{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/plugins/index_management/public/application/sections/home/index_list/index_table/index_table.js","dependencies":[{"path":"x-pack/plugins/index_management/public/application/sections/home/index_list/index_table/index_table.js","mtime":1589249554136},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkluZGV4VGFibGUgPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX3JlYWN0Um91dGVyRG9tID0gcmVxdWlyZSgicmVhY3Qtcm91dGVyLWRvbSIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cyIpOwoKdmFyIF9jb25zdGFudHMyID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29uc3RhbnRzIik7Cgp2YXIgX3NlcnZpY2VzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vc2VydmljZXMiKTsKCnZhciBfYXBwX2NvbnRleHQgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9hcHBfY29udGV4dCIpOwoKdmFyIF9yZW5kZXJfYmFkZ2VzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vbGliL3JlbmRlcl9iYWRnZXMiKTsKCnZhciBfY29tcG9uZW50cyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMiKTsKCnZhciBfaW5kZXhfYWN0aW9uc19jb250ZXh0X21lbnUgPSByZXF1aXJlKCIuLi9pbmRleF9hY3Rpb25zX2NvbnRleHRfbWVudSIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsgfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX2UgPSB1bmRlZmluZWQ7IHRyeSB7IGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsgX2Fyci5wdXNoKF9zLnZhbHVlKTsgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOyB9IH0gY2F0Y2ggKGVycikgeyBfZCA9IHRydWU7IF9lID0gZXJyOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsgfSBmaW5hbGx5IHsgaWYgKF9kKSB0aHJvdyBfZTsgfSB9IHJldHVybiBfYXJyOyB9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7IH0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsgfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgeyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IH0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgSEVBREVSUyA9IHsKICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleFRhYmxlLmhlYWRlcnMubmFtZUhlYWRlcicsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnTmFtZScKICB9KSwKICBoZWFsdGg6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4VGFibGUuaGVhZGVycy5oZWFsdGhIZWFkZXInLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ0hlYWx0aCcKICB9KSwKICBzdGF0dXM6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4VGFibGUuaGVhZGVycy5zdGF0dXNIZWFkZXInLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ1N0YXR1cycKICB9KSwKICBwcmltYXJ5OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleFRhYmxlLmhlYWRlcnMucHJpbWFyeUhlYWRlcicsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnUHJpbWFyaWVzJwogIH0pLAogIHJlcGxpY2E6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4VGFibGUuaGVhZGVycy5yZXBsaWNhSGVhZGVyJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdSZXBsaWNhcycKICB9KSwKICBkb2N1bWVudHM6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4VGFibGUuaGVhZGVycy5kb2N1bWVudHNIZWFkZXInLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ0RvY3MgY291bnQnCiAgfSksCiAgc2l6ZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhUYWJsZS5oZWFkZXJzLnN0b3JhZ2VTaXplSGVhZGVyJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdTdG9yYWdlIHNpemUnCiAgfSkKfTsKCnZhciBJbmRleFRhYmxlID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhJbmRleFRhYmxlLCBfQ29tcG9uZW50KTsKCiAgX2NyZWF0ZUNsYXNzKEluZGV4VGFibGUsIG51bGwsIFt7CiAgICBrZXk6ICJnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhwcm9wcywgc3RhdGUpIHsKICAgICAgLy8gRGVzZWxjdCBhbnkgaW5kaWNlcyB3aGljaCBubyBsb25nZXIgZXhpc3QsIGUuZy4gdGhleSd2ZSBiZWVuIGRlbGV0ZWQuCiAgICAgIHZhciBzZWxlY3RlZEluZGljZXNNYXAgPSBzdGF0ZS5zZWxlY3RlZEluZGljZXNNYXA7CiAgICAgIHZhciBpbmRleE5hbWVzID0gcHJvcHMuaW5kaWNlcy5tYXAoZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgcmV0dXJuIGluZGV4Lm5hbWU7CiAgICAgIH0pOwogICAgICB2YXIgc2VsZWN0ZWRJbmRleE5hbWVzID0gT2JqZWN0LmtleXMoc2VsZWN0ZWRJbmRpY2VzTWFwKTsKICAgICAgdmFyIG1pc3NpbmdJbmRleE5hbWVzID0gc2VsZWN0ZWRJbmRleE5hbWVzLmZpbHRlcihmdW5jdGlvbiAoc2VsZWN0ZWRJbmRleE5hbWUpIHsKICAgICAgICByZXR1cm4gIWluZGV4TmFtZXMuaW5jbHVkZXMoc2VsZWN0ZWRJbmRleE5hbWUpOwogICAgICB9KTsKCiAgICAgIGlmIChtaXNzaW5nSW5kZXhOYW1lcy5sZW5ndGgpIHsKICAgICAgICB2YXIgbmV3TWFwID0gX29iamVjdFNwcmVhZCh7fSwgc2VsZWN0ZWRJbmRpY2VzTWFwKTsKCiAgICAgICAgbWlzc2luZ0luZGV4TmFtZXMuZm9yRWFjaChmdW5jdGlvbiAobWlzc2luZ0luZGV4TmFtZSkgewogICAgICAgICAgcmV0dXJuIGRlbGV0ZSBuZXdNYXBbbWlzc2luZ0luZGV4TmFtZV07CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHNlbGVjdGVkSW5kaWNlc01hcDogbmV3TWFwCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfV0pOwoKICBmdW5jdGlvbiBJbmRleFRhYmxlKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEluZGV4VGFibGUpOwoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKEluZGV4VGFibGUpLmNhbGwodGhpcywgcHJvcHMpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblNvcnQiLCBmdW5jdGlvbiAoY29sdW1uKSB7CiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IF90aGlzLnByb3BzLAogICAgICAgICAgc29ydEZpZWxkID0gX3RoaXMkcHJvcHMuc29ydEZpZWxkLAogICAgICAgICAgaXNTb3J0QXNjZW5kaW5nID0gX3RoaXMkcHJvcHMuaXNTb3J0QXNjZW5kaW5nLAogICAgICAgICAgc29ydENoYW5nZWQgPSBfdGhpcyRwcm9wcy5zb3J0Q2hhbmdlZDsKICAgICAgdmFyIG5ld0lzU29ydEFzY2VuZGluZyA9IHNvcnRGaWVsZCA9PT0gY29sdW1uID8gIWlzU29ydEFzY2VuZGluZyA6IHRydWU7CiAgICAgIHNvcnRDaGFuZ2VkKGNvbHVtbiwgbmV3SXNTb3J0QXNjZW5kaW5nKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRmlsdGVyQ2hhbmdlZCIsIGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgIHZhciBxdWVyeSA9IF9yZWYucXVlcnksCiAgICAgICAgICBlcnJvciA9IF9yZWYuZXJyb3I7CgogICAgICBpZiAoZXJyb3IpIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBmaWx0ZXJFcnJvcjogZXJyb3IKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5wcm9wcy5maWx0ZXJDaGFuZ2VkKHF1ZXJ5KTsKCiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgZmlsdGVyRXJyb3I6IG51bGwKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0RmlsdGVycyIsIGZ1bmN0aW9uIChleHRlbnNpb25zU2VydmljZSkgewogICAgICB2YXIgYWxsSW5kaWNlcyA9IF90aGlzLnByb3BzLmFsbEluZGljZXM7CiAgICAgIHJldHVybiBleHRlbnNpb25zU2VydmljZS5maWx0ZXJzLnJlZHVjZShmdW5jdGlvbiAoYWNjdW0sIGZpbHRlckV4dGVuc2lvbikgewogICAgICAgIHZhciBmaWx0ZXJzVG9BZGQgPSBmaWx0ZXJFeHRlbnNpb24oYWxsSW5kaWNlcyk7CiAgICAgICAgcmV0dXJuIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoYWNjdW0pLCBfdG9Db25zdW1hYmxlQXJyYXkoZmlsdGVyc1RvQWRkKSk7CiAgICAgIH0sIFtdKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInRvZ2dsZUFsbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGFsbFNlbGVjdGVkID0gX3RoaXMuYXJlQWxsSXRlbXNTZWxlY3RlZCgpOwoKICAgICAgaWYgKGFsbFNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgIHNlbGVjdGVkSW5kaWNlc01hcDoge30KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIGluZGljZXMgPSBfdGhpcy5wcm9wcy5pbmRpY2VzOwogICAgICB2YXIgc2VsZWN0ZWRJbmRpY2VzTWFwID0ge307CiAgICAgIGluZGljZXMuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgICB2YXIgbmFtZSA9IF9yZWYyLm5hbWU7CiAgICAgICAgc2VsZWN0ZWRJbmRpY2VzTWFwW25hbWVdID0gdHJ1ZTsKICAgICAgfSk7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2VsZWN0ZWRJbmRpY2VzTWFwOiBzZWxlY3RlZEluZGljZXNNYXAKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJ0b2dnbGVJdGVtIiwgZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKF9yZWYzKSB7CiAgICAgICAgdmFyIHNlbGVjdGVkSW5kaWNlc01hcCA9IF9yZWYzLnNlbGVjdGVkSW5kaWNlc01hcDsKCiAgICAgICAgdmFyIG5ld01hcCA9IF9vYmplY3RTcHJlYWQoe30sIHNlbGVjdGVkSW5kaWNlc01hcCk7CgogICAgICAgIGlmIChuZXdNYXBbbmFtZV0pIHsKICAgICAgICAgIGRlbGV0ZSBuZXdNYXBbbmFtZV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG5ld01hcFtuYW1lXSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gewogICAgICAgICAgc2VsZWN0ZWRJbmRpY2VzTWFwOiBuZXdNYXAKICAgICAgICB9OwogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImlzSXRlbVNlbGVjdGVkIiwgZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgcmV0dXJuICEhX3RoaXMuc3RhdGUuc2VsZWN0ZWRJbmRpY2VzTWFwW25hbWVdOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiYXJlQWxsSXRlbXNTZWxlY3RlZCIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGluZGljZXMgPSBfdGhpcy5wcm9wcy5pbmRpY2VzOwogICAgICB2YXIgaW5kZXhPZlVuc2VsZWN0ZWRJdGVtID0gaW5kaWNlcy5maW5kSW5kZXgoZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgcmV0dXJuICFfdGhpcy5pc0l0ZW1TZWxlY3RlZChpbmRleC5uYW1lKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBpbmRleE9mVW5zZWxlY3RlZEl0ZW0gPT09IC0xOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25JdGVtU2VsZWN0aW9uQ2hhbmdlZCIsIGZ1bmN0aW9uIChzZWxlY3RlZEluZGljZXMpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNlbGVjdGVkSW5kaWNlczogc2VsZWN0ZWRJbmRpY2VzCiAgICAgIH0pOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIHNlbGVjdGVkSW5kaWNlc01hcDoge30KICAgIH07CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoSW5kZXhUYWJsZSwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5wcm9wcy5sb2FkSW5kaWNlcygpOwogICAgICB0aGlzLmludGVydmFsID0gc2V0SW50ZXJ2YWwodGhpcy5wcm9wcy5yZWxvYWRJbmRpY2VzLCBfY29uc3RhbnRzMi5SRUZSRVNIX1JBVEVfSU5ERVhfTElTVCk7CiAgICAgIHZhciBfdGhpcyRwcm9wczIgPSB0aGlzLnByb3BzLAogICAgICAgICAgZmlsdGVyQ2hhbmdlZCA9IF90aGlzJHByb3BzMi5maWx0ZXJDaGFuZ2VkLAogICAgICAgICAgZmlsdGVyRnJvbVVSSSA9IF90aGlzJHByb3BzMi5maWx0ZXJGcm9tVVJJOwoKICAgICAgaWYgKGZpbHRlckZyb21VUkkpIHsKICAgICAgICB2YXIgZGVjb2RlZEZpbHRlciA9IGRlY29kZVVSSUNvbXBvbmVudChmaWx0ZXJGcm9tVVJJKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHZhciBmaWx0ZXIgPSBfZXVpLkV1aVNlYXJjaEJhci5RdWVyeS5wYXJzZShkZWNvZGVkRmlsdGVyKTsKCiAgICAgICAgICBmaWx0ZXJDaGFuZ2VkKGZpbHRlcik7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgIGZpbHRlckVycm9yOiBlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsVW5tb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7CiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyRmlsdGVyRXJyb3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckZpbHRlckVycm9yKCkgewogICAgICB2YXIgZmlsdGVyRXJyb3IgPSB0aGlzLnN0YXRlLmZpbHRlckVycm9yOwoKICAgICAgaWYgKCFmaWx0ZXJFcnJvcikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ2FsbE91dCwgewogICAgICAgIGljb25UeXBlOiAiZmFjZVNhZCIsCiAgICAgICAgY29sb3I6ICJkYW5nZXIiLAogICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleFRhYmxlLmludmFsaWRTZWFyY2hFcnJvck1lc3NhZ2UnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ludmFsaWQgc2VhcmNoOiB7ZXJyb3JNZXNzYWdlfScsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgZXJyb3JNZXNzYWdlOiBmaWx0ZXJFcnJvci5tZXNzYWdlCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIG51bGwpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJidWlsZEhlYWRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGRIZWFkZXIoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHByb3BzMyA9IHRoaXMucHJvcHMsCiAgICAgICAgICBzb3J0RmllbGQgPSBfdGhpcyRwcm9wczMuc29ydEZpZWxkLAogICAgICAgICAgaXNTb3J0QXNjZW5kaW5nID0gX3RoaXMkcHJvcHMzLmlzU29ydEFzY2VuZGluZzsKICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKEhFQURFUlMpLm1hcChmdW5jdGlvbiAoX3JlZjQpIHsKICAgICAgICB2YXIgX3JlZjUgPSBfc2xpY2VkVG9BcnJheShfcmVmNCwgMiksCiAgICAgICAgICAgIGZpZWxkTmFtZSA9IF9yZWY1WzBdLAogICAgICAgICAgICBsYWJlbCA9IF9yZWY1WzFdOwoKICAgICAgICB2YXIgaXNTb3J0ZWQgPSBzb3J0RmllbGQgPT09IGZpZWxkTmFtZTsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRhYmxlSGVhZGVyQ2VsbCwgewogICAgICAgICAga2V5OiBmaWVsZE5hbWUsCiAgICAgICAgICBvblNvcnQ6IGZ1bmN0aW9uIG9uU29ydCgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5vblNvcnQoZmllbGROYW1lKTsKICAgICAgICAgIH0sCiAgICAgICAgICBpc1NvcnRlZDogaXNTb3J0ZWQsCiAgICAgICAgICBpc1NvcnRBc2NlbmRpbmc6IGlzU29ydEFzY2VuZGluZywKICAgICAgICAgIGNsYXNzTmFtZTogJ2luZFRhYmxlX19oZWFkZXItLScgKyBmaWVsZE5hbWUsCiAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiaW5kZXhUYWJsZUhlYWRlckNlbGwtIi5jb25jYXQoZmllbGROYW1lKQogICAgICAgIH0sIGxhYmVsKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYnVpbGRSb3dDZWxsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBidWlsZFJvd0NlbGwoZmllbGROYW1lLCB2YWx1ZSwgaW5kZXgsIGFwcFNlcnZpY2VzKSB7CiAgICAgIHZhciBfdGhpcyRwcm9wczQgPSB0aGlzLnByb3BzLAogICAgICAgICAgb3BlbkRldGFpbFBhbmVsID0gX3RoaXMkcHJvcHM0Lm9wZW5EZXRhaWxQYW5lbCwKICAgICAgICAgIGZpbHRlckNoYW5nZWQgPSBfdGhpcyRwcm9wczQuZmlsdGVyQ2hhbmdlZDsKCiAgICAgIGlmIChmaWVsZE5hbWUgPT09ICdoZWFsdGgnKSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlIZWFsdGgsIHsKICAgICAgICAgIGNvbG9yOiAoMCwgX3NlcnZpY2VzLmhlYWx0aFRvQ29sb3IpKHZhbHVlKQogICAgICAgIH0sIHZhbHVlKTsKICAgICAgfSBlbHNlIGlmIChmaWVsZE5hbWUgPT09ICduYW1lJykgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJpbmRleFRhYmxlSW5kZXhOYW1lTGluayIsCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICBhcHBTZXJ2aWNlcy51aU1ldHJpY1NlcnZpY2UudHJhY2tNZXRyaWMoJ2NsaWNrJywgX2NvbnN0YW50cy5VSU1fU0hPV19ERVRBSUxTX0NMSUNLKTsKICAgICAgICAgICAgb3BlbkRldGFpbFBhbmVsKHZhbHVlKTsKICAgICAgICAgIH0KICAgICAgICB9LCB2YWx1ZSksICgwLCBfcmVuZGVyX2JhZGdlcy5yZW5kZXJCYWRnZXMpKGluZGV4LCBmaWx0ZXJDaGFuZ2VkLCBhcHBTZXJ2aWNlcy5leHRlbnNpb25zU2VydmljZSkpOwogICAgICB9CgogICAgICByZXR1cm4gdmFsdWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiYnVpbGRSb3dDZWxscyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGRSb3dDZWxscyhpbmRleCwgYXBwU2VydmljZXMpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICByZXR1cm4gT2JqZWN0LmtleXMoSEVBREVSUykubWFwKGZ1bmN0aW9uIChmaWVsZE5hbWUpIHsKICAgICAgICB2YXIgbmFtZSA9IGluZGV4Lm5hbWU7CiAgICAgICAgdmFyIHZhbHVlID0gaW5kZXhbZmllbGROYW1lXTsKCiAgICAgICAgaWYgKGZpZWxkTmFtZSA9PT0gJ25hbWUnKSB7CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgidGgiLCB7CiAgICAgICAgICAgIGtleTogIiIuY29uY2F0KGZpZWxkTmFtZSwgIi0iKS5jb25jYXQobmFtZSksCiAgICAgICAgICAgIGNsYXNzTmFtZTogImV1aVRhYmxlUm93Q2VsbCIsCiAgICAgICAgICAgIHNjb3BlOiAicm93IiwKICAgICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogImluZGV4VGFibGVDZWxsLSIuY29uY2F0KGZpZWxkTmFtZSkKICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiZXVpVGFibGVDZWxsQ29udGVudCBpbmRUYWJsZV9fY2VsbC0tIi5jb25jYXQoZmllbGROYW1lKQogICAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiZXVpLXRleHRMZWZ0IgogICAgICAgICAgfSwgX3RoaXMzLmJ1aWxkUm93Q2VsbChmaWVsZE5hbWUsIHZhbHVlLCBpbmRleCwgYXBwU2VydmljZXMpKSkpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJsZVJvd0NlbGwsIHsKICAgICAgICAgIGtleTogIiIuY29uY2F0KGZpZWxkTmFtZSwgIi0iKS5jb25jYXQobmFtZSksCiAgICAgICAgICB0cnVuY2F0ZVRleHQ6IGZhbHNlLAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogImluZGV4VGFibGVDZWxsLSIuY29uY2F0KGZpZWxkTmFtZSksCiAgICAgICAgICBjbGFzc05hbWU6ICdpbmRUYWJsZV9fY2VsbC0tJyArIGZpZWxkTmFtZSwKICAgICAgICAgIGhlYWRlcjogZmllbGROYW1lCiAgICAgICAgfSwgX3RoaXMzLmJ1aWxkUm93Q2VsbChmaWVsZE5hbWUsIHZhbHVlLCBpbmRleCwgYXBwU2VydmljZXMpKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyRXJyb3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckVycm9yKCkgewogICAgICB2YXIgaW5kaWNlc0Vycm9yID0gdGhpcy5wcm9wcy5pbmRpY2VzRXJyb3I7CiAgICAgIHZhciBkYXRhID0gaW5kaWNlc0Vycm9yLmJvZHkgPyBpbmRpY2VzRXJyb3IuYm9keSA6IGluZGljZXNFcnJvcjsKICAgICAgdmFyIGVycm9yU3RyaW5nID0gZGF0YS5lcnJvciwKICAgICAgICAgIGNhdXNlID0gZGF0YS5jYXVzZSwKICAgICAgICAgIG1lc3NhZ2UgPSBkYXRhLm1lc3NhZ2U7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNhbGxPdXQsIHsKICAgICAgICB0aXRsZTogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suaWR4TWdtdC5pbmRleFRhYmxlLnNlcnZlckVycm9yVGl0bGUiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFcnJvciBsb2FkaW5nIGluZGljZXMiCiAgICAgICAgfSksCiAgICAgICAgY29sb3I6ICJkYW5nZXIiLAogICAgICAgIGljb25UeXBlOiAiYWxlcnQiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIG1lc3NhZ2UgfHwgZXJyb3JTdHJpbmcpLCBjYXVzZSAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJtIgogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgidWwiLCBudWxsLCBjYXVzZS5tYXAoZnVuY3Rpb24gKG1lc3NhZ2UsIGkpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgibGkiLCB7CiAgICAgICAgICBrZXk6IGkKICAgICAgICB9LCBtZXNzYWdlKTsKICAgICAgfSkpKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAieGwiCiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJCYW5uZXJzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJCYW5uZXJzKGV4dGVuc2lvbnNTZXJ2aWNlKSB7CiAgICAgIHZhciBfdGhpcyRwcm9wczUgPSB0aGlzLnByb3BzLAogICAgICAgICAgX3RoaXMkcHJvcHM1JGFsbEluZGljID0gX3RoaXMkcHJvcHM1LmFsbEluZGljZXMsCiAgICAgICAgICBhbGxJbmRpY2VzID0gX3RoaXMkcHJvcHM1JGFsbEluZGljID09PSB2b2lkIDAgPyBbXSA6IF90aGlzJHByb3BzNSRhbGxJbmRpYywKICAgICAgICAgIGZpbHRlckNoYW5nZWQgPSBfdGhpcyRwcm9wczUuZmlsdGVyQ2hhbmdlZDsKICAgICAgcmV0dXJuIGV4dGVuc2lvbnNTZXJ2aWNlLmJhbm5lcnMubWFwKGZ1bmN0aW9uIChiYW5uZXJFeHRlbnNpb24sIGkpIHsKICAgICAgICB2YXIgYmFubmVyRGF0YSA9IGJhbm5lckV4dGVuc2lvbihhbGxJbmRpY2VzKTsKCiAgICAgICAgaWYgKCFiYW5uZXJEYXRhKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIHZhciB0eXBlID0gYmFubmVyRGF0YS50eXBlLAogICAgICAgICAgICB0aXRsZSA9IGJhbm5lckRhdGEudGl0bGUsCiAgICAgICAgICAgIG1lc3NhZ2UgPSBiYW5uZXJEYXRhLm1lc3NhZ2UsCiAgICAgICAgICAgIGZpbHRlciA9IGJhbm5lckRhdGEuZmlsdGVyLAogICAgICAgICAgICBmaWx0ZXJMYWJlbCA9IGJhbm5lckRhdGEuZmlsdGVyTGFiZWw7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCB7CiAgICAgICAgICBrZXk6ICJiYW5uZXJFeHRlbnNpb24iLmNvbmNhdChpKQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDYWxsT3V0LCB7CiAgICAgICAgICBjb2xvcjogdHlwZSwKICAgICAgICAgIHNpemU6ICJtIiwKICAgICAgICAgIHRpdGxlOiB0aXRsZQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCBudWxsLCBtZXNzYWdlLCBmaWx0ZXIgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTGluaywgewogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgcmV0dXJuIGZpbHRlckNoYW5nZWQoZmlsdGVyKTsKICAgICAgICAgIH0KICAgICAgICB9LCBmaWx0ZXJMYWJlbCkgOiBudWxsKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICAgIHNpemU6ICJtIgogICAgICAgIH0pKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYnVpbGRSb3dzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBidWlsZFJvd3MoYXBwU2VydmljZXMpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkcHJvcHM2ID0gdGhpcy5wcm9wcywKICAgICAgICAgIF90aGlzJHByb3BzNiRpbmRpY2VzID0gX3RoaXMkcHJvcHM2LmluZGljZXMsCiAgICAgICAgICBpbmRpY2VzID0gX3RoaXMkcHJvcHM2JGluZGljZXMgPT09IHZvaWQgMCA/IFtdIDogX3RoaXMkcHJvcHM2JGluZGljZXMsCiAgICAgICAgICBkZXRhaWxQYW5lbEluZGV4TmFtZSA9IF90aGlzJHByb3BzNi5kZXRhaWxQYW5lbEluZGV4TmFtZTsKICAgICAgcmV0dXJuIGluZGljZXMubWFwKGZ1bmN0aW9uIChpbmRleCkgewogICAgICAgIHZhciBuYW1lID0gaW5kZXgubmFtZTsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRhYmxlUm93LCB7CiAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiaW5kZXhUYWJsZVJvdyIsCiAgICAgICAgICBpc1NlbGVjdGVkOiBfdGhpczQuaXNJdGVtU2VsZWN0ZWQobmFtZSkgfHwgbmFtZSA9PT0gZGV0YWlsUGFuZWxJbmRleE5hbWUsCiAgICAgICAgICBpc1NlbGVjdGFibGU6IHRydWUsCiAgICAgICAgICBrZXk6ICIiLmNvbmNhdChuYW1lLCAiLXJvdyIpCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRhYmxlUm93Q2VsbENoZWNrYm94LCB7CiAgICAgICAgICBrZXk6ICJjaGVja2JveC0iLmNvbmNhdChuYW1lKQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDaGVja2JveCwgewogICAgICAgICAgdHlwZTogImluTGlzdCIsCiAgICAgICAgICBpZDogImNoZWNrYm94U2VsZWN0SW5kZXgtIi5jb25jYXQobmFtZSksCiAgICAgICAgICBjaGVja2VkOiBfdGhpczQuaXNJdGVtU2VsZWN0ZWQobmFtZSksCiAgICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoKSB7CiAgICAgICAgICAgIF90aGlzNC50b2dnbGVJdGVtKG5hbWUpOwogICAgICAgICAgfSwKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJpbmRleFRhYmxlUm93Q2hlY2tib3giLAogICAgICAgICAgImFyaWEtbGFiZWwiOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleFRhYmxlLnNlbGVjdEluZGV4QXJpYUxhYmVsJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NlbGVjdCB0aGlzIHJvdycKICAgICAgICAgIH0pCiAgICAgICAgfSkpLCBfdGhpczQuYnVpbGRSb3dDZWxscyhpbmRleCwgYXBwU2VydmljZXMpKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyUGFnZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclBhZ2VyKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHM3ID0gdGhpcy5wcm9wcywKICAgICAgICAgIHBhZ2VyID0gX3RoaXMkcHJvcHM3LnBhZ2VyLAogICAgICAgICAgcGFnZUNoYW5nZWQgPSBfdGhpcyRwcm9wczcucGFnZUNoYW5nZWQsCiAgICAgICAgICBwYWdlU2l6ZUNoYW5nZWQgPSBfdGhpcyRwcm9wczcucGFnZVNpemVDaGFuZ2VkOwogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRhYmxlUGFnaW5hdGlvbiwgewogICAgICAgIGFjdGl2ZVBhZ2U6IHBhZ2VyLmdldEN1cnJlbnRQYWdlSW5kZXgoKSwKICAgICAgICBpdGVtc1BlclBhZ2U6IHBhZ2VyLml0ZW1zUGVyUGFnZSwKICAgICAgICBpdGVtc1BlclBhZ2VPcHRpb25zOiBbMTAsIDUwLCAxMDBdLAogICAgICAgIHBhZ2VDb3VudDogcGFnZXIuZ2V0VG90YWxQYWdlcygpLAogICAgICAgIG9uQ2hhbmdlSXRlbXNQZXJQYWdlOiBwYWdlU2l6ZUNoYW5nZWQsCiAgICAgICAgb25DaGFuZ2VQYWdlOiBwYWdlQ2hhbmdlZAogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJUb2dnbGVDb250cm9sIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJUb2dnbGVDb250cm9sKF9yZWY2KSB7CiAgICAgIHZhciBuYW1lID0gX3JlZjYubmFtZSwKICAgICAgICAgIGxhYmVsID0gX3JlZjYubGFiZWw7CiAgICAgIHZhciBfdGhpcyRwcm9wczggPSB0aGlzLnByb3BzLAogICAgICAgICAgdG9nZ2xlTmFtZVRvVmlzaWJsZU1hcCA9IF90aGlzJHByb3BzOC50b2dnbGVOYW1lVG9WaXNpYmxlTWFwLAogICAgICAgICAgdG9nZ2xlQ2hhbmdlZCA9IF90aGlzJHByb3BzOC50b2dnbGVDaGFuZ2VkOwogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAga2V5OiBuYW1lLAogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTd2l0Y2gsIHsKICAgICAgICBpZDogImNoZWNrYm94VG9nZ2xlcy0iLmNvbmNhdChuYW1lKSwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiY2hlY2tib3hUb2dnbGVzLSIuY29uY2F0KG5hbWUpLAogICAgICAgIGNoZWNrZWQ6IHRvZ2dsZU5hbWVUb1Zpc2libGVNYXBbbmFtZV0sCiAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGV2ZW50KSB7CiAgICAgICAgICByZXR1cm4gdG9nZ2xlQ2hhbmdlZChuYW1lLCBldmVudC50YXJnZXQuY2hlY2tlZCk7CiAgICAgICAgfSwKICAgICAgICBsYWJlbDogbGFiZWwKICAgICAgfSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyRwcm9wczkgPSB0aGlzLnByb3BzLAogICAgICAgICAgZmlsdGVyID0gX3RoaXMkcHJvcHM5LmZpbHRlciwKICAgICAgICAgIHNob3dTeXN0ZW1JbmRpY2VzID0gX3RoaXMkcHJvcHM5LnNob3dTeXN0ZW1JbmRpY2VzLAogICAgICAgICAgc2hvd1N5c3RlbUluZGljZXNDaGFuZ2VkID0gX3RoaXMkcHJvcHM5LnNob3dTeXN0ZW1JbmRpY2VzQ2hhbmdlZCwKICAgICAgICAgIGluZGljZXMgPSBfdGhpcyRwcm9wczkuaW5kaWNlcywKICAgICAgICAgIGxvYWRJbmRpY2VzID0gX3RoaXMkcHJvcHM5LmxvYWRJbmRpY2VzLAogICAgICAgICAgaW5kaWNlc0xvYWRpbmcgPSBfdGhpcyRwcm9wczkuaW5kaWNlc0xvYWRpbmcsCiAgICAgICAgICBpbmRpY2VzRXJyb3IgPSBfdGhpcyRwcm9wczkuaW5kaWNlc0Vycm9yLAogICAgICAgICAgYWxsSW5kaWNlcyA9IF90aGlzJHByb3BzOS5hbGxJbmRpY2VzLAogICAgICAgICAgcGFnZXIgPSBfdGhpcyRwcm9wczkucGFnZXI7CiAgICAgIHZhciBlbXB0eVN0YXRlOwoKICAgICAgaWYgKGluZGljZXNMb2FkaW5nKSB7CiAgICAgICAgZW1wdHlTdGF0ZSA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICAgIGp1c3RpZnlDb250ZW50OiAic3BhY2VBcm91bmQiCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgICBncm93OiBmYWxzZQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMb2FkaW5nU3Bpbm5lciwgewogICAgICAgICAgc2l6ZTogInhsIgogICAgICAgIH0pKSk7CiAgICAgIH0KCiAgICAgIGlmICghaW5kaWNlc0xvYWRpbmcgJiYgIWluZGljZXNFcnJvcikgewogICAgICAgIGVtcHR5U3RhdGUgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzLk5vTWF0Y2gsIG51bGwpOwogICAgICB9CgogICAgICB2YXIgc2VsZWN0ZWRJbmRpY2VzTWFwID0gdGhpcy5zdGF0ZS5zZWxlY3RlZEluZGljZXNNYXA7CiAgICAgIHZhciBhdExlYXN0T25lSXRlbVNlbGVjdGVkID0gT2JqZWN0LmtleXMoc2VsZWN0ZWRJbmRpY2VzTWFwKS5sZW5ndGggPiAwOwoKICAgICAgaWYgKGluZGljZXNFcnJvciAmJiBpbmRpY2VzRXJyb3Iuc3RhdHVzID09PSA0MDMpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29tcG9uZW50cy5QYWdlRXJyb3JGb3JiaWRkZW4sIG51bGwpOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYXBwX2NvbnRleHQuQXBwQ29udGV4dENvbnN1bWVyLCBudWxsLCBmdW5jdGlvbiAoX3JlZjcpIHsKICAgICAgICB2YXIgc2VydmljZXMgPSBfcmVmNy5zZXJ2aWNlczsKICAgICAgICB2YXIgZXh0ZW5zaW9uc1NlcnZpY2UgPSBzZXJ2aWNlcy5leHRlbnNpb25zU2VydmljZTsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgICBncm93OiB0cnVlCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICAgICAgICBzaXplOiAicyIKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgewogICAgICAgICAgY29sb3I6ICJzdWJkdWVkIgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLmlkeE1nbXQuaG9tZS5pZHhNZ210RGVzY3JpcHRpb24iLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJVcGRhdGUgeW91ciBFbGFzdGljc2VhcmNoIGluZGljZXMgaW5kaXZpZHVhbGx5IG9yIGluIGJ1bGsuIgogICAgICAgIH0pKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgIGdyb3c6IGZhbHNlCiAgICAgICAgfSwgaW5kaWNlc0xvYWRpbmcgJiYgYWxsSW5kaWNlcy5sZW5ndGggPT09IDAgfHwgaW5kaWNlc0Vycm9yID8gbnVsbCA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIG51bGwsIGV4dGVuc2lvbnNTZXJ2aWNlLnRvZ2dsZXMubWFwKGZ1bmN0aW9uICh0b2dnbGUpIHsKICAgICAgICAgIHJldHVybiBfdGhpczUucmVuZGVyVG9nZ2xlQ29udHJvbCh0b2dnbGUpOwogICAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgIGdyb3c6IGZhbHNlCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVN3aXRjaCwgewogICAgICAgICAgaWQ6ICJjaGVja2JveFNob3dTeXN0ZW1JbmRpY2VzIiwKICAgICAgICAgIGNoZWNrZWQ6IHNob3dTeXN0ZW1JbmRpY2VzLAogICAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybiBzaG93U3lzdGVtSW5kaWNlc0NoYW5nZWQoZXZlbnQudGFyZ2V0LmNoZWNrZWQpOwogICAgICAgICAgfSwKICAgICAgICAgIGxhYmVsOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgICBpZDogInhwYWNrLmlkeE1nbXQuaW5kZXhUYWJsZS5zeXN0ZW1JbmRpY2VzU3dpdGNoTGFiZWwiLAogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkluY2x1ZGUgc3lzdGVtIGluZGljZXMiCiAgICAgICAgICB9KQogICAgICAgIH0pKSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgICAgc2l6ZTogImwiCiAgICAgICAgfSksIF90aGlzNS5yZW5kZXJCYW5uZXJzKGV4dGVuc2lvbnNTZXJ2aWNlKSwgaW5kaWNlc0Vycm9yICYmIF90aGlzNS5yZW5kZXJFcnJvcigpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAgICBndXR0ZXJTaXplOiAibCIsCiAgICAgICAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIgogICAgICAgIH0sIGF0TGVhc3RPbmVJdGVtU2VsZWN0ZWQgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgIGdyb3c6IGZhbHNlCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3RSb3V0ZXJEb20uUm91dGUsIHsKICAgICAgICAgIGtleTogIm1lbnUiLAogICAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9pbmRleF9hY3Rpb25zX2NvbnRleHRfbWVudS5JbmRleEFjdGlvbnNDb250ZXh0TWVudSwgewogICAgICAgICAgICAgIGluZGV4TmFtZXM6IE9iamVjdC5rZXlzKHNlbGVjdGVkSW5kaWNlc01hcCksCiAgICAgICAgICAgICAgcmVzZXRTZWxlY3Rpb246IGZ1bmN0aW9uIHJlc2V0U2VsZWN0aW9uKCkgewogICAgICAgICAgICAgICAgX3RoaXM1LnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRpY2VzTWFwOiB7fQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KSkgOiBudWxsLCBpbmRpY2VzTG9hZGluZyAmJiBhbGxJbmRpY2VzLmxlbmd0aCA9PT0gMCB8fCBpbmRpY2VzRXJyb3IgPyBudWxsIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNlYXJjaEJhciwgewogICAgICAgICAgZmlsdGVyczogX3RoaXM1LmdldEZpbHRlcnMoZXh0ZW5zaW9uc1NlcnZpY2UpLmxlbmd0aCA+IDAgPyBfdGhpczUuZ2V0RmlsdGVycyhleHRlbnNpb25zU2VydmljZSkgOiBudWxsLAogICAgICAgICAgZGVmYXVsdFF1ZXJ5OiBmaWx0ZXIsCiAgICAgICAgICBxdWVyeTogZmlsdGVyLAogICAgICAgICAgYm94OiB7CiAgICAgICAgICAgIGluY3JlbWVudGFsOiB0cnVlLAogICAgICAgICAgICBwbGFjZWhvbGRlcjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhUYWJsZS5zeXN0ZW1JbmRpY2VzU2VhcmNoSW5wdXRQbGFjZWhvbGRlcicsIHsKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NlYXJjaCcKICAgICAgICAgICAgfSkKICAgICAgICAgIH0sCiAgICAgICAgICAiYXJpYS1sYWJlbCI6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4VGFibGUuc3lzdGVtSW5kaWNlc1NlYXJjaEluZGljZXNBcmlhTGFiZWwnLCB7CiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnU2VhcmNoIGluZGljZXMnCiAgICAgICAgICB9KSwKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJpbmRleFRhYmxlRmlsdGVySW5wdXQiLAogICAgICAgICAgb25DaGFuZ2U6IF90aGlzNS5vbkZpbHRlckNoYW5nZWQKICAgICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgICAgICBpc0xvYWRpbmc6IGluZGljZXNMb2FkaW5nLAogICAgICAgICAgY29sb3I6ICJzZWNvbmRhcnkiLAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgbG9hZEluZGljZXMoKTsKICAgICAgICAgIH0sCiAgICAgICAgICBpY29uVHlwZTogInJlZnJlc2giLAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInJlbG9hZEluZGljZXNCdXR0b24iCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suaWR4TWdtdC5pbmRleFRhYmxlLnJlbG9hZEluZGljZXNCdXR0b24iLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJSZWxvYWQgaW5kaWNlcyIKICAgICAgICB9KSkpKSksIF90aGlzNS5yZW5kZXJGaWx0ZXJFcnJvcigpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgICBzaXplOiAibSIKICAgICAgICB9KSwgaW5kaWNlcy5sZW5ndGggPiAwID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgc3R5bGU6IHsKICAgICAgICAgICAgbWF4V2lkdGg6ICcxMDAlJywKICAgICAgICAgICAgb3ZlcmZsb3c6ICdhdXRvJwogICAgICAgICAgfQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJsZSwgewogICAgICAgICAgY2xhc3NOYW1lOiAiaW5kVGFibGUiCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNjcmVlblJlYWRlck9ubHksIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImNhcHRpb24iLCB7CiAgICAgICAgICByb2xlOiAic3RhdHVzIiwKICAgICAgICAgICJhcmlhLXJlbGV2YW50IjogInRleHQiLAogICAgICAgICAgImFyaWEtbGl2ZSI6ICJwb2xpdGUiCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suaWR4TWdtdC5pbmRleFRhYmxlLmNhcHRpb25UZXh0IiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQmVsb3cgaXMgdGhlIGluZGljZXMgdGFibGUgY29udGFpbmluZyB7Y291bnQsIHBsdXJhbCwgb25lIHsjIHJvd30gb3RoZXIgeyMgcm93c319IG91dCBvZiB7dG90YWx9LiIsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgY291bnQ6IGluZGljZXMubGVuZ3RoLAogICAgICAgICAgICB0b3RhbDogcGFnZXIudG90YWxJdGVtcwogICAgICAgICAgfQogICAgICAgIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJsZUhlYWRlciwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRhYmxlSGVhZGVyQ2VsbENoZWNrYm94LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ2hlY2tib3gsIHsKICAgICAgICAgIGlkOiAic2VsZWN0QWxsSW5kZXhlcyIsCiAgICAgICAgICBjaGVja2VkOiBfdGhpczUuYXJlQWxsSXRlbXNTZWxlY3RlZCgpLAogICAgICAgICAgb25DaGFuZ2U6IF90aGlzNS50b2dnbGVBbGwsCiAgICAgICAgICB0eXBlOiAiaW5MaXN0IiwKICAgICAgICAgICJhcmlhLWxhYmVsIjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhUYWJsZS5zZWxlY3RBbGxJbmRpY2VzQXJpYUxhYmVsJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NlbGVjdCBhbGwgcm93cycKICAgICAgICAgIH0pCiAgICAgICAgfSkpLCBfdGhpczUuYnVpbGRIZWFkZXIoKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJsZUJvZHksIG51bGwsIF90aGlzNS5idWlsZFJvd3Moc2VydmljZXMpKSkpIDogZW1wdHlTdGF0ZSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgICAgc2l6ZTogIm0iCiAgICAgICAgfSksIGluZGljZXMubGVuZ3RoID4gMCA/IF90aGlzNS5yZW5kZXJQYWdlcigpIDogbnVsbCk7CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEluZGV4VGFibGU7Cn0oX3JlYWN0LkNvbXBvbmVudCk7CgpleHBvcnRzLkluZGV4VGFibGUgPSBJbmRleFRhYmxlOw=="},null]}