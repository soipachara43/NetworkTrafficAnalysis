{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/case/components/user_action_tree/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/case/components/user_action_tree/index.js","mtime":1589249553276},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlVzZXJBY3Rpb25UcmVlID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfcmVhY3RSb3V0ZXJEb20gPSByZXF1aXJlKCJyZWFjdC1yb3V0ZXItZG9tIik7Cgp2YXIgX3N0eWxlZENvbXBvbmVudHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInN0eWxlZC1jb21wb25lbnRzIikpOwoKdmFyIGkxOG4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCIuLi9jYXNlX3ZpZXcvdHJhbnNsYXRpb25zIikpOwoKdmFyIF91c2VfdXBkYXRlX2NvbW1lbnQgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb250YWluZXJzL2Nhc2UvdXNlX3VwZGF0ZV9jb21tZW50Iik7Cgp2YXIgX2tpYmFuYSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2xpYi9raWJhbmEiKTsKCnZhciBfYWRkX2NvbW1lbnQgPSByZXF1aXJlKCIuLi9hZGRfY29tbWVudCIpOwoKdmFyIF9oZWxwZXJzID0gcmVxdWlyZSgiLi9oZWxwZXJzIik7Cgp2YXIgX3VzZXJfYWN0aW9uX2l0ZW0gPSByZXF1aXJlKCIuL3VzZXJfYWN0aW9uX2l0ZW0iKTsKCnZhciBfdXNlcl9hY3Rpb25fbWFya2Rvd24gPSByZXF1aXJlKCIuL3VzZXJfYWN0aW9uX21hcmtkb3duIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKdmFyIE15RXVpRmxleEdyb3VwID0gKDAsIF9zdHlsZWRDb21wb25lbnRzLmRlZmF1bHQpKF9ldWkuRXVpRmxleEdyb3VwKS53aXRoQ29uZmlnKHsKICBkaXNwbGF5TmFtZTogIk15RXVpRmxleEdyb3VwIiwKICBjb21wb25lbnRJZDogInJrYndkNC0wIgp9KShbIm1hcmdpbi1ib3R0b206OHB4OyJdKTsKdmFyIERFU0NSSVBUSU9OX0lEID0gJ2Rlc2NyaXB0aW9uJzsKdmFyIE5FV19JRCA9ICduZXdDb21tZW50JzsKCnZhciBVc2VyQWN0aW9uVHJlZSA9IF9yZWFjdC5kZWZhdWx0Lm1lbW8oZnVuY3Rpb24gKF9yZWYpIHsKICB2YXIgX3JlZjMsIF9jYXNlRGF0YSRjcmVhdGVkQnkkZiwgX2Nhc2VEYXRhJGNyZWF0ZWRCeSR1LCBfY3VycmVudFVzZXIkZnVsbE5hbWUsIF9jdXJyZW50VXNlciR1c2VybmFtZTsKCiAgdmFyIGNhc2VEYXRhID0gX3JlZi5kYXRhLAogICAgICBjYXNlVXNlckFjdGlvbnMgPSBfcmVmLmNhc2VVc2VyQWN0aW9ucywKICAgICAgZmV0Y2hVc2VyQWN0aW9ucyA9IF9yZWYuZmV0Y2hVc2VyQWN0aW9ucywKICAgICAgZmlyc3RJbmRleFB1c2hUb1NlcnZpY2UgPSBfcmVmLmZpcnN0SW5kZXhQdXNoVG9TZXJ2aWNlLAogICAgICBpc0xvYWRpbmdEZXNjcmlwdGlvbiA9IF9yZWYuaXNMb2FkaW5nRGVzY3JpcHRpb24sCiAgICAgIGlzTG9hZGluZ1VzZXJBY3Rpb25zID0gX3JlZi5pc0xvYWRpbmdVc2VyQWN0aW9ucywKICAgICAgbGFzdEluZGV4UHVzaFRvU2VydmljZSA9IF9yZWYubGFzdEluZGV4UHVzaFRvU2VydmljZSwKICAgICAgb25VcGRhdGVGaWVsZCA9IF9yZWYub25VcGRhdGVGaWVsZCwKICAgICAgdXBkYXRlQ2FzZSA9IF9yZWYudXBkYXRlQ2FzZSwKICAgICAgdXNlckNhbkNydWQgPSBfcmVmLnVzZXJDYW5DcnVkOwoKICB2YXIgX3VzZVBhcmFtcyA9ICgwLCBfcmVhY3RSb3V0ZXJEb20udXNlUGFyYW1zKSgpLAogICAgICBjb21tZW50SWQgPSBfdXNlUGFyYW1zLmNvbW1lbnRJZDsKCiAgdmFyIGhhbmRsZXJUaW1lb3V0SWQgPSAoMCwgX3JlYWN0LnVzZVJlZikoMCk7CgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSh0cnVlKSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksCiAgICAgIGluaXRMb2FkaW5nID0gX3VzZVN0YXRlMlswXSwKICAgICAgc2V0SW5pdExvYWRpbmcgPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgX3VzZVN0YXRlMyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKCcnKSwKICAgICAgX3VzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTMsIDIpLAogICAgICBzZWxlY3RlZE91dGxpbmVDb21tZW50SWQgPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRTZWxlY3RlZE91dGxpbmVDb21tZW50SWQgPSBfdXNlU3RhdGU0WzFdOwoKICB2YXIgX3VzZVVwZGF0ZUNvbW1lbnQgPSAoMCwgX3VzZV91cGRhdGVfY29tbWVudC51c2VVcGRhdGVDb21tZW50KSgpLAogICAgICBpc0xvYWRpbmdJZHMgPSBfdXNlVXBkYXRlQ29tbWVudC5pc0xvYWRpbmdJZHMsCiAgICAgIHBhdGNoQ29tbWVudCA9IF91c2VVcGRhdGVDb21tZW50LnBhdGNoQ29tbWVudDsKCiAgdmFyIGN1cnJlbnRVc2VyID0gKDAsIF9raWJhbmEudXNlQ3VycmVudFVzZXIpKCk7CgogIHZhciBfdXNlU3RhdGU1ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoW10pLAogICAgICBfdXNlU3RhdGU2ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNSwgMiksCiAgICAgIG1hbmFnZU1hcmtkb3duRWRpdElkcyA9IF91c2VTdGF0ZTZbMF0sCiAgICAgIHNldE1hbmFuZ2VNYXJkb3duRWRpdElkcyA9IF91c2VTdGF0ZTZbMV07CgogIHZhciBfdXNlU3RhdGU3ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkobnVsbCksCiAgICAgIF91c2VTdGF0ZTggPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGU3LCAyKSwKICAgICAgaW5zZXJ0UXVvdGUgPSBfdXNlU3RhdGU4WzBdLAogICAgICBzZXRJbnNlcnRRdW90ZSA9IF91c2VTdGF0ZThbMV07CgogIHZhciBoYW5kbGVNYW5hZ2VNYXJrZG93bkVkaXRJZCA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChpZCkgewogICAgaWYgKCFtYW5hZ2VNYXJrZG93bkVkaXRJZHMuaW5jbHVkZXMoaWQpKSB7CiAgICAgIHNldE1hbmFuZ2VNYXJkb3duRWRpdElkcyhbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KG1hbmFnZU1hcmtkb3duRWRpdElkcyksIFtpZF0pKTsKICAgIH0gZWxzZSB7CiAgICAgIHNldE1hbmFuZ2VNYXJkb3duRWRpdElkcyhtYW5hZ2VNYXJrZG93bkVkaXRJZHMuZmlsdGVyKGZ1bmN0aW9uIChteUlkKSB7CiAgICAgICAgcmV0dXJuIGlkICE9PSBteUlkOwogICAgICB9KSk7CiAgICB9CiAgfSwgW21hbmFnZU1hcmtkb3duRWRpdElkc10pOwogIHZhciBoYW5kbGVTYXZlQ29tbWVudCA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChfcmVmMiwgY29udGVudCkgewogICAgdmFyIGlkID0gX3JlZjIuaWQsCiAgICAgICAgdmVyc2lvbiA9IF9yZWYyLnZlcnNpb247CiAgICBoYW5kbGVNYW5hZ2VNYXJrZG93bkVkaXRJZChpZCk7CiAgICBwYXRjaENvbW1lbnQoewogICAgICBjYXNlSWQ6IGNhc2VEYXRhLmlkLAogICAgICBjb21tZW50SWQ6IGlkLAogICAgICBjb21tZW50VXBkYXRlOiBjb250ZW50LAogICAgICBmZXRjaFVzZXJBY3Rpb25zOiBmZXRjaFVzZXJBY3Rpb25zLAogICAgICB2ZXJzaW9uOiB2ZXJzaW9uLAogICAgICB1cGRhdGVDYXNlOiB1cGRhdGVDYXNlCiAgICB9KTsKICB9LCBbY2FzZURhdGEsIGhhbmRsZU1hbmFnZU1hcmtkb3duRWRpdElkLCBwYXRjaENvbW1lbnQsIHVwZGF0ZUNhc2VdKTsKICB2YXIgaGFuZGxlT3V0bGluZUNvbW1lbnQgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoaWQpIHsKICAgIHZhciBtb3ZlVG9UYXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiIi5jb25jYXQoaWQsICItcGVybUxpbmsiKSk7CgogICAgaWYgKG1vdmVUb1RhcmdldCAhPSBudWxsKSB7CiAgICAgIHZhciB5T2Zmc2V0ID0gLTYwOwogICAgICB2YXIgeSA9IG1vdmVUb1RhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyB3aW5kb3cucGFnZVlPZmZzZXQgKyB5T2Zmc2V0OwogICAgICB3aW5kb3cuc2Nyb2xsVG8oewogICAgICAgIHRvcDogeSwKICAgICAgICBiZWhhdmlvcjogJ3Ntb290aCcKICAgICAgfSk7CgogICAgICBpZiAoaWQgPT09ICdhZGQtY29tbWVudCcpIHsKICAgICAgICBtb3ZlVG9UYXJnZXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RleHRhcmVhJylbMF0uZm9jdXMoKTsKICAgICAgfQogICAgfQoKICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoaGFuZGxlclRpbWVvdXRJZC5jdXJyZW50KTsKICAgIHNldFNlbGVjdGVkT3V0bGluZUNvbW1lbnRJZChpZCk7CiAgICBoYW5kbGVyVGltZW91dElkLmN1cnJlbnQgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIHNldFNlbGVjdGVkT3V0bGluZUNvbW1lbnRJZCgnJyk7CiAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoaGFuZGxlclRpbWVvdXRJZC5jdXJyZW50KTsKICAgIH0sIDI0MDApOwogIH0sIFtoYW5kbGVyVGltZW91dElkLmN1cnJlbnRdKTsKICB2YXIgaGFuZGxlTWFuYWdlUXVvdGUgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAocXVvdGUpIHsKICAgIHZhciBhZGRDYXJyb3RzID0gcXVvdGUucmVwbGFjZShuZXcgUmVnRXhwKCdccj9cbicsICdnJyksICcgIFxuPiAnKTsKICAgIHNldEluc2VydFF1b3RlKCI+ICIuY29uY2F0KGFkZENhcnJvdHMsICIgXG4iKSk7CiAgICBoYW5kbGVPdXRsaW5lQ29tbWVudCgnYWRkLWNvbW1lbnQnKTsKICB9LCBbaGFuZGxlT3V0bGluZUNvbW1lbnRdKTsKICB2YXIgaGFuZGxlVXBkYXRlID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKG5ld0Nhc2UpIHsKICAgIHVwZGF0ZUNhc2UobmV3Q2FzZSk7CiAgICBmZXRjaFVzZXJBY3Rpb25zKCk7CiAgfSwgW2ZldGNoVXNlckFjdGlvbnMsIHVwZGF0ZUNhc2VdKTsKICB2YXIgTWFya2Rvd25EZXNjcmlwdGlvbiA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3VzZXJfYWN0aW9uX21hcmtkb3duLlVzZXJBY3Rpb25NYXJrZG93biwgewogICAgICBpZDogREVTQ1JJUFRJT05fSUQsCiAgICAgIGNvbnRlbnQ6IGNhc2VEYXRhLmRlc2NyaXB0aW9uLAogICAgICBpc0VkaXRhYmxlOiBtYW5hZ2VNYXJrZG93bkVkaXRJZHMuaW5jbHVkZXMoREVTQ1JJUFRJT05fSUQpLAogICAgICBvblNhdmVDb250ZW50OiBmdW5jdGlvbiBvblNhdmVDb250ZW50KGNvbnRlbnQpIHsKICAgICAgICBoYW5kbGVNYW5hZ2VNYXJrZG93bkVkaXRJZChERVNDUklQVElPTl9JRCk7CiAgICAgICAgb25VcGRhdGVGaWVsZChERVNDUklQVElPTl9JRCwgY29udGVudCk7CiAgICAgIH0sCiAgICAgIG9uQ2hhbmdlRWRpdGFibGU6IGhhbmRsZU1hbmFnZU1hcmtkb3duRWRpdElkCiAgICB9KTsKICB9LCBbY2FzZURhdGEuZGVzY3JpcHRpb24sIGhhbmRsZU1hbmFnZU1hcmtkb3duRWRpdElkLCBtYW5hZ2VNYXJrZG93bkVkaXRJZHMsIG9uVXBkYXRlRmllbGRdKTsKICB2YXIgTWFya2Rvd25OZXdDb21tZW50ID0gKDAsIF9yZWFjdC51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWRkX2NvbW1lbnQuQWRkQ29tbWVudCwgewogICAgICBjYXNlSWQ6IGNhc2VEYXRhLmlkLAogICAgICBkaXNhYmxlZDogIXVzZXJDYW5DcnVkLAogICAgICBpbnNlcnRRdW90ZTogaW5zZXJ0UXVvdGUsCiAgICAgIG9uQ29tbWVudFBvc3RlZDogaGFuZGxlVXBkYXRlLAogICAgICBvbkNvbW1lbnRTYXZpbmc6IGhhbmRsZU1hbmFnZU1hcmtkb3duRWRpdElkLmJpbmQobnVsbCwgTkVXX0lEKSwKICAgICAgc2hvd0xvYWRpbmc6IGZhbHNlCiAgICB9KTsKICB9LCBbY2FzZURhdGEuaWQsIGhhbmRsZVVwZGF0ZSwgaW5zZXJ0UXVvdGUsIHVzZXJDYW5DcnVkXSk7CiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIGlmIChpbml0TG9hZGluZyAmJiAhaXNMb2FkaW5nVXNlckFjdGlvbnMgJiYgaXNMb2FkaW5nSWRzLmxlbmd0aCA9PT0gMCkgewogICAgICBzZXRJbml0TG9hZGluZyhmYWxzZSk7CgogICAgICBpZiAoY29tbWVudElkICE9IG51bGwpIHsKICAgICAgICBoYW5kbGVPdXRsaW5lQ29tbWVudChjb21tZW50SWQpOwogICAgICB9CiAgICB9CiAgfSwgW2NvbW1lbnRJZCwgaW5pdExvYWRpbmcsIGlzTG9hZGluZ1VzZXJBY3Rpb25zLCBpc0xvYWRpbmdJZHNdKTsKICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdXNlcl9hY3Rpb25faXRlbS5Vc2VyQWN0aW9uSXRlbSwgewogICAgY3JlYXRlZEF0OiBjYXNlRGF0YS5jcmVhdGVkQXQsCiAgICBkaXNhYmxlZDogIXVzZXJDYW5DcnVkLAogICAgaWQ6IERFU0NSSVBUSU9OX0lELAogICAgaXNFZGl0YWJsZTogbWFuYWdlTWFya2Rvd25FZGl0SWRzLmluY2x1ZGVzKERFU0NSSVBUSU9OX0lEKSwKICAgIGlzTG9hZGluZzogaXNMb2FkaW5nRGVzY3JpcHRpb24sCiAgICBsYWJlbEVkaXRBY3Rpb246IGkxOG4uRURJVF9ERVNDUklQVElPTiwKICAgIGxhYmVsUXVvdGVBY3Rpb246IGkxOG4uUVVPVEUsCiAgICBsYWJlbFRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBpMThuLkFEREVEX0RFU0NSSVBUSU9OKSwKICAgIGZ1bGxOYW1lOiAoX3JlZjMgPSAoX2Nhc2VEYXRhJGNyZWF0ZWRCeSRmID0gY2FzZURhdGEuY3JlYXRlZEJ5LmZ1bGxOYW1lKSAhPT0gbnVsbCAmJiBfY2FzZURhdGEkY3JlYXRlZEJ5JGYgIT09IHZvaWQgMCA/IF9jYXNlRGF0YSRjcmVhdGVkQnkkZiA6IGNhc2VEYXRhLmNyZWF0ZWRCeS51c2VybmFtZSkgIT09IG51bGwgJiYgX3JlZjMgIT09IHZvaWQgMCA/IF9yZWYzIDogJycsCiAgICBtYXJrZG93bjogTWFya2Rvd25EZXNjcmlwdGlvbiwKICAgIG9uRWRpdDogaGFuZGxlTWFuYWdlTWFya2Rvd25FZGl0SWQuYmluZChudWxsLCBERVNDUklQVElPTl9JRCksCiAgICBvblF1b3RlOiBoYW5kbGVNYW5hZ2VRdW90ZS5iaW5kKG51bGwsIGNhc2VEYXRhLmRlc2NyaXB0aW9uKSwKICAgIHVzZXJuYW1lOiAoX2Nhc2VEYXRhJGNyZWF0ZWRCeSR1ID0gY2FzZURhdGEuY3JlYXRlZEJ5LnVzZXJuYW1lKSAhPT0gbnVsbCAmJiBfY2FzZURhdGEkY3JlYXRlZEJ5JHUgIT09IHZvaWQgMCA/IF9jYXNlRGF0YSRjcmVhdGVkQnkkdSA6ICdVbmtub3duJwogIH0pLCBjYXNlVXNlckFjdGlvbnMubWFwKGZ1bmN0aW9uIChhY3Rpb24sIGluZGV4KSB7CiAgICBpZiAoYWN0aW9uLmNvbW1lbnRJZCAhPSBudWxsICYmIGFjdGlvbi5hY3Rpb24gPT09ICdjcmVhdGUnKSB7CiAgICAgIHZhciBjb21tZW50ID0gY2FzZURhdGEuY29tbWVudHMuZmluZChmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBjLmlkID09PSBhY3Rpb24uY29tbWVudElkOwogICAgICB9KTsKCiAgICAgIGlmIChjb21tZW50ICE9IG51bGwpIHsKICAgICAgICB2YXIgX3JlZjQsIF9jb21tZW50JGNyZWF0ZWRCeSRmdSwgX2NvbW1lbnQkY3JlYXRlZEJ5JHVzOwoKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdXNlcl9hY3Rpb25faXRlbS5Vc2VyQWN0aW9uSXRlbSwgewogICAgICAgICAga2V5OiBhY3Rpb24uYWN0aW9uSWQsCiAgICAgICAgICBjcmVhdGVkQXQ6IGNvbW1lbnQuY3JlYXRlZEF0LAogICAgICAgICAgZGlzYWJsZWQ6ICF1c2VyQ2FuQ3J1ZCwKICAgICAgICAgIGlkOiBjb21tZW50LmlkLAogICAgICAgICAgaWRUb091dGxpbmU6IHNlbGVjdGVkT3V0bGluZUNvbW1lbnRJZCwKICAgICAgICAgIGlzRWRpdGFibGU6IG1hbmFnZU1hcmtkb3duRWRpdElkcy5pbmNsdWRlcyhjb21tZW50LmlkKSwKICAgICAgICAgIGlzTG9hZGluZzogaXNMb2FkaW5nSWRzLmluY2x1ZGVzKGNvbW1lbnQuaWQpLAogICAgICAgICAgbGFiZWxFZGl0QWN0aW9uOiBpMThuLkVESVRfQ09NTUVOVCwKICAgICAgICAgIGxhYmVsUXVvdGVBY3Rpb246IGkxOG4uUVVPVEUsCiAgICAgICAgICBsYWJlbFRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBpMThuLkFEREVEX0NPTU1FTlQpLAogICAgICAgICAgZnVsbE5hbWU6IChfcmVmNCA9IChfY29tbWVudCRjcmVhdGVkQnkkZnUgPSBjb21tZW50LmNyZWF0ZWRCeS5mdWxsTmFtZSkgIT09IG51bGwgJiYgX2NvbW1lbnQkY3JlYXRlZEJ5JGZ1ICE9PSB2b2lkIDAgPyBfY29tbWVudCRjcmVhdGVkQnkkZnUgOiBjb21tZW50LmNyZWF0ZWRCeS51c2VybmFtZSkgIT09IG51bGwgJiYgX3JlZjQgIT09IHZvaWQgMCA/IF9yZWY0IDogJycsCiAgICAgICAgICBtYXJrZG93bjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfdXNlcl9hY3Rpb25fbWFya2Rvd24uVXNlckFjdGlvbk1hcmtkb3duLCB7CiAgICAgICAgICAgIGlkOiBjb21tZW50LmlkLAogICAgICAgICAgICBjb250ZW50OiBjb21tZW50LmNvbW1lbnQsCiAgICAgICAgICAgIGlzRWRpdGFibGU6IG1hbmFnZU1hcmtkb3duRWRpdElkcy5pbmNsdWRlcyhjb21tZW50LmlkKSwKICAgICAgICAgICAgb25DaGFuZ2VFZGl0YWJsZTogaGFuZGxlTWFuYWdlTWFya2Rvd25FZGl0SWQsCiAgICAgICAgICAgIG9uU2F2ZUNvbnRlbnQ6IGhhbmRsZVNhdmVDb21tZW50LmJpbmQobnVsbCwgewogICAgICAgICAgICAgIGlkOiBjb21tZW50LmlkLAogICAgICAgICAgICAgIHZlcnNpb246IGNvbW1lbnQudmVyc2lvbgogICAgICAgICAgICB9KQogICAgICAgICAgfSksCiAgICAgICAgICBvbkVkaXQ6IGhhbmRsZU1hbmFnZU1hcmtkb3duRWRpdElkLmJpbmQobnVsbCwgY29tbWVudC5pZCksCiAgICAgICAgICBvblF1b3RlOiBoYW5kbGVNYW5hZ2VRdW90ZS5iaW5kKG51bGwsIGNvbW1lbnQuY29tbWVudCksCiAgICAgICAgICBvdXRsaW5lQ29tbWVudDogaGFuZGxlT3V0bGluZUNvbW1lbnQsCiAgICAgICAgICB1c2VybmFtZTogKF9jb21tZW50JGNyZWF0ZWRCeSR1cyA9IGNvbW1lbnQuY3JlYXRlZEJ5LnVzZXJuYW1lKSAhPT0gbnVsbCAmJiBfY29tbWVudCRjcmVhdGVkQnkkdXMgIT09IHZvaWQgMCA/IF9jb21tZW50JGNyZWF0ZWRCeSR1cyA6ICcnLAogICAgICAgICAgdXBkYXRlZEF0OiBjb21tZW50LnVwZGF0ZWRBdAogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgaWYgKGFjdGlvbi5hY3Rpb25GaWVsZC5sZW5ndGggPT09IDEpIHsKICAgICAgdmFyIF9yZWY1LCBfYWN0aW9uJGFjdGlvbkJ5JGZ1bGwsIF9hY3Rpb24kYWN0aW9uQnkkdXNlcjsKCiAgICAgIHZhciBteUZpZWxkID0gYWN0aW9uLmFjdGlvbkZpZWxkWzBdOwogICAgICB2YXIgbGFiZWxUaXRsZSA9ICgwLCBfaGVscGVycy5nZXRMYWJlbFRpdGxlKSh7CiAgICAgICAgYWN0aW9uOiBhY3Rpb24sCiAgICAgICAgZmllbGQ6IG15RmllbGQsCiAgICAgICAgZmlyc3RJbmRleFB1c2hUb1NlcnZpY2U6IGZpcnN0SW5kZXhQdXNoVG9TZXJ2aWNlLAogICAgICAgIGluZGV4OiBpbmRleAogICAgICB9KTsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3VzZXJfYWN0aW9uX2l0ZW0uVXNlckFjdGlvbkl0ZW0sIHsKICAgICAgICBrZXk6IGFjdGlvbi5hY3Rpb25JZCwKICAgICAgICBjcmVhdGVkQXQ6IGFjdGlvbi5hY3Rpb25BdCwKICAgICAgICBkaXNhYmxlZDogIXVzZXJDYW5DcnVkLAogICAgICAgIGlkOiBhY3Rpb24uYWN0aW9uSWQsCiAgICAgICAgaXNFZGl0YWJsZTogZmFsc2UsCiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgICBsYWJlbFRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBsYWJlbFRpdGxlKSwKICAgICAgICBsaW5rSWQ6IGFjdGlvbi5hY3Rpb24gPT09ICd1cGRhdGUnICYmIGFjdGlvbi5jb21tZW50SWQgIT0gbnVsbCA/IGFjdGlvbi5jb21tZW50SWQgOiBudWxsLAogICAgICAgIGZ1bGxOYW1lOiAoX3JlZjUgPSAoX2FjdGlvbiRhY3Rpb25CeSRmdWxsID0gYWN0aW9uLmFjdGlvbkJ5LmZ1bGxOYW1lKSAhPT0gbnVsbCAmJiBfYWN0aW9uJGFjdGlvbkJ5JGZ1bGwgIT09IHZvaWQgMCA/IF9hY3Rpb24kYWN0aW9uQnkkZnVsbCA6IGFjdGlvbi5hY3Rpb25CeS51c2VybmFtZSkgIT09IG51bGwgJiYgX3JlZjUgIT09IHZvaWQgMCA/IF9yZWY1IDogJycsCiAgICAgICAgb3V0bGluZUNvbW1lbnQ6IGhhbmRsZU91dGxpbmVDb21tZW50LAogICAgICAgIHNob3dUb3BGb290ZXI6IGFjdGlvbi5hY3Rpb24gPT09ICdwdXNoLXRvLXNlcnZpY2UnICYmIGluZGV4ID09PSBsYXN0SW5kZXhQdXNoVG9TZXJ2aWNlLAogICAgICAgIHNob3dCb3R0b21Gb290ZXI6IGFjdGlvbi5hY3Rpb24gPT09ICdwdXNoLXRvLXNlcnZpY2UnICYmIGluZGV4ID09PSBsYXN0SW5kZXhQdXNoVG9TZXJ2aWNlICYmIGluZGV4IDwgY2FzZVVzZXJBY3Rpb25zLmxlbmd0aCAtIDEsCiAgICAgICAgdXNlcm5hbWU6IChfYWN0aW9uJGFjdGlvbkJ5JHVzZXIgPSBhY3Rpb24uYWN0aW9uQnkudXNlcm5hbWUpICE9PSBudWxsICYmIF9hY3Rpb24kYWN0aW9uQnkkdXNlciAhPT0gdm9pZCAwID8gX2FjdGlvbiRhY3Rpb25CeSR1c2VyIDogJycKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfSksIChpc0xvYWRpbmdVc2VyQWN0aW9ucyB8fCBpc0xvYWRpbmdJZHMuaW5jbHVkZXMoTkVXX0lEKSkgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChNeUV1aUZsZXhHcm91cCwgewogICAganVzdGlmeUNvbnRlbnQ6ICJjZW50ZXIiLAogICAgYWxpZ25JdGVtczogImNlbnRlciIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxvYWRpbmdTcGlubmVyLCB7CiAgICBzaXplOiAibCIKICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF91c2VyX2FjdGlvbl9pdGVtLlVzZXJBY3Rpb25JdGVtLCB7CiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwKICAgIGRpc2FibGVkOiAhdXNlckNhbkNydWQsCiAgICBpZDogTkVXX0lELAogICAgaXNFZGl0YWJsZTogdHJ1ZSwKICAgIGlzTG9hZGluZzogaXNMb2FkaW5nSWRzLmluY2x1ZGVzKE5FV19JRCksCiAgICBmdWxsTmFtZTogY3VycmVudFVzZXIgIT0gbnVsbCA/IChfY3VycmVudFVzZXIkZnVsbE5hbWUgPSBjdXJyZW50VXNlci5mdWxsTmFtZSkgIT09IG51bGwgJiYgX2N1cnJlbnRVc2VyJGZ1bGxOYW1lICE9PSB2b2lkIDAgPyBfY3VycmVudFVzZXIkZnVsbE5hbWUgOiAnJyA6ICcnLAogICAgbWFya2Rvd246IE1hcmtkb3duTmV3Q29tbWVudCwKICAgIHVzZXJuYW1lOiBjdXJyZW50VXNlciAhPSBudWxsID8gKF9jdXJyZW50VXNlciR1c2VybmFtZSA9IGN1cnJlbnRVc2VyLnVzZXJuYW1lKSAhPT0gbnVsbCAmJiBfY3VycmVudFVzZXIkdXNlcm5hbWUgIT09IHZvaWQgMCA/IF9jdXJyZW50VXNlciR1c2VybmFtZSA6ICcnIDogJycKICB9KSk7Cn0pOwoKZXhwb3J0cy5Vc2VyQWN0aW9uVHJlZSA9IFVzZXJBY3Rpb25UcmVlOwpVc2VyQWN0aW9uVHJlZS5kaXNwbGF5TmFtZSA9ICdVc2VyQWN0aW9uVHJlZSc7"},null]}