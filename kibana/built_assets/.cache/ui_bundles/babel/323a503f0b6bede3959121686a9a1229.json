{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/plugins/expressions/common/execution/execution.js","dependencies":[{"path":"src/plugins/expressions/common/execution/execution.js","mtime":1589249550811},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgeyB0cnkgeyB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7IHZhciB2YWx1ZSA9IGluZm8udmFsdWU7IH0gY2F0Y2ggKGVycm9yKSB7IHJlamVjdChlcnJvcik7IHJldHVybjsgfSBpZiAoaW5mby5kb25lKSB7IHJlc29sdmUodmFsdWUpOyB9IGVsc2UgeyBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7IH0gfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7IGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7IH0gZnVuY3Rpb24gX3Rocm93KGVycikgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7IH0gX25leHQodW5kZWZpbmVkKTsgfSk7IH07IH0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5Mih0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eTIob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5FeGVjdXRpb24gPSB2b2lkIDA7Cgp2YXIgX2xvZGFzaCA9IHJlcXVpcmUoImxvZGFzaCIpOwoKdmFyIF9jb250YWluZXIgPSByZXF1aXJlKCIuL2NvbnRhaW5lciIpOwoKdmFyIF91dGlsID0gcmVxdWlyZSgiLi4vdXRpbCIpOwoKdmFyIF9jb21tb24gPSByZXF1aXJlKCIuLi8uLi8uLi9raWJhbmFfdXRpbHMvY29tbW9uIik7Cgp2YXIgX2NvbW1vbjIgPSByZXF1aXJlKCIuLi8uLi8uLi9kYXRhL2NvbW1vbiIpOwoKdmFyIF9jb21tb24zID0gcmVxdWlyZSgiLi4vLi4vLi4vaW5zcGVjdG9yL2NvbW1vbiIpOwoKdmFyIF9lcnJvciA9IHJlcXVpcmUoIi4uL2V4cHJlc3Npb25fdHlwZXMvc3BlY3MvZXJyb3IiKTsKCnZhciBfYXN0ID0gcmVxdWlyZSgiLi4vYXN0Iik7Cgp2YXIgX2V4cHJlc3Npb25fdHlwZXMgPSByZXF1aXJlKCIuLi9leHByZXNzaW9uX3R5cGVzIik7Cgp2YXIgX2dldF9ieV9hbGlhcyA9IHJlcXVpcmUoIi4uL3V0aWwvZ2V0X2J5X2FsaWFzIik7Cgp2YXIgX2V4ZWN1dGlvbl9jb250cmFjdCA9IHJlcXVpcmUoIi4vZXhlY3V0aW9uX2NvbnRyYWN0Iik7CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIGNyZWF0ZURlZmF1bHRJbnNwZWN0b3JBZGFwdGVycyA9IGZ1bmN0aW9uIGNyZWF0ZURlZmF1bHRJbnNwZWN0b3JBZGFwdGVycygpIHsKICByZXR1cm4gewogICAgcmVxdWVzdHM6IG5ldyBfY29tbW9uMy5SZXF1ZXN0QWRhcHRlcigpLAogICAgZGF0YTogbmV3IF9jb21tb24zLkRhdGFBZGFwdGVyKCkKICB9Owp9OwoKdmFyIEV4ZWN1dGlvbiA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIF9jcmVhdGVDbGFzcyhFeGVjdXRpb24sIFt7CiAgICBrZXk6ICJyZXN1bHQiLAoKICAgIC8qKgogICAgICogRHluYW1pYyBzdGF0ZSBvZiB0aGUgZXhlY3V0aW9uLgogICAgICovCgogICAgLyoqCiAgICAgKiBJbml0aWFsIGlucHV0IG9mIHRoZSBleGVjdXRpb24uCiAgICAgKgogICAgICogTi5CLiBJdCBpcyBpbml0aWFsaXplZCB0byBgbnVsbGAgcmF0aGVyIHRoYW4gYHVuZGVmaW5lZGAgZm9yIGxlZ2FjeSByZWFzb25zLAogICAgICogYmVjYXVzZSBpbiBsZWdhY3kgaW50ZXJwcmV0ZXIgaXQgd2FzIHNldCB0byBgbnVsbGAgYnkgZGVmYXVsdC4KICAgICAqLwoKICAgIC8qKgogICAgICogRXhlY3V0aW9uIGNvbnRleHQgLSBvYmplY3QgdGhhdCBhbGxvd3MgdG8gZG8gc2lkZS1lZmZlY3RzLiBDb250ZXh0IGlzIHBhc3NlZAogICAgICogdG8gZXZlcnkgZnVuY3Rpb24uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFib3J0Q29udHJvbGxlciB0byBjYW5jZWwgdGhpcyBFeGVjdXRpb24uCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZXRoZXIgLnN0YXJ0KCkgbWV0aG9kIGhhcyBiZWVuIGNhbGxlZC4KICAgICAqLwoKICAgIC8qKgogICAgICogRnV0dXJlIHRoYXQgdHJhY2tzIHJlc3VsdCBvciBlcnJvciBvZiB0aGlzIGV4ZWN1dGlvbi4KICAgICAqLwoKICAgIC8qKgogICAgICogQ29udHJhY3QgaXMgYSBwdWJsaWMgcmVwcmVzZW50YXRpb24gb2YgYEV4ZWN1dGlvbmAgaW5zdGFuY2VzLiBDb250cmFjdCB3ZQogICAgICogY2FuIHJldHVybiB0byBvdGhlciBwbHVnaW5zIGZvciB0aGVpciBjb25zdW1wdGlvbi4KICAgICAqLwogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLmZpcnN0UmVzdWx0RnV0dXJlLnByb21pc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW5zcGVjdG9yQWRhcHRlcnMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuaW5zcGVjdG9yQWRhcHRlcnM7CiAgICB9CiAgfV0pOwoKICBmdW5jdGlvbiBFeGVjdXRpb24ocGFyYW1zKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFeGVjdXRpb24pOwoKICAgIHRoaXMucGFyYW1zID0gcGFyYW1zOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAic3RhdGUiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiaW5wdXQiLCBudWxsKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImNvbnRleHQiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYWJvcnRDb250cm9sbGVyIiwgbmV3IEFib3J0Q29udHJvbGxlcigpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImhhc1N0YXJ0ZWQiLCBmYWxzZSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJmaXJzdFJlc3VsdEZ1dHVyZSIsIG5ldyBfY29tbW9uLkRlZmVyKCkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29udHJhY3QiLCBuZXcgX2V4ZWN1dGlvbl9jb250cmFjdC5FeGVjdXRpb25Db250cmFjdCh0aGlzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJleHByZXNzaW9uIiwgdm9pZCAwKTsKCiAgICB2YXIgZXhlY3V0b3IgPSBwYXJhbXMuZXhlY3V0b3I7CgogICAgaWYgKCFwYXJhbXMuYXN0ICYmICFwYXJhbXMuZXhwcmVzc2lvbikgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdFeGVjdXRpb24gcGFyYW1zIHNob3VsZCBjb250YWluIGF0IGxlYXN0IC5hc3Qgb3IgLmV4cHJlc3Npb24ga2V5LicpOwogICAgfSBlbHNlIGlmIChwYXJhbXMuYXN0ICYmIHBhcmFtcy5leHByZXNzaW9uKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4ZWN1dGlvbiBwYXJhbXMgY2Fubm90IGNvbnRhaW4gYm90aCAuYXN0IGFuZCAuZXhwcmVzc2lvbiBrZXkuJyk7CiAgICB9CgogICAgdGhpcy5leHByZXNzaW9uID0gcGFyYW1zLmV4cHJlc3Npb24gfHwgKDAsIF9hc3QuZm9ybWF0RXhwcmVzc2lvbikocGFyYW1zLmFzdCk7CiAgICB2YXIgYXN0ID0gcGFyYW1zLmFzdCB8fCAoMCwgX2FzdC5wYXJzZUV4cHJlc3Npb24pKHRoaXMuZXhwcmVzc2lvbik7CiAgICB0aGlzLnN0YXRlID0gKDAsIF9jb250YWluZXIuY3JlYXRlRXhlY3V0aW9uQ29udGFpbmVyKShfb2JqZWN0U3ByZWFkKHt9LCBleGVjdXRvci5zdGF0ZS5nZXQoKSwgewogICAgICBzdGF0ZTogJ25vdC1zdGFydGVkJywKICAgICAgYXN0OiBhc3QKICAgIH0pKTsKICAgIHRoaXMuY29udGV4dCA9IF9vYmplY3RTcHJlYWQoewogICAgICBnZXRJbml0aWFsSW5wdXQ6IGZ1bmN0aW9uIGdldEluaXRpYWxJbnB1dCgpIHsKICAgICAgICByZXR1cm4gX3RoaXMuaW5wdXQ7CiAgICAgIH0sCiAgICAgIHZhcmlhYmxlczoge30sCiAgICAgIHR5cGVzOiBleGVjdXRvci5nZXRUeXBlcygpLAogICAgICBhYm9ydFNpZ25hbDogdGhpcy5hYm9ydENvbnRyb2xsZXIuc2lnbmFsCiAgICB9LCBwYXJhbXMuY29udGV4dCB8fCB7fSwgewogICAgICBpbnNwZWN0b3JBZGFwdGVyczogcGFyYW1zLmNvbnRleHQgJiYgcGFyYW1zLmNvbnRleHQuaW5zcGVjdG9yQWRhcHRlcnMgPyBwYXJhbXMuY29udGV4dC5pbnNwZWN0b3JBZGFwdGVycyA6IGNyZWF0ZURlZmF1bHRJbnNwZWN0b3JBZGFwdGVycygpCiAgICB9KTsKICB9CiAgLyoqCiAgICogU3RvcCBleGVjdXRpb24gb2YgZXhwcmVzc2lvbi4KICAgKi8KCgogIF9jcmVhdGVDbGFzcyhFeGVjdXRpb24sIFt7CiAgICBrZXk6ICJjYW5jZWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNhbmNlbCgpIHsKICAgICAgdGhpcy5hYm9ydENvbnRyb2xsZXIuYWJvcnQoKTsKICAgIH0KICAgIC8qKgogICAgICogQ2FsbCB0aGlzIG1ldGhvZCB0byBzdGFydCBleGVjdXRpb24uCiAgICAgKgogICAgICogTi5CLiBgaW5wdXRgIGlzIGluaXRpYWxpemVkIHRvIGBudWxsYCByYXRoZXIgdGhhbiBgdW5kZWZpbmVkYCBmb3IgbGVnYWN5IHJlYXNvbnMsCiAgICAgKiBiZWNhdXNlIGluIGxlZ2FjeSBpbnRlcnByZXRlciBpdCB3YXMgc2V0IHRvIGBudWxsYCBieSBkZWZhdWx0LgogICAgICovCgogIH0sIHsKICAgIGtleTogInN0YXJ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgaW5wdXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IG51bGw7CiAgICAgIGlmICh0aGlzLmhhc1N0YXJ0ZWQpIHRocm93IG5ldyBFcnJvcignRXhlY3V0aW9uIGFscmVhZHkgc3RhcnRlZC4nKTsKICAgICAgdGhpcy5oYXNTdGFydGVkID0gdHJ1ZTsKICAgICAgdGhpcy5pbnB1dCA9IGlucHV0OwogICAgICB0aGlzLnN0YXRlLnRyYW5zaXRpb25zLnN0YXJ0KCk7CiAgICAgIHZhciBfdGhpcyRmaXJzdFJlc3VsdEZ1dHUgPSB0aGlzLmZpcnN0UmVzdWx0RnV0dXJlLAogICAgICAgICAgcmVzb2x2ZSA9IF90aGlzJGZpcnN0UmVzdWx0RnV0dS5yZXNvbHZlLAogICAgICAgICAgcmVqZWN0ID0gX3RoaXMkZmlyc3RSZXN1bHRGdXR1LnJlamVjdDsKICAgICAgdGhpcy5pbnZva2VDaGFpbih0aGlzLnN0YXRlLmdldCgpLmFzdC5jaGFpbiwgaW5wdXQpLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgdGhpcy5maXJzdFJlc3VsdEZ1dHVyZS5wcm9taXNlLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIF90aGlzMi5zdGF0ZS50cmFuc2l0aW9ucy5zZXRSZXN1bHQocmVzdWx0KTsKICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgX3RoaXMyLnN0YXRlLnRyYW5zaXRpb25zLnNldEVycm9yKGVycm9yKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW52b2tlQ2hhaW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9pbnZva2VDaGFpbiA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoY2hhaW5BcnIsIGlucHV0KSB7CiAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24sIF9kaWRJdGVyYXRvckVycm9yLCBfaXRlcmF0b3JFcnJvciwgX2l0ZXJhdG9yLCBfc3RlcCwgbGluaywgZm5OYW1lLCBmbkFyZ3MsIGZuLCBhcmdzLCB0aW1lU3RhcnQsIF9yZWYsIHJlc29sdmVkQXJncywgb3V0cHV0LCB0aW1lRW5kLCBfdGltZUVuZCwgZXJyb3I7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmIChjaGFpbkFyci5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGlucHV0KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7CiAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlOwogICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gNTsKICAgICAgICAgICAgICAgIF9pdGVyYXRvciA9IGNoYWluQXJyW1N5bWJvbC5pdGVyYXRvcl0oKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgaWYgKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0MzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbGluayA9IF9zdGVwLnZhbHVlOwoKICAgICAgICAgICAgICAgIGlmICghKHRoaXMuY29udGV4dC5hYm9ydFNpZ25hbCAmJiB0aGlzLmNvbnRleHQuYWJvcnRTaWduYWwuYWJvcnRlZCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCAoMCwgX3V0aWwuY3JlYXRlRXJyb3IpKG5ldyBfY29tbW9uMi5BYm9ydEVycm9yKCdUaGUgZXhwcmVzc2lvbiB3YXMgYWJvcnRlZC4nKSkpOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgZm5OYW1lID0gbGluay5mdW5jdGlvbiwgZm5BcmdzID0gbGluay5hcmd1bWVudHM7CiAgICAgICAgICAgICAgICBmbiA9ICgwLCBfZ2V0X2J5X2FsaWFzLmdldEJ5QWxpYXMpKHRoaXMuc3RhdGUuZ2V0KCkuZnVuY3Rpb25zLCBmbk5hbWUpOwoKICAgICAgICAgICAgICAgIGlmIChmbikgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsICgwLCBfdXRpbC5jcmVhdGVFcnJvcikoewogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiRnVuY3Rpb24gIi5jb25jYXQoZm5OYW1lLCAiIGNvdWxkIG5vdCBiZSBmb3VuZC4iKQogICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgYXJncyA9IHt9OwogICAgICAgICAgICAgICAgdGltZVN0YXJ0ID0gdm9pZCAwOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE3OwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIwOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVzb2x2ZUFyZ3MoZm4sIGlucHV0LCBmbkFyZ3MpOwoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgICAgX3JlZiA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICByZXNvbHZlZEFyZ3MgPSBfcmVmLnJlc29sdmVkQXJnczsKICAgICAgICAgICAgICAgIGFyZ3MgPSByZXNvbHZlZEFyZ3M7CiAgICAgICAgICAgICAgICB0aW1lU3RhcnQgPSB0aGlzLnBhcmFtcy5kZWJ1ZyA/ICgwLCBfY29tbW9uLm5vdykoKSA6IDA7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjY7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pbnZva2VGdW5jdGlvbihmbiwgaW5wdXQsIHJlc29sdmVkQXJncyk7CgogICAgICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICAgICAgICBvdXRwdXQgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmFtcy5kZWJ1ZykgewogICAgICAgICAgICAgICAgICB0aW1lRW5kID0gKDAsIF9jb21tb24ubm93KSgpOwogICAgICAgICAgICAgICAgICBsaW5rLmRlYnVnID0gewogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgZm46IGZuLAogICAgICAgICAgICAgICAgICAgIGlucHV0OiBpbnB1dCwKICAgICAgICAgICAgICAgICAgICBhcmdzOiByZXNvbHZlZEFyZ3MsCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiBvdXRwdXQsCiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IHRpbWVFbmQgLSB0aW1lU3RhcnQKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoISgoMCwgX2V4cHJlc3Npb25fdHlwZXMuZ2V0VHlwZSkob3V0cHV0KSA9PT0gJ2Vycm9yJykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBvdXRwdXQpOwoKICAgICAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICAgICAgaW5wdXQgPSBvdXRwdXQ7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAzMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAzMzsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMTcpOwogICAgICAgICAgICAgICAgX3RpbWVFbmQgPSB0aGlzLnBhcmFtcy5kZWJ1ZyA/ICgwLCBfY29tbW9uLm5vdykoKSA6IDA7CiAgICAgICAgICAgICAgICBlcnJvciA9ICgwLCBfdXRpbC5jcmVhdGVFcnJvcikoX2NvbnRleHQudDApOwogICAgICAgICAgICAgICAgZXJyb3IuZXJyb3IubWVzc2FnZSA9ICJbIi5jb25jYXQoZm5OYW1lLCAiXSA+ICIpLmNvbmNhdChlcnJvci5lcnJvci5tZXNzYWdlKTsKCiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJhbXMuZGVidWcpIHsKICAgICAgICAgICAgICAgICAgbGluay5kZWJ1ZyA9IHsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBmbjogZm4sCiAgICAgICAgICAgICAgICAgICAgaW5wdXQ6IGlucHV0LAogICAgICAgICAgICAgICAgICAgIGFyZ3M6IGFyZ3MsCiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLAogICAgICAgICAgICAgICAgICAgIHJhd0Vycm9yOiBfY29udGV4dC50MCwKICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogdGltZVN0YXJ0ID8gX3RpbWVFbmQgLSB0aW1lU3RhcnQgOiB1bmRlZmluZWQKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBlcnJvcik7CgogICAgICAgICAgICAgIGNhc2UgNDA6CiAgICAgICAgICAgICAgICBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNDM6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDk7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA0NToKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA0NTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQxID0gX2NvbnRleHRbImNhdGNoIl0oNSk7CiAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IF9jb250ZXh0LnQxOwoKICAgICAgICAgICAgICBjYXNlIDQ5OgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDQ5OwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDUwOwoKICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yLnJldHVybigpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDUyOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDUyOwoKICAgICAgICAgICAgICAgIGlmICghX2RpZEl0ZXJhdG9yRXJyb3IpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjsKCiAgICAgICAgICAgICAgY2FzZSA1NToKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5maW5pc2goNTIpOwoKICAgICAgICAgICAgICBjYXNlIDU2OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmZpbmlzaCg0OSk7CgogICAgICAgICAgICAgIGNhc2UgNTc6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBpbnB1dCk7CgogICAgICAgICAgICAgIGNhc2UgNTg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzLCBbWzUsIDQ1LCA0OSwgNTddLCBbMTcsIDMzXSwgWzUwLCwgNTIsIDU2XV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBpbnZva2VDaGFpbihfeCwgX3gyKSB7CiAgICAgICAgcmV0dXJuIF9pbnZva2VDaGFpbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gaW52b2tlQ2hhaW47CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJpbnZva2VGdW5jdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2ludm9rZUZ1bmN0aW9uID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoZm4sIGlucHV0LCBhcmdzKSB7CiAgICAgICAgdmFyIG5vcm1hbGl6ZWRJbnB1dCwgb3V0cHV0LCByZXR1cm5UeXBlLCBleHBlY3RlZFR5cGUsIHR5cGU7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWRJbnB1dCA9IHRoaXMuY2FzdChpbnB1dCwgZm4uaW5wdXRUeXBlcyk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gZm4uZm4obm9ybWFsaXplZElucHV0LCBhcmdzLCB0aGlzLmNvbnRleHQpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBvdXRwdXQgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGZ1bmN0aW9uIHJldHVybmVkIHRoZSB0eXBlIGl0IHNhaWQgaXQgd291bGQuCiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzbid0IHJlcXVpcmVkLCBidXQgaXQga2VlcHMgZnVuY3Rpb24gZGV2ZWxvcGVycyBob25lc3QuCiAgICAgICAgICAgICAgICByZXR1cm5UeXBlID0gKDAsIF9leHByZXNzaW9uX3R5cGVzLmdldFR5cGUpKG91dHB1dCk7CiAgICAgICAgICAgICAgICBleHBlY3RlZFR5cGUgPSBmbi50eXBlOwoKICAgICAgICAgICAgICAgIGlmICghKGV4cGVjdGVkVHlwZSAmJiByZXR1cm5UeXBlICE9PSBleHBlY3RlZFR5cGUpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJGdW5jdGlvbiAnIi5jb25jYXQoZm4ubmFtZSwgIicgc2hvdWxkIHJldHVybiAnIikuY29uY2F0KGV4cGVjdGVkVHlwZSwgIicsIikgKyAiIGFjdHVhbGx5IHJldHVybmVkICciLmNvbmNhdChyZXR1cm5UeXBlLCAiJyIpKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgLy8gVmFsaWRhdGUgdGhlIGZ1bmN0aW9uIG91dHB1dCBhZ2FpbnN0IHRoZSB0eXBlIGRlZmluaXRpb24ncyB2YWxpZGF0ZSBmdW5jdGlvbi4KICAgICAgICAgICAgICAgIHR5cGUgPSB0aGlzLmNvbnRleHQudHlwZXNbZm4udHlwZV07CgogICAgICAgICAgICAgICAgaWYgKCEodHlwZSAmJiB0eXBlLnZhbGlkYXRlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDEwOwogICAgICAgICAgICAgICAgdHlwZS52YWxpZGF0ZShvdXRwdXQpOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAxNDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MlsiY2F0Y2giXSgxMCk7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIk91dHB1dCBvZiAnIi5jb25jYXQoZm4ubmFtZSwgIicgaXMgbm90IGEgdmFsaWQgdHlwZSAnIikuY29uY2F0KGZuLnR5cGUsICInOiAiKS5jb25jYXQoX2NvbnRleHQyLnQwKSk7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgb3V0cHV0KTsKCiAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcywgW1sxMCwgMTRdXSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGludm9rZUZ1bmN0aW9uKF94MywgX3g0LCBfeDUpIHsKICAgICAgICByZXR1cm4gX2ludm9rZUZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBpbnZva2VGdW5jdGlvbjsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImNhc3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNhc3QodmFsdWUsIHRvVHlwZU5hbWVzKSB7CiAgICAgIC8vIElmIHlvdSBkb24ndCBnaXZlIHVzIGFueXRoaW5nIHRvIGNhc3QgdG8sIHlvdSdsbCBnZXQgeW91ciBpbnB1dCBiYWNrCiAgICAgIGlmICghdG9UeXBlTmFtZXMgfHwgdG9UeXBlTmFtZXMubGVuZ3RoID09PSAwKSByZXR1cm4gdmFsdWU7IC8vIE5vIG5lZWQgdG8gY2FzdCBpZiBub2RlIGlzIGFscmVhZHkgb25lIG9mIHRoZSB2YWxpZCB0eXBlcwoKICAgICAgdmFyIGZyb21UeXBlTmFtZSA9ICgwLCBfZXhwcmVzc2lvbl90eXBlcy5nZXRUeXBlKSh2YWx1ZSk7CiAgICAgIGlmICh0b1R5cGVOYW1lcy5pbmNsdWRlcyhmcm9tVHlwZU5hbWUpKSByZXR1cm4gdmFsdWU7CgogICAgICB2YXIgX3RoaXMkc3RhdGUkZ2V0ID0gdGhpcy5zdGF0ZS5nZXQoKSwKICAgICAgICAgIHR5cGVzID0gX3RoaXMkc3RhdGUkZ2V0LnR5cGVzOwoKICAgICAgdmFyIGZyb21UeXBlRGVmID0gdHlwZXNbZnJvbVR5cGVOYW1lXTsKICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZTsKICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlOwogICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IyID0gdW5kZWZpbmVkOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IyID0gdG9UeXBlTmFtZXNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDI7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWUpIHsKICAgICAgICAgIHZhciB0b1R5cGVOYW1lID0gX3N0ZXAyLnZhbHVlOwoKICAgICAgICAgIC8vIEZpcnN0IGNoZWNrIGlmIHRoZSBjdXJyZW50IHR5cGUgY2FuIGNhc3QgdG8gdGhpcyB0eXBlCiAgICAgICAgICBpZiAoZnJvbVR5cGVEZWYgJiYgZnJvbVR5cGVEZWYuY2FzdHNUbyh0b1R5cGVOYW1lKSkgewogICAgICAgICAgICByZXR1cm4gZnJvbVR5cGVEZWYudG8odmFsdWUsIHRvVHlwZU5hbWUsIHR5cGVzKTsKICAgICAgICAgIH0gLy8gSWYgdGhhdCBpc24ndCBwb3NzaWJsZSwgY2hlY2sgaWYgdGhpcyB0eXBlIGNhbiBjYXN0IGZyb20gdGhlIGN1cnJlbnQgdHlwZQoKCiAgICAgICAgICB2YXIgdG9UeXBlRGVmID0gdHlwZXNbdG9UeXBlTmFtZV07CiAgICAgICAgICBpZiAodG9UeXBlRGVmICYmIHRvVHlwZURlZi5jYXN0c0Zyb20oZnJvbVR5cGVOYW1lKSkgcmV0dXJuIHRvVHlwZURlZi5mcm9tKHZhbHVlLCB0eXBlcyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjIgPSB0cnVlOwogICAgICAgIF9pdGVyYXRvckVycm9yMiA9IGVycjsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiAmJiBfaXRlcmF0b3IyLnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjIucmV0dXJuKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjIpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3IyOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW4gbm90IGNhc3QgJyIuY29uY2F0KGZyb21UeXBlTmFtZSwgIicgdG8gYW55IG9mICciKS5jb25jYXQodG9UeXBlTmFtZXMuam9pbignLCAnKSwgIiciKSk7CiAgICB9IC8vIFByb2Nlc3NlcyB0aGUgbXVsdGktdmFsdWVkIEFTVCBhcmd1bWVudCB2YWx1ZXMgaW50byBhcmd1bWVudHMgdGhhdCBjYW4gYmUgcGFzc2VkIHRvIHRoZSBmdW5jdGlvbgoKICB9LCB7CiAgICBrZXk6ICJyZXNvbHZlQXJncyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3Jlc29sdmVBcmdzID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoZm5EZWYsIGlucHV0LCBhcmdBc3RzKSB7CiAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICAgIHZhciBhcmdEZWZzLCBkZWFsaWFzZWRBcmdBc3RzLCBfaSwgX09iamVjdCR2YWx1ZXMsIGFyZ0RlZiwgYWxpYXNlcywgYXJnRGVmYXVsdCwgYXJnTmFtZSwgcmVxdWlyZWQsIGVycm9yQXJnLCBhcmdBc3RzV2l0aERlZmF1bHRzLCByZXNvbHZlQXJnRm5zLCBhcmdOYW1lcywgcmVzb2x2ZWRBcmdWYWx1ZXMsIHJlc29sdmVkTXVsdGlBcmdzLCByZXNvbHZlZEFyZ3M7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhcmdEZWZzID0gZm5EZWYuYXJnczsgLy8gVXNlIHRoZSBub24tYWxpYXMgbmFtZSBmcm9tIHRoZSBhcmd1bWVudCBkZWZpbml0aW9uCgogICAgICAgICAgICAgICAgZGVhbGlhc2VkQXJnQXN0cyA9ICgwLCBfbG9kYXNoLnJlZHVjZSkoYXJnQXN0cywgZnVuY3Rpb24gKGFjYywgYXJnQXN0LCBhcmdOYW1lKSB7CiAgICAgICAgICAgICAgICAgIHZhciBhcmdEZWYgPSAoMCwgX2dldF9ieV9hbGlhcy5nZXRCeUFsaWFzKShhcmdEZWZzLCBhcmdOYW1lKTsKCiAgICAgICAgICAgICAgICAgIGlmICghYXJnRGVmKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmtub3duIGFyZ3VtZW50ICciLmNvbmNhdChhcmdOYW1lLCAiJyBwYXNzZWQgdG8gZnVuY3Rpb24gJyIpLmNvbmNhdChmbkRlZi5uYW1lLCAiJyIpKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgYWNjW2FyZ0RlZi5uYW1lXSA9IChhY2NbYXJnRGVmLm5hbWVdIHx8IFtdKS5jb25jYXQoYXJnQXN0KTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgICAgICAgICAgIH0sIHt9KTsgLy8gQ2hlY2sgZm9yIG1pc3NpbmcgcmVxdWlyZWQgYXJndW1lbnRzLgoKICAgICAgICAgICAgICAgIF9pID0gMCwgX09iamVjdCR2YWx1ZXMgPSBPYmplY3QudmFsdWVzKGFyZ0RlZnMpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBpZiAoIShfaSA8IF9PYmplY3QkdmFsdWVzLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYXJnRGVmID0gX09iamVjdCR2YWx1ZXNbX2ldOwogICAgICAgICAgICAgICAgYWxpYXNlcyA9IGFyZ0RlZi5hbGlhc2VzLCBhcmdEZWZhdWx0ID0gYXJnRGVmLmRlZmF1bHQsIGFyZ05hbWUgPSBhcmdEZWYubmFtZSwgcmVxdWlyZWQgPSBhcmdEZWYucmVxdWlyZWQ7CgogICAgICAgICAgICAgICAgaWYgKCEodHlwZW9mIGFyZ0RlZmF1bHQgIT09ICd1bmRlZmluZWQnIHx8ICFyZXF1aXJlZCB8fCB0eXBlb2YgZGVhbGlhc2VkQXJnQXN0c1thcmdOYW1lXSAhPT0gJ3VuZGVmaW5lZCcpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoImNvbnRpbnVlIiwgMTIpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBpZiAoISghYWxpYXNlcyB8fCBhbGlhc2VzLmxlbmd0aCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCIiLmNvbmNhdChmbkRlZi5uYW1lLCAiIHJlcXVpcmVzIGFuIGFyZ3VtZW50IikpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgLy8gdXNlIGFuIGFsaWFzIGlmIF8gaXMgdGhlIG1pc3NpbmcgYXJnCiAgICAgICAgICAgICAgICBlcnJvckFyZyA9IGFyZ05hbWUgPT09ICdfJyA/IGFsaWFzZXNbMF0gOiBhcmdOYW1lOwogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCIiLmNvbmNhdChmbkRlZi5uYW1lLCAiIHJlcXVpcmVzIGFuIFwiIikuY29uY2F0KGVycm9yQXJnLCAiXCIgYXJndW1lbnQiKSk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICBfaSsrOwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICAvLyBGaWxsIGluIGRlZmF1bHQgdmFsdWVzIGZyb20gYXJndW1lbnQgZGVmaW5pdGlvbgogICAgICAgICAgICAgICAgYXJnQXN0c1dpdGhEZWZhdWx0cyA9ICgwLCBfbG9kYXNoLnJlZHVjZSkoYXJnRGVmcywgZnVuY3Rpb24gKGFjYywgYXJnRGVmLCBhcmdOYW1lKSB7CiAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYWNjW2FyZ05hbWVdID09PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgYXJnRGVmLmRlZmF1bHQgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICAgICAgICAgICAgYWNjW2FyZ05hbWVdID0gWygwLCBfYXN0LnBhcnNlKShhcmdEZWYuZGVmYXVsdCwgJ2FyZ3VtZW50JyldOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgICAgICAgICAgfSwgZGVhbGlhc2VkQXJnQXN0cyk7IC8vIENyZWF0ZSB0aGUgZnVuY3Rpb25zIHRvIHJlc29sdmUgdGhlIGFyZ3VtZW50IEFTVHMgaW50byB2YWx1ZXMKICAgICAgICAgICAgICAgIC8vIFRoZXNlIGFyZSB3aGF0IGFyZSBwYXNzZWQgdG8gdGhlIGFjdHVhbCBmdW5jdGlvbnMgaWYgeW91IG9wdCBvdXQgb2YgcmVzb2x2aW5nCgogICAgICAgICAgICAgICAgcmVzb2x2ZUFyZ0ZucyA9ICgwLCBfbG9kYXNoLm1hcFZhbHVlcykoYXJnQXN0c1dpdGhEZWZhdWx0cywgZnVuY3Rpb24gKGFzdHMsIGFyZ05hbWUpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGFzdHMubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YklucHV0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc3RlZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FyZ3MzID0gYXJndW1lbnRzOwogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJJbnB1dCA9IF9hcmdzMy5sZW5ndGggPiAwICYmIF9hcmdzM1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MzWzBdIDogaW5wdXQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLnBhcmFtcy5leGVjdXRvci5pbnRlcnByZXQoaXRlbSwgc3ViSW5wdXQsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidWc6IF90aGlzMy5wYXJhbXMuZGVidWcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBfY29udGV4dDMuc2VudDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISgwLCBfZXJyb3IuaXNFeHByZXNzaW9uVmFsdWVFcnJvcikob3V0cHV0KSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG91dHB1dC5lcnJvcjsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzdGVkID0gX3RoaXMzLmNhc3Qob3V0cHV0LCBhcmdEZWZzW2FyZ05hbWVdLnR5cGVzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCBjYXN0ZWQpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGFyZ05hbWVzID0gKDAsIF9sb2Rhc2gua2V5cykocmVzb2x2ZUFyZ0Zucyk7IC8vIEFjdHVhbGx5IHJlc29sdmUgdW5sZXNzIHRoZSBhcmd1bWVudCBkZWZpbml0aW9uIHNheXMgbm90IHRvCgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyMDsKICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChhcmdOYW1lcy5tYXAoZnVuY3Rpb24gKGFyZ05hbWUpIHsKICAgICAgICAgICAgICAgICAgdmFyIGludGVycHJldEZucyA9IHJlc29sdmVBcmdGbnNbYXJnTmFtZV07CiAgICAgICAgICAgICAgICAgIGlmICghYXJnRGVmc1thcmdOYW1lXS5yZXNvbHZlKSByZXR1cm4gaW50ZXJwcmV0Rm5zOwogICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoaW50ZXJwcmV0Rm5zLm1hcChmdW5jdGlvbiAoZm4pIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4oKTsKICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgICAgcmVzb2x2ZWRBcmdWYWx1ZXMgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgIHJlc29sdmVkTXVsdGlBcmdzID0gKDAsIF9sb2Rhc2guemlwT2JqZWN0KShhcmdOYW1lcywgcmVzb2x2ZWRBcmdWYWx1ZXMpOyAvLyBKdXN0IHJldHVybiB0aGUgbGFzdCB1bmxlc3MgdGhlIGFyZ3VtZW50IGRlZmluaXRpb24gYWxsb3dzIG11bHRpcGxlCgogICAgICAgICAgICAgICAgcmVzb2x2ZWRBcmdzID0gKDAsIF9sb2Rhc2gubWFwVmFsdWVzKShyZXNvbHZlZE11bHRpQXJncywgZnVuY3Rpb24gKGFyZ1ZhbHVlcywgYXJnTmFtZSkgewogICAgICAgICAgICAgICAgICBpZiAoYXJnRGVmc1thcmdOYW1lXS5tdWx0aSkgcmV0dXJuIGFyZ1ZhbHVlczsKICAgICAgICAgICAgICAgICAgcmV0dXJuICgwLCBfbG9kYXNoLmxhc3QpKGFyZ1ZhbHVlcyk7CiAgICAgICAgICAgICAgICB9KTsgLy8gUmV0dXJuIGFuIG9iamVjdCBoZXJlIGJlY2F1c2UgdGhlIGFyZ3VtZW50cyB0aGVtc2VsdmVzIG1pZ2h0IGFjdHVhbGx5IGhhdmUgYSAndGhlbicKICAgICAgICAgICAgICAgIC8vIGZ1bmN0aW9uIHdoaWNoIHdvdWxkIGJlIHRyZWF0ZWQgYXMgYSBwcm9taXNlCgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRBcmdzOiByZXNvbHZlZEFyZ3MKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcmVzb2x2ZUFyZ3MoX3g2LCBfeDcsIF94OCkgewogICAgICAgIHJldHVybiBfcmVzb2x2ZUFyZ3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc29sdmVBcmdzOwogICAgfSgpCiAgfV0pOwoKICByZXR1cm4gRXhlY3V0aW9uOwp9KCk7CgpleHBvcnRzLkV4ZWN1dGlvbiA9IEV4ZWN1dGlvbjs="},null]}