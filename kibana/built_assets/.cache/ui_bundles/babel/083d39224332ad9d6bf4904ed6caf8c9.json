{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/plugins/index_management/public/application/components/mappings_editor/lib/mappings_validator.js","dependencies":[{"path":"x-pack/plugins/index_management/public/application/components/mappings_editor/lib/mappings_validator.js","mtime":1589249554124},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlZBTElEX01BUFBJTkdTX1BBUkFNRVRFUlMgPSBleHBvcnRzLnZhbGlkYXRlTWFwcGluZ3MgPSBleHBvcnRzLnZhbGlkYXRlTWFwcGluZ3NDb25maWd1cmF0aW9uID0gZXhwb3J0cy5tYXBwaW5nc0NvbmZpZ3VyYXRpb25TY2hlbWEgPSBleHBvcnRzLnZhbGlkYXRlUHJvcGVydGllcyA9IHZvaWQgMDsKCnZhciBfbG9kYXNoID0gcmVxdWlyZSgibG9kYXNoIik7Cgp2YXIgdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoImlvLXRzIikpOwoKdmFyIF9PcmQgPSByZXF1aXJlKCJmcC10cy9saWIvT3JkIik7Cgp2YXIgX1NldCA9IHJlcXVpcmUoImZwLXRzL2xpYi9TZXQiKTsKCnZhciBfRWl0aGVyID0gcmVxdWlyZSgiZnAtdHMvbGliL0VpdGhlciIpOwoKdmFyIF9lcnJvcl9yZXBvcnRlciA9IHJlcXVpcmUoIi4vZXJyb3JfcmVwb3J0ZXIiKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi4vY29uc3RhbnRzIik7Cgp2YXIgX3V0aWxzID0gcmVxdWlyZSgiLi91dGlscyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoc291cmNlLCBleGNsdWRlZCkgewogIGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9OwoKICB2YXIgdGFyZ2V0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2Uoc291cmNlLCBleGNsdWRlZCk7CgogIHZhciBrZXksIGk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc291cmNlU3ltYm9sS2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc291cmNlKTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgc291cmNlU3ltYm9sS2V5cy5sZW5ndGg7IGkrKykgewogICAgICBrZXkgPSBzb3VyY2VTeW1ib2xLZXlzW2ldOwogICAgICBpZiAoZXhjbHVkZWQuaW5kZXhPZihrZXkpID49IDApIGNvbnRpbnVlOwogICAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzb3VyY2UsIGtleSkpIGNvbnRpbnVlOwogICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2Uoc291cmNlLCBleGNsdWRlZCkgewogIGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9OwogIHZhciB0YXJnZXQgPSB7fTsKICB2YXIgc291cmNlS2V5cyA9IE9iamVjdC5rZXlzKHNvdXJjZSk7CiAgdmFyIGtleSwgaTsKCiAgZm9yIChpID0gMDsgaSA8IHNvdXJjZUtleXMubGVuZ3RoOyBpKyspIHsKICAgIGtleSA9IHNvdXJjZUtleXNbaV07CiAgICBpZiAoZXhjbHVkZWQuaW5kZXhPZihrZXkpID49IDApIGNvbnRpbnVlOwogICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsKICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsKICByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgewogIHZhciBfYXJyID0gW107CiAgdmFyIF9uID0gdHJ1ZTsKICB2YXIgX2QgPSBmYWxzZTsKICB2YXIgX2UgPSB1bmRlZmluZWQ7CgogIHRyeSB7CiAgICBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7CiAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7CgogICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfZCA9IHRydWU7CiAgICBfZSA9IGVycjsKICB9IGZpbmFsbHkgewogICAgdHJ5IHsKICAgICAgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBpZiAoX2QpIHRocm93IF9lOwogICAgfQogIH0KCiAgcmV0dXJuIF9hcnI7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOwp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCnZhciBBTExPV0VEX0ZJRUxEX1BST1BFUlRJRVMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KE9iamVjdC5rZXlzKF9jb25zdGFudHMuUEFSQU1FVEVSU19ERUZJTklUSU9OKSksIFsndHlwZScsICdwcm9wZXJ0aWVzJywgJ2ZpZWxkcyddKTsKdmFyIERFRkFVTFRfRklFTERfVFlQRSA9ICdvYmplY3QnOwoKdmFyIHZhbGlkYXRlRmllbGRUeXBlID0gZnVuY3Rpb24gdmFsaWRhdGVGaWVsZFR5cGUodHlwZSkgewogIGlmICh0eXBlb2YgdHlwZSAhPT0gJ3N0cmluZycpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGlmICghX2NvbnN0YW50cy5BTExfREFUQV9UWVBFUy5pbmNsdWRlcyh0eXBlKSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgcmV0dXJuIHRydWU7Cn07Cgp2YXIgdmFsaWRhdGVQYXJhbWV0ZXIgPSBmdW5jdGlvbiB2YWxpZGF0ZVBhcmFtZXRlcihwYXJhbWV0ZXIsIHZhbHVlKSB7CiAgaWYgKHBhcmFtZXRlciA9PT0gJ3R5cGUnKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGlmIChwYXJhbWV0ZXIgPT09ICduYW1lJykgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgaWYgKHBhcmFtZXRlciA9PT0gJ3Byb3BlcnRpZXMnIHx8IHBhcmFtZXRlciA9PT0gJ2ZpZWxkcycpIHsKICAgIHJldHVybiAoMCwgX2xvZGFzaC5pc1BsYWluT2JqZWN0KSh2YWx1ZSk7CiAgfQoKICB2YXIgcGFyYW1ldGVyU2NoZW1hID0gX2NvbnN0YW50cy5QQVJBTUVURVJTX0RFRklOSVRJT05bcGFyYW1ldGVyXS5zY2hlbWE7CgogIGlmIChwYXJhbWV0ZXJTY2hlbWEpIHsKICAgIHJldHVybiAoMCwgX0VpdGhlci5pc1JpZ2h0KShwYXJhbWV0ZXJTY2hlbWEuZGVjb2RlKHZhbHVlKSk7CiAgfSAvLyBGYWxsYmFjaywgaWYgbm8gc2NoZW1hIGRlZmluZWQgZm9yIHRoZSBwYXJhbWV0ZXIgKHRoaXMgc2hvdWxkIG5vdCBoYXBwZW4gaW4gdGhlb3J5KQoKCiAgcmV0dXJuIHRydWU7Cn07Cgp2YXIgc3RyaXBVbmtub3duT3JJbnZhbGlkUGFyYW1ldGVyID0gZnVuY3Rpb24gc3RyaXBVbmtub3duT3JJbnZhbGlkUGFyYW1ldGVyKGZpZWxkKSB7CiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKGZpZWxkKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgX3JlZikgewogICAgdmFyIF9yZWYyID0gX3NsaWNlZFRvQXJyYXkoX3JlZiwgMiksCiAgICAgICAga2V5ID0gX3JlZjJbMF0sCiAgICAgICAgdmFsdWUgPSBfcmVmMlsxXTsKCiAgICBpZiAoIUFMTE9XRURfRklFTERfUFJPUEVSVElFUy5pbmNsdWRlcyhrZXkpIHx8ICF2YWxpZGF0ZVBhcmFtZXRlcihrZXksIHZhbHVlKSkgewogICAgICBhY2MucGFyYW1ldGVyc1JlbW92ZWQucHVzaChrZXkpOwogICAgfSBlbHNlIHsKICAgICAgdmFyIF9hY2MkdmFsdWU7CgogICAgICBhY2MudmFsdWUgPSAoX2FjYyR2YWx1ZSA9IGFjYy52YWx1ZSkgIT09IG51bGwgJiYgX2FjYyR2YWx1ZSAhPT0gdm9pZCAwID8gX2FjYyR2YWx1ZSA6IHt9OwogICAgICBhY2MudmFsdWVba2V5XSA9IHZhbHVlOwogICAgfQoKICAgIHJldHVybiBhY2M7CiAgfSwgewogICAgcGFyYW1ldGVyc1JlbW92ZWQ6IFtdCiAgfSk7Cn07Cgp2YXIgcGFyc2VGaWVsZCA9IGZ1bmN0aW9uIHBhcnNlRmllbGQoZmllbGQpIHsKICB2YXIgX2ZpZWxkJHR5cGU7IC8vIFNhbml0aXplIHRoZSBpbnB1dCB0byBtYWtlIHN1cmUgd2UgYXJlIHdvcmtpbmcgd2l0aCBhbiBvYmplY3QKCgogIGlmICghKDAsIF9sb2Rhc2guaXNQbGFpbk9iamVjdCkoZmllbGQpKSB7CiAgICByZXR1cm4gewogICAgICBwYXJhbWV0ZXJzUmVtb3ZlZDogW10KICAgIH07CiAgfSAvLyBNYWtlIHN1cmUgdGhlIGZpZWxkICJ0eXBlIiBpcyB2YWxpZAoKCiAgaWYgKCF2YWxpZGF0ZUZpZWxkVHlwZSgoX2ZpZWxkJHR5cGUgPSBmaWVsZC50eXBlKSAhPT0gbnVsbCAmJiBfZmllbGQkdHlwZSAhPT0gdm9pZCAwID8gX2ZpZWxkJHR5cGUgOiBERUZBVUxUX0ZJRUxEX1RZUEUpKSB7CiAgICByZXR1cm4gewogICAgICBwYXJhbWV0ZXJzUmVtb3ZlZDogW10KICAgIH07CiAgfSAvLyBGaWx0ZXIgb3V0IHVua25vd24gb3IgaW52YWxpZCAicGFyYW1ldGVycyIKCgogIHZhciBmaWVsZFdpdGhUeXBlID0gX29iamVjdFNwcmVhZCh7CiAgICB0eXBlOiBERUZBVUxUX0ZJRUxEX1RZUEUKICB9LCBmaWVsZCk7CgogIHZhciBwYXJzZWRGaWVsZCA9IHN0cmlwVW5rbm93bk9ySW52YWxpZFBhcmFtZXRlcihmaWVsZFdpdGhUeXBlKTsKICB2YXIgbWV0YSA9ICgwLCBfdXRpbHMuZ2V0RmllbGRNZXRhKShmaWVsZFdpdGhUeXBlKTsKICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgcGFyc2VkRmllbGQsIHsKICAgIG1ldGE6IG1ldGEKICB9KTsKfTsKCnZhciBwYXJzZUZpZWxkcyA9IGZ1bmN0aW9uIHBhcnNlRmllbGRzKHByb3BlcnRpZXMpIHsKICB2YXIgcGF0aCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogW107CiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHByb3BlcnRpZXMpLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBfcmVmMykgewogICAgdmFyIF9yZWY0ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjMsIDIpLAogICAgICAgIGZpZWxkTmFtZSA9IF9yZWY0WzBdLAogICAgICAgIHVucGFyc2VkRmllbGQgPSBfcmVmNFsxXTsKCiAgICB2YXIgZmllbGRQYXRoID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShwYXRoKSwgW2ZpZWxkTmFtZV0pLmpvaW4oJy4nKTsKCiAgICB2YXIgX3BhcnNlRmllbGQgPSBwYXJzZUZpZWxkKHVucGFyc2VkRmllbGQpLAogICAgICAgIHBhcnNlZEZpZWxkID0gX3BhcnNlRmllbGQudmFsdWUsCiAgICAgICAgcGFyYW1ldGVyc1JlbW92ZWQgPSBfcGFyc2VGaWVsZC5wYXJhbWV0ZXJzUmVtb3ZlZCwKICAgICAgICBtZXRhID0gX3BhcnNlRmllbGQubWV0YTsKCiAgICBpZiAocGFyc2VkRmllbGQgPT09IHVuZGVmaW5lZCkgewogICAgICAvLyBGaWVsZCBoYXMgYmVlbiBzdHJpcHBlZCBvdXQgYmVjYXVzZSBpdCB3YXMgaW52YWxpZAogICAgICBhY2MuZXJyb3JzLnB1c2goewogICAgICAgIGNvZGU6ICdFUlJfRklFTEQnLAogICAgICAgIGZpZWxkUGF0aDogZmllbGRQYXRoCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgaWYgKG1ldGEuaGFzQ2hpbGRGaWVsZHMgfHwgbWV0YS5oYXNNdWx0aUZpZWxkcykgewogICAgICAgIC8vIFJlY3Vyc2l2ZWx5IHBhcnNlIGFsbCB0aGUgcG9zc2libGUgY2hpbGRyZW4gKCJwcm9wZXJ0aWVzIiBvciAiZmllbGRzIiBmb3IgbXVsdGktZmllbGRzKQogICAgICAgIHZhciBwYXJzZWRDaGlsZHJlbiA9IHBhcnNlRmllbGRzKHBhcnNlZEZpZWxkW21ldGEuY2hpbGRGaWVsZHNOYW1lXSwgW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShwYXRoKSwgW2ZpZWxkTmFtZV0pKTsKICAgICAgICBwYXJzZWRGaWVsZFttZXRhLmNoaWxkRmllbGRzTmFtZV0gPSBwYXJzZWRDaGlsZHJlbi52YWx1ZTsKICAgICAgICAvKioKICAgICAgICAgKiBJZiB0aGUgY2hpbGRyZW4gcGFyc2VkIGhhdmUgYW55IGVycm9yIHdlIGNvbmNhdGVuYXRlIHRoZW0gaW4gb3VyIGFjY3VtdWxhdG9yLgogICAgICAgICAqLwoKICAgICAgICBpZiAocGFyc2VkQ2hpbGRyZW4uZXJyb3JzKSB7CiAgICAgICAgICBhY2MuZXJyb3JzID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShhY2MuZXJyb3JzKSwgX3RvQ29uc3VtYWJsZUFycmF5KHBhcnNlZENoaWxkcmVuLmVycm9ycykpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgYWNjLnZhbHVlW2ZpZWxkTmFtZV0gPSBwYXJzZWRGaWVsZDsKCiAgICAgIGlmIChCb29sZWFuKHBhcmFtZXRlcnNSZW1vdmVkLmxlbmd0aCkpIHsKICAgICAgICBhY2MuZXJyb3JzID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShhY2MuZXJyb3JzKSwgX3RvQ29uc3VtYWJsZUFycmF5KHBhcmFtZXRlcnNSZW1vdmVkLm1hcChmdW5jdGlvbiAocGFyYW1OYW1lKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBjb2RlOiAnRVJSX1BBUkFNRVRFUicsCiAgICAgICAgICAgIGZpZWxkUGF0aDogZmllbGRQYXRoLAogICAgICAgICAgICBwYXJhbU5hbWU6IHBhcmFtTmFtZQogICAgICAgICAgfTsKICAgICAgICB9KSkpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGFjYzsKICB9LCB7CiAgICB2YWx1ZToge30sCiAgICBlcnJvcnM6IFtdCiAgfSk7Cn07Ci8qKgogKiBVdGlsaXR5IGZ1bmN0aW9uIHRoYXQgcmVhZHMgYSBtYXBwaW5ncyAicHJvcGVydGllcyIgb2JqZWN0IGFuZCB2YWxpZGF0ZSBpdHMgZmllbGRzIGJ5CiAqIC0gUmVtb3ZpbmcgdW5rbm93biBmaWVsZCB0eXBlcwogKiAtIFJlbW92aW5nIHVua25vd24gZmllbGQgcGFyYW1ldGVycyBvciBmaWVsZCBwYXJhbWV0ZXJzIHRoYXQgZG9uJ3QgaGF2ZSB0aGUgY29ycmVjdCBmb3JtYXQuCiAqCiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IG11dGF0ZSB0aGUgb3JpZ2luYWwgcHJvcGVydGllcyBvYmplY3QuIEl0IHJldHVybnMgYW4gb2JqZWN0IHdpdGgKICogdGhlIHBhcnNlZCBwcm9wZXJ0aWVzIGFuZCBhbiBhcnJheSBvZiBmaWVsZCBwYXRocyB0aGF0IGhhdmUgYmVlbiByZW1vdmVkLgogKiBUaGlzIGFsbG93cyB1cyB0byBkaXNwbGF5IGEgd2FybmluZyBpbiB0aGUgVUkgYW5kIGxldCB0aGUgdXNlciBjb3JyZWN0IHRoZSBmaWVsZHMgdGhhdCB3ZQogKiBhcmUgYWJvdXQgdG8gcmVtb3ZlLgogKgogKiBOT1RFOiBUaGUgSm9pIFNjaGVtYSB0aGF0IHdlIGRlZmluZWQgZm9yIGVhY2ggcGFyYW1ldGVyIChpbiAicGFyYW1ldGVyc19kZWZpbml0aW9uIi50c3gpCiAqIGRvZXMgbm90IGRvIGFuIGV4aGF1c3RpdmUgdmFsaWRhdGlvbiBvZiB0aGUgcGFyYW1ldGVyIHZhbHVlLgogKiBJdCdzIG1haW4gcHVycG9zZSBpcyB0byBwcmV2ZW50IHRoZSBVSSBmcm9tIGJsb3dpbmcgdXAuCiAqCiAqIEBwYXJhbSBwcm9wZXJ0aWVzIEEgbWFwcGluZ3MgInByb3BlcnRpZXMiIG9iamVjdAogKi8KCgp2YXIgdmFsaWRhdGVQcm9wZXJ0aWVzID0gZnVuY3Rpb24gdmFsaWRhdGVQcm9wZXJ0aWVzKCkgewogIHZhciBwcm9wZXJ0aWVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsgLy8gU2FuaXRpemUgdGhlIGlucHV0IHRvIG1ha2Ugc3VyZSB3ZSBhcmUgd29ya2luZyB3aXRoIGFuIG9iamVjdAoKICBpZiAoISgwLCBfbG9kYXNoLmlzUGxhaW5PYmplY3QpKHByb3BlcnRpZXMpKSB7CiAgICByZXR1cm4gewogICAgICB2YWx1ZToge30sCiAgICAgIGVycm9yczogW10KICAgIH07CiAgfQoKICByZXR1cm4gcGFyc2VGaWVsZHMocHJvcGVydGllcyk7Cn07Ci8qKgogKiBTaW5nbGUgc291cmNlIG9mIHRydXRoIHRvIHZhbGlkYXRlIHRoZSAqY29uZmlndXJhdGlvbiogb2YgdGhlIG1hcHBpbmdzLgogKiBXaGVuZXZlciBhIHVzZXIgbG9hZHMgYSBKU09OIG9iamVjdCBpdCB3aWxsIGJlIHZhbGlkYXRlIGFnYWluc3QgdGhpcyBKb2kgc2NoZW1hLgogKi8KCgpleHBvcnRzLnZhbGlkYXRlUHJvcGVydGllcyA9IHZhbGlkYXRlUHJvcGVydGllczsKdmFyIG1hcHBpbmdzQ29uZmlndXJhdGlvblNjaGVtYSA9IHQuZXhhY3QodC5wYXJ0aWFsKHsKICBkeW5hbWljOiB0LnVuaW9uKFt0LmxpdGVyYWwodHJ1ZSksIHQubGl0ZXJhbChmYWxzZSksIHQubGl0ZXJhbCgnc3RyaWN0JyldKSwKICBkYXRlX2RldGVjdGlvbjogdC5ib29sZWFuLAogIG51bWVyaWNfZGV0ZWN0aW9uOiB0LmJvb2xlYW4sCiAgZHluYW1pY19kYXRlX2Zvcm1hdHM6IHQuYXJyYXkodC5zdHJpbmcpLAogIF9zb3VyY2U6IHQuZXhhY3QodC5wYXJ0aWFsKHsKICAgIGVuYWJsZWQ6IHQuYm9vbGVhbiwKICAgIGluY2x1ZGVzOiB0LmFycmF5KHQuc3RyaW5nKSwKICAgIGV4Y2x1ZGVzOiB0LmFycmF5KHQuc3RyaW5nKQogIH0pKSwKICBfbWV0YTogdC5Vbmtub3duUmVjb3JkLAogIF9yb3V0aW5nOiB0LmludGVyZmFjZSh7CiAgICByZXF1aXJlZDogdC5ib29sZWFuCiAgfSkKfSkpOwpleHBvcnRzLm1hcHBpbmdzQ29uZmlndXJhdGlvblNjaGVtYSA9IG1hcHBpbmdzQ29uZmlndXJhdGlvblNjaGVtYTsKdmFyIG1hcHBpbmdzQ29uZmlndXJhdGlvblNjaGVtYUtleXMgPSBPYmplY3Qua2V5cyhtYXBwaW5nc0NvbmZpZ3VyYXRpb25TY2hlbWEudHlwZS5wcm9wcyk7CnZhciBzb3VyY2VDb25maWd1cmF0aW9uU2NoZW1hS2V5cyA9IE9iamVjdC5rZXlzKG1hcHBpbmdzQ29uZmlndXJhdGlvblNjaGVtYS50eXBlLnByb3BzLl9zb3VyY2UudHlwZS5wcm9wcyk7Cgp2YXIgdmFsaWRhdGVNYXBwaW5nc0NvbmZpZ3VyYXRpb24gPSBmdW5jdGlvbiB2YWxpZGF0ZU1hcHBpbmdzQ29uZmlndXJhdGlvbihtYXBwaW5nc0NvbmZpZ3VyYXRpb24pIHsKICAvLyBTZXQgdG8ga2VlcCB0cmFjayBvZiBpbnZhbGlkIGNvbmZpZ3VyYXRpb24gcGFyYW1ldGVycy4KICB2YXIgY29uZmlndXJhdGlvblJlbW92ZWQgPSBuZXcgU2V0KCk7CgogIHZhciBjb3B5T2ZNYXBwaW5nc0NvbmZpZyA9IF9vYmplY3RTcHJlYWQoe30sIG1hcHBpbmdzQ29uZmlndXJhdGlvbik7CgogIHZhciByZXN1bHQgPSBtYXBwaW5nc0NvbmZpZ3VyYXRpb25TY2hlbWEuZGVjb2RlKG1hcHBpbmdzQ29uZmlndXJhdGlvbik7CiAgdmFyIGlzU2NoZW1hSW52YWxpZCA9ICgwLCBfRWl0aGVyLmlzTGVmdCkocmVzdWx0KTsKICB2YXIgdW5rbm93bkNvbmZpZ3VyYXRpb25QYXJhbWV0ZXJzID0gT2JqZWN0LmtleXMobWFwcGluZ3NDb25maWd1cmF0aW9uKS5maWx0ZXIoZnVuY3Rpb24gKGtleSkgewogICAgcmV0dXJuIG1hcHBpbmdzQ29uZmlndXJhdGlvblNjaGVtYUtleXMuaW5jbHVkZXMoa2V5KSA9PT0gZmFsc2U7CiAgfSk7CiAgdmFyIHVua25vd25Tb3VyY2VDb25maWd1cmF0aW9uUGFyYW1ldGVycyA9IG1hcHBpbmdzQ29uZmlndXJhdGlvbi5fc291cmNlICE9PSB1bmRlZmluZWQgPyBPYmplY3Qua2V5cyhtYXBwaW5nc0NvbmZpZ3VyYXRpb24uX3NvdXJjZSkuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsKICAgIHJldHVybiBzb3VyY2VDb25maWd1cmF0aW9uU2NoZW1hS2V5cy5pbmNsdWRlcyhrZXkpID09PSBmYWxzZTsKICB9KSA6IFtdOwoKICBpZiAoaXNTY2hlbWFJbnZhbGlkKSB7CiAgICAvKioKICAgICAqIFRvIGtlZXAgdGhlIGxvZ2ljIHNpbXBsZSB3ZSB3aWxsIHN0cmlwIG91dCB0aGUgcGFyYW1ldGVycyB0aGF0IGNvbnRhaW4gZXJyb3JzCiAgICAgKi8KICAgIHZhciBfZXJyb3JzID0gX2Vycm9yX3JlcG9ydGVyLmVycm9yUmVwb3J0ZXIucmVwb3J0KHJlc3VsdCk7CgogICAgX2Vycm9ycy5mb3JFYWNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICB2YXIgY29uZmlndXJhdGlvbk5hbWUgPSBlcnJvci5wYXRoWzBdOwogICAgICBjb25maWd1cmF0aW9uUmVtb3ZlZC5hZGQoY29uZmlndXJhdGlvbk5hbWUpOwogICAgICBkZWxldGUgY29weU9mTWFwcGluZ3NDb25maWdbY29uZmlndXJhdGlvbk5hbWVdOwogICAgfSk7CiAgfQoKICBpZiAodW5rbm93bkNvbmZpZ3VyYXRpb25QYXJhbWV0ZXJzLmxlbmd0aCA+IDApIHsKICAgIHVua25vd25Db25maWd1cmF0aW9uUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uIChjb25maWdOYW1lKSB7CiAgICAgIHJldHVybiBjb25maWd1cmF0aW9uUmVtb3ZlZC5hZGQoY29uZmlnTmFtZSk7CiAgICB9KTsKICB9CgogIGlmICh1bmtub3duU291cmNlQ29uZmlndXJhdGlvblBhcmFtZXRlcnMubGVuZ3RoID4gMCkgewogICAgY29uZmlndXJhdGlvblJlbW92ZWQuYWRkKCdfc291cmNlJyk7CiAgICBkZWxldGUgY29weU9mTWFwcGluZ3NDb25maWcuX3NvdXJjZTsKICB9CgogIGNvcHlPZk1hcHBpbmdzQ29uZmlnID0gKDAsIF9sb2Rhc2gucGljaykoY29weU9mTWFwcGluZ3NDb25maWcsIG1hcHBpbmdzQ29uZmlndXJhdGlvblNjaGVtYUtleXMpOwogIHZhciBlcnJvcnMgPSAoMCwgX1NldC50b0FycmF5KShfT3JkLm9yZFN0cmluZykoY29uZmlndXJhdGlvblJlbW92ZWQpLm1hcChmdW5jdGlvbiAoY29uZmlnTmFtZSkgewogICAgcmV0dXJuIHsKICAgICAgY29kZTogJ0VSUl9DT05GSUcnLAogICAgICBjb25maWdOYW1lOiBjb25maWdOYW1lCiAgICB9OwogIH0pLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgIHJldHVybiBhLmNvbmZpZ05hbWUubG9jYWxlQ29tcGFyZShiLmNvbmZpZ05hbWUpOwogIH0pOwogIHJldHVybiB7CiAgICB2YWx1ZTogY29weU9mTWFwcGluZ3NDb25maWcsCiAgICBlcnJvcnM6IGVycm9ycwogIH07Cn07CgpleHBvcnRzLnZhbGlkYXRlTWFwcGluZ3NDb25maWd1cmF0aW9uID0gdmFsaWRhdGVNYXBwaW5nc0NvbmZpZ3VyYXRpb247Cgp2YXIgdmFsaWRhdGVNYXBwaW5ncyA9IGZ1bmN0aW9uIHZhbGlkYXRlTWFwcGluZ3MoKSB7CiAgdmFyIG1hcHBpbmdzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKCiAgaWYgKCEoMCwgX2xvZGFzaC5pc1BsYWluT2JqZWN0KShtYXBwaW5ncykpIHsKICAgIHJldHVybiB7CiAgICAgIHZhbHVlOiB7fQogICAgfTsKICB9CgogIHZhciBwcm9wZXJ0aWVzID0gbWFwcGluZ3MucHJvcGVydGllcywKICAgICAgZHluYW1pY1RlbXBsYXRlcyA9IG1hcHBpbmdzLmR5bmFtaWNfdGVtcGxhdGVzLAogICAgICBtYXBwaW5nc0NvbmZpZ3VyYXRpb24gPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMobWFwcGluZ3MsIFsicHJvcGVydGllcyIsICJkeW5hbWljX3RlbXBsYXRlcyJdKTsKCiAgdmFyIF92YWxpZGF0ZU1hcHBpbmdzQ29uZiA9IHZhbGlkYXRlTWFwcGluZ3NDb25maWd1cmF0aW9uKG1hcHBpbmdzQ29uZmlndXJhdGlvbiksCiAgICAgIHBhcnNlZENvbmZpZ3VyYXRpb24gPSBfdmFsaWRhdGVNYXBwaW5nc0NvbmYudmFsdWUsCiAgICAgIGNvbmZpZ3VyYXRpb25FcnJvcnMgPSBfdmFsaWRhdGVNYXBwaW5nc0NvbmYuZXJyb3JzOwoKICB2YXIgX3ZhbGlkYXRlUHJvcGVydGllcyA9IHZhbGlkYXRlUHJvcGVydGllcyhwcm9wZXJ0aWVzKSwKICAgICAgcGFyc2VkUHJvcGVydGllcyA9IF92YWxpZGF0ZVByb3BlcnRpZXMudmFsdWUsCiAgICAgIHByb3BlcnRpZXNFcnJvcnMgPSBfdmFsaWRhdGVQcm9wZXJ0aWVzLmVycm9yczsKCiAgdmFyIGVycm9ycyA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoY29uZmlndXJhdGlvbkVycm9ycyksIF90b0NvbnN1bWFibGVBcnJheShwcm9wZXJ0aWVzRXJyb3JzKSk7CiAgcmV0dXJuIHsKICAgIHZhbHVlOiBfb2JqZWN0U3ByZWFkKHt9LCBwYXJzZWRDb25maWd1cmF0aW9uLCB7CiAgICAgIHByb3BlcnRpZXM6IHBhcnNlZFByb3BlcnRpZXMsCiAgICAgIGR5bmFtaWNfdGVtcGxhdGVzOiBkeW5hbWljVGVtcGxhdGVzICE9PSBudWxsICYmIGR5bmFtaWNUZW1wbGF0ZXMgIT09IHZvaWQgMCA/IGR5bmFtaWNUZW1wbGF0ZXMgOiBbXQogICAgfSksCiAgICBlcnJvcnM6IGVycm9ycy5sZW5ndGggPyBlcnJvcnMgOiB1bmRlZmluZWQKICB9Owp9OwoKZXhwb3J0cy52YWxpZGF0ZU1hcHBpbmdzID0gdmFsaWRhdGVNYXBwaW5nczsKdmFyIFZBTElEX01BUFBJTkdTX1BBUkFNRVRFUlMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KG1hcHBpbmdzQ29uZmlndXJhdGlvblNjaGVtYUtleXMpLCBbJ2R5bmFtaWNfdGVtcGxhdGVzJywgJ3Byb3BlcnRpZXMnXSk7CmV4cG9ydHMuVkFMSURfTUFQUElOR1NfUEFSQU1FVEVSUyA9IFZBTElEX01BUFBJTkdTX1BBUkFNRVRFUlM7"},null]}