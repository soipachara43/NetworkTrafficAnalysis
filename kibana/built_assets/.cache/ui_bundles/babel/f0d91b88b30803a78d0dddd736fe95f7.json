{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/canvas/public/expression_types/function_form.js","dependencies":[{"path":"x-pack/legacy/plugins/canvas/public/expression_types/function_form.js","mtime":1589249552035},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkZ1bmN0aW9uRm9ybSA9IHZvaWQgMDsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfbG9kYXNoID0gcmVxdWlyZSgibG9kYXNoIik7Cgp2YXIgX2NvbW1vbiA9IHJlcXVpcmUoIkBrYm4vaW50ZXJwcmV0ZXIvY29tbW9uIik7Cgp2YXIgX2FyZ19hZGRfcG9wb3ZlciA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvYXJnX2FkZF9wb3BvdmVyIik7Cgp2YXIgX3NpZGViYXJfc2VjdGlvbiA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvc2lkZWJhci9zaWRlYmFyX3NlY3Rpb24iKTsKCnZhciBfc2lkZWJhcl9zZWN0aW9uX3RpdGxlID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9zaWRlYmFyL3NpZGViYXJfc2VjdGlvbl90aXRsZSIpOwoKdmFyIF9iYXNlX2Zvcm0gPSByZXF1aXJlKCIuL2Jhc2VfZm9ybSIpOwoKdmFyIF9hcmcgPSByZXF1aXJlKCIuL2FyZyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKZnVuY3Rpb24gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKHNvdXJjZSwgZXhjbHVkZWQpIHsgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307IHZhciB0YXJnZXQgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKTsgdmFyIGtleSwgaTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHNvdXJjZVN5bWJvbEtleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHNvdXJjZSk7IGZvciAoaSA9IDA7IGkgPCBzb3VyY2VTeW1ib2xLZXlzLmxlbmd0aDsgaSsrKSB7IGtleSA9IHNvdXJjZVN5bWJvbEtleXNbaV07IGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7IGlmICghT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHNvdXJjZSwga2V5KSkgY29udGludWU7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7IGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9OyB2YXIgdGFyZ2V0ID0ge307IHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTsgdmFyIGtleSwgaTsgZm9yIChpID0gMDsgaSA8IHNvdXJjZUtleXMubGVuZ3RoOyBpKyspIHsga2V5ID0gc291cmNlS2V5c1tpXTsgaWYgKGV4Y2x1ZGVkLmluZGV4T2Yoa2V5KSA+PSAwKSBjb250aW51ZTsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKdmFyIEZ1bmN0aW9uRm9ybSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9CYXNlRm9ybSkgewogIF9pbmhlcml0cyhGdW5jdGlvbkZvcm0sIF9CYXNlRm9ybSk7CgogIGZ1bmN0aW9uIEZ1bmN0aW9uRm9ybShwcm9wcykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGdW5jdGlvbkZvcm0pOwoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKEZ1bmN0aW9uRm9ybSkuY2FsbCh0aGlzLCBfb2JqZWN0U3ByZWFkKHt9LCBwcm9wcykpKTsKICAgIF90aGlzLmFyZ3MgPSBwcm9wcy5hcmdzIHx8IFtdOwoKICAgIF90aGlzLnJlc29sdmUgPSBwcm9wcy5yZXNvbHZlIHx8IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHt9OwogICAgfTsKCiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRnVuY3Rpb25Gb3JtLCBbewogICAga2V5OiAicmVuZGVyQXJnIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJBcmcocHJvcHMsIGRhdGFBcmcpIHsKICAgICAgdmFyIG9uVmFsdWVSZW1vdmUgPSBwcm9wcy5vblZhbHVlUmVtb3ZlLAogICAgICAgICAgb25WYWx1ZUNoYW5nZSA9IHByb3BzLm9uVmFsdWVDaGFuZ2UsCiAgICAgICAgICBwYXNzZWRQcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhwcm9wcywgWyJvblZhbHVlUmVtb3ZlIiwgIm9uVmFsdWVDaGFuZ2UiXSk7CgogICAgICB2YXIgYXJnID0gZGF0YUFyZy5hcmcsCiAgICAgICAgICBhcmdWYWx1ZXMgPSBkYXRhQXJnLmFyZ1ZhbHVlcywKICAgICAgICAgIHNraXBSZW5kZXIgPSBkYXRhQXJnLnNraXBSZW5kZXIsCiAgICAgICAgICBsYWJlbCA9IGRhdGFBcmcubGFiZWw7CiAgICAgIHZhciBhcmdUeXBlID0gcGFzc2VkUHJvcHMuYXJnVHlwZSwKICAgICAgICAgIGV4cHJlc3Npb25JbmRleCA9IHBhc3NlZFByb3BzLmV4cHJlc3Npb25JbmRleDsgLy8gVE9ETzogc2hvdyBzb21lIGluZm9ybWF0aW9uIHRvIHRoZSB1c2VyIHRoYW4gYW4gYXJndW1lbnQgd2FzIHNraXBwZWQKCiAgICAgIGlmICghYXJnIHx8IHNraXBSZW5kZXIpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFyIHJlbmRlckFyZ1dpdGhQcm9wcyA9IGZ1bmN0aW9uIHJlbmRlckFyZ1dpdGhQcm9wcyhhcmdWYWx1ZSwgdmFsdWVJbmRleCkgewogICAgICAgIHJldHVybiBhcmcucmVuZGVyKF9vYmplY3RTcHJlYWQoewogICAgICAgICAga2V5OiAiIi5jb25jYXQoYXJnVHlwZSwgIi0iKS5jb25jYXQoZXhwcmVzc2lvbkluZGV4LCAiLSIpLmNvbmNhdChhcmcubmFtZSwgIi0iKS5jb25jYXQodmFsdWVJbmRleCkKICAgICAgICB9LCBwYXNzZWRQcm9wcywgewogICAgICAgICAgbGFiZWw6IGxhYmVsLAogICAgICAgICAgdmFsdWVJbmRleDogdmFsdWVJbmRleCwKICAgICAgICAgIGFyZ1ZhbHVlOiBhcmdWYWx1ZSwKICAgICAgICAgIG9uVmFsdWVDaGFuZ2U6IG9uVmFsdWVDaGFuZ2UoYXJnLm5hbWUsIHZhbHVlSW5kZXgpLAogICAgICAgICAgb25WYWx1ZVJlbW92ZTogb25WYWx1ZVJlbW92ZShhcmcubmFtZSwgdmFsdWVJbmRleCkKICAgICAgICB9KSk7CiAgICAgIH07IC8vIHJlbmRlciB0aGUgYXJndW1lbnQncyB0ZW1wbGF0ZSwgd3JhcHBlZCBpbiBhIHJlbW92ZSBjb250cm9sCiAgICAgIC8vIGlmIHRoZSBhcmd1bWVudCBpcyByZXF1aXJlZCBidXQgbm90IGluY2x1ZGVkLCByZW5kZXIgdGhlIGNvbnRyb2wgYW55d2F5CgoKICAgICAgaWYgKCFhcmdWYWx1ZXMgJiYgYXJnLnJlcXVpcmVkKSB7CiAgICAgICAgcmV0dXJuIHJlbmRlckFyZ1dpdGhQcm9wcyh7CiAgICAgICAgICB0eXBlOiB1bmRlZmluZWQsCiAgICAgICAgICB2YWx1ZTogJycKICAgICAgICB9LCAwKTsKICAgICAgfSAvLyByZW5kZXIgYWxsIGluY2x1ZGVkIGFyZ3VtZW50IGNvbnRyb2xzCgoKICAgICAgcmV0dXJuIGFyZ1ZhbHVlcyAmJiBhcmdWYWx1ZXMubWFwKHJlbmRlckFyZ1dpdGhQcm9wcyk7CiAgICB9IC8vIFRPRE86IEFyZ3VtZW50IGFkZGluZyBpc24ndCB2ZXJ5IGdvb2QsIHdlIHNob3VsZCBpbXByb3ZlIHRoaXMgVUkKCiAgfSwgewogICAga2V5OiAiZ2V0QWRkYWJsZUFyZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QWRkYWJsZUFyZyhwcm9wcywgZGF0YUFyZykgewogICAgICB2YXIgb25WYWx1ZUFkZCA9IHByb3BzLm9uVmFsdWVBZGQ7CiAgICAgIHZhciBhcmcgPSBkYXRhQXJnLmFyZywKICAgICAgICAgIGFyZ1ZhbHVlcyA9IGRhdGFBcmcuYXJnVmFsdWVzLAogICAgICAgICAgc2tpcFJlbmRlciA9IGRhdGFBcmcuc2tpcFJlbmRlcjsgLy8gc2tpcCBhcmd1bWVudHMgdGhhdCBhcmVuJ3QgZGVmaW5lZCBpbiB0aGUgZXhwcmVzc2lvbiB0eXBlIHNjaGVtYQoKICAgICAgaWYgKCFhcmcgfHwgYXJnLnJlcXVpcmVkIHx8IHNraXBSZW5kZXIpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKGFyZ1ZhbHVlcyAmJiAhYXJnLm11bHRpKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciB2YWx1ZSA9IGFyZy5kZWZhdWx0ID09IG51bGwgPyBudWxsIDogKDAsIF9jb21tb24uZnJvbUV4cHJlc3Npb24pKGFyZy5kZWZhdWx0LCAnYXJndW1lbnQnKTsKICAgICAgcmV0dXJuIHsKICAgICAgICBhcmc6IGFyZywKICAgICAgICBvblZhbHVlQWRkOiBvblZhbHVlQWRkKGFyZy5uYW1lLCB2YWx1ZSkKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXNvbHZlQXJnIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXNvbHZlQXJnKCkgewogICAgICAvLyBiYXNpY2FsbHkgYSBuby1vcCBwbGFjZWhvbGRlcgogICAgICByZXR1cm4ge307CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwogICAgICB2YXIgYXJncyA9IGRhdGEuYXJncywKICAgICAgICAgIGFyZ1R5cGVEZWYgPSBkYXRhLmFyZ1R5cGVEZWY7IC8vIERvbid0IGluc3RhbmlhdGUgdGhlc2UgdW50aWwgcmVuZGVyIHRpbWUsIHRvIGdpdmUgdGhlIHJlZ2lzdHJpZXMgYSBjaGFuY2UgdG8gcG9wdWxhdGUuCgogICAgICB2YXIgYXJnSW5zdGFuY2VzID0gdGhpcy5hcmdzLm1hcChmdW5jdGlvbiAoYXJnU3BlYykgewogICAgICAgIHJldHVybiBuZXcgX2FyZy5BcmcoYXJnU3BlYyk7CiAgICAgIH0pOwoKICAgICAgaWYgKCEoMCwgX2xvZGFzaC5pc1BsYWluT2JqZWN0KShhcmdzKSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiRm9ybSBcIiIuY29uY2F0KHRoaXMubmFtZSwgIlwiIGV4cGVjdHMgXCJhcmdzXCIgb2JqZWN0IikpOwogICAgICB9IC8vIGdldCBhIG1hcHBpbmcgb2YgYXJnIHZhbHVlcyBmcm9tIHRoZSBleHByZXNzaW9uIGFuZCBmcm9tIHRoZSByZW5kZXJhYmxlJ3Mgc2NoZW1hCgoKICAgICAgdmFyIGFyZ05hbWVzID0gKDAsIF9sb2Rhc2gudW5pcSkoYXJnSW5zdGFuY2VzLm1hcChmdW5jdGlvbiAoYXJnKSB7CiAgICAgICAgcmV0dXJuIGFyZy5uYW1lOwogICAgICB9KS5jb25jYXQoT2JqZWN0LmtleXMoYXJncykpKTsKICAgICAgdmFyIGRhdGFBcmdzID0gYXJnTmFtZXMubWFwKGZ1bmN0aW9uIChhcmdOYW1lKSB7CiAgICAgICAgdmFyIGFyZyA9IGFyZ0luc3RhbmNlcy5maW5kKGZ1bmN0aW9uIChhcmcpIHsKICAgICAgICAgIHJldHVybiBhcmcubmFtZSA9PT0gYXJnTmFtZTsKICAgICAgICB9KTsgLy8gaWYgYXJnIGlzIG5vdCBtdWx0aSwgb25seSBwcmVzZXJ2ZSB0aGUgbGFzdCB2YWx1ZSBmb3VuZAogICAgICAgIC8vIG90aGVyd2lzZSwgbGVhdmUgdGhlIHZhbHVlIGFsb25lIChpbmNsdWRpbmcgaWYgdGhlIGFyZyBpcyBub3QgZGVmaW5lZCkKCiAgICAgICAgdmFyIGlzTXVsdGkgPSBhcmcgJiYgYXJnLm11bHRpOwogICAgICAgIHZhciBhcmdWYWx1ZXMgPSBhcmdzW2FyZ05hbWVdICYmICFpc011bHRpID8gWygwLCBfbG9kYXNoLmxhc3QpKGFyZ3NbYXJnTmFtZV0pXSA6IGFyZ3NbYXJnTmFtZV07CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGFyZzogYXJnLAogICAgICAgICAgYXJnVmFsdWVzOiBhcmdWYWx1ZXMKICAgICAgICB9OwogICAgICB9KTsgLy8gcHJvcHMgYXJlIHBhc3NlZCB0byByZXNvbHZlIGFuZCB0aGUgcmV0dXJuZWQgb2JqZWN0IGlzIG1peGVkIGludG8gdGhlIHRlbXBsYXRlIHByb3BzCgogICAgICB2YXIgcHJvcHMgPSBfb2JqZWN0U3ByZWFkKHt9LCBkYXRhLCB7fSwgdGhpcy5yZXNvbHZlKGRhdGEpLCB7CiAgICAgICAgdHlwZUluc3RhbmNlOiB0aGlzCiAgICAgIH0pOwoKICAgICAgdHJ5IHsKICAgICAgICAvLyBhbGxvdyBhIGhvb2sgdG8gb3ZlcnJpZGUgdGhlIGRhdGEgYXJncwogICAgICAgIHZhciByZXNvbHZlZERhdGFBcmdzID0gZGF0YUFyZ3MubWFwKGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgZCwge30sIF90aGlzMi5yZXNvbHZlQXJnKGQsIHByb3BzKSk7CiAgICAgICAgfSk7CiAgICAgICAgdmFyIGFyZ3VtZW50Rm9ybXMgPSAoMCwgX2xvZGFzaC5jb21wYWN0KShyZXNvbHZlZERhdGFBcmdzLm1hcChmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMi5yZW5kZXJBcmcocHJvcHMsIGQpOwogICAgICAgIH0pKTsKICAgICAgICB2YXIgYWRkYWJsZUFyZ3MgPSAoMCwgX2xvZGFzaC5jb21wYWN0KShyZXNvbHZlZERhdGFBcmdzLm1hcChmdW5jdGlvbiAoZCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMi5nZXRBZGRhYmxlQXJnKHByb3BzLCBkKTsKICAgICAgICB9KSk7CgogICAgICAgIGlmICghYWRkYWJsZUFyZ3MubGVuZ3RoICYmICFhcmd1bWVudEZvcm1zLmxlbmd0aCkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2lkZWJhcl9zZWN0aW9uLlNpZGViYXJTZWN0aW9uLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zaWRlYmFyX3NlY3Rpb25fdGl0bGUuU2lkZWJhclNlY3Rpb25UaXRsZSwgewogICAgICAgICAgdGl0bGU6IGFyZ1R5cGVEZWYuZGlzcGxheU5hbWUsCiAgICAgICAgICB0aXA6IGFyZ1R5cGVEZWYuaGVscAogICAgICAgIH0sIGFkZGFibGVBcmdzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9hcmdfYWRkX3BvcG92ZXIuQXJnQWRkUG9wb3ZlciwgewogICAgICAgICAgb3B0aW9uczogYWRkYWJsZUFyZ3MKICAgICAgICB9KSksIGFyZ3VtZW50Rm9ybXMpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDYWxsT3V0LCB7CiAgICAgICAgICBjb2xvcjogImRhbmdlciIsCiAgICAgICAgICBpY29uVHlwZTogImNyb3NzIiwKICAgICAgICAgIHRpdGxlOiAiRXhwcmVzc2lvbiByZW5kZXJpbmcgZXJyb3IiCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIGUubWVzc2FnZSkpOwogICAgICB9CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRnVuY3Rpb25Gb3JtOwp9KF9iYXNlX2Zvcm0uQmFzZUZvcm0pOwoKZXhwb3J0cy5GdW5jdGlvbkZvcm0gPSBGdW5jdGlvbkZvcm07"},null]}