{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/components/field_renderers/field_renderers.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/components/field_renderers/field_renderers.js","mtime":1589249552976},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkRlZmF1bHRGaWVsZFJlbmRlcmVyT3ZlcmZsb3cgPSBleHBvcnRzLk1vcmVDb250YWluZXIgPSBleHBvcnRzLkRlZmF1bHRGaWVsZFJlbmRlcmVyID0gZXhwb3J0cy5EZWZhdWx0RmllbGRSZW5kZXJlckNvbXBvbmVudCA9IGV4cG9ydHMucmVwdXRhdGlvblJlbmRlcmVyID0gZXhwb3J0cy53aG9pc1JlbmRlcmVyID0gZXhwb3J0cy5ob3N0TmFtZVJlbmRlcmVyID0gZXhwb3J0cy5ob3N0SWRSZW5kZXJlciA9IGV4cG9ydHMuYXV0b25vbW91c1N5c3RlbVJlbmRlcmVyID0gZXhwb3J0cy5kYXRlUmVuZGVyZXIgPSBleHBvcnRzLmxvY2F0aW9uUmVuZGVyZXIgPSBleHBvcnRzLkRFRkFVTFRfTU9SRV9NQVhfSEVJR0hUID0gZXhwb3J0cy5JcE92ZXJ2aWV3SWQgPSB2b2lkIDA7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9yZWFjdCA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9mcCA9IHJlcXVpcmUoImxvZGFzaC9mcCIpOwoKdmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfc3R5bGVkQ29tcG9uZW50cyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgic3R5bGVkLWNvbXBvbmVudHMiKSk7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuLi9kcmFnX2FuZF9kcm9wL2hlbHBlcnMiKTsKCnZhciBfZHJhZ2dhYmxlcyA9IHJlcXVpcmUoIi4uL2RyYWdnYWJsZXMiKTsKCnZhciBfZW1wdHlfdmFsdWUgPSByZXF1aXJlKCIuLi9lbXB0eV92YWx1ZSIpOwoKdmFyIF9mb3JtYXR0ZWRfZGF0ZSA9IHJlcXVpcmUoIi4uL2Zvcm1hdHRlZF9kYXRlIik7Cgp2YXIgX2xpbmtzID0gcmVxdWlyZSgiLi4vbGlua3MiKTsKCnZhciBfcGFnZSA9IHJlcXVpcmUoIi4uL3BhZ2UiKTsKCnZhciBpMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi4vcGFnZS9uZXR3b3JrL2lwX292ZXJ2aWV3L3RyYW5zbGF0aW9ucyIpKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgewogIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKICAgIHJldHVybiBvYmo7CiAgfSBlbHNlIHsKICAgIHZhciBuZXdPYmogPSB7fTsKCiAgICBpZiAob2JqICE9IG51bGwpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsKCiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7CiAgICByZXR1cm4gbmV3T2JqOwogIH0KfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKdmFyIERyYWdnYWJsZUNvbnRhaW5lckZsZXhHcm91cCA9ICgwLCBfc3R5bGVkQ29tcG9uZW50cy5kZWZhdWx0KShfZXVpLkV1aUZsZXhHcm91cCkud2l0aENvbmZpZyh7CiAgZGlzcGxheU5hbWU6ICJEcmFnZ2FibGVDb250YWluZXJGbGV4R3JvdXAiLAogIGNvbXBvbmVudElkOiAibnA0MHpvLTAiCn0pKFsiZmxleC1ncm93OnVuc2V0OyJdKTsKdmFyIElwT3ZlcnZpZXdJZCA9ICdpcC1vdmVydmlldyc7Ci8qKiBUaGUgZGVmYXVsdCBtYXgtaGVpZ2h0IG9mIHRoZSBwb3BvdmVyIHVzZWQgdG8gc2hvdyAiK24gTW9yZSIgaXRlbXMgKGUuZy4gYCs5IE1vcmVgKSAqLwoKZXhwb3J0cy5JcE92ZXJ2aWV3SWQgPSBJcE92ZXJ2aWV3SWQ7CnZhciBERUZBVUxUX01PUkVfTUFYX0hFSUdIVCA9ICcyMDBweCc7CmV4cG9ydHMuREVGQVVMVF9NT1JFX01BWF9IRUlHSFQgPSBERUZBVUxUX01PUkVfTUFYX0hFSUdIVDsKCnZhciBsb2NhdGlvblJlbmRlcmVyID0gZnVuY3Rpb24gbG9jYXRpb25SZW5kZXJlcihmaWVsZE5hbWVzLCBkYXRhKSB7CiAgcmV0dXJuIGZpZWxkTmFtZXMubGVuZ3RoID4gMCAmJiBmaWVsZE5hbWVzLmV2ZXJ5KGZ1bmN0aW9uIChmaWVsZE5hbWUpIHsKICAgIHJldHVybiAoMCwgX2ZwLmdldE9yKShudWxsLCBmaWVsZE5hbWUsIGRhdGEpOwogIH0pID8gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiLAogICAgZ3V0dGVyU2l6ZTogIm5vbmUiLAogICAgImRhdGEtdGVzdC1zdWJqIjogImxvY2F0aW9uLWZpZWxkIgogIH0sIGZpZWxkTmFtZXMubWFwKGZ1bmN0aW9uIChmaWVsZE5hbWUsIGluZGV4KSB7CiAgICB2YXIgbG9jYXRpb25WYWx1ZSA9ICgwLCBfZnAuZ2V0T3IpKCcnLCBmaWVsZE5hbWUsIGRhdGEpOwogICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRnJhZ21lbnQsIHsKICAgICAga2V5OiAiIi5jb25jYXQoSXBPdmVydmlld0lkLCAiLSIpLmNvbmNhdChmaWVsZE5hbWUpCiAgICB9LCBpbmRleCA/ICIsXHhBMCIgOiAnJywgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICBncm93OiBmYWxzZQogICAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2RyYWdnYWJsZXMuRGVmYXVsdERyYWdnYWJsZSwgewogICAgICBpZDogImxvY2F0aW9uLXJlbmRlcmVyLWRlZmF1bHQtZHJhZ2dhYmxlLSIuY29uY2F0KElwT3ZlcnZpZXdJZCwgIi0iKS5jb25jYXQoZmllbGROYW1lKSwKICAgICAgZmllbGQ6IGZpZWxkTmFtZSwKICAgICAgdmFsdWU6IGxvY2F0aW9uVmFsdWUKICAgIH0pKSk7CiAgfSkpIDogKDAsIF9lbXB0eV92YWx1ZS5nZXRFbXB0eVRhZ1ZhbHVlKSgpOwp9OwoKZXhwb3J0cy5sb2NhdGlvblJlbmRlcmVyID0gbG9jYXRpb25SZW5kZXJlcjsKCnZhciBkYXRlUmVuZGVyZXIgPSBmdW5jdGlvbiBkYXRlUmVuZGVyZXIodGltZXN0YW1wKSB7CiAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9mb3JtYXR0ZWRfZGF0ZS5Gb3JtYXR0ZWRSZWxhdGl2ZVByZWZlcmVuY2VEYXRlLCB7CiAgICB2YWx1ZTogdGltZXN0YW1wCiAgfSk7Cn07CgpleHBvcnRzLmRhdGVSZW5kZXJlciA9IGRhdGVSZW5kZXJlcjsKCnZhciBhdXRvbm9tb3VzU3lzdGVtUmVuZGVyZXIgPSBmdW5jdGlvbiBhdXRvbm9tb3VzU3lzdGVtUmVuZGVyZXIoYXMsIGZsb3dUYXJnZXQpIHsKICByZXR1cm4gYXMgJiYgYXMub3JnYW5pemF0aW9uICYmIGFzLm9yZ2FuaXphdGlvbi5uYW1lICYmIGFzLm51bWJlciA/IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIiwKICAgIGd1dHRlclNpemU6ICJub25lIgogIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlCiAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2RyYWdnYWJsZXMuRGVmYXVsdERyYWdnYWJsZSwgewogICAgaWQ6ICJhdXRvbm9tb3VzLXN5c3RlbS1yZW5kZXJlci1kZWZhdWx0LWRyYWdnYWJsZS0iLmNvbmNhdChJcE92ZXJ2aWV3SWQsICItIikuY29uY2F0KGZsb3dUYXJnZXQsICIuYXMub3JnYW5pemF0aW9uLm5hbWUiKSwKICAgIGZpZWxkOiAiIi5jb25jYXQoZmxvd1RhcmdldCwgIi5hcy5vcmdhbml6YXRpb24ubmFtZSIpLAogICAgdmFsdWU6IGFzLm9yZ2FuaXphdGlvbi5uYW1lCiAgfSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sICcvJyksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlCiAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2RyYWdnYWJsZXMuRGVmYXVsdERyYWdnYWJsZSwgewogICAgaWQ6ICJhdXRvbm9tb3VzLXN5c3RlbS1yZW5kZXJlci1kZWZhdWx0LWRyYWdnYWJsZS0iLmNvbmNhdChJcE92ZXJ2aWV3SWQsICItIikuY29uY2F0KGZsb3dUYXJnZXQsICIuYXMubnVtYmVyIiksCiAgICBmaWVsZDogIiIuY29uY2F0KGZsb3dUYXJnZXQsICIuYXMubnVtYmVyIiksCiAgICB2YWx1ZTogIiIuY29uY2F0KGFzLm51bWJlcikKICB9KSkpIDogKDAsIF9lbXB0eV92YWx1ZS5nZXRFbXB0eVRhZ1ZhbHVlKSgpOwp9OwoKZXhwb3J0cy5hdXRvbm9tb3VzU3lzdGVtUmVuZGVyZXIgPSBhdXRvbm9tb3VzU3lzdGVtUmVuZGVyZXI7Cgp2YXIgaG9zdElkUmVuZGVyZXIgPSBmdW5jdGlvbiBob3N0SWRSZW5kZXJlcihfcmVmKSB7CiAgdmFyIGhvc3QgPSBfcmVmLmhvc3QsCiAgICAgIGlwRmlsdGVyID0gX3JlZi5pcEZpbHRlciwKICAgICAgbm9MaW5rID0gX3JlZi5ub0xpbms7CiAgcmV0dXJuIGhvc3QuaWQgJiYgaG9zdC5pcCAmJiAoaXBGaWx0ZXIgPT0gbnVsbCB8fCBob3N0LmlwLmluY2x1ZGVzKGlwRmlsdGVyKSkgPyBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIGhvc3QubmFtZSAmJiBob3N0Lm5hbWVbMF0gIT0gbnVsbCA/IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9kcmFnZ2FibGVzLkRlZmF1bHREcmFnZ2FibGUsIHsKICAgIGlkOiAiaG9zdC1pZC1yZW5kZXJlci1kZWZhdWx0LWRyYWdnYWJsZS0iLmNvbmNhdChJcE92ZXJ2aWV3SWQsICItaG9zdC1pZCIpLAogICAgZmllbGQ6ICJob3N0LmlkIiwKICAgIHZhbHVlOiBob3N0LmlkWzBdCiAgfSwgbm9MaW5rID8gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBob3N0LmlkKSA6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9saW5rcy5Ib3N0RGV0YWlsc0xpbmssIHsKICAgIGhvc3ROYW1lOiBob3N0Lm5hbWVbMF0KICB9LCBob3N0LmlkKSkgOiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIGhvc3QuaWQpKSA6ICgwLCBfZW1wdHlfdmFsdWUuZ2V0RW1wdHlUYWdWYWx1ZSkoKTsKfTsKCmV4cG9ydHMuaG9zdElkUmVuZGVyZXIgPSBob3N0SWRSZW5kZXJlcjsKCnZhciBob3N0TmFtZVJlbmRlcmVyID0gZnVuY3Rpb24gaG9zdE5hbWVSZW5kZXJlcihob3N0LCBpcEZpbHRlcikgewogIHJldHVybiBob3N0Lm5hbWUgJiYgaG9zdC5uYW1lWzBdICYmIGhvc3QuaXAgJiYgKCEoaXBGaWx0ZXIgIT0gbnVsbCkgfHwgaG9zdC5pcC5pbmNsdWRlcyhpcEZpbHRlcikpID8gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2RyYWdnYWJsZXMuRGVmYXVsdERyYWdnYWJsZSwgewogICAgaWQ6ICJob3N0LW5hbWUtcmVuZGVyZXItZGVmYXVsdC1kcmFnZ2FibGUtIi5jb25jYXQoSXBPdmVydmlld0lkLCAiLWhvc3QtbmFtZSIpLAogICAgZmllbGQ6ICdob3N0Lm5hbWUnLAogICAgdmFsdWU6IGhvc3QubmFtZVswXQogIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9saW5rcy5Ib3N0RGV0YWlsc0xpbmssIHsKICAgIGhvc3ROYW1lOiBob3N0Lm5hbWVbMF0KICB9LCBob3N0Lm5hbWUgPyBob3N0Lm5hbWUgOiAoMCwgX2VtcHR5X3ZhbHVlLmdldEVtcHR5VGFnVmFsdWUpKCkpKSA6ICgwLCBfZW1wdHlfdmFsdWUuZ2V0RW1wdHlUYWdWYWx1ZSkoKTsKfTsKCmV4cG9ydHMuaG9zdE5hbWVSZW5kZXJlciA9IGhvc3ROYW1lUmVuZGVyZXI7Cgp2YXIgd2hvaXNSZW5kZXJlciA9IGZ1bmN0aW9uIHdob2lzUmVuZGVyZXIoaXApIHsKICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2xpbmtzLldob0lzTGluaywgewogICAgZG9tYWluOiBpcAogIH0sIGkxOG4uVklFV19XSE9JUyk7Cn07CgpleHBvcnRzLndob2lzUmVuZGVyZXIgPSB3aG9pc1JlbmRlcmVyOwoKdmFyIHJlcHV0YXRpb25SZW5kZXJlciA9IGZ1bmN0aW9uIHJlcHV0YXRpb25SZW5kZXJlcihpcCkgewogIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfbGlua3MuUmVwdXRhdGlvbkxpbmssIHsKICAgIGRvbWFpbjogaXAsCiAgICBkaXJlY3Rpb246ICJjb2x1bW4iCiAgfSk7Cn07CgpleHBvcnRzLnJlcHV0YXRpb25SZW5kZXJlciA9IHJlcHV0YXRpb25SZW5kZXJlcjsgLy8gVE9ETzogVGhpcyBjYXVzZXMgYnJlYWtzIGJldHdlZW4gZWxlbWVudHMgdW50aWwgdGhlIHRpY2tldCBiZWxvdyBpcyBmaXhlZAovLyBodHRwczovL2dpdGh1Yi5jb20vZWxhc3RpYy9pbmdlc3QtZGV2L2lzc3Vlcy80NzQKCnZhciBEZWZhdWx0RmllbGRSZW5kZXJlckNvbXBvbmVudCA9IGZ1bmN0aW9uIERlZmF1bHRGaWVsZFJlbmRlcmVyQ29tcG9uZW50KF9yZWYyKSB7CiAgdmFyIGF0dHJOYW1lID0gX3JlZjIuYXR0ck5hbWUsCiAgICAgIF9yZWYyJGRpc3BsYXlDb3VudCA9IF9yZWYyLmRpc3BsYXlDb3VudCwKICAgICAgZGlzcGxheUNvdW50ID0gX3JlZjIkZGlzcGxheUNvdW50ID09PSB2b2lkIDAgPyAxIDogX3JlZjIkZGlzcGxheUNvdW50LAogICAgICBpZFByZWZpeCA9IF9yZWYyLmlkUHJlZml4LAogICAgICBfcmVmMiRtb3JlTWF4SGVpZ2h0ID0gX3JlZjIubW9yZU1heEhlaWdodCwKICAgICAgbW9yZU1heEhlaWdodCA9IF9yZWYyJG1vcmVNYXhIZWlnaHQgPT09IHZvaWQgMCA/IERFRkFVTFRfTU9SRV9NQVhfSEVJR0hUIDogX3JlZjIkbW9yZU1heEhlaWdodCwKICAgICAgcmVuZGVyID0gX3JlZjIucmVuZGVyLAogICAgICByb3dJdGVtcyA9IF9yZWYyLnJvd0l0ZW1zOwoKICBpZiAocm93SXRlbXMgIT0gbnVsbCAmJiByb3dJdGVtcy5sZW5ndGggPiAwKSB7CiAgICB2YXIgZHJhZ2dhYmxlcyA9IHJvd0l0ZW1zLnNsaWNlKDAsIGRpc3BsYXlDb3VudCkubWFwKGZ1bmN0aW9uIChyb3dJdGVtLCBpbmRleCkgewogICAgICB2YXIgaWQgPSAoMCwgX2hlbHBlcnMuZXNjYXBlRGF0YVByb3ZpZGVySWQpKCJkZWZhdWx0LWZpZWxkLXJlbmRlcmVyLWRlZmF1bHQtZHJhZ2dhYmxlLSIuY29uY2F0KGlkUHJlZml4LCAiLSIpLmNvbmNhdChhdHRyTmFtZSwgIi0iKS5jb25jYXQocm93SXRlbSkpOwogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGtleTogaWQsCiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgaW5kZXggIT09IDAgJiYgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCAnLCcsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9wYWdlLlNwYWNlciwgbnVsbCkpLCB0eXBlb2Ygcm93SXRlbSA9PT0gJ3N0cmluZycgJiYgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2RyYWdnYWJsZXMuRGVmYXVsdERyYWdnYWJsZSwgewogICAgICAgIGlkOiBpZCwKICAgICAgICBmaWVsZDogYXR0ck5hbWUsCiAgICAgICAgdmFsdWU6IHJvd0l0ZW0KICAgICAgfSwgcmVuZGVyID8gcmVuZGVyKHJvd0l0ZW0pIDogcm93SXRlbSkpOwogICAgfSk7CiAgICByZXR1cm4gZHJhZ2dhYmxlcy5sZW5ndGggPiAwID8gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRHJhZ2dhYmxlQ29udGFpbmVyRmxleEdyb3VwLCB7CiAgICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiLAogICAgICBndXR0ZXJTaXplOiAibm9uZSIsCiAgICAgIGNvbXBvbmVudDogInNwYW4iCiAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgIGdyb3c6IGZhbHNlCiAgICB9LCBkcmFnZ2FibGVzLCAiICIpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgIGdyb3c6IGZhbHNlCiAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChEZWZhdWx0RmllbGRSZW5kZXJlck92ZXJmbG93LCB7CiAgICAgIHJvd0l0ZW1zOiByb3dJdGVtcywKICAgICAgaWRQcmVmaXg6IGlkUHJlZml4LAogICAgICByZW5kZXI6IHJlbmRlciwKICAgICAgb3ZlcmZsb3dJbmRleFN0YXJ0OiBkaXNwbGF5Q291bnQsCiAgICAgIG1vcmVNYXhIZWlnaHQ6IG1vcmVNYXhIZWlnaHQKICAgIH0pKSkgOiAoMCwgX2VtcHR5X3ZhbHVlLmdldEVtcHR5VGFnVmFsdWUpKCk7CiAgfSBlbHNlIHsKICAgIHJldHVybiAoMCwgX2VtcHR5X3ZhbHVlLmdldEVtcHR5VGFnVmFsdWUpKCk7CiAgfQp9OwoKZXhwb3J0cy5EZWZhdWx0RmllbGRSZW5kZXJlckNvbXBvbmVudCA9IERlZmF1bHRGaWVsZFJlbmRlcmVyQ29tcG9uZW50OwoKdmFyIERlZmF1bHRGaWVsZFJlbmRlcmVyID0gX3JlYWN0Mi5kZWZhdWx0Lm1lbW8oRGVmYXVsdEZpZWxkUmVuZGVyZXJDb21wb25lbnQpOwoKZXhwb3J0cy5EZWZhdWx0RmllbGRSZW5kZXJlciA9IERlZmF1bHRGaWVsZFJlbmRlcmVyOwpEZWZhdWx0RmllbGRSZW5kZXJlci5kaXNwbGF5TmFtZSA9ICdEZWZhdWx0RmllbGRSZW5kZXJlcic7Ci8qKiBBIGNvbnRhaW5lciAod2l0aCBvdmVyZmxvdykgZm9yIHNob3dpbmcgIk1vcmUiIGl0ZW1zIGluIGEgcG9wb3ZlciAqLwoKdmFyIE1vcmVDb250YWluZXIgPSBfcmVhY3QyLmRlZmF1bHQubWVtbyhmdW5jdGlvbiAoX3JlZjMpIHsKICB2YXIgaWRQcmVmaXggPSBfcmVmMy5pZFByZWZpeCwKICAgICAgcmVuZGVyID0gX3JlZjMucmVuZGVyLAogICAgICByb3dJdGVtcyA9IF9yZWYzLnJvd0l0ZW1zLAogICAgICBtb3JlTWF4SGVpZ2h0ID0gX3JlZjMubW9yZU1heEhlaWdodCwKICAgICAgb3ZlcmZsb3dJbmRleFN0YXJ0ID0gX3JlZjMub3ZlcmZsb3dJbmRleFN0YXJ0OwogIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgImRhdGEtdGVzdC1zdWJqIjogIm1vcmUtY29udGFpbmVyIiwKICAgIHN0eWxlOiB7CiAgICAgIG1heEhlaWdodDogbW9yZU1heEhlaWdodCwKICAgICAgb3ZlcmZsb3c6ICdhdXRvJywKICAgICAgcGFkZGluZ1JpZ2h0OiAnMnB4JwogICAgfQogIH0sIHJvd0l0ZW1zLnNsaWNlKG92ZXJmbG93SW5kZXhTdGFydCkubWFwKGZ1bmN0aW9uIChyb3dJdGVtLCBpKSB7CiAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgIGtleTogIiIuY29uY2F0KGlkUHJlZml4LCAiLSIpLmNvbmNhdChyb3dJdGVtLCAiLSIpLmNvbmNhdChpKSwKICAgICAgc2l6ZTogInMiCiAgICB9LCByZW5kZXIgPyByZW5kZXIocm93SXRlbSkgOiByb3dJdGVtKTsKICB9KSk7Cn0pOwoKZXhwb3J0cy5Nb3JlQ29udGFpbmVyID0gTW9yZUNvbnRhaW5lcjsKTW9yZUNvbnRhaW5lci5kaXNwbGF5TmFtZSA9ICdNb3JlQ29udGFpbmVyJzsKCnZhciBEZWZhdWx0RmllbGRSZW5kZXJlck92ZXJmbG93ID0gX3JlYWN0Mi5kZWZhdWx0Lm1lbW8oZnVuY3Rpb24gKF9yZWY0KSB7CiAgdmFyIGlkUHJlZml4ID0gX3JlZjQuaWRQcmVmaXgsCiAgICAgIG1vcmVNYXhIZWlnaHQgPSBfcmVmNC5tb3JlTWF4SGVpZ2h0LAogICAgICBfcmVmNCRvdmVyZmxvd0luZGV4U3QgPSBfcmVmNC5vdmVyZmxvd0luZGV4U3RhcnQsCiAgICAgIG92ZXJmbG93SW5kZXhTdGFydCA9IF9yZWY0JG92ZXJmbG93SW5kZXhTdCA9PT0gdm9pZCAwID8gNSA6IF9yZWY0JG92ZXJmbG93SW5kZXhTdCwKICAgICAgcmVuZGVyID0gX3JlZjQucmVuZGVyLAogICAgICByb3dJdGVtcyA9IF9yZWY0LnJvd0l0ZW1zOwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksCiAgICAgIGlzT3BlbiA9IF91c2VTdGF0ZTJbMF0sCiAgICAgIHNldElzT3BlbiA9IF91c2VTdGF0ZTJbMV07CgogIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIHJvd0l0ZW1zLmxlbmd0aCA+IG92ZXJmbG93SW5kZXhTdGFydCAmJiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBvcG92ZXIsIHsKICAgIGlkOiAicG9wb3ZlciIsCiAgICBidXR0b246IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgJyAsJywgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25FbXB0eSwgewogICAgICBzaXplOiAieHMiLAogICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgIHJldHVybiBzZXRJc09wZW4oIWlzT3Blbik7CiAgICAgIH0KICAgIH0sICIrIi5jb25jYXQocm93SXRlbXMubGVuZ3RoIC0gb3ZlcmZsb3dJbmRleFN0YXJ0LCAiICIpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICBpZDogInhwYWNrLnNpZW0uZmllbGRSZW5kZXJlcnMubW9yZUxhYmVsIiwKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJNb3JlIgogICAgfSkpKSwKICAgIGlzT3BlbjogaXNPcGVuLAogICAgY2xvc2VQb3BvdmVyOiBmdW5jdGlvbiBjbG9zZVBvcG92ZXIoKSB7CiAgICAgIHJldHVybiBzZXRJc09wZW4oIWlzT3Blbik7CiAgICB9CiAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTW9yZUNvbnRhaW5lciwgewogICAgaWRQcmVmaXg6IGlkUHJlZml4LAogICAgcmVuZGVyOiByZW5kZXIsCiAgICByb3dJdGVtczogcm93SXRlbXMsCiAgICBtb3JlTWF4SGVpZ2h0OiBtb3JlTWF4SGVpZ2h0LAogICAgb3ZlcmZsb3dJbmRleFN0YXJ0OiBvdmVyZmxvd0luZGV4U3RhcnQKICB9KSkpOwp9KTsKCmV4cG9ydHMuRGVmYXVsdEZpZWxkUmVuZGVyZXJPdmVyZmxvdyA9IERlZmF1bHRGaWVsZFJlbmRlcmVyT3ZlcmZsb3c7CkRlZmF1bHRGaWVsZFJlbmRlcmVyT3ZlcmZsb3cuZGlzcGxheU5hbWUgPSAnRGVmYXVsdEZpZWxkUmVuZGVyZXJPdmVyZmxvdyc7"},null]}