{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/containers/detection_engine/rules/use_rules.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/containers/detection_engine/rules/use_rules.js","mtime":1589249553224},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLnVzZVJ1bGVzID0gdm9pZCAwOwoKdmFyIF9mcCA9IHJlcXVpcmUoImxvZGFzaC9mcCIpOwoKdmFyIF9yZWFjdCA9IHJlcXVpcmUoInJlYWN0Iik7Cgp2YXIgX3RvYXN0ZXJzID0gcmVxdWlyZSgiLi4vLi4vLi4vY29tcG9uZW50cy90b2FzdGVycyIpOwoKdmFyIF9hcGkgPSByZXF1aXJlKCIuL2FwaSIpOwoKdmFyIGkxOG4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCIuL3RyYW5zbGF0aW9ucyIpKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgewogIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKICAgIHJldHVybiBvYmo7CiAgfSBlbHNlIHsKICAgIHZhciBuZXdPYmogPSB7fTsKCiAgICBpZiAob2JqICE9IG51bGwpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsKCiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7CiAgICByZXR1cm4gbmV3T2JqOwogIH0KfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgewogIHRyeSB7CiAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7CiAgICB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICByZWplY3QoZXJyb3IpOwogICAgcmV0dXJuOwogIH0KCiAgaWYgKGluZm8uZG9uZSkgewogICAgcmVzb2x2ZSh2YWx1ZSk7CiAgfSBlbHNlIHsKICAgIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsKICB9Cn0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICBhcmdzID0gYXJndW1lbnRzOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOwoKICAgICAgZnVuY3Rpb24gX25leHQodmFsdWUpIHsKICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOwogICAgICB9CgogICAgICBfbmV4dCh1bmRlZmluZWQpOwogICAgfSk7CiAgfTsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQovKioKICogSG9vayBmb3IgdXNpbmcgdGhlIGxpc3Qgb2YgUnVsZXMgZnJvbSB0aGUgRGV0ZWN0aW9uIEVuZ2luZSBBUEkKICoKICogQHBhcmFtIHBhZ2luYXRpb24gZGVzaXJlZCBwYWdpbmF0aW9uIG9wdGlvbnMgKGUuZy4gcGFnZS9wZXJQYWdlKQogKiBAcGFyYW0gZmlsdGVyT3B0aW9ucyBkZXNpcmVkIGZpbHRlcnMgKGUuZy4gZmlsdGVyL3NvcnRGaWVsZC9zb3J0T3JkZXIpCiAqLwoKCnZhciB1c2VSdWxlcyA9IGZ1bmN0aW9uIHVzZVJ1bGVzKF9yZWYpIHsKICB2YXIgX2ZpbHRlck9wdGlvbnMkdGFnczsKCiAgdmFyIHBhZ2luYXRpb24gPSBfcmVmLnBhZ2luYXRpb24sCiAgICAgIGZpbHRlck9wdGlvbnMgPSBfcmVmLmZpbHRlck9wdGlvbnMsCiAgICAgIHJlZmV0Y2hQcmVQYWNrYWdlZFJ1bGVzU3RhdHVzID0gX3JlZi5yZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1cywKICAgICAgZGlzcGF0Y2hSdWxlc0luUmVkdWNlciA9IF9yZWYuZGlzcGF0Y2hSdWxlc0luUmVkdWNlcjsKCiAgdmFyIF91c2VTdGF0ZSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKG51bGwpLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgcnVsZXMgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRSdWxlcyA9IF91c2VTdGF0ZTJbMV07CgogIHZhciByZUZldGNoUnVsZXMgPSAoMCwgX3JlYWN0LnVzZVJlZikoX2ZwLm5vb3ApOwoKICB2YXIgX3VzZVN0YXRlMyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHRydWUpLAogICAgICBfdXNlU3RhdGU0ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMywgMiksCiAgICAgIGxvYWRpbmcgPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRMb2FkaW5nID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIF91c2VTdGF0ZVRvYXN0ZXIgPSAoMCwgX3RvYXN0ZXJzLnVzZVN0YXRlVG9hc3RlcikoKSwKICAgICAgX3VzZVN0YXRlVG9hc3RlcjIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGVUb2FzdGVyLCAyKSwKICAgICAgZGlzcGF0Y2hUb2FzdGVyID0gX3VzZVN0YXRlVG9hc3RlcjJbMV07CgogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICB2YXIgaXNTdWJzY3JpYmVkID0gdHJ1ZTsKICAgIHZhciBhYm9ydEN0cmwgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7CgogICAgZnVuY3Rpb24gZmV0Y2hEYXRhKCkgewogICAgICByZXR1cm4gX2ZldGNoRGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9mZXRjaERhdGEoKSB7CiAgICAgIF9mZXRjaERhdGEgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBmb3JjZVJlbG9hZCwKICAgICAgICAgICAgZmV0Y2hSdWxlc1Jlc3VsdCwKICAgICAgICAgICAgX2FyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZm9yY2VSZWxvYWQgPSBfYXJncy5sZW5ndGggPiAwICYmIF9hcmdzWzBdICE9PSB1bmRlZmluZWQgPyBfYXJnc1swXSA6IGZhbHNlOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE7CiAgICAgICAgICAgICAgICBzZXRMb2FkaW5nKHRydWUpOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gKDAsIF9hcGkuZmV0Y2hSdWxlcykoewogICAgICAgICAgICAgICAgICBmaWx0ZXJPcHRpb25zOiBmaWx0ZXJPcHRpb25zLAogICAgICAgICAgICAgICAgICBwYWdpbmF0aW9uOiBwYWdpbmF0aW9uLAogICAgICAgICAgICAgICAgICBzaWduYWw6IGFib3J0Q3RybC5zaWduYWwKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBmZXRjaFJ1bGVzUmVzdWx0ID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoaXNTdWJzY3JpYmVkKSB7CiAgICAgICAgICAgICAgICAgIHNldFJ1bGVzKGZldGNoUnVsZXNSZXN1bHQpOwoKICAgICAgICAgICAgICAgICAgaWYgKGRpc3BhdGNoUnVsZXNJblJlZHVjZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoUnVsZXNJblJlZHVjZXIoZmV0Y2hSdWxlc1Jlc3VsdC5kYXRhLCB7CiAgICAgICAgICAgICAgICAgICAgICBwYWdlOiBmZXRjaFJ1bGVzUmVzdWx0LnBhZ2UsCiAgICAgICAgICAgICAgICAgICAgICBwZXJQYWdlOiBmZXRjaFJ1bGVzUmVzdWx0LnBlclBhZ2UsCiAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogZmV0Y2hSdWxlc1Jlc3VsdC50b3RhbAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA5OwogICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxKTsKCiAgICAgICAgICAgICAgICBpZiAoaXNTdWJzY3JpYmVkKSB7CiAgICAgICAgICAgICAgICAgICgwLCBfdG9hc3RlcnMuZXJyb3JUb1RvYXN0ZXIpKHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogaTE4bi5SVUxFX0ZFVENIX0ZBSUxVUkUsCiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IF9jb250ZXh0LnQwLAogICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RlcjogZGlzcGF0Y2hUb2FzdGVyCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgaWYgKGRpc3BhdGNoUnVsZXNJblJlZHVjZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoUnVsZXNJblJlZHVjZXIoW10sIHt9KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgaWYgKGlzU3Vic2NyaWJlZCkgewogICAgICAgICAgICAgICAgICBzZXRMb2FkaW5nKGZhbHNlKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMSwgOV1dKTsKICAgICAgfSkpOwogICAgICByZXR1cm4gX2ZldGNoRGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZldGNoRGF0YSgpOwoKICAgIHJlRmV0Y2hSdWxlcy5jdXJyZW50ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgcmVmcmVzaFByZVBhY2thZ2VkUnVsZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CiAgICAgIGZldGNoRGF0YSh0cnVlKTsKCiAgICAgIGlmIChyZWZyZXNoUHJlUGFja2FnZWRSdWxlICYmIHJlZmV0Y2hQcmVQYWNrYWdlZFJ1bGVzU3RhdHVzICE9IG51bGwpIHsKICAgICAgICByZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1cygpOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGlzU3Vic2NyaWJlZCA9IGZhbHNlOwogICAgICBhYm9ydEN0cmwuYWJvcnQoKTsKICAgIH07CiAgfSwgW3BhZ2luYXRpb24ucGFnZSwgcGFnaW5hdGlvbi5wZXJQYWdlLCBmaWx0ZXJPcHRpb25zLmZpbHRlciwgZmlsdGVyT3B0aW9ucy5zb3J0RmllbGQsIGZpbHRlck9wdGlvbnMuc29ydE9yZGVyLCAoX2ZpbHRlck9wdGlvbnMkdGFncyA9IGZpbHRlck9wdGlvbnMudGFncykgPT09IG51bGwgfHwgX2ZpbHRlck9wdGlvbnMkdGFncyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2ZpbHRlck9wdGlvbnMkdGFncy5zb3J0KCkuam9pbigpLCBmaWx0ZXJPcHRpb25zLnNob3dDdXN0b21SdWxlcywgZmlsdGVyT3B0aW9ucy5zaG93RWxhc3RpY1J1bGVzLCByZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1c10pOwogIHJldHVybiBbbG9hZGluZywgcnVsZXMsIHJlRmV0Y2hSdWxlcy5jdXJyZW50XTsKfTsKCmV4cG9ydHMudXNlUnVsZXMgPSB1c2VSdWxlczs="},null]}