{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/canvas/public/components/workpad_loader/workpad_loader.js","dependencies":[{"path":"x-pack/legacy/plugins/canvas/public/components/workpad_loader/workpad_loader.js","mtime":1589249552027},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLldvcmtwYWRMb2FkZXIgPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3Byb3BUeXBlcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicHJvcC10eXBlcyIpKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2xvZGFzaCA9IHJlcXVpcmUoImxvZGFzaCIpOwoKdmFyIF9tb21lbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudCIpKTsKCnZhciBfY29uZmlybV9tb2RhbCA9IHJlcXVpcmUoIi4uL2NvbmZpcm1fbW9kYWwiKTsKCnZhciBfbGluayA9IHJlcXVpcmUoIi4uL2xpbmsiKTsKCnZhciBfcGFnaW5hdGUgPSByZXF1aXJlKCIuLi9wYWdpbmF0ZSIpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiLi4vLi4vLi4vaTE4biIpOwoKdmFyIF9raWJhbmFfYWR2YW5jZWRfc2V0dGluZ3MgPSByZXF1aXJlKCIuLi8uLi9saWIva2liYW5hX2FkdmFuY2VkX3NldHRpbmdzIik7Cgp2YXIgX3dvcmtwYWRfZHJvcHpvbmUgPSByZXF1aXJlKCIuL3dvcmtwYWRfZHJvcHpvbmUiKTsKCnZhciBfd29ya3BhZF9jcmVhdGUgPSByZXF1aXJlKCIuL3dvcmtwYWRfY3JlYXRlIik7Cgp2YXIgX3dvcmtwYWRfc2VhcmNoID0gcmVxdWlyZSgiLi93b3JrcGFkX3NlYXJjaCIpOwoKdmFyIF91cGxvYWRfd29ya3BhZCA9IHJlcXVpcmUoIi4vdXBsb2FkX3dvcmtwYWQiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgeyB0cnkgeyB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7IHZhciB2YWx1ZSA9IGluZm8udmFsdWU7IH0gY2F0Y2ggKGVycm9yKSB7IHJlamVjdChlcnJvcik7IHJldHVybjsgfSBpZiAoaW5mby5kb25lKSB7IHJlc29sdmUodmFsdWUpOyB9IGVsc2UgeyBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7IH0gfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7IGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7IH0gZnVuY3Rpb24gX3Rocm93KGVycikgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7IH0gX25leHQodW5kZWZpbmVkKTsgfSk7IH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKdmFyIHN0cmluZ3MgPSBfaTE4bi5Db21wb25lbnRTdHJpbmdzLldvcmtwYWRMb2FkZXI7Cgp2YXIgZm9ybWF0RGF0ZSA9IGZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZSkgewogIHJldHVybiBkYXRlICYmICgwLCBfbW9tZW50LmRlZmF1bHQpKGRhdGUpLmZvcm1hdChfa2liYW5hX2FkdmFuY2VkX3NldHRpbmdzLkFkdmFuY2VkU2V0dGluZ3MuZ2V0KCdkYXRlRm9ybWF0JykpOwp9OwoKdmFyIGdldERpc3BsYXlOYW1lID0gZnVuY3Rpb24gZ2V0RGlzcGxheU5hbWUobmFtZSwgd29ya3BhZCwgbG9hZGVkV29ya3BhZCkgewogIHZhciB3b3JrcGFkTmFtZSA9IG5hbWUubGVuZ3RoID8gbmFtZSA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImVtIiwgbnVsbCwgd29ya3BhZC5pZCk7CiAgcmV0dXJuIHdvcmtwYWQuaWQgPT09IGxvYWRlZFdvcmtwYWQgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJzdHJvbmciLCBudWxsLCB3b3JrcGFkTmFtZSkgOiB3b3JrcGFkTmFtZTsKfTsKCnZhciBXb3JrcGFkTG9hZGVyID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX1JlYWN0JFB1cmVDb21wb25lbnQpIHsKICBfaW5oZXJpdHMoV29ya3BhZExvYWRlciwgX1JlYWN0JFB1cmVDb21wb25lbnQpOwoKICBmdW5jdGlvbiBXb3JrcGFkTG9hZGVyKCkgewogICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7CgogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXb3JrcGFkTG9hZGVyKTsKCiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgIH0KCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gX2dldFByb3RvdHlwZU9mKFdvcmtwYWRMb2FkZXIpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzXS5jb25jYXQoYXJncykpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzdGF0ZSIsIHsKICAgICAgY3JlYXRlUGVuZGluZzogZmFsc2UsCiAgICAgIGRlbGV0aW5nV29ya3BhZDogZmFsc2UsCiAgICAgIHNvcnRGaWVsZDogJ0B0aW1lc3RhbXAnLAogICAgICBzb3J0RGlyZWN0aW9uOiAnZGVzYycsCiAgICAgIHNlbGVjdGVkV29ya3BhZHM6IFtdLAogICAgICBwYWdlU2l6ZTogMTAKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNyZWF0ZVdvcmtwYWQiLAogICAgLyojX19QVVJFX18qLwogICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAvKiNfX1BVUkVfXyovCiAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgY3JlYXRlUGVuZGluZzogdHJ1ZQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucHJvcHMuY3JlYXRlV29ya3BhZCgpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIF90aGlzLl9pc01vdW50ZWQgJiYgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgY3JlYXRlUGVuZGluZzogZmFsc2UKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uVXBsb2FkIiwKICAgIC8qI19fUFVSRV9fKi8KICAgIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZWYyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIod29ya3BhZCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIGNyZWF0ZVBlbmRpbmc6IHRydWUKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5wcm9wcy5jcmVhdGVXb3JrcGFkKHdvcmtwYWQpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfdGhpcy5faXNNb3VudGVkICYmIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgY3JlYXRlUGVuZGluZzogZmFsc2UKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgcmV0dXJuIF9yZWYyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9KCkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNsb25lV29ya3BhZCIsCiAgICAvKiNfX1BVUkVfXyovCiAgICBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVmMyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKHdvcmtwYWQpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICBjcmVhdGVQZW5kaW5nOiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucHJvcHMuY2xvbmVXb3JrcGFkKHdvcmtwYWQuaWQpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfdGhpcy5faXNNb3VudGVkICYmIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgY3JlYXRlUGVuZGluZzogZmFsc2UKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gKF94MikgewogICAgICAgIHJldHVybiBfcmVmMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvcGVuUmVtb3ZlQ29uZmlybSIsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBkZWxldGluZ1dvcmtwYWQ6IHRydWUKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjbG9zZVJlbW92ZUNvbmZpcm0iLCBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgZGVsZXRpbmdXb3JrcGFkOiBmYWxzZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbW92ZVdvcmtwYWRzIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZWN0ZWRXb3JrcGFkcyA9IF90aGlzLnN0YXRlLnNlbGVjdGVkV29ya3BhZHM7CgogICAgICBfdGhpcy5wcm9wcy5yZW1vdmVXb3JrcGFkcyhzZWxlY3RlZFdvcmtwYWRzLm1hcChmdW5jdGlvbiAoX3JlZjQpIHsKICAgICAgICB2YXIgaWQgPSBfcmVmNC5pZDsKICAgICAgICByZXR1cm4gaWQ7CiAgICAgIH0pKS50aGVuKGZ1bmN0aW9uIChyZW1haW5pbmdJZHMpIHsKICAgICAgICB2YXIgcmVtYWluaW5nV29ya3BhZHMgPSByZW1haW5pbmdJZHMubGVuZ3RoID4gMCA/IHNlbGVjdGVkV29ya3BhZHMuZmlsdGVyKGZ1bmN0aW9uIChfcmVmNSkgewogICAgICAgICAgdmFyIGlkID0gX3JlZjUuaWQ7CiAgICAgICAgICByZXR1cm4gcmVtYWluaW5nSWRzLmluY2x1ZGVzKGlkKTsKICAgICAgICB9KSA6IFtdOwogICAgICAgIF90aGlzLl9pc01vdW50ZWQgJiYgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgZGVsZXRpbmdXb3JrcGFkOiBmYWxzZSwKICAgICAgICAgIHNlbGVjdGVkV29ya3BhZHM6IHJlbWFpbmluZ1dvcmtwYWRzCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZG93bmxvYWRXb3JrcGFkcyIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc3RhdGUuc2VsZWN0ZWRXb3JrcGFkcy5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmNikgewogICAgICAgIHZhciBpZCA9IF9yZWY2LmlkOwogICAgICAgIHJldHVybiBfdGhpcy5wcm9wcy5kb3dubG9hZFdvcmtwYWQoaWQpOwogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uU2VsZWN0aW9uQ2hhbmdlIiwgZnVuY3Rpb24gKHNlbGVjdGVkV29ya3BhZHMpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNlbGVjdGVkV29ya3BhZHM6IHNlbGVjdGVkV29ya3BhZHMKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblRhYmxlQ2hhbmdlIiwgZnVuY3Rpb24gKF9yZWY3KSB7CiAgICAgIHZhciBfcmVmNyRzb3J0ID0gX3JlZjcuc29ydCwKICAgICAgICAgIHNvcnQgPSBfcmVmNyRzb3J0ID09PSB2b2lkIDAgPyB7fSA6IF9yZWY3JHNvcnQ7CiAgICAgIHZhciBzb3J0RmllbGQgPSBzb3J0LmZpZWxkLAogICAgICAgICAgc29ydERpcmVjdGlvbiA9IHNvcnQuZGlyZWN0aW9uOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNvcnRGaWVsZDogc29ydEZpZWxkLAogICAgICAgIHNvcnREaXJlY3Rpb246IHNvcnREaXJlY3Rpb24KICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZW5kZXJXb3JrcGFkVGFibGUiLCBmdW5jdGlvbiAoX3JlZjgpIHsKICAgICAgdmFyIHJvd3MgPSBfcmVmOC5yb3dzLAogICAgICAgICAgcGFnZU51bWJlciA9IF9yZWY4LnBhZ2VOdW1iZXIsCiAgICAgICAgICB0b3RhbFBhZ2VzID0gX3JlZjgudG90YWxQYWdlcywKICAgICAgICAgIHNldFBhZ2UgPSBfcmVmOC5zZXRQYWdlOwogICAgICB2YXIgX3RoaXMkc3RhdGUgPSBfdGhpcy5zdGF0ZSwKICAgICAgICAgIHNvcnRGaWVsZCA9IF90aGlzJHN0YXRlLnNvcnRGaWVsZCwKICAgICAgICAgIHNvcnREaXJlY3Rpb24gPSBfdGhpcyRzdGF0ZS5zb3J0RGlyZWN0aW9uOwogICAgICB2YXIgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcywKICAgICAgICAgIGNhblVzZXJXcml0ZSA9IF90aGlzJHByb3BzLmNhblVzZXJXcml0ZSwKICAgICAgICAgIGNyZWF0ZVBlbmRpbmcgPSBfdGhpcyRwcm9wcy5jcmVhdGVQZW5kaW5nLAogICAgICAgICAgbG9hZGVkV29ya3BhZCA9IF90aGlzJHByb3BzLndvcmtwYWRJZDsKICAgICAgdmFyIGFjdGlvbnMgPSBbewogICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHdvcmtwYWQpIHsKICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAgICAgIGd1dHRlclNpemU6ICJ4cyIsCiAgICAgICAgICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiCiAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUb29sVGlwLCB7CiAgICAgICAgICAgIGNvbnRlbnQ6IHN0cmluZ3MuZ2V0RXhwb3J0VG9vbFRpcCgpCiAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uSWNvbiwgewogICAgICAgICAgICBpY29uVHlwZTogImV4cG9ydEFjdGlvbiIsCiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnByb3BzLmRvd25sb2FkV29ya3BhZCh3b3JrcGFkLmlkKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImFyaWEtbGFiZWwiOiBzdHJpbmdzLmdldEV4cG9ydFRvb2xUaXAoKQogICAgICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgICAgIGdyb3c6IGZhbHNlCiAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVG9vbFRpcCwgewogICAgICAgICAgICBjb250ZW50OiBjYW5Vc2VyV3JpdGUgPyBzdHJpbmdzLmdldENsb25lVG9vbFRpcCgpIDogc3RyaW5ncy5nZXROb1Blcm1pc3Npb25Ub0Nsb25lVG9vbFRpcCgpCiAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uSWNvbiwgewogICAgICAgICAgICBpY29uVHlwZTogImNvcHkiLAogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5jbG9uZVdvcmtwYWQod29ya3BhZCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJhcmlhLWxhYmVsIjogc3RyaW5ncy5nZXRDbG9uZVRvb2xUaXAoKSwKICAgICAgICAgICAgZGlzYWJsZWQ6ICFjYW5Vc2VyV3JpdGUKICAgICAgICAgIH0pKSkpOwogICAgICAgIH0KICAgICAgfV07CiAgICAgIHZhciBjb2x1bW5zID0gW3sKICAgICAgICBmaWVsZDogJ25hbWUnLAogICAgICAgIG5hbWU6IHN0cmluZ3MuZ2V0VGFibGVOYW1lQ29sdW1uVGl0bGUoKSwKICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICBkYXRhVHlwZTogJ3N0cmluZycsCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIobmFtZSwgd29ya3BhZCkgewogICAgICAgICAgdmFyIHdvcmtwYWROYW1lID0gZ2V0RGlzcGxheU5hbWUobmFtZSwgd29ya3BhZCwgbG9hZGVkV29ya3BhZCk7CiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfbGluay5MaW5rLCB7CiAgICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJjYW52YXNXb3JrcGFkTG9hZGVyV29ya3BhZCIsCiAgICAgICAgICAgIG5hbWU6ICJsb2FkV29ya3BhZCIsCiAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgIGlkOiB3b3JrcGFkLmlkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJhcmlhLWxhYmVsIjogc3RyaW5ncy5nZXRMb2FkV29ya3BhZEFyaWFsTGFiZWwoKQogICAgICAgICAgfSwgd29ya3BhZE5hbWUpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGZpZWxkOiAnQGNyZWF0ZWQnLAogICAgICAgIG5hbWU6IHN0cmluZ3MuZ2V0VGFibGVDcmVhdGVkQ29sdW1uVGl0bGUoKSwKICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICBkYXRhVHlwZTogJ2RhdGUnLAogICAgICAgIHdpZHRoOiAnMjAlJywKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihkYXRlKSB7CiAgICAgICAgICByZXR1cm4gZm9ybWF0RGF0ZShkYXRlKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBmaWVsZDogJ0B0aW1lc3RhbXAnLAogICAgICAgIG5hbWU6IHN0cmluZ3MuZ2V0VGFibGVVcGRhdGVkQ29sdW1uVGl0bGUoKSwKICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICBkYXRhVHlwZTogJ2RhdGUnLAogICAgICAgIHdpZHRoOiAnMjAlJywKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihkYXRlKSB7CiAgICAgICAgICByZXR1cm4gZm9ybWF0RGF0ZShkYXRlKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBuYW1lOiAnJywKICAgICAgICBhY3Rpb25zOiBhY3Rpb25zLAogICAgICAgIHdpZHRoOiAnNSUnCiAgICAgIH1dOwogICAgICB2YXIgc29ydGluZyA9IHsKICAgICAgICBzb3J0OiB7CiAgICAgICAgICBmaWVsZDogc29ydEZpZWxkLAogICAgICAgICAgZGlyZWN0aW9uOiBzb3J0RGlyZWN0aW9uCiAgICAgICAgfQogICAgICB9OwogICAgICB2YXIgc2VsZWN0aW9uID0gewogICAgICAgIGl0ZW1JZDogJ2lkJywKICAgICAgICBvblNlbGVjdGlvbkNoYW5nZTogX3RoaXMub25TZWxlY3Rpb25DaGFuZ2UKICAgICAgfTsKCiAgICAgIHZhciBlbXB0eVRhYmxlID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUVtcHR5UHJvbXB0LCB7CiAgICAgICAgaWNvblR5cGU6ICJpbXBvcnRBY3Rpb24iLAogICAgICAgIHRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoMiIsIG51bGwsIHN0cmluZ3MuZ2V0RW1wdHlQcm9tcHRUaXRsZSgpKSwKICAgICAgICB0aXRsZVNpemU6ICJzIiwKICAgICAgICBib2R5OiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIHN0cmluZ3MuZ2V0RW1wdHlQcm9tcHRHZXR0aW5nU3RhcnRlZERlc2NyaXB0aW9uKCkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgc3RyaW5ncy5nZXRFbXB0eVByb21wdE5ld1VzZXJEZXNjcmlwdGlvbigpLCAnICcsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgICBocmVmOiAia2liYW5hIy9ob21lL3R1dG9yaWFsX2RpcmVjdG9yeS9zYW1wbGVEYXRhIgogICAgICAgIH0sIHN0cmluZ3MuZ2V0U2FtcGxlRGF0YUxpbmtMYWJlbCgpKSwgIi4iKSkKICAgICAgfSk7CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3dvcmtwYWRfZHJvcHpvbmUuV29ya3BhZERyb3B6b25lLCB7CiAgICAgICAgb25VcGxvYWQ6IF90aGlzLm9uVXBsb2FkLAogICAgICAgIGRpc2FibGVkOiBjcmVhdGVQZW5kaW5nIHx8ICFjYW5Vc2VyV3JpdGUKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJhc2ljVGFibGUsIHsKICAgICAgICBpdGVtczogcm93cywKICAgICAgICBpdGVtSWQ6ICJpZCIsCiAgICAgICAgY29sdW1uczogY29sdW1ucywKICAgICAgICBzb3J0aW5nOiBzb3J0aW5nLAogICAgICAgIG5vSXRlbXNNZXNzYWdlOiBlbXB0eVRhYmxlLAogICAgICAgIG9uQ2hhbmdlOiBfdGhpcy5vblRhYmxlQ2hhbmdlLAogICAgICAgIGlzU2VsZWN0YWJsZTogdHJ1ZSwKICAgICAgICBzZWxlY3Rpb246IHNlbGVjdGlvbiwKICAgICAgICBjbGFzc05hbWU6ICJjYW52YXNXb3JrcGFkX19kcm9wem9uZVRhYmxlIiwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiY2FudmFzV29ya3BhZExvYWRlclRhYmxlIgogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICBndXR0ZXJTaXplOiAibm9uZSIsCiAgICAgICAganVzdGlmeUNvbnRlbnQ6ICJmbGV4RW5kIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnaW5hdGlvbiwgewogICAgICAgIGFjdGl2ZVBhZ2U6IHBhZ2VOdW1iZXIsCiAgICAgICAgb25QYWdlQ2xpY2s6IHNldFBhZ2UsCiAgICAgICAgcGFnZUNvdW50OiB0b3RhbFBhZ2VzCiAgICAgIH0pKSkpKTsKICAgIH0pOwoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhXb3JrcGFkTG9hZGVyLCBbewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9jb21wb25lbnREaWRNb3VudCA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAvLyBvbiBjb21wb25lbnQgbG9hZCwga2ljayBvZmYgdGhlIHdvcmtwYWQgc2VhcmNoCiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmZpbmRXb3JrcGFkcygpOyAvLyBrZWVwIHRyYWNrIG9mIHdoZXRoZXIgb3Igbm90IHRoZSBjb21wb25lbnQgaXMgbW91bnRlZCwgdG8gcHJldmVudCByb2d1ZSBzZXRTdGF0ZSBjYWxscwoKICAgICAgICAgICAgICAgIHRoaXMuX2lzTW91bnRlZCA9IHRydWU7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICAgIHJldHVybiBfY29tcG9uZW50RGlkTW91bnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGNvbXBvbmVudERpZE1vdW50OwogICAgfSgpCiAgfSwgewogICAga2V5OiAiVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIFVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5ld1Byb3BzKSB7CiAgICAgIC8vIHRoZSB3b3JrcGFkSWQgcHJvcCB3aWxsIGNoYW5nZSB3aGVuIGEgaXMgY3JlYXRlZCBvciBsb2FkZWQsIGNsb3NlIHRoZSB0b29sYmFyIHdoZW4gaXQgZG9lcwogICAgICB2YXIgX3RoaXMkcHJvcHMyID0gdGhpcy5wcm9wcywKICAgICAgICAgIHdvcmtwYWRJZCA9IF90aGlzJHByb3BzMi53b3JrcGFkSWQsCiAgICAgICAgICBvbkNsb3NlID0gX3RoaXMkcHJvcHMyLm9uQ2xvc2U7CgogICAgICBpZiAod29ya3BhZElkICE9PSBuZXdQcm9wcy53b3JrcGFkSWQpIHsKICAgICAgICBvbkNsb3NlKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsVW5tb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7CiAgICAgIHRoaXMuX2lzTW91bnRlZCA9IGZhbHNlOwogICAgfSAvLyBjcmVhdGUgbmV3IGVtcHR5IHdvcmtwYWQKCiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHN0YXRlMiA9IHRoaXMuc3RhdGUsCiAgICAgICAgICBkZWxldGluZ1dvcmtwYWQgPSBfdGhpcyRzdGF0ZTIuZGVsZXRpbmdXb3JrcGFkLAogICAgICAgICAgY3JlYXRlUGVuZGluZyA9IF90aGlzJHN0YXRlMi5jcmVhdGVQZW5kaW5nLAogICAgICAgICAgc2VsZWN0ZWRXb3JrcGFkcyA9IF90aGlzJHN0YXRlMi5zZWxlY3RlZFdvcmtwYWRzLAogICAgICAgICAgc29ydEZpZWxkID0gX3RoaXMkc3RhdGUyLnNvcnRGaWVsZCwKICAgICAgICAgIHNvcnREaXJlY3Rpb24gPSBfdGhpcyRzdGF0ZTIuc29ydERpcmVjdGlvbjsKICAgICAgdmFyIGNhblVzZXJXcml0ZSA9IHRoaXMucHJvcHMuY2FuVXNlcldyaXRlOwogICAgICB2YXIgaXNMb2FkaW5nID0gdGhpcy5wcm9wcy53b3JrcGFkcyA9PSBudWxsOwoKICAgICAgdmFyIGNyZWF0ZUJ1dHRvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3dvcmtwYWRfY3JlYXRlLldvcmtwYWRDcmVhdGUsIHsKICAgICAgICBjcmVhdGVQZW5kaW5nOiBjcmVhdGVQZW5kaW5nLAogICAgICAgIG9uQ3JlYXRlOiB0aGlzLmNyZWF0ZVdvcmtwYWQsCiAgICAgICAgZGlzYWJsZWQ6ICFjYW5Vc2VyV3JpdGUKICAgICAgfSk7CgogICAgICB2YXIgZGVsZXRlQnV0dG9uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgIGNvbG9yOiAiZGFuZ2VyIiwKICAgICAgICBpY29uVHlwZTogInRyYXNoIiwKICAgICAgICBvbkNsaWNrOiB0aGlzLm9wZW5SZW1vdmVDb25maXJtLAogICAgICAgIGRpc2FibGVkOiAhY2FuVXNlcldyaXRlLAogICAgICAgICJhcmlhLWxhYmVsIjogc3RyaW5ncy5nZXREZWxldGVCdXR0b25BcmlhTGFiZWwoc2VsZWN0ZWRXb3JrcGFkcy5sZW5ndGgpCiAgICAgIH0sIHN0cmluZ3MuZ2V0RGVsZXRlQnV0dG9uTGFiZWwoc2VsZWN0ZWRXb3JrcGFkcy5sZW5ndGgpKTsKCiAgICAgIHZhciBkb3dubG9hZEJ1dHRvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgICAgICBjb2xvcjogInNlY29uZGFyeSIsCiAgICAgICAgb25DbGljazogdGhpcy5kb3dubG9hZFdvcmtwYWRzLAogICAgICAgIGljb25UeXBlOiAiZXhwb3J0QWN0aW9uIiwKICAgICAgICAiYXJpYS1sYWJlbCI6IHN0cmluZ3MuZ2V0RXhwb3J0QnV0dG9uQXJpYUxhYmVsKHNlbGVjdGVkV29ya3BhZHMubGVuZ3RoKQogICAgICB9LCBzdHJpbmdzLmdldEV4cG9ydEJ1dHRvbkxhYmVsKHNlbGVjdGVkV29ya3BhZHMubGVuZ3RoKSk7CgogICAgICB2YXIgdXBsb2FkQnV0dG9uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZpbGVQaWNrZXIsIHsKICAgICAgICBkaXNwbGF5OiAiZGVmYXVsdCIsCiAgICAgICAgY29tcHJlc3NlZDogdHJ1ZSwKICAgICAgICBjbGFzc05hbWU6ICJjYW52YXNXb3JrcGFkX191cGxvYWQtLWNvbXByZXNzZWQiLAogICAgICAgIGluaXRpYWxQcm9tcHRUZXh0OiBzdHJpbmdzLmdldEZpbGVQaWNrZXJQbGFjZWhvbGRlcigpLAogICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShfcmVmOSkgewogICAgICAgICAgdmFyIF9yZWYxMCA9IF9zbGljZWRUb0FycmF5KF9yZWY5LCAxKSwKICAgICAgICAgICAgICBmaWxlID0gX3JlZjEwWzBdOwoKICAgICAgICAgIHJldHVybiAoMCwgX3VwbG9hZF93b3JrcGFkLnVwbG9hZFdvcmtwYWQpKGZpbGUsIF90aGlzMi5vblVwbG9hZCk7CiAgICAgICAgfSwKICAgICAgICBhY2NlcHQ6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICBkaXNhYmxlZDogY3JlYXRlUGVuZGluZyB8fCAhY2FuVXNlcldyaXRlCiAgICAgIH0pOwoKICAgICAgaWYgKCFjYW5Vc2VyV3JpdGUpIHsKICAgICAgICBjcmVhdGVCdXR0b24gPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVG9vbFRpcCwgewogICAgICAgICAgY29udGVudDogc3RyaW5ncy5nZXROb1Blcm1pc3Npb25Ub0NyZWF0ZVRvb2xUaXAoKQogICAgICAgIH0sIGNyZWF0ZUJ1dHRvbik7CiAgICAgICAgZGVsZXRlQnV0dG9uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRvb2xUaXAsIHsKICAgICAgICAgIGNvbnRlbnQ6IHN0cmluZ3MuZ2V0Tm9QZXJtaXNzaW9uVG9EZWxldGVUb29sVGlwKCkKICAgICAgICB9LCBkZWxldGVCdXR0b24pOwogICAgICAgIHVwbG9hZEJ1dHRvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUb29sVGlwLCB7CiAgICAgICAgICBjb250ZW50OiBzdHJpbmdzLmdldE5vUGVybWlzc2lvblRvVXBsb2FkVG9vbFRpcCgpCiAgICAgICAgfSwgdXBsb2FkQnV0dG9uKTsKICAgICAgfQoKICAgICAgdmFyIG1vZGFsVGl0bGUgPSBzZWxlY3RlZFdvcmtwYWRzLmxlbmd0aCA9PT0gMSA/IHN0cmluZ3MuZ2V0RGVsZXRlU2luZ2xlV29ya3BhZE1vZGFsVGl0bGUoc2VsZWN0ZWRXb3JrcGFkc1swXS5uYW1lKSA6IHN0cmluZ3MuZ2V0RGVsZXRlTXVsdGlwbGVXb3JrcGFkTW9kYWxUaXRsZShzZWxlY3RlZFdvcmtwYWRzLmxlbmd0aCk7CgogICAgICB2YXIgY29uZmlybU1vZGFsID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29uZmlybV9tb2RhbC5Db25maXJtTW9kYWwsIHsKICAgICAgICBpc09wZW46IGRlbGV0aW5nV29ya3BhZCwKICAgICAgICB0aXRsZTogbW9kYWxUaXRsZSwKICAgICAgICBtZXNzYWdlOiBzdHJpbmdzLmdldERlbGV0ZU1vZGFsRGVzY3JpcHRpb24oKSwKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogc3RyaW5ncy5nZXREZWxldGVNb2RhbENvbmZpcm1CdXR0b25MYWJlbCgpLAogICAgICAgIG9uQ29uZmlybTogdGhpcy5yZW1vdmVXb3JrcGFkcywKICAgICAgICBvbkNhbmNlbDogdGhpcy5jbG9zZVJlbW92ZUNvbmZpcm0KICAgICAgfSk7CgogICAgICB2YXIgc29ydGVkV29ya3BhZHMgPSBbXTsKCiAgICAgIGlmICghY3JlYXRlUGVuZGluZyAmJiAhaXNMb2FkaW5nKSB7CiAgICAgICAgdmFyIHdvcmtwYWRzID0gdGhpcy5wcm9wcy53b3JrcGFkcy53b3JrcGFkczsKICAgICAgICBzb3J0ZWRXb3JrcGFkcyA9ICgwLCBfbG9kYXNoLnNvcnRCeU9yZGVyKSh3b3JrcGFkcywgW3NvcnRGaWVsZCwgJ0B0aW1lc3RhbXAnXSwgW3NvcnREaXJlY3Rpb24sICdkZXNjJ10pOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcGFnaW5hdGUuUGFnaW5hdGUsIHsKICAgICAgICByb3dzOiBzb3J0ZWRXb3JrcGFkcwogICAgICB9LCBmdW5jdGlvbiAocGFnaW5hdGlvbikgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgICAganVzdGlmeUNvbnRlbnQ6ICJzcGFjZUJldHdlZW4iCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgICBncm93OiAyCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgICAgZ3V0dGVyU2l6ZTogInMiCiAgICAgICAgfSwgc2VsZWN0ZWRXb3JrcGFkcy5sZW5ndGggPiAwICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgIGdyb3c6IGZhbHNlCiAgICAgICAgfSwgZG93bmxvYWRCdXR0b24pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgIGdyb3c6IGZhbHNlCiAgICAgICAgfSwgZGVsZXRlQnV0dG9uKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgICAgZ3JvdzogMQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3dvcmtwYWRfc2VhcmNoLldvcmtwYWRTZWFyY2gsIHsKICAgICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZSh0ZXh0KSB7CiAgICAgICAgICAgIHBhZ2luYXRpb24uc2V0UGFnZSgwKTsKCiAgICAgICAgICAgIF90aGlzMi5wcm9wcy5maW5kV29ya3BhZHModGV4dCk7CiAgICAgICAgICB9CiAgICAgICAgfSkpKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgICAgZ3JvdzogMgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICAgIGd1dHRlclNpemU6ICJzIiwKICAgICAgICAgIGp1c3RpZnlDb250ZW50OiAiZmxleEVuZCIsCiAgICAgICAgICB3cmFwOiB0cnVlCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgICBncm93OiBmYWxzZQogICAgICAgIH0sIHVwbG9hZEJ1dHRvbiksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgICB9LCBjcmVhdGVCdXR0b24pKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCBudWxsKSwgY3JlYXRlUGVuZGluZyAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBzdHlsZTogewogICAgICAgICAgICB3aWR0aDogJzEwMCUnCiAgICAgICAgICB9CiAgICAgICAgfSwgc3RyaW5ncy5nZXRDcmVhdGVXb3JrcGFkTG9hZGluZ0Rlc2NyaXB0aW9uKCkpLCAhY3JlYXRlUGVuZGluZyAmJiBpc0xvYWRpbmcgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgc3R5bGU6IHsKICAgICAgICAgICAgd2lkdGg6ICcxMDAlJwogICAgICAgICAgfQogICAgICAgIH0sIHN0cmluZ3MuZ2V0RmV0Y2hMb2FkaW5nRGVzY3JpcHRpb24oKSksICFjcmVhdGVQZW5kaW5nICYmICFpc0xvYWRpbmcgJiYgX3RoaXMyLnJlbmRlcldvcmtwYWRUYWJsZShwYWdpbmF0aW9uKSwgY29uZmlybU1vZGFsKTsKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gV29ya3BhZExvYWRlcjsKfShfcmVhY3QuZGVmYXVsdC5QdXJlQ29tcG9uZW50KTsKCmV4cG9ydHMuV29ya3BhZExvYWRlciA9IFdvcmtwYWRMb2FkZXI7CgpfZGVmaW5lUHJvcGVydHkoV29ya3BhZExvYWRlciwgInByb3BUeXBlcyIsIHsKICB3b3JrcGFkSWQ6IF9wcm9wVHlwZXMuZGVmYXVsdC5zdHJpbmcuaXNSZXF1aXJlZCwKICBjYW5Vc2VyV3JpdGU6IF9wcm9wVHlwZXMuZGVmYXVsdC5ib29sLmlzUmVxdWlyZWQsCiAgY3JlYXRlV29ya3BhZDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBmaW5kV29ya3BhZHM6IF9wcm9wVHlwZXMuZGVmYXVsdC5mdW5jLmlzUmVxdWlyZWQsCiAgZG93bmxvYWRXb3JrcGFkOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkLAogIGNsb25lV29ya3BhZDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICByZW1vdmVXb3JrcGFkczogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBvbkNsb3NlOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkLAogIHdvcmtwYWRzOiBfcHJvcFR5cGVzLmRlZmF1bHQub2JqZWN0Cn0pOw=="},null]}