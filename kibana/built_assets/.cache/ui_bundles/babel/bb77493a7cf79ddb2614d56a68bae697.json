{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/visualizations/public/np_ready/public/embeddable/visualize_embeddable_factory.js","dependencies":[{"path":"src/legacy/core_plugins/visualizations/public/np_ready/public/embeddable/visualize_embeddable_factory.js","mtime":1589249550166},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuVmlzdWFsaXplRW1iZWRkYWJsZUZhY3RvcnkgPSB2b2lkIDA7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcGx1Z2lucy9lbWJlZGRhYmxlL3B1YmxpYyIpOwoKdmFyIF9kaXNhYmxlZF9sYWJfZW1iZWRkYWJsZSA9IHJlcXVpcmUoIi4vZGlzYWJsZWRfbGFiX2VtYmVkZGFibGUiKTsKCnZhciBfdmlzdWFsaXplX2VtYmVkZGFibGUgPSByZXF1aXJlKCIuL3Zpc3VhbGl6ZV9lbWJlZGRhYmxlIik7Cgp2YXIgX3R5cGVzID0gcmVxdWlyZSgiLi4vdHlwZXMiKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi9jb25zdGFudHMiKTsKCnZhciBfc2VydmljZXMgPSByZXF1aXJlKCIuLi9zZXJ2aWNlcyIpOwoKdmFyIF93aXphcmQgPSByZXF1aXJlKCIuLi93aXphcmQiKTsKCnZhciBfc2F2ZWRfdmlzID0gcmVxdWlyZSgiLi4vc2F2ZWRfdmlzdWFsaXphdGlvbnMvX3NhdmVkX3ZpcyIpOwoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBfdHlwZW9mMihTeW1ib2wuaXRlcmF0b3IpID09PSAic3ltYm9sIikgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9IGVsc2UgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0KCiAgcmV0dXJuIF90eXBlb2Yob2JqKTsKfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgewogIHRyeSB7CiAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7CiAgICB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICByZWplY3QoZXJyb3IpOwogICAgcmV0dXJuOwogIH0KCiAgaWYgKGluZm8uZG9uZSkgewogICAgcmVzb2x2ZSh2YWx1ZSk7CiAgfSBlbHNlIHsKICAgIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsKICB9Cn0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICBhcmdzID0gYXJndW1lbnRzOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOwoKICAgICAgZnVuY3Rpb24gX25leHQodmFsdWUpIHsKICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOwogICAgICB9CgogICAgICBfbmV4dCh1bmRlZmluZWQpOwogICAgfSk7CiAgfTsKfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgfQp9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogIHJldHVybiBDb25zdHJ1Y3RvcjsKfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgewogIGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsKICAgIHJldHVybiBjYWxsOwogIH0KCiAgcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7Cn0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7CiAgfTsKICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwp9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsKICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIHNlbGY7Cn0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOwogIH0KCiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9KTsKICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsKfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgIG8uX19wcm90b19fID0gcDsKICAgIHJldHVybiBvOwogIH07CgogIHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgVmlzdWFsaXplRW1iZWRkYWJsZUZhY3RvcnkgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfRW1iZWRkYWJsZUZhY3RvcnkpIHsKICBfaW5oZXJpdHMoVmlzdWFsaXplRW1iZWRkYWJsZUZhY3RvcnksIF9FbWJlZGRhYmxlRmFjdG9yeSk7CgogIGZ1bmN0aW9uIFZpc3VhbGl6ZUVtYmVkZGFibGVGYWN0b3J5KCkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWaXN1YWxpemVFbWJlZGRhYmxlRmFjdG9yeSk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoVmlzdWFsaXplRW1iZWRkYWJsZUZhY3RvcnkpLmNhbGwodGhpcywgewogICAgICBzYXZlZE9iamVjdE1ldGFEYXRhOiB7CiAgICAgICAgbmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3Zpc3VhbGl6YXRpb25zLnNhdmVkT2JqZWN0TmFtZScsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVmlzdWFsaXphdGlvbicKICAgICAgICB9KSwKICAgICAgICBpbmNsdWRlRmllbGRzOiBbJ3Zpc1N0YXRlJ10sCiAgICAgICAgdHlwZTogJ3Zpc3VhbGl6YXRpb24nLAogICAgICAgIGdldEljb25Gb3JTYXZlZE9iamVjdDogZnVuY3Rpb24gZ2V0SWNvbkZvclNhdmVkT2JqZWN0KHNhdmVkT2JqZWN0KSB7CiAgICAgICAgICByZXR1cm4gKDAsIF9zZXJ2aWNlcy5nZXRUeXBlcykoKS5nZXQoSlNPTi5wYXJzZShzYXZlZE9iamVjdC5hdHRyaWJ1dGVzLnZpc1N0YXRlKS50eXBlKS5pY29uIHx8ICd2aXN1YWxpemVBcHAnOwogICAgICAgIH0sCiAgICAgICAgZ2V0VG9vbHRpcEZvclNhdmVkT2JqZWN0OiBmdW5jdGlvbiBnZXRUb29sdGlwRm9yU2F2ZWRPYmplY3Qoc2F2ZWRPYmplY3QpIHsKICAgICAgICAgIHJldHVybiAiIi5jb25jYXQoc2F2ZWRPYmplY3QuYXR0cmlidXRlcy50aXRsZSwgIiAoIikuY29uY2F0KCgwLCBfc2VydmljZXMuZ2V0VHlwZXMpKCkuZ2V0KEpTT04ucGFyc2Uoc2F2ZWRPYmplY3QuYXR0cmlidXRlcy52aXNTdGF0ZSkudHlwZSkudGl0bGUsICIpIik7CiAgICAgICAgfSwKICAgICAgICBzaG93U2F2ZWRPYmplY3Q6IGZ1bmN0aW9uIHNob3dTYXZlZE9iamVjdChzYXZlZE9iamVjdCkgewogICAgICAgICAgdmFyIHR5cGVOYW1lID0gSlNPTi5wYXJzZShzYXZlZE9iamVjdC5hdHRyaWJ1dGVzLnZpc1N0YXRlKS50eXBlOwogICAgICAgICAgdmFyIHZpc1R5cGUgPSAoMCwgX3NlcnZpY2VzLmdldFR5cGVzKSgpLmdldCh0eXBlTmFtZSk7CgogICAgICAgICAgaWYgKCF2aXNUeXBlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoKDAsIF9zZXJ2aWNlcy5nZXRVSVNldHRpbmdzKSgpLmdldCgndmlzdWFsaXplOmVuYWJsZUxhYnMnKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gdmlzVHlwZS5zdGFnZSAhPT0gJ2V4cGVyaW1lbnRhbCc7CiAgICAgICAgfQogICAgICB9CiAgICB9KSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidHlwZSIsIF9jb25zdGFudHMuVklTVUFMSVpFX0VNQkVEREFCTEVfVFlQRSk7CgogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFZpc3VhbGl6ZUVtYmVkZGFibGVGYWN0b3J5LCBbewogICAga2V5OiAiaXNFZGl0YWJsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2lzRWRpdGFibGUgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsICgwLCBfc2VydmljZXMuZ2V0Q2FwYWJpbGl0aWVzKSgpLnZpc3VhbGl6ZS5zYXZlKTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGlzRWRpdGFibGUoKSB7CiAgICAgICAgcmV0dXJuIF9pc0VkaXRhYmxlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBpc0VkaXRhYmxlOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZ2V0RGlzcGxheU5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERpc3BsYXlOYW1lKCkgewogICAgICByZXR1cm4gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3Zpc3VhbGl6YXRpb25zLmRpc3BsYXlOYW1lJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAndmlzdWFsaXphdGlvbicKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlRnJvbU9iamVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2NyZWF0ZUZyb21PYmplY3QgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMih2aXMsIGlucHV0LCBwYXJlbnQpIHsKICAgICAgICB2YXIgc2F2ZWRWaXN1YWxpemF0aW9ucywgdmlzSWQsIGVkaXRVcmwsIGlzTGFic0VuYWJsZWQsIGluZGV4UGF0dGVybiwgaW5kZXhQYXR0ZXJucywgZWRpdGFibGU7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHNhdmVkVmlzdWFsaXphdGlvbnMgPSAoMCwgX3NlcnZpY2VzLmdldFNhdmVkVmlzdWFsaXphdGlvbnNMb2FkZXIpKCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDE7CiAgICAgICAgICAgICAgICB2aXNJZCA9IHZpcy5pZDsKICAgICAgICAgICAgICAgIGVkaXRVcmwgPSB2aXNJZCA/ICgwLCBfc2VydmljZXMuZ2V0SHR0cCkoKS5iYXNlUGF0aC5wcmVwZW5kKCIvYXBwL2tpYmFuYSIuY29uY2F0KHNhdmVkVmlzdWFsaXphdGlvbnMudXJsRm9yKHZpc0lkKSkpIDogJyc7CiAgICAgICAgICAgICAgICBpc0xhYnNFbmFibGVkID0gKDAsIF9zZXJ2aWNlcy5nZXRVSVNldHRpbmdzKSgpLmdldCgndmlzdWFsaXplOmVuYWJsZUxhYnMnKTsKCiAgICAgICAgICAgICAgICBpZiAoISghaXNMYWJzRW5hYmxlZCAmJiB2aXMudHlwZS5zdGFnZSA9PT0gJ2V4cGVyaW1lbnRhbCcpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIG5ldyBfZGlzYWJsZWRfbGFiX2VtYmVkZGFibGUuRGlzYWJsZWRMYWJFbWJlZGRhYmxlKHZpcy50aXRsZSwgaW5wdXQpKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgaW5kZXhQYXR0ZXJuID0gdmlzLmRhdGEuaW5kZXhQYXR0ZXJuOwogICAgICAgICAgICAgICAgaW5kZXhQYXR0ZXJucyA9IGluZGV4UGF0dGVybiA/IFtpbmRleFBhdHRlcm5dIDogW107CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNFZGl0YWJsZSgpOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgZWRpdGFibGUgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBuZXcgX3Zpc3VhbGl6ZV9lbWJlZGRhYmxlLlZpc3VhbGl6ZUVtYmVkZGFibGUoKDAsIF9zZXJ2aWNlcy5nZXRUaW1lRmlsdGVyKSgpLCB7CiAgICAgICAgICAgICAgICAgIHZpczogdmlzLAogICAgICAgICAgICAgICAgICBpbmRleFBhdHRlcm5zOiBpbmRleFBhdHRlcm5zLAogICAgICAgICAgICAgICAgICBlZGl0VXJsOiBlZGl0VXJsLAogICAgICAgICAgICAgICAgICBlZGl0YWJsZTogZWRpdGFibGUsCiAgICAgICAgICAgICAgICAgIGFwcFN0YXRlOiBpbnB1dC5hcHBTdGF0ZSwKICAgICAgICAgICAgICAgICAgdWlTdGF0ZTogaW5wdXQudWlTdGF0ZQogICAgICAgICAgICAgICAgfSwgaW5wdXQsIHBhcmVudCkpOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAxNTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MlsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoX2NvbnRleHQyLnQwKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIG5ldyBfcHVibGljLkVycm9yRW1iZWRkYWJsZShfY29udGV4dDIudDAsIGlucHV0LCBwYXJlbnQpKTsKCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcywgW1sxLCAxNV1dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gY3JlYXRlRnJvbU9iamVjdChfeCwgX3gyLCBfeDMpIHsKICAgICAgICByZXR1cm4gX2NyZWF0ZUZyb21PYmplY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGNyZWF0ZUZyb21PYmplY3Q7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJjcmVhdGVGcm9tU2F2ZWRPYmplY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9jcmVhdGVGcm9tU2F2ZWRPYmplY3QgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhzYXZlZE9iamVjdElkLCBpbnB1dCwgcGFyZW50KSB7CiAgICAgICAgdmFyIHNhdmVkVmlzdWFsaXphdGlvbnMsIHNhdmVkT2JqZWN0LCB2aXM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHNhdmVkVmlzdWFsaXphdGlvbnMgPSAoMCwgX3NlcnZpY2VzLmdldFNhdmVkVmlzdWFsaXphdGlvbnNMb2FkZXIpKCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDE7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gc2F2ZWRWaXN1YWxpemF0aW9ucy5nZXQoc2F2ZWRPYmplY3RJZCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIHNhdmVkT2JqZWN0ID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfdHlwZXMuVmlzOwogICAgICAgICAgICAgICAgX2NvbnRleHQzLnQxID0gc2F2ZWRPYmplY3QudmlzU3RhdGUudHlwZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX3NhdmVkX3Zpcy5jb252ZXJ0VG9TZXJpYWxpemVkVmlzKShzYXZlZE9iamVjdCk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIF9jb250ZXh0My50MiA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgdmlzID0gbmV3IF9jb250ZXh0My50MChfY29udGV4dDMudDEsIF9jb250ZXh0My50Mik7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgdGhpcy5jcmVhdGVGcm9tT2JqZWN0KHZpcywgaW5wdXQsIHBhcmVudCkpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAxNDsKICAgICAgICAgICAgICAgIF9jb250ZXh0My50MyA9IF9jb250ZXh0M1siY2F0Y2giXSgxKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoX2NvbnRleHQzLnQzKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIG5ldyBfcHVibGljLkVycm9yRW1iZWRkYWJsZShfY29udGV4dDMudDMsIGlucHV0LCBwYXJlbnQpKTsKCiAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcywgW1sxLCAxNF1dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gY3JlYXRlRnJvbVNhdmVkT2JqZWN0KF94NCwgX3g1LCBfeDYpIHsKICAgICAgICByZXR1cm4gX2NyZWF0ZUZyb21TYXZlZE9iamVjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gY3JlYXRlRnJvbVNhdmVkT2JqZWN0OwogICAgfSgpCiAgfSwgewogICAga2V5OiAiY3JlYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfY3JlYXRlID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIC8vIFRPRE86IFRoaXMgaXMgYSBiaXQgb2YgYSBoYWNrIHRvIHByZXNlcnZlIHRoZSBvcmlnaW5hbCBmdW5jdGlvbmFsaXR5LiBJZGVhbGx5IHdlIHdpbGwgY2xlYW4gdGhpcyB1cAogICAgICAgICAgICAgICAgLy8gdG8gYWxsb3cgZm9yIGluIHBsYWNlIGNyZWF0aW9uIG9mIHZpc3VhbGl6YXRpb25zIHdpdGhvdXQgaGF2aW5nIHRvIG5hdmlnYXRlIGF3YXkgdG8gYSBuZXcgVVJMLgogICAgICAgICAgICAgICAgKDAsIF93aXphcmQuc2hvd05ld1Zpc01vZGFsKSh7CiAgICAgICAgICAgICAgICAgIGVkaXRvclBhcmFtczogWydhZGRUb0Rhc2hib2FyZCddCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCB1bmRlZmluZWQpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBjcmVhdGUoKSB7CiAgICAgICAgcmV0dXJuIF9jcmVhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGNyZWF0ZTsKICAgIH0oKQogIH1dKTsKCiAgcmV0dXJuIFZpc3VhbGl6ZUVtYmVkZGFibGVGYWN0b3J5Owp9KF9wdWJsaWMuRW1iZWRkYWJsZUZhY3RvcnkpOwoKZXhwb3J0cy5WaXN1YWxpemVFbWJlZGRhYmxlRmFjdG9yeSA9IFZpc3VhbGl6ZUVtYmVkZGFibGVGYWN0b3J5Ow=="},null]}