{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/plugins/infra/public/utils/use_tracked_promise.js","dependencies":[{"path":"x-pack/plugins/infra/public/utils/use_tracked_promise.js","mtime":1589249554341},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuU2lsZW50Q2FuY2VsZWRQcm9taXNlRXJyb3IgPSBleHBvcnRzLkNhbmNlbGVkUHJvbWlzZUVycm9yID0gZXhwb3J0cy51c2VUcmFja2VkUHJvbWlzZSA9IHZvaWQgMDsKCnZhciBfcmVhY3QgPSByZXF1aXJlKCJyZWFjdCIpOwoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBfdHlwZW9mMihTeW1ib2wuaXRlcmF0b3IpID09PSAic3ltYm9sIikgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9IGVsc2UgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0KCiAgcmV0dXJuIF90eXBlb2Yob2JqKTsKfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsKICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIHNlbGY7Cn0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOwogIH0KCiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9KTsKICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsKfQoKZnVuY3Rpb24gX3dyYXBOYXRpdmVTdXBlcihDbGFzcykgewogIHZhciBfY2FjaGUgPSB0eXBlb2YgTWFwID09PSAiZnVuY3Rpb24iID8gbmV3IE1hcCgpIDogdW5kZWZpbmVkOwoKICBfd3JhcE5hdGl2ZVN1cGVyID0gZnVuY3Rpb24gX3dyYXBOYXRpdmVTdXBlcihDbGFzcykgewogICAgaWYgKENsYXNzID09PSBudWxsIHx8ICFfaXNOYXRpdmVGdW5jdGlvbihDbGFzcykpIHJldHVybiBDbGFzczsKCiAgICBpZiAodHlwZW9mIENsYXNzICE9PSAiZnVuY3Rpb24iKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7CiAgICB9CgogICAgaWYgKHR5cGVvZiBfY2FjaGUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIGlmIChfY2FjaGUuaGFzKENsYXNzKSkgcmV0dXJuIF9jYWNoZS5nZXQoQ2xhc3MpOwoKICAgICAgX2NhY2hlLnNldChDbGFzcywgV3JhcHBlcik7CiAgICB9CgogICAgZnVuY3Rpb24gV3JhcHBlcigpIHsKICAgICAgcmV0dXJuIF9jb25zdHJ1Y3QoQ2xhc3MsIGFyZ3VtZW50cywgX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yKTsKICAgIH0KCiAgICBXcmFwcGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQ2xhc3MucHJvdG90eXBlLCB7CiAgICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgICAgdmFsdWU6IFdyYXBwZXIsCiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihXcmFwcGVyLCBDbGFzcyk7CiAgfTsKCiAgcmV0dXJuIF93cmFwTmF0aXZlU3VwZXIoQ2xhc3MpOwp9CgpmdW5jdGlvbiBpc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7CiAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsKICBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOwogIGlmICh0eXBlb2YgUHJveHkgPT09ICJmdW5jdGlvbiIpIHJldHVybiB0cnVlOwoKICB0cnkgewogICAgRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChEYXRlLCBbXSwgZnVuY3Rpb24gKCkge30pKTsKICAgIHJldHVybiB0cnVlOwogIH0gY2F0Y2ggKGUpIHsKICAgIHJldHVybiBmYWxzZTsKICB9Cn0KCmZ1bmN0aW9uIF9jb25zdHJ1Y3QoUGFyZW50LCBhcmdzLCBDbGFzcykgewogIGlmIChpc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSkgewogICAgX2NvbnN0cnVjdCA9IFJlZmxlY3QuY29uc3RydWN0OwogIH0gZWxzZSB7CiAgICBfY29uc3RydWN0ID0gZnVuY3Rpb24gX2NvbnN0cnVjdChQYXJlbnQsIGFyZ3MsIENsYXNzKSB7CiAgICAgIHZhciBhID0gW251bGxdOwogICAgICBhLnB1c2guYXBwbHkoYSwgYXJncyk7CiAgICAgIHZhciBDb25zdHJ1Y3RvciA9IEZ1bmN0aW9uLmJpbmQuYXBwbHkoUGFyZW50LCBhKTsKICAgICAgdmFyIGluc3RhbmNlID0gbmV3IENvbnN0cnVjdG9yKCk7CiAgICAgIGlmIChDbGFzcykgX3NldFByb3RvdHlwZU9mKGluc3RhbmNlLCBDbGFzcy5wcm90b3R5cGUpOwogICAgICByZXR1cm4gaW5zdGFuY2U7CiAgICB9OwogIH0KCiAgcmV0dXJuIF9jb25zdHJ1Y3QuYXBwbHkobnVsbCwgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2lzTmF0aXZlRnVuY3Rpb24oZm4pIHsKICByZXR1cm4gRnVuY3Rpb24udG9TdHJpbmcuY2FsbChmbikuaW5kZXhPZigiW25hdGl2ZSBjb2RlXSIpICE9PSAtMTsKfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgIG8uX19wcm90b19fID0gcDsKICAgIHJldHVybiBvOwogIH07CgogIHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7Cn0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7CiAgfTsKICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICB9CgogICAgcmV0dXJuIGFycjI7CiAgfQp9CgpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsKICByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgewogIHZhciBfYXJyID0gW107CiAgdmFyIF9uID0gdHJ1ZTsKICB2YXIgX2QgPSBmYWxzZTsKICB2YXIgX2UgPSB1bmRlZmluZWQ7CgogIHRyeSB7CiAgICBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7CiAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7CgogICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfZCA9IHRydWU7CiAgICBfZSA9IGVycjsKICB9IGZpbmFsbHkgewogICAgdHJ5IHsKICAgICAgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBpZiAoX2QpIHRocm93IF9lOwogICAgfQogIH0KCiAgcmV0dXJuIF9hcnI7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOwp9Ci8qKgogKiBUaGlzIGhvb2sgbWFuYWdlcyBhIFByb21pc2UgZmFjdG9yeSBhbmQgY2FuIGNyZWF0ZSBuZXcgUHJvbWlzZXMgZnJvbSBpdC4gVGhlCiAqIHN0YXRlIG9mIHRoZXNlIFByb21pc2VzIGlzIHRyYWNrZWQgYW5kIHRoZXkgY2FuIGJlIGNhbmNlbGVkIHdoZW4gc3VwZXJzZWRlZAogKiB0byBhdm9pZCByYWNlIGNvbmRpdGlvbnMuCiAqCiAqIGBgYAogKiBjb25zdCBbcmVxdWVzdFN0YXRlLCBwZXJmb3JtUmVxdWVzdF0gPSB1c2VUcmFja2VkUHJvbWlzZSgKICogICB7CiAqICAgICBjYW5jZWxQcmV2aW91c09uOiAncmVzb2x1dGlvbicsCiAqICAgICBjcmVhdGVQcm9taXNlOiBhc3luYyAodXJsOiBzdHJpbmcpID0+IHsKICogICAgICAgcmV0dXJuIGF3YWl0IGZldGNoU29tZXRoaW5nKHVybCkKICogICAgIH0sCiAqICAgICBvblJlc29sdmU6IHJlc3BvbnNlID0+IHsKICogICAgICAgc2V0U29tZVN0YXRlKHJlc3BvbnNlLmRhdGEpOwogKiAgICAgfSwKICogICAgIG9uUmVqZWN0OiByZXNwb25zZSA9PiB7CiAqICAgICAgIHNldFNvbWVFcnJvcihyZXNwb25zZSk7CiAqICAgICB9LAogKiAgIH0sCiAqICAgW2ZldGNoU29tZXRoaW5nXQogKiApOwogKiBgYGAKICoKICogVGhlIGBvblJlc29sdmVgIGFuZCBgb25SZWplY3RgIGhhbmRsZXJzIGFyZSByZWdpc3RlcmVkIHNlcGFyYXRlbHksIGJlY2F1c2UKICogdGhlIGhvb2sgd2lsbCBpbmplY3QgYSByZWplY3Rpb24gd2hlbiBpbiBjYXNlIG9mIGEgY2FuZWxsYXRpb24uIFRoZQogKiBgY2FuY2VsUHJldmlvdXNPbmAgYXR0cmlidXRlIGNhbiBiZSB1c2VkIHRvIGluZGljYXRlIHdoZW4gdGhlIHByZWNlZGluZwogKiBwZW5kaW5nIHByb21pc2VzIHNob3VsZCBiZSBjYW5jZWxlZDoKICoKICogJ25ldmVyJzogTm8gcHJlY2VkaW5nIHByb21pc2VzIHdpbGwgYmUgY2FuY2VsZWQuCiAqCiAqICdjcmVhdGlvbic6IEFueSBwcmVjZWRpbmcgcHJvbWlzZXMgd2lsbCBiZSBjYW5jZWxlZCBhcyBzb29uIGFzIGEgbmV3IG9uZSBpcwogKiBjcmVhdGVkLgogKgogKiAnc2V0dGxlbWVudCc6IEFueSBwcmVjZWRpbmcgcHJvbWlzZSB3aWxsIGJlIGNhbmNlbGVkIHdoZW4gYSBuZXdlciBwcm9taXNlIGlzCiAqIHJlc29sdmVkIG9yIHJlamVjdGVkLgogKgogKiAncmVzb2x1dGlvbic6IEFueSBwcmVjZWRpbmcgcHJvbWlzZSB3aWxsIGJlIGNhbmNlbGVkIHdoZW4gYSBuZXdlciBwcm9taXNlIGlzCiAqIHJlc29sdmVkLgogKgogKiAncmVqZWN0aW9uJzogQW55IHByZWNlZGluZyBwcm9taXNlIHdpbGwgYmUgY2FuY2VsZWQgd2hlbiBhIG5ld2VyIHByb21pc2UgaXMKICogcmVqZWN0ZWQuCiAqCiAqIEFueSBwZW5kaW5nIHByb21pc2VzIHdpbGwgYmUgY2FuY2VsZWQgd2hlbiB0aGUgY29tcG9uZW50IHVzaW5nIHRoZSBob29rIGlzCiAqIHVubW91bnRlZCwgYnV0IHRoZWlyIHN0YXR1cyB3aWxsIG5vdCBiZSB0cmFja2VkIHRvIGF2b2lkIFJlYWN0IHdhcm5pbmdzCiAqIGFib3V0IG1lbW9yeSBsZWFrcy4KICoKICogVGhlIGxhc3QgYXJndW1lbnQgaXMgYSBub3JtYWwgUmVhY3QgaG9vayBkZXBlbmRlbmN5IGxpc3QgdGhhdCBpbmRpY2F0ZXMKICogdW5kZXIgd2hpY2ggY29uZGl0aW9ucyBhIG5ldyByZWZlcmVuY2UgdG8gdGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IHNob3VsZCBiZQogKiB1c2VkLgogKi8KCgp2YXIgdXNlVHJhY2tlZFByb21pc2UgPSBmdW5jdGlvbiB1c2VUcmFja2VkUHJvbWlzZShfcmVmLCBkZXBlbmRlbmNpZXMpIHsKICB2YXIgY3JlYXRlUHJvbWlzZSA9IF9yZWYuY3JlYXRlUHJvbWlzZSwKICAgICAgX3JlZiRvblJlc29sdmUgPSBfcmVmLm9uUmVzb2x2ZSwKICAgICAgb25SZXNvbHZlID0gX3JlZiRvblJlc29sdmUgPT09IHZvaWQgMCA/IG5vT3AgOiBfcmVmJG9uUmVzb2x2ZSwKICAgICAgX3JlZiRvblJlamVjdCA9IF9yZWYub25SZWplY3QsCiAgICAgIG9uUmVqZWN0ID0gX3JlZiRvblJlamVjdCA9PT0gdm9pZCAwID8gbm9PcCA6IF9yZWYkb25SZWplY3QsCiAgICAgIF9yZWYkY2FuY2VsUHJldmlvdXNPbiA9IF9yZWYuY2FuY2VsUHJldmlvdXNPbiwKICAgICAgY2FuY2VsUHJldmlvdXNPbiA9IF9yZWYkY2FuY2VsUHJldmlvdXNPbiA9PT0gdm9pZCAwID8gJ25ldmVyJyA6IF9yZWYkY2FuY2VsUHJldmlvdXNPbjsKICAvKioKICAgKiBJZiBhIHByb21pc2UgaXMgY3VycmVudGx5IHBlbmRpbmcsIHRoaXMgaG9sZHMgYSByZWZlcmVuY2UgdG8gaXQgYW5kIGl0cwogICAqIGNhbmNlbGxhdGlvbiBmdW5jdGlvbi4KICAgKi8KCiAgdmFyIHBlbmRpbmdQcm9taXNlcyA9ICgwLCBfcmVhY3QudXNlUmVmKShbXSk7CiAgLyoqCiAgICogVGhlIHN0YXRlIG9mIHRoZSBwcm9taXNlIG1vc3QgcmVjZW50bHkgY3JlYXRlZCBieSB0aGUgYGNyZWF0ZVByb21pc2VgCiAgICogZmFjdG9yeS4gSXQgY291bGQgYmUgdW5pbml0aWFsaXplZCwgcGVuZGluZywgcmVzb2x2ZWQgb3IgcmVqZWN0ZWQuCiAgICovCgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSh7CiAgICBzdGF0ZTogJ3VuaW5pdGlhbGl6ZWQnCiAgfSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBwcm9taXNlU3RhdGUgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRQcm9taXNlU3RhdGUgPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgZXhlY3V0ZSA9ICgwLCBfcmVhY3QudXNlTWVtbykoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHJlamVjdENhbmNlbGxhdGlvblByb21pc2U7CiAgICAgIHZhciBjYW5jZWxsYXRpb25Qcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKF8sIHJlamVjdCkgewogICAgICAgIHJlamVjdENhbmNlbGxhdGlvblByb21pc2UgPSByZWplY3Q7CiAgICAgIH0pOyAvLyByZW1lbWJlciB0aGUgbGlzdCBvZiBwcmlvciBwZW5kaW5nIHByb21pc2VzIGZvciBjYW5jZWxsYXRpb24KCiAgICAgIHZhciBwcmV2aW91c1BlbmRpbmdQcm9taXNlcyA9IHBlbmRpbmdQcm9taXNlcy5jdXJyZW50OwoKICAgICAgdmFyIGNhbmNlbFByZXZpb3VzUGVuZGluZ1Byb21pc2VzID0gZnVuY3Rpb24gY2FuY2VsUHJldmlvdXNQZW5kaW5nUHJvbWlzZXMoKSB7CiAgICAgICAgcHJldmlvdXNQZW5kaW5nUHJvbWlzZXMuZm9yRWFjaChmdW5jdGlvbiAocHJvbWlzZSkgewogICAgICAgICAgcmV0dXJuIHByb21pc2UuY2FuY2VsKCk7CiAgICAgICAgfSk7CiAgICAgIH07CgogICAgICB2YXIgbmV3UHJvbWlzZSA9IGNyZWF0ZVByb21pc2UuYXBwbHkodm9pZCAwLCBhcmd1bWVudHMpOwogICAgICB2YXIgbmV3Q2FuY2VsYWJsZVByb21pc2UgPSBQcm9taXNlLnJhY2UoW25ld1Byb21pc2UsIGNhbmNlbGxhdGlvblByb21pc2VdKTsgLy8gdHJhY2sgdGhpcyBuZXcgc3RhdGUKCiAgICAgIHNldFByb21pc2VTdGF0ZSh7CiAgICAgICAgc3RhdGU6ICdwZW5kaW5nJywKICAgICAgICBwcm9taXNlOiBuZXdDYW5jZWxhYmxlUHJvbWlzZQogICAgICB9KTsKCiAgICAgIGlmIChjYW5jZWxQcmV2aW91c09uID09PSAnY3JlYXRpb24nKSB7CiAgICAgICAgY2FuY2VsUHJldmlvdXNQZW5kaW5nUHJvbWlzZXMoKTsKICAgICAgfQoKICAgICAgdmFyIG5ld1BlbmRpbmdQcm9taXNlID0gewogICAgICAgIGNhbmNlbDogZnVuY3Rpb24gY2FuY2VsKCkgewogICAgICAgICAgcmVqZWN0Q2FuY2VsbGF0aW9uUHJvbWlzZShuZXcgQ2FuY2VsZWRQcm9taXNlRXJyb3IoKSk7CiAgICAgICAgfSwKICAgICAgICBjYW5jZWxTaWxlbnRseTogZnVuY3Rpb24gY2FuY2VsU2lsZW50bHkoKSB7CiAgICAgICAgICByZWplY3RDYW5jZWxsYXRpb25Qcm9taXNlKG5ldyBTaWxlbnRDYW5jZWxlZFByb21pc2VFcnJvcigpKTsKICAgICAgICB9LAogICAgICAgIHByb21pc2U6IG5ld0NhbmNlbGFibGVQcm9taXNlLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICBzZXRQcm9taXNlU3RhdGUoZnVuY3Rpb24gKHByZXZpb3VzUHJvbWlzZVN0YXRlKSB7CiAgICAgICAgICAgIHJldHVybiBwcmV2aW91c1Byb21pc2VTdGF0ZS5zdGF0ZSA9PT0gJ3BlbmRpbmcnICYmIHByZXZpb3VzUHJvbWlzZVN0YXRlLnByb21pc2UgPT09IG5ld0NhbmNlbGFibGVQcm9taXNlID8gewogICAgICAgICAgICAgIHN0YXRlOiAncmVzb2x2ZWQnLAogICAgICAgICAgICAgIHByb21pc2U6IG5ld1BlbmRpbmdQcm9taXNlLnByb21pc2UsCiAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgICAgICAgIH0gOiBwcmV2aW91c1Byb21pc2VTdGF0ZTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGlmIChbJ3NldHRsZW1lbnQnLCAncmVzb2x1dGlvbiddLmluY2x1ZGVzKGNhbmNlbFByZXZpb3VzT24pKSB7CiAgICAgICAgICAgIGNhbmNlbFByZXZpb3VzUGVuZGluZ1Byb21pc2VzKCk7CiAgICAgICAgICB9IC8vIHJlbW92ZSBpdHNlbGYgZnJvbSB0aGUgbGlzdCBvZiBwZW5kaW5nIHByb21pc2VzCgoKICAgICAgICAgIHBlbmRpbmdQcm9taXNlcy5jdXJyZW50ID0gcGVuZGluZ1Byb21pc2VzLmN1cnJlbnQuZmlsdGVyKGZ1bmN0aW9uIChwZW5kaW5nUHJvbWlzZSkgewogICAgICAgICAgICByZXR1cm4gcGVuZGluZ1Byb21pc2UucHJvbWlzZSAhPT0gbmV3UGVuZGluZ1Byb21pc2UucHJvbWlzZTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGlmIChvblJlc29sdmUpIHsKICAgICAgICAgICAgb25SZXNvbHZlKHZhbHVlKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfSwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIFNpbGVudENhbmNlbGVkUHJvbWlzZUVycm9yKSkgewogICAgICAgICAgICBzZXRQcm9taXNlU3RhdGUoZnVuY3Rpb24gKHByZXZpb3VzUHJvbWlzZVN0YXRlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHByZXZpb3VzUHJvbWlzZVN0YXRlLnN0YXRlID09PSAncGVuZGluZycgJiYgcHJldmlvdXNQcm9taXNlU3RhdGUucHJvbWlzZSA9PT0gbmV3Q2FuY2VsYWJsZVByb21pc2UgPyB7CiAgICAgICAgICAgICAgICBzdGF0ZTogJ3JlamVjdGVkJywKICAgICAgICAgICAgICAgIHByb21pc2U6IG5ld0NhbmNlbGFibGVQcm9taXNlLAogICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgICAgICAgICAgfSA6IHByZXZpb3VzUHJvbWlzZVN0YXRlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoWydzZXR0bGVtZW50JywgJ3JlamVjdGlvbiddLmluY2x1ZGVzKGNhbmNlbFByZXZpb3VzT24pKSB7CiAgICAgICAgICAgIGNhbmNlbFByZXZpb3VzUGVuZGluZ1Byb21pc2VzKCk7CiAgICAgICAgICB9IC8vIHJlbW92ZSBpdHNlbGYgZnJvbSB0aGUgbGlzdCBvZiBwZW5kaW5nIHByb21pc2VzCgoKICAgICAgICAgIHBlbmRpbmdQcm9taXNlcy5jdXJyZW50ID0gcGVuZGluZ1Byb21pc2VzLmN1cnJlbnQuZmlsdGVyKGZ1bmN0aW9uIChwZW5kaW5nUHJvbWlzZSkgewogICAgICAgICAgICByZXR1cm4gcGVuZGluZ1Byb21pc2UucHJvbWlzZSAhPT0gbmV3UGVuZGluZ1Byb21pc2UucHJvbWlzZTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGlmIChvblJlamVjdCkgewogICAgICAgICAgICBvblJlamVjdCh2YWx1ZSk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhyb3cgdmFsdWU7CiAgICAgICAgfSkKICAgICAgfTsgLy8gYWRkIHRoZSBuZXcgcHJvbWlzZSB0byB0aGUgbGlzdCBvZiBwZW5kaW5nIHByb21pc2VzCgogICAgICBwZW5kaW5nUHJvbWlzZXMuY3VycmVudCA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkocGVuZGluZ1Byb21pc2VzLmN1cnJlbnQpLCBbbmV3UGVuZGluZ1Byb21pc2VdKTsgLy8gc2lsZW5jZSAidW5oYW5kbGVkIHJlamVjdGlvbiIgd2FybmluZ3MKCiAgICAgIG5ld1BlbmRpbmdQcm9taXNlLnByb21pc2UuY2F0Y2gobm9PcCk7CiAgICAgIHJldHVybiBuZXdQZW5kaW5nUHJvbWlzZS5wcm9taXNlOwogICAgfTsKICB9LCAvLyB0aGUgZGVwZW5kZW5jaWVzIGFyZSBtYW5hZ2VkIGJ5IHRoZSBjYWxsZXIKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzCiAgZGVwZW5kZW5jaWVzKTsKICAvKioKICAgKiBDYW5jZWwgYW55IHBlbmRpbmcgcHJvbWlzZXMgc2lsZW50bHkgdG8gYXZvaWQgbWVtb3J5IGxlYWtzIGFuZCByYWNlCiAgICogY29uZGl0aW9ucy4KICAgKi8KCiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIHBlbmRpbmdQcm9taXNlcy5jdXJyZW50LmZvckVhY2goZnVuY3Rpb24gKHByb21pc2UpIHsKICAgICAgICByZXR1cm4gcHJvbWlzZS5jYW5jZWxTaWxlbnRseSgpOwogICAgICB9KTsKICAgIH07CiAgfSwgW10pOwogIHJldHVybiBbcHJvbWlzZVN0YXRlLCBleGVjdXRlXTsKfTsKCmV4cG9ydHMudXNlVHJhY2tlZFByb21pc2UgPSB1c2VUcmFja2VkUHJvbWlzZTsKCnZhciBDYW5jZWxlZFByb21pc2VFcnJvciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9FcnJvcikgewogIF9pbmhlcml0cyhDYW5jZWxlZFByb21pc2VFcnJvciwgX0Vycm9yKTsKCiAgZnVuY3Rpb24gQ2FuY2VsZWRQcm9taXNlRXJyb3IobWVzc2FnZSkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDYW5jZWxlZFByb21pc2VFcnJvcik7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoQ2FuY2VsZWRQcm9taXNlRXJyb3IpLmNhbGwodGhpcywgbWVzc2FnZSkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImlzQ2FuY2VsZWQiLCB0cnVlKTsKCiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICh0aGlzIGluc3RhbmNlb2YgQ2FuY2VsZWRQcm9taXNlRXJyb3IgPyB0aGlzLmNvbnN0cnVjdG9yIDogdm9pZCAwKS5wcm90b3R5cGUpOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgcmV0dXJuIENhbmNlbGVkUHJvbWlzZUVycm9yOwp9KF93cmFwTmF0aXZlU3VwZXIoRXJyb3IpKTsKCmV4cG9ydHMuQ2FuY2VsZWRQcm9taXNlRXJyb3IgPSBDYW5jZWxlZFByb21pc2VFcnJvcjsKCnZhciBTaWxlbnRDYW5jZWxlZFByb21pc2VFcnJvciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9DYW5jZWxlZFByb21pc2VFcnJvcikgewogIF9pbmhlcml0cyhTaWxlbnRDYW5jZWxlZFByb21pc2VFcnJvciwgX0NhbmNlbGVkUHJvbWlzZUVycm9yKTsKCiAgZnVuY3Rpb24gU2lsZW50Q2FuY2VsZWRQcm9taXNlRXJyb3IoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2lsZW50Q2FuY2VsZWRQcm9taXNlRXJyb3IpOwoKICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoU2lsZW50Q2FuY2VsZWRQcm9taXNlRXJyb3IpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogIH0KCiAgcmV0dXJuIFNpbGVudENhbmNlbGVkUHJvbWlzZUVycm9yOwp9KENhbmNlbGVkUHJvbWlzZUVycm9yKTsKCmV4cG9ydHMuU2lsZW50Q2FuY2VsZWRQcm9taXNlRXJyb3IgPSBTaWxlbnRDYW5jZWxlZFByb21pc2VFcnJvcjsKCnZhciBub09wID0gZnVuY3Rpb24gbm9PcCgpIHsKICByZXR1cm4gdW5kZWZpbmVkOwp9Ow=="},null]}