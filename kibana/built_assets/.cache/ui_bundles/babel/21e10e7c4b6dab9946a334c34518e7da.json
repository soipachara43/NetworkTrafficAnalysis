{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/store/timeline/epic.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/store/timeline/epic.js","mtime":1589249553348},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmNvbnZlcnRUaW1lbGluZUFzSW5wdXQgPSBleHBvcnRzLmNyZWF0ZVRpbWVsaW5lRXBpYyA9IHZvaWQgMDsKCnZhciBfZnAgPSByZXF1aXJlKCJsb2Rhc2gvZnAiKTsKCnZhciBfcnhqcyA9IHJlcXVpcmUoInJ4anMiKTsKCnZhciBfb3BlcmF0b3JzID0gcmVxdWlyZSgicnhqcy9vcGVyYXRvcnMiKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3BsdWdpbnMvZGF0YS9wdWJsaWMiKTsKCnZhciBfcGVyc2lzdCA9IHJlcXVpcmUoIi4uLy4uL2NvbnRhaW5lcnMvdGltZWxpbmUvcGVyc2lzdC5ncWxfcXVlcnkiKTsKCnZhciBfYWN0aW9ucyA9IHJlcXVpcmUoIi4uL2FwcC9hY3Rpb25zIik7Cgp2YXIgX2FjdGlvbnMyID0gcmVxdWlyZSgiLi9hY3Rpb25zIik7Cgp2YXIgX2VwaWNfbm90ZSA9IHJlcXVpcmUoIi4vZXBpY19ub3RlIik7Cgp2YXIgX2VwaWNfcGlubmVkX2V2ZW50ID0gcmVxdWlyZSgiLi9lcGljX3Bpbm5lZF9ldmVudCIpOwoKdmFyIF9lcGljX2Zhdm9yaXRlID0gcmVxdWlyZSgiLi9lcGljX2Zhdm9yaXRlIik7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuL2hlbHBlcnMiKTsKCnZhciBfZXBpY19kaXNwYXRjaGVyX3RpbWVsaW5lX3BlcnNpc3RlbmNlX3F1ZXVlID0gcmVxdWlyZSgiLi9lcGljX2Rpc3BhdGNoZXJfdGltZWxpbmVfcGVyc2lzdGVuY2VfcXVldWUiKTsKCnZhciBfcmVmZXRjaF9xdWVyaWVzID0gcmVxdWlyZSgiLi9yZWZldGNoX3F1ZXJpZXMiKTsKCnZhciBfbXlfZXBpY190aW1lbGluZV9pZCA9IHJlcXVpcmUoIi4vbXlfZXBpY190aW1lbGluZV9pZCIpOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciB0aW1lbGluZUFjdGlvbnNUeXBlID0gW19hY3Rpb25zMi5hcHBseUtxbEZpbHRlclF1ZXJ5LnR5cGUsIF9hY3Rpb25zMi5hZGRQcm92aWRlci50eXBlLCBfYWN0aW9uczIuZGF0YVByb3ZpZGVyRWRpdGVkLnR5cGUsIF9hY3Rpb25zMi5yZW1vdmVDb2x1bW4udHlwZSwgX2FjdGlvbnMyLnJlbW92ZVByb3ZpZGVyLnR5cGUsIF9hY3Rpb25zMi5zZXRGaWx0ZXJzLnR5cGUsIF9hY3Rpb25zMi5zZXRTYXZlZFF1ZXJ5SWQudHlwZSwgX2FjdGlvbnMyLnVwZGF0ZUNvbHVtbnMudHlwZSwgX2FjdGlvbnMyLnVwZGF0ZURhdGFQcm92aWRlckVuYWJsZWQudHlwZSwgX2FjdGlvbnMyLnVwZGF0ZURhdGFQcm92aWRlckV4Y2x1ZGVkLnR5cGUsIF9hY3Rpb25zMi51cGRhdGVEYXRhUHJvdmlkZXJLcWxRdWVyeS50eXBlLCBfYWN0aW9uczIudXBkYXRlRGVzY3JpcHRpb24udHlwZSwgX2FjdGlvbnMyLnVwZGF0ZUV2ZW50VHlwZS50eXBlLCBfYWN0aW9uczIudXBkYXRlS3FsTW9kZS50eXBlLCBfYWN0aW9uczIudXBkYXRlUHJvdmlkZXJzLnR5cGUsIF9hY3Rpb25zMi51cGRhdGVTb3J0LnR5cGUsIF9hY3Rpb25zMi51cGRhdGVUaXRsZS50eXBlLCBfYWN0aW9uczIudXBkYXRlUmFuZ2UudHlwZSwgX2FjdGlvbnMyLnVwc2VydENvbHVtbi50eXBlXTsKCnZhciBpc0l0QXRpbWVsaW5lQWN0aW9uID0gZnVuY3Rpb24gaXNJdEF0aW1lbGluZUFjdGlvbih0aW1lbGluZUlkKSB7CiAgcmV0dXJuIHRpbWVsaW5lSWQgJiYgdGltZWxpbmVJZC50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJ3RpbWVsaW5lJyk7Cn07Cgp2YXIgY3JlYXRlVGltZWxpbmVFcGljID0gZnVuY3Rpb24gY3JlYXRlVGltZWxpbmVFcGljKCkgewogIHJldHVybiBmdW5jdGlvbiAoYWN0aW9uJCwgc3RhdGUkLCBfcmVmKSB7CiAgICB2YXIgc2VsZWN0Tm90ZXNCeUlkU2VsZWN0b3IgPSBfcmVmLnNlbGVjdE5vdGVzQnlJZFNlbGVjdG9yLAogICAgICAgIHRpbWVsaW5lQnlJZFNlbGVjdG9yID0gX3JlZi50aW1lbGluZUJ5SWRTZWxlY3RvciwKICAgICAgICB0aW1lbGluZVRpbWVSYW5nZVNlbGVjdG9yID0gX3JlZi50aW1lbGluZVRpbWVSYW5nZVNlbGVjdG9yLAogICAgICAgIGFwb2xsb0NsaWVudCQgPSBfcmVmLmFwb2xsb0NsaWVudCQ7CiAgICB2YXIgdGltZWxpbmUkID0gc3RhdGUkLnBpcGUoKDAsIF9vcGVyYXRvcnMubWFwKSh0aW1lbGluZUJ5SWRTZWxlY3RvciksICgwLCBfb3BlcmF0b3JzLmZpbHRlcikoX2hlbHBlcnMuaXNOb3ROdWxsKSk7CiAgICB2YXIgbm90ZXMkID0gc3RhdGUkLnBpcGUoKDAsIF9vcGVyYXRvcnMubWFwKShzZWxlY3ROb3Rlc0J5SWRTZWxlY3RvciksICgwLCBfb3BlcmF0b3JzLmZpbHRlcikoX2hlbHBlcnMuaXNOb3ROdWxsKSk7CiAgICB2YXIgdGltZWxpbmVUaW1lUmFuZ2UkID0gc3RhdGUkLnBpcGUoKDAsIF9vcGVyYXRvcnMubWFwKSh0aW1lbGluZVRpbWVSYW5nZVNlbGVjdG9yKSwgKDAsIF9vcGVyYXRvcnMuZmlsdGVyKShfaGVscGVycy5pc05vdE51bGwpKTsKICAgIHJldHVybiAoMCwgX3J4anMubWVyZ2UpKGFjdGlvbiQucGlwZSgoMCwgX29wZXJhdG9ycy53aXRoTGF0ZXN0RnJvbSkodGltZWxpbmUkKSwgKDAsIF9vcGVyYXRvcnMuZmlsdGVyKShmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgdmFyIF9yZWYzID0gX3NsaWNlZFRvQXJyYXkoX3JlZjIsIDIpLAogICAgICAgICAgYWN0aW9uID0gX3JlZjNbMF0sCiAgICAgICAgICB0aW1lbGluZSA9IF9yZWYzWzFdOwoKICAgICAgdmFyIHRpbWVsaW5lSWQgPSAoMCwgX2ZwLmdldCkoJ3BheWxvYWQuaWQnLCBhY3Rpb24pOwogICAgICB2YXIgdGltZWxpbmVPYmogPSB0aW1lbGluZVt0aW1lbGluZUlkXTsKCiAgICAgIGlmIChhY3Rpb24udHlwZSA9PT0gX2FjdGlvbnMuYWRkRXJyb3IudHlwZSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAoYWN0aW9uLnR5cGUgPT09IF9hY3Rpb25zMi5jcmVhdGVUaW1lbGluZS50eXBlICYmIGlzSXRBdGltZWxpbmVBY3Rpb24odGltZWxpbmVJZCkpIHsKICAgICAgICBfbXlfZXBpY190aW1lbGluZV9pZC5teUVwaWNUaW1lbGluZUlkLnNldFRpbWVsaW5lSWQobnVsbCk7CgogICAgICAgIF9teV9lcGljX3RpbWVsaW5lX2lkLm15RXBpY1RpbWVsaW5lSWQuc2V0VGltZWxpbmVWZXJzaW9uKG51bGwpOwogICAgICB9IGVsc2UgaWYgKGFjdGlvbi50eXBlID09PSBfYWN0aW9uczIuYWRkVGltZWxpbmUudHlwZSAmJiBpc0l0QXRpbWVsaW5lQWN0aW9uKHRpbWVsaW5lSWQpKSB7CiAgICAgICAgdmFyIGFkZE5ld1RpbWVsaW5lID0gKDAsIF9mcC5nZXQpKCdwYXlsb2FkLnRpbWVsaW5lJywgYWN0aW9uKTsKCiAgICAgICAgX215X2VwaWNfdGltZWxpbmVfaWQubXlFcGljVGltZWxpbmVJZC5zZXRUaW1lbGluZUlkKGFkZE5ld1RpbWVsaW5lLnNhdmVkT2JqZWN0SWQpOwoKICAgICAgICBfbXlfZXBpY190aW1lbGluZV9pZC5teUVwaWNUaW1lbGluZUlkLnNldFRpbWVsaW5lVmVyc2lvbihhZGROZXdUaW1lbGluZS52ZXJzaW9uKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSBpZiAodGltZWxpbmVBY3Rpb25zVHlwZS5pbmNsdWRlcyhhY3Rpb24udHlwZSkgJiYgIXRpbWVsaW5lT2JqLmlzTG9hZGluZyAmJiBpc0l0QXRpbWVsaW5lQWN0aW9uKHRpbWVsaW5lSWQpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0pLCAoMCwgX29wZXJhdG9ycy5kZWJvdW5jZVRpbWUpKDUwMCksICgwLCBfb3BlcmF0b3JzLm1lcmdlTWFwKShmdW5jdGlvbiAoX3JlZjQpIHsKICAgICAgdmFyIF9yZWY1ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjQsIDEpLAogICAgICAgICAgYWN0aW9uID0gX3JlZjVbMF07CgogICAgICBfZXBpY19kaXNwYXRjaGVyX3RpbWVsaW5lX3BlcnNpc3RlbmNlX3F1ZXVlLmRpc3BhdGNoZXJUaW1lbGluZVBlcnNpc3RRdWV1ZS5uZXh0KHsKICAgICAgICBhY3Rpb246IGFjdGlvbgogICAgICB9KTsKCiAgICAgIHJldHVybiAoMCwgX3J4anMuZW1wdHkpKCk7CiAgICB9KSksIF9lcGljX2Rpc3BhdGNoZXJfdGltZWxpbmVfcGVyc2lzdGVuY2VfcXVldWUuZGlzcGF0Y2hlclRpbWVsaW5lUGVyc2lzdFF1ZXVlLnBpcGUoKDAsIF9vcGVyYXRvcnMuZGVsYXkpKDUwMCksICgwLCBfb3BlcmF0b3JzLndpdGhMYXRlc3RGcm9tKSh0aW1lbGluZSQsIGFwb2xsb0NsaWVudCQsIG5vdGVzJCwgdGltZWxpbmVUaW1lUmFuZ2UkKSwgKDAsIF9vcGVyYXRvcnMuY29uY2F0TWFwKShmdW5jdGlvbiAoX3JlZjYpIHsKICAgICAgdmFyIF9yZWY3ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjYsIDUpLAogICAgICAgICAgb2JqQWN0aW9uID0gX3JlZjdbMF0sCiAgICAgICAgICB0aW1lbGluZSA9IF9yZWY3WzFdLAogICAgICAgICAgYXBvbGxvQ2xpZW50ID0gX3JlZjdbMl0sCiAgICAgICAgICBub3RlcyA9IF9yZWY3WzNdLAogICAgICAgICAgdGltZWxpbmVUaW1lUmFuZ2UgPSBfcmVmN1s0XTsKCiAgICAgIHZhciBhY3Rpb24gPSAoMCwgX2ZwLmdldCkoJ2FjdGlvbicsIG9iakFjdGlvbik7CgogICAgICB2YXIgdGltZWxpbmVJZCA9IF9teV9lcGljX3RpbWVsaW5lX2lkLm15RXBpY1RpbWVsaW5lSWQuZ2V0VGltZWxpbmVJZCgpOwoKICAgICAgdmFyIHZlcnNpb24gPSBfbXlfZXBpY190aW1lbGluZV9pZC5teUVwaWNUaW1lbGluZUlkLmdldFRpbWVsaW5lVmVyc2lvbigpOwoKICAgICAgaWYgKF9lcGljX25vdGUudGltZWxpbmVOb3RlQWN0aW9uc1R5cGUuaW5jbHVkZXMoYWN0aW9uLnR5cGUpKSB7CiAgICAgICAgcmV0dXJuICgwLCBfZXBpY19ub3RlLmVwaWNQZXJzaXN0Tm90ZSkoYXBvbGxvQ2xpZW50LCBhY3Rpb24sIHRpbWVsaW5lLCBub3RlcywgYWN0aW9uJCwgdGltZWxpbmUkLCBub3RlcyQpOwogICAgICB9IGVsc2UgaWYgKF9lcGljX3Bpbm5lZF9ldmVudC50aW1lbGluZVBpbm5lZEV2ZW50QWN0aW9uc1R5cGUuaW5jbHVkZXMoYWN0aW9uLnR5cGUpKSB7CiAgICAgICAgcmV0dXJuICgwLCBfZXBpY19waW5uZWRfZXZlbnQuZXBpY1BlcnNpc3RQaW5uZWRFdmVudCkoYXBvbGxvQ2xpZW50LCBhY3Rpb24sIHRpbWVsaW5lLCBhY3Rpb24kLCB0aW1lbGluZSQpOwogICAgICB9IGVsc2UgaWYgKF9lcGljX2Zhdm9yaXRlLnRpbWVsaW5lRmF2b3JpdGVBY3Rpb25zVHlwZS5pbmNsdWRlcyhhY3Rpb24udHlwZSkpIHsKICAgICAgICByZXR1cm4gKDAsIF9lcGljX2Zhdm9yaXRlLmVwaWNQZXJzaXN0VGltZWxpbmVGYXZvcml0ZSkoYXBvbGxvQ2xpZW50LCBhY3Rpb24sIHRpbWVsaW5lLCBhY3Rpb24kLCB0aW1lbGluZSQpOwogICAgICB9IGVsc2UgaWYgKHRpbWVsaW5lQWN0aW9uc1R5cGUuaW5jbHVkZXMoYWN0aW9uLnR5cGUpKSB7CiAgICAgICAgcmV0dXJuICgwLCBfcnhqcy5mcm9tKShhcG9sbG9DbGllbnQubXV0YXRlKHsKICAgICAgICAgIG11dGF0aW9uOiBfcGVyc2lzdC5wZXJzaXN0VGltZWxpbmVNdXRhdGlvbiwKICAgICAgICAgIGZldGNoUG9saWN5OiAnbm8tY2FjaGUnLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIHRpbWVsaW5lSWQ6IHRpbWVsaW5lSWQsCiAgICAgICAgICAgIHZlcnNpb246IHZlcnNpb24sCiAgICAgICAgICAgIHRpbWVsaW5lOiBjb252ZXJ0VGltZWxpbmVBc0lucHV0KHRpbWVsaW5lW2FjdGlvbi5wYXlsb2FkLmlkXSwgdGltZWxpbmVUaW1lUmFuZ2UpCiAgICAgICAgICB9LAogICAgICAgICAgcmVmZXRjaFF1ZXJpZXM6IF9yZWZldGNoX3F1ZXJpZXMucmVmZXRjaFF1ZXJpZXMKICAgICAgICB9KSkucGlwZSgoMCwgX29wZXJhdG9ycy53aXRoTGF0ZXN0RnJvbSkodGltZWxpbmUkKSwgKDAsIF9vcGVyYXRvcnMubWVyZ2VNYXApKGZ1bmN0aW9uIChfcmVmOCkgewogICAgICAgICAgdmFyIF9yZWY5ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjgsIDIpLAogICAgICAgICAgICAgIHJlc3VsdCA9IF9yZWY5WzBdLAogICAgICAgICAgICAgIHJlY2VudFRpbWVsaW5lID0gX3JlZjlbMV07CgogICAgICAgICAgdmFyIHNhdmVkVGltZWxpbmUgPSByZWNlbnRUaW1lbGluZVthY3Rpb24ucGF5bG9hZC5pZF07CiAgICAgICAgICB2YXIgcmVzcG9uc2UgPSAoMCwgX2ZwLmdldCkoJ2RhdGEucGVyc2lzdFRpbWVsaW5lJywgcmVzdWx0KTsKICAgICAgICAgIHZhciBjYWxsT3V0TXNnID0gcmVzcG9uc2UuY29kZSA9PT0gNDAzID8gWygwLCBfYWN0aW9uczIuc2hvd0NhbGxPdXRVbmF1dGhvcml6ZWRNc2cpKCldIDogW107CiAgICAgICAgICByZXR1cm4gW3Jlc3BvbnNlLmNvZGUgPT09IDQwOSA/ICgwLCBfYWN0aW9uczIudXBkYXRlQXV0b1NhdmVNc2cpKHsKICAgICAgICAgICAgdGltZWxpbmVJZDogYWN0aW9uLnBheWxvYWQuaWQsCiAgICAgICAgICAgIG5ld1RpbWVsaW5lTW9kZWw6IG9taXRUeXBlbmFtZUluVGltZWxpbmUoc2F2ZWRUaW1lbGluZSwgcmVzcG9uc2UudGltZWxpbmUpCiAgICAgICAgICB9KSA6ICgwLCBfYWN0aW9uczIudXBkYXRlVGltZWxpbmUpKHsKICAgICAgICAgICAgaWQ6IGFjdGlvbi5wYXlsb2FkLmlkLAogICAgICAgICAgICB0aW1lbGluZTogX29iamVjdFNwcmVhZCh7fSwgc2F2ZWRUaW1lbGluZSwgewogICAgICAgICAgICAgIHNhdmVkT2JqZWN0SWQ6IHJlc3BvbnNlLnRpbWVsaW5lLnNhdmVkT2JqZWN0SWQsCiAgICAgICAgICAgICAgdmVyc2lvbjogcmVzcG9uc2UudGltZWxpbmUudmVyc2lvbiwKICAgICAgICAgICAgICBpc1NhdmluZzogZmFsc2UKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pXS5jb25jYXQoY2FsbE91dE1zZywgWygwLCBfYWN0aW9uczIuZW5kVGltZWxpbmVTYXZpbmcpKHsKICAgICAgICAgICAgaWQ6IGFjdGlvbi5wYXlsb2FkLmlkCiAgICAgICAgICB9KV0pOwogICAgICAgIH0pLCAoMCwgX29wZXJhdG9ycy5zdGFydFdpdGgpKCgwLCBfYWN0aW9uczIuc3RhcnRUaW1lbGluZVNhdmluZykoewogICAgICAgICAgaWQ6IGFjdGlvbi5wYXlsb2FkLmlkCiAgICAgICAgfSkpLCAoMCwgX29wZXJhdG9ycy50YWtlVW50aWwpKGFjdGlvbiQucGlwZSgoMCwgX29wZXJhdG9ycy53aXRoTGF0ZXN0RnJvbSkodGltZWxpbmUkKSwgKDAsIF9vcGVyYXRvcnMuZmlsdGVyKShmdW5jdGlvbiAoX3JlZjEwKSB7CiAgICAgICAgICB2YXIgX3JlZjExID0gX3NsaWNlZFRvQXJyYXkoX3JlZjEwLCAyKSwKICAgICAgICAgICAgICBjaGVja0FjdGlvbiA9IF9yZWYxMVswXSwKICAgICAgICAgICAgICB1cGRhdGVkVGltZWxpbmUgPSBfcmVmMTFbMV07CgogICAgICAgICAgaWYgKGNoZWNrQWN0aW9uLnR5cGUgPT09IF9hY3Rpb25zMi5lbmRUaW1lbGluZVNhdmluZy50eXBlICYmIHVwZGF0ZWRUaW1lbGluZVsoMCwgX2ZwLmdldCkoJ3BheWxvYWQuaWQnLCBjaGVja0FjdGlvbildLnNhdmVkT2JqZWN0SWQgIT0gbnVsbCkgewogICAgICAgICAgICBfbXlfZXBpY190aW1lbGluZV9pZC5teUVwaWNUaW1lbGluZUlkLnNldFRpbWVsaW5lSWQodXBkYXRlZFRpbWVsaW5lWygwLCBfZnAuZ2V0KSgncGF5bG9hZC5pZCcsIGNoZWNrQWN0aW9uKV0uc2F2ZWRPYmplY3RJZCk7CgogICAgICAgICAgICBfbXlfZXBpY190aW1lbGluZV9pZC5teUVwaWNUaW1lbGluZUlkLnNldFRpbWVsaW5lVmVyc2lvbih1cGRhdGVkVGltZWxpbmVbKDAsIF9mcC5nZXQpKCdwYXlsb2FkLmlkJywgY2hlY2tBY3Rpb24pXS52ZXJzaW9uKTsKCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9KSkpKTsKICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfcnhqcy5lbXB0eSkoKTsKICAgIH0pKSk7CiAgfTsKfTsKCmV4cG9ydHMuY3JlYXRlVGltZWxpbmVFcGljID0gY3JlYXRlVGltZWxpbmVFcGljOwp2YXIgdGltZWxpbmVJbnB1dCA9IHsKICBjb2x1bW5zOiBudWxsLAogIGRhdGFQcm92aWRlcnM6IG51bGwsCiAgZGVzY3JpcHRpb246IG51bGwsCiAgZXZlbnRUeXBlOiBudWxsLAogIGZpbHRlcnM6IG51bGwsCiAga3FsTW9kZTogbnVsbCwKICBrcWxRdWVyeTogbnVsbCwKICB0aXRsZTogbnVsbCwKICBkYXRlUmFuZ2U6IG51bGwsCiAgc2F2ZWRRdWVyeUlkOiBudWxsLAogIHNvcnQ6IG51bGwKfTsKCnZhciBjb252ZXJ0VGltZWxpbmVBc0lucHV0ID0gZnVuY3Rpb24gY29udmVydFRpbWVsaW5lQXNJbnB1dCh0aW1lbGluZSwgdGltZWxpbmVUaW1lUmFuZ2UpIHsKICByZXR1cm4gT2JqZWN0LmtleXModGltZWxpbmVJbnB1dCkucmVkdWNlKGZ1bmN0aW9uIChhY2MsIGtleSkgewogICAgaWYgKCgwLCBfZnAuaGFzKShrZXksIHRpbWVsaW5lKSkgewogICAgICBpZiAoa2V5ID09PSAna3FsUXVlcnknKSB7CiAgICAgICAgcmV0dXJuICgwLCBfZnAuc2V0KSgiIi5jb25jYXQoa2V5LCAiLmZpbHRlclF1ZXJ5IiksICgwLCBfZnAuZ2V0KSgiIi5jb25jYXQoa2V5LCAiLmZpbHRlclF1ZXJ5IiksIHRpbWVsaW5lKSwgYWNjKTsKICAgICAgfSBlbHNlIGlmIChrZXkgPT09ICdkYXRlUmFuZ2UnKSB7CiAgICAgICAgcmV0dXJuICgwLCBfZnAuc2V0KSgiIi5jb25jYXQoa2V5KSwgewogICAgICAgICAgc3RhcnQ6IHRpbWVsaW5lVGltZVJhbmdlLmZyb20sCiAgICAgICAgICBlbmQ6IHRpbWVsaW5lVGltZVJhbmdlLnRvCiAgICAgICAgfSwgYWNjKTsKICAgICAgfSBlbHNlIGlmIChrZXkgPT09ICdjb2x1bW5zJyAmJiAoMCwgX2ZwLmdldCkoa2V5LCB0aW1lbGluZSkgIT0gbnVsbCkgewogICAgICAgIHJldHVybiAoMCwgX2ZwLnNldCkoa2V5LCAoMCwgX2ZwLmdldCkoa2V5LCB0aW1lbGluZSkubWFwKGZ1bmN0aW9uIChjb2wpIHsKICAgICAgICAgIHJldHVybiAoMCwgX2ZwLm9taXQpKFsnd2lkdGgnLCAnX190eXBlbmFtZSddLCBjb2wpOwogICAgICAgIH0pLCBhY2MpOwogICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ2ZpbHRlcnMnICYmICgwLCBfZnAuZ2V0KShrZXksIHRpbWVsaW5lKSAhPSBudWxsKSB7CiAgICAgICAgdmFyIGZpbHRlcnMgPSAoMCwgX2ZwLmdldCkoa2V5LCB0aW1lbGluZSk7CiAgICAgICAgcmV0dXJuICgwLCBfZnAuc2V0KShrZXksIGZpbHRlcnMgIT0gbnVsbCA/IGZpbHRlcnMubWFwKGZ1bmN0aW9uIChteUZpbHRlcikgewogICAgICAgICAgdmFyIGJhc2ljRmlsdGVyID0gKDAsIF9mcC5vbWl0KShbJyRzdGF0ZSddLCBteUZpbHRlcik7CiAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgYmFzaWNGaWx0ZXIsIHsKICAgICAgICAgICAgbWV0YTogX29iamVjdFNwcmVhZCh7fSwgYmFzaWNGaWx0ZXIubWV0YSwgewogICAgICAgICAgICAgIGZpZWxkOiAoX3B1YmxpYy5lc0ZpbHRlcnMuaXNNYXRjaEFsbEZpbHRlcihiYXNpY0ZpbHRlcikgfHwgX3B1YmxpYy5lc0ZpbHRlcnMuaXNQaHJhc2VGaWx0ZXIoYmFzaWNGaWx0ZXIpIHx8IF9wdWJsaWMuZXNGaWx0ZXJzLmlzUGhyYXNlc0ZpbHRlcihiYXNpY0ZpbHRlcikgfHwgX3B1YmxpYy5lc0ZpbHRlcnMuaXNSYW5nZUZpbHRlcihiYXNpY0ZpbHRlcikpICYmIGJhc2ljRmlsdGVyLm1ldGEuZmllbGQgIT0gbnVsbCA/IGNvbnZlcnRUb1N0cmluZyhiYXNpY0ZpbHRlci5tZXRhLmZpZWxkKSA6IG51bGwsCiAgICAgICAgICAgICAgdmFsdWU6IGJhc2ljRmlsdGVyLm1ldGEudmFsdWUgIT0gbnVsbCA/IGNvbnZlcnRUb1N0cmluZyhiYXNpY0ZpbHRlci5tZXRhLnZhbHVlKSA6IG51bGwsCiAgICAgICAgICAgICAgcGFyYW1zOiBiYXNpY0ZpbHRlci5tZXRhLnBhcmFtcyAhPSBudWxsID8gY29udmVydFRvU3RyaW5nKGJhc2ljRmlsdGVyLm1ldGEucGFyYW1zKSA6IG51bGwKICAgICAgICAgICAgfSkKICAgICAgICAgIH0sIF9wdWJsaWMuZXNGaWx0ZXJzLmlzTWF0Y2hBbGxGaWx0ZXIoYmFzaWNGaWx0ZXIpID8gewogICAgICAgICAgICBtYXRjaF9hbGw6IGNvbnZlcnRUb1N0cmluZyhiYXNpY0ZpbHRlci5tYXRjaF9hbGwpCiAgICAgICAgICB9IDogewogICAgICAgICAgICBtYXRjaF9hbGw6IG51bGwKICAgICAgICAgIH0sIHt9LCBfcHVibGljLmVzRmlsdGVycy5pc01pc3NpbmdGaWx0ZXIoYmFzaWNGaWx0ZXIpICYmIGJhc2ljRmlsdGVyLm1pc3NpbmcgIT0gbnVsbCA/IHsKICAgICAgICAgICAgbWlzc2luZzogY29udmVydFRvU3RyaW5nKGJhc2ljRmlsdGVyLm1pc3NpbmcpCiAgICAgICAgICB9IDogewogICAgICAgICAgICBtaXNzaW5nOiBudWxsCiAgICAgICAgICB9LCB7fSwgX3B1YmxpYy5lc0ZpbHRlcnMuaXNFeGlzdHNGaWx0ZXIoYmFzaWNGaWx0ZXIpICYmIGJhc2ljRmlsdGVyLmV4aXN0cyAhPSBudWxsID8gewogICAgICAgICAgICBleGlzdHM6IGNvbnZlcnRUb1N0cmluZyhiYXNpY0ZpbHRlci5leGlzdHMpCiAgICAgICAgICB9IDogewogICAgICAgICAgICBleGlzdHM6IG51bGwKICAgICAgICAgIH0sIHt9LCAoX3B1YmxpYy5lc0ZpbHRlcnMuaXNRdWVyeVN0cmluZ0ZpbHRlcihiYXNpY0ZpbHRlcikgfHwgKDAsIF9mcC5nZXQpKCdxdWVyeScsIGJhc2ljRmlsdGVyKSAhPSBudWxsKSAmJiBiYXNpY0ZpbHRlci5xdWVyeSAhPSBudWxsID8gewogICAgICAgICAgICBxdWVyeTogY29udmVydFRvU3RyaW5nKGJhc2ljRmlsdGVyLnF1ZXJ5KQogICAgICAgICAgfSA6IHsKICAgICAgICAgICAgcXVlcnk6IG51bGwKICAgICAgICAgIH0sIHt9LCBfcHVibGljLmVzRmlsdGVycy5pc1JhbmdlRmlsdGVyKGJhc2ljRmlsdGVyKSAmJiBiYXNpY0ZpbHRlci5yYW5nZSAhPSBudWxsID8gewogICAgICAgICAgICByYW5nZTogY29udmVydFRvU3RyaW5nKGJhc2ljRmlsdGVyLnJhbmdlKQogICAgICAgICAgfSA6IHsKICAgICAgICAgICAgcmFuZ2U6IG51bGwKICAgICAgICAgIH0sIHt9LCBfcHVibGljLmVzRmlsdGVycy5pc1JhbmdlRmlsdGVyKGJhc2ljRmlsdGVyKSAmJiBiYXNpY0ZpbHRlci5zY3JpcHQgIT0gbnVsbAogICAgICAgICAgLyogVE9ETyByZW1vdmUgaXQgd2hlbiBQUjUwNzEzIGlzIG1lcmdlZCB8fCBlc0ZpbHRlcnMuaXNQaHJhc2VGaWx0ZXIoYmFzaWNGaWx0ZXIpICovCiAgICAgICAgICA/IHsKICAgICAgICAgICAgc2NyaXB0OiBjb252ZXJ0VG9TdHJpbmcoYmFzaWNGaWx0ZXIuc2NyaXB0KQogICAgICAgICAgfSA6IHsKICAgICAgICAgICAgc2NyaXB0OiBudWxsCiAgICAgICAgICB9KTsKICAgICAgICB9KSA6IFtdLCBhY2MpOwogICAgICB9CgogICAgICByZXR1cm4gKDAsIF9mcC5zZXQpKGtleSwgKDAsIF9mcC5nZXQpKGtleSwgdGltZWxpbmUpLCBhY2MpOwogICAgfQoKICAgIHJldHVybiBhY2M7CiAgfSwgdGltZWxpbmVJbnB1dCk7Cn07CgpleHBvcnRzLmNvbnZlcnRUaW1lbGluZUFzSW5wdXQgPSBjb252ZXJ0VGltZWxpbmVBc0lucHV0OwoKdmFyIG9taXRUeXBlbmFtZSA9IGZ1bmN0aW9uIG9taXRUeXBlbmFtZShrZXksIHZhbHVlKSB7CiAgcmV0dXJuIGtleSA9PT0gJ19fdHlwZW5hbWUnID8gdW5kZWZpbmVkIDogdmFsdWU7Cn07Cgp2YXIgb21pdFR5cGVuYW1lSW5UaW1lbGluZSA9IGZ1bmN0aW9uIG9taXRUeXBlbmFtZUluVGltZWxpbmUob2xkVGltZWxpbmUsIG5ld1RpbWVsaW5lKSB7CiAgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoKDAsIF9mcC5tZXJnZSkob2xkVGltZWxpbmUsIG5ld1RpbWVsaW5lKSksIG9taXRUeXBlbmFtZSk7Cn07Cgp2YXIgY29udmVydFRvU3RyaW5nID0gZnVuY3Rpb24gY29udmVydFRvU3RyaW5nKG9iaikgewogIHRyeSB7CiAgICBpZiAoKDAsIF9mcC5pc09iamVjdCkob2JqKSkgewogICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqKTsKICAgIH0KCiAgICByZXR1cm4gKDAsIF9mcC50b1N0cmluZykob2JqKTsKICB9IGNhdGNoIChfdW51c2VkKSB7CiAgICByZXR1cm4gJyc7CiAgfQp9Ow=="},null]}