{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/plugins/data/common/es_query/kuery/functions/is.js","dependencies":[{"path":"src/plugins/data/common/es_query/kuery/functions/is.js","mtime":1589249550567},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0gfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9lID0gdW5kZWZpbmVkOyB0cnkgeyBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuYnVpbGROb2RlUGFyYW1zID0gYnVpbGROb2RlUGFyYW1zOwpleHBvcnRzLnRvRWxhc3RpY3NlYXJjaFF1ZXJ5ID0gdG9FbGFzdGljc2VhcmNoUXVlcnk7Cgp2YXIgX2xvZGFzaCA9IHJlcXVpcmUoImxvZGFzaCIpOwoKdmFyIF9maWx0ZXJzID0gcmVxdWlyZSgiLi4vLi4vZmlsdGVycyIpOwoKdmFyIF9nZXRfZmllbGRzID0gcmVxdWlyZSgiLi91dGlscy9nZXRfZmllbGRzIik7Cgp2YXIgX3V0aWxzID0gcmVxdWlyZSgiLi4vLi4vdXRpbHMiKTsKCnZhciBfZ2V0X2Z1bGxfZmllbGRfbmFtZV9ub2RlID0gcmVxdWlyZSgiLi91dGlscy9nZXRfZnVsbF9maWVsZF9uYW1lX25vZGUiKTsKCnZhciBhc3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCIuLi9hc3QiKSk7Cgp2YXIgbGl0ZXJhbCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIi4uL25vZGVfdHlwZXMvbGl0ZXJhbCIpKTsKCnZhciB3aWxkY2FyZCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIi4uL25vZGVfdHlwZXMvd2lsZGNhcmQiKSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KLyoKICogTGljZW5zZWQgdG8gRWxhc3RpY3NlYXJjaCBCLlYuIHVuZGVyIG9uZSBvciBtb3JlIGNvbnRyaWJ1dG9yCiAqIGxpY2Vuc2UgYWdyZWVtZW50cy4gU2VlIHRoZSBOT1RJQ0UgZmlsZSBkaXN0cmlidXRlZCB3aXRoCiAqIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiByZWdhcmRpbmcgY29weXJpZ2h0CiAqIG93bmVyc2hpcC4gRWxhc3RpY3NlYXJjaCBCLlYuIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byB5b3UgdW5kZXIKICogdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkKICogbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICovCgoKZnVuY3Rpb24gYnVpbGROb2RlUGFyYW1zKGZpZWxkTmFtZSwgdmFsdWUpIHsKICB2YXIgaXNQaHJhc2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlOwoKICBpZiAoKDAsIF9sb2Rhc2guaXNVbmRlZmluZWQpKGZpZWxkTmFtZSkpIHsKICAgIHRocm93IG5ldyBFcnJvcignZmllbGROYW1lIGlzIGEgcmVxdWlyZWQgYXJndW1lbnQnKTsKICB9CgogIGlmICgoMCwgX2xvZGFzaC5pc1VuZGVmaW5lZCkodmFsdWUpKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ3ZhbHVlIGlzIGEgcmVxdWlyZWQgYXJndW1lbnQnKTsKICB9CgogIHZhciBmaWVsZE5vZGUgPSB0eXBlb2YgZmllbGROYW1lID09PSAnc3RyaW5nJyA/IGFzdC5mcm9tTGl0ZXJhbEV4cHJlc3Npb24oZmllbGROYW1lKSA6IGxpdGVyYWwuYnVpbGROb2RlKGZpZWxkTmFtZSk7CiAgdmFyIHZhbHVlTm9kZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyBhc3QuZnJvbUxpdGVyYWxFeHByZXNzaW9uKHZhbHVlKSA6IGxpdGVyYWwuYnVpbGROb2RlKHZhbHVlKTsKICB2YXIgaXNQaHJhc2VOb2RlID0gbGl0ZXJhbC5idWlsZE5vZGUoaXNQaHJhc2UpOwogIHJldHVybiB7CiAgICBhcmd1bWVudHM6IFtmaWVsZE5vZGUsIHZhbHVlTm9kZSwgaXNQaHJhc2VOb2RlXQogIH07Cn0KCmZ1bmN0aW9uIHRvRWxhc3RpY3NlYXJjaFF1ZXJ5KG5vZGUsIGluZGV4UGF0dGVybikgewogIHZhciBjb25maWcgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9OwogIHZhciBjb250ZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiB7fTsKCiAgdmFyIF9ub2RlJGFyZ3VtZW50cyA9IF9zbGljZWRUb0FycmF5KG5vZGUuYXJndW1lbnRzLCAzKSwKICAgICAgZmllbGROYW1lQXJnID0gX25vZGUkYXJndW1lbnRzWzBdLAogICAgICB2YWx1ZUFyZyA9IF9ub2RlJGFyZ3VtZW50c1sxXSwKICAgICAgaXNQaHJhc2VBcmcgPSBfbm9kZSRhcmd1bWVudHNbMl07CgogIHZhciBmdWxsRmllbGROYW1lQXJnID0gKDAsIF9nZXRfZnVsbF9maWVsZF9uYW1lX25vZGUuZ2V0RnVsbEZpZWxkTmFtZU5vZGUpKGZpZWxkTmFtZUFyZywgaW5kZXhQYXR0ZXJuLCAoY29udGV4dCA9PT0gbnVsbCB8fCBjb250ZXh0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb250ZXh0Lm5lc3RlZCkgPyBjb250ZXh0Lm5lc3RlZC5wYXRoIDogdW5kZWZpbmVkKTsKICB2YXIgZmllbGROYW1lID0gYXN0LnRvRWxhc3RpY3NlYXJjaFF1ZXJ5KGZ1bGxGaWVsZE5hbWVBcmcpOwogIHZhciB2YWx1ZSA9ICEoMCwgX2xvZGFzaC5pc1VuZGVmaW5lZCkodmFsdWVBcmcpID8gYXN0LnRvRWxhc3RpY3NlYXJjaFF1ZXJ5KHZhbHVlQXJnKSA6IHZhbHVlQXJnOwogIHZhciB0eXBlID0gaXNQaHJhc2VBcmcudmFsdWUgPyAncGhyYXNlJyA6ICdiZXN0X2ZpZWxkcyc7CgogIGlmIChmdWxsRmllbGROYW1lQXJnLnZhbHVlID09PSBudWxsKSB7CiAgICBpZiAodmFsdWVBcmcudHlwZSA9PT0gJ3dpbGRjYXJkJykgewogICAgICByZXR1cm4gewogICAgICAgIHF1ZXJ5X3N0cmluZzogewogICAgICAgICAgcXVlcnk6IHdpbGRjYXJkLnRvUXVlcnlTdHJpbmdRdWVyeSh2YWx1ZUFyZykKICAgICAgICB9CiAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgbXVsdGlfbWF0Y2g6IHsKICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgIHF1ZXJ5OiB2YWx1ZSwKICAgICAgICBsZW5pZW50OiB0cnVlCiAgICAgIH0KICAgIH07CiAgfQoKICB2YXIgZmllbGRzID0gaW5kZXhQYXR0ZXJuID8gKDAsIF9nZXRfZmllbGRzLmdldEZpZWxkcykoZnVsbEZpZWxkTmFtZUFyZywgaW5kZXhQYXR0ZXJuKSA6IFtdOyAvLyBJZiBubyBmaWVsZHMgYXJlIGZvdW5kIGluIHRoZSBpbmRleCBwYXR0ZXJuIHdlIHNlbmQgdGhyb3VnaCB0aGUgZ2l2ZW4gZmllbGQgbmFtZSBhcy1pcy4gV2UgZG8gdGhpcyB0byBwcmVzZXJ2ZQogIC8vIHRoZSBiZWhhdmlvdXIgb2YgbHVjZW5lIG9uIGRhc2hib2FyZHMgd2hlcmUgdGhlcmUgYXJlIHBhbmVscyBiYXNlZCBvbiBkaWZmZXJlbnQgaW5kZXggcGF0dGVybnMgdGhhdCBoYXZlIGRpZmZlcmVudAogIC8vIGZpZWxkcy4gSWYgYSB1c2VyIHF1ZXJpZXMgb24gYSBmaWVsZCB0aGF0IGV4aXN0cyBpbiBvbmUgcGF0dGVybiBidXQgbm90IHRoZSBvdGhlciwgdGhlIGluZGV4IHBhdHRlcm4gd2l0aG91dCB0aGUKICAvLyBmaWVsZCBzaG91bGQgcmV0dXJuIG5vIHJlc3VsdHMuIEl0J3MgZGViYXRhYmxlIHdoZXRoZXIgdGhpcyBpcyBkZXNpcmFibGUsIGJ1dCBpdCdzIGJlZW4gdGhhdCB3YXkgZm9yZXZlciwgc28gd2UnbGwKICAvLyBrZWVwIHRoaW5ncyBmYW1pbGlhciBmb3Igbm93LgoKICBpZiAoZmllbGRzICYmIGZpZWxkcy5sZW5ndGggPT09IDApIHsKICAgIGZpZWxkcy5wdXNoKHsKICAgICAgbmFtZTogYXN0LnRvRWxhc3RpY3NlYXJjaFF1ZXJ5KGZ1bGxGaWVsZE5hbWVBcmcpLAogICAgICBzY3JpcHRlZDogZmFsc2UsCiAgICAgIHR5cGU6ICcnCiAgICB9KTsKICB9CgogIHZhciBpc0V4aXN0c1F1ZXJ5ID0gdmFsdWVBcmcudHlwZSA9PT0gJ3dpbGRjYXJkJyAmJiB2YWx1ZSA9PT0gJyonOwogIHZhciBpc0FsbEZpZWxkc1F1ZXJ5ID0gZnVsbEZpZWxkTmFtZUFyZy50eXBlID09PSAnd2lsZGNhcmQnICYmIGZpZWxkTmFtZSA9PT0gJyonIHx8IGZpZWxkcyAmJiBpbmRleFBhdHRlcm4gJiYgZmllbGRzLmxlbmd0aCA9PT0gaW5kZXhQYXR0ZXJuLmZpZWxkcy5sZW5ndGg7CiAgdmFyIGlzTWF0Y2hBbGxRdWVyeSA9IGlzRXhpc3RzUXVlcnkgJiYgaXNBbGxGaWVsZHNRdWVyeTsKCiAgaWYgKGlzTWF0Y2hBbGxRdWVyeSkgewogICAgcmV0dXJuIHsKICAgICAgbWF0Y2hfYWxsOiB7fQogICAgfTsKICB9CgogIHZhciBxdWVyaWVzID0gZmllbGRzLnJlZHVjZShmdW5jdGlvbiAoYWNjdW11bGF0b3IsIGZpZWxkKSB7CiAgICB2YXIgd3JhcFdpdGhOZXN0ZWRRdWVyeSA9IGZ1bmN0aW9uIHdyYXBXaXRoTmVzdGVkUXVlcnkocXVlcnkpIHsKICAgICAgLy8gV2lsZGNhcmRzIGNhbiBlYXNpbHkgaW5jbHVkZSBuZXN0ZWQgYW5kIG5vbi1uZXN0ZWQgZmllbGRzLiBUaGVyZSBpc24ndCBhIGdvb2Qgd2F5IHRvIGxldAogICAgICAvLyB1c2VycyBoYW5kbGUgdGhpcyB0aGVtc2VsdmVzIHNvIHdlIGF1dG9tYXRpY2FsbHkgYWRkIG5lc3RlZCBxdWVyaWVzIGluIHRoaXMgc2NlbmFyaW8uCiAgICAgIGlmICghKGZ1bGxGaWVsZE5hbWVBcmcudHlwZSA9PT0gJ3dpbGRjYXJkJykgfHwgISgwLCBfbG9kYXNoLmdldCkoZmllbGQsICdzdWJUeXBlLm5lc3RlZCcpIHx8IChjb250ZXh0ID09PSBudWxsIHx8IGNvbnRleHQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbnRleHQubmVzdGVkKSkgewogICAgICAgIHJldHVybiBxdWVyeTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbmVzdGVkOiB7CiAgICAgICAgICAgIHBhdGg6IGZpZWxkLnN1YlR5cGUubmVzdGVkLnBhdGgsCiAgICAgICAgICAgIHF1ZXJ5OiBxdWVyeSwKICAgICAgICAgICAgc2NvcmVfbW9kZTogJ25vbmUnCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQogICAgfTsKCiAgICBpZiAoZmllbGQuc2NyaXB0ZWQpIHsKICAgICAgLy8gRXhpc3RzIHF1ZXJpZXMgZG9uJ3QgbWFrZSBzZW5zZSBmb3Igc2NyaXB0ZWQgZmllbGRzCiAgICAgIGlmICghaXNFeGlzdHNRdWVyeSkgewogICAgICAgIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGFjY3VtdWxhdG9yKSwgW3sKICAgICAgICAgIHNjcmlwdDogX29iamVjdFNwcmVhZCh7fSwgKDAsIF9maWx0ZXJzLmdldFBocmFzZVNjcmlwdCkoZmllbGQsIHZhbHVlKSkKICAgICAgICB9XSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXNFeGlzdHNRdWVyeSkgewogICAgICByZXR1cm4gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShhY2N1bXVsYXRvciksIFt3cmFwV2l0aE5lc3RlZFF1ZXJ5KHsKICAgICAgICBleGlzdHM6IHsKICAgICAgICAgIGZpZWxkOiBmaWVsZC5uYW1lCiAgICAgICAgfQogICAgICB9KV0pOwogICAgfSBlbHNlIGlmICh2YWx1ZUFyZy50eXBlID09PSAnd2lsZGNhcmQnKSB7CiAgICAgIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGFjY3VtdWxhdG9yKSwgW3dyYXBXaXRoTmVzdGVkUXVlcnkoewogICAgICAgIHF1ZXJ5X3N0cmluZzogewogICAgICAgICAgZmllbGRzOiBbZmllbGQubmFtZV0sCiAgICAgICAgICBxdWVyeTogd2lsZGNhcmQudG9RdWVyeVN0cmluZ1F1ZXJ5KHZhbHVlQXJnKQogICAgICAgIH0KICAgICAgfSldKTsKICAgIH0gZWxzZSBpZiAoZmllbGQudHlwZSA9PT0gJ2RhdGUnKSB7CiAgICAgIC8qCiAgICAgIElmIHdlIGRldGVjdCB0aGF0IGl0J3MgYSBkYXRlIGZpZWxkIGFuZCB0aGUgdXNlciB3YW50cyBhbiBleGFjdCBkYXRlLCB3ZSBuZWVkIHRvIGNvbnZlcnQgdGhlIHF1ZXJ5IHRvIGJvdGggPj0gYW5kIDw9IHRoZSB2YWx1ZSBwcm92aWRlZCB0byBmb3JjZSBhIHJhbmdlIHF1ZXJ5LiBUaGlzIGlzIGJlY2F1c2UgbWF0Y2ggYW5kIG1hdGNoX3BocmFzZSBxdWVyaWVzIGRvIG5vdCBhY2NlcHQgYSB0aW1lem9uZSBwYXJhbWV0ZXIuCiAgICAgIGRhdGVGb3JtYXRUWiBjYW4gaGF2ZSB0aGUgdmFsdWUgb2YgJ0Jyb3dzZXInLCBpbiB3aGljaCBjYXNlIHdlIGd1ZXNzIHRoZSB0aW1lem9uZSB1c2luZyBtb21lbnQudHouZ3Vlc3MuCiAgICAgICovCiAgICAgIHZhciB0aW1lWm9uZVBhcmFtID0gY29uZmlnLmRhdGVGb3JtYXRUWiA/IHsKICAgICAgICB0aW1lX3pvbmU6ICgwLCBfdXRpbHMuZ2V0VGltZVpvbmVGcm9tU2V0dGluZ3MpKGNvbmZpZy5kYXRlRm9ybWF0VFopCiAgICAgIH0gOiB7fTsKICAgICAgcmV0dXJuIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoYWNjdW11bGF0b3IpLCBbd3JhcFdpdGhOZXN0ZWRRdWVyeSh7CiAgICAgICAgcmFuZ2U6IF9kZWZpbmVQcm9wZXJ0eSh7fSwgZmllbGQubmFtZSwgX29iamVjdFNwcmVhZCh7CiAgICAgICAgICBndGU6IHZhbHVlLAogICAgICAgICAgbHRlOiB2YWx1ZQogICAgICAgIH0sIHRpbWVab25lUGFyYW0pKQogICAgICB9KV0pOwogICAgfSBlbHNlIHsKICAgICAgdmFyIHF1ZXJ5VHlwZSA9IHR5cGUgPT09ICdwaHJhc2UnID8gJ21hdGNoX3BocmFzZScgOiAnbWF0Y2gnOwogICAgICByZXR1cm4gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShhY2N1bXVsYXRvciksIFt3cmFwV2l0aE5lc3RlZFF1ZXJ5KF9kZWZpbmVQcm9wZXJ0eSh7fSwgcXVlcnlUeXBlLCBfZGVmaW5lUHJvcGVydHkoe30sIGZpZWxkLm5hbWUsIHZhbHVlKSkpXSk7CiAgICB9CiAgfSwgW10pOwogIHJldHVybiB7CiAgICBib29sOiB7CiAgICAgIHNob3VsZDogcXVlcmllcyB8fCBbXSwKICAgICAgbWluaW11bV9zaG91bGRfbWF0Y2g6IDEKICAgIH0KICB9Owp9"},null]}