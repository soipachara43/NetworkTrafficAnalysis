{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/beats_management/public/pages/overview/enrolled_beats.js","dependencies":[{"path":"x-pack/legacy/plugins/beats_management/public/pages/overview/enrolled_beats.js","mtime":1589249551719},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuQmVhdHNQYWdlID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9yZWFjdCA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfbW9tZW50ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJtb21lbnQiKSk7Cgp2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2Vucm9sbF9iZWF0cyA9IHJlcXVpcmUoIi4uLy4uL2NvbXBvbmVudHMvZW5yb2xsX2JlYXRzIik7Cgp2YXIgX2JyZWFkY3J1bWIgPSByZXF1aXJlKCIuLi8uLi9jb21wb25lbnRzL25hdmlnYXRpb24vYnJlYWRjcnVtYiIpOwoKdmFyIF90YWJsZSA9IHJlcXVpcmUoIi4uLy4uL2NvbXBvbmVudHMvdGFibGUiKTsKCnZhciBfYWN0aW9uX3NjaGVtYSA9IHJlcXVpcmUoIi4uLy4uL2NvbXBvbmVudHMvdGFibGUvYWN0aW9uX3NjaGVtYSIpOwoKdmFyIF90YWJsZTIgPSByZXF1aXJlKCIuLi8uLi9jb21wb25lbnRzL3RhYmxlL3RhYmxlIik7Cgp2YXIgX3dpdGhfa3VlcnlfYXV0b2NvbXBsZXRpb24gPSByZXF1aXJlKCIuLi8uLi9jb250YWluZXJzL3dpdGhfa3VlcnlfYXV0b2NvbXBsZXRpb24iKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZjIoU3ltYm9sLml0ZXJhdG9yKSA9PT0gInN5bWJvbCIpIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9CgogIHJldHVybiBfdHlwZW9mKG9iaik7Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsKICB0cnkgewogICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOwogICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVqZWN0KGVycm9yKTsKICAgIHJldHVybjsKICB9CgogIGlmIChpbmZvLmRvbmUpIHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0gZWxzZSB7CiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7CiAgfQp9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgYXJncyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsKCiAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsKICAgICAgfQoKICAgICAgX25leHQodW5kZWZpbmVkKTsKICAgIH0pOwogIH07Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsKICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICByZXR1cm4gY2FsbDsKICB9CgogIHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwp9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOwogIH07CiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7Cn0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7CiAgICBvLl9fcHJvdG9fXyA9IHA7CiAgICByZXR1cm4gbzsKICB9OwoKICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIEJlYXRzUGFnZUNvbXBvbmVudCA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9SZWFjdCRQdXJlQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKEJlYXRzUGFnZUNvbXBvbmVudCwgX1JlYWN0JFB1cmVDb21wb25lbnQpOwoKICBmdW5jdGlvbiBCZWF0c1BhZ2VDb21wb25lbnQocHJvcHMpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmVhdHNQYWdlQ29tcG9uZW50KTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihCZWF0c1BhZ2VDb21wb25lbnQpLmNhbGwodGhpcywgcHJvcHMpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJ0YWJsZVJlZiIsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVSZWYoKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicmVuZGVyQWN0aW9uQXJlYSIsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25FbXB0eSwgewogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAvLyByYW5kb20sIGJ1dCBzcGVjaWZpYyBudW1iZXIgZW5zdXJlcyBuZXcgdGFiIGRvZXMgbm90IG92ZXJ3cml0ZSBhbm90aGVyIF9uZXd0YWIgaW4gY2hyb21lCiAgICAgICAgICAvLyBhbmQgYXQgdGhlIHNhbWUgdGltZSBub3QgdHJ1bHkgcmFuZG9tIHNvIHRoYXQgbWFueSBjbGlja3Mgb2YgdGhlIGxpbmsgb3BlbiBtYW55IHRhYnMgYXQgdGhpcyBzYW1lIFVSTAogICAgICAgICAgd2luZG93Lm9wZW4oJ2h0dHBzOi8vd3d3LmVsYXN0aWMuY28vZ3VpZGUvZW4vYmVhdHMvbGliYmVhdC9jdXJyZW50L2dldHRpbmctc3RhcnRlZC5odG1sJywgJ19uZXd0YWIzNTYyODkzNzQ1NicpOwogICAgICAgIH0KICAgICAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLmJlYXRzTWFuYWdlbWVudC5iZWF0cy5pbnN0YWxsQmVhdHNMZWFybmluZ0J1dHRvbkxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkxlYXJuIGhvdyB0byBpbnN0YWxsIGJlYXRzIgogICAgICB9KSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgICAgc2l6ZTogInMiLAogICAgICAgIGNvbG9yOiAicHJpbWFyeSIsCiAgICAgICAgb25DbGljazoKICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIF90aGlzLnByb3BzLmdvVG8oIi9vdmVydmlldy9lbnJvbGxlZF9iZWF0cy9lbnJvbGwiKTsKCiAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgICAgfSkpCiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5iZWF0c01hbmFnZW1lbnQuYmVhdHMuZW5yb2xsQmVhdHNCdXR0b25MYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFbnJvbGwgQmVhdHMiCiAgICAgIH0pKSwgX3RoaXMucHJvcHMubG9jYXRpb24ucGF0aG5hbWUgPT09ICcvb3ZlcnZpZXcvZW5yb2xsZWRfYmVhdHMvZW5yb2xsJyAmJiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU92ZXJsYXlNYXNrLCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU1vZGFsLCB7CiAgICAgICAgb25DbG9zZTogZnVuY3Rpb24gb25DbG9zZSgpIHsKICAgICAgICAgIF90aGlzLnByb3BzLnNldFVybFN0YXRlKHsKICAgICAgICAgICAgZW5yb2xsbWVudFRva2VuOiAnJwogICAgICAgICAgfSk7CgogICAgICAgICAgX3RoaXMucHJvcHMuZ29UbygiL292ZXJ2aWV3L2Vucm9sbGVkX2JlYXRzIik7CiAgICAgICAgfSwKICAgICAgICBzdHlsZTogewogICAgICAgICAgd2lkdGg6ICc2NDBweCcKICAgICAgICB9CiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTW9kYWxIZWFkZXIsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTW9kYWxIZWFkZXJUaXRsZSwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLmJlYXRzTWFuYWdlbWVudC5iZWF0cy5lbnJvbGxOZXdCZWF0c1RpdGxlIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkVucm9sbCBhIG5ldyBCZWF0IgogICAgICB9KSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU1vZGFsQm9keSwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2Vucm9sbF9iZWF0cy5FbnJvbGxCZWF0LCB7CiAgICAgICAgZnJhbWV3b3JrQmFzZVBhdGg6IF90aGlzLnByb3BzLmxpYnMuZnJhbWV3b3JrLmluZm8uYmFzZVBhdGgsCiAgICAgICAgZW5yb2xsbWVudFRva2VuOiBfdGhpcy5wcm9wcy51cmxTdGF0ZS5lbnJvbGxtZW50VG9rZW4sCiAgICAgICAgZ2V0QmVhdFdpdGhUb2tlbjogX3RoaXMucHJvcHMuY29udGFpbmVycy5iZWF0cy5nZXRCZWF0V2l0aFRva2VuLAogICAgICAgIGNyZWF0ZUVucm9sbG1lbnRUb2tlbjoKICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgICAgdmFyIGVucm9sbG1lbnRUb2tlbnM7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5wcm9wcy5saWJzLnRva2Vucy5jcmVhdGVFbnJvbGxtZW50VG9rZW5zKCk7CgogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBlbnJvbGxtZW50VG9rZW5zID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgICAgICBfdGhpcy5wcm9wcy5zZXRVcmxTdGF0ZSh7CiAgICAgICAgICAgICAgICAgICAgZW5yb2xsbWVudFRva2VuOiBlbnJvbGxtZW50VG9rZW5zWzBdCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICAgIH0pKSwKICAgICAgICBvbkJlYXRFbnJvbGxlZDogZnVuY3Rpb24gb25CZWF0RW5yb2xsZWQoKSB7CiAgICAgICAgICBfdGhpcy5wcm9wcy5zZXRVcmxTdGF0ZSh7CiAgICAgICAgICAgIGVucm9sbG1lbnRUb2tlbjogJycKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSksICFfdGhpcy5wcm9wcy51cmxTdGF0ZS5lbnJvbGxtZW50VG9rZW4gJiYgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgIHNpemU6ICJzIiwKICAgICAgICBjb2xvcjogInByaW1hcnkiLAogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICBtYXJnaW5MZWZ0OiAxMAogICAgICAgIH0sCiAgICAgICAgb25DbGljazoKICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgX3RoaXMucHJvcHMuZ29UbygnL292ZXJ2aWV3L2Vucm9sbGVkX2JlYXRzJyk7CgogICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgICAgfSkpCiAgICAgIH0sICJEb25lIikpKSkpKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm5vdGlmeUJlYXREaXNlbnJvbGxlZCIsCiAgICAvKiNfX1BVUkVfXyovCiAgICBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVmNCA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KGJlYXRzKSB7CiAgICAgICAgdmFyIGludGwsIHRpdGxlLCB0ZXh0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpbnRsID0gX3RoaXMucHJvcHMuaW50bDsKCiAgICAgICAgICAgICAgICBpZiAoYmVhdHMubGVuZ3RoID09PSAxKSB7CiAgICAgICAgICAgICAgICAgIHRpdGxlID0gaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLmJlYXRzTWFuYWdlbWVudC5iZWF0cy5iZWF0RGlzZW5yb2xsZWROb3RpZmljYXRpb25UaXRsZScsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd7Zmlyc3RCZWF0TmFtZU9ySWR9IGRpc2Vucm9sbGVkJwogICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgZmlyc3RCZWF0TmFtZU9ySWQ6ICJcIiIuY29uY2F0KGJlYXRzWzBdLm5hbWUgfHwgYmVhdHNbMF0uaWQsICJcIiIpCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB0ZXh0ID0gaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLmJlYXRzTWFuYWdlbWVudC5iZWF0cy5iZWF0RGlzZW5yb2xsZWROb3RpZmljYXRpb25EZXNjcmlwdGlvbicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdCZWF0IHdpdGggSUQge2ZpcnN0QmVhdElkfSB3YXMgZGlzZW5yb2xsZWQuJwogICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgZmlyc3RCZWF0SWQ6ICJcIiIuY29uY2F0KGJlYXRzWzBdLmlkLCAiXCIiKQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHRpdGxlID0gaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICBpZDogJ3hwYWNrLmJlYXRzTWFuYWdlbWVudC5iZWF0cy5kaXNlbnJvbGxlZEJlYXRzTm90aWZpY2F0aW9uVGl0bGUnLAogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAne2JlYXRzTGVuZ3RofSBiZWF0cyBkaXNlbnJvbGxlZCcKICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgIGJlYXRzTGVuZ3RoOiBiZWF0cy5sZW5ndGgKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25zOiBfdGhpcy5zdGF0ZS5ub3RpZmljYXRpb25zLmNvbmNhdCh7CiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICd3YXJuaW5nJywKICAgICAgICAgICAgICAgICAgICBpZDogImRpc2Vucm9sbF8iLmNvbmNhdChuZXcgRGF0ZSgpKSwKICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsCiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dAogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgIH0pKTsKCiAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICByZXR1cm4gX3JlZjQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgIH0oKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAibm90aWZ5VXBkYXRlZFRhZ0Fzc29jaWF0aW9uIiwgZnVuY3Rpb24gKGFjdGlvbiwgYmVhdHMsIHRhZykgewogICAgICB2YXIgaW50bCA9IF90aGlzLnByb3BzLmludGw7CiAgICAgIHZhciBub3RpZmljYXRpb25NZXNzYWdlID0gYWN0aW9uID09PSAncmVtb3ZlZCcgPyBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgIGlkOiAneHBhY2suYmVhdHNNYW5hZ2VtZW50LmJlYXRzLnJlbW92ZWROb3RpZmljYXRpb25EZXNjcmlwdGlvbicsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdSZW1vdmVkIHRhZyB7dGFnfSBmcm9tIHthc3NpZ25tZW50c0xlbmd0aCwgcGx1cmFsLCBvbmUge2JlYXQge2JlYXROYW1lfX0gb3RoZXIgeyMgYmVhdHN9fS4nCiAgICAgIH0sIHsKICAgICAgICB0YWc6ICJcIiIuY29uY2F0KHRhZywgIlwiIiksCiAgICAgICAgYXNzaWdubWVudHNMZW5ndGg6IGJlYXRzLmxlbmd0aCwKICAgICAgICBiZWF0TmFtZTogIlwiIi5jb25jYXQoYmVhdHNbMF0ubmFtZSB8fCBiZWF0c1swXS5pZCwgIlwiIikKICAgICAgfSkgOiBpbnRsLmZvcm1hdE1lc3NhZ2UoewogICAgICAgIGlkOiAneHBhY2suYmVhdHNNYW5hZ2VtZW50LmJlYXRzLmFkZGVkTm90aWZpY2F0aW9uRGVzY3JpcHRpb24nLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQWRkZWQgdGFnIHt0YWd9IHRvIHthc3NpZ25tZW50c0xlbmd0aCwgcGx1cmFsLCBvbmUge2JlYXQge2JlYXROYW1lfX0gb3RoZXIgeyMgYmVhdHN9fS4nCiAgICAgIH0sIHsKICAgICAgICB0YWc6ICJcIiIuY29uY2F0KHRhZywgIlwiIiksCiAgICAgICAgYXNzaWdubWVudHNMZW5ndGg6IGJlYXRzLmxlbmd0aCwKICAgICAgICBiZWF0TmFtZTogIlwiIi5jb25jYXQoYmVhdHNbMF0ubmFtZSB8fCBiZWF0c1swXS5pZCwgIlwiIikKICAgICAgfSk7CiAgICAgIHZhciBub3RpZmljYXRpb25UaXRsZSA9IGFjdGlvbiA9PT0gJ3JlbW92ZWQnID8gaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICBpZDogJ3hwYWNrLmJlYXRzTWFuYWdlbWVudC5iZWF0cy5yZW1vdmVkTm90aWZpY2F0aW9uVGl0bGUnLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAne2Fzc2lnbm1lbnRzTGVuZ3RoLCBwbHVyYWwsIG9uZSB7VGFnfSBvdGhlciB7VGFnc319IHJlbW92ZWQnCiAgICAgIH0sIHsKICAgICAgICBhc3NpZ25tZW50c0xlbmd0aDogYmVhdHMubGVuZ3RoCiAgICAgIH0pIDogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICBpZDogJ3hwYWNrLmJlYXRzTWFuYWdlbWVudC5iZWF0cy5hZGRlZE5vdGlmaWNhdGlvblRpdGxlJywKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ3thc3NpZ25tZW50c0xlbmd0aCwgcGx1cmFsLCBvbmUge1RhZ30gb3RoZXIge1RhZ3N9fSBhZGRlZCcKICAgICAgfSwgewogICAgICAgIGFzc2lnbm1lbnRzTGVuZ3RoOiBiZWF0cy5sZW5ndGgKICAgICAgfSk7CgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgbm90aWZpY2F0aW9uczogX3RoaXMuc3RhdGUubm90aWZpY2F0aW9ucy5jb25jYXQoewogICAgICAgICAgY29sb3I6ICdzdWNjZXNzJywKICAgICAgICAgIGlkOiAidGFnLSIuY29uY2F0KF9tb21lbnQuZGVmYXVsdC5ub3coKSksCiAgICAgICAgICB0ZXh0OiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIG5vdGlmaWNhdGlvbk1lc3NhZ2UpLAogICAgICAgICAgdGl0bGU6IG5vdGlmaWNhdGlvblRpdGxlCiAgICAgICAgfSkKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRTZWxlY3RlZEJlYXRzIiwgZnVuY3Rpb24gKCkgewogICAgICBpZiAoIV90aGlzLnRhYmxlUmVmLmN1cnJlbnQpIHsKICAgICAgICByZXR1cm4gW107CiAgICAgIH0KCiAgICAgIHZhciBzZWxlY3RlZElkcyA9IF90aGlzLnRhYmxlUmVmLmN1cnJlbnQuc3RhdGUuc2VsZWN0aW9uLm1hcChmdW5jdGlvbiAoYmVhdCkgewogICAgICAgIHJldHVybiBiZWF0LmlkOwogICAgICB9KTsKCiAgICAgIHZhciBiZWF0cyA9IFtdOwogICAgICBzZWxlY3RlZElkcy5mb3JFYWNoKGZ1bmN0aW9uIChpZCkgewogICAgICAgIHZhciBiZWF0ID0gX3RoaXMucHJvcHMuY29udGFpbmVycy5iZWF0cy5zdGF0ZS5saXN0LmZpbmQoZnVuY3Rpb24gKGIpIHsKICAgICAgICAgIHJldHVybiBiLmlkID09PSBpZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGJlYXQpIHsKICAgICAgICAgIGJlYXRzLnB1c2goYmVhdCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIGJlYXRzOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIG5vdGlmaWNhdGlvbnM6IFtdLAogICAgICB0YWdzOiBudWxsLAogICAgICBiZWF0czogW10sCiAgICAgIGFzc2lnbm1lbnRPcHRpb25zOiBudWxsCiAgICB9OwogICAgcHJvcHMucmVuZGVyQWN0aW9uKF90aGlzLnJlbmRlckFjdGlvbkFyZWEpOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEJlYXRzUGFnZUNvbXBvbmVudCwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgaWYgKHRoaXMucHJvcHMudXJsU3RhdGUuYmVhdHNLQmFyKSB7CiAgICAgICAgdGhpcy5wcm9wcy5jb250YWluZXJzLmJlYXRzLnJlbG9hZCh0aGlzLnByb3BzLnVybFN0YXRlLmJlYXRzS0Jhcik7CiAgICAgIH0KCiAgICAgIHRoaXMudXBkYXRlQmVhdHNEYXRhKHRoaXMucHJvcHMudXJsU3RhdGUuYmVhdHNLQmFyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGVCZWF0c0RhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF91cGRhdGVCZWF0c0RhdGEgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNShiZWF0c0tCYXIpIHsKICAgICAgICB2YXIgYmVhdHMsIHRhZ3M7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS50MSA9IF9sb2Rhc2guc29ydEJ5OwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMubGlicy5iZWF0cy5nZXRBbGwoYmVhdHNLQmFyKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnQyID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDUudDAgPSAoMCwgX2NvbnRleHQ1LnQxKShfY29udGV4dDUudDIsICdpZCcpOwoKICAgICAgICAgICAgICAgIGlmIChfY29udGV4dDUudDApIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDUudDAgPSBbXTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgYmVhdHMgPSBfY29udGV4dDUudDA7CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMubGlicy50YWdzLmdldFRhZ3NXaXRoSWRzKCgwLCBfbG9kYXNoLmZsYXR0ZW4pKGJlYXRzLm1hcChmdW5jdGlvbiAoYmVhdCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gYmVhdC50YWdzOwogICAgICAgICAgICAgICAgfSkpKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIHRhZ3MgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICB0YWdzOiB0YWdzLAogICAgICAgICAgICAgICAgICBiZWF0czogYmVhdHMKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gdXBkYXRlQmVhdHNEYXRhKF94MikgewogICAgICAgIHJldHVybiBfdXBkYXRlQmVhdHNEYXRhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB1cGRhdGVCZWF0c0RhdGE7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYnJlYWRjcnVtYi5CcmVhZGNydW1iLCB7CiAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5iZWF0c01hbmFnZW1lbnQuYnJlYWRjcnVtYi5lbnJvbGxlZEJlYXRzJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFbnJvbGxlZCBCZWF0cycKICAgICAgICB9KSwKICAgICAgICBwYXRoOiAiL292ZXJ2aWV3L2Vucm9sbGVkX2JlYXRzIgogICAgICB9KSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3dpdGhfa3VlcnlfYXV0b2NvbXBsZXRpb24uV2l0aEt1ZXJ5QXV0b2NvbXBsZXRpb24sIHsKICAgICAgICBsaWJzOiB0aGlzLnByb3BzLmxpYnMsCiAgICAgICAgZmllbGRQcmVmaXg6ICJiZWF0IgogICAgICB9LCBmdW5jdGlvbiAoYXV0b2NvbXBsZXRlUHJvcHMpIHsKICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3RhYmxlLlRhYmxlLCB7CiAgICAgICAgICBrdWVyeUJhclByb3BzOiBfb2JqZWN0U3ByZWFkKHt9LCBhdXRvY29tcGxldGVQcm9wcywgewogICAgICAgICAgICBmaWx0ZXJRdWVyeURyYWZ0OiAnZmFsc2UnLAogICAgICAgICAgICAvLyB0b2RvCiAgICAgICAgICAgIGlzVmFsaWQ6IF90aGlzMi5wcm9wcy5saWJzLmVsYXN0aWNzZWFyY2guaXNLdWVyeVZhbGlkKF90aGlzMi5wcm9wcy51cmxTdGF0ZS5iZWF0c0tCYXIgfHwgJycpLAogICAgICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UodmFsdWUpIHsKICAgICAgICAgICAgICBfdGhpczIucHJvcHMuc2V0VXJsU3RhdGUoewogICAgICAgICAgICAgICAgYmVhdHNLQmFyOiB2YWx1ZQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBfdGhpczIudXBkYXRlQmVhdHNEYXRhKHZhbHVlKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25TdWJtaXQ6IGZ1bmN0aW9uIG9uU3VibWl0KCkgewogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9LAogICAgICAgICAgICAvLyB0b2RvCiAgICAgICAgICAgIHZhbHVlOiBfdGhpczIucHJvcHMudXJsU3RhdGUuYmVhdHNLQmFyIHx8ICcnCiAgICAgICAgICB9KSwKICAgICAgICAgIGFjdGlvbnM6IF9hY3Rpb25fc2NoZW1hLmJlYXRzTGlzdEFjdGlvbnMsCiAgICAgICAgICBhY3Rpb25EYXRhOiB7CiAgICAgICAgICAgIHRhZ3M6IF90aGlzMi5zdGF0ZS5hc3NpZ25tZW50T3B0aW9ucwogICAgICAgICAgfSwKICAgICAgICAgIGFjdGlvbkhhbmRsZXI6CiAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBfcmVmNSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KGFjdGlvbiwgcGF5bG9hZCkgewogICAgICAgICAgICAgIHZhciBzdGF0dXMsIGFzc2lnbm1lbnRPcHRpb25zOwogICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYudDAgPSBhY3Rpb247CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IF9jb250ZXh0Ni50MCA9PT0gX3RhYmxlMi5Bc3NpZ25tZW50QWN0aW9uVHlwZS5Bc3NpZ24gPyAzIDogX2NvbnRleHQ2LnQwID09PSBfdGFibGUyLkFzc2lnbm1lbnRBY3Rpb25UeXBlLkRlbGV0ZSA/IDEwIDogX2NvbnRleHQ2LnQwID09PSBfdGFibGUyLkFzc2lnbm1lbnRBY3Rpb25UeXBlLlJlbG9hZCA/IDE2IDogMjE7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5wcm9wcy5jb250YWluZXJzLmJlYXRzLnRvZ2dsZVRhZ0Fzc2lnbm1lbnQocGF5bG9hZCwgX3RoaXMyLmdldFNlbGVjdGVkQmVhdHMoKSk7CgogICAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi51cGRhdGVCZWF0c0RhdGEoKTsKCiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgX3RoaXMyLm5vdGlmeVVwZGF0ZWRUYWdBc3NvY2lhdGlvbihzdGF0dXMsIF90aGlzMi5nZXRTZWxlY3RlZEJlYXRzKCksIHBheWxvYWQpOwoKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJicmVhayIsIDIxKTsKCiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLnByb3BzLmNvbnRhaW5lcnMuYmVhdHMuZGVhY3RpdmF0ZShfdGhpczIuZ2V0U2VsZWN0ZWRCZWF0cygpKTsKCiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLnVwZGF0ZUJlYXRzRGF0YSgpOwoKICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgICAgICAgX3RoaXMyLm5vdGlmeUJlYXREaXNlbnJvbGxlZChfdGhpczIuZ2V0U2VsZWN0ZWRCZWF0cygpKTsKCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgiYnJlYWsiLCAyMSk7CgogICAgICAgICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5wcm9wcy5saWJzLnRhZ3MuZ2V0YXNzaWduYWJsZVRhZ3NGb3JCZWF0cyhfdGhpczIuZ2V0U2VsZWN0ZWRCZWF0cygpKTsKCiAgICAgICAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnRPcHRpb25zID0gX2NvbnRleHQ2LnNlbnQ7CgogICAgICAgICAgICAgICAgICAgICAgX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudE9wdGlvbnM6IGFzc2lnbm1lbnRPcHRpb25zCiAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgiYnJlYWsiLCAyMSk7CgogICAgICAgICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICAgICAgICB9KSk7CgogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94MywgX3g0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIF9yZWY1LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KCksCiAgICAgICAgICBpdGVtczogX3RoaXMyLnN0YXRlLmJlYXRzLm1hcChmdW5jdGlvbiAoYmVhdCkgewogICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgYmVhdCwgewogICAgICAgICAgICAgIHRhZ3M6IChfdGhpczIuc3RhdGUudGFncyB8fCBbXSkuZmlsdGVyKGZ1bmN0aW9uICh0YWcpIHsKICAgICAgICAgICAgICAgIHJldHVybiBiZWF0LnRhZ3MuaW5jbHVkZXModGFnLmlkKTsKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pLAogICAgICAgICAgcmVmOiBfdGhpczIudGFibGVSZWYsCiAgICAgICAgICB0eXBlOiBfdGFibGUuQmVhdHNUYWJsZVR5cGUKICAgICAgICB9KTsKICAgICAgfSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpR2xvYmFsVG9hc3RMaXN0LCB7CiAgICAgICAgdG9hc3RzOiB0aGlzLnN0YXRlLm5vdGlmaWNhdGlvbnMsCiAgICAgICAgZGlzbWlzc1RvYXN0OiBmdW5jdGlvbiBkaXNtaXNzVG9hc3QoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgICAgbm90aWZpY2F0aW9uczogW10KICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgdG9hc3RMaWZlVGltZU1zOiA1MDAwCiAgICAgIH0pKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBCZWF0c1BhZ2VDb21wb25lbnQ7Cn0oX3JlYWN0Mi5kZWZhdWx0LlB1cmVDb21wb25lbnQpOwoKdmFyIEJlYXRzUGFnZSA9ICgwLCBfcmVhY3QuaW5qZWN0STE4bikoQmVhdHNQYWdlQ29tcG9uZW50KTsKZXhwb3J0cy5CZWF0c1BhZ2UgPSBCZWF0c1BhZ2U7"},null]}