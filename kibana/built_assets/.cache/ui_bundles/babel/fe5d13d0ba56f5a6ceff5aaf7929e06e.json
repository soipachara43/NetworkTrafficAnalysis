{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/maps/public/layers/sources/es_search_source/create_source_editor.js","dependencies":[{"path":"x-pack/legacy/plugins/maps/public/layers/sources/es_search_source/create_source_editor.js","mtime":1589249552452},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkNyZWF0ZVNvdXJjZUVkaXRvciA9IHZvaWQgMDsKCnZhciBfbG9kYXNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2giKSk7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3Byb3BUeXBlcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicHJvcC10eXBlcyIpKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX3NpbmdsZV9maWVsZF9zZWxlY3QgPSByZXF1aXJlKCIuLi8uLi8uLi9jb21wb25lbnRzL3NpbmdsZV9maWVsZF9zZWxlY3QiKTsKCnZhciBfa2liYW5hX3NlcnZpY2VzID0gcmVxdWlyZSgiLi4vLi4vLi4va2liYW5hX3NlcnZpY2VzIik7Cgp2YXIgX25vX2luZGV4X3BhdHRlcm5fY2FsbG91dCA9IHJlcXVpcmUoIi4uLy4uLy4uL2NvbXBvbmVudHMvbm9faW5kZXhfcGF0dGVybl9jYWxsb3V0Iik7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cyIpOwoKdmFyIF9jb25zdGFudHMyID0gcmVxdWlyZSgiLi9jb25zdGFudHMiKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3BsdWdpbnMvZGF0YS9wdWJsaWMiKTsKCnZhciBfc2NhbGluZ19mb3JtID0gcmVxdWlyZSgiLi9zY2FsaW5nX2Zvcm0iKTsKCnZhciBfaW5kZXhfcGF0dGVybl91dGlsID0gcmVxdWlyZSgiLi4vLi4vLi4vaW5kZXhfcGF0dGVybl91dGlsIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCmZ1bmN0aW9uIGdldEdlb0ZpZWxkcyhmaWVsZHMpIHsKICByZXR1cm4gZmllbGRzLmZpbHRlcihmdW5jdGlvbiAoZmllbGQpIHsKICAgIHJldHVybiAhX3B1YmxpYy5pbmRleFBhdHRlcm5zLmlzTmVzdGVkRmllbGQoZmllbGQpICYmIFtfY29uc3RhbnRzLkVTX0dFT19GSUVMRF9UWVBFLkdFT19QT0lOVCwgX2NvbnN0YW50cy5FU19HRU9fRklFTERfVFlQRS5HRU9fU0hBUEVdLmluY2x1ZGVzKGZpZWxkLnR5cGUpOwogIH0pOwp9CgpmdW5jdGlvbiBpc0dlb0ZpZWxkQWdncmVnYXRhYmxlKGluZGV4UGF0dGVybiwgZ2VvRmllbGROYW1lKSB7CiAgaWYgKCFpbmRleFBhdHRlcm4pIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHZhciBnZW9GaWVsZCA9IGluZGV4UGF0dGVybi5maWVsZHMuZ2V0QnlOYW1lKGdlb0ZpZWxkTmFtZSk7CiAgcmV0dXJuIGdlb0ZpZWxkICYmIGdlb0ZpZWxkLmFnZ3JlZ2F0YWJsZTsKfQoKdmFyIFJFU0VUX0lOREVYX1BBVFRFUk5fU1RBVEUgPSB7CiAgaW5kZXhQYXR0ZXJuOiB1bmRlZmluZWQsCiAgZ2VvRmllbGRzOiB1bmRlZmluZWQsCiAgLy8gRVMgc2VhcmNoIHNvdXJjZSBkZXNjcmlwdG9yIHN0YXRlCiAgZ2VvRmllbGROYW1lOiB1bmRlZmluZWQsCiAgZmlsdGVyQnlNYXBCb3VuZHM6IF9jb25zdGFudHMyLkRFRkFVTFRfRklMVEVSX0JZX01BUF9CT1VORFMsCiAgc2NhbGluZ1R5cGU6IF9jb25zdGFudHMuU0NBTElOR19UWVBFUy5DTFVTVEVSUywKICAvLyB0dXJuIG9uIGNsdXN0aW5nIGJ5IGRlZmF1bHQKICB0b3BIaXRzU3BsaXRGaWVsZDogdW5kZWZpbmVkLAogIHRvcEhpdHNTaXplOiAxCn07Cgp2YXIgQ3JlYXRlU291cmNlRWRpdG9yID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhDcmVhdGVTb3VyY2VFZGl0b3IsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBDcmVhdGVTb3VyY2VFZGl0b3IoKSB7CiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjsKCiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENyZWF0ZVNvdXJjZUVkaXRvcik7CgogICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICB9CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9IF9nZXRQcm90b3R5cGVPZihDcmVhdGVTb3VyY2VFZGl0b3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzXS5jb25jYXQoYXJncykpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzdGF0ZSIsIF9vYmplY3RTcHJlYWQoewogICAgICBpc0xvYWRpbmdJbmRleFBhdHRlcm46IGZhbHNlLAogICAgICBub0dlb0luZGV4UGF0dGVybnNFeGlzdDogZmFsc2UKICAgIH0sIFJFU0VUX0lOREVYX1BBVFRFUk5fU1RBVEUpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfb25JbmRleFBhdHRlcm5TZWxlY3QiLCBmdW5jdGlvbiAoaW5kZXhQYXR0ZXJuSWQpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGluZGV4UGF0dGVybklkOiBpbmRleFBhdHRlcm5JZAogICAgICB9LCBfdGhpcy5fbG9hZEluZGV4UGF0dGVybihpbmRleFBhdHRlcm5JZCkpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiX2xvYWRJbmRleFBhdHRlcm4iLCBmdW5jdGlvbiAoaW5kZXhQYXR0ZXJuSWQpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoX29iamVjdFNwcmVhZCh7CiAgICAgICAgaXNMb2FkaW5nSW5kZXhQYXR0ZXJuOiB0cnVlCiAgICAgIH0sIFJFU0VUX0lOREVYX1BBVFRFUk5fU1RBVEUpLCBfdGhpcy5fZGVib3VuY2VkTG9hZC5iaW5kKG51bGwsIGluZGV4UGF0dGVybklkKSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfZGVib3VuY2VkTG9hZCIsIF9sb2Rhc2guZGVmYXVsdC5kZWJvdW5jZSgKICAgIC8qI19fUFVSRV9fKi8KICAgIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGluZGV4UGF0dGVybklkKSB7CiAgICAgICAgdmFyIGluZGV4UGF0dGVybiwgZ2VvRmllbGRzLCBmaXJzdEFnZ3JlZ2F0YWJsZUdlb0ZpZWxkLCBkZWZhdWx0R2VvRmllbGROYW1lOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmICghKCFpbmRleFBhdHRlcm5JZCB8fCBpbmRleFBhdHRlcm5JZC5sZW5ndGggPT09IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX2tpYmFuYV9zZXJ2aWNlcy5nZXRJbmRleFBhdHRlcm5TZXJ2aWNlKSgpLmdldChpbmRleFBhdHRlcm5JZCk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGluZGV4UGF0dGVybiA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDg7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDIpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2lzTW91bnRlZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgaWYgKCEoaW5kZXhQYXR0ZXJuLmlkICE9PSBpbmRleFBhdHRlcm5JZCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIGdlb0ZpZWxkcyA9IGdldEdlb0ZpZWxkcyhpbmRleFBhdHRlcm4uZmllbGRzKTsKCiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIGlzTG9hZGluZ0luZGV4UGF0dGVybjogZmFsc2UsCiAgICAgICAgICAgICAgICAgIGluZGV4UGF0dGVybjogaW5kZXhQYXR0ZXJuLAogICAgICAgICAgICAgICAgICBnZW9GaWVsZHM6IGdlb0ZpZWxkcwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKGdlb0ZpZWxkcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgLy8gbWFrZSBkZWZhdWx0IHNlbGVjdGlvbiwgcHJlZmVyIGFnZ3JlZ2F0YWJsZSBmaWVsZCBvdmVyIHRoZSBmaXJzdCBhdmFpbGFibGUKICAgICAgICAgICAgICAgICAgZmlyc3RBZ2dyZWdhdGFibGVHZW9GaWVsZCA9IGdlb0ZpZWxkcy5maW5kKGZ1bmN0aW9uIChnZW9GaWVsZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBnZW9GaWVsZC5hZ2dyZWdhdGFibGU7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBkZWZhdWx0R2VvRmllbGROYW1lID0gZmlyc3RBZ2dyZWdhdGFibGVHZW9GaWVsZCA/IGZpcnN0QWdncmVnYXRhYmxlR2VvRmllbGQgOiBnZW9GaWVsZHNbMF07CgogICAgICAgICAgICAgICAgICBfdGhpcy5fb25HZW9GaWVsZFNlbGVjdChkZWZhdWx0R2VvRmllbGROYW1lLm5hbWUpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1syLCA4XV0pOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgIH0oKSwgMzAwKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiX29uR2VvRmllbGRTZWxlY3QiLCBmdW5jdGlvbiAoZ2VvRmllbGROYW1lKSB7CiAgICAgIC8vIFJlc3BlY3QgcHJldmlvdXMgc2NhbGluZyB0eXBlIHNlbGVjdGlvbiB1bmxlc3MgbmV3bHkgc2VsZWN0ZWQgZ2VvIGZpZWxkIGRvZXMgbm90IHN1cHBvcnQgY2x1c3RlcmluZy4KICAgICAgdmFyIHNjYWxpbmdUeXBlID0gX3RoaXMuc3RhdGUuc2NhbGluZ1R5cGUgPT09IF9jb25zdGFudHMuU0NBTElOR19UWVBFUy5DTFVTVEVSUyAmJiAhaXNHZW9GaWVsZEFnZ3JlZ2F0YWJsZShfdGhpcy5zdGF0ZS5pbmRleFBhdHRlcm4sIGdlb0ZpZWxkTmFtZSkgPyBfY29uc3RhbnRzLlNDQUxJTkdfVFlQRVMuTElNSVQgOiBfdGhpcy5zdGF0ZS5zY2FsaW5nVHlwZTsKCiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBnZW9GaWVsZE5hbWU6IGdlb0ZpZWxkTmFtZSwKICAgICAgICBzY2FsaW5nVHlwZTogc2NhbGluZ1R5cGUKICAgICAgfSwgX3RoaXMuX3ByZXZpZXdMYXllcik7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfb25TY2FsaW5nUHJvcENoYW5nZSIsIGZ1bmN0aW9uIChfcmVmMikgewogICAgICB2YXIgcHJvcE5hbWUgPSBfcmVmMi5wcm9wTmFtZSwKICAgICAgICAgIHZhbHVlID0gX3JlZjIudmFsdWU7CgogICAgICBfdGhpcy5zZXRTdGF0ZShfZGVmaW5lUHJvcGVydHkoe30sIHByb3BOYW1lLCB2YWx1ZSksIF90aGlzLl9wcmV2aWV3TGF5ZXIpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiX3ByZXZpZXdMYXllciIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF90aGlzJHN0YXRlID0gX3RoaXMuc3RhdGUsCiAgICAgICAgICBpbmRleFBhdHRlcm5JZCA9IF90aGlzJHN0YXRlLmluZGV4UGF0dGVybklkLAogICAgICAgICAgZ2VvRmllbGROYW1lID0gX3RoaXMkc3RhdGUuZ2VvRmllbGROYW1lLAogICAgICAgICAgZmlsdGVyQnlNYXBCb3VuZHMgPSBfdGhpcyRzdGF0ZS5maWx0ZXJCeU1hcEJvdW5kcywKICAgICAgICAgIHNjYWxpbmdUeXBlID0gX3RoaXMkc3RhdGUuc2NhbGluZ1R5cGUsCiAgICAgICAgICB0b3BIaXRzU3BsaXRGaWVsZCA9IF90aGlzJHN0YXRlLnRvcEhpdHNTcGxpdEZpZWxkLAogICAgICAgICAgdG9wSGl0c1NpemUgPSBfdGhpcyRzdGF0ZS50b3BIaXRzU2l6ZTsKICAgICAgdmFyIHNvdXJjZUNvbmZpZyA9IGluZGV4UGF0dGVybklkICYmIGdlb0ZpZWxkTmFtZSA/IHsKICAgICAgICBpbmRleFBhdHRlcm5JZDogaW5kZXhQYXR0ZXJuSWQsCiAgICAgICAgZ2VvRmllbGQ6IGdlb0ZpZWxkTmFtZSwKICAgICAgICBmaWx0ZXJCeU1hcEJvdW5kczogZmlsdGVyQnlNYXBCb3VuZHMsCiAgICAgICAgc2NhbGluZ1R5cGU6IHNjYWxpbmdUeXBlLAogICAgICAgIHRvcEhpdHNTcGxpdEZpZWxkOiB0b3BIaXRzU3BsaXRGaWVsZCwKICAgICAgICB0b3BIaXRzU2l6ZTogdG9wSGl0c1NpemUKICAgICAgfSA6IG51bGw7CgogICAgICBfdGhpcy5wcm9wcy5vblNvdXJjZUNvbmZpZ0NoYW5nZShzb3VyY2VDb25maWcpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiX29uTm9JbmRleFBhdHRlcm5zIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgbm9HZW9JbmRleFBhdHRlcm5zRXhpc3Q6IHRydWUKICAgICAgfSk7CiAgICB9KTsKCiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQ3JlYXRlU291cmNlRWRpdG9yLCBbewogICAga2V5OiAiY29tcG9uZW50V2lsbFVubW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkgewogICAgICB0aGlzLl9pc01vdW50ZWQgPSBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIHRoaXMuX2lzTW91bnRlZCA9IHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlbmRlckdlb1NlbGVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbmRlckdlb1NlbGVjdCgpIHsKICAgICAgaWYgKCF0aGlzLnN0YXRlLmluZGV4UGF0dGVybikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLnNvdXJjZS5lc1NlYXJjaC5nZW9maWVsZExhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdHZW9zcGF0aWFsIGZpZWxkJwogICAgICAgIH0pCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NpbmdsZV9maWVsZF9zZWxlY3QuU2luZ2xlRmllbGRTZWxlY3QsIHsKICAgICAgICBwbGFjZWhvbGRlcjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMuc291cmNlLmVzU2VhcmNoLnNlbGVjdExhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTZWxlY3QgZ2VvIGZpZWxkJwogICAgICAgIH0pLAogICAgICAgIHZhbHVlOiB0aGlzLnN0YXRlLmdlb0ZpZWxkTmFtZSwKICAgICAgICBvbkNoYW5nZTogdGhpcy5fb25HZW9GaWVsZFNlbGVjdCwKICAgICAgICBmaWVsZHM6IHRoaXMuc3RhdGUuZ2VvRmllbGRzCiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcmVuZGVyU2NhbGluZ1BhbmVsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVuZGVyU2NhbGluZ1BhbmVsKCkgewogICAgICBpZiAoIXRoaXMuc3RhdGUuaW5kZXhQYXR0ZXJuIHx8ICF0aGlzLnN0YXRlLmdlb0ZpZWxkTmFtZSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibSIKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NjYWxpbmdfZm9ybS5TY2FsaW5nRm9ybSwgewogICAgICAgIGZpbHRlckJ5TWFwQm91bmRzOiB0aGlzLnN0YXRlLmZpbHRlckJ5TWFwQm91bmRzLAogICAgICAgIGluZGV4UGF0dGVybklkOiB0aGlzLnN0YXRlLmluZGV4UGF0dGVybklkLAogICAgICAgIG9uQ2hhbmdlOiB0aGlzLl9vblNjYWxpbmdQcm9wQ2hhbmdlLAogICAgICAgIHNjYWxpbmdUeXBlOiB0aGlzLnN0YXRlLnNjYWxpbmdUeXBlLAogICAgICAgIHN1cHBvcnRzQ2x1c3RlcmluZzogaXNHZW9GaWVsZEFnZ3JlZ2F0YWJsZSh0aGlzLnN0YXRlLmluZGV4UGF0dGVybiwgdGhpcy5zdGF0ZS5nZW9GaWVsZE5hbWUpLAogICAgICAgIHRlcm1GaWVsZHM6ICgwLCBfaW5kZXhfcGF0dGVybl91dGlsLmdldFRlcm1zRmllbGRzKSh0aGlzLnN0YXRlLmluZGV4UGF0dGVybi5maWVsZHMpLAogICAgICAgIHRvcEhpdHNTcGxpdEZpZWxkOiB0aGlzLnN0YXRlLnRvcEhpdHNTcGxpdEZpZWxkLAogICAgICAgIHRvcEhpdHNTaXplOiB0aGlzLnN0YXRlLnRvcEhpdHNTaXplCiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcmVuZGVyTm9JbmRleFBhdHRlcm5XYXJuaW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVuZGVyTm9JbmRleFBhdHRlcm5XYXJuaW5nKCkgewogICAgICBpZiAoIXRoaXMuc3RhdGUubm9HZW9JbmRleFBhdHRlcm5zRXhpc3QpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ub19pbmRleF9wYXR0ZXJuX2NhbGxvdXQuTm9JbmRleFBhdHRlcm5DYWxsb3V0LCBudWxsKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJzIgogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBJbmRleFBhdHRlcm5TZWxlY3QgPSAoMCwgX2tpYmFuYV9zZXJ2aWNlcy5nZXRJbmRleFBhdHRlcm5TZWxlY3RDb21wb25lbnQpKCk7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgdGhpcy5fcmVuZGVyTm9JbmRleFBhdHRlcm5XYXJuaW5nKCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGb3JtUm93LCB7CiAgICAgICAgbGFiZWw6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tYXBzLnNvdXJjZS5lc1NlYXJjaC5pbmRleFBhdHRlcm5MYWJlbCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnSW5kZXggcGF0dGVybicKICAgICAgICB9KQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEluZGV4UGF0dGVyblNlbGVjdCwgewogICAgICAgIGlzRGlzYWJsZWQ6IHRoaXMuc3RhdGUubm9HZW9JbmRleFBhdHRlcm5zRXhpc3QsCiAgICAgICAgaW5kZXhQYXR0ZXJuSWQ6IHRoaXMuc3RhdGUuaW5kZXhQYXR0ZXJuSWQsCiAgICAgICAgb25DaGFuZ2U6IHRoaXMuX29uSW5kZXhQYXR0ZXJuU2VsZWN0LAogICAgICAgIHBsYWNlaG9sZGVyOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5zb3VyY2UuZXNTZWFyY2guc2VsZWN0SW5kZXhQYXR0ZXJuUGxhY2Vob2xkZXInLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NlbGVjdCBpbmRleCBwYXR0ZXJuJwogICAgICAgIH0pLAogICAgICAgIGZpZWxkVHlwZXM6IFtfY29uc3RhbnRzLkVTX0dFT19GSUVMRF9UWVBFLkdFT19QT0lOVCwgX2NvbnN0YW50cy5FU19HRU9fRklFTERfVFlQRS5HRU9fU0hBUEVdLAogICAgICAgIG9uTm9JbmRleFBhdHRlcm5zOiB0aGlzLl9vbk5vSW5kZXhQYXR0ZXJucwogICAgICB9KSksIHRoaXMuX3JlbmRlckdlb1NlbGVjdCgpLCB0aGlzLl9yZW5kZXJTY2FsaW5nUGFuZWwoKSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQ3JlYXRlU291cmNlRWRpdG9yOwp9KF9yZWFjdC5Db21wb25lbnQpOwoKZXhwb3J0cy5DcmVhdGVTb3VyY2VFZGl0b3IgPSBDcmVhdGVTb3VyY2VFZGl0b3I7CgpfZGVmaW5lUHJvcGVydHkoQ3JlYXRlU291cmNlRWRpdG9yLCAicHJvcFR5cGVzIiwgewogIG9uU291cmNlQ29uZmlnQ2hhbmdlOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkCn0pOw=="},null]}