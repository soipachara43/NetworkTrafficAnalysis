{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/plugins/data/public/search/aggs/agg_configs.js","dependencies":[{"path":"src/plugins/data/public/search/aggs/agg_configs.js","mtime":1589249550635},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuQWdnQ29uZmlncyA9IHZvaWQgMDsKCnZhciBfbG9kYXNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2giKSk7Cgp2YXIgX2FnZ19jb25maWcgPSByZXF1aXJlKCIuL2FnZ19jb25maWciKTsKCnZhciBfYWdnX2dyb3VwcyA9IHJlcXVpcmUoIi4vYWdnX2dyb3VwcyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgZGVmYXVsdDogb2JqCiAgfTsKfQoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICB9CgogICAgcmV0dXJuIGFycjI7CiAgfQp9CgpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsKICByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgewogIHZhciBfYXJyID0gW107CiAgdmFyIF9uID0gdHJ1ZTsKICB2YXIgX2QgPSBmYWxzZTsKICB2YXIgX2UgPSB1bmRlZmluZWQ7CgogIHRyeSB7CiAgICBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7CiAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7CgogICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfZCA9IHRydWU7CiAgICBfZSA9IGVycjsKICB9IGZpbmFsbHkgewogICAgdHJ5IHsKICAgICAgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBpZiAoX2QpIHRocm93IF9lOwogICAgfQogIH0KCiAgcmV0dXJuIF9hcnI7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOwp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICB9Cn0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgcmV0dXJuIENvbnN0cnVjdG9yOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBfdHlwZW9mMihTeW1ib2wuaXRlcmF0b3IpID09PSAic3ltYm9sIikgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9IGVsc2UgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0KCiAgcmV0dXJuIF90eXBlb2Yob2JqKTsKfQoKZnVuY3Rpb24gcmVtb3ZlUGFyZW50QWdncyhvYmopIHsKICBmb3IgKHZhciBwcm9wIGluIG9iaikgewogICAgaWYgKHByb3AgPT09ICdwYXJlbnRBZ2dzJykgZGVsZXRlIG9ialtwcm9wXTtlbHNlIGlmIChfdHlwZW9mKG9ialtwcm9wXSkgPT09ICdvYmplY3QnKSByZW1vdmVQYXJlbnRBZ2dzKG9ialtwcm9wXSk7CiAgfQp9CgpmdW5jdGlvbiBwYXJzZVBhcmVudEFnZ3MoZHNsTHZsQ3Vyc29yLCBkc2wpIHsKICBpZiAoZHNsLnBhcmVudEFnZ3MpIHsKICAgIF9sb2Rhc2guZGVmYXVsdC5lYWNoKGRzbC5wYXJlbnRBZ2dzLCBmdW5jdGlvbiAoYWdnLCBrZXkpIHsKICAgICAgZHNsTHZsQ3Vyc29yW2tleV0gPSBhZ2c7CiAgICAgIHBhcnNlUGFyZW50QWdncyhkc2xMdmxDdXJzb3IsIGFnZyk7CiAgICB9KTsKICB9Cn0KCnZhciBBZ2dDb25maWdzID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQWdnQ29uZmlncyhpbmRleFBhdHRlcm4pIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdmFyIGNvbmZpZ1N0YXRlcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogW107CiAgICB2YXIgb3B0cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBZ2dDb25maWdzKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImluZGV4UGF0dGVybiIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJ0aW1lUmFuZ2UiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAidHlwZXNSZWdpc3RyeSIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJhZ2dzIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImNyZWF0ZUFnZ0NvbmZpZyIsIGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICAgdmFyIF9yZWYgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9LAogICAgICAgICAgX3JlZiRhZGRUb0FnZ0NvbmZpZ3MgPSBfcmVmLmFkZFRvQWdnQ29uZmlncywKICAgICAgICAgIGFkZFRvQWdnQ29uZmlncyA9IF9yZWYkYWRkVG9BZ2dDb25maWdzID09PSB2b2lkIDAgPyB0cnVlIDogX3JlZiRhZGRUb0FnZ0NvbmZpZ3M7CgogICAgICB2YXIgdHlwZSA9IHBhcmFtcy50eXBlOwogICAgICB2YXIgYWdnQ29uZmlnOwoKICAgICAgaWYgKHBhcmFtcyBpbnN0YW5jZW9mIF9hZ2dfY29uZmlnLkFnZ0NvbmZpZykgewogICAgICAgIGFnZ0NvbmZpZyA9IHBhcmFtczsKICAgICAgICBwYXJhbXMucGFyZW50ID0gX3RoaXM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWdnQ29uZmlnID0gbmV3IF9hZ2dfY29uZmlnLkFnZ0NvbmZpZyhfdGhpcywgX29iamVjdFNwcmVhZCh7fSwgcGFyYW1zLCB7CiAgICAgICAgICB0eXBlOiB0eXBlb2YgdHlwZSA9PT0gJ3N0cmluZycgPyBfdGhpcy50eXBlc1JlZ2lzdHJ5LmdldCh0eXBlKSA6IHR5cGUKICAgICAgICB9KSk7CiAgICAgIH0KCiAgICAgIGlmIChhZGRUb0FnZ0NvbmZpZ3MpIHsKICAgICAgICBfdGhpcy5hZ2dzLnB1c2goYWdnQ29uZmlnKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGFnZ0NvbmZpZzsKICAgIH0pOwoKICAgIHRoaXMudHlwZXNSZWdpc3RyeSA9IG9wdHMudHlwZXNSZWdpc3RyeTsKICAgIGNvbmZpZ1N0YXRlcyA9IF9hZ2dfY29uZmlnLkFnZ0NvbmZpZy5lbnN1cmVJZHMoY29uZmlnU3RhdGVzKTsKICAgIHRoaXMuYWdncyA9IFtdOwogICAgdGhpcy5pbmRleFBhdHRlcm4gPSBpbmRleFBhdHRlcm47CiAgICBjb25maWdTdGF0ZXMuZm9yRWFjaChmdW5jdGlvbiAocGFyYW1zKSB7CiAgICAgIHJldHVybiBfdGhpcy5jcmVhdGVBZ2dDb25maWcocGFyYW1zKTsKICAgIH0pOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEFnZ0NvbmZpZ3MsIFt7CiAgICBrZXk6ICJzZXRUaW1lUmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFRpbWVSYW5nZSh0aW1lUmFuZ2UpIHsKICAgICAgdGhpcy50aW1lUmFuZ2UgPSB0aW1lUmFuZ2U7CgogICAgICB2YXIgdXBkYXRlQWdnVGltZVJhbmdlID0gZnVuY3Rpb24gdXBkYXRlQWdnVGltZVJhbmdlKGFnZykgewogICAgICAgIF9sb2Rhc2guZGVmYXVsdC5lYWNoKGFnZy5wYXJhbXMsIGZ1bmN0aW9uIChwYXJhbSkgewogICAgICAgICAgaWYgKHBhcmFtIGluc3RhbmNlb2YgX2FnZ19jb25maWcuQWdnQ29uZmlnKSB7CiAgICAgICAgICAgIHVwZGF0ZUFnZ1RpbWVSYW5nZShwYXJhbSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGlmIChfbG9kYXNoLmRlZmF1bHQuZ2V0KGFnZywgJ3R5cGUubmFtZScpID09PSAnZGF0ZV9oaXN0b2dyYW0nKSB7CiAgICAgICAgICBhZ2cucGFyYW1zLnRpbWVSYW5nZSA9IHRpbWVSYW5nZTsKICAgICAgICB9CiAgICAgIH07CgogICAgICB0aGlzLmFnZ3MuZm9yRWFjaCh1cGRhdGVBZ2dUaW1lUmFuZ2UpOwogICAgfSAvLyBjbG9uZSBtZXRob2Qgd2lsbCByZXVzZSBleGlzdGluZyBBZ2dDb25maWcgaW4gdGhlIGxpc3QgKHdpbGwgbm90IGNyZWF0ZSBuZXcgaW5zdGFuY2VzKQoKICB9LCB7CiAgICBrZXk6ICJjbG9uZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7CiAgICAgIHZhciBfcmVmMiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge30sCiAgICAgICAgICBfcmVmMiRlbmFibGVkT25seSA9IF9yZWYyLmVuYWJsZWRPbmx5LAogICAgICAgICAgZW5hYmxlZE9ubHkgPSBfcmVmMiRlbmFibGVkT25seSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWYyJGVuYWJsZWRPbmx5OwoKICAgICAgdmFyIGZpbHRlckFnZ3MgPSBmdW5jdGlvbiBmaWx0ZXJBZ2dzKGFnZykgewogICAgICAgIGlmICghZW5hYmxlZE9ubHkpIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBhZ2cuZW5hYmxlZDsKICAgICAgfTsKCiAgICAgIHZhciBhZ2dDb25maWdzID0gbmV3IEFnZ0NvbmZpZ3ModGhpcy5pbmRleFBhdHRlcm4sIHRoaXMuYWdncy5maWx0ZXIoZmlsdGVyQWdncyksIHsKICAgICAgICB0eXBlc1JlZ2lzdHJ5OiB0aGlzLnR5cGVzUmVnaXN0cnkKICAgICAgfSk7CiAgICAgIHJldHVybiBhZ2dDb25maWdzOwogICAgfQogIH0sIHsKICAgIGtleTogImpzb25EYXRhRXF1YWxzIiwKCiAgICAvKioKICAgICAqIERhdGEtYnktZGF0YSBjb21wYXJpc29uIG9mIHRoaXMgQWdncmVnYXRpb24KICAgICAqIElnbm9yZXMgdGhlIG5vbi1hcnJheSBpbmRleGVzCiAgICAgKiBAcGFyYW0gYWdnQ29uZmlncyBhbiBBZ2dDb25maWdzIGluc3RhbmNlCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBqc29uRGF0YUVxdWFscyhhZ2dDb25maWdzKSB7CiAgICAgIGlmIChhZ2dDb25maWdzLmxlbmd0aCAhPT0gdGhpcy5hZ2dzLmxlbmd0aCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmFnZ3MubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgICBpZiAoIV9sb2Rhc2guZGVmYXVsdC5pc0VxdWFsKGFnZ0NvbmZpZ3NbaV0udG9KU09OKCksIHRoaXMuYWdnc1tpXS50b0pTT04oKSkpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0sIHsKICAgIGtleTogInRvRHNsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b0RzbCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgaGllcmFyY2hpY2FsID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgICAgdmFyIGRzbFRvcEx2bCA9IHt9OwogICAgICB2YXIgZHNsTHZsQ3Vyc29yOwogICAgICB2YXIgbmVzdGVkTWV0cmljczsKCiAgICAgIGlmIChoaWVyYXJjaGljYWwpIHsKICAgICAgICAvLyBjb2xsZWN0IGFsbCBtZXRyaWNzLCBhbmQgZmlsdGVyIG91dCB0aGUgb25lcyB0aGF0IHdlIHdvbid0IGJlIGNvcHlpbmcKICAgICAgICBuZXN0ZWRNZXRyaWNzID0gdGhpcy5hZ2dzLmZpbHRlcihmdW5jdGlvbiAoYWdnKSB7CiAgICAgICAgICByZXR1cm4gYWdnLnR5cGUudHlwZSA9PT0gJ21ldHJpY3MnICYmIGFnZy50eXBlLm5hbWUgIT09ICdjb3VudCc7CiAgICAgICAgfSkubWFwKGZ1bmN0aW9uIChhZ2cpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGNvbmZpZzogYWdnLAogICAgICAgICAgICBkc2w6IGFnZy50b0RzbChfdGhpczIpCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICB9CgogICAgICB0aGlzLmdldFJlcXVlc3RBZ2dzKCkuZmlsdGVyKGZ1bmN0aW9uIChjb25maWcpIHsKICAgICAgICByZXR1cm4gIWNvbmZpZy50eXBlLmhhc05vRHNsOwogICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChjb25maWcsIGksIGxpc3QpIHsKICAgICAgICBpZiAoIWRzbEx2bEN1cnNvcikgewogICAgICAgICAgLy8gc3RhcnQgYXQgdGhlIHRvcCBsZXZlbAogICAgICAgICAgZHNsTHZsQ3Vyc29yID0gZHNsVG9wTHZsOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgcHJldkNvbmZpZyA9IGxpc3RbaSAtIDFdOwogICAgICAgICAgdmFyIHByZXZEc2wgPSBkc2xMdmxDdXJzb3JbcHJldkNvbmZpZy5pZF07IC8vIGFkdmFuY2UgdGhlIGN1cnNvciBhbmQgbmVzdCB1bmRlciB0aGUgcHJldmlvdXMgYWdnLCBvcgogICAgICAgICAgLy8gcHV0IGl0IG9uIHRoZSBzYW1lIGxldmVsIGlmIHRoZSBwcmV2aW91cyBhZ2cgZG9lc24ndCBhY2NlcHQKICAgICAgICAgIC8vIHN1YiBhZ2dzCgogICAgICAgICAgZHNsTHZsQ3Vyc29yID0gcHJldkRzbC5hZ2dzIHx8IGRzbEx2bEN1cnNvcjsKICAgICAgICB9CgogICAgICAgIHZhciBkc2wgPSBkc2xMdmxDdXJzb3JbY29uZmlnLmlkXSA9IGNvbmZpZy50b0RzbChfdGhpczIpOwogICAgICAgIHZhciBzdWJBZ2dzOwogICAgICAgIHBhcnNlUGFyZW50QWdncyhkc2xMdmxDdXJzb3IsIGRzbCk7CgogICAgICAgIGlmIChjb25maWcudHlwZS50eXBlID09PSBfYWdnX2dyb3Vwcy5BZ2dHcm91cE5hbWVzLkJ1Y2tldHMgJiYgaSA8IGxpc3QubGVuZ3RoIC0gMSkgewogICAgICAgICAgLy8gYnVja2V0cyB0aGF0IGFyZSBub3QgdGhlIGxhc3QgaXRlbSBpbiB0aGUgbGlzdCBhY2NlcHQgc3ViLWFnZ3MKICAgICAgICAgIHN1YkFnZ3MgPSBkc2wuYWdncyB8fCAoZHNsLmFnZ3MgPSB7fSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3ViQWdncyAmJiBuZXN0ZWRNZXRyaWNzKSB7CiAgICAgICAgICBuZXN0ZWRNZXRyaWNzLmZvckVhY2goZnVuY3Rpb24gKGFnZykgewogICAgICAgICAgICBzdWJBZ2dzW2FnZy5jb25maWcuaWRdID0gYWdnLmRzbDsgLy8gaWYgYSBuZXN0ZWQgbWV0cmljIGFnZyBoYXMgcGFyZW50IGFnZ3MsIHdlIGhhdmUgdG8gYWRkIHRoZW0gdG8gZXZlcnkgbGV2ZWwgb2YgdGhlIHRyZWUKICAgICAgICAgICAgLy8gdG8gbWFrZSBzdXJlICJidWNrZXRfcGF0aCIgcmVmZXJlbmNlcyBpbiB0aGUgbmVzdGVkIG1ldHJpYyBhZ2cgaXRzZWxmIGFyZSBzdGlsbCB3b3JraW5nCgogICAgICAgICAgICBpZiAoYWdnLmRzbC5wYXJlbnRBZ2dzKSB7CiAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoYWdnLmRzbC5wYXJlbnRBZ2dzKS5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmMykgewogICAgICAgICAgICAgICAgdmFyIF9yZWY0ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjMsIDIpLAogICAgICAgICAgICAgICAgICAgIHBhcmVudEFnZ0lkID0gX3JlZjRbMF0sCiAgICAgICAgICAgICAgICAgICAgcGFyZW50QWdnID0gX3JlZjRbMV07CgogICAgICAgICAgICAgICAgc3ViQWdnc1twYXJlbnRBZ2dJZF0gPSBwYXJlbnRBZ2c7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJlbW92ZVBhcmVudEFnZ3MoZHNsVG9wTHZsKTsKICAgICAgcmV0dXJuIGRzbFRvcEx2bDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRBbGwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFsbCgpIHsKICAgICAgcmV0dXJuIF90b0NvbnN1bWFibGVBcnJheSh0aGlzLmFnZ3MpOwogICAgfQogIH0sIHsKICAgIGtleTogImJ5SW5kZXgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJ5SW5kZXgoaW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMuYWdnc1tpbmRleF07CiAgICB9CiAgfSwgewogICAga2V5OiAiYnlJZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYnlJZChpZCkgewogICAgICByZXR1cm4gdGhpcy5hZ2dzLmZpbmQoZnVuY3Rpb24gKGFnZykgewogICAgICAgIHJldHVybiBhZ2cuaWQgPT09IGlkOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJieU5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJ5TmFtZShuYW1lKSB7CiAgICAgIHJldHVybiB0aGlzLmFnZ3MuZmlsdGVyKGZ1bmN0aW9uIChhZ2cpIHsKICAgICAgICB2YXIgX2FnZyR0eXBlOwoKICAgICAgICByZXR1cm4gKChfYWdnJHR5cGUgPSBhZ2cudHlwZSkgPT09IG51bGwgfHwgX2FnZyR0eXBlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYWdnJHR5cGUubmFtZSkgPT09IG5hbWU7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImJ5VHlwZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYnlUeXBlKHR5cGUpIHsKICAgICAgcmV0dXJuIHRoaXMuYWdncy5maWx0ZXIoZnVuY3Rpb24gKGFnZykgewogICAgICAgIHZhciBfYWdnJHR5cGUyOwoKICAgICAgICByZXR1cm4gKChfYWdnJHR5cGUyID0gYWdnLnR5cGUpID09PSBudWxsIHx8IF9hZ2ckdHlwZTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hZ2ckdHlwZTIudHlwZSkgPT09IHR5cGU7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImJ5VHlwZU5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJ5VHlwZU5hbWUodHlwZSkgewogICAgICByZXR1cm4gdGhpcy5ieU5hbWUodHlwZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYnlTY2hlbWFOYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBieVNjaGVtYU5hbWUoc2NoZW1hKSB7CiAgICAgIHJldHVybiB0aGlzLmFnZ3MuZmlsdGVyKGZ1bmN0aW9uIChhZ2cpIHsKICAgICAgICByZXR1cm4gYWdnLnNjaGVtYSA9PT0gc2NoZW1hOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRSZXF1ZXN0QWdncyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVxdWVzdEFnZ3MoKSB7CiAgICAgIC8vIGNvbGxlY3QgYWxsIHRoZSBhZ2dyZWdhdGlvbnMKICAgICAgdmFyIGFnZ3JlZ2F0aW9ucyA9IHRoaXMuYWdncy5maWx0ZXIoZnVuY3Rpb24gKGFnZykgewogICAgICAgIHJldHVybiBhZ2cuZW5hYmxlZCAmJiBhZ2cudHlwZTsKICAgICAgfSkucmVkdWNlKGZ1bmN0aW9uIChyZXF1ZXN0VmFsdWVzQWdncywgYWdnKSB7CiAgICAgICAgdmFyIGFnZ3MgPSBhZ2cuZ2V0UmVxdWVzdEFnZ3MoKTsKICAgICAgICByZXR1cm4gYWdncyA/IHJlcXVlc3RWYWx1ZXNBZ2dzLmNvbmNhdChhZ2dzKSA6IHJlcXVlc3RWYWx1ZXNBZ2dzOwogICAgICB9LCBbXSk7IC8vIG1vdmUgbWV0cmljcyB0byB0aGUgZW5kCgogICAgICByZXR1cm4gX2xvZGFzaC5kZWZhdWx0LnNvcnRCeShhZ2dyZWdhdGlvbnMsIGZ1bmN0aW9uIChhZ2cpIHsKICAgICAgICByZXR1cm4gYWdnLnR5cGUudHlwZSA9PT0gX2FnZ19ncm91cHMuQWdnR3JvdXBOYW1lcy5NZXRyaWNzID8gMSA6IDA7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFJlcXVlc3RBZ2dCeUlkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZXF1ZXN0QWdnQnlJZChpZCkgewogICAgICByZXR1cm4gdGhpcy5hZ2dzLmZpbmQoZnVuY3Rpb24gKGFnZykgewogICAgICAgIHJldHVybiBhZ2cuaWQgPT09IGlkOwogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0cyB0aGUgQWdnQ29uZmlncyAoYW5kIHBvc3NpYmx5IFJlc3BvbnNlQWdnQ29uZmlncykgdGhhdAogICAgICogcmVwcmVzZW50IHRoZSB2YWx1ZXMgdGhhdCB3aWxsIGJlIHByb2R1Y2VkIHdoZW4gYWxsIGFnZ3MKICAgICAqIGFyZSBydW4uCiAgICAgKgogICAgICogV2l0aCBtdWx0aS12YWx1ZSBtZXRyaWMgYWdncyBpdCBpcyBwb3NzaWJsZSBmb3IgYSBzaW5nbGUgYWdnCiAgICAgKiByZXF1ZXN0IHRvIHJlc3VsdCBpbiBtdWx0aXBsZSBhZ2cgdmFsdWVzLCB3aGljaCBpcyB3aHkgdGhlIGxlbmd0aAogICAgICogb2YgYSB2aXMnIHJlc3BvbnNlVmFsdWVzQWdncyBtYXkgYmUgZGlmZmVyZW50IHRoYW4gdGhlIHZpcycgYWdncwogICAgICoKICAgICAqIEByZXR1cm4ge2FycmF5W0FnZ0NvbmZpZ119CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0UmVzcG9uc2VBZ2dzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZXNwb25zZUFnZ3MoKSB7CiAgICAgIHJldHVybiB0aGlzLmdldFJlcXVlc3RBZ2dzKCkucmVkdWNlKGZ1bmN0aW9uIChyZXNwb25zZVZhbHVlc0FnZ3MsIGFnZykgewogICAgICAgIHZhciBhZ2dzID0gYWdnLmdldFJlc3BvbnNlQWdncygpOwogICAgICAgIHJldHVybiBhZ2dzID8gcmVzcG9uc2VWYWx1ZXNBZ2dzLmNvbmNhdChhZ2dzKSA6IHJlc3BvbnNlVmFsdWVzQWdnczsKICAgICAgfSwgW10pOwogICAgfQogICAgLyoqCiAgICAgKiBGaW5kIGEgcmVzcG9uc2UgYWdnIGJ5IGl0J3MgaWQuIFRoaXMgbWF5IGJlIGFuIGFnZyBpbiB0aGUgYWdnQ29uZmlncywgb3Igb25lCiAgICAgKiBjcmVhdGVkIHNwZWNpZmljYWxseSBmb3IgYSByZXNwb25zZSB2YWx1ZQogICAgICoKICAgICAqIEBwYXJhbSAge3N0cmluZ30gaWQgLSB0aGUgaWQgb2YgdGhlIGFnZyB0byBmaW5kCiAgICAgKiBAcmV0dXJuIHtBZ2dDb25maWd9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0UmVzcG9uc2VBZ2dCeUlkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZXNwb25zZUFnZ0J5SWQoaWQpIHsKICAgICAgaWQgPSBTdHJpbmcoaWQpOwoKICAgICAgdmFyIHJlcUFnZyA9IF9sb2Rhc2guZGVmYXVsdC5maW5kKHRoaXMuZ2V0UmVxdWVzdEFnZ3MoKSwgZnVuY3Rpb24gKGFnZykgewogICAgICAgIHJldHVybiBpZC5zdWJzdHIoMCwgU3RyaW5nKGFnZy5pZCkubGVuZ3RoKSA9PT0gYWdnLmlkOwogICAgICB9KTsKCiAgICAgIGlmICghcmVxQWdnKSByZXR1cm47CiAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuZmluZChyZXFBZ2cuZ2V0UmVzcG9uc2VBZ2dzKCksIHsKICAgICAgICBpZDogaWQKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25TZWFyY2hSZXF1ZXN0U3RhcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uU2VhcmNoUmVxdWVzdFN0YXJ0KHNlYXJjaFNvdXJjZSwgb3B0aW9ucykgewogICAgICByZXR1cm4gUHJvbWlzZS5hbGwoIC8vIEB0cy1pZ25vcmUKICAgICAgdGhpcy5nZXRSZXF1ZXN0QWdncygpLm1hcChmdW5jdGlvbiAoYWdnKSB7CiAgICAgICAgcmV0dXJuIGFnZy5vblNlYXJjaFJlcXVlc3RTdGFydChzZWFyY2hTb3VyY2UsIG9wdGlvbnMpOwogICAgICB9KSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQWdnQ29uZmlnczsKfSgpOwoKZXhwb3J0cy5BZ2dDb25maWdzID0gQWdnQ29uZmlnczs="},null]}