{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/kibana/public/management/sections/objects/components/objects_table/objects_table.js","dependencies":[{"path":"src/legacy/core_plugins/kibana/public/management/sections/objects/components/objects_table/objects_table.js","mtime":1589249549846},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk9iamVjdHNUYWJsZSA9IGV4cG9ydHMuUE9TU0lCTEVfVFlQRVMgPSB2b2lkIDA7Cgp2YXIgX2Nocm9tZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidWkvY2hyb21lIikpOwoKdmFyIF9maWxlc2F2ZXIgPSByZXF1aXJlKCJAZWxhc3RpYy9maWxlc2F2ZXIiKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfcHJvcFR5cGVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJwcm9wLXR5cGVzIikpOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfaGVhZGVyID0gcmVxdWlyZSgiLi9jb21wb25lbnRzL2hlYWRlciIpOwoKdmFyIF9mbHlvdXQgPSByZXF1aXJlKCIuL2NvbXBvbmVudHMvZmx5b3V0Iik7Cgp2YXIgX3JlbGF0aW9uc2hpcHMgPSByZXF1aXJlKCIuL2NvbXBvbmVudHMvcmVsYXRpb25zaGlwcyIpOwoKdmFyIF90YWJsZSA9IHJlcXVpcmUoIi4vY29tcG9uZW50cy90YWJsZSIpOwoKdmFyIF9ub3RpZnkgPSByZXF1aXJlKCJ1aS9ub3RpZnkiKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2xpYiA9IHJlcXVpcmUoIi4uLy4uL2xpYiIpOwoKdmFyIF9leHRyYWN0X2V4cG9ydF9kZXRhaWxzID0gcmVxdWlyZSgiLi4vLi4vbGliL2V4dHJhY3RfZXhwb3J0X2RldGFpbHMiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307IGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOyB9IGVsc2UgeyBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgUE9TU0lCTEVfVFlQRVMgPSBfY2hyb21lLmRlZmF1bHQuZ2V0SW5qZWN0ZWQoJ2ltcG9ydEFuZEV4cG9ydGFibGVUeXBlcycpOwoKZXhwb3J0cy5QT1NTSUJMRV9UWVBFUyA9IFBPU1NJQkxFX1RZUEVTOwoKdmFyIE9iamVjdHNUYWJsZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoT2JqZWN0c1RhYmxlLCBfQ29tcG9uZW50KTsKCiAgZnVuY3Rpb24gT2JqZWN0c1RhYmxlKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE9iamVjdHNUYWJsZSk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoT2JqZWN0c1RhYmxlKS5jYWxsKHRoaXMsIHByb3BzKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmV0Y2hDb3VudHMiLAogICAgLyojX19QVVJFX18qLwogICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAvKiNfX1BVUkVfXyovCiAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICB2YXIgX3BhcnNlUXVlcnksIHF1ZXJ5VGV4dCwgdmlzaWJsZVR5cGVzLCBmaWx0ZXJlZFR5cGVzLCBmaWx0ZXJlZFNhdmVkT2JqZWN0Q291bnRzLCBleHBvcnRBbGxPcHRpb25zLCBleHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMsIHNhdmVkT2JqZWN0Q291bnRzOwoKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9wYXJzZVF1ZXJ5ID0gKDAsIF9saWIucGFyc2VRdWVyeSkoX3RoaXMuc3RhdGUuYWN0aXZlUXVlcnkpLCBxdWVyeVRleHQgPSBfcGFyc2VRdWVyeS5xdWVyeVRleHQsIHZpc2libGVUeXBlcyA9IF9wYXJzZVF1ZXJ5LnZpc2libGVUeXBlczsKICAgICAgICAgICAgICBmaWx0ZXJlZFR5cGVzID0gX3RoaXMuc2F2ZWRPYmplY3RUeXBlcy5maWx0ZXIoZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAhdmlzaWJsZVR5cGVzIHx8IHZpc2libGVUeXBlcy5pbmNsdWRlcyh0eXBlKTsKICAgICAgICAgICAgICB9KTsgLy8gVGhlc2UgYXJlIHRoZSBzYXZlZCBvYmplY3RzIHZpc2libGUgaW4gdGhlIHRhYmxlLgoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICByZXR1cm4gKDAsIF9saWIuZ2V0U2F2ZWRPYmplY3RDb3VudHMpKF90aGlzLnByb3BzLiRodHRwLCBmaWx0ZXJlZFR5cGVzLCBxdWVyeVRleHQpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGZpbHRlcmVkU2F2ZWRPYmplY3RDb3VudHMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIGV4cG9ydEFsbE9wdGlvbnMgPSBbXTsKICAgICAgICAgICAgICBleHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMgPSB7fTsKICAgICAgICAgICAgICBPYmplY3Qua2V5cyhmaWx0ZXJlZFNhdmVkT2JqZWN0Q291bnRzKS5mb3JFYWNoKGZ1bmN0aW9uIChpZCkgewogICAgICAgICAgICAgICAgLy8gQWRkIHRoaXMgdHlwZSBhcyBhIGJ1bGstZXhwb3J0IG9wdGlvbi4KICAgICAgICAgICAgICAgIGV4cG9ydEFsbE9wdGlvbnMucHVzaCh7CiAgICAgICAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgICAgICAgbGFiZWw6ICIiLmNvbmNhdChpZCwgIiAoIikuY29uY2F0KGZpbHRlcmVkU2F2ZWRPYmplY3RDb3VudHNbaWRdIHx8IDAsICIpIikKICAgICAgICAgICAgICAgIH0pOyAvLyBTZWxlY3QgaXQgYnkgZGVmYXl1bHQuCgogICAgICAgICAgICAgICAgZXhwb3J0QWxsU2VsZWN0ZWRPcHRpb25zW2lkXSA9IHRydWU7CiAgICAgICAgICAgICAgfSk7IC8vIEZldGNoIGFsbCB0aGUgc2F2ZWQgb2JqZWN0cyB0aGF0IGV4aXN0IHNvIHdlIGNhbiBhY2N1cmF0ZWx5IHBvcHVsYXRlIHRoZSBjb3VudHMgd2l0aGluCiAgICAgICAgICAgICAgLy8gdGhlIHRhYmxlIGZpbHRlciBkcm9wZG93bi4KCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgIHJldHVybiAoMCwgX2xpYi5nZXRTYXZlZE9iamVjdENvdW50cykoX3RoaXMucHJvcHMuJGh0dHAsIF90aGlzLnNhdmVkT2JqZWN0VHlwZXMsIHF1ZXJ5VGV4dCk7CgogICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIHNhdmVkT2JqZWN0Q291bnRzID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHN0YXRlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgc3RhdGUsIHsKICAgICAgICAgICAgICAgICAgc2F2ZWRPYmplY3RDb3VudHM6IHNhdmVkT2JqZWN0Q291bnRzLAogICAgICAgICAgICAgICAgICBleHBvcnRBbGxPcHRpb25zOiBleHBvcnRBbGxPcHRpb25zLAogICAgICAgICAgICAgICAgICBleHBvcnRBbGxTZWxlY3RlZE9wdGlvbnM6IGV4cG9ydEFsbFNlbGVjdGVkT3B0aW9ucwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmV0Y2hTYXZlZE9iamVjdHMiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc1NlYXJjaGluZzogdHJ1ZQogICAgICB9LCBfdGhpcy5kZWJvdW5jZWRGZXRjaCk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJkZWJvdW5jZWRGZXRjaCIsICgwLCBfbG9kYXNoLmRlYm91bmNlKSgKICAgIC8qI19fUFVSRV9fKi8KICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgLyojX19QVVJFX18qLwogICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0ZSwgcXVlcnksIHBhZ2UsIHBlclBhZ2UsIF9wYXJzZVF1ZXJ5MiwgcXVlcnlUZXh0LCB2aXNpYmxlVHlwZXMsIGZpbmRPcHRpb25zLCByZXNwOwoKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfdGhpcyRzdGF0ZSA9IF90aGlzLnN0YXRlLCBxdWVyeSA9IF90aGlzJHN0YXRlLmFjdGl2ZVF1ZXJ5LCBwYWdlID0gX3RoaXMkc3RhdGUucGFnZSwgcGVyUGFnZSA9IF90aGlzJHN0YXRlLnBlclBhZ2U7CiAgICAgICAgICAgICAgX3BhcnNlUXVlcnkyID0gKDAsIF9saWIucGFyc2VRdWVyeSkocXVlcnkpLCBxdWVyeVRleHQgPSBfcGFyc2VRdWVyeTIucXVlcnlUZXh0LCB2aXNpYmxlVHlwZXMgPSBfcGFyc2VRdWVyeTIudmlzaWJsZVR5cGVzOyAvLyAic2VhcmNoRmllbGRzIiBpcyBtaXNzaW5nIGZyb20gdGhlICJmaW5kT3B0aW9ucyIgYnV0IGdldHMgaW5qZWN0ZWQgdmlhIHRoZSBBUEkuCiAgICAgICAgICAgICAgLy8gVGhlIEFQSSBleHRyYWN0cyB0aGUgZmllbGRzIGZyb20gZWFjaCB1aUV4cG9ydHMuc2F2ZWRPYmplY3RzTWFuYWdlbWVudCAiZGVmYXVsdFNlYXJjaEZpZWxkIiBhdHRyaWJ1dGUKCiAgICAgICAgICAgICAgZmluZE9wdGlvbnMgPSB7CiAgICAgICAgICAgICAgICBzZWFyY2g6IHF1ZXJ5VGV4dCA/ICIiLmNvbmNhdChxdWVyeVRleHQsICIqIikgOiB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICBwZXJQYWdlOiBwZXJQYWdlLAogICAgICAgICAgICAgICAgcGFnZTogcGFnZSArIDEsCiAgICAgICAgICAgICAgICBmaWVsZHM6IFsnaWQnXSwKICAgICAgICAgICAgICAgIHR5cGU6IF90aGlzLnNhdmVkT2JqZWN0VHlwZXMuZmlsdGVyKGZ1bmN0aW9uICh0eXBlKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiAhdmlzaWJsZVR5cGVzIHx8IHZpc2libGVUeXBlcy5pbmNsdWRlcyh0eXBlKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgaWYgKGZpbmRPcHRpb25zLnR5cGUubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgICAgZmluZE9wdGlvbnMuc29ydEZpZWxkID0gJ3R5cGUnOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSA0OwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICByZXR1cm4gKDAsIF9saWIuZmluZE9iamVjdHMpKGZpbmRPcHRpb25zKTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICByZXNwID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAxMDsKICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oNCk7CgogICAgICAgICAgICAgIGlmIChfdGhpcy5faXNNb3VudGVkKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIGlzU2VhcmNoaW5nOiBmYWxzZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoewogICAgICAgICAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCdrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS51bmFibGVGaW5kU2F2ZWRPYmplY3RzTm90aWZpY2F0aW9uTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmFibGUgZmluZCBzYXZlZCBvYmplY3RzJwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB0ZXh0OiAiIi5jb25jYXQoX2NvbnRleHQyLnQwKQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgIGlmIChfdGhpcy5faXNNb3VudGVkKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChfcmVmMykgewogICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVF1ZXJ5ID0gX3JlZjMuYWN0aXZlUXVlcnk7CgogICAgICAgICAgICAgICAgLy8gaWdub3JlIHJlc3VsdHMgZm9yIG9sZCByZXF1ZXN0cwogICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVF1ZXJ5LnRleHQgIT09IHF1ZXJ5LnRleHQpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHt9OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgIHNhdmVkT2JqZWN0czogcmVzcC5zYXZlZE9iamVjdHMsCiAgICAgICAgICAgICAgICAgIGZpbHRlcmVkSXRlbUNvdW50OiByZXNwLnRvdGFsLAogICAgICAgICAgICAgICAgICBpc1NlYXJjaGluZzogZmFsc2UKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbNCwgMTBdXSk7CiAgICB9KSksIDMwMCkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlZnJlc2hEYXRhIiwKICAgIC8qI19fUFVSRV9fKi8KICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgLyojX19QVVJFX18qLwogICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbX3RoaXMuZmV0Y2hTYXZlZE9iamVjdHMoKSwgX3RoaXMuZmV0Y2hDb3VudHMoKV0pOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTMpOwogICAgfSkpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblNlbGVjdGlvbkNoYW5nZWQiLCBmdW5jdGlvbiAoc2VsZWN0aW9uKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBzZWxlY3RlZFNhdmVkT2JqZWN0czogc2VsZWN0aW9uCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25RdWVyeUNoYW5nZSIsIGZ1bmN0aW9uIChfcmVmNSkgewogICAgICB2YXIgcXVlcnkgPSBfcmVmNS5xdWVyeTsKCiAgICAgIC8vIFRPRE86IFVzZSBpc1NhbWVRdWVyeSB0byBjb21wYXJlIG5ldyBxdWVyeSB3aXRoIHN0YXRlLmFjdGl2ZVF1ZXJ5IHRvIGF2b2lkIHJlLWZldGNoaW5nIHRoZQogICAgICAvLyBzYW1lIGRhdGEgd2UgYWxyZWFkeSBoYXZlLgogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgYWN0aXZlUXVlcnk6IHF1ZXJ5LAogICAgICAgIHBhZ2U6IDAsCiAgICAgICAgLy8gUmVzZXQgdGhpcyBvbiBlYWNoIHF1ZXJ5IGNoYW5nZQogICAgICAgIHNlbGVjdGVkU2F2ZWRPYmplY3RzOiBbXQogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuZmV0Y2hTYXZlZE9iamVjdHMoKTsKCiAgICAgICAgX3RoaXMuZmV0Y2hDb3VudHMoKTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblRhYmxlQ2hhbmdlIiwKICAgIC8qI19fUFVSRV9fKi8KICAgIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZWY2ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQodGFibGUpIHsKICAgICAgICB2YXIgX3JlZjcsIHBhZ2UsIHBlclBhZ2U7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfcmVmNyA9IHRhYmxlLnBhZ2UgfHwge30sIHBhZ2UgPSBfcmVmNy5pbmRleCwgcGVyUGFnZSA9IF9yZWY3LnNpemU7CgogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICBwYWdlOiBwYWdlLAogICAgICAgICAgICAgICAgICBwZXJQYWdlOiBwZXJQYWdlLAogICAgICAgICAgICAgICAgICBzZWxlY3RlZFNhdmVkT2JqZWN0czogW10KICAgICAgICAgICAgICAgIH0sIF90aGlzLmZldGNoU2F2ZWRPYmplY3RzKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgIHJldHVybiBfcmVmNi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblNob3dSZWxhdGlvbnNoaXBzIiwgZnVuY3Rpb24gKG9iamVjdCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNTaG93aW5nUmVsYXRpb25zaGlwczogdHJ1ZSwKICAgICAgICByZWxhdGlvbnNoaXBPYmplY3Q6IG9iamVjdAogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uSGlkZVJlbGF0aW9uc2hpcHMiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc1Nob3dpbmdSZWxhdGlvbnNoaXBzOiBmYWxzZSwKICAgICAgICByZWxhdGlvbnNoaXBPYmplY3Q6IHVuZGVmaW5lZAogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRXhwb3J0IiwKICAgIC8qI19fUFVSRV9fKi8KICAgIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZWY4ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoaW5jbHVkZVJlZmVyZW5jZXNEZWVwKSB7CiAgICAgICAgdmFyIHNlbGVjdGVkU2F2ZWRPYmplY3RzLCBvYmplY3RzVG9FeHBvcnQsIGJsb2IsIGV4cG9ydERldGFpbHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHNlbGVjdGVkU2F2ZWRPYmplY3RzID0gX3RoaXMuc3RhdGUuc2VsZWN0ZWRTYXZlZE9iamVjdHM7CiAgICAgICAgICAgICAgICBvYmplY3RzVG9FeHBvcnQgPSBzZWxlY3RlZFNhdmVkT2JqZWN0cy5tYXAoZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIGlkOiBvYmouaWQsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogb2JqLnR5cGUKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnByZXYgPSAyOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuICgwLCBfbGliLmZldGNoRXhwb3J0T2JqZWN0cykob2JqZWN0c1RvRXhwb3J0LCBpbmNsdWRlUmVmZXJlbmNlc0RlZXApOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBibG9iID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5wcmV2ID0gODsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS50MCA9IF9jb250ZXh0NVsiY2F0Y2giXSgyKTsKCiAgICAgICAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoewogICAgICAgICAgICAgICAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2tibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLmV4cG9ydC5kYW5nZXJOb3RpZmljYXRpb24nLCB7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmFibGUgdG8gZ2VuZXJhdGUgZXhwb3J0JwogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQ1LnQwOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgKDAsIF9maWxlc2F2ZXIuc2F2ZUFzKShibG9iLCAnZXhwb3J0Lm5kanNvbicpOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX2V4dHJhY3RfZXhwb3J0X2RldGFpbHMuZXh0cmFjdEV4cG9ydERldGFpbHMpKGJsb2IpOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgZXhwb3J0RGV0YWlscyA9IF9jb250ZXh0NS5zZW50OwoKICAgICAgICAgICAgICAgIF90aGlzLnNob3dFeHBvcnRTdWNjZXNzTWVzc2FnZShleHBvcnREZXRhaWxzKTsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNSwgbnVsbCwgW1syLCA4XV0pOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gKF94MikgewogICAgICAgIHJldHVybiBfcmVmOC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkV4cG9ydEFsbCIsCiAgICAvKiNfX1BVUkVfXyovCiAgICBfYXN5bmNUb0dlbmVyYXRvcigKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICB2YXIgX3RoaXMkc3RhdGUyLCBleHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMsIGlzSW5jbHVkZVJlZmVyZW5jZXNEZWVwQ2hlY2tlZCwgYWN0aXZlUXVlcnksIF9wYXJzZVF1ZXJ5MywgcXVlcnlUZXh0LCBleHBvcnRUeXBlcywgYmxvYiwgZXhwb3J0RGV0YWlsczsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMkc3RhdGUyID0gX3RoaXMuc3RhdGUsIGV4cG9ydEFsbFNlbGVjdGVkT3B0aW9ucyA9IF90aGlzJHN0YXRlMi5leHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMsIGlzSW5jbHVkZVJlZmVyZW5jZXNEZWVwQ2hlY2tlZCA9IF90aGlzJHN0YXRlMi5pc0luY2x1ZGVSZWZlcmVuY2VzRGVlcENoZWNrZWQsIGFjdGl2ZVF1ZXJ5ID0gX3RoaXMkc3RhdGUyLmFjdGl2ZVF1ZXJ5OwogICAgICAgICAgICAgIF9wYXJzZVF1ZXJ5MyA9ICgwLCBfbGliLnBhcnNlUXVlcnkpKGFjdGl2ZVF1ZXJ5KSwgcXVlcnlUZXh0ID0gX3BhcnNlUXVlcnkzLnF1ZXJ5VGV4dDsKICAgICAgICAgICAgICBleHBvcnRUeXBlcyA9IE9iamVjdC5lbnRyaWVzKGV4cG9ydEFsbFNlbGVjdGVkT3B0aW9ucykucmVkdWNlKGZ1bmN0aW9uIChhY2N1bSwgX3JlZjEwKSB7CiAgICAgICAgICAgICAgICB2YXIgX3JlZjExID0gX3NsaWNlZFRvQXJyYXkoX3JlZjEwLCAyKSwKICAgICAgICAgICAgICAgICAgICBpZCA9IF9yZWYxMVswXSwKICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IF9yZWYxMVsxXTsKCiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgICAgYWNjdW0ucHVzaChpZCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIGFjY3VtOwogICAgICAgICAgICAgIH0sIFtdKTsKICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDM7CiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA2OwogICAgICAgICAgICAgIHJldHVybiAoMCwgX2xpYi5mZXRjaEV4cG9ydEJ5VHlwZUFuZFNlYXJjaCkoZXhwb3J0VHlwZXMsIHF1ZXJ5VGV4dCA/ICIiLmNvbmNhdChxdWVyeVRleHQsICIqIikgOiB1bmRlZmluZWQsIGlzSW5jbHVkZVJlZmVyZW5jZXNEZWVwQ2hlY2tlZCk7CgogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgYmxvYiA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSA5OwogICAgICAgICAgICAgIF9jb250ZXh0Ni50MCA9IF9jb250ZXh0NlsiY2F0Y2giXSgzKTsKCiAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKHsKICAgICAgICAgICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZXhwb3J0LmRhbmdlck5vdGlmaWNhdGlvbicsIHsKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmFibGUgdG8gZ2VuZXJhdGUgZXhwb3J0JwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQ2LnQwOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAoMCwgX2ZpbGVzYXZlci5zYXZlQXMpKGJsb2IsICdleHBvcnQubmRqc29uJyk7CiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxNjsKICAgICAgICAgICAgICByZXR1cm4gKDAsIF9leHRyYWN0X2V4cG9ydF9kZXRhaWxzLmV4dHJhY3RFeHBvcnREZXRhaWxzKShibG9iKTsKCiAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgZXhwb3J0RGV0YWlscyA9IF9jb250ZXh0Ni5zZW50OwoKICAgICAgICAgICAgICBfdGhpcy5zaG93RXhwb3J0U3VjY2Vzc01lc3NhZ2UoZXhwb3J0RGV0YWlscyk7CgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGlzU2hvd2luZ0V4cG9ydEFsbE9wdGlvbnNNb2RhbDogZmFsc2UKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlNiwgbnVsbCwgW1szLCA5XV0pOwogICAgfSkpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzaG93RXhwb3J0U3VjY2Vzc01lc3NhZ2UiLCBmdW5jdGlvbiAoZXhwb3J0RGV0YWlscykgewogICAgICBpZiAoZXhwb3J0RGV0YWlscyAmJiBleHBvcnREZXRhaWxzLm1pc3NpbmdSZWZlcmVuY2VzLmxlbmd0aCA+IDApIHsKICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGRXYXJuaW5nKHsKICAgICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZXhwb3J0LnN1Y2Nlc3NXaXRoTWlzc2luZ1JlZnNOb3RpZmljYXRpb24nLCB7CiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnWW91ciBmaWxlIGlzIGRvd25sb2FkaW5nIGluIHRoZSBiYWNrZ3JvdW5kLiAnICsgJ1NvbWUgcmVsYXRlZCBvYmplY3RzIGNvdWxkIG5vdCBiZSBmb3VuZC4gJyArICdQbGVhc2Ugc2VlIHRoZSBsYXN0IGxpbmUgaW4gdGhlIGV4cG9ydGVkIGZpbGUgZm9yIGEgbGlzdCBvZiBtaXNzaW5nIG9iamVjdHMuJwogICAgICAgICAgfSkKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGRTdWNjZXNzKHsKICAgICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZXhwb3J0LnN1Y2Nlc3NOb3RpZmljYXRpb24nLCB7CiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnWW91ciBmaWxlIGlzIGRvd25sb2FkaW5nIGluIHRoZSBiYWNrZ3JvdW5kJwogICAgICAgICAgfSkKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmluaXNoSW1wb3J0IiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5oaWRlSW1wb3J0Rmx5b3V0KCk7CgogICAgICBfdGhpcy5mZXRjaFNhdmVkT2JqZWN0cygpOwoKICAgICAgX3RoaXMuZmV0Y2hDb3VudHMoKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInNob3dJbXBvcnRGbHlvdXQiLCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc1Nob3dpbmdJbXBvcnRGbHlvdXQ6IHRydWUKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJoaWRlSW1wb3J0Rmx5b3V0IiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNTaG93aW5nSW1wb3J0Rmx5b3V0OiBmYWxzZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uRGVsZXRlIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNTaG93aW5nRGVsZXRlQ29uZmlybU1vZGFsOiB0cnVlCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZGVsZXRlIiwKICAgIC8qI19fUFVSRV9fKi8KICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgLyojX19QVVJFX18qLwogICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgIHZhciBzYXZlZE9iamVjdHNDbGllbnQsIF90aGlzJHN0YXRlMywgc2VsZWN0ZWRTYXZlZE9iamVjdHMsIGlzRGVsZXRpbmcsIGluZGV4UGF0dGVybnMsIG9iamVjdHMsIGRlbGV0ZXM7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHNhdmVkT2JqZWN0c0NsaWVudCA9IF90aGlzLnByb3BzLnNhdmVkT2JqZWN0c0NsaWVudDsKICAgICAgICAgICAgICBfdGhpcyRzdGF0ZTMgPSBfdGhpcy5zdGF0ZSwgc2VsZWN0ZWRTYXZlZE9iamVjdHMgPSBfdGhpcyRzdGF0ZTMuc2VsZWN0ZWRTYXZlZE9iamVjdHMsIGlzRGVsZXRpbmcgPSBfdGhpcyRzdGF0ZTMuaXNEZWxldGluZzsKCiAgICAgICAgICAgICAgaWYgKCFpc0RlbGV0aW5nKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBpc0RlbGV0aW5nOiB0cnVlCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGluZGV4UGF0dGVybnMgPSBzZWxlY3RlZFNhdmVkT2JqZWN0cy5maWx0ZXIoZnVuY3Rpb24gKG9iamVjdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIG9iamVjdC50eXBlID09PSAnaW5kZXgtcGF0dGVybic7CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGlmICghaW5kZXhQYXR0ZXJucy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA5OwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5wcm9wcy5pbmRleFBhdHRlcm5zLmNsZWFyQ2FjaGUoKTsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDExOwogICAgICAgICAgICAgIHJldHVybiBzYXZlZE9iamVjdHNDbGllbnQuYnVsa0dldChzZWxlY3RlZFNhdmVkT2JqZWN0cyk7CgogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIG9iamVjdHMgPSBfY29udGV4dDcuc2VudDsKICAgICAgICAgICAgICBkZWxldGVzID0gb2JqZWN0cy5zYXZlZE9iamVjdHMubWFwKGZ1bmN0aW9uIChvYmplY3QpIHsKICAgICAgICAgICAgICAgIHJldHVybiBzYXZlZE9iamVjdHNDbGllbnQuZGVsZXRlKG9iamVjdC50eXBlLCBvYmplY3QuaWQpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGRlbGV0ZXMpOwoKICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAvLyBVbnNldCB0aGlzCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgc2VsZWN0ZWRTYXZlZE9iamVjdHM6IFtdCiAgICAgICAgICAgICAgfSk7IC8vIEZldGNoaW5nIGFsbCBkYXRhCgoKICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDE4OwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5mZXRjaFNhdmVkT2JqZWN0cygpOwoKICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDIwOwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5mZXRjaENvdW50cygpOwoKICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAvLyBBbGxvdyB0aGUgdXNlciB0byBpbnRlcmFjdCB3aXRoIHRoZSB0YWJsZSBvbmNlIHRoZSBzYXZlZCBvYmplY3RzIGhhdmUgYmVlbiByZS1mZXRjaGVkLgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGlzU2hvd2luZ0RlbGV0ZUNvbmZpcm1Nb2RhbDogZmFsc2UsCiAgICAgICAgICAgICAgICBpc0RlbGV0aW5nOiBmYWxzZQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU3KTsKICAgIH0pKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0UmVsYXRpb25zaGlwcyIsCiAgICAvKiNfX1BVUkVfXyovCiAgICBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVmMTMgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCh0eXBlLCBpZCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gKDAsIF9saWIuZ2V0UmVsYXRpb25zaGlwcykodHlwZSwgaWQsIF90aGlzLnNhdmVkT2JqZWN0VHlwZXMsIF90aGlzLnByb3BzLiRodHRwLCBfdGhpcy5wcm9wcy5iYXNlUGF0aCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDguc2VudCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOCk7CiAgICAgIH0pKTsKCiAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gzLCBfeDQpIHsKICAgICAgICByZXR1cm4gX3JlZjEzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9KCkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNoYW5nZUluY2x1ZGVSZWZlcmVuY2VzRGVlcCIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHN0YXRlKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGlzSW5jbHVkZVJlZmVyZW5jZXNEZWVwQ2hlY2tlZDogIXN0YXRlLmlzSW5jbHVkZVJlZmVyZW5jZXNEZWVwQ2hlY2tlZAogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2xvc2VFeHBvcnRBbGxNb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGlzU2hvd2luZ0V4cG9ydEFsbE9wdGlvbnNNb2RhbDogZmFsc2UKICAgICAgfSk7CiAgICB9KTsKCiAgICBfdGhpcy5zYXZlZE9iamVjdFR5cGVzID0gUE9TU0lCTEVfVFlQRVM7CiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgdG90YWxDb3VudDogMCwKICAgICAgcGFnZTogMCwKICAgICAgcGVyUGFnZTogcHJvcHMucGVyUGFnZUNvbmZpZyB8fCA1MCwKICAgICAgc2F2ZWRPYmplY3RzOiBbXSwKICAgICAgc2F2ZWRPYmplY3RDb3VudHM6IF90aGlzLnNhdmVkT2JqZWN0VHlwZXMucmVkdWNlKGZ1bmN0aW9uICh0eXBlVG9Db3VudE1hcCwgdHlwZSkgewogICAgICAgIHR5cGVUb0NvdW50TWFwW3R5cGVdID0gMDsKICAgICAgICByZXR1cm4gdHlwZVRvQ291bnRNYXA7CiAgICAgIH0sIHt9KSwKICAgICAgYWN0aXZlUXVlcnk6IF9ldWkuUXVlcnkucGFyc2UoJycpLAogICAgICBzZWxlY3RlZFNhdmVkT2JqZWN0czogW10sCiAgICAgIGlzU2hvd2luZ0ltcG9ydEZseW91dDogZmFsc2UsCiAgICAgIGlzU2VhcmNoaW5nOiBmYWxzZSwKICAgICAgZmlsdGVyZWRJdGVtQ291bnQ6IDAsCiAgICAgIGlzU2hvd2luZ1JlbGF0aW9uc2hpcHM6IGZhbHNlLAogICAgICByZWxhdGlvbnNoaXBPYmplY3Q6IHVuZGVmaW5lZCwKICAgICAgaXNTaG93aW5nRGVsZXRlQ29uZmlybU1vZGFsOiBmYWxzZSwKICAgICAgaXNTaG93aW5nRXhwb3J0QWxsT3B0aW9uc01vZGFsOiBmYWxzZSwKICAgICAgaXNEZWxldGluZzogZmFsc2UsCiAgICAgIGV4cG9ydEFsbE9wdGlvbnM6IFtdLAogICAgICBleHBvcnRBbGxTZWxlY3RlZE9wdGlvbnM6IHt9LAogICAgICBpc0luY2x1ZGVSZWZlcmVuY2VzRGVlcENoZWNrZWQ6IHRydWUKICAgIH07CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoT2JqZWN0c1RhYmxlLCBbewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB0aGlzLl9pc01vdW50ZWQgPSB0cnVlOwogICAgICB0aGlzLmZldGNoU2F2ZWRPYmplY3RzKCk7CiAgICAgIHRoaXMuZmV0Y2hDb3VudHMoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsVW5tb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7CiAgICAgIHRoaXMuX2lzTW91bnRlZCA9IGZhbHNlOwogICAgICB0aGlzLmRlYm91bmNlZEZldGNoLmNhbmNlbCgpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckZseW91dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyRmx5b3V0KCkgewogICAgICBpZiAoIXRoaXMuc3RhdGUuaXNTaG93aW5nSW1wb3J0Rmx5b3V0KSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9mbHlvdXQuRmx5b3V0LCB7CiAgICAgICAgY2xvc2U6IHRoaXMuaGlkZUltcG9ydEZseW91dCwKICAgICAgICBkb25lOiB0aGlzLmZpbmlzaEltcG9ydCwKICAgICAgICBzZXJ2aWNlczogdGhpcy5wcm9wcy5zZXJ2aWNlcywKICAgICAgICBpbmRleFBhdHRlcm5zOiB0aGlzLnByb3BzLmluZGV4UGF0dGVybnMsCiAgICAgICAgbmV3SW5kZXhQYXR0ZXJuVXJsOiB0aGlzLnByb3BzLm5ld0luZGV4UGF0dGVyblVybCwKICAgICAgICBzYXZlZE9iamVjdFR5cGVzOiB0aGlzLnByb3BzLnNhdmVkT2JqZWN0VHlwZXMsCiAgICAgICAgY29uZmlybU1vZGFsUHJvbWlzZTogdGhpcy5wcm9wcy5jb25maXJtTW9kYWxQcm9taXNlCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlclJlbGF0aW9uc2hpcHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclJlbGF0aW9uc2hpcHMoKSB7CiAgICAgIGlmICghdGhpcy5zdGF0ZS5pc1Nob3dpbmdSZWxhdGlvbnNoaXBzKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWxhdGlvbnNoaXBzLlJlbGF0aW9uc2hpcHMsIHsKICAgICAgICBzYXZlZE9iamVjdDogdGhpcy5zdGF0ZS5yZWxhdGlvbnNoaXBPYmplY3QsCiAgICAgICAgZ2V0UmVsYXRpb25zaGlwczogdGhpcy5nZXRSZWxhdGlvbnNoaXBzLAogICAgICAgIGNsb3NlOiB0aGlzLm9uSGlkZVJlbGF0aW9uc2hpcHMsCiAgICAgICAgZ2V0RGFzaGJvYXJkVXJsOiB0aGlzLnByb3BzLmdldERhc2hib2FyZFVybCwKICAgICAgICBnb0luc3BlY3RPYmplY3Q6IHRoaXMucHJvcHMuZ29JbnNwZWN0T2JqZWN0LAogICAgICAgIGNhbkdvSW5BcHA6IHRoaXMucHJvcHMuY2FuR29JbkFwcAogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJEZWxldGVDb25maXJtTW9kYWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckRlbGV0ZUNvbmZpcm1Nb2RhbCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkc3RhdGU0ID0gdGhpcy5zdGF0ZSwKICAgICAgICAgIGlzU2hvd2luZ0RlbGV0ZUNvbmZpcm1Nb2RhbCA9IF90aGlzJHN0YXRlNC5pc1Nob3dpbmdEZWxldGVDb25maXJtTW9kYWwsCiAgICAgICAgICBpc0RlbGV0aW5nID0gX3RoaXMkc3RhdGU0LmlzRGVsZXRpbmcsCiAgICAgICAgICBzZWxlY3RlZFNhdmVkT2JqZWN0cyA9IF90aGlzJHN0YXRlNC5zZWxlY3RlZFNhdmVkT2JqZWN0czsKCiAgICAgIGlmICghaXNTaG93aW5nRGVsZXRlQ29uZmlybU1vZGFsKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBtb2RhbDsKCiAgICAgIGlmIChpc0RlbGV0aW5nKSB7CiAgICAgICAgLy8gQmxvY2sgdGhlIHVzZXIgZnJvbSBpbnRlcmFjdGluZyB3aXRoIHRoZSB0YWJsZSB3aGlsZSBpdHMgY29udGVudHMgYXJlIGJlaW5nIGRlbGV0ZWQuCiAgICAgICAgbW9kYWwgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTG9hZGluZ0tpYmFuYSwgewogICAgICAgICAgc2l6ZTogInhsIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBvbkNhbmNlbCA9IGZ1bmN0aW9uIG9uQ2FuY2VsKCkgewogICAgICAgICAgX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgICAgaXNTaG93aW5nRGVsZXRlQ29uZmlybU1vZGFsOiBmYWxzZQogICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIG9uQ29uZmlybSA9IGZ1bmN0aW9uIG9uQ29uZmlybSgpIHsKICAgICAgICAgIF90aGlzMi5kZWxldGUoKTsKICAgICAgICB9OwoKICAgICAgICBtb2RhbCA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDb25maXJtTW9kYWwsIHsKICAgICAgICAgIHRpdGxlOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgICBpZDogImtibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLmRlbGV0ZVNhdmVkT2JqZWN0c0NvbmZpcm1Nb2RhbFRpdGxlIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJEZWxldGUgc2F2ZWQgb2JqZWN0cyIKICAgICAgICAgIH0pLAogICAgICAgICAgb25DYW5jZWw6IG9uQ2FuY2VsLAogICAgICAgICAgb25Db25maXJtOiBvbkNvbmZpcm0sCiAgICAgICAgICBidXR0b25Db2xvcjogImRhbmdlciIsCiAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgICBpZDogImtibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLmRlbGV0ZVNhdmVkT2JqZWN0c0NvbmZpcm1Nb2RhbC5jYW5jZWxCdXR0b25MYWJlbCIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ2FuY2VsIgogICAgICAgICAgfSksCiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogaXNEZWxldGluZyA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAia2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZGVsZXRlU2F2ZWRPYmplY3RzQ29uZmlybU1vZGFsLmRlbGV0ZVByb2Nlc3NCdXR0b25MYWJlbCIsCiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRGVsZXRpbmdcdTIwMjYiCiAgICAgICAgICB9KSA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAia2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZGVsZXRlU2F2ZWRPYmplY3RzQ29uZmlybU1vZGFsLmRlbGV0ZUJ1dHRvbkxhYmVsIiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJEZWxldGUiCiAgICAgICAgICB9KSwKICAgICAgICAgIGRlZmF1bHRGb2N1c2VkQnV0dG9uOiBfZXVpLkVVSV9NT0RBTF9DT05GSVJNX0JVVFRPTgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJrYm4ubWFuYWdlbWVudC5vYmplY3RzLmRlbGV0ZVNhdmVkT2JqZWN0c0NvbmZpcm1Nb2RhbERlc2NyaXB0aW9uIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVGhpcyBhY3Rpb24gd2lsbCBkZWxldGUgdGhlIGZvbGxvd2luZyBzYXZlZCBvYmplY3RzOiIKICAgICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJbk1lbW9yeVRhYmxlLCB7CiAgICAgICAgICBpdGVtczogc2VsZWN0ZWRTYXZlZE9iamVjdHMsCiAgICAgICAgICBjb2x1bW5zOiBbewogICAgICAgICAgICBmaWVsZDogJ3R5cGUnLAogICAgICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgna2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZGVsZXRlU2F2ZWRPYmplY3RzQ29uZmlybU1vZGFsLnR5cGVDb2x1bW5OYW1lJywgewogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVHlwZScKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIHdpZHRoOiAnNTBweCcsCiAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHR5cGUsIG9iamVjdCkgewogICAgICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVG9vbFRpcCwgewogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AiLAogICAgICAgICAgICAgICAgY29udGVudDogKDAsIF9saWIuZ2V0U2F2ZWRPYmplY3RMYWJlbCkodHlwZSkKICAgICAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICAgICAgICAgICAgdHlwZTogb2JqZWN0Lm1ldGEuaWNvbiB8fCAnYXBwcycKICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIHsKICAgICAgICAgICAgZmllbGQ6ICdpZCcsCiAgICAgICAgICAgIG5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCdrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5kZWxldGVTYXZlZE9iamVjdHNDb25maXJtTW9kYWwuaWRDb2x1bW5OYW1lJywgewogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnSWQnCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGZpZWxkOiAnbWV0YS50aXRsZScsCiAgICAgICAgICAgIG5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCdrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5kZWxldGVTYXZlZE9iamVjdHNDb25maXJtTW9kYWwudGl0bGVDb2x1bW5OYW1lJywgewogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVGl0bGUnCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9XSwKICAgICAgICAgIHBhZ2luYXRpb246IHRydWUsCiAgICAgICAgICBzb3J0aW5nOiBmYWxzZQogICAgICAgIH0pKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlPdmVybGF5TWFzaywgbnVsbCwgbW9kYWwpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckV4cG9ydEFsbE9wdGlvbnNNb2RhbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyRXhwb3J0QWxsT3B0aW9uc01vZGFsKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyRzdGF0ZTUgPSB0aGlzLnN0YXRlLAogICAgICAgICAgaXNTaG93aW5nRXhwb3J0QWxsT3B0aW9uc01vZGFsID0gX3RoaXMkc3RhdGU1LmlzU2hvd2luZ0V4cG9ydEFsbE9wdGlvbnNNb2RhbCwKICAgICAgICAgIGZpbHRlcmVkSXRlbUNvdW50ID0gX3RoaXMkc3RhdGU1LmZpbHRlcmVkSXRlbUNvdW50LAogICAgICAgICAgZXhwb3J0QWxsT3B0aW9ucyA9IF90aGlzJHN0YXRlNS5leHBvcnRBbGxPcHRpb25zLAogICAgICAgICAgZXhwb3J0QWxsU2VsZWN0ZWRPcHRpb25zID0gX3RoaXMkc3RhdGU1LmV4cG9ydEFsbFNlbGVjdGVkT3B0aW9ucywKICAgICAgICAgIGlzSW5jbHVkZVJlZmVyZW5jZXNEZWVwQ2hlY2tlZCA9IF90aGlzJHN0YXRlNS5pc0luY2x1ZGVSZWZlcmVuY2VzRGVlcENoZWNrZWQ7CgogICAgICBpZiAoIWlzU2hvd2luZ0V4cG9ydEFsbE9wdGlvbnNNb2RhbCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU92ZXJsYXlNYXNrLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTW9kYWwsIHsKICAgICAgICBvbkNsb3NlOiB0aGlzLmNsb3NlRXhwb3J0QWxsTW9kYWwKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU1vZGFsSGVhZGVyLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTW9kYWxIZWFkZXJUaXRsZSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogImtibi5tYW5hZ2VtZW50Lm9iamVjdHMub2JqZWN0c1RhYmxlLmV4cG9ydE9iamVjdHNDb25maXJtTW9kYWxUaXRsZSIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFeHBvcnQge2ZpbHRlcmVkSXRlbUNvdW50LCBwbHVyYWwsIG9uZXsjIG9iamVjdH0gb3RoZXIgeyMgb2JqZWN0c319IiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIGZpbHRlcmVkSXRlbUNvdW50OiBmaWx0ZXJlZEl0ZW1Db3VudAogICAgICAgIH0KICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU1vZGFsQm9keSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm1Sb3csIHsKICAgICAgICBsYWJlbDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAia2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZXhwb3J0T2JqZWN0c0NvbmZpcm1Nb2RhbERlc2NyaXB0aW9uIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU2VsZWN0IHdoaWNoIHR5cGVzIHRvIGV4cG9ydCIKICAgICAgICB9KSwKICAgICAgICBsYWJlbFR5cGU6ICJsZWdlbmQiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDaGVja2JveEdyb3VwLCB7CiAgICAgICAgb3B0aW9uczogZXhwb3J0QWxsT3B0aW9ucywKICAgICAgICBpZFRvU2VsZWN0ZWRNYXA6IGV4cG9ydEFsbFNlbGVjdGVkT3B0aW9ucywKICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2Uob3B0aW9uSWQpIHsKICAgICAgICAgIHZhciBuZXdFeHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMgPSBfb2JqZWN0U3ByZWFkKHt9LCBleHBvcnRBbGxTZWxlY3RlZE9wdGlvbnMsIHt9LCBfZGVmaW5lUHJvcGVydHkoe30sIG9wdGlvbklkLCAhZXhwb3J0QWxsU2VsZWN0ZWRPcHRpb25zW29wdGlvbklkXSkpOwoKICAgICAgICAgIF90aGlzMy5zZXRTdGF0ZSh7CiAgICAgICAgICAgIGV4cG9ydEFsbFNlbGVjdGVkT3B0aW9uczogbmV3RXhwb3J0QWxsU2VsZWN0ZWRPcHRpb25zCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJtIgogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVN3aXRjaCwgewogICAgICAgIG5hbWU6ICJpbmNsdWRlUmVmZXJlbmNlc0RlZXAiLAogICAgICAgIGxhYmVsOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5leHBvcnRPYmplY3RzQ29uZmlybU1vZGFsLmluY2x1ZGVSZWZlcmVuY2VzRGVlcExhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiSW5jbHVkZSByZWxhdGVkIG9iamVjdHMiCiAgICAgICAgfSksCiAgICAgICAgY2hlY2tlZDogaXNJbmNsdWRlUmVmZXJlbmNlc0RlZXBDaGVja2VkLAogICAgICAgIG9uQ2hhbmdlOiB0aGlzLmNoYW5nZUluY2x1ZGVSZWZlcmVuY2VzRGVlcAogICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlNb2RhbEZvb3RlciwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgIGp1c3RpZnlDb250ZW50OiAiZmxleEVuZCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkVtcHR5LCB7CiAgICAgICAgb25DbGljazogdGhpcy5jbG9zZUV4cG9ydEFsbE1vZGFsCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJrYm4ubWFuYWdlbWVudC5vYmplY3RzLm9iamVjdHNUYWJsZS5leHBvcnRPYmplY3RzQ29uZmlybU1vZGFsLmNhbmNlbEJ1dHRvbkxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNhbmNlbCIKICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgIGZpbGw6IHRydWUsCiAgICAgICAgb25DbGljazogdGhpcy5vbkV4cG9ydEFsbAogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAia2JuLm1hbmFnZW1lbnQub2JqZWN0cy5vYmplY3RzVGFibGUuZXhwb3J0T2JqZWN0c0NvbmZpcm1Nb2RhbC5leHBvcnRBbGxCdXR0b25MYWJlbCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFeHBvcnQgYWxsIgogICAgICB9KSkpKSkpKSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyRzdGF0ZTYgPSB0aGlzLnN0YXRlLAogICAgICAgICAgc2VsZWN0ZWRTYXZlZE9iamVjdHMgPSBfdGhpcyRzdGF0ZTYuc2VsZWN0ZWRTYXZlZE9iamVjdHMsCiAgICAgICAgICBwYWdlID0gX3RoaXMkc3RhdGU2LnBhZ2UsCiAgICAgICAgICBwZXJQYWdlID0gX3RoaXMkc3RhdGU2LnBlclBhZ2UsCiAgICAgICAgICBzYXZlZE9iamVjdHMgPSBfdGhpcyRzdGF0ZTYuc2F2ZWRPYmplY3RzLAogICAgICAgICAgZmlsdGVyZWRJdGVtQ291bnQgPSBfdGhpcyRzdGF0ZTYuZmlsdGVyZWRJdGVtQ291bnQsCiAgICAgICAgICBpc1NlYXJjaGluZyA9IF90aGlzJHN0YXRlNi5pc1NlYXJjaGluZywKICAgICAgICAgIHNhdmVkT2JqZWN0Q291bnRzID0gX3RoaXMkc3RhdGU2LnNhdmVkT2JqZWN0Q291bnRzOwogICAgICB2YXIgc2VsZWN0aW9uQ29uZmlnID0gewogICAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlOiB0aGlzLm9uU2VsZWN0aW9uQ2hhbmdlZAogICAgICB9OwogICAgICB2YXIgZmlsdGVyT3B0aW9ucyA9IHRoaXMuc2F2ZWRPYmplY3RUeXBlcy5tYXAoZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdmFsdWU6IHR5cGUsCiAgICAgICAgICBuYW1lOiB0eXBlLAogICAgICAgICAgdmlldzogIiIuY29uY2F0KHR5cGUsICIgKCIpLmNvbmNhdChzYXZlZE9iamVjdENvdW50c1t0eXBlXSB8fCAwLCAiKSIpCiAgICAgICAgfTsKICAgICAgfSk7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnZUNvbnRlbnQsIHsKICAgICAgICBob3Jpem9udGFsUG9zaXRpb246ICJjZW50ZXIiCiAgICAgIH0sIHRoaXMucmVuZGVyRmx5b3V0KCksIHRoaXMucmVuZGVyUmVsYXRpb25zaGlwcygpLCB0aGlzLnJlbmRlckRlbGV0ZUNvbmZpcm1Nb2RhbCgpLCB0aGlzLnJlbmRlckV4cG9ydEFsbE9wdGlvbnNNb2RhbCgpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9oZWFkZXIuSGVhZGVyLCB7CiAgICAgICAgb25FeHBvcnRBbGw6IGZ1bmN0aW9uIG9uRXhwb3J0QWxsKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzNC5zZXRTdGF0ZSh7CiAgICAgICAgICAgIGlzU2hvd2luZ0V4cG9ydEFsbE9wdGlvbnNNb2RhbDogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBvbkltcG9ydDogdGhpcy5zaG93SW1wb3J0Rmx5b3V0LAogICAgICAgIG9uUmVmcmVzaDogdGhpcy5yZWZyZXNoRGF0YSwKICAgICAgICBmaWx0ZXJlZENvdW50OiBmaWx0ZXJlZEl0ZW1Db3VudAogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJ4cyIKICAgICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3RhYmxlLlRhYmxlLCB7CiAgICAgICAgaXRlbUlkOiAnaWQnLAogICAgICAgIHNlbGVjdGlvbkNvbmZpZzogc2VsZWN0aW9uQ29uZmlnLAogICAgICAgIHNlbGVjdGVkU2F2ZWRPYmplY3RzOiBzZWxlY3RlZFNhdmVkT2JqZWN0cywKICAgICAgICBvblF1ZXJ5Q2hhbmdlOiB0aGlzLm9uUXVlcnlDaGFuZ2UsCiAgICAgICAgb25UYWJsZUNoYW5nZTogdGhpcy5vblRhYmxlQ2hhbmdlLAogICAgICAgIGZpbHRlck9wdGlvbnM6IGZpbHRlck9wdGlvbnMsCiAgICAgICAgb25FeHBvcnQ6IHRoaXMub25FeHBvcnQsCiAgICAgICAgY2FuRGVsZXRlOiB0aGlzLnByb3BzLnVpQ2FwYWJpbGl0aWVzLnNhdmVkT2JqZWN0c01hbmFnZW1lbnQuZGVsZXRlLAogICAgICAgIG9uRGVsZXRlOiB0aGlzLm9uRGVsZXRlLAogICAgICAgIGdvSW5zcGVjdE9iamVjdDogdGhpcy5wcm9wcy5nb0luc3BlY3RPYmplY3QsCiAgICAgICAgcGFnZUluZGV4OiBwYWdlLAogICAgICAgIHBhZ2VTaXplOiBwZXJQYWdlLAogICAgICAgIGl0ZW1zOiBzYXZlZE9iamVjdHMsCiAgICAgICAgdG90YWxJdGVtQ291bnQ6IGZpbHRlcmVkSXRlbUNvdW50LAogICAgICAgIGlzU2VhcmNoaW5nOiBpc1NlYXJjaGluZywKICAgICAgICBvblNob3dSZWxhdGlvbnNoaXBzOiB0aGlzLm9uU2hvd1JlbGF0aW9uc2hpcHMsCiAgICAgICAgY2FuR29JbkFwcDogdGhpcy5wcm9wcy5jYW5Hb0luQXBwCiAgICAgIH0pKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBPYmplY3RzVGFibGU7Cn0oX3JlYWN0LkNvbXBvbmVudCk7CgpleHBvcnRzLk9iamVjdHNUYWJsZSA9IE9iamVjdHNUYWJsZTsKCl9kZWZpbmVQcm9wZXJ0eShPYmplY3RzVGFibGUsICJwcm9wVHlwZXMiLCB7CiAgc2F2ZWRPYmplY3RzQ2xpZW50OiBfcHJvcFR5cGVzLmRlZmF1bHQub2JqZWN0LmlzUmVxdWlyZWQsCiAgaW5kZXhQYXR0ZXJuczogX3Byb3BUeXBlcy5kZWZhdWx0Lm9iamVjdC5pc1JlcXVpcmVkLAogICRodHRwOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkLAogIGJhc2VQYXRoOiBfcHJvcFR5cGVzLmRlZmF1bHQuc3RyaW5nLmlzUmVxdWlyZWQsCiAgcGVyUGFnZUNvbmZpZzogX3Byb3BUeXBlcy5kZWZhdWx0Lm51bWJlciwKICBuZXdJbmRleFBhdHRlcm5Vcmw6IF9wcm9wVHlwZXMuZGVmYXVsdC5zdHJpbmcuaXNSZXF1aXJlZCwKICBjb25maXJtTW9kYWxQcm9taXNlOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkLAogIHNlcnZpY2VzOiBfcHJvcFR5cGVzLmRlZmF1bHQuYXJyYXkuaXNSZXF1aXJlZCwKICB1aUNhcGFiaWxpdGllczogX3Byb3BUeXBlcy5kZWZhdWx0Lm9iamVjdC5pc1JlcXVpcmVkLAogIGdvSW5zcGVjdE9iamVjdDogX3Byb3BUeXBlcy5kZWZhdWx0LmZ1bmMuaXNSZXF1aXJlZCwKICBjYW5Hb0luQXBwOiBfcHJvcFR5cGVzLmRlZmF1bHQuZnVuYy5pc1JlcXVpcmVkCn0pOw=="},null]}