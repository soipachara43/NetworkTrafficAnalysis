{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/plugins/triggers_actions_ui/public/application/sections/alerts_list/components/alerts_list.js","dependencies":[{"path":"x-pack/plugins/triggers_actions_ui/public/application/sections/alerts_list/components/alerts_list.js","mtime":1589249555565},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFsZXJ0c0xpc3QgPSB2b2lkIDA7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfcmVhY3QgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9yZWFjdFJvdXRlckRvbSA9IHJlcXVpcmUoInJlYWN0LXJvdXRlci1kb20iKTsKCnZhciBfbG9kYXNoID0gcmVxdWlyZSgibG9kYXNoIik7Cgp2YXIgX2FsZXJ0c19jb250ZXh0ID0gcmVxdWlyZSgiLi4vLi4vLi4vY29udGV4dC9hbGVydHNfY29udGV4dCIpOwoKdmFyIF9hcHBfY29udGV4dCA9IHJlcXVpcmUoIi4uLy4uLy4uL2FwcF9jb250ZXh0Iik7Cgp2YXIgX2FsZXJ0X2Zvcm0gPSByZXF1aXJlKCIuLi8uLi9hbGVydF9mb3JtIik7Cgp2YXIgX2J1bGtfb3BlcmF0aW9uX3BvcG92ZXIgPSByZXF1aXJlKCIuLi8uLi9jb21tb24vY29tcG9uZW50cy9idWxrX29wZXJhdGlvbl9wb3BvdmVyIik7Cgp2YXIgX2FsZXJ0X3F1aWNrX2VkaXRfYnV0dG9ucyA9IHJlcXVpcmUoIi4uLy4uL2NvbW1vbi9jb21wb25lbnRzL2FsZXJ0X3F1aWNrX2VkaXRfYnV0dG9ucyIpOwoKdmFyIF9jb2xsYXBzZWRfaXRlbV9hY3Rpb25zID0gcmVxdWlyZSgiLi9jb2xsYXBzZWRfaXRlbV9hY3Rpb25zIik7Cgp2YXIgX3R5cGVfZmlsdGVyID0gcmVxdWlyZSgiLi90eXBlX2ZpbHRlciIpOwoKdmFyIF9hY3Rpb25fdHlwZV9maWx0ZXIgPSByZXF1aXJlKCIuL2FjdGlvbl90eXBlX2ZpbHRlciIpOwoKdmFyIF9hbGVydF9hcGkgPSByZXF1aXJlKCIuLi8uLi8uLi9saWIvYWxlcnRfYXBpIik7Cgp2YXIgX2FjdGlvbl9jb25uZWN0b3JfYXBpID0gcmVxdWlyZSgiLi4vLi4vLi4vbGliL2FjdGlvbl9jb25uZWN0b3JfYXBpIik7Cgp2YXIgX2NhcGFiaWxpdGllcyA9IHJlcXVpcmUoIi4uLy4uLy4uL2xpYi9jYXBhYmlsaXRpZXMiKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi4vLi4vLi4vY29uc3RhbnRzIik7Cgp2YXIgX2RlbGV0ZV9tb2RhbF9jb25maXJtYXRpb24gPSByZXF1aXJlKCIuLi8uLi8uLi9jb21wb25lbnRzL2RlbGV0ZV9tb2RhbF9jb25maXJtYXRpb24iKTsKCnZhciBfZW1wdHlfcHJvbXB0ID0gcmVxdWlyZSgiLi4vLi4vLi4vY29tcG9uZW50cy9wcm9tcHRzL2VtcHR5X3Byb21wdCIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgewogIHRyeSB7CiAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7CiAgICB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICByZWplY3QoZXJyb3IpOwogICAgcmV0dXJuOwogIH0KCiAgaWYgKGluZm8uZG9uZSkgewogICAgcmVzb2x2ZSh2YWx1ZSk7CiAgfSBlbHNlIHsKICAgIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsKICB9Cn0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICBhcmdzID0gYXJndW1lbnRzOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOwoKICAgICAgZnVuY3Rpb24gX25leHQodmFsdWUpIHsKICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOwogICAgICB9CgogICAgICBfbmV4dCh1bmRlZmluZWQpOwogICAgfSk7CiAgfTsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKdmFyIEVOVEVSX0tFWSA9IDEzOwoKdmFyIEFsZXJ0c0xpc3QgPSBmdW5jdGlvbiBBbGVydHNMaXN0KCkgewogIHZhciBoaXN0b3J5ID0gKDAsIF9yZWFjdFJvdXRlckRvbS51c2VIaXN0b3J5KSgpOwoKICB2YXIgX3VzZUFwcERlcGVuZGVuY2llcyA9ICgwLCBfYXBwX2NvbnRleHQudXNlQXBwRGVwZW5kZW5jaWVzKSgpLAogICAgICBodHRwID0gX3VzZUFwcERlcGVuZGVuY2llcy5odHRwLAogICAgICB0b2FzdE5vdGlmaWNhdGlvbnMgPSBfdXNlQXBwRGVwZW5kZW5jaWVzLnRvYXN0Tm90aWZpY2F0aW9ucywKICAgICAgY2FwYWJpbGl0aWVzID0gX3VzZUFwcERlcGVuZGVuY2llcy5jYXBhYmlsaXRpZXMsCiAgICAgIGFsZXJ0VHlwZVJlZ2lzdHJ5ID0gX3VzZUFwcERlcGVuZGVuY2llcy5hbGVydFR5cGVSZWdpc3RyeSwKICAgICAgYWN0aW9uVHlwZVJlZ2lzdHJ5ID0gX3VzZUFwcERlcGVuZGVuY2llcy5hY3Rpb25UeXBlUmVnaXN0cnksCiAgICAgIHVpU2V0dGluZ3MgPSBfdXNlQXBwRGVwZW5kZW5jaWVzLnVpU2V0dGluZ3MsCiAgICAgIGRvY0xpbmtzID0gX3VzZUFwcERlcGVuZGVuY2llcy5kb2NMaW5rcywKICAgICAgY2hhcnRzID0gX3VzZUFwcERlcGVuZGVuY2llcy5jaGFydHMsCiAgICAgIGRhdGFQbHVnaW4gPSBfdXNlQXBwRGVwZW5kZW5jaWVzLmRhdGFQbHVnaW47CgogIHZhciBjYW5EZWxldGUgPSAoMCwgX2NhcGFiaWxpdGllcy5oYXNEZWxldGVBbGVydHNDYXBhYmlsaXR5KShjYXBhYmlsaXRpZXMpOwogIHZhciBjYW5TYXZlID0gKDAsIF9jYXBhYmlsaXRpZXMuaGFzU2F2ZUFsZXJ0c0NhcGFiaWxpdHkpKGNhcGFiaWxpdGllcyk7CgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0Mi51c2VTdGF0ZSkoW10pLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgYWN0aW9uVHlwZXMgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRBY3Rpb25UeXBlcyA9IF91c2VTdGF0ZTJbMV07CgogIHZhciBfdXNlU3RhdGUzID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKFtdKSwKICAgICAgX3VzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTMsIDIpLAogICAgICBzZWxlY3RlZElkcyA9IF91c2VTdGF0ZTRbMF0sCiAgICAgIHNldFNlbGVjdGVkSWRzID0gX3VzZVN0YXRlNFsxXTsKCiAgdmFyIF91c2VTdGF0ZTUgPSAoMCwgX3JlYWN0Mi51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGU2ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNSwgMiksCiAgICAgIGlzUGVyZm9ybWluZ0FjdGlvbiA9IF91c2VTdGF0ZTZbMF0sCiAgICAgIHNldElzUGVyZm9ybWluZ0FjdGlvbiA9IF91c2VTdGF0ZTZbMV07CgogIHZhciBfdXNlU3RhdGU3ID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKHsKICAgIGluZGV4OiAwLAogICAgc2l6ZTogX2NvbnN0YW50cy5ERUZBVUxUX1NFQVJDSF9QQUdFX1NJWkUKICB9KSwKICAgICAgX3VzZVN0YXRlOCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTcsIDIpLAogICAgICBwYWdlID0gX3VzZVN0YXRlOFswXSwKICAgICAgc2V0UGFnZSA9IF91c2VTdGF0ZThbMV07CgogIHZhciBfdXNlU3RhdGU5ID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKCksCiAgICAgIF91c2VTdGF0ZTEwID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlOSwgMiksCiAgICAgIHNlYXJjaFRleHQgPSBfdXNlU3RhdGUxMFswXSwKICAgICAgc2V0U2VhcmNoVGV4dCA9IF91c2VTdGF0ZTEwWzFdOwoKICB2YXIgX3VzZVN0YXRlMTEgPSAoMCwgX3JlYWN0Mi51c2VTdGF0ZSkoKSwKICAgICAgX3VzZVN0YXRlMTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUxMSwgMiksCiAgICAgIGlucHV0VGV4dCA9IF91c2VTdGF0ZTEyWzBdLAogICAgICBzZXRJbnB1dFRleHQgPSBfdXNlU3RhdGUxMlsxXTsKCiAgdmFyIF91c2VTdGF0ZTEzID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKFtdKSwKICAgICAgX3VzZVN0YXRlMTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUxMywgMiksCiAgICAgIHR5cGVzRmlsdGVyID0gX3VzZVN0YXRlMTRbMF0sCiAgICAgIHNldFR5cGVzRmlsdGVyID0gX3VzZVN0YXRlMTRbMV07CgogIHZhciBfdXNlU3RhdGUxNSA9ICgwLCBfcmVhY3QyLnVzZVN0YXRlKShbXSksCiAgICAgIF91c2VTdGF0ZTE2ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMTUsIDIpLAogICAgICBhY3Rpb25UeXBlc0ZpbHRlciA9IF91c2VTdGF0ZTE2WzBdLAogICAgICBzZXRBY3Rpb25UeXBlc0ZpbHRlciA9IF91c2VTdGF0ZTE2WzFdOwoKICB2YXIgX3VzZVN0YXRlMTcgPSAoMCwgX3JlYWN0Mi51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGUxOCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTE3LCAyKSwKICAgICAgYWxlcnRGbHlvdXRWaXNpYmxlID0gX3VzZVN0YXRlMThbMF0sCiAgICAgIHNldEFsZXJ0Rmx5b3V0VmlzaWJpbGl0eSA9IF91c2VTdGF0ZTE4WzFdOwoKICB2YXIgX3VzZVN0YXRlMTkgPSAoMCwgX3JlYWN0Mi51c2VTdGF0ZSkoewogICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgIGlzSW5pdGlhbGl6ZWQ6IGZhbHNlLAogICAgZGF0YToge30KICB9KSwKICAgICAgX3VzZVN0YXRlMjAgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUxOSwgMiksCiAgICAgIGFsZXJ0VHlwZXNTdGF0ZSA9IF91c2VTdGF0ZTIwWzBdLAogICAgICBzZXRBbGVydFR5cGVzU3RhdGUgPSBfdXNlU3RhdGUyMFsxXTsKCiAgdmFyIF91c2VTdGF0ZTIxID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKHsKICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICBkYXRhOiBbXSwKICAgIHRvdGFsSXRlbUNvdW50OiAwCiAgfSksCiAgICAgIF91c2VTdGF0ZTIyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMjEsIDIpLAogICAgICBhbGVydHNTdGF0ZSA9IF91c2VTdGF0ZTIyWzBdLAogICAgICBzZXRBbGVydHNTdGF0ZSA9IF91c2VTdGF0ZTIyWzFdOwoKICB2YXIgX3VzZVN0YXRlMjMgPSAoMCwgX3JlYWN0Mi51c2VTdGF0ZSkodW5kZWZpbmVkKSwKICAgICAgX3VzZVN0YXRlMjQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUyMywgMiksCiAgICAgIGVkaXRlZEFsZXJ0SXRlbSA9IF91c2VTdGF0ZTI0WzBdLAogICAgICBzZXRFZGl0ZWRBbGVydEl0ZW0gPSBfdXNlU3RhdGUyNFsxXTsKCiAgdmFyIF91c2VTdGF0ZTI1ID0gKDAsIF9yZWFjdDIudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlMjYgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUyNSwgMiksCiAgICAgIGVkaXRGbHlvdXRWaXNpYmxlID0gX3VzZVN0YXRlMjZbMF0sCiAgICAgIHNldEVkaXRGbHlvdXRWaXNpYmlsaXR5ID0gX3VzZVN0YXRlMjZbMV07CgogIHZhciBfdXNlU3RhdGUyNyA9ICgwLCBfcmVhY3QyLnVzZVN0YXRlKShbXSksCiAgICAgIF91c2VTdGF0ZTI4ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMjcsIDIpLAogICAgICBhbGVydHNUb0RlbGV0ZSA9IF91c2VTdGF0ZTI4WzBdLAogICAgICBzZXRBbGVydHNUb0RlbGV0ZSA9IF91c2VTdGF0ZTI4WzFdOwoKICAoMCwgX3JlYWN0Mi51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIGxvYWRBbGVydHNEYXRhKCk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHMKICB9LCBbcGFnZSwgc2VhcmNoVGV4dCwgdHlwZXNGaWx0ZXIsIGFjdGlvblR5cGVzRmlsdGVyXSk7CiAgKDAsIF9yZWFjdDIudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICBfYXN5bmNUb0dlbmVyYXRvcigKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBhbGVydFR5cGVzLCBpbmRleCwgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiwgX2RpZEl0ZXJhdG9yRXJyb3IsIF9pdGVyYXRvckVycm9yLCBfaXRlcmF0b3IsIF9zdGVwLCBhbGVydFR5cGU7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDA7CiAgICAgICAgICAgICAgc2V0QWxlcnRUeXBlc1N0YXRlKF9vYmplY3RTcHJlYWQoe30sIGFsZXJ0VHlwZXNTdGF0ZSwgewogICAgICAgICAgICAgICAgaXNMb2FkaW5nOiB0cnVlCiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiAoMCwgX2FsZXJ0X2FwaS5sb2FkQWxlcnRUeXBlcykoewogICAgICAgICAgICAgICAgaHR0cDogaHR0cAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGFsZXJ0VHlwZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIGluZGV4ID0ge307CiAgICAgICAgICAgICAgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7CiAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTsKICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gOTsKCiAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IgPSBhbGVydFR5cGVzW1N5bWJvbC5pdGVyYXRvcl0oKTsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7CiAgICAgICAgICAgICAgICBhbGVydFR5cGUgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgICAgICAgIGluZGV4W2FsZXJ0VHlwZS5pZF0gPSBhbGVydFR5cGU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMzsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDkpOwogICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IF9jb250ZXh0LnQwOwoKICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTc7CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE4OwoKICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gJiYgX2l0ZXJhdG9yLnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMjA7CgogICAgICAgICAgICAgIGlmICghX2RpZEl0ZXJhdG9yRXJyb3IpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7CgogICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5maW5pc2goMjApOwoKICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuZmluaXNoKDE3KTsKCiAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgc2V0QWxlcnRUeXBlc1N0YXRlKHsKICAgICAgICAgICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgICAgICBkYXRhOiBpbmRleCwKICAgICAgICAgICAgICAgIGlzSW5pdGlhbGl6ZWQ6IHRydWUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDI4OgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyODsKICAgICAgICAgICAgICBfY29udGV4dC50MSA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgIHRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoewogICAgICAgICAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmlnZ2Vyc0FjdGlvbnNVSS5zZWN0aW9ucy5hbGVydHNMaXN0LnVuYWJsZVRvTG9hZEFsZXJ0VHlwZXNNZXNzYWdlJywgewogICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1VuYWJsZSB0byBsb2FkIGFsZXJ0IHR5cGVzJwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBzZXRBbGVydFR5cGVzU3RhdGUoX29iamVjdFNwcmVhZCh7fSwgYWxlcnRUeXBlc1N0YXRlLCB7CiAgICAgICAgICAgICAgICBpc0xvYWRpbmc6IGZhbHNlCiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgY2FzZSAzMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1swLCAyOF0sIFs5LCAxMywgMTcsIDI1XSwgWzE4LCwgMjAsIDI0XV0pOwogICAgfSkpKCk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHMKCiAgfSwgW10pOwogICgwLCBfcmVhY3QyLnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAvKiNfX1BVUkVfXyovCiAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgdmFyIHJlc3VsdDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDA7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiAoMCwgX2FjdGlvbl9jb25uZWN0b3JfYXBpLmxvYWRBY3Rpb25UeXBlcykoewogICAgICAgICAgICAgICAgaHR0cDogaHR0cAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgIHNldEFjdGlvblR5cGVzKHJlc3VsdC5maWx0ZXIoZnVuY3Rpb24gKGFjdGlvblR5cGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25UeXBlUmVnaXN0cnkuaGFzKGFjdGlvblR5cGUuaWQpOwogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEwOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gNzsKICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMCk7CiAgICAgICAgICAgICAgdG9hc3ROb3RpZmljYXRpb25zLmFkZERhbmdlcih7CiAgICAgICAgICAgICAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0c0xpc3QudW5hYmxlVG9Mb2FkQWN0aW9uVHlwZXNNZXNzYWdlJywgewogICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1VuYWJsZSB0byBsb2FkIGFjdGlvbiB0eXBlcycKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbMCwgN11dKTsKICAgIH0pKSgpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzCgogIH0sIFtdKTsKCiAgZnVuY3Rpb24gbG9hZEFsZXJ0c0RhdGEoKSB7CiAgICByZXR1cm4gX2xvYWRBbGVydHNEYXRhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICBmdW5jdGlvbiBfbG9hZEFsZXJ0c0RhdGEoKSB7CiAgICBfbG9hZEFsZXJ0c0RhdGEgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICB2YXIgYWxlcnRzUmVzcG9uc2U7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgc2V0QWxlcnRzU3RhdGUoX29iamVjdFNwcmVhZCh7fSwgYWxlcnRzU3RhdGUsIHsKICAgICAgICAgICAgICAgIGlzTG9hZGluZzogdHJ1ZQogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICBfY29udGV4dDUucHJldiA9IDE7CiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiAoMCwgX2FsZXJ0X2FwaS5sb2FkQWxlcnRzKSh7CiAgICAgICAgICAgICAgICBodHRwOiBodHRwLAogICAgICAgICAgICAgICAgcGFnZTogcGFnZSwKICAgICAgICAgICAgICAgIHNlYXJjaFRleHQ6IHNlYXJjaFRleHQsCiAgICAgICAgICAgICAgICB0eXBlc0ZpbHRlcjogdHlwZXNGaWx0ZXIsCiAgICAgICAgICAgICAgICBhY3Rpb25UeXBlc0ZpbHRlcjogYWN0aW9uVHlwZXNGaWx0ZXIKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBhbGVydHNSZXNwb25zZSA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgIHNldEFsZXJ0c1N0YXRlKHsKICAgICAgICAgICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgICAgICBkYXRhOiBhbGVydHNSZXNwb25zZS5kYXRhLAogICAgICAgICAgICAgICAgdG90YWxJdGVtQ291bnQ6IGFsZXJ0c1Jlc3BvbnNlLnRvdGFsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxMjsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBfY29udGV4dDUucHJldiA9IDg7CiAgICAgICAgICAgICAgX2NvbnRleHQ1LnQwID0gX2NvbnRleHQ1WyJjYXRjaCJdKDEpOwogICAgICAgICAgICAgIHRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoewogICAgICAgICAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmlnZ2Vyc0FjdGlvbnNVSS5zZWN0aW9ucy5hbGVydHNMaXN0LnVuYWJsZVRvTG9hZEFsZXJ0c01lc3NhZ2UnLCB7CiAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5hYmxlIHRvIGxvYWQgYWxlcnRzJwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBzZXRBbGVydHNTdGF0ZShfb2JqZWN0U3ByZWFkKHt9LCBhbGVydHNTdGF0ZSwgewogICAgICAgICAgICAgICAgaXNMb2FkaW5nOiBmYWxzZQogICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlNSwgbnVsbCwgW1sxLCA4XV0pOwogICAgfSkpOwogICAgcmV0dXJuIF9sb2FkQWxlcnRzRGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0KCiAgZnVuY3Rpb24gZWRpdEl0ZW0oX3gpIHsKICAgIHJldHVybiBfZWRpdEl0ZW0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIGZ1bmN0aW9uIF9lZGl0SXRlbSgpIHsKICAgIF9lZGl0SXRlbSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgLyojX19QVVJFX18qLwogICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoYWxlcnRUYWJsZUl0ZW0pIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzZXRFZGl0ZWRBbGVydEl0ZW0oYWxlcnRUYWJsZUl0ZW0pOwogICAgICAgICAgICAgIHNldEVkaXRGbHlvdXRWaXNpYmlsaXR5KHRydWUpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTYpOwogICAgfSkpOwogICAgcmV0dXJuIF9lZGl0SXRlbS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0KCiAgdmFyIGFsZXJ0c1RhYmxlQ29sdW1ucyA9IFt7CiAgICBmaWVsZDogJ25hbWUnLAogICAgbmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0c0xpc3QuYWxlcnRzTGlzdFRhYmxlLmNvbHVtbnMubmFtZVRpdGxlJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ05hbWUnCiAgICB9KSwKICAgIHNvcnRhYmxlOiBmYWxzZSwKICAgIHRydW5jYXRlVGV4dDogdHJ1ZSwKICAgICdkYXRhLXRlc3Qtc3Viaic6ICdhbGVydHNUYWJsZUNlbGwtbmFtZScsCiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihuYW1lLCBhbGVydCkgewogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgdGl0bGU6IG5hbWUsCiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgIGhpc3RvcnkucHVzaChfY29uc3RhbnRzLnJvdXRlVG9BbGVydERldGFpbHMucmVwbGFjZSgiOmFsZXJ0SWQiLCBhbGVydC5pZCkpOwogICAgICAgIH0KICAgICAgfSwgbmFtZSk7CiAgICB9CiAgfSwgewogICAgZmllbGQ6ICd0YWdzVGV4dCcsCiAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJpZ2dlcnNBY3Rpb25zVUkuc2VjdGlvbnMuYWxlcnRzTGlzdC5hbGVydHNMaXN0VGFibGUuY29sdW1ucy50YWdzVGV4dCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUYWdzJwogICAgfSksCiAgICBzb3J0YWJsZTogZmFsc2UsCiAgICAnZGF0YS10ZXN0LXN1YmonOiAnYWxlcnRzVGFibGVDZWxsLXRhZ3NUZXh0JwogIH0sIHsKICAgIGZpZWxkOiAnYWxlcnRUeXBlJywKICAgIG5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmlnZ2Vyc0FjdGlvbnNVSS5zZWN0aW9ucy5hbGVydHNMaXN0LmFsZXJ0c0xpc3RUYWJsZS5jb2x1bW5zLmFsZXJ0VHlwZVRpdGxlJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1R5cGUnCiAgICB9KSwKICAgIHNvcnRhYmxlOiBmYWxzZSwKICAgIHRydW5jYXRlVGV4dDogdHJ1ZSwKICAgICdkYXRhLXRlc3Qtc3Viaic6ICdhbGVydHNUYWJsZUNlbGwtYWxlcnRUeXBlJwogIH0sIHsKICAgIGZpZWxkOiAnc2NoZWR1bGUuaW50ZXJ2YWwnLAogICAgbmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0c0xpc3QuYWxlcnRzTGlzdFRhYmxlLmNvbHVtbnMuaW50ZXJ2YWxUaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdSdW5zIGV2ZXJ5JwogICAgfSksCiAgICBzb3J0YWJsZTogZmFsc2UsCiAgICB0cnVuY2F0ZVRleHQ6IGZhbHNlLAogICAgJ2RhdGEtdGVzdC1zdWJqJzogJ2FsZXJ0c1RhYmxlQ2VsbC1pbnRlcnZhbCcKICB9LCB7CiAgICBuYW1lOiAnJywKICAgIHdpZHRoOiAnNTBweCcsCiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihpdGVtKSB7CiAgICAgIGlmICghY2FuU2F2ZSB8fCAhYWxlcnRUeXBlUmVnaXN0cnkuaGFzKGl0ZW0uYWxlcnRUeXBlSWQpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogImFsZXJ0c1RhYmxlQ2VsbC1lZGl0TGluayIsCiAgICAgICAgY29sb3I6ICJwcmltYXJ5IiwKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIGVkaXRJdGVtKGl0ZW0pOwogICAgICAgIH0KICAgICAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkVkaXQiLAogICAgICAgIGlkOiAieHBhY2sudHJpZ2dlcnNBY3Rpb25zVUkuc2VjdGlvbnMuYWxlcnRzTGlzdC5hbGVydHNMaXN0VGFibGUuY29sdW1ucy5lZGl0TGlua1RpdGxlIgogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAgbmFtZTogJycsCiAgICB3aWR0aDogJzQwcHgnLAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoaXRlbSkgewogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbGxhcHNlZF9pdGVtX2FjdGlvbnMuQ29sbGFwc2VkSXRlbUFjdGlvbnNXaXRoQXBpLCB7CiAgICAgICAga2V5OiBpdGVtLmlkLAogICAgICAgIGl0ZW06IGl0ZW0sCiAgICAgICAgb25BbGVydENoYW5nZWQ6IGZ1bmN0aW9uIG9uQWxlcnRDaGFuZ2VkKCkgewogICAgICAgICAgcmV0dXJuIGxvYWRBbGVydHNEYXRhKCk7CiAgICAgICAgfSwKICAgICAgICBzZXRBbGVydHNUb0RlbGV0ZTogc2V0QWxlcnRzVG9EZWxldGUKICAgICAgfSk7CiAgICB9CiAgfV07CiAgdmFyIHRvb2xzUmlnaHQgPSBbX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3R5cGVfZmlsdGVyLlR5cGVGaWx0ZXIsIHsKICAgIGtleTogInR5cGUtZmlsdGVyIiwKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZSh0eXBlcykgewogICAgICByZXR1cm4gc2V0VHlwZXNGaWx0ZXIodHlwZXMpOwogICAgfSwKICAgIG9wdGlvbnM6IE9iamVjdC52YWx1ZXMoYWxlcnRUeXBlc1N0YXRlLmRhdGEpLm1hcChmdW5jdGlvbiAoYWxlcnRUeXBlKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdmFsdWU6IGFsZXJ0VHlwZS5pZCwKICAgICAgICBuYW1lOiBhbGVydFR5cGUubmFtZQogICAgICB9OwogICAgfSkuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICByZXR1cm4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKTsKICAgIH0pCiAgfSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9hY3Rpb25fdHlwZV9maWx0ZXIuQWN0aW9uVHlwZUZpbHRlciwgewogICAga2V5OiAiYWN0aW9uLXR5cGUtZmlsdGVyIiwKICAgIGFjdGlvblR5cGVzOiBhY3Rpb25UeXBlcywKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShpZHMpIHsKICAgICAgcmV0dXJuIHNldEFjdGlvblR5cGVzRmlsdGVyKGlkcyk7CiAgICB9CiAgfSldOwoKICBpZiAoY2FuU2F2ZSkgewogICAgdG9vbHNSaWdodC5wdXNoKF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgIGtleTogImNyZWF0ZS1hbGVydCIsCiAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJjcmVhdGVBbGVydEJ1dHRvbiIsCiAgICAgIGZpbGw6IHRydWUsCiAgICAgIGljb25UeXBlOiAicGx1c0luQ2lyY2xlIiwKICAgICAgaWNvblNpZGU6ICJsZWZ0IiwKICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICByZXR1cm4gc2V0QWxlcnRGbHlvdXRWaXNpYmlsaXR5KHRydWUpOwogICAgICB9CiAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICBpZDogInhwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0c0xpc3QuYWRkQWN0aW9uQnV0dG9uTGFiZWwiLAogICAgICBkZWZhdWx0TWVzc2FnZTogIkNyZWF0ZSBhbGVydCIKICAgIH0pKSk7CiAgfQoKICB2YXIgdGFibGUgPSBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZyYWdtZW50LCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgZ3V0dGVyU2l6ZTogInMiCiAgfSwgc2VsZWN0ZWRJZHMubGVuZ3RoID4gMCAmJiBjYW5EZWxldGUgJiYgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYnVsa19vcGVyYXRpb25fcG9wb3Zlci5CdWxrT3BlcmF0aW9uUG9wb3ZlciwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2FsZXJ0X3F1aWNrX2VkaXRfYnV0dG9ucy5BbGVydFF1aWNrRWRpdEJ1dHRvbnNXaXRoQXBpLCB7CiAgICBzZWxlY3RlZEl0ZW1zOiBjb252ZXJ0QWxlcnRzVG9UYWJsZUl0ZW1zKGZpbHRlckFsZXJ0c0J5SWQoYWxlcnRzU3RhdGUuZGF0YSwgc2VsZWN0ZWRJZHMpLCBhbGVydFR5cGVzU3RhdGUuZGF0YSksCiAgICBvblBlcmZvcm1pbmdBY3Rpb246IGZ1bmN0aW9uIG9uUGVyZm9ybWluZ0FjdGlvbigpIHsKICAgICAgcmV0dXJuIHNldElzUGVyZm9ybWluZ0FjdGlvbih0cnVlKTsKICAgIH0sCiAgICBvbkFjdGlvblBlcmZvcm1lZDogZnVuY3Rpb24gb25BY3Rpb25QZXJmb3JtZWQoKSB7CiAgICAgIGxvYWRBbGVydHNEYXRhKCk7CiAgICAgIHNldElzUGVyZm9ybWluZ0FjdGlvbihmYWxzZSk7CiAgICB9LAogICAgc2V0QWxlcnRzVG9EZWxldGU6IHNldEFsZXJ0c1RvRGVsZXRlCiAgfSkpKSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGaWVsZFRleHQsIHsKICAgIGZ1bGxXaWR0aDogdHJ1ZSwKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJhbGVydFNlYXJjaEZpZWxkIiwKICAgIHByZXBlbmQ6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICB0eXBlOiAic2VhcmNoIgogICAgfSksCiAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZSkgewogICAgICByZXR1cm4gc2V0SW5wdXRUZXh0KGUudGFyZ2V0LnZhbHVlKTsKICAgIH0sCiAgICBvbktleVVwOiBmdW5jdGlvbiBvbktleVVwKGUpIHsKICAgICAgaWYgKGUua2V5Q29kZSA9PT0gRU5URVJfS0VZKSB7CiAgICAgICAgc2V0U2VhcmNoVGV4dChpbnB1dFRleHQpOwogICAgICB9CiAgICB9LAogICAgcGxhY2Vob2xkZXI6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmlnZ2Vyc0FjdGlvbnNVSS5zZWN0aW9ucy5hbGVydHNMaXN0LnNlYXJjaFBsYWNlaG9sZGVyVGl0bGUnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnU2VhcmNoJwogICAgfSkKICB9KSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgIGdyb3c6IGZhbHNlCiAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgIGd1dHRlclNpemU6ICJzIgogIH0sIHRvb2xzUmlnaHQubWFwKGZ1bmN0aW9uICh0b29sLCBpbmRleCkgewogICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAga2V5OiBpbmRleCwKICAgICAgZ3JvdzogZmFsc2UKICAgIH0sIHRvb2wpOwogIH0pKSkpLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgc2l6ZTogImwiCiAgfSksIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQmFzaWNUYWJsZSwgewogICAgbG9hZGluZzogYWxlcnRzU3RhdGUuaXNMb2FkaW5nIHx8IGFsZXJ0VHlwZXNTdGF0ZS5pc0xvYWRpbmcgfHwgaXNQZXJmb3JtaW5nQWN0aW9uCiAgICAvKiBEb24ndCBkaXNwbGF5IGFsZXJ0cyB1bnRpbCB3ZSBoYXZlIHRoZSBhbGVydCB0eXBlcyBpbml0aWFsaXplZCAqLwogICAgLAogICAgaXRlbXM6IGFsZXJ0VHlwZXNTdGF0ZS5pc0luaXRpYWxpemVkID09PSBmYWxzZSA/IFtdIDogY29udmVydEFsZXJ0c1RvVGFibGVJdGVtcyhhbGVydHNTdGF0ZS5kYXRhLCBhbGVydFR5cGVzU3RhdGUuZGF0YSksCiAgICBpdGVtSWQ6ICJpZCIsCiAgICBjb2x1bW5zOiBhbGVydHNUYWJsZUNvbHVtbnMsCiAgICByb3dQcm9wczogZnVuY3Rpb24gcm93UHJvcHMoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgJ2RhdGEtdGVzdC1zdWJqJzogJ2FsZXJ0LXJvdycKICAgICAgfTsKICAgIH0sCiAgICBjZWxsUHJvcHM6IGZ1bmN0aW9uIGNlbGxQcm9wcygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICAnZGF0YS10ZXN0LXN1YmonOiAnY2VsbCcKICAgICAgfTsKICAgIH0sCiAgICAiZGF0YS10ZXN0LXN1YmoiOiAiYWxlcnRzTGlzdCIsCiAgICBwYWdpbmF0aW9uOiB7CiAgICAgIHBhZ2VJbmRleDogcGFnZS5pbmRleCwKICAgICAgcGFnZVNpemU6IHBhZ2Uuc2l6ZSwKCiAgICAgIC8qIERvbid0IGRpc3BsYXkgYWxlcnQgY291bnQgdW50aWwgd2UgaGF2ZSB0aGUgYWxlcnQgdHlwZXMgaW5pdGlhbGl6ZWQgKi8KICAgICAgdG90YWxJdGVtQ291bnQ6IGFsZXJ0VHlwZXNTdGF0ZS5pc0luaXRpYWxpemVkID09PSBmYWxzZSA/IDAgOiBhbGVydHNTdGF0ZS50b3RhbEl0ZW1Db3VudAogICAgfSwKICAgIHNlbGVjdGlvbjogY2FuRGVsZXRlID8gewogICAgICBvblNlbGVjdGlvbkNoYW5nZTogZnVuY3Rpb24gb25TZWxlY3Rpb25DaGFuZ2UodXBkYXRlZFNlbGVjdGVkSXRlbXNMaXN0KSB7CiAgICAgICAgc2V0U2VsZWN0ZWRJZHModXBkYXRlZFNlbGVjdGVkSXRlbXNMaXN0Lm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIGl0ZW0uaWQ7CiAgICAgICAgfSkpOwogICAgICB9CiAgICB9IDogdW5kZWZpbmVkLAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKF9yZWYzKSB7CiAgICAgIHZhciBjaGFuZ2VkUGFnZSA9IF9yZWYzLnBhZ2U7CiAgICAgIHNldFBhZ2UoY2hhbmdlZFBhZ2UpOwogICAgfQogIH0pKTsKCiAgdmFyIGxvYWRlZEl0ZW1zID0gY29udmVydEFsZXJ0c1RvVGFibGVJdGVtcyhhbGVydHNTdGF0ZS5kYXRhLCBhbGVydFR5cGVzU3RhdGUuZGF0YSk7CiAgdmFyIGlzRmlsdGVyQXBwbGllZCA9ICEoKDAsIF9sb2Rhc2guaXNFbXB0eSkoc2VhcmNoVGV4dCkgJiYgKDAsIF9sb2Rhc2guaXNFbXB0eSkodHlwZXNGaWx0ZXIpICYmICgwLCBfbG9kYXNoLmlzRW1wdHkpKGFjdGlvblR5cGVzRmlsdGVyKSk7CiAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJzZWN0aW9uIiwgewogICAgImRhdGEtdGVzdC1zdWJqIjogImFsZXJ0c0xpc3QiCiAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2RlbGV0ZV9tb2RhbF9jb25maXJtYXRpb24uRGVsZXRlTW9kYWxDb25maXJtYXRpb24sIHsKICAgIG9uRGVsZXRlZDogZnVuY3Rpb24gb25EZWxldGVkKGRlbGV0ZWQpIHsKICAgICAgaWYgKHNlbGVjdGVkSWRzLmxlbmd0aCA9PT0gMCB8fCBzZWxlY3RlZElkcy5sZW5ndGggPT09IGRlbGV0ZWQubGVuZ3RoKSB7CiAgICAgICAgdmFyIHVwZGF0ZWRBbGVydHMgPSBhbGVydHNTdGF0ZS5kYXRhLmZpbHRlcihmdW5jdGlvbiAoYWxlcnQpIHsKICAgICAgICAgIHJldHVybiBhbGVydC5pZCAmJiAhYWxlcnRzVG9EZWxldGUuaW5jbHVkZXMoYWxlcnQuaWQpOwogICAgICAgIH0pOwogICAgICAgIHNldEFsZXJ0c1N0YXRlKHsKICAgICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgICBkYXRhOiB1cGRhdGVkQWxlcnRzLAogICAgICAgICAgdG90YWxJdGVtQ291bnQ6IGFsZXJ0c1N0YXRlLnRvdGFsSXRlbUNvdW50IC0gZGVsZXRlZC5sZW5ndGgKICAgICAgICB9KTsKICAgICAgICBzZXRTZWxlY3RlZElkcyhbXSk7CiAgICAgIH0KCiAgICAgIHNldEFsZXJ0c1RvRGVsZXRlKFtdKTsKICAgIH0sCiAgICBvbkVycm9yczoKICAgIC8qI19fUFVSRV9fKi8KICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgLyojX19QVVJFX18qLwogICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiBsb2FkQWxlcnRzRGF0YSgpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHNldEFsZXJ0c1RvRGVsZXRlKFtdKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUzKTsKICAgIH0pKSwKICAgIG9uQ2FuY2VsOgogICAgLyojX19QVVJFX18qLwogICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAvKiNfX1BVUkVfXyovCiAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzZXRBbGVydHNUb0RlbGV0ZShbXSk7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlNCk7CiAgICB9KSksCiAgICBhcGlEZWxldGVDYWxsOiBfYWxlcnRfYXBpLmRlbGV0ZUFsZXJ0cywKICAgIGlkc1RvRGVsZXRlOiBhbGVydHNUb0RlbGV0ZSwKICAgIHNpbmdsZVRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJpZ2dlcnNBY3Rpb25zVUkuc2VjdGlvbnMuYWxlcnRzTGlzdC5zaW5nbGVUaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdhbGVydCcKICAgIH0pLAogICAgbXVsdGlwbGVUaXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0c0xpc3QubXVsdGlwbGVUaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdhbGVydHMnCiAgICB9KQogIH0pLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgc2l6ZTogIm0iCiAgfSksIGxvYWRlZEl0ZW1zLmxlbmd0aCB8fCBpc0ZpbHRlckFwcGxpZWQgPyB0YWJsZSA6IGFsZXJ0VHlwZXNTdGF0ZS5pc0xvYWRpbmcgfHwgYWxlcnRzU3RhdGUuaXNMb2FkaW5nID8gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgIGp1c3RpZnlDb250ZW50OiAiY2VudGVyIiwKICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiCiAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxvYWRpbmdTcGlubmVyLCB7CiAgICBzaXplOiAieGwiCiAgfSkpKSA6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9lbXB0eV9wcm9tcHQuRW1wdHlQcm9tcHQsIHsKICAgIG9uQ1RBQ2xpY2tlZDogZnVuY3Rpb24gb25DVEFDbGlja2VkKCkgewogICAgICByZXR1cm4gc2V0QWxlcnRGbHlvdXRWaXNpYmlsaXR5KHRydWUpOwogICAgfQogIH0pLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWxlcnRzX2NvbnRleHQuQWxlcnRzQ29udGV4dFByb3ZpZGVyLCB7CiAgICB2YWx1ZTogewogICAgICByZWxvYWRBbGVydHM6IGxvYWRBbGVydHNEYXRhLAogICAgICBodHRwOiBodHRwLAogICAgICBhY3Rpb25UeXBlUmVnaXN0cnk6IGFjdGlvblR5cGVSZWdpc3RyeSwKICAgICAgYWxlcnRUeXBlUmVnaXN0cnk6IGFsZXJ0VHlwZVJlZ2lzdHJ5LAogICAgICB0b2FzdE5vdGlmaWNhdGlvbnM6IHRvYXN0Tm90aWZpY2F0aW9ucywKICAgICAgdWlTZXR0aW5nczogdWlTZXR0aW5ncywKICAgICAgZG9jTGlua3M6IGRvY0xpbmtzLAogICAgICBjaGFydHM6IGNoYXJ0cywKICAgICAgZGF0YUZpZWxkc0Zvcm1hdHM6IGRhdGFQbHVnaW4uZmllbGRGb3JtYXRzCiAgICB9CiAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2FsZXJ0X2Zvcm0uQWxlcnRBZGQsIHsKICAgIGNvbnN1bWVyOiAnYWxlcnRpbmcnLAogICAgYWRkRmx5b3V0VmlzaWJsZTogYWxlcnRGbHlvdXRWaXNpYmxlLAogICAgc2V0QWRkRmx5b3V0VmlzaWJpbGl0eTogc2V0QWxlcnRGbHlvdXRWaXNpYmlsaXR5CiAgfSksIGVkaXRGbHlvdXRWaXNpYmxlICYmIGVkaXRlZEFsZXJ0SXRlbSA/IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9hbGVydF9mb3JtLkFsZXJ0RWRpdCwgewogICAga2V5OiBlZGl0ZWRBbGVydEl0ZW0uaWQsCiAgICBpbml0aWFsQWxlcnQ6IGVkaXRlZEFsZXJ0SXRlbSwKICAgIGVkaXRGbHlvdXRWaXNpYmxlOiBlZGl0Rmx5b3V0VmlzaWJsZSwKICAgIHNldEVkaXRGbHlvdXRWaXNpYmlsaXR5OiBzZXRFZGl0Rmx5b3V0VmlzaWJpbGl0eQogIH0pIDogbnVsbCkpOwp9OwoKZXhwb3J0cy5BbGVydHNMaXN0ID0gQWxlcnRzTGlzdDsKCmZ1bmN0aW9uIGZpbHRlckFsZXJ0c0J5SWQoYWxlcnRzLCBpZHMpIHsKICByZXR1cm4gYWxlcnRzLmZpbHRlcihmdW5jdGlvbiAoYWxlcnQpIHsKICAgIHJldHVybiBpZHMuaW5jbHVkZXMoYWxlcnQuaWQpOwogIH0pOwp9CgpmdW5jdGlvbiBjb252ZXJ0QWxlcnRzVG9UYWJsZUl0ZW1zKGFsZXJ0cywgYWxlcnRUeXBlc0luZGV4KSB7CiAgcmV0dXJuIGFsZXJ0cy5tYXAoZnVuY3Rpb24gKGFsZXJ0KSB7CiAgICB2YXIgX3JlZjYsIF9hbGVydFR5cGVzSW5kZXgkYWxlcjsKCiAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgYWxlcnQsIHsKICAgICAgdGFnc1RleHQ6IGFsZXJ0LnRhZ3Muam9pbignLCAnKSwKICAgICAgYWxlcnRUeXBlOiAoX3JlZjYgPSAoX2FsZXJ0VHlwZXNJbmRleCRhbGVyID0gYWxlcnRUeXBlc0luZGV4W2FsZXJ0LmFsZXJ0VHlwZUlkXSkgPT09IG51bGwgfHwgX2FsZXJ0VHlwZXNJbmRleCRhbGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYWxlcnRUeXBlc0luZGV4JGFsZXIubmFtZSkgIT09IG51bGwgJiYgX3JlZjYgIT09IHZvaWQgMCA/IF9yZWY2IDogYWxlcnQuYWxlcnRUeXBlSWQKICAgIH0pOwogIH0pOwp9"},null]}