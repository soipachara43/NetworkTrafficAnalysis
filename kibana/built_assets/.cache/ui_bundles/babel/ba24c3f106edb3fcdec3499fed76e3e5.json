{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/beats_management/public/lib/adapters/framework/kibana_framework_adapter.js","dependencies":[{"path":"x-pack/legacy/plugins/beats_management/public/lib/adapters/framework/kibana_framework_adapter.js","mtime":1589249551715},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLktpYmFuYUZyYW1ld29ya0FkYXB0ZXIgPSB2b2lkIDA7Cgp2YXIgX1BhdGhSZXBvcnRlciA9IHJlcXVpcmUoImlvLXRzL2xpYi9QYXRoUmVwb3J0ZXIiKTsKCnZhciBSZWFjdERPTSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0LWRvbSIpKTsKCnZhciBfRWl0aGVyID0gcmVxdWlyZSgiZnAtdHMvbGliL0VpdGhlciIpOwoKdmFyIF9uZXdfcGxhdGZvcm0gPSByZXF1aXJlKCJ1aS9uZXdfcGxhdGZvcm0iKTsKCnZhciBfYWRhcHRlcl90eXBlcyA9IHJlcXVpcmUoIi4vYWRhcHRlcl90eXBlcyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsKICB0cnkgewogICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOwogICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVqZWN0KGVycm9yKTsKICAgIHJldHVybjsKICB9CgogIGlmIChpbmZvLmRvbmUpIHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0gZWxzZSB7CiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7CiAgfQp9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgYXJncyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsKCiAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsKICAgICAgfQoKICAgICAgX25leHQodW5kZWZpbmVkKTsKICAgIH0pOwogIH07Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgS2liYW5hRnJhbWV3b3JrQWRhcHRlciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIF9jcmVhdGVDbGFzcyhLaWJhbmFGcmFtZXdvcmtBZGFwdGVyLCBbewogICAga2V5OiAiaW5mbyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgaWYgKHRoaXMueHBhY2tJbmZvKSB7CiAgICAgICAgcmV0dXJuIHRoaXMueHBhY2tJbmZvOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBFcnJvcignZnJhbWV3b3JrIGFkYXB0ZXIgbXVzdCBoYXZlIGluaXQgY2FsbGVkIGJlZm9yZSBhbnl0aGluZyBlbHNlJyk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjdXJyZW50VXNlciIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuc2hpZWxkVXNlcjsKICAgIH0KICB9XSk7CgogIGZ1bmN0aW9uIEtpYmFuYUZyYW1ld29ya0FkYXB0ZXIoUExVR0lOX0lELCBtYW5hZ2VtZW50LCByb3V0ZXMsIGdldEJhc2VQYXRoLCBvbktpYmFuYVJlYWR5LCB4cGFja0luZm9TZXJ2aWNlLCB2ZXJzaW9uKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBLaWJhbmFGcmFtZXdvcmtBZGFwdGVyKTsKCiAgICB0aGlzLlBMVUdJTl9JRCA9IFBMVUdJTl9JRDsKICAgIHRoaXMubWFuYWdlbWVudCA9IG1hbmFnZW1lbnQ7CiAgICB0aGlzLnJvdXRlcyA9IHJvdXRlczsKICAgIHRoaXMuZ2V0QmFzZVBhdGggPSBnZXRCYXNlUGF0aDsKICAgIHRoaXMub25LaWJhbmFSZWFkeSA9IG9uS2liYW5hUmVhZHk7CiAgICB0aGlzLnhwYWNrSW5mb1NlcnZpY2UgPSB4cGFja0luZm9TZXJ2aWNlOwogICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgInhwYWNrSW5mbyIsIG51bGwpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYWRhcHRlclNlcnZpY2UiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAic2hpZWxkVXNlciIsIG51bGwpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAic2V0VUlTZXR0aW5ncyIsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgIF90aGlzLmFkYXB0ZXJTZXJ2aWNlLmNhbGxPckJ1ZmZlcihmdW5jdGlvbiAoX3JlZikgewogICAgICAgIHZhciBjb25maWcgPSBfcmVmLmNvbmZpZzsKICAgICAgICBjb25maWcuc2V0KGtleSwgdmFsdWUpOwogICAgICB9KTsKICAgIH0pOwoKICAgIHRoaXMuYWRhcHRlclNlcnZpY2UgPSBuZXcgS2liYW5hQWRhcHRlclNlcnZpY2VQcm92aWRlcigpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEtpYmFuYUZyYW1ld29ya0FkYXB0ZXIsIFt7CiAgICBrZXk6ICJ3YWl0VW50aWxGcmFtZXdvcmtSZWFkeSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3dhaXRVbnRpbEZyYW1ld29ya1JlYWR5ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgeHBhY2tJbmZvLCB4cGFja0luZm9VbnBhY2tlZCwgYXNzZXJ0RGF0YSwgc2VjdXJpdHlTZXR1cCwgYXNzZXJ0VXNlcjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9uS2liYW5hUmVhZHkoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgeHBhY2tJbmZvID0gdGhpcy54cGFja0luZm9TZXJ2aWNlOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDM7CiAgICAgICAgICAgICAgICB4cGFja0luZm9VbnBhY2tlZCA9IHsKICAgICAgICAgICAgICAgICAgYmFzZVBhdGg6IHRoaXMuZ2V0QmFzZVBhdGgoKSwKICAgICAgICAgICAgICAgICAgbGljZW5zZTogewogICAgICAgICAgICAgICAgICAgIHR5cGU6IHhwYWNrSW5mbyA/IHhwYWNrSW5mby5nZXRMaWNlbnNlKCkudHlwZSA6ICdvc3MnLAogICAgICAgICAgICAgICAgICAgIGV4cGlyZWQ6IHhwYWNrSW5mbyA/ICF4cGFja0luZm8uZ2V0TGljZW5zZSgpLmlzQWN0aXZlIDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgZXhwaXJ5X2RhdGVfaW5fbWlsbGlzOiB4cGFja0luZm8uZ2V0TGljZW5zZSgpLmV4cGlyeURhdGVJbk1pbGxpcyAhPT0gdW5kZWZpbmVkID8geHBhY2tJbmZvLmdldExpY2Vuc2UoKS5leHBpcnlEYXRlSW5NaWxsaXMgOiAtMQogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBzZWN1cml0eTogewogICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHhwYWNrSW5mbyA/IHhwYWNrSW5mby5nZXQoImZlYXR1cmVzLiIuY29uY2F0KHRoaXMuUExVR0lOX0lELCAiLnNlY3VyaXR5LmVuYWJsZWQiKSwgZmFsc2UpIDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgYXZhaWxhYmxlOiB4cGFja0luZm8gPyB4cGFja0luZm8uZ2V0KCJmZWF0dXJlcy4iLmNvbmNhdCh0aGlzLlBMVUdJTl9JRCwgIi5zZWN1cml0eS5hdmFpbGFibGUiKSwgZmFsc2UpIDogZmFsc2UKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgc2V0dGluZ3M6IHhwYWNrSW5mbyA/IHhwYWNrSW5mby5nZXQoImZlYXR1cmVzLiIuY29uY2F0KHRoaXMuUExVR0lOX0lELCAiLnNldHRpbmdzIikpIDoge30KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDc7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDMpOwogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIGRhdGEgc3RydWN0dXJlIGZyb20geHBhY2tJbmZvU2VydmljZSwgIi5jb25jYXQoSlNPTi5zdHJpbmdpZnkoX2NvbnRleHQudDApKSk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBhc3NlcnREYXRhID0gX2FkYXB0ZXJfdHlwZXMuUnVudGltZUZyYW1ld29ya0luZm8uZGVjb2RlKHhwYWNrSW5mb1VucGFja2VkKTsKCiAgICAgICAgICAgICAgICBpZiAoISgwLCBfRWl0aGVyLmlzTGVmdCkoYXNzZXJ0RGF0YSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkVycm9yIHBhcnNpbmcgeHBhY2sgaW5mbyBpbiAiLmNvbmNhdCh0aGlzLlBMVUdJTl9JRCwgIiwgICAiKS5jb25jYXQoX1BhdGhSZXBvcnRlci5QYXRoUmVwb3J0ZXIucmVwb3J0KGFzc2VydERhdGEpWzBdKSk7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICB0aGlzLnhwYWNrSW5mbyA9IHhwYWNrSW5mb1VucGFja2VkOwogICAgICAgICAgICAgICAgc2VjdXJpdHlTZXR1cCA9IF9uZXdfcGxhdGZvcm0ubnBTZXR1cC5wbHVnaW5zLnNlY3VyaXR5OwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE1OwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgcmV0dXJuIHNlY3VyaXR5U2V0dXAgPT09IG51bGwgfHwgc2VjdXJpdHlTZXR1cCA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2VjdXJpdHlTZXR1cC5hdXRoYy5nZXRDdXJyZW50VXNlcigpOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgX2NvbnRleHQudDEgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChfY29udGV4dC50MSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQxID0gbnVsbDsKCiAgICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICAgIHRoaXMuc2hpZWxkVXNlciA9IF9jb250ZXh0LnQxOwogICAgICAgICAgICAgICAgYXNzZXJ0VXNlciA9IF9hZGFwdGVyX3R5cGVzLlJ1bnRpbWVGcmFtZXdvcmtVc2VyLmRlY29kZSh0aGlzLnNoaWVsZFVzZXIpOwoKICAgICAgICAgICAgICAgIGlmICghKDAsIF9FaXRoZXIuaXNMZWZ0KShhc3NlcnRVc2VyKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRXJyb3IgcGFyc2luZyB1c2VyIGluZm8gaW4gIi5jb25jYXQodGhpcy5QTFVHSU5fSUQsICIsICAgIikuY29uY2F0KF9QYXRoUmVwb3J0ZXIuUGF0aFJlcG9ydGVyLnJlcG9ydChhc3NlcnRVc2VyKVswXSkpOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMwOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMjc7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MiA9IF9jb250ZXh0WyJjYXRjaCJdKDE1KTsKICAgICAgICAgICAgICAgIHRoaXMuc2hpZWxkVXNlciA9IG51bGw7CgogICAgICAgICAgICAgIGNhc2UgMzA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzLCBbWzMsIDddLCBbMTUsIDI3XV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiB3YWl0VW50aWxGcmFtZXdvcmtSZWFkeSgpIHsKICAgICAgICByZXR1cm4gX3dhaXRVbnRpbEZyYW1ld29ya1JlYWR5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB3YWl0VW50aWxGcmFtZXdvcmtSZWFkeTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogInJlbmRlclVJQXRQYXRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJVSUF0UGF0aChwYXRoLCBjb21wb25lbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgdG9Db250cm9sbGVyID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAnc2VsZic7CiAgICAgIHZhciBhZGFwdGVyID0gdGhpczsKICAgICAgdGhpcy5yb3V0ZXMud2hlbigiIi5jb25jYXQocGF0aCkuY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShBcnJheSg2KSkubWFwKGZ1bmN0aW9uIChlLCBuKSB7CiAgICAgICAgcmV0dXJuICIvOmFyZyIuY29uY2F0KG4sICI/Iik7CiAgICAgIH0pLmpvaW4oJycpKSwgLy8gSGFjayBiZWNhdXNlIGFuZ3VsYXIgMSBkb2VzIG5vdCBzdXBwb3J0IHdpbGRjYXJkcwogICAgICB7CiAgICAgICAgdGVtcGxhdGU6IHRvQ29udHJvbGxlciA9PT0gJ3NlbGYnID8gIjwiLmNvbmNhdCh0aGlzLlBMVUdJTl9JRCwgIj48ZGl2IGlkPVwiIikuY29uY2F0KHRoaXMuUExVR0lOX0lELCAiUmVhY3RSb290XCI+PC9kaXY+PC8iKS5jb25jYXQodGhpcy5QTFVHSU5fSUQsICI+IikgOiAiPGtibi1tYW5hZ2VtZW50LWFwcCBzZWN0aW9uPVwiIi5jb25jYXQodGhpcy5QTFVHSU5fSUQucmVwbGFjZSgnXycsICctJyksICJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVwibWFuYWdlbWVudC1zaWRlbmF2XCIgY2xhc3M9XCJldWlQYWdlU2lkZUJhclwiIHN0eWxlPVwicG9zaXRpb246IHN0YXRpYztcIj48L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVwiIikuY29uY2F0KHRoaXMuUExVR0lOX0lELCAiUmVhY3RSb290XCIgLz5cbiAgICAgICAgICAgICAgIDwva2JuLW1hbmFnZW1lbnQtYXBwPiIpLAogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZQogICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uIGNvbnRyb2xsZXIoJHNjb3BlLCAkcm91dGUpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICRzY29wZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHZhciBlbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIiIuY29uY2F0KF90aGlzMi5QTFVHSU5fSUQsICJSZWFjdFJvb3QiKSk7CiAgICAgICAgICAgICAgUmVhY3RET00ucmVuZGVyKGNvbXBvbmVudCwgZWxlbSk7CiAgICAgICAgICAgICAgYWRhcHRlci5tYW5hZ2VBbmd1bGFyTGlmZWN5Y2xlKCRzY29wZSwgJHJvdXRlLCBlbGVtKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAkc2NvcGUuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAkc2NvcGUudG9wTmF2TWVudSA9IFtdOwogICAgICAgICAgICB9OwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkVycm9yIHJlbmRlcmluZyBCZWF0cyBDTSB0byB0aGUgZG9tLCAiLmNvbmNhdChlLm1lc3NhZ2UpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlZ2lzdGVyTWFuYWdlbWVudFNlY3Rpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyTWFuYWdlbWVudFNlY3Rpb24oc2V0dGluZ3MpIHsKICAgICAgdmFyIHNlY3Rpb25JZCA9IHNldHRpbmdzLmlkIHx8IHRoaXMuUExVR0lOX0lEOwoKICAgICAgaWYgKCF0aGlzLm1hbmFnZW1lbnQuaGFzSXRlbShzZWN0aW9uSWQpKSB7CiAgICAgICAgdGhpcy5tYW5hZ2VtZW50LnJlZ2lzdGVyKHNlY3Rpb25JZCwgewogICAgICAgICAgZGlzcGxheTogc2V0dGluZ3MubmFtZSwKICAgICAgICAgIGljb246IHNldHRpbmdzLmljb25OYW1lLAogICAgICAgICAgb3JkZXI6IHNldHRpbmdzLm9yZGVyIHx8IDMwCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWdpc3Rlck1hbmFnZW1lbnRVSSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJNYW5hZ2VtZW50VUkoc2V0dGluZ3MpIHsKICAgICAgdmFyIHNlY3Rpb25JZCA9IHNldHRpbmdzLnNlY3Rpb25JZCB8fCB0aGlzLlBMVUdJTl9JRDsKCiAgICAgIGlmICghdGhpcy5tYW5hZ2VtZW50Lmhhc0l0ZW0oc2VjdGlvbklkKSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigicmVnaXN0ZXJNYW5hZ2VtZW50VUkgd2FzIGNhbGxlZCB3aXRoIGEgc2VjdGlvbklkIG9mICIuY29uY2F0KHNlY3Rpb25JZCwgIiwgYW5kIHRoYXQgaXMgaXMgbm90IHlldCByZWdlc3RlcmVkIGFzIGEgc2VjdGlvbiIpKTsKICAgICAgfQoKICAgICAgdmFyIHNlY3Rpb24gPSB0aGlzLm1hbmFnZW1lbnQuZ2V0U2VjdGlvbihzZWN0aW9uSWQpOwogICAgICBzZWN0aW9uLnJlZ2lzdGVyKHNlY3Rpb25JZCwgewogICAgICAgIHZpc2libGU6IHNldHRpbmdzLnZpc2FibGUgfHwgdHJ1ZSwKICAgICAgICBkaXNwbGF5OiBzZXR0aW5ncy5uYW1lLAogICAgICAgIG9yZGVyOiBzZXR0aW5ncy5vcmRlciB8fCAzMCwKICAgICAgICB1cmw6ICIjIi5jb25jYXQoc2V0dGluZ3MuYmFzZVBhdGgpCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogIm1hbmFnZUFuZ3VsYXJMaWZlY3ljbGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1hbmFnZUFuZ3VsYXJMaWZlY3ljbGUoJHNjb3BlLCAkcm91dGUsIGVsZW0pIHsKICAgICAgdmFyIGxhc3RSb3V0ZSA9ICRyb3V0ZS5jdXJyZW50OwogICAgICB2YXIgZGVyZWdpc3RlciA9ICRzY29wZS4kb24oJyRsb2NhdGlvbkNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGN1cnJlbnRSb3V0ZSA9ICRyb3V0ZS5jdXJyZW50OyAvLyBpZiB0ZW1wbGF0ZXMgYXJlIHRoZSBzYW1lIHdlIGFyZSBvbiB0aGUgc2FtZSByb3V0ZQoKICAgICAgICBpZiAobGFzdFJvdXRlLiQkcm91dGUudGVtcGxhdGUgPT09IGN1cnJlbnRSb3V0ZS4kJHJvdXRlLnRlbXBsYXRlKSB7CiAgICAgICAgICAvLyB0aGlzIHByZXZlbnRzIGFuZ3VsYXIgZnJvbSBkZXN0cm95aW5nIHNjb3BlCiAgICAgICAgICAkcm91dGUuY3VycmVudCA9IGxhc3RSb3V0ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGVsZW0pIHsKICAgICAgICAgICAgUmVhY3RET00udW5tb3VudENvbXBvbmVudEF0Tm9kZShlbGVtKTsKICAgICAgICAgICAgZWxlbS5yZW1vdmUoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoZGVyZWdpc3RlcikgewogICAgICAgICAgZGVyZWdpc3RlcigpOwogICAgICAgIH0gLy8gbWFudWFsbHkgdW5tb3VudCBjb21wb25lbnQgd2hlbiBzY29wZSBpcyBkZXN0cm95ZWQKCgogICAgICAgIGlmIChlbGVtKSB7CiAgICAgICAgICBSZWFjdERPTS51bm1vdW50Q29tcG9uZW50QXROb2RlKGVsZW0pOwogICAgICAgICAgZWxlbS5yZW1vdmUoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEtpYmFuYUZyYW1ld29ya0FkYXB0ZXI7Cn0oKTsKCmV4cG9ydHMuS2liYW5hRnJhbWV3b3JrQWRhcHRlciA9IEtpYmFuYUZyYW1ld29ya0FkYXB0ZXI7Cgp2YXIgS2liYW5hQWRhcHRlclNlcnZpY2VQcm92aWRlciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEtpYmFuYUFkYXB0ZXJTZXJ2aWNlUHJvdmlkZXIoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgS2liYW5hQWRhcHRlclNlcnZpY2VQcm92aWRlcik7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJzZXJ2aWNlUmVmcyIsIG51bGwpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYnVmZmVyZWRDYWxscyIsIFtdKTsKICB9CgogIF9jcmVhdGVDbGFzcyhLaWJhbmFBZGFwdGVyU2VydmljZVByb3ZpZGVyLCBbewogICAga2V5OiAiJGdldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gJGdldCgkcm9vdFNjb3BlLCBjb25maWcpIHsKICAgICAgdGhpcy5zZXJ2aWNlUmVmcyA9IHsKICAgICAgICBjb25maWc6IGNvbmZpZywKICAgICAgICByb290U2NvcGU6ICRyb290U2NvcGUKICAgICAgfTsKICAgICAgdGhpcy5hcHBseUJ1ZmZlcmVkQ2FsbHModGhpcy5idWZmZXJlZENhbGxzKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2FsbE9yQnVmZmVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYWxsT3JCdWZmZXIoc2VydmljZUNhbGwpIHsKICAgICAgaWYgKHRoaXMuc2VydmljZVJlZnMgIT09IG51bGwpIHsKICAgICAgICB0aGlzLmFwcGx5QnVmZmVyZWRDYWxscyhbc2VydmljZUNhbGxdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmJ1ZmZlcmVkQ2FsbHMucHVzaChzZXJ2aWNlQ2FsbCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJhcHBseUJ1ZmZlcmVkQ2FsbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5QnVmZmVyZWRDYWxscyhidWZmZXJlZENhbGxzKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLnNlcnZpY2VSZWZzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLnNlcnZpY2VSZWZzLnJvb3RTY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkgewogICAgICAgIGJ1ZmZlcmVkQ2FsbHMuZm9yRWFjaChmdW5jdGlvbiAoc2VydmljZUNhbGwpIHsKICAgICAgICAgIGlmICghX3RoaXMzLnNlcnZpY2VSZWZzKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gc2VydmljZUNhbGwoX3RoaXMzLnNlcnZpY2VSZWZzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gS2liYW5hQWRhcHRlclNlcnZpY2VQcm92aWRlcjsKfSgpOw=="},null]}