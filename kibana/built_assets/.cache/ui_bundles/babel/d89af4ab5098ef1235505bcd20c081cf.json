{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/plugins/data/public/search/aggs/agg_config.js","dependencies":[{"path":"src/plugins/data/public/search/aggs/agg_config.js","mtime":1589249550635},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFnZ0NvbmZpZyA9IHZvaWQgMDsKCnZhciBfbG9kYXNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2giKSk7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfYWdnX3BhcmFtcyA9IHJlcXVpcmUoIi4vYWdnX3BhcmFtcyIpOwoKdmFyIF9jb21tb24gPSByZXF1aXJlKCIuLi8uLi8uLi9jb21tb24iKTsKCnZhciBfc2VydmljZXMgPSByZXF1aXJlKCIuLi8uLi8uLi9wdWJsaWMvc2VydmljZXMiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgfQp9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogIHJldHVybiBDb25zdHJ1Y3RvcjsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCnZhciBBZ2dDb25maWcgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICBfY3JlYXRlQ2xhc3MoQWdnQ29uZmlnLCBudWxsLCBbewogICAga2V5OiAiZW5zdXJlSWRzIiwKCiAgICAvKioKICAgICAqIEVuc3VyZSB0aGF0IGFsbCBvZiB0aGUgb2JqZWN0cyBpbiB0aGUgbGlzdCBoYXZlIGlkcywgdGhlIG9iamVjdHMKICAgICAqIGFuZCBsaXN0IGFyZSBtb2RpZmllZCBieSByZWZlcmVuY2UuCiAgICAgKgogICAgICogQHBhcmFtICB7YXJyYXlbb2JqZWN0XX0gbGlzdCAtIGEgbGlzdCBvZiBvYmplY3RzLCBvYmplY3RzIGNhbiBiZSBhbnl0aGluZyByZWFsbHkKICAgICAqIEByZXR1cm4ge2FycmF5fSAtIHRoZSBsaXN0IHRoYXQgd2FzIHBhc3NlZCBpbgogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gZW5zdXJlSWRzKGxpc3QpIHsKICAgICAgdmFyIGhhdmUgPSBbXTsKICAgICAgdmFyIGhhdmVOb3QgPSBbXTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAob2JqLmlkID8gaGF2ZSA6IGhhdmVOb3QpLnB1c2gob2JqKTsKICAgICAgfSk7CiAgICAgIHZhciBuZXh0SWQgPSBBZ2dDb25maWcubmV4dElkKGhhdmUpOwogICAgICBoYXZlTm90LmZvckVhY2goZnVuY3Rpb24gKG9iaikgewogICAgICAgIG9iai5pZCA9IFN0cmluZyhuZXh0SWQrKyk7CiAgICAgIH0pOwogICAgICByZXR1cm4gbGlzdDsKICAgIH0KICAgIC8qKgogICAgICogQ2FsY3VsYXRlIHRoZSBuZXh0IGlkIGJhc2VkIG9uIHRoZSBpZHMgaW4gdGhpcyBsaXN0CiAgICAgKgogICAgICogQHJldHVybiB7YXJyYXl9IGxpc3QgLSBhIGxpc3Qgb2Ygb2JqZWN0cyB3aXRoIGlkIHByb3BlcnRpZXMKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJuZXh0SWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5leHRJZChsaXN0KSB7CiAgICAgIHJldHVybiAxICsgbGlzdC5yZWR1Y2UoZnVuY3Rpb24gKG1heCwgb2JqKSB7CiAgICAgICAgcmV0dXJuIE1hdGgubWF4KG1heCwgK29iai5pZCB8fCAwKTsKICAgICAgfSwgMCk7CiAgICB9CiAgfV0pOwoKICBmdW5jdGlvbiBBZ2dDb25maWcoYWdnQ29uZmlncywgb3B0cykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFnZ0NvbmZpZyk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJhZ2dDb25maWdzIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImlkIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImVuYWJsZWQiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAicGFyYW1zIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgInBhcmVudCIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJicmFuZE5ldyIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJzY2hlbWEiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiX190eXBlIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIl9fdHlwZURlY29yYXRpb25zIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgInN1YkFnZ3MiLCBbXSk7CgogICAgdGhpcy5hZ2dDb25maWdzID0gYWdnQ29uZmlnczsKICAgIHRoaXMuaWQgPSBTdHJpbmcob3B0cy5pZCB8fCBBZ2dDb25maWcubmV4dElkKGFnZ0NvbmZpZ3MuYWdncykpOwogICAgdGhpcy5lbmFibGVkID0gdHlwZW9mIG9wdHMuZW5hYmxlZCA9PT0gJ2Jvb2xlYW4nID8gb3B0cy5lbmFibGVkIDogdHJ1ZTsgLy8gc3RhcnQgd2l0aCBlbXB0eSBwYXJhbXMgc28gdGhhdCBjaGVja3MgaW4gdHlwZS9zY2hlbWEgc2V0dGVycyBkb24ndCBmcmVhawogICAgLy8gYmVjYXVzZSB0aGlzLnBhcmFtcyBpcyB1bmRlZmluZWQKCiAgICB0aGlzLnBhcmFtcyA9IHt9OyAvLyBzZXR0ZXJzCgogICAgdGhpcy5zZXRUeXBlKG9wdHMudHlwZSk7CgogICAgaWYgKG9wdHMuc2NoZW1hKSB7CiAgICAgIHRoaXMuc2NoZW1hID0gb3B0cy5zY2hlbWE7CiAgICB9IC8vIHNldCB0aGUgcGFyYW1zIHRvIHRoZSB2YWx1ZXMgZnJvbSBvcHRzLCBvciBqdXN0IHRvIHRoZSBkZWZhdWx0cwoKCiAgICB0aGlzLnNldFBhcmFtcyhvcHRzLnBhcmFtcyB8fCB7fSk7IC8vIEB0cy1pZ25vcmUKCiAgICB0aGlzLl9fdHlwZSA9IHRoaXMuX190eXBlOwogIH0KICAvKioKICAgKiBXcml0ZSB0aGUgY3VycmVudCB2YWx1ZXMgdG8gdGhpcy5wYXJhbXMsIGZpbGxpbmcgaW4gdGhlIGRlZmF1bHRzIGFzIHdlIGdvCiAgICoKICAgKiBAcGFyYW0gIHtvYmplY3R9IFtmcm9tXSAtIG9wdGlvbmFsIG9iamVjdCB0byByZWFkIHZhbHVlcyBmcm9tLAogICAqICAgICAgICAgICAgICAgICAgICAgICAgIHVzZWQgd2hlbiBpbml0aWFsaXppbmcKICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9CiAgICovCgoKICBfY3JlYXRlQ2xhc3MoQWdnQ29uZmlnLCBbewogICAga2V5OiAic2V0UGFyYW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRQYXJhbXMoZnJvbSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgZnJvbSA9IGZyb20gfHwgdGhpcy5wYXJhbXMgfHwge307CiAgICAgIHZhciB0byA9IHRoaXMucGFyYW1zID0ge307CiAgICAgIHRoaXMuZ2V0QWdnUGFyYW1zKCkuZm9yRWFjaChmdW5jdGlvbiAoYWdnUGFyYW0pIHsKICAgICAgICB2YXIgdmFsID0gZnJvbVthZ2dQYXJhbS5uYW1lXTsKCiAgICAgICAgaWYgKHZhbCA9PSBudWxsKSB7CiAgICAgICAgICBpZiAoYWdnUGFyYW0uZGVmYXVsdCA9PSBudWxsKSByZXR1cm47CgogICAgICAgICAgaWYgKCFfbG9kYXNoLmRlZmF1bHQuaXNGdW5jdGlvbihhZ2dQYXJhbS5kZWZhdWx0KSkgewogICAgICAgICAgICB2YWwgPSBhZ2dQYXJhbS5kZWZhdWx0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFsID0gYWdnUGFyYW0uZGVmYXVsdChfdGhpcyk7CiAgICAgICAgICAgIGlmICh2YWwgPT0gbnVsbCkgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGFnZ1BhcmFtLmRlc2VyaWFsaXplKSB7CiAgICAgICAgICB2YXIgaXNUeXBlZCA9IF9sb2Rhc2guZGVmYXVsdC5pc0Z1bmN0aW9uKGFnZ1BhcmFtLnZhbHVlVHlwZSk7CgogICAgICAgICAgdmFyIGlzVHlwZSA9IGlzVHlwZWQgJiYgdmFsIGluc3RhbmNlb2YgYWdnUGFyYW0udmFsdWVUeXBlOwoKICAgICAgICAgIHZhciBpc09iamVjdCA9ICFpc1R5cGVkICYmIF9sb2Rhc2guZGVmYXVsdC5pc09iamVjdCh2YWwpOwoKICAgICAgICAgIHZhciBpc0Rlc2VyaWFsaXplZCA9IGlzVHlwZSB8fCBpc09iamVjdDsKCiAgICAgICAgICBpZiAoIWlzRGVzZXJpYWxpemVkKSB7CiAgICAgICAgICAgIHZhbCA9IGFnZ1BhcmFtLmRlc2VyaWFsaXplKHZhbCwgX3RoaXMpOwogICAgICAgICAgfQoKICAgICAgICAgIHRvW2FnZ1BhcmFtLm5hbWVdID0gdmFsOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdG9bYWdnUGFyYW0ubmFtZV0gPSBfbG9kYXNoLmRlZmF1bHQuY2xvbmVEZWVwKHZhbCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFBhcmFtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQYXJhbShrZXkpIHsKICAgICAgcmV0dXJuIF9sb2Rhc2guZGVmYXVsdC5nZXQodGhpcy5wYXJhbXMsIGtleSk7CiAgICB9CiAgfSwgewogICAga2V5OiAid3JpdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHdyaXRlKGFnZ3MpIHsKICAgICAgcmV0dXJuICgwLCBfYWdnX3BhcmFtcy53cml0ZVBhcmFtcykodGhpcy50eXBlLnBhcmFtcywgdGhpcywgYWdncyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNGaWx0ZXJhYmxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0ZpbHRlcmFibGUoKSB7CiAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuaXNGdW5jdGlvbih0aGlzLnR5cGUuY3JlYXRlRmlsdGVyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGVGaWx0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZUZpbHRlcihrZXkpIHsKICAgICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHZhciBjcmVhdGVGaWx0ZXIgPSB0aGlzLnR5cGUuY3JlYXRlRmlsdGVyOwoKICAgICAgaWYgKCFjcmVhdGVGaWx0ZXIpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGUgXCIiLmNvbmNhdCh0aGlzLnR5cGUudGl0bGUsICJcIiBhZ2dyZWdhdGlvbiBkb2VzIG5vdCBzdXBwb3J0IGZpbHRlcmluZy4iKSk7CiAgICAgIH0KCiAgICAgIHZhciBmaWVsZCA9IHRoaXMuZ2V0RmllbGQoKTsKICAgICAgdmFyIGxhYmVsID0gdGhpcy5nZXRGaWVsZERpc3BsYXlOYW1lKCk7CgogICAgICBpZiAoZmllbGQgJiYgIWZpZWxkLmZpbHRlcmFibGUpIHsKICAgICAgICB2YXIgbWVzc2FnZSA9ICJUaGUgXCIiLmNvbmNhdChsYWJlbCwgIlwiIGZpZWxkIGNhbiBub3QgYmUgdXNlZCBmb3IgZmlsdGVyaW5nLiIpOwoKICAgICAgICBpZiAoZmllbGQuc2NyaXB0ZWQpIHsKICAgICAgICAgIG1lc3NhZ2UgPSAiVGhlIFwiIi5jb25jYXQobGFiZWwsICJcIiBmaWVsZCBpcyBzY3JpcHRlZCBhbmQgY2FuIG5vdCBiZSB1c2VkIGZvciBmaWx0ZXJpbmcuIik7CiAgICAgICAgfQoKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKG1lc3NhZ2UpOwogICAgICB9CgogICAgICByZXR1cm4gY3JlYXRlRmlsdGVyKHRoaXMsIGtleSwgcGFyYW1zKTsKICAgIH0KICAgIC8qKgogICAgICogIEhvb2sgZm9yIHByZS1mbGlnaHQgbG9naWMsIHNlZSBBZ2dUeXBlI29uU2VhcmNoUmVxdWVzdFN0YXJ0CiAgICAgKiAgQHBhcmFtIHtDb3VyaWVyLlNlYXJjaFNvdXJjZX0gc2VhcmNoU291cmNlCiAgICAgKiAgQHBhcmFtIHtDb3VyaWVyLkZldGNoT3B0aW9uc30gb3B0aW9ucwogICAgICogIEByZXR1cm4ge1Byb21pc2U8dW5kZWZpbmVkPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvblNlYXJjaFJlcXVlc3RTdGFydCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TZWFyY2hSZXF1ZXN0U3RhcnQoc2VhcmNoU291cmNlLCBvcHRpb25zKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLnR5cGUpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBQcm9taXNlLmFsbCh0aGlzLnR5cGUucGFyYW1zLm1hcChmdW5jdGlvbiAocGFyYW0pIHsKICAgICAgICByZXR1cm4gcGFyYW0ubW9kaWZ5QWdnQ29uZmlnT25TZWFyY2hSZXF1ZXN0U3RhcnQoX3RoaXMyLCBzZWFyY2hTb3VyY2UsIG9wdGlvbnMpOwogICAgICB9KSk7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdGhpcyBhZ2dDb25maWcgdG8gaXRzIGRzbCBzeW50YXguCiAgICAgKgogICAgICogQWRkcyBwYXJhbXMgYW5kIGFkaG9jIHN1YmFnZ3MgdG8gYSBwb2pvLCB0aGVuIHJldHVybnMgaXQKICAgICAqCiAgICAgKiBAcGFyYW0gIHtBZ2dDb25maWdzfSBhZ2dDb25maWdzIC0gdGhlIGNvbmZpZyBvYmplY3QgdG8gY29udmVydAogICAgICogQHJldHVybiB7dm9pZHxPYmplY3R9IC0gaWYgdGhlIGNvbmZpZyBoYXMgYSBkc2wgcmVwcmVzZW50YXRpb24sIGl0IGlzCiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5lZCwgZWxzZSB1bmRlZmluZWQgaXMgcmV0dXJuZWQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJ0b0RzbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9Ec2woYWdnQ29uZmlncykgewogICAgICBpZiAodGhpcy50eXBlLmhhc05vRHNsKSByZXR1cm47CiAgICAgIHZhciBvdXRwdXQgPSB0aGlzLndyaXRlKGFnZ0NvbmZpZ3MpOwogICAgICB2YXIgY29uZmlnRHNsID0ge307CiAgICAgIGNvbmZpZ0RzbFt0aGlzLnR5cGUuZHNsTmFtZSB8fCB0aGlzLnR5cGUubmFtZV0gPSBvdXRwdXQucGFyYW1zOyAvLyBpZiB0aGUgY29uZmlnIHJlcXVpcmVzIHN1YkFnZ3MsIHdyaXRlIHRoZW0gdG8gdGhlIGRzbCBhcyB3ZWxsCgogICAgICBpZiAodGhpcy5zdWJBZ2dzLmxlbmd0aCAmJiAhb3V0cHV0LnN1YkFnZ3MpIG91dHB1dC5zdWJBZ2dzID0gdGhpcy5zdWJBZ2dzOwoKICAgICAgaWYgKG91dHB1dC5zdWJBZ2dzKSB7CiAgICAgICAgdmFyIHN1YkRzbEx2bCA9IGNvbmZpZ0RzbC5hZ2dzIHx8IChjb25maWdEc2wuYWdncyA9IHt9KTsKICAgICAgICBvdXRwdXQuc3ViQWdncy5mb3JFYWNoKGZ1bmN0aW9uIG5lc3RBZGhvY1N1YkFnZ3Moc3ViQWdnQ29uZmlnKSB7CiAgICAgICAgICBzdWJEc2xMdmxbc3ViQWdnQ29uZmlnLmlkXSA9IHN1YkFnZ0NvbmZpZy50b0RzbChhZ2dDb25maWdzKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKG91dHB1dC5wYXJlbnRBZ2dzKSB7CiAgICAgICAgdmFyIF9zdWJEc2xMdmwgPSBjb25maWdEc2wucGFyZW50QWdncyB8fCAoY29uZmlnRHNsLnBhcmVudEFnZ3MgPSB7fSk7CgogICAgICAgIG91dHB1dC5wYXJlbnRBZ2dzLmZvckVhY2goZnVuY3Rpb24gbmVzdEFkaG9jU3ViQWdncyhzdWJBZ2dDb25maWcpIHsKICAgICAgICAgIF9zdWJEc2xMdmxbc3ViQWdnQ29uZmlnLmlkXSA9IHN1YkFnZ0NvbmZpZy50b0RzbChhZ2dDb25maWdzKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGNvbmZpZ0RzbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0b0pTT04iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvSlNPTigpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgcGFyYW1zID0gdGhpcy5wYXJhbXM7CgogICAgICB2YXIgb3V0UGFyYW1zID0gX2xvZGFzaC5kZWZhdWx0LnRyYW5zZm9ybSh0aGlzLmdldEFnZ1BhcmFtcygpLCBmdW5jdGlvbiAob3V0LCBhZ2dQYXJhbSkgewogICAgICAgIHZhciB2YWwgPSBwYXJhbXNbYWdnUGFyYW0ubmFtZV07IC8vIGRvbid0IHNlcmlhbGl6ZSB1bmRlZmluZWQvbnVsbCB2YWx1ZXMKCiAgICAgICAgaWYgKHZhbCA9PSBudWxsKSByZXR1cm47CiAgICAgICAgaWYgKGFnZ1BhcmFtLnNlcmlhbGl6ZSkgdmFsID0gYWdnUGFyYW0uc2VyaWFsaXplKHZhbCwgX3RoaXMzKTsKICAgICAgICBpZiAodmFsID09IG51bGwpIHJldHVybjsgLy8gdG8gcHJldmVudCBhY2NpZGVudGFsIGxlYWtpbmcsIHdlIHdpbGwgY2xvbmUgYWxsIGNvbXBsZXggdmFsdWVzCgogICAgICAgIG91dFthZ2dQYXJhbS5uYW1lXSA9IF9sb2Rhc2guZGVmYXVsdC5jbG9uZURlZXAodmFsKTsKICAgICAgfSwge30pOwoKICAgICAgcmV0dXJuIHsKICAgICAgICBpZDogdGhpcy5pZCwKICAgICAgICBlbmFibGVkOiB0aGlzLmVuYWJsZWQsCiAgICAgICAgdHlwZTogdGhpcy50eXBlICYmIHRoaXMudHlwZS5uYW1lLAogICAgICAgIHNjaGVtYTogdGhpcy5zY2hlbWEsCiAgICAgICAgcGFyYW1zOiBvdXRQYXJhbXMKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRBZ2dQYXJhbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFnZ1BhcmFtcygpIHsKICAgICAgcmV0dXJuIF90b0NvbnN1bWFibGVBcnJheShfbG9kYXNoLmRlZmF1bHQuaGFzKHRoaXMsICd0eXBlLnBhcmFtcycpID8gdGhpcy50eXBlLnBhcmFtcyA6IFtdKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRSZXF1ZXN0QWdncyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVxdWVzdEFnZ3MoKSB7CiAgICAgIHJldHVybiB0aGlzLnR5cGUgJiYgdGhpcy50eXBlLmdldFJlcXVlc3RBZ2dzKHRoaXMpIHx8IFt0aGlzXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRSZXNwb25zZUFnZ3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJlc3BvbnNlQWdncygpIHsKICAgICAgcmV0dXJuIHRoaXMudHlwZSAmJiB0aGlzLnR5cGUuZ2V0UmVzcG9uc2VBZ2dzKHRoaXMpIHx8IFt0aGlzXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRWYWx1ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VmFsdWUoYnVja2V0KSB7CiAgICAgIHJldHVybiB0aGlzLnR5cGUuZ2V0VmFsdWUodGhpcywgYnVja2V0KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRLZXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEtleShidWNrZXQsIGtleSkgewogICAgICBpZiAodGhpcy50eXBlLmdldEtleSkgewogICAgICAgIHJldHVybiB0aGlzLnR5cGUuZ2V0S2V5KGJ1Y2tldCwga2V5LCB0aGlzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRGaWVsZERpc3BsYXlOYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGaWVsZERpc3BsYXlOYW1lKCkgewogICAgICB2YXIgZmllbGQgPSB0aGlzLmdldEZpZWxkKCk7CiAgICAgIHJldHVybiBmaWVsZCA/IGZpZWxkLmRpc3BsYXlOYW1lIHx8IHRoaXMuZmllbGROYW1lKCkgOiAnJzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRGaWVsZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RmllbGQoKSB7CiAgICAgIHJldHVybiB0aGlzLnBhcmFtcy5maWVsZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYWtlTGFiZWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1ha2VMYWJlbCgpIHsKICAgICAgdmFyIHBlcmNlbnRhZ2VNb2RlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKCiAgICAgIGlmICh0aGlzLnBhcmFtcy5jdXN0b21MYWJlbCkgewogICAgICAgIHJldHVybiB0aGlzLnBhcmFtcy5jdXN0b21MYWJlbDsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLnR5cGUpIHJldHVybiAnJzsKICAgICAgcmV0dXJuIHBlcmNlbnRhZ2VNb2RlID8gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ2RhdGEuc2VhcmNoLmFnZ3MucGVyY2VudGFnZU9mTGFiZWwnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdQZXJjZW50YWdlIG9mIHtsYWJlbH0nLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgbGFiZWw6IHRoaXMudHlwZS5tYWtlTGFiZWwodGhpcykKICAgICAgICB9CiAgICAgIH0pIDogIiIuY29uY2F0KHRoaXMudHlwZS5tYWtlTGFiZWwodGhpcykpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEluZGV4UGF0dGVybiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SW5kZXhQYXR0ZXJuKCkgewogICAgICByZXR1cm4gdGhpcy5hZ2dDb25maWdzLmluZGV4UGF0dGVybjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRUaW1lUmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFRpbWVSYW5nZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYWdnQ29uZmlncy50aW1lUmFuZ2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmllbGRGb3JtYXR0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpZWxkRm9ybWF0dGVyKGNvbnRlbnRUeXBlLCBkZWZhdWx0Rm9ybWF0KSB7CiAgICAgIHZhciBmb3JtYXQgPSB0aGlzLnR5cGUgJiYgdGhpcy50eXBlLmdldEZvcm1hdCh0aGlzKTsKCiAgICAgIGlmIChmb3JtYXQpIHsKICAgICAgICByZXR1cm4gZm9ybWF0LmdldENvbnZlcnRlckZvcihjb250ZW50VHlwZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmZpZWxkT3duRm9ybWF0dGVyKGNvbnRlbnRUeXBlLCBkZWZhdWx0Rm9ybWF0KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmaWVsZE93bkZvcm1hdHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmllbGRPd25Gb3JtYXR0ZXIoY29udGVudFR5cGUsIGRlZmF1bHRGb3JtYXQpIHsKICAgICAgdmFyIGZpZWxkRm9ybWF0c1NlcnZpY2UgPSAoMCwgX3NlcnZpY2VzLmdldEZpZWxkRm9ybWF0cykoKTsKICAgICAgdmFyIGZpZWxkID0gdGhpcy5nZXRGaWVsZCgpOwogICAgICB2YXIgZm9ybWF0ID0gZmllbGQgJiYgZmllbGQuZm9ybWF0OwogICAgICBpZiAoIWZvcm1hdCkgZm9ybWF0ID0gZGVmYXVsdEZvcm1hdDsKICAgICAgaWYgKCFmb3JtYXQpIGZvcm1hdCA9IGZpZWxkRm9ybWF0c1NlcnZpY2UuZ2V0RGVmYXVsdEluc3RhbmNlKF9jb21tb24uS0JOX0ZJRUxEX1RZUEVTLlNUUklORyk7CiAgICAgIHJldHVybiBmb3JtYXQuZ2V0Q29udmVydGVyRm9yKGNvbnRlbnRUeXBlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmaWVsZE5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpZWxkTmFtZSgpIHsKICAgICAgdmFyIGZpZWxkID0gdGhpcy5nZXRGaWVsZCgpOwogICAgICByZXR1cm4gZmllbGQgPyBmaWVsZC5uYW1lIDogJyc7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmllbGRJc1RpbWVGaWVsZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmllbGRJc1RpbWVGaWVsZCgpIHsKICAgICAgdmFyIGluZGV4UGF0dGVybiA9IHRoaXMuZ2V0SW5kZXhQYXR0ZXJuKCk7CiAgICAgIGlmICghaW5kZXhQYXR0ZXJuKSByZXR1cm4gZmFsc2U7CiAgICAgIHZhciB0aW1lRmllbGROYW1lID0gaW5kZXhQYXR0ZXJuLnRpbWVGaWVsZE5hbWU7CiAgICAgIHJldHVybiB0aW1lRmllbGROYW1lICYmIHRoaXMuZmllbGROYW1lKCkgPT09IHRpbWVGaWVsZE5hbWU7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0VHlwZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0VHlwZSh0eXBlKSB7CiAgICAgIHRoaXMudHlwZSA9IHR5cGU7CiAgICB9CiAgfSwgewogICAga2V5OiAidHlwZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX190eXBlOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KHR5cGUpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICBpZiAodGhpcy5fX3R5cGVEZWNvcmF0aW9ucykgewogICAgICAgIF9sb2Rhc2guZGVmYXVsdC5mb3JPd24odGhpcy5fX3R5cGVEZWNvcmF0aW9ucywgZnVuY3Rpb24gKHByb3AsIG5hbWUpIHsKICAgICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAgIGRlbGV0ZSB0aGlzW25hbWVdOwogICAgICAgIH0sIHRoaXMpOwogICAgICB9CgogICAgICBpZiAodHlwZSAmJiBfbG9kYXNoLmRlZmF1bHQuaXNGdW5jdGlvbih0eXBlLmRlY29yYXRlQWdnQ29uZmlnKSkgewogICAgICAgIHRoaXMuX190eXBlRGVjb3JhdGlvbnMgPSB0eXBlLmRlY29yYXRlQWdnQ29uZmlnKCk7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywgdGhpcy5fX3R5cGVEZWNvcmF0aW9ucyk7CiAgICAgIH0KCiAgICAgIHRoaXMuX190eXBlID0gdHlwZTsKICAgICAgdmFyIGF2YWlsYWJsZUZpZWxkcyA9IFtdOwogICAgICB2YXIgZmllbGRQYXJhbSA9IHRoaXMudHlwZSAmJiB0aGlzLnR5cGUucGFyYW1zLmZpbmQoZnVuY3Rpb24gKHApIHsKICAgICAgICByZXR1cm4gcC50eXBlID09PSAnZmllbGQnOwogICAgICB9KTsKCiAgICAgIGlmIChmaWVsZFBhcmFtKSB7CiAgICAgICAgLy8gQHRzLWlnbm9yZQogICAgICAgIGF2YWlsYWJsZUZpZWxkcyA9IGZpZWxkUGFyYW0uZ2V0QXZhaWxhYmxlRmllbGRzKHRoaXMpOwogICAgICB9IC8vIGNsZWFyIG91dCB0aGUgcHJldmlvdXMgcGFyYW1zIGV4Y2VwdCBmb3IgYSBmZXcgc3BlY2lhbCBvbmVzCgoKICAgICAgdGhpcy5zZXRQYXJhbXMoewogICAgICAgIC8vIGFsbW9zdCBldmVyeSBhZ2cgaGFzIGZpZWxkcywgc28gd2UgdHJ5IHRvIHBlcnNpc3QgdGhhdCB3aGVuIHR5cGUgY2hhbmdlcwogICAgICAgIGZpZWxkOiBhdmFpbGFibGVGaWVsZHMuZmluZChmdW5jdGlvbiAoZmllbGQpIHsKICAgICAgICAgIHJldHVybiBmaWVsZC5uYW1lID09PSBfdGhpczQuZ2V0RmllbGQoKTsKICAgICAgICB9KQogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBBZ2dDb25maWc7Cn0oKTsKCmV4cG9ydHMuQWdnQ29uZmlnID0gQWdnQ29uZmlnOw=="},null]}