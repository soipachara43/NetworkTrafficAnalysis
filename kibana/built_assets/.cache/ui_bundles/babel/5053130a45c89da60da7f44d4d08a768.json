{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/maps/public/layers/styles/vector/properties/dynamic_style_property.js","dependencies":[{"path":"x-pack/legacy/plugins/maps/public/layers/styles/vector/properties/dynamic_style_property.js","mtime":1589249552484},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkR5bmFtaWNTdHlsZVByb3BlcnR5ID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfc3R5bGVfcHJvcGVydHkgPSByZXF1aXJlKCIuL3N0eWxlX3Byb3BlcnR5Iik7Cgp2YXIgX3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cyA9IHJlcXVpcmUoIi4uL3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cyIpOwoKdmFyIF9jb25zdGFudHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9jb21tb24vY29uc3RhbnRzIik7Cgp2YXIgX3N0eWxlX3V0aWwgPSByZXF1aXJlKCIuLi9zdHlsZV91dGlsIik7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfb3JkaW5hbF9sZWdlbmQgPSByZXF1aXJlKCIuL2NvbXBvbmVudHMvb3JkaW5hbF9sZWdlbmQiKTsKCnZhciBfY2F0ZWdvcmljYWxfbGVnZW5kID0gcmVxdWlyZSgiLi9jb21wb25lbnRzL2NhdGVnb3JpY2FsX2xlZ2VuZCIpOwoKdmFyIF9vcmRpbmFsX2ZpZWxkX21ldGFfcG9wb3ZlciA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvZmllbGRfbWV0YS9vcmRpbmFsX2ZpZWxkX21ldGFfcG9wb3ZlciIpOwoKdmFyIF9jYXRlZ29yaWNhbF9maWVsZF9tZXRhX3BvcG92ZXIgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL2ZpZWxkX21ldGEvY2F0ZWdvcmljYWxfZmllbGRfbWV0YV9wb3BvdmVyIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9lID0gdW5kZWZpbmVkOyB0cnkgeyBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOyB9IH0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCnZhciBEeW5hbWljU3R5bGVQcm9wZXJ0eSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9BYnN0cmFjdFN0eWxlUHJvcGVydCkgewogIF9pbmhlcml0cyhEeW5hbWljU3R5bGVQcm9wZXJ0eSwgX0Fic3RyYWN0U3R5bGVQcm9wZXJ0KTsKCiAgZnVuY3Rpb24gRHluYW1pY1N0eWxlUHJvcGVydHkob3B0aW9ucywgc3R5bGVOYW1lLCBfZmllbGQsIHZlY3RvckxheWVyLCBnZXRGaWVsZEZvcm1hdHRlcikgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEeW5hbWljU3R5bGVQcm9wZXJ0eSk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoRHluYW1pY1N0eWxlUHJvcGVydHkpLmNhbGwodGhpcywgb3B0aW9ucywgc3R5bGVOYW1lKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZ2V0VmFsdWVTdWdnZXN0aW9ucyIsIGZ1bmN0aW9uIChxdWVyeSkgewogICAgICB2YXIgZmllbGQgPSBfdGhpcy5nZXRGaWVsZCgpOwoKICAgICAgdmFyIGZpZWxkU291cmNlID0gX3RoaXMuX2dldEZpZWxkU291cmNlKCk7CgogICAgICByZXR1cm4gZmllbGRTb3VyY2UgJiYgZmllbGQgPyBmaWVsZFNvdXJjZS5nZXRWYWx1ZVN1Z2dlc3Rpb25zKGZpZWxkLCBxdWVyeSkgOiBbXTsKICAgIH0pOwoKICAgIF90aGlzLl9maWVsZCA9IF9maWVsZDsKICAgIF90aGlzLl9sYXllciA9IHZlY3RvckxheWVyOwogICAgX3RoaXMuX2dldEZpZWxkRm9ybWF0dGVyID0gZ2V0RmllbGRGb3JtYXR0ZXI7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRHluYW1pY1N0eWxlUHJvcGVydHksIFt7CiAgICBrZXk6ICJfZ2V0U3R5bGVNZXRhRGF0YVJlcXVlc3RJZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2dldFN0eWxlTWV0YURhdGFSZXF1ZXN0SWQoZmllbGROYW1lKSB7CiAgICAgIGlmICh0aGlzLmdldEZpZWxkT3JpZ2luKCkgPT09IF9jb25zdGFudHMuRklFTERfT1JJR0lOLlNPVVJDRSkgewogICAgICAgIHJldHVybiBfY29uc3RhbnRzLlNPVVJDRV9NRVRBX0lEX09SSUdJTjsKICAgICAgfQoKICAgICAgdmFyIGpvaW4gPSB0aGlzLl9sYXllci5nZXRWYWxpZEpvaW5zKCkuZmluZChmdW5jdGlvbiAoam9pbikgewogICAgICAgIHJldHVybiBqb2luLmdldFJpZ2h0Sm9pblNvdXJjZSgpLmhhc01hdGNoaW5nTWV0cmljRmllbGQoZmllbGROYW1lKTsKICAgICAgfSk7CgogICAgICByZXR1cm4gam9pbiA/IGpvaW4uZ2V0U291cmNlTWV0YURhdGFSZXF1ZXN0SWQoKSA6IG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UmFuZ2VGaWVsZE1ldGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJhbmdlRmllbGRNZXRhKCkgewogICAgICB2YXIgc3R5bGUgPSB0aGlzLl9sYXllci5nZXRTdHlsZSgpOwoKICAgICAgdmFyIHN0eWxlTWV0YSA9IHN0eWxlLmdldFN0eWxlTWV0YSgpOwogICAgICB2YXIgZmllbGROYW1lID0gdGhpcy5nZXRGaWVsZE5hbWUoKTsKICAgICAgdmFyIHJhbmdlRmllbGRNZXRhRnJvbUxvY2FsRmVhdHVyZXMgPSBzdHlsZU1ldGEuZ2V0UmFuZ2VGaWVsZE1ldGFEZXNjcmlwdG9yKGZpZWxkTmFtZSk7CgogICAgICBpZiAoIXRoaXMuaXNGaWVsZE1ldGFFbmFibGVkKCkpIHsKICAgICAgICByZXR1cm4gcmFuZ2VGaWVsZE1ldGFGcm9tTG9jYWxGZWF0dXJlczsKICAgICAgfQoKICAgICAgdmFyIGRhdGFSZXF1ZXN0SWQgPSB0aGlzLl9nZXRTdHlsZU1ldGFEYXRhUmVxdWVzdElkKGZpZWxkTmFtZSk7CgogICAgICBpZiAoIWRhdGFSZXF1ZXN0SWQpIHsKICAgICAgICByZXR1cm4gcmFuZ2VGaWVsZE1ldGFGcm9tTG9jYWxGZWF0dXJlczsKICAgICAgfQoKICAgICAgdmFyIHN0eWxlTWV0YURhdGFSZXF1ZXN0ID0gdGhpcy5fbGF5ZXIuZ2V0RGF0YVJlcXVlc3QoZGF0YVJlcXVlc3RJZCk7CgogICAgICBpZiAoIXN0eWxlTWV0YURhdGFSZXF1ZXN0IHx8ICFzdHlsZU1ldGFEYXRhUmVxdWVzdC5oYXNEYXRhKCkpIHsKICAgICAgICByZXR1cm4gcmFuZ2VGaWVsZE1ldGFGcm9tTG9jYWxGZWF0dXJlczsKICAgICAgfQoKICAgICAgdmFyIGRhdGEgPSBzdHlsZU1ldGFEYXRhUmVxdWVzdC5nZXREYXRhKCk7CiAgICAgIHZhciByYW5nZUZpZWxkTWV0YSA9IHRoaXMucGx1Y2tPcmRpbmFsU3R5bGVNZXRhRnJvbUZpZWxkTWV0YURhdGEoZGF0YSk7CiAgICAgIHJldHVybiByYW5nZUZpZWxkTWV0YSA/IHJhbmdlRmllbGRNZXRhIDogcmFuZ2VGaWVsZE1ldGFGcm9tTG9jYWxGZWF0dXJlczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRDYXRlZ29yeUZpZWxkTWV0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2F0ZWdvcnlGaWVsZE1ldGEoKSB7CiAgICAgIHZhciBzdHlsZSA9IHRoaXMuX2xheWVyLmdldFN0eWxlKCk7CgogICAgICB2YXIgc3R5bGVNZXRhID0gc3R5bGUuZ2V0U3R5bGVNZXRhKCk7CiAgICAgIHZhciBmaWVsZE5hbWUgPSB0aGlzLmdldEZpZWxkTmFtZSgpOwogICAgICB2YXIgY2F0ZWdvcnlGaWVsZE1ldGFGcm9tTG9jYWxGZWF0dXJlcyA9IHN0eWxlTWV0YS5nZXRDYXRlZ29yeUZpZWxkTWV0YURlc2NyaXB0b3IoZmllbGROYW1lKTsKCiAgICAgIGlmICghdGhpcy5pc0ZpZWxkTWV0YUVuYWJsZWQoKSkgewogICAgICAgIHJldHVybiBjYXRlZ29yeUZpZWxkTWV0YUZyb21Mb2NhbEZlYXR1cmVzOwogICAgICB9CgogICAgICB2YXIgZGF0YVJlcXVlc3RJZCA9IHRoaXMuX2dldFN0eWxlTWV0YURhdGFSZXF1ZXN0SWQoZmllbGROYW1lKTsKCiAgICAgIGlmICghZGF0YVJlcXVlc3RJZCkgewogICAgICAgIHJldHVybiBjYXRlZ29yeUZpZWxkTWV0YUZyb21Mb2NhbEZlYXR1cmVzOwogICAgICB9CgogICAgICB2YXIgc3R5bGVNZXRhRGF0YVJlcXVlc3QgPSB0aGlzLl9sYXllci5nZXREYXRhUmVxdWVzdChkYXRhUmVxdWVzdElkKTsKCiAgICAgIGlmICghc3R5bGVNZXRhRGF0YVJlcXVlc3QgfHwgIXN0eWxlTWV0YURhdGFSZXF1ZXN0Lmhhc0RhdGEoKSkgewogICAgICAgIHJldHVybiBjYXRlZ29yeUZpZWxkTWV0YUZyb21Mb2NhbEZlYXR1cmVzOwogICAgICB9CgogICAgICB2YXIgZGF0YSA9IHN0eWxlTWV0YURhdGFSZXF1ZXN0LmdldERhdGEoKTsKICAgICAgdmFyIHJhbmdlRmllbGRNZXRhID0gdGhpcy5wbHVja0NhdGVnb3JpY2FsU3R5bGVNZXRhRnJvbUZpZWxkTWV0YURhdGEoZGF0YSk7CiAgICAgIHJldHVybiByYW5nZUZpZWxkTWV0YSA/IHJhbmdlRmllbGRNZXRhIDogY2F0ZWdvcnlGaWVsZE1ldGFGcm9tTG9jYWxGZWF0dXJlczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRGaWVsZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RmllbGQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9maWVsZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZ2V0RmllbGRTb3VyY2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRGaWVsZFNvdXJjZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ZpZWxkID8gdGhpcy5fZmllbGQuZ2V0U291cmNlKCkgOiBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEZpZWxkTmFtZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RmllbGROYW1lKCkgewogICAgICByZXR1cm4gdGhpcy5fZmllbGQgPyB0aGlzLl9maWVsZC5nZXROYW1lKCkgOiAnJzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRDb21wdXRlZEZpZWxkTmFtZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29tcHV0ZWRGaWVsZE5hbWUoKSB7CiAgICAgIGlmICghdGhpcy5pc0NvbXBsZXRlKCkpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfc3R5bGVfdXRpbC5nZXRDb21wdXRlZEZpZWxkTmFtZSkodGhpcy5fc3R5bGVOYW1lLCB0aGlzLmdldEZpZWxkKCkuZ2V0TmFtZSgpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0R5bmFtaWMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzRHluYW1pYygpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNPcmRpbmFsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc09yZGluYWwoKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0sIHsKICAgIGtleTogImlzQ2F0ZWdvcmljYWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzQ2F0ZWdvcmljYWwoKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYXNPcmRpbmFsQnJlYWtzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYXNPcmRpbmFsQnJlYWtzKCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNPcmRpbmFsUmFuZ2VkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc09yZGluYWxSYW5nZWQoKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0sIHsKICAgIGtleTogImlzQ29tcGxldGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzQ29tcGxldGUoKSB7CiAgICAgIHJldHVybiAhIXRoaXMuX2ZpZWxkOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEZpZWxkT3JpZ2luIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGaWVsZE9yaWdpbigpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ZpZWxkLmdldE9yaWdpbigpOwogICAgfQogIH0sIHsKICAgIGtleTogImlzRmllbGRNZXRhRW5hYmxlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNGaWVsZE1ldGFFbmFibGVkKCkgewogICAgICB2YXIgZmllbGRNZXRhT3B0aW9ucyA9IHRoaXMuZ2V0RmllbGRNZXRhT3B0aW9ucygpOwogICAgICByZXR1cm4gdGhpcy5zdXBwb3J0c0ZpZWxkTWV0YSgpICYmIF9sb2Rhc2guZGVmYXVsdC5nZXQoZmllbGRNZXRhT3B0aW9ucywgJ2lzRW5hYmxlZCcsIHRydWUpOwogICAgfQogIH0sIHsKICAgIGtleTogInN1cHBvcnRzRmllbGRNZXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdXBwb3J0c0ZpZWxkTWV0YSgpIHsKICAgICAgaWYgKHRoaXMuaXNPcmRpbmFsKCkpIHsKICAgICAgICByZXR1cm4gdGhpcy5pc0NvbXBsZXRlKCkgJiYgdGhpcy5pc09yZGluYWxTY2FsZWQoKSAmJiB0aGlzLl9maWVsZC5zdXBwb3J0c0ZpZWxkTWV0YSgpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuaXNDYXRlZ29yaWNhbCgpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaXNDb21wbGV0ZSgpICYmIHRoaXMuX2ZpZWxkLnN1cHBvcnRzRmllbGRNZXRhKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RmllbGRNZXRhUmVxdWVzdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldEZpZWxkTWV0YVJlcXVlc3QgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc09yZGluYWwoKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgdGhpcy5fZmllbGQuZ2V0T3JkaW5hbEZpZWxkTWV0YVJlcXVlc3QoKSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0NhdGVnb3JpY2FsKCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHRoaXMuX2ZpZWxkLmdldENhdGVnb3JpY2FsRmllbGRNZXRhUmVxdWVzdCgpKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRGaWVsZE1ldGFSZXF1ZXN0KCkgewogICAgICAgIHJldHVybiBfZ2V0RmllbGRNZXRhUmVxdWVzdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0RmllbGRNZXRhUmVxdWVzdDsKICAgIH0oKQogIH0sIHsKICAgIGtleTogInN1cHBvcnRzTWJGZWF0dXJlU3RhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN1cHBvcnRzTWJGZWF0dXJlU3RhdGUoKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0sIHsKICAgIGtleTogImlzT3JkaW5hbFNjYWxlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNPcmRpbmFsU2NhbGVkKCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRGaWVsZE1ldGFPcHRpb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGaWVsZE1ldGFPcHRpb25zKCkgewogICAgICByZXR1cm4gX2xvZGFzaC5kZWZhdWx0LmdldCh0aGlzLmdldE9wdGlvbnMoKSwgJ2ZpZWxkTWV0YU9wdGlvbnMnLCB7fSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicGx1Y2tPcmRpbmFsU3R5bGVNZXRhRnJvbUZlYXR1cmVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwbHVja09yZGluYWxTdHlsZU1ldGFGcm9tRmVhdHVyZXMoZmVhdHVyZXMpIHsKICAgICAgaWYgKCF0aGlzLmlzT3JkaW5hbCgpKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBuYW1lID0gdGhpcy5nZXRGaWVsZCgpLmdldE5hbWUoKTsKICAgICAgdmFyIG1pbiA9IEluZmluaXR5OwogICAgICB2YXIgbWF4ID0gLUluZmluaXR5OwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmZWF0dXJlcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBmZWF0dXJlID0gZmVhdHVyZXNbaV07CiAgICAgICAgdmFyIG5ld1ZhbHVlID0gcGFyc2VGbG9hdChmZWF0dXJlLnByb3BlcnRpZXNbbmFtZV0pOwoKICAgICAgICBpZiAoIWlzTmFOKG5ld1ZhbHVlKSkgewogICAgICAgICAgbWluID0gTWF0aC5taW4obWluLCBuZXdWYWx1ZSk7CiAgICAgICAgICBtYXggPSBNYXRoLm1heChtYXgsIG5ld1ZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBtaW4gPT09IEluZmluaXR5IHx8IG1heCA9PT0gLUluZmluaXR5ID8gbnVsbCA6IHsKICAgICAgICBtaW46IG1pbiwKICAgICAgICBtYXg6IG1heCwKICAgICAgICBkZWx0YTogbWF4IC0gbWluCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAicGx1Y2tDYXRlZ29yaWNhbFN0eWxlTWV0YUZyb21GZWF0dXJlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGx1Y2tDYXRlZ29yaWNhbFN0eWxlTWV0YUZyb21GZWF0dXJlcyhmZWF0dXJlcykgewogICAgICBpZiAoIXRoaXMuaXNDYXRlZ29yaWNhbCgpKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBmaWVsZE5hbWUgPSB0aGlzLmdldEZpZWxkKCkuZ2V0TmFtZSgpOwogICAgICB2YXIgY291bnRzID0gbmV3IE1hcCgpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmZWF0dXJlcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBmZWF0dXJlID0gZmVhdHVyZXNbaV07CiAgICAgICAgdmFyIHRlcm0gPSBmZWF0dXJlLnByb3BlcnRpZXNbZmllbGROYW1lXTsgLy9wcm9wZXJ0aWVzIG9iamVjdCBtYXkgYmUgc3BhcnNlLCBzbyBuZWVkIHRvIGNoZWNrIGlmIHRoZSBmaWVsZCBpcyBlZmZlY3RpdmVseSBwcmVzZW50CgogICAgICAgIGlmIChfdHlwZW9mKHRlcm0pICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmIChjb3VudHMuaGFzKHRlcm0pKSB7CiAgICAgICAgICAgIGNvdW50cy5zZXQodGVybSwgY291bnRzLmdldCh0ZXJtKSArIDEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY291bnRzLnNldCh0ZXJtLCAxKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBvcmRlcmVkID0gW107CiAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTsKICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7CiAgICAgIHZhciBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gY291bnRzW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkgewogICAgICAgICAgdmFyIF9zdGVwJHZhbHVlID0gX3NsaWNlZFRvQXJyYXkoX3N0ZXAudmFsdWUsIDIpLAogICAgICAgICAgICAgIGtleSA9IF9zdGVwJHZhbHVlWzBdLAogICAgICAgICAgICAgIHZhbHVlID0gX3N0ZXAkdmFsdWVbMV07CgogICAgICAgICAgb3JkZXJlZC5wdXNoKHsKICAgICAgICAgICAga2V5OiBrZXksCiAgICAgICAgICAgIGNvdW50OiB2YWx1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7CiAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgICAgX2l0ZXJhdG9yLnJldHVybigpOwogICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBvcmRlcmVkLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICByZXR1cm4gYi5jb3VudCAtIGEuY291bnQ7CiAgICAgIH0pOwogICAgICB2YXIgdHJ1bmNhdGVkID0gb3JkZXJlZC5zbGljZSgwLCBfY29uc3RhbnRzLkNPTE9SX1BBTEVUVEVfTUFYX1NJWkUpOwogICAgICByZXR1cm4gewogICAgICAgIGNhdGVnb3JpZXM6IHRydW5jYXRlZAogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogInBsdWNrT3JkaW5hbFN0eWxlTWV0YUZyb21GaWVsZE1ldGFEYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwbHVja09yZGluYWxTdHlsZU1ldGFGcm9tRmllbGRNZXRhRGF0YShmaWVsZE1ldGFEYXRhKSB7CiAgICAgIGlmICghdGhpcy5pc09yZGluYWwoKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgc3RhdHMgPSBmaWVsZE1ldGFEYXRhW3RoaXMuX2ZpZWxkLmdldFJvb3ROYW1lKCldOwoKICAgICAgaWYgKCFzdGF0cykgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgc2lnbWEgPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KHRoaXMuZ2V0RmllbGRNZXRhT3B0aW9ucygpLCAnc2lnbWEnLCBfdmVjdG9yX3N0eWxlX2RlZmF1bHRzLkRFRkFVTFRfU0lHTUEpOwoKICAgICAgdmFyIHN0ZExvd2VyQm91bmRzID0gc3RhdHMuYXZnIC0gc3RhdHMuc3RkX2RldmlhdGlvbiAqIHNpZ21hOwogICAgICB2YXIgc3RkVXBwZXJCb3VuZHMgPSBzdGF0cy5hdmcgKyBzdGF0cy5zdGRfZGV2aWF0aW9uICogc2lnbWE7CiAgICAgIHZhciBtaW4gPSBNYXRoLm1heChzdGF0cy5taW4sIHN0ZExvd2VyQm91bmRzKTsKICAgICAgdmFyIG1heCA9IE1hdGgubWluKHN0YXRzLm1heCwgc3RkVXBwZXJCb3VuZHMpOwogICAgICByZXR1cm4gewogICAgICAgIG1pbjogbWluLAogICAgICAgIG1heDogbWF4LAogICAgICAgIGRlbHRhOiBtYXggLSBtaW4sCiAgICAgICAgaXNNaW5PdXRzaWRlU3RkUmFuZ2U6IHN0YXRzLm1pbiA8IHN0ZExvd2VyQm91bmRzLAogICAgICAgIGlzTWF4T3V0c2lkZVN0ZFJhbmdlOiBzdGF0cy5tYXggPiBzdGRVcHBlckJvdW5kcwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogInBsdWNrQ2F0ZWdvcmljYWxTdHlsZU1ldGFGcm9tRmllbGRNZXRhRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGx1Y2tDYXRlZ29yaWNhbFN0eWxlTWV0YUZyb21GaWVsZE1ldGFEYXRhKGZpZWxkTWV0YURhdGEpIHsKICAgICAgaWYgKCF0aGlzLmlzQ2F0ZWdvcmljYWwoKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgcm9vdEZpZWxkTmFtZSA9IHRoaXMuX2ZpZWxkLmdldFJvb3ROYW1lKCk7CgogICAgICBpZiAoIWZpZWxkTWV0YURhdGFbcm9vdEZpZWxkTmFtZV0gfHwgIWZpZWxkTWV0YURhdGFbcm9vdEZpZWxkTmFtZV0uYnVja2V0cykgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgb3JkZXJlZCA9IGZpZWxkTWV0YURhdGFbcm9vdEZpZWxkTmFtZV0uYnVja2V0cy5tYXAoZnVuY3Rpb24gKGJ1Y2tldCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBrZXk6IGJ1Y2tldC5rZXksCiAgICAgICAgICBjb3VudDogYnVja2V0LmRvY19jb3VudAogICAgICAgIH07CiAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGNhdGVnb3JpZXM6IG9yZGVyZWQKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmb3JtYXRGaWVsZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZm9ybWF0RmllbGQodmFsdWUpIHsKICAgICAgaWYgKHRoaXMuZ2V0RmllbGQoKSkgewogICAgICAgIHZhciBmaWVsZE5hbWUgPSB0aGlzLmdldEZpZWxkKCkuZ2V0TmFtZSgpOwoKICAgICAgICB2YXIgZmllbGRGb3JtYXR0ZXIgPSB0aGlzLl9nZXRGaWVsZEZvcm1hdHRlcihmaWVsZE5hbWUpOwoKICAgICAgICByZXR1cm4gZmllbGRGb3JtYXR0ZXIgPyBmaWVsZEZvcm1hdHRlcih2YWx1ZSkgOiB2YWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRNYlZhbHVlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRNYlZhbHVlKHZhbHVlKSB7CiAgICAgIGlmICghdGhpcy5pc09yZGluYWwoKSkgewogICAgICAgIHJldHVybiB0aGlzLmZvcm1hdEZpZWxkKHZhbHVlKTsKICAgICAgfQoKICAgICAgdmFyIHZhbHVlQXNGbG9hdCA9IHBhcnNlRmxvYXQodmFsdWUpOwoKICAgICAgaWYgKHRoaXMuaXNPcmRpbmFsU2NhbGVkKCkpIHsKICAgICAgICByZXR1cm4gKDAsIF9zdHlsZV91dGlsLnNjYWxlVmFsdWUpKHZhbHVlQXNGbG9hdCwgdGhpcy5nZXRSYW5nZUZpZWxkTWV0YSgpKTsKICAgICAgfQoKICAgICAgaWYgKGlzTmFOKHZhbHVlQXNGbG9hdCkpIHsKICAgICAgICByZXR1cm4gMDsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbHVlQXNGbG9hdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJCcmVha2VkTGVnZW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJCcmVha2VkTGVnZW5kKCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcmVuZGVyQ2F0ZWdvcmljYWxMZWdlbmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZW5kZXJDYXRlZ29yaWNhbExlZ2VuZChfcmVmKSB7CiAgICAgIHZhciBpc1BvaW50c09ubHkgPSBfcmVmLmlzUG9pbnRzT25seSwKICAgICAgICAgIGlzTGluZXNPbmx5ID0gX3JlZi5pc0xpbmVzT25seSwKICAgICAgICAgIHN5bWJvbElkID0gX3JlZi5zeW1ib2xJZDsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NhdGVnb3JpY2FsX2xlZ2VuZC5DYXRlZ29yaWNhbExlZ2VuZCwgewogICAgICAgIHN0eWxlOiB0aGlzLAogICAgICAgIGlzUG9pbnRzT25seTogaXNQb2ludHNPbmx5LAogICAgICAgIGlzTGluZXNPbmx5OiBpc0xpbmVzT25seSwKICAgICAgICBzeW1ib2xJZDogc3ltYm9sSWQKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlbmRlclJhbmdlTGVnZW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVuZGVyUmFuZ2VMZWdlbmQoKSB7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9vcmRpbmFsX2xlZ2VuZC5PcmRpbmFsTGVnZW5kLCB7CiAgICAgICAgc3R5bGU6IHRoaXMKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyTGVnZW5kRGV0YWlsUm93IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJMZWdlbmREZXRhaWxSb3coX3JlZjIpIHsKICAgICAgdmFyIGlzUG9pbnRzT25seSA9IF9yZWYyLmlzUG9pbnRzT25seSwKICAgICAgICAgIGlzTGluZXNPbmx5ID0gX3JlZjIuaXNMaW5lc09ubHksCiAgICAgICAgICBzeW1ib2xJZCA9IF9yZWYyLnN5bWJvbElkOwoKICAgICAgaWYgKHRoaXMuaXNPcmRpbmFsKCkpIHsKICAgICAgICBpZiAodGhpcy5pc09yZGluYWxSYW5nZWQoKSkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlclJhbmdlTGVnZW5kKCk7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmhhc09yZGluYWxCcmVha3MoKSkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlckNhdGVnb3JpY2FsTGVnZW5kKHsKICAgICAgICAgICAgaXNQb2ludHNPbmx5OiBpc1BvaW50c09ubHksCiAgICAgICAgICAgIGlzTGluZXNPbmx5OiBpc0xpbmVzT25seSwKICAgICAgICAgICAgc3ltYm9sSWQ6IHN5bWJvbElkCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaXNDYXRlZ29yaWNhbCgpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlckNhdGVnb3JpY2FsTGVnZW5kKHsKICAgICAgICAgIGlzUG9pbnRzT25seTogaXNQb2ludHNPbmx5LAogICAgICAgICAgaXNMaW5lc09ubHk6IGlzTGluZXNPbmx5LAogICAgICAgICAgc3ltYm9sSWQ6IHN5bWJvbElkCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJGaWVsZE1ldGFQb3BvdmVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJGaWVsZE1ldGFQb3BvdmVyKG9uRmllbGRNZXRhT3B0aW9uc0NoYW5nZSkgewogICAgICBpZiAoIXRoaXMuc3VwcG9ydHNGaWVsZE1ldGEoKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5pc0NhdGVnb3JpY2FsKCkgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jYXRlZ29yaWNhbF9maWVsZF9tZXRhX3BvcG92ZXIuQ2F0ZWdvcmljYWxGaWVsZE1ldGFQb3BvdmVyLCB7CiAgICAgICAgc3R5bGVQcm9wZXJ0eTogdGhpcywKICAgICAgICBvbkNoYW5nZTogb25GaWVsZE1ldGFPcHRpb25zQ2hhbmdlCiAgICAgIH0pIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfb3JkaW5hbF9maWVsZF9tZXRhX3BvcG92ZXIuT3JkaW5hbEZpZWxkTWV0YVBvcG92ZXIsIHsKICAgICAgICBzdHlsZVByb3BlcnR5OiB0aGlzLAogICAgICAgIG9uQ2hhbmdlOiBvbkZpZWxkTWV0YU9wdGlvbnNDaGFuZ2UKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRHluYW1pY1N0eWxlUHJvcGVydHk7Cn0oX3N0eWxlX3Byb3BlcnR5LkFic3RyYWN0U3R5bGVQcm9wZXJ0eSk7CgpleHBvcnRzLkR5bmFtaWNTdHlsZVByb3BlcnR5ID0gRHluYW1pY1N0eWxlUHJvcGVydHk7CgpfZGVmaW5lUHJvcGVydHkoRHluYW1pY1N0eWxlUHJvcGVydHksICJ0eXBlIiwgX2NvbnN0YW50cy5TVFlMRV9UWVBFLkRZTkFNSUMpOw=="},null]}