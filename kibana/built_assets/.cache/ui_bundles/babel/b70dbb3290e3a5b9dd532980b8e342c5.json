{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/components/description_step/helpers.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/components/description_step/helpers.js","mtime":1589249553300},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmJ1aWxkUnVsZVR5cGVEZXNjcmlwdGlvbiA9IGV4cG9ydHMuYnVpbGROb3RlRGVzY3JpcHRpb24gPSBleHBvcnRzLmJ1aWxkVXJsc0Rlc2NyaXB0aW9uID0gZXhwb3J0cy5idWlsZFNldmVyaXR5RGVzY3JpcHRpb24gPSBleHBvcnRzLmJ1aWxkU3RyaW5nQXJyYXlEZXNjcmlwdGlvbiA9IGV4cG9ydHMuYnVpbGRVbm9yZGVyZWRMaXN0QXJyYXlEZXNjcmlwdGlvbiA9IGV4cG9ydHMuYnVpbGRUaHJlYXREZXNjcmlwdGlvbiA9IGV4cG9ydHMuYnVpbGRRdWVyeUJhckRlc2NyaXB0aW9uID0gZXhwb3J0cy5pc05vdEVtcHR5QXJyYXkgPSB2b2lkIDA7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9mcCA9IHJlcXVpcmUoImxvZGFzaC9mcCIpOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3N0eWxlZENvbXBvbmVudHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInN0eWxlZC1jb21wb25lbnRzIikpOwoKdmFyIF9wdWJsaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9kYXRhL3B1YmxpYyIpOwoKdmFyIF9taXRyZV90YWN0aWNzX3RlY2huaXF1ZXMgPSByZXF1aXJlKCIuLi8uLi8uLi9taXRyZS9taXRyZV90YWN0aWNzX3RlY2huaXF1ZXMiKTsKCnZhciBpMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi90cmFuc2xhdGlvbnMiKSk7Cgp2YXIgX3NldmVyaXR5X2JhZGdlID0gcmVxdWlyZSgiLi4vc2V2ZXJpdHlfYmFkZ2UiKTsKCnZhciBfbGlzdF90cmVlX2ljb24gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIi4vYXNzZXRzL2xpc3RfdHJlZV9pY29uLnN2ZyIpKTsKCnZhciBfaGVscGVycyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL2xpYi9oZWxwZXJzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KfQoKdmFyIE5vdGVEZXNjcmlwdGlvbkNvbnRhaW5lciA9ICgwLCBfc3R5bGVkQ29tcG9uZW50cy5kZWZhdWx0KShfZXVpLkV1aUZsZXhJdGVtKS53aXRoQ29uZmlnKHsKICBkaXNwbGF5TmFtZTogIk5vdGVEZXNjcmlwdGlvbkNvbnRhaW5lciIsCiAgY29tcG9uZW50SWQ6ICJjanR5a2EtMCIKfSkoWyJoZWlnaHQ6MTA1cHg7b3ZlcmZsb3cteTpoaWRkZW47Il0pOwoKdmFyIGlzTm90RW1wdHlBcnJheSA9IGZ1bmN0aW9uIGlzTm90RW1wdHlBcnJheSh2YWx1ZXMpIHsKICByZXR1cm4gISgwLCBfZnAuaXNFbXB0eSkodmFsdWVzLmpvaW4oJycpKTsKfTsKCmV4cG9ydHMuaXNOb3RFbXB0eUFycmF5ID0gaXNOb3RFbXB0eUFycmF5Owp2YXIgRXVpQmFkZ2VXcmFwID0gKDAsIF9zdHlsZWRDb21wb25lbnRzLmRlZmF1bHQpKF9ldWkuRXVpQmFkZ2UpLndpdGhDb25maWcoewogIGRpc3BsYXlOYW1lOiAiRXVpQmFkZ2VXcmFwIiwKICBjb21wb25lbnRJZDogImNqdHlrYS0xIgp9KShbIi5ldWlCYWRnZV9fdGV4dHt3aGl0ZS1zcGFjZTpwcmUtd3JhcCAhaW1wb3J0YW50O30iXSk7Cgp2YXIgYnVpbGRRdWVyeUJhckRlc2NyaXB0aW9uID0gZnVuY3Rpb24gYnVpbGRRdWVyeUJhckRlc2NyaXB0aW9uKF9yZWYpIHsKICB2YXIgZmllbGQgPSBfcmVmLmZpZWxkLAogICAgICBmaWx0ZXJzID0gX3JlZi5maWx0ZXJzLAogICAgICBmaWx0ZXJNYW5hZ2VyID0gX3JlZi5maWx0ZXJNYW5hZ2VyLAogICAgICBxdWVyeSA9IF9yZWYucXVlcnksCiAgICAgIHNhdmVkSWQgPSBfcmVmLnNhdmVkSWQsCiAgICAgIGluZGV4UGF0dGVybnMgPSBfcmVmLmluZGV4UGF0dGVybnM7CiAgdmFyIGl0ZW1zID0gW107CgogIGlmICghKDAsIF9mcC5pc0VtcHR5KShmaWx0ZXJzKSkgewogICAgZmlsdGVyTWFuYWdlci5zZXRGaWx0ZXJzKGZpbHRlcnMpOwogICAgaXRlbXMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGl0ZW1zKSwgW3sKICAgICAgdGl0bGU6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIGkxOG4uRklMVEVSU19MQUJFTCwgIiAiKSwKICAgICAgZGVzY3JpcHRpb246IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICB3cmFwOiB0cnVlLAogICAgICAgIHJlc3BvbnNpdmU6IGZhbHNlLAogICAgICAgIGd1dHRlclNpemU6ICJ4cyIKICAgICAgfSwgZmlsdGVyTWFuYWdlci5nZXRGaWx0ZXJzKCkubWFwKGZ1bmN0aW9uIChmaWx0ZXIsIGluZGV4KSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgICAgZ3JvdzogZmFsc2UsCiAgICAgICAgICBrZXk6ICIiLmNvbmNhdChmaWVsZCwgIi1maWx0ZXItIikuY29uY2F0KGluZGV4KQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRXVpQmFkZ2VXcmFwLCB7CiAgICAgICAgICBjb2xvcjogImhvbGxvdyIKICAgICAgICB9LCBpbmRleFBhdHRlcm5zICE9IG51bGwgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9wdWJsaWMuZXNGaWx0ZXJzLkZpbHRlckxhYmVsLCB7CiAgICAgICAgICBmaWx0ZXI6IGZpbHRlciwKICAgICAgICAgIHZhbHVlTGFiZWw6IF9wdWJsaWMuZXNGaWx0ZXJzLmdldERpc3BsYXlWYWx1ZUZyb21GaWx0ZXIoZmlsdGVyLCBbaW5kZXhQYXR0ZXJuc10pCiAgICAgICAgfSkgOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTG9hZGluZ1NwaW5uZXIsIHsKICAgICAgICAgIHNpemU6ICJtIgogICAgICAgIH0pKSk7CiAgICAgIH0pKQogICAgfV0pOwogIH0KCiAgaWYgKCEoMCwgX2ZwLmlzRW1wdHkpKHF1ZXJ5KSkgewogICAgaXRlbXMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGl0ZW1zKSwgW3sKICAgICAgdGl0bGU6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIGkxOG4uUVVFUllfTEFCRUwsICIgIiksCiAgICAgIGRlc2NyaXB0aW9uOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBxdWVyeSwgIiAiKQogICAgfV0pOwogIH0KCiAgaWYgKCEoMCwgX2ZwLmlzRW1wdHkpKHNhdmVkSWQpKSB7CiAgICBpdGVtcyA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoaXRlbXMpLCBbewogICAgICB0aXRsZTogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgaTE4bi5TQVZFRF9JRF9MQUJFTCwgIiAiKSwKICAgICAgZGVzY3JpcHRpb246IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIHNhdmVkSWQsICIgIikKICAgIH1dKTsKICB9CgogIHJldHVybiBpdGVtczsKfTsKCmV4cG9ydHMuYnVpbGRRdWVyeUJhckRlc2NyaXB0aW9uID0gYnVpbGRRdWVyeUJhckRlc2NyaXB0aW9uOwp2YXIgVGhyZWF0RXVpRmxleEdyb3VwID0gKDAsIF9zdHlsZWRDb21wb25lbnRzLmRlZmF1bHQpKF9ldWkuRXVpRmxleEdyb3VwKS53aXRoQ29uZmlnKHsKICBkaXNwbGF5TmFtZTogIlRocmVhdEV1aUZsZXhHcm91cCIsCiAgY29tcG9uZW50SWQ6ICJjanR5a2EtMiIKfSkoWyIuZXVpRmxleEl0ZW17bWFyZ2luLWJvdHRvbTowcHg7fSJdKTsKdmFyIFRlY2huaXF1ZUxpbmtJdGVtID0gKDAsIF9zdHlsZWRDb21wb25lbnRzLmRlZmF1bHQpKF9ldWkuRXVpQnV0dG9uRW1wdHkpLndpdGhDb25maWcoewogIGRpc3BsYXlOYW1lOiAiVGVjaG5pcXVlTGlua0l0ZW0iLAogIGNvbXBvbmVudElkOiAiY2p0eWthLTMiCn0pKFsiLmV1aUljb257d2lkdGg6OHB4O2hlaWdodDo4cHg7fSJdKTsKCnZhciBidWlsZFRocmVhdERlc2NyaXB0aW9uID0gZnVuY3Rpb24gYnVpbGRUaHJlYXREZXNjcmlwdGlvbihfcmVmMikgewogIHZhciBsYWJlbCA9IF9yZWYyLmxhYmVsLAogICAgICB0aHJlYXQgPSBfcmVmMi50aHJlYXQ7CgogIGlmICh0aHJlYXQubGVuZ3RoID4gMCkgewogICAgcmV0dXJuIFt7CiAgICAgIHRpdGxlOiBsYWJlbCwKICAgICAgZGVzY3JpcHRpb246IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoVGhyZWF0RXVpRmxleEdyb3VwLCB7CiAgICAgICAgZGlyZWN0aW9uOiAiY29sdW1uIgogICAgICB9LCB0aHJlYXQubWFwKGZ1bmN0aW9uIChzaW5nbGVUaHJlYXQsIGluZGV4KSB7CiAgICAgICAgdmFyIHRhY3RpYyA9IF9taXRyZV90YWN0aWNzX3RlY2huaXF1ZXMudGFjdGljc09wdGlvbnMuZmluZChmdW5jdGlvbiAodCkgewogICAgICAgICAgcmV0dXJuIHQuaWQgPT09IHNpbmdsZVRocmVhdC50YWN0aWMuaWQ7CiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgIGtleTogIiIuY29uY2F0KHNpbmdsZVRocmVhdC50YWN0aWMubmFtZSwgIi0iKS5jb25jYXQoaW5kZXgpCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ0aHJlYXRUYWN0aWNMaW5rIiwKICAgICAgICAgIGhyZWY6IHNpbmdsZVRocmVhdC50YWN0aWMucmVmZXJlbmNlLAogICAgICAgICAgdGFyZ2V0OiAiX2JsYW5rIgogICAgICAgIH0sIHRhY3RpYyAhPSBudWxsID8gdGFjdGljLnRleHQgOiAnJyksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICAgIGd1dHRlclNpemU6ICJub25lIiwKICAgICAgICAgIGFsaWduSXRlbXM6ICJmbGV4U3RhcnQiLAogICAgICAgICAgZGlyZWN0aW9uOiAiY29sdW1uIgogICAgICAgIH0sIHNpbmdsZVRocmVhdC50ZWNobmlxdWUubWFwKGZ1bmN0aW9uICh0ZWNobmlxdWUpIHsKICAgICAgICAgIHZhciBteVRlY2huaXF1ZSA9IF9taXRyZV90YWN0aWNzX3RlY2huaXF1ZXMudGVjaG5pcXVlc09wdGlvbnMuZmluZChmdW5jdGlvbiAodCkgewogICAgICAgICAgICByZXR1cm4gdC5pZCA9PT0gdGVjaG5pcXVlLmlkOwogICAgICAgICAgfSk7CgogICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChUZWNobmlxdWVMaW5rSXRlbSwgewogICAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAidGhyZWF0VGVjaG5pcXVlTGluayIsCiAgICAgICAgICAgIGhyZWY6IHRlY2huaXF1ZS5yZWZlcmVuY2UsCiAgICAgICAgICAgIHRhcmdldDogIl9ibGFuayIsCiAgICAgICAgICAgIGljb25UeXBlOiBfbGlzdF90cmVlX2ljb24uZGVmYXVsdCwKICAgICAgICAgICAgc2l6ZTogInhzIiwKICAgICAgICAgICAgZmx1c2g6ICJsZWZ0IgogICAgICAgICAgfSwgbXlUZWNobmlxdWUgIT0gbnVsbCA/IG15VGVjaG5pcXVlLmxhYmVsIDogJycpKTsKICAgICAgICB9KSkpOwogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCkpCiAgICB9XTsKICB9CgogIHJldHVybiBbXTsKfTsKCmV4cG9ydHMuYnVpbGRUaHJlYXREZXNjcmlwdGlvbiA9IGJ1aWxkVGhyZWF0RGVzY3JpcHRpb247Cgp2YXIgYnVpbGRVbm9yZGVyZWRMaXN0QXJyYXlEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uIGJ1aWxkVW5vcmRlcmVkTGlzdEFycmF5RGVzY3JpcHRpb24obGFiZWwsIGZpZWxkLCB2YWx1ZXMpIHsKICBpZiAoaXNOb3RFbXB0eUFycmF5KHZhbHVlcykpIHsKICAgIHJldHVybiBbewogICAgICB0aXRsZTogbGFiZWwsCiAgICAgIGRlc2NyaXB0aW9uOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgewogICAgICAgIHNpemU6ICJzIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJ1bCIsIG51bGwsIHZhbHVlcy5tYXAoZnVuY3Rpb24gKHZhbCkgewogICAgICAgIHJldHVybiAoMCwgX2ZwLmlzRW1wdHkpKHZhbCkgPyBudWxsIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgibGkiLCB7CiAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAidW5vcmRlcmVkTGlzdEFycmF5RGVzY3JpcHRpb25JdGVtIiwKICAgICAgICAgIGtleTogIiIuY29uY2F0KGZpZWxkLCAiLSIpLmNvbmNhdCh2YWwpCiAgICAgICAgfSwgdmFsKTsKICAgICAgfSkpKQogICAgfV07CiAgfQoKICByZXR1cm4gW107Cn07CgpleHBvcnRzLmJ1aWxkVW5vcmRlcmVkTGlzdEFycmF5RGVzY3JpcHRpb24gPSBidWlsZFVub3JkZXJlZExpc3RBcnJheURlc2NyaXB0aW9uOwoKdmFyIGJ1aWxkU3RyaW5nQXJyYXlEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uIGJ1aWxkU3RyaW5nQXJyYXlEZXNjcmlwdGlvbihsYWJlbCwgZmllbGQsIHZhbHVlcykgewogIGlmIChpc05vdEVtcHR5QXJyYXkodmFsdWVzKSkgewogICAgcmV0dXJuIFt7CiAgICAgIHRpdGxlOiBsYWJlbCwKICAgICAgZGVzY3JpcHRpb246IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgICAgICByZXNwb25zaXZlOiBmYWxzZSwKICAgICAgICBndXR0ZXJTaXplOiAieHMiLAogICAgICAgIHdyYXA6IHRydWUKICAgICAgfSwgdmFsdWVzLm1hcChmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgcmV0dXJuICgwLCBfZnAuaXNFbXB0eSkodmFsKSA/IG51bGwgOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgIGdyb3c6IGZhbHNlLAogICAgICAgICAga2V5OiAiIi5jb25jYXQoZmllbGQsICItIikuY29uY2F0KHZhbCkKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEV1aUJhZGdlV3JhcCwgewogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInN0cmluZ0FycmF5RGVzY3JpcHRpb25CYWRnZUl0ZW0iLAogICAgICAgICAgY29sb3I6ICJob2xsb3ciCiAgICAgICAgfSwgdmFsKSk7CiAgICAgIH0pKQogICAgfV07CiAgfQoKICByZXR1cm4gW107Cn07CgpleHBvcnRzLmJ1aWxkU3RyaW5nQXJyYXlEZXNjcmlwdGlvbiA9IGJ1aWxkU3RyaW5nQXJyYXlEZXNjcmlwdGlvbjsKCnZhciBidWlsZFNldmVyaXR5RGVzY3JpcHRpb24gPSBmdW5jdGlvbiBidWlsZFNldmVyaXR5RGVzY3JpcHRpb24obGFiZWwsIHZhbHVlKSB7CiAgcmV0dXJuIFt7CiAgICB0aXRsZTogbGFiZWwsCiAgICBkZXNjcmlwdGlvbjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2V2ZXJpdHlfYmFkZ2UuU2V2ZXJpdHlCYWRnZSwgewogICAgICB2YWx1ZTogdmFsdWUKICAgIH0pCiAgfV07Cn07CgpleHBvcnRzLmJ1aWxkU2V2ZXJpdHlEZXNjcmlwdGlvbiA9IGJ1aWxkU2V2ZXJpdHlEZXNjcmlwdGlvbjsKCnZhciBidWlsZFVybHNEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uIGJ1aWxkVXJsc0Rlc2NyaXB0aW9uKGxhYmVsLCB2YWx1ZXMpIHsKICBpZiAoaXNOb3RFbXB0eUFycmF5KHZhbHVlcykpIHsKICAgIHJldHVybiBbewogICAgICB0aXRsZTogbGFiZWwsCiAgICAgIGRlc2NyaXB0aW9uOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgewogICAgICAgIHNpemU6ICJzIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJ1bCIsIG51bGwsIHZhbHVlcy5maWx0ZXIoZnVuY3Rpb24gKHYpIHsKICAgICAgICByZXR1cm4gISgwLCBfZnAuaXNFbXB0eSkodik7CiAgICAgIH0pLm1hcChmdW5jdGlvbiAodmFsLCBpbmRleCkgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJsaSIsIHsKICAgICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJ1cmxzRGVzY3JpcHRpb25SZWZlcmVuY2VMaW5rSXRlbSIsCiAgICAgICAgICBrZXk6ICIiLmNvbmNhdChpbmRleCwgIi0iKS5jb25jYXQodmFsKQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgICBocmVmOiB2YWwsCiAgICAgICAgICBleHRlcm5hbDogdHJ1ZSwKICAgICAgICAgIHRhcmdldDogIl9ibGFuayIKICAgICAgICB9LCB2YWwpKTsKICAgICAgfSkpKQogICAgfV07CiAgfQoKICByZXR1cm4gW107Cn07CgpleHBvcnRzLmJ1aWxkVXJsc0Rlc2NyaXB0aW9uID0gYnVpbGRVcmxzRGVzY3JpcHRpb247Cgp2YXIgYnVpbGROb3RlRGVzY3JpcHRpb24gPSBmdW5jdGlvbiBidWlsZE5vdGVEZXNjcmlwdGlvbihsYWJlbCwgbm90ZSkgewogIGlmIChub3RlLnRyaW0oKSAhPT0gJycpIHsKICAgIHJldHVybiBbewogICAgICB0aXRsZTogbGFiZWwsCiAgICAgIGRlc2NyaXB0aW9uOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KE5vdGVEZXNjcmlwdGlvbkNvbnRhaW5lciwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJub3RlRGVzY3JpcHRpb25JdGVtIiwKICAgICAgICBjbGFzc05hbWU6ICJldWkteVNjcm9sbFdpdGhTaGFkb3dzIgogICAgICB9LCBub3RlKSkKICAgIH1dOwogIH0KCiAgcmV0dXJuIFtdOwp9OwoKZXhwb3J0cy5idWlsZE5vdGVEZXNjcmlwdGlvbiA9IGJ1aWxkTm90ZURlc2NyaXB0aW9uOwoKdmFyIGJ1aWxkUnVsZVR5cGVEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uIGJ1aWxkUnVsZVR5cGVEZXNjcmlwdGlvbihsYWJlbCwgcnVsZVR5cGUpIHsKICBzd2l0Y2ggKHJ1bGVUeXBlKSB7CiAgICBjYXNlICdtYWNoaW5lX2xlYXJuaW5nJzoKICAgICAgewogICAgICAgIHJldHVybiBbewogICAgICAgICAgdGl0bGU6IGxhYmVsLAogICAgICAgICAgZGVzY3JpcHRpb246IGkxOG4uTUxfVFlQRV9ERVNDUklQVElPTgogICAgICAgIH1dOwogICAgICB9CgogICAgY2FzZSAncXVlcnknOgogICAgY2FzZSAnc2F2ZWRfcXVlcnknOgogICAgICB7CiAgICAgICAgcmV0dXJuIFt7CiAgICAgICAgICB0aXRsZTogbGFiZWwsCiAgICAgICAgICBkZXNjcmlwdGlvbjogaTE4bi5RVUVSWV9UWVBFX0RFU0NSSVBUSU9OCiAgICAgICAgfV07CiAgICAgIH0KCiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gKDAsIF9oZWxwZXJzLmFzc2VydFVucmVhY2hhYmxlKShydWxlVHlwZSk7CiAgfQp9OwoKZXhwb3J0cy5idWlsZFJ1bGVUeXBlRGVzY3JpcHRpb24gPSBidWlsZFJ1bGVUeXBlRGVzY3JpcHRpb247"},null]}