{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/components/step_schedule_rule/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/components/step_schedule_rule/index.js","mtime":1589249553316},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlN0ZXBTY2hlZHVsZVJ1bGUgPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2Zhc3REZWVwRXF1YWwgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImZhc3QtZGVlcC1lcXVhbCIpKTsKCnZhciBfc3R5bGVkQ29tcG9uZW50cyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgic3R5bGVkLWNvbXBvbmVudHMiKSk7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuLi8uLi9oZWxwZXJzIik7Cgp2YXIgX3R5cGVzID0gcmVxdWlyZSgiLi4vLi4vdHlwZXMiKTsKCnZhciBfZGVzY3JpcHRpb25fc3RlcCA9IHJlcXVpcmUoIi4uL2Rlc2NyaXB0aW9uX3N0ZXAiKTsKCnZhciBfc2NoZWR1bGVfaXRlbV9mb3JtID0gcmVxdWlyZSgiLi4vc2NoZWR1bGVfaXRlbV9mb3JtIik7Cgp2YXIgX3NoYXJlZF9pbXBvcnRzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vc2hhcmVkX2ltcG9ydHMiKTsKCnZhciBfc3RlcF9jb250ZW50X3dyYXBwZXIgPSByZXF1aXJlKCIuLi9zdGVwX2NvbnRlbnRfd3JhcHBlciIpOwoKdmFyIF9uZXh0X3N0ZXAgPSByZXF1aXJlKCIuLi9uZXh0X3N0ZXAiKTsKCnZhciBfc2NoZW1hID0gcmVxdWlyZSgiLi9zY2hlbWEiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgewogIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKICAgIHJldHVybiBvYmo7CiAgfSBlbHNlIHsKICAgIHZhciBuZXdPYmogPSB7fTsKCiAgICBpZiAob2JqICE9IG51bGwpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsKCiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7CiAgICByZXR1cm4gbmV3T2JqOwogIH0KfQoKZnVuY3Rpb24gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKHNvdXJjZSwgZXhjbHVkZWQpIHsKICBpZiAoc291cmNlID09IG51bGwpIHJldHVybiB7fTsKCiAgdmFyIHRhcmdldCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKHNvdXJjZSwgZXhjbHVkZWQpOwoKICB2YXIga2V5LCBpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHNvdXJjZVN5bWJvbEtleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHNvdXJjZSk7CgogICAgZm9yIChpID0gMDsgaSA8IHNvdXJjZVN5bWJvbEtleXMubGVuZ3RoOyBpKyspIHsKICAgICAga2V5ID0gc291cmNlU3ltYm9sS2V5c1tpXTsKICAgICAgaWYgKGV4Y2x1ZGVkLmluZGV4T2Yoa2V5KSA+PSAwKSBjb250aW51ZTsKICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoc291cmNlLCBrZXkpKSBjb250aW51ZTsKICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKHNvdXJjZSwgZXhjbHVkZWQpIHsKICBpZiAoc291cmNlID09IG51bGwpIHJldHVybiB7fTsKICB2YXIgdGFyZ2V0ID0ge307CiAgdmFyIHNvdXJjZUtleXMgPSBPYmplY3Qua2V5cyhzb3VyY2UpOwogIHZhciBrZXksIGk7CgogIGZvciAoaSA9IDA7IGkgPCBzb3VyY2VLZXlzLmxlbmd0aDsgaSsrKSB7CiAgICBrZXkgPSBzb3VyY2VLZXlzW2ldOwogICAgaWYgKGV4Y2x1ZGVkLmluZGV4T2Yoa2V5KSA+PSAwKSBjb250aW51ZTsKICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgewogIHRyeSB7CiAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7CiAgICB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICByZWplY3QoZXJyb3IpOwogICAgcmV0dXJuOwogIH0KCiAgaWYgKGluZm8uZG9uZSkgewogICAgcmVzb2x2ZSh2YWx1ZSk7CiAgfSBlbHNlIHsKICAgIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsKICB9Cn0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICBhcmdzID0gYXJndW1lbnRzOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOwoKICAgICAgZnVuY3Rpb24gX25leHQodmFsdWUpIHsKICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOwogICAgICB9CgogICAgICBfbmV4dCh1bmRlZmluZWQpOwogICAgfSk7CiAgfTsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKdmFyIFJlc3RyaWN0ZWRXaWR0aENvbnRhaW5lciA9IF9zdHlsZWRDb21wb25lbnRzLmRlZmF1bHQuZGl2LndpdGhDb25maWcoewogIGRpc3BsYXlOYW1lOiAiUmVzdHJpY3RlZFdpZHRoQ29udGFpbmVyIiwKICBjb21wb25lbnRJZDogInNjLTNyZW9rNi0wIgp9KShbIm1heC13aWR0aDozMDBweDsiXSk7Cgp2YXIgc3RlcFNjaGVkdWxlRGVmYXVsdFZhbHVlID0gewogIGludGVydmFsOiAnNW0nLAogIGlzTmV3OiB0cnVlLAogIGZyb206ICcxbScKfTsKCnZhciBTdGVwU2NoZWR1bGVSdWxlQ29tcG9uZW50ID0gZnVuY3Rpb24gU3RlcFNjaGVkdWxlUnVsZUNvbXBvbmVudChfcmVmKSB7CiAgdmFyIF9yZWYkYWRkUGFkZGluZyA9IF9yZWYuYWRkUGFkZGluZywKICAgICAgYWRkUGFkZGluZyA9IF9yZWYkYWRkUGFkZGluZyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmJGFkZFBhZGRpbmcsCiAgICAgIGRlZmF1bHRWYWx1ZXMgPSBfcmVmLmRlZmF1bHRWYWx1ZXMsCiAgICAgIF9yZWYkZGVzY3JpcHRpb25Db2x1bSA9IF9yZWYuZGVzY3JpcHRpb25Db2x1bW5zLAogICAgICBkZXNjcmlwdGlvbkNvbHVtbnMgPSBfcmVmJGRlc2NyaXB0aW9uQ29sdW0gPT09IHZvaWQgMCA/ICdzaW5nbGVTcGxpdCcgOiBfcmVmJGRlc2NyaXB0aW9uQ29sdW0sCiAgICAgIGlzUmVhZE9ubHlWaWV3ID0gX3JlZi5pc1JlYWRPbmx5VmlldywKICAgICAgaXNMb2FkaW5nID0gX3JlZi5pc0xvYWRpbmcsCiAgICAgIF9yZWYkaXNVcGRhdGVWaWV3ID0gX3JlZi5pc1VwZGF0ZVZpZXcsCiAgICAgIGlzVXBkYXRlVmlldyA9IF9yZWYkaXNVcGRhdGVWaWV3ID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYkaXNVcGRhdGVWaWV3LAogICAgICBzZXRTdGVwRGF0YSA9IF9yZWYuc2V0U3RlcERhdGEsCiAgICAgIHNldEZvcm0gPSBfcmVmLnNldEZvcm07CgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShzdGVwU2NoZWR1bGVEZWZhdWx0VmFsdWUpLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgbXlTdGVwRGF0YSA9IF91c2VTdGF0ZTJbMF0sCiAgICAgIHNldE15U3RlcERhdGEgPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgX3VzZUZvcm0gPSAoMCwgX3NoYXJlZF9pbXBvcnRzLnVzZUZvcm0pKHsKICAgIGRlZmF1bHRWYWx1ZTogbXlTdGVwRGF0YSwKICAgIG9wdGlvbnM6IHsKICAgICAgc3RyaXBFbXB0eUZpZWxkczogZmFsc2UKICAgIH0sCiAgICBzY2hlbWE6IF9zY2hlbWEuc2NoZW1hCiAgfSksCiAgICAgIGZvcm0gPSBfdXNlRm9ybS5mb3JtOwoKICB2YXIgb25TdWJtaXQgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKSgKICAvKiNfX1BVUkVfXyovCiAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgLyojX19QVVJFX18qLwogIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICB2YXIgX3JlZjMsIG5ld0lzVmFsaWQsIGRhdGE7CgogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBpZiAoIXNldFN0ZXBEYXRhKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNldFN0ZXBEYXRhKF90eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGUsIG51bGwsIGZhbHNlKTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgIHJldHVybiBmb3JtLnN1Ym1pdCgpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgX3JlZjMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICBuZXdJc1ZhbGlkID0gX3JlZjMuaXNWYWxpZDsKICAgICAgICAgICAgZGF0YSA9IF9yZWYzLmRhdGE7CgogICAgICAgICAgICBpZiAobmV3SXNWYWxpZCkgewogICAgICAgICAgICAgIHNldFN0ZXBEYXRhKF90eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGUsIF9vYmplY3RTcHJlYWQoe30sIGRhdGEpLCBuZXdJc1ZhbGlkKTsKICAgICAgICAgICAgICBzZXRNeVN0ZXBEYXRhKF9vYmplY3RTcHJlYWQoe30sIGRhdGEsIHsKICAgICAgICAgICAgICAgIGlzTmV3OiBmYWxzZQogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgfQoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSksIFtmb3JtXSk7CiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIHZhciBpc05ldyA9IG15U3RlcERhdGEuaXNOZXcsCiAgICAgICAgaW5pdERlZmF1bHRWYWx1ZSA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhteVN0ZXBEYXRhLCBbImlzTmV3Il0pOwoKICAgIGlmIChkZWZhdWx0VmFsdWVzICE9IG51bGwgJiYgISgwLCBfZmFzdERlZXBFcXVhbC5kZWZhdWx0KShpbml0RGVmYXVsdFZhbHVlLCBkZWZhdWx0VmFsdWVzKSkgewogICAgICB2YXIgbXlEZWZhdWx0VmFsdWVzID0gX29iamVjdFNwcmVhZCh7fSwgZGVmYXVsdFZhbHVlcywgewogICAgICAgIGlzTmV3OiBmYWxzZQogICAgICB9KTsKCiAgICAgIHNldE15U3RlcERhdGEobXlEZWZhdWx0VmFsdWVzKTsKICAgICAgKDAsIF9oZWxwZXJzLnNldEZpZWxkVmFsdWUpKGZvcm0sIF9zY2hlbWEuc2NoZW1hLCBteURlZmF1bHRWYWx1ZXMpOwogICAgfQogIH0sIFtkZWZhdWx0VmFsdWVzXSk7CiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIGlmIChzZXRGb3JtICE9IG51bGwpIHsKICAgICAgc2V0Rm9ybShfdHlwZXMuUnVsZVN0ZXAuc2NoZWR1bGVSdWxlLCBmb3JtKTsKICAgIH0KICB9LCBbZm9ybV0pOwogIHJldHVybiBpc1JlYWRPbmx5VmlldyAmJiBteVN0ZXBEYXRhICE9IG51bGwgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zdGVwX2NvbnRlbnRfd3JhcHBlci5TdGVwQ29udGVudFdyYXBwZXIsIHsKICAgIGFkZFBhZGRpbmc6IGFkZFBhZGRpbmcKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9kZXNjcmlwdGlvbl9zdGVwLlN0ZXBSdWxlRGVzY3JpcHRpb24sIHsKICAgIGNvbHVtbnM6IGRlc2NyaXB0aW9uQ29sdW1ucywKICAgIHNjaGVtYTogX3NjaGVtYS5zY2hlbWEsCiAgICBkYXRhOiBteVN0ZXBEYXRhCiAgfSkpIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcF9jb250ZW50X3dyYXBwZXIuU3RlcENvbnRlbnRXcmFwcGVyLCB7CiAgICBhZGRQYWRkaW5nOiAhaXNVcGRhdGVWaWV3CiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2hhcmVkX2ltcG9ydHMuRm9ybSwgewogICAgZm9ybTogZm9ybSwKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJzdGVwU2NoZWR1bGVSdWxlIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoUmVzdHJpY3RlZFdpZHRoQ29udGFpbmVyLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zaGFyZWRfaW1wb3J0cy5Vc2VGaWVsZCwgewogICAgcGF0aDogImludGVydmFsIiwKICAgIGNvbXBvbmVudDogX3NjaGVkdWxlX2l0ZW1fZm9ybS5TY2hlZHVsZUl0ZW0sCiAgICBjb21wb25lbnRQcm9wczogewogICAgICBpZEFyaWE6ICdkZXRlY3Rpb25FbmdpbmVTdGVwU2NoZWR1bGVSdWxlSW50ZXJ2YWwnLAogICAgICBpc0Rpc2FibGVkOiBpc0xvYWRpbmcsCiAgICAgIGRhdGFUZXN0U3ViajogJ2RldGVjdGlvbkVuZ2luZVN0ZXBTY2hlZHVsZVJ1bGVJbnRlcnZhbCcKICAgIH0KICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoUmVzdHJpY3RlZFdpZHRoQ29udGFpbmVyLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zaGFyZWRfaW1wb3J0cy5Vc2VGaWVsZCwgewogICAgcGF0aDogImZyb20iLAogICAgY29tcG9uZW50OiBfc2NoZWR1bGVfaXRlbV9mb3JtLlNjaGVkdWxlSXRlbSwKICAgIGNvbXBvbmVudFByb3BzOiB7CiAgICAgIGlkQXJpYTogJ2RldGVjdGlvbkVuZ2luZVN0ZXBTY2hlZHVsZVJ1bGVGcm9tJywKICAgICAgaXNEaXNhYmxlZDogaXNMb2FkaW5nLAogICAgICBkYXRhVGVzdFN1Ymo6ICdkZXRlY3Rpb25FbmdpbmVTdGVwU2NoZWR1bGVSdWxlRnJvbScsCiAgICAgIG1pbmltdW1WYWx1ZTogMQogICAgfQogIH0pKSkpLCAhaXNVcGRhdGVWaWV3ICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX25leHRfc3RlcC5OZXh0U3RlcCwgewogICAgZGF0YVRlc3RTdWJqOiAic2NoZWR1bGUtY29udGludWUiLAogICAgb25DbGljazogb25TdWJtaXQsCiAgICBpc0Rpc2FibGVkOiBpc0xvYWRpbmcKICB9KSk7Cn07Cgp2YXIgU3RlcFNjaGVkdWxlUnVsZSA9ICgwLCBfcmVhY3QubWVtbykoU3RlcFNjaGVkdWxlUnVsZUNvbXBvbmVudCk7CmV4cG9ydHMuU3RlcFNjaGVkdWxlUnVsZSA9IFN0ZXBTY2hlZHVsZVJ1bGU7"},null]}