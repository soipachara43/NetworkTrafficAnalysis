{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/vis_type_vislib/public/vislib/lib/data.js","dependencies":[{"path":"src/legacy/core_plugins/vis_type_vislib/public/vislib/lib/data.js","mtime":1589249550142},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkRhdGEgPSB2b2lkIDA7Cgp2YXIgX2QgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImQzIikpOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfaW5qZWN0X3plcm9zID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy96ZXJvX2luamVjdGlvbi9pbmplY3RfemVyb3MiKTsKCnZhciBfb3JkZXJlZF94X2tleXMgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL3plcm9faW5qZWN0aW9uL29yZGVyZWRfeF9rZXlzIik7Cgp2YXIgX2xhYmVscyA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvbGFiZWxzL2xhYmVscyIpOwoKdmFyIF9sZWdhY3lfaW1wb3J0cyA9IHJlcXVpcmUoIi4uLy4uL2xlZ2FjeV9pbXBvcnRzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0gfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKLy8gWCBheGlzIGFuZCBzcGxpdCBzZXJpZXMgdmFsdWVzIGluIGEgZGF0YSB0YWJsZSBjYW4gc29tZXRpbWVzIGJlIG9iamVjdHMsCi8vIGUuZy4gd2hlbiB3b3JraW5nIHdpdGggZGF0ZSByYW5nZXMuIGQzIGNhc3RzIGFsbCBvcmRpbmFsIHZhbHVlcyB0byBzdHJpbmdzCi8vIHdoaWNoIGlzIGEgcHJvYmxlbSBmb3IgdGhlc2Ugb2JqZWN0cyBiZWNhdXNlIHRoZXkganVzdCByZXR1cm4gYFtvYmplY3QgT2JqZWN0XWAKLy8gYW5kIHRodXMgYWxsIG1hcCB0byB0aGUgc2FtZSB2YWx1ZS4KLy8gVGhpcyBsaXR0bGUgaGVscGVyIG92ZXJ3cml0ZXMgdGhlIHRvU3RyaW5nIG1ldGhvZCBvZiBhbiBvYmplY3QgYW5kIGtlZXBzIGl0IHRoZQovLyBzYW1lIG90aGVyd2lzZSAtIGFsbG93aW5nIGQzIHRvIGNvcnJlY3RseSB3b3JrIHdpdGggdGhlIHZhbHVlcy4KdmFyIEQzTWFwcGFibGVPYmplY3QgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBEM01hcHBhYmxlT2JqZWN0KGRhdGEpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEM01hcHBhYmxlT2JqZWN0KTsKCiAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkgewogICAgICBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgICAgdGhpc1trZXldID0gZGF0YVtrZXldOwogICAgICB9CiAgICB9CiAgfQoKICBfY3JlYXRlQ2xhc3MoRDNNYXBwYWJsZU9iamVjdCwgW3sKICAgIGtleTogInRvU3RyaW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b1N0cmluZygpIHsKICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEQzTWFwcGFibGVPYmplY3Q7Cn0oKTsKLyoqCiAqIFByb3ZpZGVzIGFuIEFQSSBmb3IgcHVsbGluZyB2YWx1ZXMgb2ZmIHRoZSBkYXRhCiAqIGFuZCBjYWxjdWxhdGluZyB2YWx1ZXMgdXNpbmcgdGhlIGRhdGEKICoKICogQGNsYXNzIERhdGEKICogQGNvbnN0cnVjdG9yCiAqIEBwYXJhbSBkYXRhIHtPYmplY3R9IEVsYXN0aWNzZWFyY2ggcXVlcnkgcmVzdWx0cwogKiBAcGFyYW0gYXR0ciB7T2JqZWN0fCp9IFZpc3VhbGl6YXRpb24gb3B0aW9ucwogKi8KCgp2YXIgRGF0YSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIERhdGEoZGF0YSwgdWlTdGF0ZSwgY3JlYXRlQ29sb3JMb29rdXBGdW5jdGlvbikgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERhdGEpOwoKICAgIHRoaXMudWlTdGF0ZSA9IHVpU3RhdGU7CiAgICB0aGlzLmNyZWF0ZUNvbG9yTG9va3VwRnVuY3Rpb24gPSBjcmVhdGVDb2xvckxvb2t1cEZ1bmN0aW9uOwogICAgdGhpcy5kYXRhID0gdGhpcy5jb3B5RGF0YU9iaihkYXRhKTsKICAgIHRoaXMudHlwZSA9IHRoaXMuZ2V0RGF0YVR5cGUoKTsKCiAgICB0aGlzLl9jbGVhblZpc0RhdGEoKTsKCiAgICB0aGlzLmxhYmVscyA9IHRoaXMuX2dldExhYmVscyh0aGlzLmRhdGEpOwogICAgdGhpcy5jb2xvciA9IHRoaXMubGFiZWxzID8gY3JlYXRlQ29sb3JMb29rdXBGdW5jdGlvbih0aGlzLmxhYmVscywgdWlTdGF0ZS5nZXQoJ3Zpcy5jb2xvcnMnKSkgOiB1bmRlZmluZWQ7CgogICAgdGhpcy5fbm9ybWFsaXplT3JkZXJlZCgpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKERhdGEsIFt7CiAgICBrZXk6ICJjb3B5RGF0YU9iaiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29weURhdGFPYmooZGF0YSkgewogICAgICB2YXIgY29weUNoYXJ0ID0gZnVuY3Rpb24gY29weUNoYXJ0KGRhdGEpIHsKICAgICAgICB2YXIgbmV3RGF0YSA9IHt9OwogICAgICAgIE9iamVjdC5rZXlzKGRhdGEpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgaWYgKGtleSA9PT0gJ3hBeGlzT3JkZXJlZFZhbHVlcycpIHsKICAgICAgICAgICAgbmV3RGF0YVtrZXldID0gZGF0YVtrZXldLm1hcChmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICAgICAgaWYgKF90eXBlb2YodmFsKSA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRDNNYXBwYWJsZU9iamVjdCh2YWwpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ3NlcmllcycpIHsKICAgICAgICAgICAgbmV3RGF0YVtrZXldID0gZGF0YVtrZXldLm1hcChmdW5jdGlvbiAoc2VyaSkgewogICAgICAgICAgICAgIHZhciBjb252ZXJ0ZXIgPSAoMCwgX2xlZ2FjeV9pbXBvcnRzLmdldEZvcm1hdCkoc2VyaS5mb3JtYXQpOwogICAgICAgICAgICAgIHZhciB6Q29udmVydGVyID0gKDAsIF9sZWdhY3lfaW1wb3J0cy5nZXRGb3JtYXQpKHNlcmkuekZvcm1hdCk7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGlkOiBzZXJpLmlkLAogICAgICAgICAgICAgICAgcmF3SWQ6IHNlcmkucmF3SWQsCiAgICAgICAgICAgICAgICBsYWJlbDogc2VyaS5sYWJlbCwKICAgICAgICAgICAgICAgIHpMYWJlbDogc2VyaS56TGFiZWwsCiAgICAgICAgICAgICAgICB2YWx1ZXM6IHNlcmkudmFsdWVzLm1hcChmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICAgICAgICAgIHZhciBuZXdWYWwgPSBfbG9kYXNoLmRlZmF1bHQuY2xvbmUodmFsKTsKCiAgICAgICAgICAgICAgICAgIG5ld1ZhbC5leHRyYU1ldHJpY3MgPSB2YWwuZXh0cmFNZXRyaWNzOwogICAgICAgICAgICAgICAgICBuZXdWYWwuc2VyaWVzID0gdmFsLnNlcmllcyB8fCBzZXJpLmxhYmVsOwoKICAgICAgICAgICAgICAgICAgaWYgKF90eXBlb2YobmV3VmFsLngpID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgICAgIG5ld1ZhbC54ID0gbmV3IEQzTWFwcGFibGVPYmplY3QobmV3VmFsLngpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICByZXR1cm4gbmV3VmFsOwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB5QXhpc0Zvcm1hdHRlcjogZnVuY3Rpb24geUF4aXNGb3JtYXR0ZXIodmFsKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBjb252ZXJ0ZXIuY29udmVydCh2YWwpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHpBeGlzRm9ybWF0dGVyOiBmdW5jdGlvbiB6QXhpc0Zvcm1hdHRlcih2YWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHpDb252ZXJ0ZXIuY29udmVydCh2YWwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3RGF0YVtrZXldID0gZGF0YVtrZXldOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHZhciB4Q29udmVydGVyID0gKDAsIF9sZWdhY3lfaW1wb3J0cy5nZXRGb3JtYXQpKG5ld0RhdGEueEF4aXNGb3JtYXQpOwogICAgICAgIHZhciB5Q29udmVydGVyID0gKDAsIF9sZWdhY3lfaW1wb3J0cy5nZXRGb3JtYXQpKG5ld0RhdGEueUF4aXNGb3JtYXQpOwogICAgICAgIHZhciB6Q29udmVydGVyID0gKDAsIF9sZWdhY3lfaW1wb3J0cy5nZXRGb3JtYXQpKG5ld0RhdGEuekF4aXNGb3JtYXQpOwoKICAgICAgICBuZXdEYXRhLnhBeGlzRm9ybWF0dGVyID0gZnVuY3Rpb24gKHZhbCkgewogICAgICAgICAgcmV0dXJuIHhDb252ZXJ0ZXIuY29udmVydCh2YWwpOwogICAgICAgIH07CgogICAgICAgIG5ld0RhdGEueUF4aXNGb3JtYXR0ZXIgPSBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICByZXR1cm4geUNvbnZlcnRlci5jb252ZXJ0KHZhbCk7CiAgICAgICAgfTsKCiAgICAgICAgbmV3RGF0YS56QXhpc0Zvcm1hdHRlciA9IGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgIHJldHVybiB6Q29udmVydGVyLmNvbnZlcnQodmFsKTsKICAgICAgICB9OwoKICAgICAgICByZXR1cm4gbmV3RGF0YTsKICAgICAgfTsKCiAgICAgIGlmICghZGF0YS5zZXJpZXMpIHsKICAgICAgICB2YXIgbmV3RGF0YSA9IHt9OwogICAgICAgIE9iamVjdC5rZXlzKGRhdGEpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgaWYgKCFbJ3Jvd3MnLCAnY29sdW1ucyddLmluY2x1ZGVzKGtleSkpIHsKICAgICAgICAgICAgbmV3RGF0YVtrZXldID0gZGF0YVtrZXldOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3RGF0YVtrZXldID0gZGF0YVtrZXldLm1hcChmdW5jdGlvbiAoY2hhcnQpIHsKICAgICAgICAgICAgICByZXR1cm4gY29weUNoYXJ0KGNoYXJ0KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIG5ld0RhdGE7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb3B5Q2hhcnQoZGF0YSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2dldExhYmVscyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2dldExhYmVscyhkYXRhKSB7CiAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdzZXJpZXMnKSB7CiAgICAgICAgcmV0dXJuICgwLCBfbGFiZWxzLmxhYmVscykoZGF0YSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBbXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXREYXRhVHlwZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF0YVR5cGUoKSB7CiAgICAgIHZhciBkYXRhID0gdGhpcy5nZXRWaXNEYXRhKCk7CiAgICAgIHZhciB0eXBlOwogICAgICBkYXRhLmZvckVhY2goZnVuY3Rpb24gKG9iaikgewogICAgICAgIGlmIChvYmouc2VyaWVzKSB7CiAgICAgICAgICB0eXBlID0gJ3Nlcmllcyc7CiAgICAgICAgfSBlbHNlIGlmIChvYmouc2xpY2VzKSB7CiAgICAgICAgICB0eXBlID0gJ3NsaWNlcyc7CiAgICAgICAgfSBlbHNlIGlmIChvYmouZ2VvSnNvbikgewogICAgICAgICAgdHlwZSA9ICdnZW9Kc29uJzsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gdHlwZTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbiBhcnJheSBvZiB0aGUgYWN0dWFsIHggYW5kIHkgZGF0YSB2YWx1ZSBvYmplY3RzCiAgICAgKiBmcm9tIGRhdGEgd2l0aCBzZXJpZXMga2V5cwogICAgICoKICAgICAqIEBtZXRob2QgY2hhcnREYXRhCiAgICAgKiBAcmV0dXJucyB7Kn0gQXJyYXkgb2YgZGF0YSBvYmplY3RzCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiY2hhcnREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjaGFydERhdGEoKSB7CiAgICAgIGlmICghdGhpcy5kYXRhLnNlcmllcykgewogICAgICAgIHZhciBhcnIgPSB0aGlzLmRhdGEucm93cyA/IHRoaXMuZGF0YS5yb3dzIDogdGhpcy5kYXRhLmNvbHVtbnM7CiAgICAgICAgcmV0dXJuIF9sb2Rhc2guZGVmYXVsdC50b0FycmF5KGFycik7CiAgICAgIH0KCiAgICAgIHJldHVybiBbdGhpcy5kYXRhXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzaG91bGRCZVN0YWNrZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNob3VsZEJlU3RhY2tlZChzZXJpZXNDb25maWcpIHsKICAgICAgaWYgKCFzZXJpZXNDb25maWcpIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHNlcmllc0NvbmZpZy5tb2RlID09PSAnc3RhY2tlZCc7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0U3RhY2tlZFNlcmllcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U3RhY2tlZFNlcmllcyhjaGFydENvbmZpZywgYXhpcywgc2VyaWVzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZmlyc3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgbWF0Y2hpbmdTZXJpZXMgPSBbXTsKICAgICAgY2hhcnRDb25maWcuc2VyaWVzLmZvckVhY2goZnVuY3Rpb24gKHNlcmlBcmdzLCBpKSB7CiAgICAgICAgdmFyIG1hdGNoaW5nQXhpcyA9IHNlcmlBcmdzLnZhbHVlQXhpcyA9PT0gYXhpcy5heGlzQ29uZmlnLmdldCgnaWQnKSB8fCAhc2VyaUFyZ3MudmFsdWVBeGlzICYmIGZpcnN0OwoKICAgICAgICBpZiAobWF0Y2hpbmdBeGlzICYmIChfdGhpcy5zaG91bGRCZVN0YWNrZWQoc2VyaUFyZ3MpIHx8IGF4aXMuYXhpc0NvbmZpZy5nZXQoJ3NjYWxlLnN0YWNrZWQnKSkpIHsKICAgICAgICAgIG1hdGNoaW5nU2VyaWVzLnB1c2goc2VyaWVzW2ldKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gbWF0Y2hpbmdTZXJpZXM7CiAgICB9CiAgfSwgewogICAga2V5OiAic3RhY2tDaGFydERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN0YWNrQ2hhcnREYXRhKGhhbmRsZXIsIGRhdGEsIGNoYXJ0Q29uZmlnKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIHN0YWNrZWREYXRhID0ge307CiAgICAgIGhhbmRsZXIudmFsdWVBeGVzLmZvckVhY2goZnVuY3Rpb24gKGF4aXMsIGkpIHsKICAgICAgICB2YXIgaWQgPSBheGlzLmF4aXNDb25maWcuZ2V0KCdpZCcpOwogICAgICAgIHN0YWNrZWREYXRhW2lkXSA9IF90aGlzMi5nZXRTdGFja2VkU2VyaWVzKGNoYXJ0Q29uZmlnLCBheGlzLCBkYXRhLCBpID09PSAwKTsKICAgICAgICBzdGFja2VkRGF0YVtpZF0gPSBfdGhpczIuaW5qZWN0WmVyb3Moc3RhY2tlZERhdGFbaWRdLCBoYW5kbGVyLnZpc0NvbmZpZy5nZXQoJ29yZGVyQnVja2V0c0J5U3VtJywgZmFsc2UpKTsKICAgICAgICBheGlzLmF4aXNDb25maWcuc2V0KCdzdGFja2VkU2VyaWVzJywgc3RhY2tlZERhdGFbaWRdLmxlbmd0aCk7CiAgICAgICAgYXhpcy5zdGFjayhfbG9kYXNoLmRlZmF1bHQubWFwKHN0YWNrZWREYXRhW2lkXSwgJ3ZhbHVlcycpKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBzdGFja2VkRGF0YTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdGFja0RhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN0YWNrRGF0YShoYW5kbGVyKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7CgogICAgICBpZiAoZGF0YS5yb3dzIHx8IGRhdGEuY29sdW1ucykgewogICAgICAgIHZhciBjaGFydHMgPSBkYXRhLnJvd3MgPyBkYXRhLnJvd3MgOiBkYXRhLmNvbHVtbnM7CiAgICAgICAgY2hhcnRzLmZvckVhY2goZnVuY3Rpb24gKGNoYXJ0LCBpKSB7CiAgICAgICAgICBfdGhpczMuc3RhY2tDaGFydERhdGEoaGFuZGxlciwgY2hhcnQuc2VyaWVzLCBoYW5kbGVyLnZpc0NvbmZpZy5nZXQoImNoYXJ0c1siLmNvbmNhdChpLCAiXSIpKSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zdGFja0NoYXJ0RGF0YShoYW5kbGVyLCBkYXRhLnNlcmllcywgaGFuZGxlci52aXNDb25maWcuZ2V0KCdjaGFydHNbMF0nKSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbiBhcnJheSBvZiBjaGFydCBkYXRhIG9iamVjdHMKICAgICAqCiAgICAgKiBAbWV0aG9kIGdldFZpc0RhdGEKICAgICAqIEByZXR1cm5zIHsqfSBBcnJheSBvZiBjaGFydCBkYXRhIG9iamVjdHMKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRWaXNEYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRWaXNEYXRhKCkgewogICAgICB2YXIgdmlzRGF0YTsKCiAgICAgIGlmICh0aGlzLmRhdGEucm93cykgewogICAgICAgIHZpc0RhdGEgPSB0aGlzLmRhdGEucm93czsKICAgICAgfSBlbHNlIGlmICh0aGlzLmRhdGEuY29sdW1ucykgewogICAgICAgIHZpc0RhdGEgPSB0aGlzLmRhdGEuY29sdW1uczsKICAgICAgfSBlbHNlIHsKICAgICAgICB2aXNEYXRhID0gW3RoaXMuZGF0YV07CiAgICAgIH0KCiAgICAgIHJldHVybiB2aXNEYXRhOwogICAgfQogICAgLyoqCiAgICAgKiBnZXQgbWluIGFuZCBtYXggZm9yIGFsbCBjb2xzLCByb3dzIG9mIGRhdGEKICAgICAqCiAgICAgKiBAbWV0aG9kIGdldE1heE1pbgogICAgICogQHJldHVybiB7T2JqZWN0fQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldEdlb0V4dGVudHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEdlb0V4dGVudHMoKSB7CiAgICAgIHZhciB2aXNEYXRhID0gdGhpcy5nZXRWaXNEYXRhKCk7CiAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQucmVkdWNlKF9sb2Rhc2guZGVmYXVsdC5wbHVjayh2aXNEYXRhLCAnZ2VvSnNvbi5wcm9wZXJ0aWVzJyksIGZ1bmN0aW9uIChtaW5NYXgsIHByb3BzKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIG1pbjogTWF0aC5taW4ocHJvcHMubWluLCBtaW5NYXgubWluKSwKICAgICAgICAgIG1heDogTWF0aC5tYXgocHJvcHMubWF4LCBtaW5NYXgubWF4KQogICAgICAgIH07CiAgICAgIH0sIHsKICAgICAgICBtaW46IEluZmluaXR5LAogICAgICAgIG1heDogLUluZmluaXR5CiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFycmF5IG9mIGNoYXJ0IGRhdGEgb2JqZWN0cyBmb3IgcGllIGRhdGEgb2JqZWN0cwogICAgICoKICAgICAqIEBtZXRob2QgcGllRGF0YQogICAgICogQHJldHVybnMgeyp9IEFycmF5IG9mIGNoYXJ0IGRhdGEgb2JqZWN0cwogICAgICovCgogIH0sIHsKICAgIGtleTogInBpZURhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBpZURhdGEoKSB7CiAgICAgIGlmICghdGhpcy5kYXRhLnNsaWNlcykgewogICAgICAgIHJldHVybiB0aGlzLmRhdGEucm93cyA/IHRoaXMuZGF0YS5yb3dzIDogdGhpcy5kYXRhLmNvbHVtbnM7CiAgICAgIH0KCiAgICAgIHJldHVybiBbdGhpcy5kYXRhXTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGF0dHJpYnV0ZXMgb2ZmIHRoZSBkYXRhLCBlLmcuIGB0b29sdGlwRm9ybWF0dGVyYCBvciBgeEF4aXNGb3JtYXR0ZXJgCiAgICAgKiBwdWxscyB0aGUgdmFsdWUgb2ZmIHRoZSBmaXJzdCBpdGVtIGluIHRoZSBhcnJheQogICAgICogdGhlc2UgdmFsdWVzIGFyZSB0eXBpY2FsbHkgdGhlIHNhbWUgYmV0d2VlbiBkYXRhIG9iamVjdHMgb2YgdGhlIHNhbWUgY2hhcnQKICAgICAqIFRPRE86IE1heSBuZWVkIHRvIHZlcmlmeSB0aGlzIG9yIHJlZmFjdG9yCiAgICAgKgogICAgICogQG1ldGhvZCBnZXQKICAgICAqIEBwYXJhbSB0aGluZyB7U3RyaW5nfSBEYXRhIG9iamVjdCBrZXkKICAgICAqIEByZXR1cm5zIHsqfSBEYXRhIG9iamVjdCB2YWx1ZQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0KHRoaW5nLCBkZWYpIHsKICAgICAgdmFyIHNvdXJjZSA9ICh0aGlzLmRhdGEucm93cyB8fCB0aGlzLmRhdGEuY29sdW1ucyB8fCBbdGhpcy5kYXRhXSlbMF07CiAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuZ2V0KHNvdXJjZSwgdGhpbmcsIGRlZik7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiBudWxsIHZhbHVlcyBhcmUgcHJlc2VudAogICAgICogQHJldHVybnMgeyp9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaGFzTnVsbFZhbHVlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzTnVsbFZhbHVlcygpIHsKICAgICAgdmFyIGNoYXJ0RGF0YSA9IHRoaXMuY2hhcnREYXRhKCk7CiAgICAgIHJldHVybiBjaGFydERhdGEuc29tZShmdW5jdGlvbiAoY2hhcnQpIHsKICAgICAgICByZXR1cm4gY2hhcnQuc2VyaWVzLnNvbWUoZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgcmV0dXJuIG9iai52YWx1ZXMuc29tZShmdW5jdGlvbiAoZCkgewogICAgICAgICAgICByZXR1cm4gZC55ID09PSBudWxsOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgb2YgYWxsIHZhbHVlIG9iamVjdHMKICAgICAqIFBsdWNrIHRoZSBkYXRhLnNlcmllcyBhcnJheSBmcm9tIGVhY2ggZGF0YSBvYmplY3QKICAgICAqIENyZWF0ZSBhbiBhcnJheSBvZiBhbGwgdGhlIHZhbHVlIG9iamVjdHMgZnJvbSB0aGUgc2VyaWVzIGFycmF5CiAgICAgKgogICAgICogQG1ldGhvZCBmbGF0dGVuCiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFZhbHVlIG9iamVjdHMKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJmbGF0dGVuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmbGF0dGVuKCkgewogICAgICByZXR1cm4gKDAsIF9sb2Rhc2guZGVmYXVsdCkodGhpcy5jaGFydERhdGEoKSkucGx1Y2soJ3NlcmllcycpLmZsYXR0ZW5EZWVwKCkucGx1Y2soJ3ZhbHVlcycpLmZsYXR0ZW5EZWVwKCkudmFsdWUoKTsKICAgIH0KICAgIC8qKgogICAgICogVmFsaWRhdGVzIHRoYXQgdGhlIFkgYXhpcyBtaW4gdmFsdWUgZGVmaW5lZCBieSB1c2VyIGlucHV0CiAgICAgKiBpcyBhIG51bWJlci4KICAgICAqCiAgICAgKiBAcGFyYW0gdmFsIHtOdW1iZXJ9IFkgYXhpcyBtaW4gdmFsdWUKICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IFkgYXhpcyBtaW4gdmFsdWUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJ2YWxpZGF0ZVVzZXJEZWZpbmVkWU1pbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdmFsaWRhdGVVc2VyRGVmaW5lZFlNaW4odmFsKSB7CiAgICAgIGlmICghX2xvZGFzaC5kZWZhdWx0LmlzTnVtYmVyKHZhbCkpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3ZhbGlkYXRlVXNlckRlZmluZWRZTWluIGV4cGVjdHMgYSBudW1iZXInKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbDsKICAgIH0KICAgIC8qKgogICAgICogSGVscGVyIGZ1bmN0aW9uIGZvciBnZXROYW1lcwogICAgICogUmV0dXJucyBhbiBhcnJheSBvZiBvYmplY3RzIHdpdGggYSBuYW1lIChrZXkpIHZhbHVlIGFuZCBhbiBpbmRleCB2YWx1ZS4KICAgICAqIFRoZSBpbmRleCB2YWx1ZSBhbGxvd3MgdXMgdG8gc29ydCB0aGUgbmFtZXMgaW4gdGhlIGNvcnJlY3QgbmVzdGVkIG9yZGVyLgogICAgICoKICAgICAqIEBtZXRob2QgcmV0dXJuTmFtZXMKICAgICAqIEBwYXJhbSBhcnJheSB7QXJyYXl9IEFycmF5IG9mIGRhdGEgb2JqZWN0cwogICAgICogQHBhcmFtIGluZGV4IHtOdW1iZXJ9IE51bWJlciBvZiB0aW1lcyB0aGUgb2JqZWN0IGlzIG5lc3RlZAogICAgICogQHBhcmFtIGNvbHVtbnMge09iamVjdH0gQ29udGFpbnMgbmFtZSBmb3JtYXR0ZXIgaW5mb3JtYXRpb24KICAgICAqIEByZXR1cm5zIHtBcnJheX0gQXJyYXkgb2YgbGFiZWxzIChzdHJpbmdzKQogICAgICovCgogIH0sIHsKICAgIGtleTogInJldHVybk5hbWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXR1cm5OYW1lcyhhcnJheSwgaW5kZXgsIGNvbHVtbnMpIHsKICAgICAgdmFyIG5hbWVzID0gW107CiAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgIF9sb2Rhc2guZGVmYXVsdC5mb3JFYWNoKGFycmF5LCBmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgbmFtZXMucHVzaCh7CiAgICAgICAgICBsYWJlbDogb2JqLm5hbWUsCiAgICAgICAgICB2YWx1ZXM6IFtvYmoucmF3RGF0YV0sCiAgICAgICAgICBpbmRleDogaW5kZXgKICAgICAgICB9KTsKCiAgICAgICAgaWYgKG9iai5jaGlsZHJlbikgewogICAgICAgICAgdmFyIHBsdXNJbmRleCA9IGluZGV4ICsgMTsKCiAgICAgICAgICBfbG9kYXNoLmRlZmF1bHQuZm9yRWFjaChzZWxmLnJldHVybk5hbWVzKG9iai5jaGlsZHJlbiwgcGx1c0luZGV4LCBjb2x1bW5zKSwgZnVuY3Rpb24gKG5hbWVkT2JqKSB7CiAgICAgICAgICAgIG5hbWVzLnB1c2gobmFtZWRPYmopOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHJldHVybiBuYW1lczsKICAgIH0KICAgIC8qKgogICAgICogRmxhdHRlbnMgaGllcmFyY2hpY2FsIGRhdGEgaW50byBhbiBhcnJheSBvZiBvYmplY3RzIHdpdGggYSBuYW1lIGFuZCBpbmRleCB2YWx1ZS4KICAgICAqIFRoZSBpbmRleGVkIHZhbHVlIGRldGVybWluZXMgdGhlIG9yZGVyIG9mIG5lc3RpbmcgaW4gdGhlIGRhdGEuCiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IHdpdGggbmFtZXMgc29ydGVkIGJ5IHRoZSBpbmRleCB2YWx1ZS4KICAgICAqCiAgICAgKiBAbWV0aG9kIGdldE5hbWVzCiAgICAgKiBAcGFyYW0gZGF0YSB7T2JqZWN0fSBDaGFydCBkYXRhIG9iamVjdAogICAgICogQHBhcmFtIGNvbHVtbnMge09iamVjdH0gQ29udGFpbnMgZm9ybWF0dGVyIGluZm9ybWF0aW9uCiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IEFycmF5IG9mIG5hbWVzIChzdHJpbmdzKQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldE5hbWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROYW1lcyhkYXRhLCBjb2x1bW5zKSB7CiAgICAgIHZhciBzbGljZXMgPSBkYXRhLnNsaWNlczsKCiAgICAgIGlmIChzbGljZXMuY2hpbGRyZW4pIHsKICAgICAgICB2YXIgbmFtZWRPYmogPSB0aGlzLnJldHVybk5hbWVzKHNsaWNlcy5jaGlsZHJlbiwgMCwgY29sdW1ucyk7CiAgICAgICAgcmV0dXJuICgwLCBfbG9kYXNoLmRlZmF1bHQpKG5hbWVkT2JqKS5zb3J0QnkoZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgcmV0dXJuIG9iai5pbmRleDsKICAgICAgICB9KS51bmlxdWUoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgIHJldHVybiBkLmxhYmVsOwogICAgICAgIH0pLnZhbHVlKCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2xlYW4gdmlzdWFsaXphdGlvbiBkYXRhIGZyb20gbWlzc2luZy93cm9uZyB2YWx1ZXMuCiAgICAgKiBDdXJyZW50bHkgdXNlZCBvbmx5IHRvIGNsZWFuIHJlbW92ZSB6ZXJvIHNsaWNlcyBmcm9tCiAgICAgKiBwaWUgY2hhcnQuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX2NsZWFuVmlzRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NsZWFuVmlzRGF0YSgpIHsKICAgICAgdmFyIHZpc0RhdGEgPSB0aGlzLmdldFZpc0RhdGEoKTsKCiAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdzbGljZXMnKSB7CiAgICAgICAgdGhpcy5fY2xlYW5QaWVDaGFydERhdGEodmlzRGF0YSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogTXV0YXRlIHRoZSBjdXJyZW50IHBpZSBjaGFydCB2aXMgZGF0YSB0byByZW1vdmUgc2xpY2VzIHdpdGgKICAgICAqIHplcm8gdmFsdWVzLgogICAgICogQHBhcmFtIHtBcnJheX0gZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9jbGVhblBpZUNoYXJ0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NsZWFuUGllQ2hhcnREYXRhKGRhdGEpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICBfbG9kYXNoLmRlZmF1bHQuZm9yRWFjaChkYXRhLCBmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgb2JqLnNsaWNlcyA9IF90aGlzNC5fcmVtb3ZlWmVyb1NsaWNlcyhvYmouc2xpY2VzKTsKICAgICAgfSk7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgemVyb3MgZnJvbSBwaWUgY2hhcnQgZGF0YSwgbXV0YXRpbmcgdGhlIHBhc3NlZCB2YWx1ZXMuCiAgICAgKiBAcGFyYW0gc2xpY2VzCiAgICAgKiBAcmV0dXJucyB7Kn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfcmVtb3ZlWmVyb1NsaWNlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbW92ZVplcm9TbGljZXMoc2xpY2VzKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgaWYgKCFzbGljZXMuY2hpbGRyZW4pIHsKICAgICAgICByZXR1cm4gc2xpY2VzOwogICAgICB9CgogICAgICBzbGljZXMgPSBfbG9kYXNoLmRlZmF1bHQuY2xvbmUoc2xpY2VzKTsKICAgICAgc2xpY2VzLmNoaWxkcmVuID0gc2xpY2VzLmNoaWxkcmVuLnJlZHVjZShmdW5jdGlvbiAoY2hpbGRyZW4sIGNoaWxkKSB7CiAgICAgICAgaWYgKGNoaWxkLnNpemUgIT09IDApIHsKICAgICAgICAgIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGNoaWxkcmVuKSwgW190aGlzNS5fcmVtb3ZlWmVyb1NsaWNlcyhjaGlsZCldKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBjaGlsZHJlbjsKICAgICAgfSwgW10pOwogICAgICByZXR1cm4gc2xpY2VzOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIG5hbWVzIG9yZGVyZWQgYnkgYXBwZWFyYW5jZSBpbiB0aGUgbmVzdGVkIGFycmF5CiAgICAgKiBvZiBvYmplY3RzCiAgICAgKgogICAgICogQG1ldGhvZCBwaWVOYW1lcwogICAgICogQHJldHVybnMge0FycmF5fSBBcnJheSBvZiB1bmlxdWUgbmFtZXMgKHN0cmluZ3MpCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicGllTmFtZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBpZU5hbWVzKGRhdGEpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgbmFtZXMgPSBbXTsKCiAgICAgIF9sb2Rhc2guZGVmYXVsdC5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uIChvYmopIHsKICAgICAgICB2YXIgY29sdW1ucyA9IG9iai5yYXcgPyBvYmoucmF3LmNvbHVtbnMgOiB1bmRlZmluZWQ7CgogICAgICAgIF9sb2Rhc2guZGVmYXVsdC5mb3JFYWNoKHNlbGYuZ2V0TmFtZXMob2JqLCBjb2x1bW5zKSwgZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICAgIG5hbWVzLnB1c2gobmFtZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIF9sb2Rhc2guZGVmYXVsdC51bmlxKG5hbWVzLCAnbGFiZWwnKTsKICAgIH0KICAgIC8qKgogICAgICogSW5qZWN0IHplcm9zIGludG8gdGhlIGRhdGEKICAgICAqCiAgICAgKiBAbWV0aG9kIGluamVjdFplcm9zCiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBEYXRhIG9iamVjdCB3aXRoIHplcm9zIGluamVjdGVkCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaW5qZWN0WmVyb3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluamVjdFplcm9zKGRhdGEpIHsKICAgICAgdmFyIG9yZGVyQnVja2V0c0J5U3VtID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAgICAgcmV0dXJuICgwLCBfaW5qZWN0X3plcm9zLmluamVjdFplcm9zKShkYXRhLCB0aGlzLmRhdGEsIG9yZGVyQnVja2V0c0J5U3VtKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbiBhcnJheSBvZiBhbGwgeCBheGlzIHZhbHVlcyBmcm9tIHRoZSBkYXRhCiAgICAgKgogICAgICogQG1ldGhvZCB4VmFsdWVzCiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IEFycmF5IG9mIHggYXhpcyB2YWx1ZXMKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJ4VmFsdWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB4VmFsdWVzKCkgewogICAgICB2YXIgb3JkZXJCdWNrZXRzQnlTdW0gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgICByZXR1cm4gKDAsIF9vcmRlcmVkX3hfa2V5cy5vcmRlclhWYWx1ZXMpKHRoaXMuZGF0YSwgb3JkZXJCdWNrZXRzQnlTdW0pOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgb2YgdW5pcXVlIGxhYmVscwogICAgICogQ3VycmVudGx5LCBvbmx5IHVzZWQgZm9yIHZlcnRpY2FsIGJhciBhbmQgbGluZSBjaGFydHMsCiAgICAgKiBvciBhbnkgZGF0YSBvYmplY3Qgd2l0aCBzZXJpZXMgdmFsdWVzCiAgICAgKgogICAgICogQG1ldGhvZCBnZXRMYWJlbHMKICAgICAqIEByZXR1cm5zIHtBcnJheX0gQXJyYXkgb2YgbGFiZWxzIChzdHJpbmdzKQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldExhYmVscyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TGFiZWxzKCkgewogICAgICByZXR1cm4gKDAsIF9sYWJlbHMubGFiZWxzKSh0aGlzLmRhdGEpOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBkb2VzIGNvbG9yIGxvb2t1cCBvbiBsYWJlbHMKICAgICAqCiAgICAgKiBAbWV0aG9kIGdldENvbG9yRnVuYwogICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBQZXJmb3JtcyBsb29rdXAgb24gc3RyaW5nIGFuZCByZXR1cm5zIGhleCBjb2xvcgogICAgICovCgogIH0sIHsKICAgIGtleTogImdldENvbG9yRnVuYyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29sb3JGdW5jKCkgewogICAgICBpZiAodGhpcy50eXBlID09PSAnc2xpY2VzJykgewogICAgICAgIHJldHVybiB0aGlzLmdldFBpZUNvbG9yRnVuYygpOwogICAgICB9CgogICAgICB2YXIgZGVmYXVsdENvbG9ycyA9IHRoaXMudWlTdGF0ZS5nZXQoJ3Zpcy5kZWZhdWx0Q29sb3JzJyk7CiAgICAgIHZhciBvdmVyd3JpdGVDb2xvcnMgPSB0aGlzLnVpU3RhdGUuZ2V0KCd2aXMuY29sb3JzJyk7CiAgICAgIHZhciBjb2xvcnMgPSBkZWZhdWx0Q29sb3JzID8gX2xvZGFzaC5kZWZhdWx0LmRlZmF1bHRzKHt9LCBvdmVyd3JpdGVDb2xvcnMsIGRlZmF1bHRDb2xvcnMpIDogb3ZlcndyaXRlQ29sb3JzOwogICAgICByZXR1cm4gdGhpcy5jcmVhdGVDb2xvckxvb2t1cEZ1bmN0aW9uKHRoaXMuZ2V0TGFiZWxzKCksIGNvbG9ycyk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGRvZXMgY29sb3IgbG9va3VwIG9uIG5hbWVzIGZvciBwaWUgY2hhcnRzCiAgICAgKgogICAgICogQG1ldGhvZCBnZXRQaWVDb2xvckZ1bmMKICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUGVyZm9ybXMgbG9va3VwIG9uIHN0cmluZyBhbmQgcmV0dXJucyBoZXggY29sb3IKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRQaWVDb2xvckZ1bmMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBpZUNvbG9yRnVuYygpIHsKICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQ29sb3JMb29rdXBGdW5jdGlvbih0aGlzLnBpZU5hbWVzKHRoaXMuZ2V0VmlzRGF0YSgpKS5tYXAoZnVuY3Rpb24gKGQpIHsKICAgICAgICByZXR1cm4gZC5sYWJlbDsKICAgICAgfSksIHRoaXMudWlTdGF0ZS5nZXQoJ3Zpcy5jb2xvcnMnKSk7CiAgICB9CiAgICAvKioKICAgICAqIGVuc3VyZSB0aGF0IHRoZSBkYXRhcyBvcmRlcmVkIHByb3BlcnR5IGhhcyBhIG1pbiBhbmQgbWF4CiAgICAgKiBpZiB0aGUgZGF0YSByZXByZXNlbnRzIGFuIG9yZGVyZWQgZGF0ZSByYW5nZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX25vcm1hbGl6ZU9yZGVyZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9ub3JtYWxpemVPcmRlcmVkKCkgewogICAgICB2YXIgZGF0YSA9IHRoaXMuZ2V0VmlzRGF0YSgpOwogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIGRhdGEuZm9yRWFjaChmdW5jdGlvbiAoZCkgewogICAgICAgIGlmICghZC5vcmRlcmVkIHx8ICFkLm9yZGVyZWQuZGF0ZSkgcmV0dXJuOwogICAgICAgIHZhciBtaXNzaW5nTWluID0gZC5vcmRlcmVkLm1pbiA9PSBudWxsOwogICAgICAgIHZhciBtaXNzaW5nTWF4ID0gZC5vcmRlcmVkLm1heCA9PSBudWxsOwoKICAgICAgICBpZiAobWlzc2luZ01heCB8fCBtaXNzaW5nTWluKSB7CiAgICAgICAgICB2YXIgZXh0ZW50ID0gX2QuZGVmYXVsdC5leHRlbnQoc2VsZi54VmFsdWVzKCkpOwoKICAgICAgICAgIGlmIChtaXNzaW5nTWluKSBkLm9yZGVyZWQubWluID0gZXh0ZW50WzBdOwogICAgICAgICAgaWYgKG1pc3NpbmdNYXgpIGQub3JkZXJlZC5tYXggPSBleHRlbnRbMV07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogQ2FsY3VsYXRlcyBtaW4gYW5kIG1heCB2YWx1ZXMgZm9yIGFsbCBtYXAgZGF0YQogICAgICogc2VyaWVzLnJvd3MgaXMgYW4gYXJyYXkgb2YgYXJyYXlzCiAgICAgKiBlYWNoIHJvdyBpcyBhbiBhcnJheSBvZiB2YWx1ZXMKICAgICAqIGxhc3QgdmFsdWUgaW4gcm93IGFycmF5IGlzIGJ1Y2tldCBjb3VudAogICAgICoKICAgICAqIEBtZXRob2QgbWFwRGF0YUV4dGVudHMKICAgICAqIEBwYXJhbSBzZXJpZXMge0FycmF5fSBBcnJheSBvZiBkYXRhIG9iamVjdHMKICAgICAqIEByZXR1cm5zIHtBcnJheX0gbWluIGFuZCBtYXggdmFsdWVzCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAibWFwRGF0YUV4dGVudHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1hcERhdGFFeHRlbnRzKHNlcmllcykgewogICAgICB2YXIgdmFsdWVzID0gX2xvZGFzaC5kZWZhdWx0Lm1hcChzZXJpZXMucm93cywgZnVuY3Rpb24gKHJvdykgewogICAgICAgIHJldHVybiByb3dbcm93Lmxlbmd0aCAtIDFdOwogICAgICB9KTsKCiAgICAgIHJldHVybiBbX2xvZGFzaC5kZWZhdWx0Lm1pbih2YWx1ZXMpLCBfbG9kYXNoLmRlZmF1bHQubWF4KHZhbHVlcyldOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIG1heGltdW0gbnVtYmVyIG9mIHNlcmllcywgY29uc2lkZXJpbmcgZWFjaCBjaGFydAogICAgICogaW5kaXZpZHVhbGx5LgogICAgICoKICAgICAqIEByZXR1cm4ge251bWJlcn0gLSB0aGUgbGFyZ2VzdCBudW1iZXIgb2Ygc2VyaWVzIGZyb20gYWxsIGNoYXJ0cwogICAgICovCgogIH0sIHsKICAgIGtleTogIm1heE51bWJlck9mU2VyaWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtYXhOdW1iZXJPZlNlcmllcygpIHsKICAgICAgcmV0dXJuIHRoaXMuY2hhcnREYXRhKCkucmVkdWNlKGZ1bmN0aW9uIChtYXgsIGNoYXJ0KSB7CiAgICAgICAgcmV0dXJuIE1hdGgubWF4KG1heCwgY2hhcnQuc2VyaWVzLmxlbmd0aCk7CiAgICAgIH0sIDApOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIERhdGE7Cn0oKTsKCmV4cG9ydHMuRGF0YSA9IERhdGE7"},null]}