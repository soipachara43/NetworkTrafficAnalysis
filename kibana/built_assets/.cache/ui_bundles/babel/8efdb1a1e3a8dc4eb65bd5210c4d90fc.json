{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/components/ml/conditional_links/add_entities_to_kql.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/components/ml/conditional_links/add_entities_to_kql.js","mtime":1589249553028},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmFkZEVudGl0aWVzVG9LcWwgPSBleHBvcnRzLmVudGl0aWVzVG9LcWwgPSBleHBvcnRzLmVudGl0eVRvS3FsID0gdm9pZCAwOwoKdmFyIF9yaXNvbk5vZGUgPSByZXF1aXJlKCJyaXNvbi1ub2RlIik7Cgp2YXIgX3Jpc29uX2hlbHBlcnMgPSByZXF1aXJlKCIuL3Jpc29uX2hlbHBlcnMiKTsKLyoKICogQ29weXJpZ2h0IEVsYXN0aWNzZWFyY2ggQi5WLiBhbmQvb3IgbGljZW5zZWQgdG8gRWxhc3RpY3NlYXJjaCBCLlYuIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gTGljZW5zZWQgdW5kZXIgdGhlIEVsYXN0aWMgTGljZW5zZTsKICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBFbGFzdGljIExpY2Vuc2UuCiAqLwoKCnZhciBlbnRpdHlUb0txbCA9IGZ1bmN0aW9uIGVudGl0eVRvS3FsKGVudGl0eU5hbWVzLCBlbnRpdHkpIHsKICBpZiAoZW50aXR5TmFtZXMubGVuZ3RoID09PSAxKSB7CiAgICByZXR1cm4gIiIuY29uY2F0KGVudGl0eU5hbWVzWzBdLCAiOiBcIiIpLmNvbmNhdChlbnRpdHksICJcIiIpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gZW50aXR5TmFtZXMucmVkdWNlKGZ1bmN0aW9uIChhY2N1bSwgZW50aXR5TmFtZSwgaW5kZXgsIGFycmF5KSB7CiAgICAgIGlmIChpbmRleCA9PT0gMCkgewogICAgICAgIHJldHVybiAiKCIuY29uY2F0KGVudGl0eU5hbWUsICI6IFwiIikuY29uY2F0KGVudGl0eSwgIlwiIik7CiAgICAgIH0gZWxzZSBpZiAoaW5kZXggPT09IGFycmF5Lmxlbmd0aCAtIDEpIHsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KGFjY3VtLCAiIG9yICIpLmNvbmNhdChlbnRpdHlOYW1lLCAiOiBcIiIpLmNvbmNhdChlbnRpdHksICJcIikiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KGFjY3VtLCAiIG9yICIpLmNvbmNhdChlbnRpdHlOYW1lLCAiOiBcIiIpLmNvbmNhdChlbnRpdHksICJcIiIpOwogICAgICB9CiAgICB9LCAnJyk7CiAgfQp9OwoKZXhwb3J0cy5lbnRpdHlUb0txbCA9IGVudGl0eVRvS3FsOwoKdmFyIGVudGl0aWVzVG9LcWwgPSBmdW5jdGlvbiBlbnRpdGllc1RvS3FsKGVudGl0eU5hbWVzLCBlbnRpdGllcykgewogIHJldHVybiBlbnRpdGllcy5yZWR1Y2UoZnVuY3Rpb24gKGFjY3VtLCBlbnRpdHksIGluZGV4KSB7CiAgICB2YXIgZW50aXR5S3FsID0gZW50aXR5VG9LcWwoZW50aXR5TmFtZXMsIGVudGl0eSk7CgogICAgaWYgKGluZGV4ID09PSAwKSB7CiAgICAgIHJldHVybiBlbnRpdHlLcWw7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gIiIuY29uY2F0KGFjY3VtLCAiIG9yICIpLmNvbmNhdChlbnRpdHlLcWwpOwogICAgfQogIH0sICcnKTsKfTsKCmV4cG9ydHMuZW50aXRpZXNUb0txbCA9IGVudGl0aWVzVG9LcWw7Cgp2YXIgYWRkRW50aXRpZXNUb0txbCA9IGZ1bmN0aW9uIGFkZEVudGl0aWVzVG9LcWwoZW50aXR5TmFtZXMsIGVudGl0aWVzLCBrcWxRdWVyeSkgewogIHZhciB2YWx1ZSA9ICgwLCBfcmlzb25faGVscGVycy5kZWNvZGVSaXNvbikoa3FsUXVlcnkpOwoKICBpZiAoKDAsIF9yaXNvbl9oZWxwZXJzLmlzUmlzb25PYmplY3QpKHZhbHVlKSkgewogICAgdmFyIGFwcFF1ZXJ5ID0gdmFsdWU7CgogICAgaWYgKCgwLCBfcmlzb25faGVscGVycy5pc1Jpc29uT2JqZWN0KShhcHBRdWVyeSkpIHsKICAgICAgaWYgKCgwLCBfcmlzb25faGVscGVycy5pc1JlZ3VsYXJTdHJpbmcpKGFwcFF1ZXJ5LnF1ZXJ5KSkgewogICAgICAgIHZhciBlbnRpdGllc0txbCA9IGVudGl0aWVzVG9LcWwoZW50aXR5TmFtZXMsIGVudGl0aWVzKTsKCiAgICAgICAgaWYgKGFwcFF1ZXJ5LnF1ZXJ5ICE9PSAnJyAmJiBlbnRpdGllc0txbCAhPT0gJycpIHsKICAgICAgICAgIGFwcFF1ZXJ5LnF1ZXJ5ID0gIigiLmNvbmNhdChlbnRpdGllc0txbCwgIikgYW5kICgiKS5jb25jYXQoYXBwUXVlcnkucXVlcnksICIpIik7CiAgICAgICAgfSBlbHNlIGlmIChhcHBRdWVyeS5xdWVyeSA9PT0gJycgJiYgZW50aXRpZXNLcWwgIT09ICcnKSB7CiAgICAgICAgICBhcHBRdWVyeS5xdWVyeSA9ICIoIi5jb25jYXQoZW50aXRpZXNLcWwsICIpIik7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKDAsIF9yaXNvbk5vZGUuZW5jb2RlKSh2YWx1ZSk7CiAgICAgIH0KICAgIH0KICB9IGVsc2UgaWYgKHZhbHVlID09IG51bGwpIHsKICAgIHZhciBfZW50aXRpZXNLcWwgPSBlbnRpdGllc1RvS3FsKGVudGl0eU5hbWVzLCBlbnRpdGllcyk7CgogICAgcmV0dXJuICgwLCBfcmlzb25Ob2RlLmVuY29kZSkoewogICAgICBxdWVyeTogIigiLmNvbmNhdChfZW50aXRpZXNLcWwsICIpIiksCiAgICAgIGxhbmd1YWdlOiAna3VlcnknCiAgICB9KTsKICB9CgogIHJldHVybiBrcWxRdWVyeTsKfTsKCmV4cG9ydHMuYWRkRW50aXRpZXNUb0txbCA9IGFkZEVudGl0aWVzVG9LcWw7"},null]}