{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/create/helpers.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/create/helpers.js","mtime":1589249553316},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmZvcm1hdFJ1bGUgPSBleHBvcnRzLmZvcm1hdEFjdGlvbnNTdGVwRGF0YSA9IGV4cG9ydHMuZm9ybWF0QWJvdXRTdGVwRGF0YSA9IGV4cG9ydHMuZm9ybWF0U2NoZWR1bGVTdGVwRGF0YSA9IGV4cG9ydHMuZm9ybWF0RGVmaW5lU3RlcERhdGEgPSBleHBvcnRzLmZpbHRlclJ1bGVGaWVsZHNGb3JUeXBlID0gZXhwb3J0cy5nZXRUaW1lVHlwZVZhbHVlID0gdm9pZCAwOwoKdmFyIF9mcCA9IHJlcXVpcmUoImxvZGFzaC9mcCIpOwoKdmFyIF9tb21lbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudCIpKTsKCnZhciBfZGVlcG1lcmdlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJkZWVwbWVyZ2UiKSk7Cgp2YXIgX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL2NvbW1vbi9jb25zdGFudHMiKTsKCnZhciBfdHJhbnNmb3JtX2FjdGlvbnMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9jb21tb24vZGV0ZWN0aW9uX2VuZ2luZS90cmFuc2Zvcm1fYWN0aW9ucyIpOwoKdmFyIF9tbF9oZWxwZXJzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vY29tbW9uL2RldGVjdGlvbl9lbmdpbmUvbWxfaGVscGVycyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgZGVmYXVsdDogb2JqCiAgfTsKfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhzb3VyY2UsIGV4Y2x1ZGVkKSB7CiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307CgogIHZhciB0YXJnZXQgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKTsKCiAgdmFyIGtleSwgaTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzb3VyY2VTeW1ib2xLZXlzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzb3VyY2UpOwoKICAgIGZvciAoaSA9IDA7IGkgPCBzb3VyY2VTeW1ib2xLZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGtleSA9IHNvdXJjZVN5bWJvbEtleXNbaV07CiAgICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7CiAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHNvdXJjZSwga2V5KSkgY29udGludWU7CiAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7CiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307CiAgdmFyIHRhcmdldCA9IHt9OwogIHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTsKICB2YXIga2V5LCBpOwoKICBmb3IgKGkgPSAwOyBpIDwgc291cmNlS2V5cy5sZW5ndGg7IGkrKykgewogICAga2V5ID0gc291cmNlS2V5c1tpXTsKICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7CiAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOwogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKdmFyIGdldFRpbWVUeXBlVmFsdWUgPSBmdW5jdGlvbiBnZXRUaW1lVHlwZVZhbHVlKHRpbWUpIHsKICB2YXIgdGltZU9iaiA9IHsKICAgIHVuaXQ6ICcnLAogICAgdmFsdWU6IDAKICB9OwogIHZhciBmaWx0ZXJUaW1lVmFsID0gdGltZS5tYXRjaCgvXGQrL2cpOwogIHZhciBmaWx0ZXJUaW1lVHlwZSA9IHRpbWUubWF0Y2goL1thLXpBLVpdKy9nKTsKCiAgaWYgKCEoMCwgX2ZwLmlzRW1wdHkpKGZpbHRlclRpbWVWYWwpICYmIGZpbHRlclRpbWVWYWwgIT0gbnVsbCAmJiAhaXNOYU4oTnVtYmVyKGZpbHRlclRpbWVWYWxbMF0pKSkgewogICAgdGltZU9iai52YWx1ZSA9IE51bWJlcihmaWx0ZXJUaW1lVmFsWzBdKTsKICB9CgogIGlmICghKDAsIF9mcC5pc0VtcHR5KShmaWx0ZXJUaW1lVHlwZSkgJiYgZmlsdGVyVGltZVR5cGUgIT0gbnVsbCAmJiBbJ3MnLCAnbScsICdoJ10uaW5jbHVkZXMoZmlsdGVyVGltZVR5cGVbMF0pKSB7CiAgICB0aW1lT2JqLnVuaXQgPSBmaWx0ZXJUaW1lVHlwZVswXTsKICB9CgogIHJldHVybiB0aW1lT2JqOwp9OwoKZXhwb3J0cy5nZXRUaW1lVHlwZVZhbHVlID0gZ2V0VGltZVR5cGVWYWx1ZTsKCnZhciBpc01sRmllbGRzID0gZnVuY3Rpb24gaXNNbEZpZWxkcyhmaWVsZHMpIHsKICByZXR1cm4gKDAsIF9mcC5oYXMpKCdhbm9tYWx5VGhyZXNob2xkJywgZmllbGRzKTsKfTsKCnZhciBmaWx0ZXJSdWxlRmllbGRzRm9yVHlwZSA9IGZ1bmN0aW9uIGZpbHRlclJ1bGVGaWVsZHNGb3JUeXBlKGZpZWxkcywgdHlwZSkgewogIGlmICgoMCwgX21sX2hlbHBlcnMuaXNNbFJ1bGUpKHR5cGUpKSB7CiAgICB2YXIgaW5kZXggPSBmaWVsZHMuaW5kZXgsCiAgICAgICAgcXVlcnlCYXIgPSBmaWVsZHMucXVlcnlCYXIsCiAgICAgICAgbWxSdWxlRmllbGRzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKGZpZWxkcywgWyJpbmRleCIsICJxdWVyeUJhciJdKTsKCiAgICByZXR1cm4gbWxSdWxlRmllbGRzOwogIH0gZWxzZSB7CiAgICB2YXIgYW5vbWFseVRocmVzaG9sZCA9IGZpZWxkcy5hbm9tYWx5VGhyZXNob2xkLAogICAgICAgIG1hY2hpbmVMZWFybmluZ0pvYklkID0gZmllbGRzLm1hY2hpbmVMZWFybmluZ0pvYklkLAogICAgICAgIHF1ZXJ5UnVsZUZpZWxkcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhmaWVsZHMsIFsiYW5vbWFseVRocmVzaG9sZCIsICJtYWNoaW5lTGVhcm5pbmdKb2JJZCJdKTsKCiAgICByZXR1cm4gcXVlcnlSdWxlRmllbGRzOwogIH0KfTsKCmV4cG9ydHMuZmlsdGVyUnVsZUZpZWxkc0ZvclR5cGUgPSBmaWx0ZXJSdWxlRmllbGRzRm9yVHlwZTsKCnZhciBmb3JtYXREZWZpbmVTdGVwRGF0YSA9IGZ1bmN0aW9uIGZvcm1hdERlZmluZVN0ZXBEYXRhKGRlZmluZVN0ZXBEYXRhKSB7CiAgdmFyIF9ydWxlRmllbGRzJHF1ZXJ5QmFyLCBfcnVsZUZpZWxkcyRxdWVyeUJhcjIsIF9ydWxlRmllbGRzJHF1ZXJ5QmFyMywgX3J1bGVGaWVsZHMkcXVlcnlCYXI0LCBfcnVsZUZpZWxkcyRxdWVyeUJhcjUsIF9ydWxlRmllbGRzJHF1ZXJ5QmFyNiwgX3J1bGVGaWVsZHMkcXVlcnlCYXI3OwoKICB2YXIgcnVsZUZpZWxkcyA9IGZpbHRlclJ1bGVGaWVsZHNGb3JUeXBlKGRlZmluZVN0ZXBEYXRhLCBkZWZpbmVTdGVwRGF0YS5ydWxlVHlwZSk7CiAgdmFyIHJ1bGVUeXBlID0gcnVsZUZpZWxkcy5ydWxlVHlwZSwKICAgICAgdGltZWxpbmUgPSBydWxlRmllbGRzLnRpbWVsaW5lOwoKICB2YXIgYmFzZUZpZWxkcyA9IF9vYmplY3RTcHJlYWQoewogICAgdHlwZTogcnVsZVR5cGUKICB9LCB0aW1lbGluZS5pZCAhPSBudWxsICYmIHRpbWVsaW5lLnRpdGxlICE9IG51bGwgJiYgewogICAgdGltZWxpbmVfaWQ6IHRpbWVsaW5lLmlkLAogICAgdGltZWxpbmVfdGl0bGU6IHRpbWVsaW5lLnRpdGxlCiAgfSk7CgogIHZhciB0eXBlRmllbGRzID0gaXNNbEZpZWxkcyhydWxlRmllbGRzKSA/IHsKICAgIGFub21hbHlfdGhyZXNob2xkOiBydWxlRmllbGRzLmFub21hbHlUaHJlc2hvbGQsCiAgICBtYWNoaW5lX2xlYXJuaW5nX2pvYl9pZDogcnVsZUZpZWxkcy5tYWNoaW5lTGVhcm5pbmdKb2JJZAogIH0gOiBfb2JqZWN0U3ByZWFkKHsKICAgIGluZGV4OiBydWxlRmllbGRzLmluZGV4LAogICAgZmlsdGVyczogKF9ydWxlRmllbGRzJHF1ZXJ5QmFyID0gcnVsZUZpZWxkcy5xdWVyeUJhcikgPT09IG51bGwgfHwgX3J1bGVGaWVsZHMkcXVlcnlCYXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ydWxlRmllbGRzJHF1ZXJ5QmFyLmZpbHRlcnMsCiAgICBsYW5ndWFnZTogKF9ydWxlRmllbGRzJHF1ZXJ5QmFyMiA9IHJ1bGVGaWVsZHMucXVlcnlCYXIpID09PSBudWxsIHx8IF9ydWxlRmllbGRzJHF1ZXJ5QmFyMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9ydWxlRmllbGRzJHF1ZXJ5QmFyMyA9IF9ydWxlRmllbGRzJHF1ZXJ5QmFyMi5xdWVyeSkgPT09IG51bGwgfHwgX3J1bGVGaWVsZHMkcXVlcnlCYXIzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcnVsZUZpZWxkcyRxdWVyeUJhcjMubGFuZ3VhZ2UsCiAgICBxdWVyeTogKF9ydWxlRmllbGRzJHF1ZXJ5QmFyNCA9IHJ1bGVGaWVsZHMucXVlcnlCYXIpID09PSBudWxsIHx8IF9ydWxlRmllbGRzJHF1ZXJ5QmFyNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9ydWxlRmllbGRzJHF1ZXJ5QmFyNSA9IF9ydWxlRmllbGRzJHF1ZXJ5QmFyNC5xdWVyeSkgPT09IG51bGwgfHwgX3J1bGVGaWVsZHMkcXVlcnlCYXI1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcnVsZUZpZWxkcyRxdWVyeUJhcjUucXVlcnksCiAgICBzYXZlZF9pZDogKF9ydWxlRmllbGRzJHF1ZXJ5QmFyNiA9IHJ1bGVGaWVsZHMucXVlcnlCYXIpID09PSBudWxsIHx8IF9ydWxlRmllbGRzJHF1ZXJ5QmFyNiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3J1bGVGaWVsZHMkcXVlcnlCYXI2LnNhdmVkX2lkCiAgfSwgcnVsZVR5cGUgPT09ICdxdWVyeScgJiYgKChfcnVsZUZpZWxkcyRxdWVyeUJhcjcgPSBydWxlRmllbGRzLnF1ZXJ5QmFyKSA9PT0gbnVsbCB8fCBfcnVsZUZpZWxkcyRxdWVyeUJhcjcgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ydWxlRmllbGRzJHF1ZXJ5QmFyNy5zYXZlZF9pZCkgJiYgewogICAgdHlwZTogJ3NhdmVkX3F1ZXJ5JwogIH0pOwogIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBiYXNlRmllbGRzLCB7fSwgdHlwZUZpZWxkcyk7Cn07CgpleHBvcnRzLmZvcm1hdERlZmluZVN0ZXBEYXRhID0gZm9ybWF0RGVmaW5lU3RlcERhdGE7Cgp2YXIgZm9ybWF0U2NoZWR1bGVTdGVwRGF0YSA9IGZ1bmN0aW9uIGZvcm1hdFNjaGVkdWxlU3RlcERhdGEoc2NoZWR1bGVEYXRhKSB7CiAgdmFyIGlzTmV3ID0gc2NoZWR1bGVEYXRhLmlzTmV3LAogICAgICBmb3JtYXRTY2hlZHVsZURhdGEgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoc2NoZWR1bGVEYXRhLCBbImlzTmV3Il0pOwoKICBpZiAoISgwLCBfZnAuaXNFbXB0eSkoZm9ybWF0U2NoZWR1bGVEYXRhLmludGVydmFsKSAmJiAhKDAsIF9mcC5pc0VtcHR5KShmb3JtYXRTY2hlZHVsZURhdGEuZnJvbSkpIHsKICAgIHZhciBfZ2V0VGltZVR5cGVWYWx1ZSA9IGdldFRpbWVUeXBlVmFsdWUoZm9ybWF0U2NoZWR1bGVEYXRhLmludGVydmFsKSwKICAgICAgICBpbnRlcnZhbFVuaXQgPSBfZ2V0VGltZVR5cGVWYWx1ZS51bml0LAogICAgICAgIGludGVydmFsVmFsdWUgPSBfZ2V0VGltZVR5cGVWYWx1ZS52YWx1ZTsKCiAgICB2YXIgX2dldFRpbWVUeXBlVmFsdWUyID0gZ2V0VGltZVR5cGVWYWx1ZShmb3JtYXRTY2hlZHVsZURhdGEuZnJvbSksCiAgICAgICAgZnJvbVVuaXQgPSBfZ2V0VGltZVR5cGVWYWx1ZTIudW5pdCwKICAgICAgICBmcm9tVmFsdWUgPSBfZ2V0VGltZVR5cGVWYWx1ZTIudmFsdWU7CgogICAgdmFyIGR1cmF0aW9uID0gX21vbWVudC5kZWZhdWx0LmR1cmF0aW9uKGludGVydmFsVmFsdWUsIGludGVydmFsVW5pdCk7CgogICAgZHVyYXRpb24uYWRkKGZyb21WYWx1ZSwgZnJvbVVuaXQpOwogICAgZm9ybWF0U2NoZWR1bGVEYXRhLmZyb20gPSAibm93LSIuY29uY2F0KGR1cmF0aW9uLmFzU2Vjb25kcygpLCAicyIpOwogICAgZm9ybWF0U2NoZWR1bGVEYXRhLnRvID0gJ25vdyc7CiAgfQoKICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgZm9ybWF0U2NoZWR1bGVEYXRhLCB7CiAgICBtZXRhOiB7CiAgICAgIGZyb206IHNjaGVkdWxlRGF0YS5mcm9tCiAgICB9CiAgfSk7Cn07CgpleHBvcnRzLmZvcm1hdFNjaGVkdWxlU3RlcERhdGEgPSBmb3JtYXRTY2hlZHVsZVN0ZXBEYXRhOwoKdmFyIGZvcm1hdEFib3V0U3RlcERhdGEgPSBmdW5jdGlvbiBmb3JtYXRBYm91dFN0ZXBEYXRhKGFib3V0U3RlcERhdGEpIHsKICB2YXIgZmFsc2VQb3NpdGl2ZXMgPSBhYm91dFN0ZXBEYXRhLmZhbHNlUG9zaXRpdmVzLAogICAgICByZWZlcmVuY2VzID0gYWJvdXRTdGVwRGF0YS5yZWZlcmVuY2VzLAogICAgICByaXNrU2NvcmUgPSBhYm91dFN0ZXBEYXRhLnJpc2tTY29yZSwKICAgICAgdGhyZWF0ID0gYWJvdXRTdGVwRGF0YS50aHJlYXQsCiAgICAgIGlzTmV3ID0gYWJvdXRTdGVwRGF0YS5pc05ldywKICAgICAgbm90ZSA9IGFib3V0U3RlcERhdGEubm90ZSwKICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhhYm91dFN0ZXBEYXRhLCBbImZhbHNlUG9zaXRpdmVzIiwgInJlZmVyZW5jZXMiLCAicmlza1Njb3JlIiwgInRocmVhdCIsICJpc05ldyIsICJub3RlIl0pOwoKICByZXR1cm4gX29iamVjdFNwcmVhZCh7CiAgICBmYWxzZV9wb3NpdGl2ZXM6IGZhbHNlUG9zaXRpdmVzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICByZXR1cm4gISgwLCBfZnAuaXNFbXB0eSkoaXRlbSk7CiAgICB9KSwKICAgIHJlZmVyZW5jZXM6IHJlZmVyZW5jZXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgIHJldHVybiAhKDAsIF9mcC5pc0VtcHR5KShpdGVtKTsKICAgIH0pLAogICAgcmlza19zY29yZTogcmlza1Njb3JlLAogICAgdGhyZWF0OiB0aHJlYXQuZmlsdGVyKGZ1bmN0aW9uIChzaW5nbGVUaHJlYXQpIHsKICAgICAgcmV0dXJuIHNpbmdsZVRocmVhdC50YWN0aWMubmFtZSAhPT0gJ25vbmUnOwogICAgfSkubWFwKGZ1bmN0aW9uIChzaW5nbGVUaHJlYXQpIHsKICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHNpbmdsZVRocmVhdCwgewogICAgICAgIGZyYW1ld29yazogJ01JVFJFIEFUVCZDSycsCiAgICAgICAgdGVjaG5pcXVlOiBzaW5nbGVUaHJlYXQudGVjaG5pcXVlLm1hcChmdW5jdGlvbiAodGVjaG5pcXVlKSB7CiAgICAgICAgICB2YXIgaWQgPSB0ZWNobmlxdWUuaWQsCiAgICAgICAgICAgICAgbmFtZSA9IHRlY2huaXF1ZS5uYW1lLAogICAgICAgICAgICAgIHJlZmVyZW5jZSA9IHRlY2huaXF1ZS5yZWZlcmVuY2U7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpZDogaWQsCiAgICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICAgIHJlZmVyZW5jZTogcmVmZXJlbmNlCiAgICAgICAgICB9OwogICAgICAgIH0pCiAgICAgIH0pOwogICAgfSkKICB9LCAhKDAsIF9mcC5pc0VtcHR5KShub3RlKSA/IHsKICAgIG5vdGU6IG5vdGUKICB9IDoge30sIHt9LCByZXN0KTsKfTsKCmV4cG9ydHMuZm9ybWF0QWJvdXRTdGVwRGF0YSA9IGZvcm1hdEFib3V0U3RlcERhdGE7Cgp2YXIgZm9ybWF0QWN0aW9uc1N0ZXBEYXRhID0gZnVuY3Rpb24gZm9ybWF0QWN0aW9uc1N0ZXBEYXRhKGFjdGlvbnNTdGVwRGF0YSkgewogIHZhciBfYWN0aW9uc1N0ZXBEYXRhJGFjdGkgPSBhY3Rpb25zU3RlcERhdGEuYWN0aW9ucywKICAgICAgYWN0aW9ucyA9IF9hY3Rpb25zU3RlcERhdGEkYWN0aSA9PT0gdm9pZCAwID8gW10gOiBfYWN0aW9uc1N0ZXBEYXRhJGFjdGksCiAgICAgIGVuYWJsZWQgPSBhY3Rpb25zU3RlcERhdGEuZW5hYmxlZCwKICAgICAga2liYW5hU2llbUFwcFVybCA9IGFjdGlvbnNTdGVwRGF0YS5raWJhbmFTaWVtQXBwVXJsLAogICAgICBfYWN0aW9uc1N0ZXBEYXRhJHRocm8gPSBhY3Rpb25zU3RlcERhdGEudGhyb3R0bGUsCiAgICAgIHRocm90dGxlID0gX2FjdGlvbnNTdGVwRGF0YSR0aHJvID09PSB2b2lkIDAgPyBfY29uc3RhbnRzLk5PVElGSUNBVElPTl9USFJPVFRMRV9OT19BQ1RJT05TIDogX2FjdGlvbnNTdGVwRGF0YSR0aHJvOwogIHJldHVybiB7CiAgICBhY3Rpb25zOiBhY3Rpb25zLm1hcChfdHJhbnNmb3JtX2FjdGlvbnMudHJhbnNmb3JtQWxlcnRUb1J1bGVBY3Rpb24pLAogICAgZW5hYmxlZDogZW5hYmxlZCwKICAgIHRocm90dGxlOiBhY3Rpb25zLmxlbmd0aCA/IHRocm90dGxlIDogX2NvbnN0YW50cy5OT1RJRklDQVRJT05fVEhST1RUTEVfTk9fQUNUSU9OUywKICAgIG1ldGE6IHsKICAgICAga2liYW5hX3NpZW1fYXBwX3VybDoga2liYW5hU2llbUFwcFVybAogICAgfQogIH07Cn07CgpleHBvcnRzLmZvcm1hdEFjdGlvbnNTdGVwRGF0YSA9IGZvcm1hdEFjdGlvbnNTdGVwRGF0YTsKCnZhciBmb3JtYXRSdWxlID0gZnVuY3Rpb24gZm9ybWF0UnVsZShkZWZpbmVTdGVwRGF0YSwgYWJvdXRTdGVwRGF0YSwgc2NoZWR1bGVEYXRhLCBhY3Rpb25zRGF0YSkgewogIHJldHVybiBfZGVlcG1lcmdlLmRlZmF1bHQuYWxsKFtmb3JtYXREZWZpbmVTdGVwRGF0YShkZWZpbmVTdGVwRGF0YSksIGZvcm1hdEFib3V0U3RlcERhdGEoYWJvdXRTdGVwRGF0YSksIGZvcm1hdFNjaGVkdWxlU3RlcERhdGEoc2NoZWR1bGVEYXRhKSwgZm9ybWF0QWN0aW9uc1N0ZXBEYXRhKGFjdGlvbnNEYXRhKV0pOwp9OwoKZXhwb3J0cy5mb3JtYXRSdWxlID0gZm9ybWF0UnVsZTs="},null]}