{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/vis_type_metric/public/components/metric_vis_component.js","dependencies":[{"path":"src/legacy/core_plugins/vis_type_metric/public/components/metric_vis_component.js","mtime":1589249549982},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuTWV0cmljVmlzQ29tcG9uZW50ID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2xlZ2FjeV9pbXBvcnRzID0gcmVxdWlyZSgiLi4vbGVnYWN5X2ltcG9ydHMiKTsKCnZhciBfbWV0cmljX3Zpc192YWx1ZSA9IHJlcXVpcmUoIi4vbWV0cmljX3Zpc192YWx1ZSIpOwoKdmFyIF9wdWJsaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9wbHVnaW5zL2NoYXJ0cy9wdWJsaWMiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgewogIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKICAgIHJldHVybiBvYmo7CiAgfSBlbHNlIHsKICAgIHZhciBuZXdPYmogPSB7fTsKCiAgICBpZiAob2JqICE9IG51bGwpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsKCiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7CiAgICByZXR1cm4gbmV3T2JqOwogIH0KfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBfdHlwZW9mMihTeW1ib2wuaXRlcmF0b3IpID09PSAic3ltYm9sIikgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9IGVsc2UgewogICAgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0KCiAgcmV0dXJuIF90eXBlb2Yob2JqKTsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgfQp9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogIHJldHVybiBDb25zdHJ1Y3RvcjsKfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgewogIGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsKICAgIHJldHVybiBjYWxsOwogIH0KCiAgcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7Cn0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7CiAgfTsKICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwp9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsKICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIHNlbGY7Cn0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOwogIH0KCiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9KTsKICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsKfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgIG8uX19wcm90b19fID0gcDsKICAgIHJldHVybiBvOwogIH07CgogIHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgTWV0cmljVmlzQ29tcG9uZW50ID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhNZXRyaWNWaXNDb21wb25lbnQsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBNZXRyaWNWaXNDb21wb25lbnQoKSB7CiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjsKCiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1ldHJpY1Zpc0NvbXBvbmVudCk7CgogICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICB9CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9IF9nZXRQcm90b3R5cGVPZihNZXRyaWNWaXNDb21wb25lbnQpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzXS5jb25jYXQoYXJncykpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRGb3JtYXR0ZWRWYWx1ZSIsIGZ1bmN0aW9uIChmaWVsZEZvcm1hdHRlciwgdmFsdWUpIHsKICAgICAgdmFyIGZvcm1hdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogJ3RleHQnOwogICAgICBpZiAoKDAsIF9sb2Rhc2guaXNOYU4pKHZhbHVlKSkgcmV0dXJuICctJzsKICAgICAgcmV0dXJuIGZpZWxkRm9ybWF0dGVyLmNvbnZlcnQodmFsdWUsIGZvcm1hdCk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJmaWx0ZXJCdWNrZXQiLCBmdW5jdGlvbiAobWV0cmljKSB7CiAgICAgIHZhciBkaW1lbnNpb25zID0gX3RoaXMucHJvcHMudmlzUGFyYW1zLmRpbWVuc2lvbnM7CgogICAgICBpZiAoIWRpbWVuc2lvbnMuYnVja2V0KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgdGFibGUgPSBfdGhpcy5wcm9wcy52aXNEYXRhOwoKICAgICAgX3RoaXMucHJvcHMudmlzLkFQSS5ldmVudHMuZmlsdGVyKHsKICAgICAgICB0YWJsZTogdGFibGUsCiAgICAgICAgY29sdW1uOiBkaW1lbnNpb25zLmJ1Y2tldC5hY2Nlc3NvciwKICAgICAgICByb3c6IG1ldHJpYy5yb3dJbmRleAogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlck1ldHJpYyIsIGZ1bmN0aW9uIChtZXRyaWMsIGluZGV4KSB7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9tZXRyaWNfdmlzX3ZhbHVlLk1ldHJpY1Zpc1ZhbHVlLCB7CiAgICAgICAga2V5OiBpbmRleCwKICAgICAgICBtZXRyaWM6IG1ldHJpYywKICAgICAgICBmb250U2l6ZTogX3RoaXMucHJvcHMudmlzUGFyYW1zLm1ldHJpYy5zdHlsZS5mb250U2l6ZSwKICAgICAgICBvbkZpbHRlcjogX3RoaXMucHJvcHMudmlzUGFyYW1zLmRpbWVuc2lvbnMuYnVja2V0ID8gX3RoaXMuZmlsdGVyQnVja2V0IDogdW5kZWZpbmVkLAogICAgICAgIHNob3dMYWJlbDogX3RoaXMucHJvcHMudmlzUGFyYW1zLm1ldHJpYy5sYWJlbHMuc2hvdwogICAgICB9KTsKICAgIH0pOwoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhNZXRyaWNWaXNDb21wb25lbnQsIFt7CiAgICBrZXk6ICJnZXRMYWJlbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldExhYmVscygpIHsKICAgICAgdmFyIGNvbmZpZyA9IHRoaXMucHJvcHMudmlzUGFyYW1zLm1ldHJpYzsKICAgICAgdmFyIGlzUGVyY2VudGFnZU1vZGUgPSBjb25maWcucGVyY2VudGFnZU1vZGU7CiAgICAgIHZhciBjb2xvcnNSYW5nZSA9IGNvbmZpZy5jb2xvcnNSYW5nZTsKICAgICAgdmFyIG1heCA9ICgwLCBfbG9kYXNoLmxhc3QpKGNvbG9yc1JhbmdlKS50bzsKICAgICAgdmFyIGxhYmVscyA9IFtdOwogICAgICBjb2xvcnNSYW5nZS5mb3JFYWNoKGZ1bmN0aW9uIChyYW5nZSkgewogICAgICAgIHZhciBmcm9tID0gaXNQZXJjZW50YWdlTW9kZSA/IE1hdGgucm91bmQoMTAwICogcmFuZ2UuZnJvbSAvIG1heCkgOiByYW5nZS5mcm9tOwogICAgICAgIHZhciB0byA9IGlzUGVyY2VudGFnZU1vZGUgPyBNYXRoLnJvdW5kKDEwMCAqIHJhbmdlLnRvIC8gbWF4KSA6IHJhbmdlLnRvOwogICAgICAgIGxhYmVscy5wdXNoKCIiLmNvbmNhdChmcm9tLCAiIC0gIikuY29uY2F0KHRvKSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gbGFiZWxzOwogICAgfQogIH0sIHsKICAgIGtleTogImdldENvbG9ycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29sb3JzKCkgewogICAgICB2YXIgY29uZmlnID0gdGhpcy5wcm9wcy52aXNQYXJhbXMubWV0cmljOwogICAgICB2YXIgaW52ZXJ0Q29sb3JzID0gY29uZmlnLmludmVydENvbG9yczsKICAgICAgdmFyIGNvbG9yU2NoZW1hID0gY29uZmlnLmNvbG9yU2NoZW1hOwogICAgICB2YXIgY29sb3JzUmFuZ2UgPSBjb25maWcuY29sb3JzUmFuZ2U7CiAgICAgIHZhciBsYWJlbHMgPSB0aGlzLmdldExhYmVscygpOwogICAgICB2YXIgY29sb3JzID0ge307CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxhYmVscy5sZW5ndGg7IGkgKz0gMSkgewogICAgICAgIHZhciBkaXZpZGVyID0gTWF0aC5tYXgoY29sb3JzUmFuZ2UubGVuZ3RoIC0gMSwgMSk7CiAgICAgICAgdmFyIHZhbCA9IGludmVydENvbG9ycyA/IDEgLSBpIC8gZGl2aWRlciA6IGkgLyBkaXZpZGVyOwogICAgICAgIGNvbG9yc1tsYWJlbHNbaV1dID0gKDAsIF9wdWJsaWMuZ2V0SGVhdG1hcENvbG9ycykodmFsLCBjb2xvclNjaGVtYSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb2xvcnM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QnVja2V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCdWNrZXQodmFsKSB7CiAgICAgIHZhciBjb25maWcgPSB0aGlzLnByb3BzLnZpc1BhcmFtcy5tZXRyaWM7CiAgICAgIHZhciBidWNrZXQgPSAoMCwgX2xvZGFzaC5maW5kSW5kZXgpKGNvbmZpZy5jb2xvcnNSYW5nZSwgZnVuY3Rpb24gKHJhbmdlKSB7CiAgICAgICAgcmV0dXJuIHJhbmdlLmZyb20gPD0gdmFsICYmIHJhbmdlLnRvID4gdmFsOwogICAgICB9KTsKCiAgICAgIGlmIChidWNrZXQgPT09IC0xKSB7CiAgICAgICAgaWYgKHZhbCA8IGNvbmZpZy5jb2xvcnNSYW5nZVswXS5mcm9tKSBidWNrZXQgPSAwO2Vsc2UgYnVja2V0ID0gY29uZmlnLmNvbG9yc1JhbmdlLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIHJldHVybiBidWNrZXQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Q29sb3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbG9yKHZhbCwgbGFiZWxzLCBjb2xvcnMpIHsKICAgICAgdmFyIGJ1Y2tldCA9IHRoaXMuZ2V0QnVja2V0KHZhbCk7CiAgICAgIHZhciBsYWJlbCA9IGxhYmVsc1tidWNrZXRdOwogICAgICByZXR1cm4gY29sb3JzW2xhYmVsXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJuZWVkc0xpZ2h0VGV4dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbmVlZHNMaWdodFRleHQoYmdDb2xvcikgewogICAgICB2YXIgY29sb3JzID0gL3JnYlwoXHMqKFxkKylccyosXHMqKFxkKylccyosXHMqKFxkKylccypcKS8uZXhlYyhiZ0NvbG9yKTsKCiAgICAgIGlmICghY29sb3JzKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB2YXIgX2NvbG9ycyRzbGljZSRtYXAgPSBjb2xvcnMuc2xpY2UoMSkubWFwKHBhcnNlSW50KSwKICAgICAgICAgIF9jb2xvcnMkc2xpY2UkbWFwMiA9IF9zbGljZWRUb0FycmF5KF9jb2xvcnMkc2xpY2UkbWFwLCAzKSwKICAgICAgICAgIHJlZCA9IF9jb2xvcnMkc2xpY2UkbWFwMlswXSwKICAgICAgICAgIGdyZWVuID0gX2NvbG9ycyRzbGljZSRtYXAyWzFdLAogICAgICAgICAgYmx1ZSA9IF9jb2xvcnMkc2xpY2UkbWFwMlsyXTsKCiAgICAgIHJldHVybiAoMCwgX2V1aS5pc0NvbG9yRGFyaykocmVkLCBncmVlbiwgYmx1ZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicHJvY2Vzc1RhYmxlR3JvdXBzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzVGFibGVHcm91cHModGFibGUpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgY29uZmlnID0gdGhpcy5wcm9wcy52aXNQYXJhbXMubWV0cmljOwogICAgICB2YXIgZGltZW5zaW9ucyA9IHRoaXMucHJvcHMudmlzUGFyYW1zLmRpbWVuc2lvbnM7CiAgICAgIHZhciBpc1BlcmNlbnRhZ2VNb2RlID0gY29uZmlnLnBlcmNlbnRhZ2VNb2RlOwogICAgICB2YXIgbWluID0gY29uZmlnLmNvbG9yc1JhbmdlWzBdLmZyb207CiAgICAgIHZhciBtYXggPSAoMCwgX2xvZGFzaC5sYXN0KShjb25maWcuY29sb3JzUmFuZ2UpLnRvOwogICAgICB2YXIgY29sb3JzID0gdGhpcy5nZXRDb2xvcnMoKTsKICAgICAgdmFyIGxhYmVscyA9IHRoaXMuZ2V0TGFiZWxzKCk7CiAgICAgIHZhciBtZXRyaWNzID0gW107CiAgICAgIHZhciBidWNrZXRDb2x1bW5JZDsKICAgICAgdmFyIGJ1Y2tldEZvcm1hdHRlcjsKCiAgICAgIGlmIChkaW1lbnNpb25zLmJ1Y2tldCkgewogICAgICAgIGJ1Y2tldENvbHVtbklkID0gdGFibGUuY29sdW1uc1tkaW1lbnNpb25zLmJ1Y2tldC5hY2Nlc3Nvcl0uaWQ7CiAgICAgICAgYnVja2V0Rm9ybWF0dGVyID0gKDAsIF9sZWdhY3lfaW1wb3J0cy5nZXRGb3JtYXQpKGRpbWVuc2lvbnMuYnVja2V0LmZvcm1hdCk7CiAgICAgIH0KCiAgICAgIGRpbWVuc2lvbnMubWV0cmljcy5mb3JFYWNoKGZ1bmN0aW9uIChtZXRyaWMpIHsKICAgICAgICB2YXIgY29sdW1uSW5kZXggPSBtZXRyaWMuYWNjZXNzb3I7CiAgICAgICAgdmFyIGNvbHVtbiA9IHRhYmxlID09PSBudWxsIHx8IHRhYmxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0YWJsZS5jb2x1bW5zW2NvbHVtbkluZGV4XTsKICAgICAgICB2YXIgZm9ybWF0dGVyID0gKDAsIF9sZWdhY3lfaW1wb3J0cy5nZXRGb3JtYXQpKG1ldHJpYy5mb3JtYXQpOwogICAgICAgIHRhYmxlLnJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93LCByb3dJbmRleCkgewogICAgICAgICAgdmFyIHRpdGxlID0gY29sdW1uLm5hbWU7CiAgICAgICAgICB2YXIgdmFsdWUgPSByb3dbY29sdW1uLmlkXTsKCiAgICAgICAgICB2YXIgY29sb3IgPSBfdGhpczIuZ2V0Q29sb3IodmFsdWUsIGxhYmVscywgY29sb3JzKTsKCiAgICAgICAgICBpZiAoaXNQZXJjZW50YWdlTW9kZSkgewogICAgICAgICAgICB2YWx1ZSA9ICh2YWx1ZSAtIG1pbikgLyAobWF4IC0gbWluKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YWx1ZSA9IF90aGlzMi5nZXRGb3JtYXR0ZWRWYWx1ZShmb3JtYXR0ZXIsIHZhbHVlLCAnaHRtbCcpOwoKICAgICAgICAgIGlmIChidWNrZXRDb2x1bW5JZCkgewogICAgICAgICAgICB2YXIgYnVja2V0VmFsdWUgPSBfdGhpczIuZ2V0Rm9ybWF0dGVkVmFsdWUoYnVja2V0Rm9ybWF0dGVyLCByb3dbYnVja2V0Q29sdW1uSWRdKTsKCiAgICAgICAgICAgIHRpdGxlID0gIiIuY29uY2F0KGJ1Y2tldFZhbHVlLCAiIC0gIikuY29uY2F0KHRpdGxlKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgc2hvdWxkQ29sb3IgPSBjb25maWcuY29sb3JzUmFuZ2UubGVuZ3RoID4gMTsKICAgICAgICAgIG1ldHJpY3MucHVzaCh7CiAgICAgICAgICAgIGxhYmVsOiB0aXRsZSwKICAgICAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgICAgICBjb2xvcjogc2hvdWxkQ29sb3IgJiYgY29uZmlnLnN0eWxlLmxhYmVsQ29sb3IgPyBjb2xvciA6IHVuZGVmaW5lZCwKICAgICAgICAgICAgYmdDb2xvcjogc2hvdWxkQ29sb3IgJiYgY29uZmlnLnN0eWxlLmJnQ29sb3IgPyBjb2xvciA6IHVuZGVmaW5lZCwKICAgICAgICAgICAgbGlnaHRUZXh0OiBzaG91bGRDb2xvciAmJiBjb25maWcuc3R5bGUuYmdDb2xvciAmJiBfdGhpczIubmVlZHNMaWdodFRleHQoY29sb3IpLAogICAgICAgICAgICByb3dJbmRleDogcm93SW5kZXgKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgcmV0dXJuIG1ldHJpY3M7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB0aGlzLnByb3BzLnJlbmRlckNvbXBsZXRlKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50RGlkVXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRVcGRhdGUoKSB7CiAgICAgIHRoaXMucHJvcHMucmVuZGVyQ29tcGxldGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIG1ldHJpY3NIdG1sOwoKICAgICAgaWYgKHRoaXMucHJvcHMudmlzRGF0YSkgewogICAgICAgIHZhciBtZXRyaWNzID0gdGhpcy5wcm9jZXNzVGFibGVHcm91cHModGhpcy5wcm9wcy52aXNEYXRhKTsKICAgICAgICBtZXRyaWNzSHRtbCA9IG1ldHJpY3MubWFwKHRoaXMucmVuZGVyTWV0cmljKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJtdHJWaXMiCiAgICAgIH0sIG1ldHJpY3NIdG1sKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBNZXRyaWNWaXNDb21wb25lbnQ7Cn0oX3JlYWN0LkNvbXBvbmVudCk7CgpleHBvcnRzLk1ldHJpY1Zpc0NvbXBvbmVudCA9IE1ldHJpY1Zpc0NvbXBvbmVudDs="},null]}