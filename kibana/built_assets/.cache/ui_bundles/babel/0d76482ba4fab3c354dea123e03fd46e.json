{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/all/columns.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/all/columns.js","mtime":1589249553292},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmdldE1vbml0b3JpbmdDb2x1bW5zID0gZXhwb3J0cy5nZXRDb2x1bW5zID0gZXhwb3J0cy5nZXRBY3Rpb25zID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfcmVhY3QgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfZW1wdHlfdmFsdWUgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL2VtcHR5X3ZhbHVlIik7Cgp2YXIgX2Zvcm1hdHRlZF9kYXRlID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy9mb3JtYXR0ZWRfZGF0ZSIpOwoKdmFyIF9yZWRpcmVjdF90b19kZXRlY3Rpb25fZW5naW5lID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy9saW5rX3RvL3JlZGlyZWN0X3RvX2RldGVjdGlvbl9lbmdpbmUiKTsKCnZhciBfdHJ1bmNhdGFibGVfdGV4dCA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvdHJ1bmNhdGFibGVfdGV4dCIpOwoKdmFyIF9oZWxwZXJzID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9ydWxlX3N0YXR1cy9oZWxwZXJzIik7Cgp2YXIgX3J1bGVfc3dpdGNoID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9ydWxlX3N3aXRjaCIpOwoKdmFyIF9zZXZlcml0eV9iYWRnZSA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvc2V2ZXJpdHlfYmFkZ2UiKTsKCnZhciBpMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi4vdHJhbnNsYXRpb25zIikpOwoKdmFyIF9hY3Rpb25zID0gcmVxdWlyZSgiLi9hY3Rpb25zIik7Cgp2YXIgX2xvY2FsaXplZF9kYXRlX3Rvb2x0aXAgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL2xvY2FsaXplZF9kYXRlX3Rvb2x0aXAiKTsKCnZhciBkZXRlY3Rpb25JMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi4vLi4vdHJhbnNsYXRpb25zIikpOwoKdmFyIF9tbF9oZWxwZXJzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vY29tbW9uL2RldGVjdGlvbl9lbmdpbmUvbWxfaGVscGVycyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsKICB0cnkgewogICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOwogICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVqZWN0KGVycm9yKTsKICAgIHJldHVybjsKICB9CgogIGlmIChpbmZvLmRvbmUpIHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0gZWxzZSB7CiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7CiAgfQp9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgYXJncyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsKCiAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsKICAgICAgfQoKICAgICAgX25leHQodW5kZWZpbmVkKTsKICAgIH0pOwogIH07Cn0KCnZhciBnZXRBY3Rpb25zID0gZnVuY3Rpb24gZ2V0QWN0aW9ucyhkaXNwYXRjaCwgZGlzcGF0Y2hUb2FzdGVyLCBoaXN0b3J5LCByZUZldGNoUnVsZXMpIHsKICByZXR1cm4gW3sKICAgIGRlc2NyaXB0aW9uOiBpMThuLkVESVRfUlVMRV9TRVRUSU5HUywKICAgIHR5cGU6ICdpY29uJywKICAgIGljb246ICdjb250cm9sc0hvcml6b250YWwnLAogICAgbmFtZTogaTE4bi5FRElUX1JVTEVfU0VUVElOR1MsCiAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKHJvd0l0ZW0pIHsKICAgICAgcmV0dXJuICgwLCBfYWN0aW9ucy5lZGl0UnVsZUFjdGlvbikocm93SXRlbSwgaGlzdG9yeSk7CiAgICB9CiAgfSwgewogICAgZGVzY3JpcHRpb246IGkxOG4uRFVQTElDQVRFX1JVTEUsCiAgICB0eXBlOiAnaWNvbicsCiAgICBpY29uOiAnY29weScsCiAgICBuYW1lOiBpMThuLkRVUExJQ0FURV9SVUxFLAogICAgb25DbGljazogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX29uQ2xpY2sgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHJvd0l0ZW0pIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX2FjdGlvbnMuZHVwbGljYXRlUnVsZXNBY3Rpb24pKFtyb3dJdGVtXSwgW3Jvd0l0ZW0uaWRdLCBkaXNwYXRjaCwgZGlzcGF0Y2hUb2FzdGVyKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVGZXRjaFJ1bGVzKHRydWUpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gb25DbGljayhfeCkgewogICAgICAgIHJldHVybiBfb25DbGljay5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gb25DbGljazsKICAgIH0oKQogIH0sIHsKICAgIGRlc2NyaXB0aW9uOiBpMThuLkVYUE9SVF9SVUxFLAogICAgdHlwZTogJ2ljb24nLAogICAgaWNvbjogJ2V4cG9ydEFjdGlvbicsCiAgICBuYW1lOiBpMThuLkVYUE9SVF9SVUxFLAogICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhyb3dJdGVtKSB7CiAgICAgIHJldHVybiAoMCwgX2FjdGlvbnMuZXhwb3J0UnVsZXNBY3Rpb24pKFtyb3dJdGVtLnJ1bGVfaWRdLCBkaXNwYXRjaCk7CiAgICB9LAogICAgZW5hYmxlZDogZnVuY3Rpb24gZW5hYmxlZChyb3dJdGVtKSB7CiAgICAgIHJldHVybiAhcm93SXRlbS5pbW11dGFibGU7CiAgICB9CiAgfSwgewogICAgJ2RhdGEtdGVzdC1zdWJqJzogJ2RlbGV0ZVJ1bGVBY3Rpb24nLAogICAgZGVzY3JpcHRpb246IGkxOG4uREVMRVRFX1JVTEUsCiAgICB0eXBlOiAnaWNvbicsCiAgICBpY29uOiAndHJhc2gnLAogICAgbmFtZTogaTE4bi5ERUxFVEVfUlVMRSwKICAgIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9vbkNsaWNrMiA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKHJvd0l0ZW0pIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuICgwLCBfYWN0aW9ucy5kZWxldGVSdWxlc0FjdGlvbikoW3Jvd0l0ZW0uaWRdLCBkaXNwYXRjaCwgZGlzcGF0Y2hUb2FzdGVyKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIHJlRmV0Y2hSdWxlcyh0cnVlKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gb25DbGljayhfeDIpIHsKICAgICAgICByZXR1cm4gX29uQ2xpY2syLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBvbkNsaWNrOwogICAgfSgpCiAgfV07Cn07CgpleHBvcnRzLmdldEFjdGlvbnMgPSBnZXRBY3Rpb25zOyAvLyBNaWNoYWVsOiBBcmUgd2UgYWJsZSB0byBkbyBjdXN0b20sIGluLXRhYmxlLWhlYWRlciBmaWx0ZXJzLCBhcyBzaG93biBpbiBteSB3aXJlZnJhbWVzPwoKdmFyIGdldENvbHVtbnMgPSBmdW5jdGlvbiBnZXRDb2x1bW5zKF9yZWYpIHsKICB2YXIgZGlzcGF0Y2ggPSBfcmVmLmRpc3BhdGNoLAogICAgICBkaXNwYXRjaFRvYXN0ZXIgPSBfcmVmLmRpc3BhdGNoVG9hc3RlciwKICAgICAgaGlzdG9yeSA9IF9yZWYuaGlzdG9yeSwKICAgICAgaGFzTWxQZXJtaXNzaW9ucyA9IF9yZWYuaGFzTWxQZXJtaXNzaW9ucywKICAgICAgaGFzTm9QZXJtaXNzaW9ucyA9IF9yZWYuaGFzTm9QZXJtaXNzaW9ucywKICAgICAgbG9hZGluZ1J1bGVJZHMgPSBfcmVmLmxvYWRpbmdSdWxlSWRzLAogICAgICByZUZldGNoUnVsZXMgPSBfcmVmLnJlRmV0Y2hSdWxlczsKICB2YXIgY29scyA9IFt7CiAgICBmaWVsZDogJ25hbWUnLAogICAgbmFtZTogaTE4bi5DT0xVTU5fUlVMRSwKICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHZhbHVlLCBpdGVtKSB7CiAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicnVsZU5hbWUiLAogICAgICAgIGhyZWY6ICgwLCBfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZS5nZXRSdWxlRGV0YWlsc1VybCkoaXRlbS5pZCkKICAgICAgfSwgdmFsdWUpOwogICAgfSwKICAgIHRydW5jYXRlVGV4dDogdHJ1ZSwKICAgIHdpZHRoOiAnMjQlJwogIH0sIHsKICAgIGZpZWxkOiAncmlza19zY29yZScsCiAgICBuYW1lOiBpMThuLkNPTFVNTl9SSVNLX1NDT1JFLAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIodmFsdWUpIHsKICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgewogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJyaXNrU2NvcmUiLAogICAgICAgIHNpemU6ICJzIgogICAgICB9LCB2YWx1ZSk7CiAgICB9LAogICAgdHJ1bmNhdGVUZXh0OiB0cnVlLAogICAgd2lkdGg6ICcxNCUnCiAgfSwgewogICAgZmllbGQ6ICdzZXZlcml0eScsCiAgICBuYW1lOiBpMThuLkNPTFVNTl9TRVZFUklUWSwKICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHZhbHVlKSB7CiAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2V2ZXJpdHlfYmFkZ2UuU2V2ZXJpdHlCYWRnZSwgewogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9KTsKICAgIH0sCiAgICB0cnVuY2F0ZVRleHQ6IHRydWUsCiAgICB3aWR0aDogJzE2JScKICB9LCB7CiAgICBmaWVsZDogJ3N0YXR1c19kYXRlJywKICAgIG5hbWU6IGkxOG4uQ09MVU1OX0xBU1RfQ09NUExFVEVfUlVOLAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIodmFsdWUpIHsKICAgICAgcmV0dXJuIHZhbHVlID09IG51bGwgPyAoMCwgX2VtcHR5X3ZhbHVlLmdldEVtcHR5VGFnVmFsdWUpKCkgOiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfbG9jYWxpemVkX2RhdGVfdG9vbHRpcC5Mb2NhbGl6ZWREYXRlVG9vbHRpcCwgewogICAgICAgIGZpZWxkTmFtZTogaTE4bi5DT0xVTU5fTEFTVF9DT01QTEVURV9SVU4sCiAgICAgICAgZGF0ZTogbmV3IERhdGUodmFsdWUpCiAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5Gb3JtYXR0ZWRSZWxhdGl2ZSwgewogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9KSk7CiAgICB9LAogICAgdHJ1bmNhdGVUZXh0OiB0cnVlLAogICAgd2lkdGg6ICcyMCUnCiAgfSwgewogICAgZmllbGQ6ICdzdGF0dXMnLAogICAgbmFtZTogaTE4bi5DT0xVTU5fTEFTVF9SRVNQT05TRSwKICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHZhbHVlKSB7CiAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSGVhbHRoLCB7CiAgICAgICAgY29sb3I6ICgwLCBfaGVscGVycy5nZXRTdGF0dXNDb2xvcikodmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHZvaWQgMCA/IHZhbHVlIDogbnVsbCkKICAgICAgfSwgdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHZvaWQgMCA/IHZhbHVlIDogKDAsIF9lbXB0eV92YWx1ZS5nZXRFbXB0eVRhZ1ZhbHVlKSgpKSk7CiAgICB9LAogICAgd2lkdGg6ICcxNiUnLAogICAgdHJ1bmNhdGVUZXh0OiB0cnVlCiAgfSwgewogICAgZmllbGQ6ICd0YWdzJywKICAgIG5hbWU6IGkxOG4uQ09MVU1OX1RBR1MsCiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcih2YWx1ZSkgewogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3RydW5jYXRhYmxlX3RleHQuVHJ1bmNhdGFibGVUZXh0LCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInRhZ3MiCiAgICAgIH0sIHZhbHVlLm1hcChmdW5jdGlvbiAodGFnLCBpKSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQmFkZ2UsIHsKICAgICAgICAgIGNvbG9yOiAiaG9sbG93IiwKICAgICAgICAgIGtleTogIiIuY29uY2F0KHRhZywgIi0iKS5jb25jYXQoaSkKICAgICAgICB9LCB0YWcpOwogICAgICB9KSk7CiAgICB9LAogICAgdHJ1bmNhdGVUZXh0OiB0cnVlLAogICAgd2lkdGg6ICcyMCUnCiAgfSwgewogICAgYWxpZ246ICdjZW50ZXInLAogICAgZmllbGQ6ICdlbmFibGVkJywKICAgIG5hbWU6IGkxOG4uQ09MVU1OX0FDVElWQVRFLAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIodmFsdWUsIGl0ZW0pIHsKICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVG9vbFRpcCwgewogICAgICAgIHBvc2l0aW9uOiAidG9wIiwKICAgICAgICBjb250ZW50OiAoMCwgX21sX2hlbHBlcnMuaXNNbFJ1bGUpKGl0ZW0udHlwZSkgJiYgIWhhc01sUGVybWlzc2lvbnMgPyBkZXRlY3Rpb25JMThuLk1MX1JVTEVTX0RJU0FCTEVEX01FU1NBR0UgOiB1bmRlZmluZWQKICAgICAgfSwgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3J1bGVfc3dpdGNoLlJ1bGVTd2l0Y2gsIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiZW5hYmxlZCIsCiAgICAgICAgZGlzcGF0Y2g6IGRpc3BhdGNoLAogICAgICAgIGlkOiBpdGVtLmlkLAogICAgICAgIGVuYWJsZWQ6IGl0ZW0uZW5hYmxlZCwKICAgICAgICBpc0Rpc2FibGVkOiBoYXNOb1Blcm1pc3Npb25zIHx8ICgwLCBfbWxfaGVscGVycy5pc01sUnVsZSkoaXRlbS50eXBlKSAmJiAhaGFzTWxQZXJtaXNzaW9ucyAmJiAhaXRlbS5lbmFibGVkLAogICAgICAgIGlzTG9hZGluZzogbG9hZGluZ1J1bGVJZHMuaW5jbHVkZXMoaXRlbS5pZCkKICAgICAgfSkpOwogICAgfSwKICAgIHNvcnRhYmxlOiB0cnVlLAogICAgd2lkdGg6ICc5NXB4JwogIH1dOwogIHZhciBhY3Rpb25zID0gW3sKICAgIGFjdGlvbnM6IGdldEFjdGlvbnMoZGlzcGF0Y2gsIGRpc3BhdGNoVG9hc3RlciwgaGlzdG9yeSwgcmVGZXRjaFJ1bGVzKSwKICAgIHdpZHRoOiAnNDBweCcKICB9XTsKICByZXR1cm4gaGFzTm9QZXJtaXNzaW9ucyA/IGNvbHMgOiBbXS5jb25jYXQoY29scywgYWN0aW9ucyk7Cn07CgpleHBvcnRzLmdldENvbHVtbnMgPSBnZXRDb2x1bW5zOwoKdmFyIGdldE1vbml0b3JpbmdDb2x1bW5zID0gZnVuY3Rpb24gZ2V0TW9uaXRvcmluZ0NvbHVtbnMoKSB7CiAgdmFyIGNvbHMgPSBbewogICAgZmllbGQ6ICduYW1lJywKICAgIG5hbWU6IGkxOG4uQ09MVU1OX1JVTEUsCiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcih2YWx1ZSwgaXRlbSkgewogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInJ1bGVOYW1lIiwKICAgICAgICBocmVmOiAoMCwgX3JlZGlyZWN0X3RvX2RldGVjdGlvbl9lbmdpbmUuZ2V0UnVsZURldGFpbHNVcmwpKGl0ZW0uaWQpCiAgICAgIH0sIHZhbHVlKTsKICAgIH0sCiAgICB0cnVuY2F0ZVRleHQ6IHRydWUsCiAgICB3aWR0aDogJzI0JScKICB9LCB7CiAgICBmaWVsZDogJ2N1cnJlbnRfc3RhdHVzLmJ1bGtfY3JlYXRlX3RpbWVfZHVyYXRpb25zJywKICAgIG5hbWU6IGkxOG4uQ09MVU1OX0lOREVYSU5HX1RJTUVTLAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIodmFsdWUpIHsKICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgewogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJidWxrX2NyZWF0ZV90aW1lX2R1cmF0aW9ucyIsCiAgICAgICAgc2l6ZTogInMiCiAgICAgIH0sIHZhbHVlICE9IG51bGwgJiYgdmFsdWUubGVuZ3RoID4gMCA/IE1hdGgubWF4LmFwcGx5KE1hdGgsIF90b0NvbnN1bWFibGVBcnJheSh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmFsdWUubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIE51bWJlci5wYXJzZUZsb2F0KGl0ZW0pOwogICAgICB9KSkpIDogbnVsbCk7CiAgICB9LAogICAgdHJ1bmNhdGVUZXh0OiB0cnVlLAogICAgd2lkdGg6ICcxNCUnCiAgfSwgewogICAgZmllbGQ6ICdjdXJyZW50X3N0YXR1cy5zZWFyY2hfYWZ0ZXJfdGltZV9kdXJhdGlvbnMnLAogICAgbmFtZTogaTE4bi5DT0xVTU5fUVVFUllfVElNRVMsCiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcih2YWx1ZSkgewogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInNlYXJjaF9hZnRlcl90aW1lX2R1cmF0aW9ucyIsCiAgICAgICAgc2l6ZTogInMiCiAgICAgIH0sIHZhbHVlICE9IG51bGwgJiYgdmFsdWUubGVuZ3RoID4gMCA/IE1hdGgubWF4LmFwcGx5KE1hdGgsIF90b0NvbnN1bWFibGVBcnJheSh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdmFsdWUubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIE51bWJlci5wYXJzZUZsb2F0KGl0ZW0pOwogICAgICB9KSkpIDogbnVsbCk7CiAgICB9LAogICAgdHJ1bmNhdGVUZXh0OiB0cnVlLAogICAgd2lkdGg6ICcxNCUnCiAgfSwgewogICAgZmllbGQ6ICdjdXJyZW50X3N0YXR1cy5nYXAnLAogICAgbmFtZTogaTE4bi5DT0xVTU5fR0FQLAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIodmFsdWUpIHsKICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgewogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJnYXAiLAogICAgICAgIHNpemU6ICJzIgogICAgICB9LCB2YWx1ZSk7CiAgICB9LAogICAgdHJ1bmNhdGVUZXh0OiB0cnVlLAogICAgd2lkdGg6ICcxNCUnCiAgfSwgewogICAgZmllbGQ6ICdjdXJyZW50X3N0YXR1cy5sYXN0X2xvb2tfYmFja19kYXRlJywKICAgIG5hbWU6IGkxOG4uQ09MVU1OX0xBU1RfTE9PS0JBQ0tfREFURSwKICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHZhbHVlKSB7CiAgICAgIHJldHVybiB2YWx1ZSA9PSBudWxsID8gKDAsIF9lbXB0eV92YWx1ZS5nZXRFbXB0eVRhZ1ZhbHVlKSgpIDogX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2Zvcm1hdHRlZF9kYXRlLkZvcm1hdHRlZERhdGUsIHsKICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgZmllbGROYW1lOiAnbGFzdCBsb29rIGJhY2sgZGF0ZScKICAgICAgfSk7CiAgICB9LAogICAgdHJ1bmNhdGVUZXh0OiB0cnVlLAogICAgd2lkdGg6ICcxNiUnCiAgfSwgewogICAgZmllbGQ6ICdjdXJyZW50X3N0YXR1cy5zdGF0dXNfZGF0ZScsCiAgICBuYW1lOiBpMThuLkNPTFVNTl9MQVNUX0NPTVBMRVRFX1JVTiwKICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKHZhbHVlKSB7CiAgICAgIHJldHVybiB2YWx1ZSA9PSBudWxsID8gKDAsIF9lbXB0eV92YWx1ZS5nZXRFbXB0eVRhZ1ZhbHVlKSgpIDogX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2xvY2FsaXplZF9kYXRlX3Rvb2x0aXAuTG9jYWxpemVkRGF0ZVRvb2x0aXAsIHsKICAgICAgICBmaWVsZE5hbWU6IGkxOG4uQ09MVU1OX0xBU1RfQ09NUExFVEVfUlVOLAogICAgICAgIGRhdGU6IG5ldyBEYXRlKHZhbHVlKQogICAgICB9LCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRm9ybWF0dGVkUmVsYXRpdmUsIHsKICAgICAgICB2YWx1ZTogdmFsdWUKICAgICAgfSkpOwogICAgfSwKICAgIHRydW5jYXRlVGV4dDogdHJ1ZSwKICAgIHdpZHRoOiAnMjAlJwogIH0sIHsKICAgIGZpZWxkOiAnY3VycmVudF9zdGF0dXMuc3RhdHVzJywKICAgIG5hbWU6IGkxOG4uQ09MVU1OX0xBU1RfUkVTUE9OU0UsCiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcih2YWx1ZSkgewogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUhlYWx0aCwgewogICAgICAgIGNvbG9yOiAoMCwgX2hlbHBlcnMuZ2V0U3RhdHVzQ29sb3IpKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB2b2lkIDAgPyB2YWx1ZSA6IG51bGwpCiAgICAgIH0sIHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB2b2lkIDAgPyB2YWx1ZSA6ICgwLCBfZW1wdHlfdmFsdWUuZ2V0RW1wdHlUYWdWYWx1ZSkoKSkpOwogICAgfSwKICAgIHdpZHRoOiAnMTYlJywKICAgIHRydW5jYXRlVGV4dDogdHJ1ZQogIH0sIHsKICAgIGZpZWxkOiAnYWN0aXZhdGUnLAogICAgbmFtZTogaTE4bi5DT0xVTU5fQUNUSVZBVEUsCiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcih2YWx1ZSkgewogICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInNlYXJjaF9hZnRlcl90aW1lX2R1cmF0aW9ucyIsCiAgICAgICAgc2l6ZTogInMiCiAgICAgIH0sIHZhbHVlID8gaTE4bi5BQ1RJVkUgOiBpMThuLklOQUNUSVZFKTsKICAgIH0sCiAgICB3aWR0aDogJzk1cHgnCiAgfV07CiAgcmV0dXJuIGNvbHM7Cn07CgpleHBvcnRzLmdldE1vbml0b3JpbmdDb2x1bW5zID0gZ2V0TW9uaXRvcmluZ0NvbHVtbnM7"},null]}