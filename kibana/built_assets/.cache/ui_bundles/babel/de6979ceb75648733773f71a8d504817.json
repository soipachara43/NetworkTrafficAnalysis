{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/plugins/triggers_actions_ui/public/application/sections/action_connector_form/action_form.js","dependencies":[{"path":"x-pack/plugins/triggers_actions_ui/public/application/sections/action_connector_form/action_form.js","mtime":1589249555557},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFjdGlvbkZvcm0gPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9hY3Rpb25fY29ubmVjdG9yX2FwaSA9IHJlcXVpcmUoIi4uLy4uL2xpYi9hY3Rpb25fY29ubmVjdG9yX2FwaSIpOwoKdmFyIF9zZWN0aW9uX2xvYWRpbmcgPSByZXF1aXJlKCIuLi8uLi9jb21wb25lbnRzL3NlY3Rpb25fbG9hZGluZyIpOwoKdmFyIF9jb25uZWN0b3JfYWRkX21vZGFsID0gcmVxdWlyZSgiLi9jb25uZWN0b3JfYWRkX21vZGFsIik7Cgp2YXIgX2FjdGlvbl90eXBlX2NvbXBhcmUgPSByZXF1aXJlKCIuLi8uLi9saWIvYWN0aW9uX3R5cGVfY29tcGFyZSIpOwoKdmFyIF9jaGVja19hY3Rpb25fdHlwZV9lbmFibGVkID0gcmVxdWlyZSgiLi4vLi4vbGliL2NoZWNrX2FjdGlvbl90eXBlX2VuYWJsZWQiKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsKICB0cnkgewogICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOwogICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVqZWN0KGVycm9yKTsKICAgIHJldHVybjsKICB9CgogIGlmIChpbmZvLmRvbmUpIHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0gZWxzZSB7CiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7CiAgfQp9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgYXJncyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsKCiAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsKICAgICAgfQoKICAgICAgX25leHQodW5kZWZpbmVkKTsKICAgIH0pOwogIH07Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciBBY3Rpb25Gb3JtID0gZnVuY3Rpb24gQWN0aW9uRm9ybShfcmVmKSB7CiAgdmFyIGFjdGlvbnMgPSBfcmVmLmFjdGlvbnMsCiAgICAgIGRlZmF1bHRBY3Rpb25Hcm91cElkID0gX3JlZi5kZWZhdWx0QWN0aW9uR3JvdXBJZCwKICAgICAgc2V0QWN0aW9uSWRCeUluZGV4ID0gX3JlZi5zZXRBY3Rpb25JZEJ5SW5kZXgsCiAgICAgIHNldEFsZXJ0UHJvcGVydHkgPSBfcmVmLnNldEFsZXJ0UHJvcGVydHksCiAgICAgIHNldEFjdGlvblBhcmFtc1Byb3BlcnR5ID0gX3JlZi5zZXRBY3Rpb25QYXJhbXNQcm9wZXJ0eSwKICAgICAgaHR0cCA9IF9yZWYuaHR0cCwKICAgICAgYWN0aW9uVHlwZVJlZ2lzdHJ5ID0gX3JlZi5hY3Rpb25UeXBlUmVnaXN0cnksCiAgICAgIGFjdGlvblR5cGVzID0gX3JlZi5hY3Rpb25UeXBlcywKICAgICAgbWVzc2FnZVZhcmlhYmxlcyA9IF9yZWYubWVzc2FnZVZhcmlhYmxlcywKICAgICAgZGVmYXVsdEFjdGlvbk1lc3NhZ2UgPSBfcmVmLmRlZmF1bHRBY3Rpb25NZXNzYWdlLAogICAgICB0b2FzdE5vdGlmaWNhdGlvbnMgPSBfcmVmLnRvYXN0Tm90aWZpY2F0aW9ucywKICAgICAgc2V0SGFzQWN0aW9uc0Rpc2FibGVkID0gX3JlZi5zZXRIYXNBY3Rpb25zRGlzYWJsZWQ7CgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShmYWxzZSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBhZGRNb2RhbFZpc2libGUgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRBZGRNb2RhbFZpc2liaWxpdHkgPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgX3VzZVN0YXRlMyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHVuZGVmaW5lZCksCiAgICAgIF91c2VTdGF0ZTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUzLCAyKSwKICAgICAgYWN0aXZlQWN0aW9uSXRlbSA9IF91c2VTdGF0ZTRbMF0sCiAgICAgIHNldEFjdGl2ZUFjdGlvbkl0ZW0gPSBfdXNlU3RhdGU0WzFdOwoKICB2YXIgX3VzZVN0YXRlNSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHRydWUpLAogICAgICBfdXNlU3RhdGU2ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNSwgMiksCiAgICAgIGlzQWRkQWN0aW9uUGFuZWxPcGVuID0gX3VzZVN0YXRlNlswXSwKICAgICAgc2V0SXNBZGRBY3Rpb25QYW5lbE9wZW4gPSBfdXNlU3RhdGU2WzFdOwoKICB2YXIgX3VzZVN0YXRlNyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKFtdKSwKICAgICAgX3VzZVN0YXRlOCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTcsIDIpLAogICAgICBjb25uZWN0b3JzID0gX3VzZVN0YXRlOFswXSwKICAgICAgc2V0Q29ubmVjdG9ycyA9IF91c2VTdGF0ZThbMV07CgogIHZhciBfdXNlU3RhdGU5ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGUxMCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTksIDIpLAogICAgICBpc0xvYWRpbmdDb25uZWN0b3JzID0gX3VzZVN0YXRlMTBbMF0sCiAgICAgIHNldElzTG9hZGluZ0Nvbm5lY3RvcnMgPSBfdXNlU3RhdGUxMFsxXTsKCiAgdmFyIF91c2VTdGF0ZTExID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGUxMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTExLCAyKSwKICAgICAgaXNMb2FkaW5nQWN0aW9uVHlwZXMgPSBfdXNlU3RhdGUxMlswXSwKICAgICAgc2V0SXNMb2FkaW5nQWN0aW9uVHlwZXMgPSBfdXNlU3RhdGUxMlsxXTsKCiAgdmFyIF91c2VTdGF0ZTEzID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkodW5kZWZpbmVkKSwKICAgICAgX3VzZVN0YXRlMTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUxMywgMiksCiAgICAgIGFjdGlvblR5cGVzSW5kZXggPSBfdXNlU3RhdGUxNFswXSwKICAgICAgc2V0QWN0aW9uVHlwZXNJbmRleCA9IF91c2VTdGF0ZTE0WzFdOwoKICB2YXIgX3VzZVN0YXRlMTUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShbXSksCiAgICAgIF91c2VTdGF0ZTE2ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlMTUsIDIpLAogICAgICBlbXB0eUFjdGlvbnNJZHMgPSBfdXNlU3RhdGUxNlswXSwKICAgICAgc2V0RW1wdHlBY3Rpb25zSWRzID0gX3VzZVN0YXRlMTZbMV07IC8vIGxvYWQgYWN0aW9uIHR5cGVzCgoKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAvKiNfX1BVUkVfXyovCiAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICB2YXIgcmVnaXN0ZXJlZEFjdGlvblR5cGVzLCBfaW5kZXgsIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24sIF9kaWRJdGVyYXRvckVycm9yLCBfaXRlcmF0b3JFcnJvciwgX2l0ZXJhdG9yLCBfc3RlcCwgYWN0aW9uVHlwZUl0ZW0sIGhhc0FjdGlvbnNEaXNhYmxlZDsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKICAgICAgICAgICAgICBzZXRJc0xvYWRpbmdBY3Rpb25UeXBlcyh0cnVlKTsKCiAgICAgICAgICAgICAgaWYgKCEoYWN0aW9uVHlwZXMgIT09IG51bGwgJiYgYWN0aW9uVHlwZXMgIT09IHZvaWQgMCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IGFjdGlvblR5cGVzOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgIHJldHVybiAoMCwgX2FjdGlvbl9jb25uZWN0b3JfYXBpLmxvYWRBY3Rpb25UeXBlcykoewogICAgICAgICAgICAgICAgaHR0cDogaHR0cAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBfY29udGV4dC50MSA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKTsKICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICByZWdpc3RlcmVkQWN0aW9uVHlwZXMgPSBfY29udGV4dC50MC5zb3J0KF9jb250ZXh0LnQxKTsKICAgICAgICAgICAgICBfaW5kZXggPSB7fTsKICAgICAgICAgICAgICBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTsKICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlOwogICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxNTsKCiAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IgPSByZWdpc3RlcmVkQWN0aW9uVHlwZXNbU3ltYm9sLml0ZXJhdG9yXSgpOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHsKICAgICAgICAgICAgICAgIGFjdGlvblR5cGVJdGVtID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICAgICAgICBfaW5kZXhbYWN0aW9uVHlwZUl0ZW0uaWRdID0gYWN0aW9uVHlwZUl0ZW07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxOTsKICAgICAgICAgICAgICBfY29udGV4dC50MiA9IF9jb250ZXh0WyJjYXRjaCJdKDE1KTsKICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBfY29udGV4dC50MjsKCiAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDIzOwogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyNDsKCiAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgX2l0ZXJhdG9yLnJldHVybigpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI2OwoKICAgICAgICAgICAgICBpZiAoIV9kaWRJdGVyYXRvckVycm9yKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yOwoKICAgICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuZmluaXNoKDI2KTsKCiAgICAgICAgICAgIGNhc2UgMzA6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmZpbmlzaCgyMyk7CgogICAgICAgICAgICBjYXNlIDMxOgogICAgICAgICAgICAgIHNldEFjdGlvblR5cGVzSW5kZXgoX2luZGV4KTsKICAgICAgICAgICAgICBoYXNBY3Rpb25zRGlzYWJsZWQgPSBhY3Rpb25zLnNvbWUoZnVuY3Rpb24gKGFjdGlvbikgewogICAgICAgICAgICAgICAgcmV0dXJuICFfaW5kZXhbYWN0aW9uLmFjdGlvblR5cGVJZF0uZW5hYmxlZDsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgaWYgKHNldEhhc0FjdGlvbnNEaXNhYmxlZCkgewogICAgICAgICAgICAgICAgc2V0SGFzQWN0aW9uc0Rpc2FibGVkKGhhc0FjdGlvbnNEaXNhYmxlZCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDM2OgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAzNjsKICAgICAgICAgICAgICBfY29udGV4dC50MyA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICBpZiAodG9hc3ROb3RpZmljYXRpb25zKSB7CiAgICAgICAgICAgICAgICB0b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKHsKICAgICAgICAgICAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmlnZ2Vyc0FjdGlvbnNVSS5zZWN0aW9ucy5hbGVydEZvcm0udW5hYmxlVG9Mb2FkQWN0aW9uVHlwZXNNZXNzYWdlJywgewogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5hYmxlIHRvIGxvYWQgYWN0aW9uIHR5cGVzJwogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2FzZSAzOToKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMzk7CiAgICAgICAgICAgICAgc2V0SXNMb2FkaW5nQWN0aW9uVHlwZXMoZmFsc2UpOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5maW5pc2goMzkpOwoKICAgICAgICAgICAgY2FzZSA0MjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1swLCAzNiwgMzksIDQyXSwgWzE1LCAxOSwgMjMsIDMxXSwgWzI0LCwgMjYsIDMwXV0pOwogICAgfSkpKCk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHMKCiAgfSwgW10pOwogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICBsb2FkQ29ubmVjdG9ycygpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzCiAgfSwgW10pOwoKICBmdW5jdGlvbiBsb2FkQ29ubmVjdG9ycygpIHsKICAgIHJldHVybiBfbG9hZENvbm5lY3RvcnMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIGZ1bmN0aW9uIF9sb2FkQ29ubmVjdG9ycygpIHsKICAgIF9sb2FkQ29ubmVjdG9ycyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgLyojX19QVVJFX18qLwogICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgIHZhciBhY3Rpb25zUmVzcG9uc2U7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAwOwogICAgICAgICAgICAgIHNldElzTG9hZGluZ0Nvbm5lY3RvcnModHJ1ZSk7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiAoMCwgX2FjdGlvbl9jb25uZWN0b3JfYXBpLmxvYWRBbGxBY3Rpb25zKSh7CiAgICAgICAgICAgICAgICBodHRwOiBodHRwCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgYWN0aW9uc1Jlc3BvbnNlID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgc2V0Q29ubmVjdG9ycyhhY3Rpb25zUmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDg7CiAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyWyJjYXRjaCJdKDApOwogICAgICAgICAgICAgIHRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoewogICAgICAgICAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay50cmlnZ2Vyc0FjdGlvbnNVSS5zZWN0aW9ucy5hbGVydEZvcm0udW5hYmxlVG9Mb2FkQWN0aW9uc01lc3NhZ2UnLCB7CiAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5hYmxlIHRvIGxvYWQgY29ubmVjdG9ycycKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMTE7CiAgICAgICAgICAgICAgc2V0SXNMb2FkaW5nQ29ubmVjdG9ycyhmYWxzZSk7CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5maW5pc2goMTEpOwoKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyLCBudWxsLCBbWzAsIDgsIDExLCAxNF1dKTsKICAgIH0pKTsKICAgIHJldHVybiBfbG9hZENvbm5lY3RvcnMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIHZhciBnZXRTZWxlY3RlZE9wdGlvbnMgPSBmdW5jdGlvbiBnZXRTZWxlY3RlZE9wdGlvbnMoYWN0aW9uSXRlbUlkKSB7CiAgICB2YXIgdmFsID0gY29ubmVjdG9ycy5maW5kKGZ1bmN0aW9uIChjb25uZWN0b3IpIHsKICAgICAgcmV0dXJuIGNvbm5lY3Rvci5pZCA9PT0gYWN0aW9uSXRlbUlkOwogICAgfSk7CgogICAgaWYgKCF2YWwpIHsKICAgICAgcmV0dXJuIFtdOwogICAgfQoKICAgIHJldHVybiBbewogICAgICBsYWJlbDogdmFsLm5hbWUsCiAgICAgIHZhbHVlOiB2YWwubmFtZSwKICAgICAgaWQ6IGFjdGlvbkl0ZW1JZAogICAgfV07CiAgfTsKCiAgdmFyIGdldEFjdGlvblR5cGVGb3JtID0gZnVuY3Rpb24gZ2V0QWN0aW9uVHlwZUZvcm0oYWN0aW9uSXRlbSwgYWN0aW9uQ29ubmVjdG9yLCBhY3Rpb25QYXJhbXNFcnJvcnMsIGluZGV4KSB7CiAgICB2YXIgb3B0aW9uc0xpc3QgPSBjb25uZWN0b3JzLmZpbHRlcihmdW5jdGlvbiAoY29ubmVjdG9ySXRlbSkgewogICAgICByZXR1cm4gY29ubmVjdG9ySXRlbS5hY3Rpb25UeXBlSWQgPT09IGFjdGlvbkl0ZW0uYWN0aW9uVHlwZUlkICYmIGNvbm5lY3Rvckl0ZW0uaWQgPT09IGFjdGlvbkl0ZW0uaWQ7CiAgICB9KS5tYXAoZnVuY3Rpb24gKF9yZWYzKSB7CiAgICAgIHZhciBuYW1lID0gX3JlZjMubmFtZSwKICAgICAgICAgIGlkID0gX3JlZjMuaWQ7CiAgICAgIHJldHVybiB7CiAgICAgICAgbGFiZWw6IG5hbWUsCiAgICAgICAga2V5OiBpZCwKICAgICAgICBpZDogaWQKICAgICAgfTsKICAgIH0pOwogICAgdmFyIGFjdGlvblR5cGVSZWdpc3RlcmVkID0gYWN0aW9uVHlwZVJlZ2lzdHJ5LmdldChhY3Rpb25Db25uZWN0b3IuYWN0aW9uVHlwZUlkKTsKICAgIGlmICghYWN0aW9uVHlwZVJlZ2lzdGVyZWQgfHwgYWN0aW9uSXRlbS5ncm91cCAhPT0gZGVmYXVsdEFjdGlvbkdyb3VwSWQpIHJldHVybiBudWxsOwogICAgdmFyIFBhcmFtc0ZpZWxkc0NvbXBvbmVudCA9IGFjdGlvblR5cGVSZWdpc3RlcmVkLmFjdGlvblBhcmFtc0ZpZWxkczsKICAgIHZhciBjaGVja0VuYWJsZWRSZXN1bHQgPSAoMCwgX2NoZWNrX2FjdGlvbl90eXBlX2VuYWJsZWQuY2hlY2tBY3Rpb25UeXBlRW5hYmxlZCkoYWN0aW9uVHlwZXNJbmRleCAmJiBhY3Rpb25UeXBlc0luZGV4W2FjdGlvbkNvbm5lY3Rvci5hY3Rpb25UeXBlSWRdKTsKICAgIHZhciBhY2NvcmRpb25Db250ZW50ID0gY2hlY2tFbmFibGVkUmVzdWx0LmlzRW5hYmxlZCA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgIGNvbXBvbmVudDogImRpdiIKICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm1Sb3csIHsKICAgICAgZnVsbFdpZHRoOiB0cnVlLAogICAgICBsYWJlbDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0Rm9ybS5hY3Rpb25JZExhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIntjb25uZWN0b3JJbnN0YW5jZX0gY29ubmVjdG9yIiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIGNvbm5lY3Rvckluc3RhbmNlOiBhY3Rpb25UeXBlc0luZGV4ID8gYWN0aW9uVHlwZXNJbmRleFthY3Rpb25Db25uZWN0b3IuYWN0aW9uVHlwZUlkXS5uYW1lIDogYWN0aW9uQ29ubmVjdG9yLmFjdGlvblR5cGVJZAogICAgICAgIH0KICAgICAgfSksCiAgICAgIGxhYmVsQXBwZW5kOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uRW1wdHksIHsKICAgICAgICBzaXplOiAieHMiLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICBzZXRBY3RpdmVBY3Rpb25JdGVtKHsKICAgICAgICAgICAgYWN0aW9uVHlwZUlkOiBhY3Rpb25JdGVtLmFjdGlvblR5cGVJZCwKICAgICAgICAgICAgaW5kZXg6IGluZGV4CiAgICAgICAgICB9KTsKICAgICAgICAgIHNldEFkZE1vZGFsVmlzaWJpbGl0eSh0cnVlKTsKICAgICAgICB9CiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJBZGQgbmV3IiwKICAgICAgICBpZDogInhwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0Rm9ybS5hZGROZXdDb25uZWN0b3JFbXB0eUJ1dHRvbiIKICAgICAgfSkpCiAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29tYm9Cb3gsIHsKICAgICAgZnVsbFdpZHRoOiB0cnVlLAogICAgICBzaW5nbGVTZWxlY3Rpb246IHsKICAgICAgICBhc1BsYWluVGV4dDogdHJ1ZQogICAgICB9LAogICAgICBvcHRpb25zOiBvcHRpb25zTGlzdCwKICAgICAgc2VsZWN0ZWRPcHRpb25zOiBnZXRTZWxlY3RlZE9wdGlvbnMoYWN0aW9uSXRlbS5pZCksCiAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShzZWxlY3RlZE9wdGlvbnMpIHsKICAgICAgICB2YXIgX3NlbGVjdGVkT3B0aW9ucyQwJGlkOwoKICAgICAgICBzZXRBY3Rpb25JZEJ5SW5kZXgoKF9zZWxlY3RlZE9wdGlvbnMkMCRpZCA9IHNlbGVjdGVkT3B0aW9uc1swXS5pZCkgIT09IG51bGwgJiYgX3NlbGVjdGVkT3B0aW9ucyQwJGlkICE9PSB2b2lkIDAgPyBfc2VsZWN0ZWRPcHRpb25zJDAkaWQgOiAnJywgaW5kZXgpOwogICAgICB9LAogICAgICBpc0NsZWFyYWJsZTogZmFsc2UKICAgIH0pKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgIHNpemU6ICJ4bCIKICAgIH0pLCBQYXJhbXNGaWVsZHNDb21wb25lbnQgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFBhcmFtc0ZpZWxkc0NvbXBvbmVudCwgewogICAgICBhY3Rpb25QYXJhbXM6IGFjdGlvbkl0ZW0ucGFyYW1zLAogICAgICBpbmRleDogaW5kZXgsCiAgICAgIGVycm9yczogYWN0aW9uUGFyYW1zRXJyb3JzLmVycm9ycywKICAgICAgZWRpdEFjdGlvbjogc2V0QWN0aW9uUGFyYW1zUHJvcGVydHksCiAgICAgIG1lc3NhZ2VWYXJpYWJsZXM6IG1lc3NhZ2VWYXJpYWJsZXMsCiAgICAgIGRlZmF1bHRNZXNzYWdlOiBkZWZhdWx0QWN0aW9uTWVzc2FnZSAhPT0gbnVsbCAmJiBkZWZhdWx0QWN0aW9uTWVzc2FnZSAhPT0gdm9pZCAwID8gZGVmYXVsdEFjdGlvbk1lc3NhZ2UgOiB1bmRlZmluZWQKICAgIH0pIDogbnVsbCkgOiBjaGVja0VuYWJsZWRSZXN1bHQubWVzc2FnZUNhcmQ7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUFjY29yZGlvbiwgewogICAgICBpbml0aWFsSXNPcGVuOiB0cnVlLAogICAgICBrZXk6IGluZGV4LAogICAgICBpZDogaW5kZXgudG9TdHJpbmcoKSwKICAgICAgY2xhc3NOYW1lOiAiYWN0QWNjb3JkaW9uQWN0aW9uRm9ybSIsCiAgICAgIGJ1dHRvbkNvbnRlbnRDbGFzc05hbWU6ICJhY3RBY2NvcmRpb25BY3Rpb25Gb3JtX19idXR0b24iLAogICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiYWxlcnRBY3Rpb25BY2NvcmRpb24tIi5jb25jYXQoZGVmYXVsdEFjdGlvbkdyb3VwSWQpLAogICAgICBidXR0b25Db250ZW50OiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAgZ3V0dGVyU2l6ZTogInMiLAogICAgICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgdHlwZTogYWN0aW9uVHlwZVJlZ2lzdGVyZWQuaWNvbkNsYXNzLAogICAgICAgIHNpemU6ICJtIgogICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICAgICAgc2l6ZTogInMiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImg1IiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgIGd1dHRlclNpemU6ICJzIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICBncm93OiBmYWxzZQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAie2FjdGlvbkNvbm5lY3Rvck5hbWV9IiwKICAgICAgICBpZDogInhwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0Rm9ybS5zZWxlY3RBbGVydEFjdGlvblR5cGVFZGl0VGl0bGUiLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgYWN0aW9uQ29ubmVjdG9yTmFtZTogYWN0aW9uQ29ubmVjdG9yLm5hbWUKICAgICAgICB9CiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgY2hlY2tFbmFibGVkUmVzdWx0LmlzRW5hYmxlZCA9PT0gZmFsc2UgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uVGlwLCB7CiAgICAgICAgdHlwZTogImFsZXJ0IiwKICAgICAgICBjb2xvcjogImRhbmdlciIsCiAgICAgICAgY29udGVudDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0Rm9ybS5hY3Rpb25EaXNhYmxlZFRpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGlzIGFjdGlvbiBpcyBkaXNhYmxlZCcKICAgICAgICB9KSwKICAgICAgICBwb3NpdGlvbjogInJpZ2h0IgogICAgICB9KSkpKSkpKSksCiAgICAgIGV4dHJhQWN0aW9uOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uSWNvbiwgewogICAgICAgIGljb25UeXBlOiAiY3Jvc3MiLAogICAgICAgIGNvbG9yOiAiZGFuZ2VyIiwKICAgICAgICBjbGFzc05hbWU6ICJhY3RBY2NvcmRpb25BY3Rpb25Gb3JtX19leHRyYUFjdGlvbiIsCiAgICAgICAgImFyaWEtbGFiZWwiOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJpZ2dlcnNBY3Rpb25zVUkuc2VjdGlvbnMuYWxlcnRGb3JtLmFjY29yZGlvbi5kZWxldGVJY29uQXJpYUxhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZWxldGUnCiAgICAgICAgfSksCiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgIHZhciB1cGRhdGVkQWN0aW9ucyA9IGFjdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChfaXRlbSwgaSkgewogICAgICAgICAgICByZXR1cm4gaSAhPT0gaW5kZXg7CiAgICAgICAgICB9KTsKICAgICAgICAgIHNldEFsZXJ0UHJvcGVydHkodXBkYXRlZEFjdGlvbnMpOwogICAgICAgICAgc2V0SXNBZGRBY3Rpb25QYW5lbE9wZW4odXBkYXRlZEFjdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLmlkICE9PSBhY3Rpb25JdGVtLmlkOwogICAgICAgICAgfSkubGVuZ3RoID09PSAwKTsKICAgICAgICAgIHNldEFjdGl2ZUFjdGlvbkl0ZW0odW5kZWZpbmVkKTsKICAgICAgICB9CiAgICAgIH0pLAogICAgICBwYWRkaW5nU2l6ZTogImwiCiAgICB9LCBhY2NvcmRpb25Db250ZW50KTsKICB9OwoKICB2YXIgZ2V0QWRkQ29ubmVjdG9yc0Zvcm0gPSBmdW5jdGlvbiBnZXRBZGRDb25uZWN0b3JzRm9ybShhY3Rpb25JdGVtLCBpbmRleCkgewogICAgdmFyIGFjdGlvblR5cGVOYW1lID0gYWN0aW9uVHlwZXNJbmRleCA/IGFjdGlvblR5cGVzSW5kZXhbYWN0aW9uSXRlbS5hY3Rpb25UeXBlSWRdLm5hbWUgOiBhY3Rpb25JdGVtLmFjdGlvblR5cGVJZDsKICAgIHZhciBhY3Rpb25UeXBlUmVnaXN0ZXJlZCA9IGFjdGlvblR5cGVSZWdpc3RyeS5nZXQoYWN0aW9uSXRlbS5hY3Rpb25UeXBlSWQpOwogICAgaWYgKCFhY3Rpb25UeXBlUmVnaXN0ZXJlZCB8fCBhY3Rpb25JdGVtLmdyb3VwICE9PSBkZWZhdWx0QWN0aW9uR3JvdXBJZCkgcmV0dXJuIG51bGw7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUFjY29yZGlvbiwgewogICAgICBpbml0aWFsSXNPcGVuOiB0cnVlLAogICAgICBrZXk6IGluZGV4LAogICAgICBpZDogaW5kZXgudG9TdHJpbmcoKSwKICAgICAgY2xhc3NOYW1lOiAiYWN0QWNjb3JkaW9uQWN0aW9uRm9ybSIsCiAgICAgIGJ1dHRvbkNvbnRlbnRDbGFzc05hbWU6ICJhY3RBY2NvcmRpb25BY3Rpb25Gb3JtX19idXR0b24iLAogICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiYWxlcnRBY3Rpb25BY2NvcmRpb24tIi5jb25jYXQoZGVmYXVsdEFjdGlvbkdyb3VwSWQpLAogICAgICBidXR0b25Db250ZW50OiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAgZ3V0dGVyU2l6ZTogInMiLAogICAgICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgdHlwZTogYWN0aW9uVHlwZVJlZ2lzdGVyZWQuaWNvbkNsYXNzLAogICAgICAgIHNpemU6ICJtIgogICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICAgICAgc2l6ZTogInMiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImg1IiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogInthY3Rpb25Db25uZWN0b3JOYW1lfSIsCiAgICAgICAgaWQ6ICJ4cGFjay50cmlnZ2Vyc0FjdGlvbnNVSS5zZWN0aW9ucy5hbGVydEZvcm0uc2VsZWN0QWxlcnRBY3Rpb25UeXBlRWRpdFRpdGxlIiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIGFjdGlvbkNvbm5lY3Rvck5hbWU6IGFjdGlvblR5cGVSZWdpc3RlcmVkLmFjdGlvblR5cGVUaXRsZQogICAgICAgIH0KICAgICAgfSkpKSkpLAogICAgICBleHRyYUFjdGlvbjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkljb24sIHsKICAgICAgICBpY29uVHlwZTogImNyb3NzIiwKICAgICAgICBjb2xvcjogImRhbmdlciIsCiAgICAgICAgY2xhc3NOYW1lOiAiYWN0QWNjb3JkaW9uQWN0aW9uRm9ybV9fZXh0cmFBY3Rpb24iLAogICAgICAgICJhcmlhLWxhYmVsIjogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0Rm9ybS5hY2NvcmRpb24uZGVsZXRlSWNvbkFyaWFMYWJlbCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRGVsZXRlJwogICAgICAgIH0pLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICB2YXIgdXBkYXRlZEFjdGlvbnMgPSBhY3Rpb25zLmZpbHRlcihmdW5jdGlvbiAoX2l0ZW0sIGkpIHsKICAgICAgICAgICAgcmV0dXJuIGkgIT09IGluZGV4OwogICAgICAgICAgfSk7CiAgICAgICAgICBzZXRBbGVydFByb3BlcnR5KHVwZGF0ZWRBY3Rpb25zKTsKICAgICAgICAgIHNldElzQWRkQWN0aW9uUGFuZWxPcGVuKHVwZGF0ZWRBY3Rpb25zLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaXRlbS5pZCAhPT0gYWN0aW9uSXRlbS5pZDsKICAgICAgICAgIH0pLmxlbmd0aCA9PT0gMCk7CiAgICAgICAgICBzZXRBY3RpdmVBY3Rpb25JdGVtKHVuZGVmaW5lZCk7CiAgICAgICAgfQogICAgICB9KSwKICAgICAgcGFkZGluZ1NpemU6ICJsIgogICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUVtcHR5UHJvbXB0LCB7CiAgICAgIHRpdGxlOiBlbXB0eUFjdGlvbnNJZHMuZmluZChmdW5jdGlvbiAoZW1wdHlJZCkgewogICAgICAgIHJldHVybiBhY3Rpb25JdGVtLmlkID09PSBlbXB0eUlkOwogICAgICB9KSA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay50cmlnZ2Vyc0FjdGlvbnNVSS5zZWN0aW9ucy5hbGVydEZvcm0uZW1wdHlDb25uZWN0b3JzTGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTm8ge2FjdGlvblR5cGVOYW1lfSBjb25uZWN0b3JzLiIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBhY3Rpb25UeXBlTmFtZTogYWN0aW9uVHlwZU5hbWUKICAgICAgICB9CiAgICAgIH0pIDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNhbGxPdXQsIHsKICAgICAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0Rm9ybS51bmFibGVUb0xvYWRDb25uZWN0b3JUaXRsZScsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnVW5hYmxlIHRvIGxvYWQgY29ubmVjdG9yLicKICAgICAgICB9KSwKICAgICAgICBjb2xvcjogIndhcm5pbmciCiAgICAgIH0pLAogICAgICBhY3Rpb25zOiBbX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgIGNvbG9yOiAicHJpbWFyeSIsCiAgICAgICAgZmlsbDogdHJ1ZSwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiY3JlYXRlQWN0aW9uQ29ubmVjdG9yQnV0dG9uIiwKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgc2V0QWN0aXZlQWN0aW9uSXRlbSh7CiAgICAgICAgICAgIGFjdGlvblR5cGVJZDogYWN0aW9uSXRlbS5hY3Rpb25UeXBlSWQsCiAgICAgICAgICAgIGluZGV4OiBpbmRleAogICAgICAgICAgfSk7CiAgICAgICAgICBzZXRBZGRNb2RhbFZpc2liaWxpdHkodHJ1ZSk7CiAgICAgICAgfQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2sudHJpZ2dlcnNBY3Rpb25zVUkuc2VjdGlvbnMuYWxlcnRGb3JtLmFkZENvbm5lY3RvckJ1dHRvbkxhYmVsIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkNyZWF0ZSBhIGNvbm5lY3RvciIKICAgICAgfSkpXQogICAgfSkpOwogIH07CgogIGZ1bmN0aW9uIGFkZEFjdGlvblR5cGUoYWN0aW9uVHlwZU1vZGVsKSB7CiAgICBpZiAoIWRlZmF1bHRBY3Rpb25Hcm91cElkKSB7CiAgICAgIHRvYXN0Tm90aWZpY2F0aW9ucy5hZGREYW5nZXIoewogICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2sudHJpZ2dlcnNBY3Rpb25zVUkuc2VjdGlvbnMuYWxlcnRGb3JtLnVuYWJsZVRvQWRkQWN0aW9uJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmFibGUgdG8gYWRkIGFjdGlvbiwgYmVjYXVzZSBkZWZhdWx0IGFjdGlvbiBncm91cCBpcyBub3QgZGVmaW5lZCcKICAgICAgICB9KQogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHNldElzQWRkQWN0aW9uUGFuZWxPcGVuKGZhbHNlKTsKICAgIHZhciBhY3Rpb25UeXBlQ29ubmVjdG9ycyA9IGNvbm5lY3RvcnMuZmlsdGVyKGZ1bmN0aW9uIChmaWVsZCkgewogICAgICByZXR1cm4gZmllbGQuYWN0aW9uVHlwZUlkID09PSBhY3Rpb25UeXBlTW9kZWwuaWQ7CiAgICB9KTsKCiAgICBpZiAoYWN0aW9uVHlwZUNvbm5lY3RvcnMubGVuZ3RoID4gMCkgewogICAgICBhY3Rpb25zLnB1c2goewogICAgICAgIGlkOiAnJywKICAgICAgICBhY3Rpb25UeXBlSWQ6IGFjdGlvblR5cGVNb2RlbC5pZCwKICAgICAgICBncm91cDogZGVmYXVsdEFjdGlvbkdyb3VwSWQsCiAgICAgICAgcGFyYW1zOiB7fQogICAgICB9KTsKICAgICAgc2V0QWN0aW9uSWRCeUluZGV4KGFjdGlvblR5cGVDb25uZWN0b3JzWzBdLmlkLCBhY3Rpb25zLmxlbmd0aCAtIDEpOwogICAgfQoKICAgIGlmIChhY3Rpb25UeXBlQ29ubmVjdG9ycy5sZW5ndGggPT09IDApIHsKICAgICAgLy8gaWYgbm8gY29ubmVjdG9ycyBleGlzdHMgb3IgYWxsIGNvbm5lY3RvcnMgaXMgYWxyZWFkeSBhc3NpZ25lZCBhbiBhY3Rpb24gdW5kZXIgY3VycmVudCBhbGVydAogICAgICAvLyBzZXQgYWN0aW9uVHlwZSBhcyBpZCB0byBiZSBhYmxlIHRvIGNyZWF0ZSBuZXcgY29ubmVjdG9yIHdpdGhpbiB0aGUgYWxlcnQgZm9ybQogICAgICBhY3Rpb25zLnB1c2goewogICAgICAgIGlkOiAnJywKICAgICAgICBhY3Rpb25UeXBlSWQ6IGFjdGlvblR5cGVNb2RlbC5pZCwKICAgICAgICBncm91cDogZGVmYXVsdEFjdGlvbkdyb3VwSWQsCiAgICAgICAgcGFyYW1zOiB7fQogICAgICB9KTsKICAgICAgc2V0QWN0aW9uSWRCeUluZGV4KGFjdGlvbnMubGVuZ3RoLnRvU3RyaW5nKCksIGFjdGlvbnMubGVuZ3RoIC0gMSk7CiAgICAgIHNldEVtcHR5QWN0aW9uc0lkcyhbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGVtcHR5QWN0aW9uc0lkcyksIFthY3Rpb25zLmxlbmd0aC50b1N0cmluZygpXSkpOwogICAgfQogIH0KCiAgdmFyIGFjdGlvblR5cGVOb2RlcyA9IG51bGw7CiAgdmFyIGhhc0Rpc2FibGVkQnlMaWNlbnNlQWN0aW9uVHlwZXMgPSBmYWxzZTsKCiAgaWYgKGFjdGlvblR5cGVzSW5kZXgpIHsKICAgIGFjdGlvblR5cGVOb2RlcyA9IGFjdGlvblR5cGVSZWdpc3RyeS5saXN0KCkuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgIHJldHVybiBhY3Rpb25UeXBlc0luZGV4W2l0ZW0uaWRdICYmIGFjdGlvblR5cGVzSW5kZXhbaXRlbS5pZF0uZW5hYmxlZEluQ29uZmlnID09PSB0cnVlOwogICAgfSkuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICByZXR1cm4gKDAsIF9hY3Rpb25fdHlwZV9jb21wYXJlLmFjdGlvblR5cGVDb21wYXJlKShhY3Rpb25UeXBlc0luZGV4W2EuaWRdLCBhY3Rpb25UeXBlc0luZGV4W2IuaWRdKTsKICAgIH0pLm1hcChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgdmFyIGFjdGlvblR5cGUgPSBhY3Rpb25UeXBlc0luZGV4W2l0ZW0uaWRdOwogICAgICB2YXIgY2hlY2tFbmFibGVkUmVzdWx0ID0gKDAsIF9jaGVja19hY3Rpb25fdHlwZV9lbmFibGVkLmNoZWNrQWN0aW9uVHlwZUVuYWJsZWQpKGFjdGlvblR5cGVzSW5kZXhbaXRlbS5pZF0pOwoKICAgICAgaWYgKCFhY3Rpb25UeXBlLmVuYWJsZWRJbkxpY2Vuc2UpIHsKICAgICAgICBoYXNEaXNhYmxlZEJ5TGljZW5zZUFjdGlvblR5cGVzID0gdHJ1ZTsKICAgICAgfQoKICAgICAgdmFyIGtleVBhZEl0ZW0gPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpS2V5UGFkTWVudUl0ZW0sIHsKICAgICAgICBrZXk6IGluZGV4LAogICAgICAgIGlzRGlzYWJsZWQ6ICFjaGVja0VuYWJsZWRSZXN1bHQuaXNFbmFibGVkLAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICIiLmNvbmNhdChpdGVtLmlkLCAiLUFjdGlvblR5cGVTZWxlY3RPcHRpb24iKSwKICAgICAgICBsYWJlbDogYWN0aW9uVHlwZXNJbmRleFtpdGVtLmlkXS5uYW1lLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICByZXR1cm4gYWRkQWN0aW9uVHlwZShpdGVtKTsKICAgICAgICB9CiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgc2l6ZTogInhsIiwKICAgICAgICB0eXBlOiBpdGVtLmljb25DbGFzcwogICAgICB9KSk7CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIHsKICAgICAgICBrZXk6ICJrZXlwYWQtIi5jb25jYXQoaXRlbS5pZCkKICAgICAgfSwgY2hlY2tFbmFibGVkUmVzdWx0LmlzRW5hYmxlZCAmJiBrZXlQYWRJdGVtLCBjaGVja0VuYWJsZWRSZXN1bHQuaXNFbmFibGVkID09PSBmYWxzZSAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVG9vbFRpcCwgewogICAgICAgIHBvc2l0aW9uOiAidG9wIiwKICAgICAgICBjb250ZW50OiBjaGVja0VuYWJsZWRSZXN1bHQubWVzc2FnZQogICAgICB9LCBrZXlQYWRJdGVtKSk7CiAgICB9KTsKICB9CgogIHZhciBhbGVydEFjdGlvbnNMaXN0ID0gYWN0aW9ucy5tYXAoZnVuY3Rpb24gKGFjdGlvbkl0ZW0sIGluZGV4KSB7CiAgICB2YXIgX2FjdGlvblR5cGVSZWdpc3RyeSRnOwoKICAgIHZhciBhY3Rpb25Db25uZWN0b3IgPSBjb25uZWN0b3JzLmZpbmQoZnVuY3Rpb24gKGZpZWxkKSB7CiAgICAgIHJldHVybiBmaWVsZC5pZCA9PT0gYWN0aW9uSXRlbS5pZDsKICAgIH0pOyAvLyBjb25uZWN0b3JzIGRvZXNuJ3QgZXhpc3RzCgogICAgaWYgKCFhY3Rpb25Db25uZWN0b3IpIHsKICAgICAgcmV0dXJuIGdldEFkZENvbm5lY3RvcnNGb3JtKGFjdGlvbkl0ZW0sIGluZGV4KTsKICAgIH0KCiAgICB2YXIgYWN0aW9uRXJyb3JzID0gKF9hY3Rpb25UeXBlUmVnaXN0cnkkZyA9IGFjdGlvblR5cGVSZWdpc3RyeS5nZXQoYWN0aW9uSXRlbS5hY3Rpb25UeXBlSWQpKSA9PT0gbnVsbCB8fCBfYWN0aW9uVHlwZVJlZ2lzdHJ5JGcgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hY3Rpb25UeXBlUmVnaXN0cnkkZy52YWxpZGF0ZVBhcmFtcyhhY3Rpb25JdGVtLnBhcmFtcyk7CiAgICByZXR1cm4gZ2V0QWN0aW9uVHlwZUZvcm0oYWN0aW9uSXRlbSwgYWN0aW9uQ29ubmVjdG9yLCBhY3Rpb25FcnJvcnMsIGluZGV4KTsKICB9KTsKICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIGlzTG9hZGluZ0Nvbm5lY3RvcnMgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zZWN0aW9uX2xvYWRpbmcuU2VjdGlvbkxvYWRpbmcsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICBpZDogInhwYWNrLnRyaWdnZXJzQWN0aW9uc1VJLnNlY3Rpb25zLmFsZXJ0Rm9ybS5sb2FkaW5nQ29ubmVjdG9yc0Rlc2NyaXB0aW9uIiwKICAgIGRlZmF1bHRNZXNzYWdlOiAiTG9hZGluZyBjb25uZWN0b3JzXHUyMDI2IgogIH0pKSA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBhbGVydEFjdGlvbnNMaXN0LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICBzaXplOiAibSIKICB9KSwgaXNBZGRBY3Rpb25QYW5lbE9wZW4gPT09IGZhbHNlID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgaWNvblR5cGU6ICJwbHVzSW5DaXJjbGUiLAogICAgImRhdGEtdGVzdC1zdWJqIjogImFkZEFsZXJ0QWN0aW9uQnV0dG9uIiwKICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgIHJldHVybiBzZXRJc0FkZEFjdGlvblBhbmVsT3Blbih0cnVlKTsKICAgIH0KICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgaWQ6ICJ4cGFjay50cmlnZ2Vyc0FjdGlvbnNVSS5zZWN0aW9ucy5hbGVydEZvcm0uYWRkQWN0aW9uQnV0dG9uTGFiZWwiLAogICAgZGVmYXVsdE1lc3NhZ2U6ICJBZGQgYWN0aW9uIgogIH0pKSA6IG51bGwsIGlzQWRkQWN0aW9uUGFuZWxPcGVuID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgIGlkOiAiYWxlcnRBY3Rpb25UeXBlVGl0bGUiLAogICAganVzdGlmeUNvbnRlbnQ6ICJzcGFjZUJldHdlZW4iCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUaXRsZSwgewogICAgc2l6ZTogInhzIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImg1IiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAiQWN0aW9uczogU2VsZWN0IGFuIGFjdGlvbiB0eXBlIiwKICAgIGlkOiAieHBhY2sudHJpZ2dlcnNBY3Rpb25zVUkuc2VjdGlvbnMuYWxlcnRGb3JtLnNlbGVjdEFsZXJ0QWN0aW9uVHlwZVRpdGxlIgogIH0pKSkpLCBoYXNEaXNhYmxlZEJ5TGljZW5zZUFjdGlvblR5cGVzICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGl0bGUsIHsKICAgIHNpemU6ICJ4cyIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoNSIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICBocmVmOiBfY29uc3RhbnRzLlZJRVdfTElDRU5TRV9PUFRJT05TX0xJTkssCiAgICB0YXJnZXQ6ICJfYmxhbmsiLAogICAgY2xhc3NOYW1lOiAiYWN0QWN0aW9uRm9ybV9fZ2V0TW9yZUFjdGlvbnNMaW5rIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogIkdldCBtb3JlIGFjdGlvbnMiLAogICAgaWQ6ICJ4cGFjay50cmlnZ2Vyc0FjdGlvbnNVSS5zZWN0aW9ucy5hY3Rpb25Gb3JtLmdldE1vcmVBY3Rpb25zVGl0bGUiCiAgfSkpKSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4R3JvdXAsIHsKICAgIGd1dHRlclNpemU6ICJzIiwKICAgIHdyYXA6IHRydWUKICB9LCBpc0xvYWRpbmdBY3Rpb25UeXBlcyA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NlY3Rpb25fbG9hZGluZy5TZWN0aW9uTG9hZGluZywgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgIGlkOiAieHBhY2sudHJpZ2dlcnNBY3Rpb25zVUkuc2VjdGlvbnMuYWxlcnRGb3JtLmxvYWRpbmdBY3Rpb25UeXBlc0Rlc2NyaXB0aW9uIiwKICAgIGRlZmF1bHRNZXNzYWdlOiAiTG9hZGluZyBhY3Rpb24gdHlwZXNcdTIwMjYiCiAgfSkpIDogYWN0aW9uVHlwZU5vZGVzKSkgOiBudWxsKSwgYWN0aW9uVHlwZXNJbmRleCAmJiBhY3RpdmVBY3Rpb25JdGVtID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29ubmVjdG9yX2FkZF9tb2RhbC5Db25uZWN0b3JBZGRNb2RhbCwgewogICAga2V5OiBhY3RpdmVBY3Rpb25JdGVtLmluZGV4LAogICAgYWN0aW9uVHlwZTogYWN0aW9uVHlwZXNJbmRleFthY3RpdmVBY3Rpb25JdGVtLmFjdGlvblR5cGVJZF0sCiAgICBhZGRNb2RhbFZpc2libGU6IGFkZE1vZGFsVmlzaWJsZSwKICAgIHNldEFkZE1vZGFsVmlzaWJpbGl0eTogc2V0QWRkTW9kYWxWaXNpYmlsaXR5LAogICAgcG9zdFNhdmVFdmVudEhhbmRsZXI6IGZ1bmN0aW9uIHBvc3RTYXZlRXZlbnRIYW5kbGVyKHNhdmVkQWN0aW9uKSB7CiAgICAgIGNvbm5lY3RvcnMucHVzaChzYXZlZEFjdGlvbik7CiAgICAgIHNldEFjdGlvbklkQnlJbmRleChzYXZlZEFjdGlvbi5pZCwgYWN0aXZlQWN0aW9uSXRlbS5pbmRleCk7CiAgICB9LAogICAgYWN0aW9uVHlwZVJlZ2lzdHJ5OiBhY3Rpb25UeXBlUmVnaXN0cnksCiAgICBodHRwOiBodHRwLAogICAgdG9hc3ROb3RpZmljYXRpb25zOiB0b2FzdE5vdGlmaWNhdGlvbnMKICB9KSA6IG51bGwpOwp9OwoKZXhwb3J0cy5BY3Rpb25Gb3JtID0gQWN0aW9uRm9ybTs="},null]}