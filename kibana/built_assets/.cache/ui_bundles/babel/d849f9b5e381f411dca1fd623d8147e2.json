{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/containers/case/api.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/containers/case/api.js","mtime":1589249553216},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmdldEFjdGlvbkxpY2Vuc2UgPSBleHBvcnRzLnB1c2hUb1NlcnZpY2UgPSBleHBvcnRzLnB1c2hDYXNlID0gZXhwb3J0cy5kZWxldGVDYXNlcyA9IGV4cG9ydHMucGF0Y2hDb21tZW50ID0gZXhwb3J0cy5wb3N0Q29tbWVudCA9IGV4cG9ydHMucGF0Y2hDYXNlc1N0YXR1cyA9IGV4cG9ydHMucGF0Y2hDYXNlID0gZXhwb3J0cy5wb3N0Q2FzZSA9IGV4cG9ydHMuZ2V0Q2FzZXMgPSBleHBvcnRzLmdldENhc2VVc2VyQWN0aW9ucyA9IGV4cG9ydHMuZ2V0UmVwb3J0ZXJzID0gZXhwb3J0cy5nZXRUYWdzID0gZXhwb3J0cy5nZXRDYXNlc1N0YXR1cyA9IGV4cG9ydHMuZ2V0Q2FzZSA9IHZvaWQgMDsKCnZhciBfa2liYW5hID0gcmVxdWlyZSgiLi4vLi4vbGliL2tpYmFuYSIpOwoKdmFyIF90eXBlcyA9IHJlcXVpcmUoIi4vdHlwZXMiKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi9jb25zdGFudHMiKTsKCnZhciBfdXRpbHMgPSByZXF1aXJlKCIuL3V0aWxzIik7Cgp2YXIgaTE4biA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIi4vdHJhbnNsYXRpb25zIikpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgewogIHRyeSB7CiAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7CiAgICB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICByZWplY3QoZXJyb3IpOwogICAgcmV0dXJuOwogIH0KCiAgaWYgKGluZm8uZG9uZSkgewogICAgcmVzb2x2ZSh2YWx1ZSk7CiAgfSBlbHNlIHsKICAgIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsKICB9Cn0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICBhcmdzID0gYXJndW1lbnRzOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOwoKICAgICAgZnVuY3Rpb24gX25leHQodmFsdWUpIHsKICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOwogICAgICB9CgogICAgICBfbmV4dCh1bmRlZmluZWQpOwogICAgfSk7CiAgfTsKfQoKdmFyIGdldENhc2UgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGNhc2VJZCkgewogICAgdmFyIGluY2x1ZGVDb21tZW50cywKICAgICAgICBzaWduYWwsCiAgICAgICAgcmVzcG9uc2UsCiAgICAgICAgX2FyZ3MgPSBhcmd1bWVudHM7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGluY2x1ZGVDb21tZW50cyA9IF9hcmdzLmxlbmd0aCA+IDEgJiYgX2FyZ3NbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzFdIDogdHJ1ZTsKICAgICAgICAgICAgc2lnbmFsID0gX2FyZ3MubGVuZ3RoID4gMiA/IF9hcmdzWzJdIDogdW5kZWZpbmVkOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgcmV0dXJuIF9raWJhbmEuS2liYW5hU2VydmljZXMuZ2V0KCkuaHR0cC5mZXRjaCgiIi5jb25jYXQoX2NvbnN0YW50cy5DQVNFU19VUkwsICIvIikuY29uY2F0KGNhc2VJZCksIHsKICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLAogICAgICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgICAgICBpbmNsdWRlQ29tbWVudHM6IGluY2x1ZGVDb21tZW50cwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgc2lnbmFsOiBzaWduYWwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsICgwLCBfdXRpbHMuY29udmVydFRvQ2FtZWxDYXNlKSgoMCwgX3V0aWxzLmRlY29kZUNhc2VSZXNwb25zZSkocmVzcG9uc2UpKSk7CgogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIGdldENhc2UoX3gpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKZXhwb3J0cy5nZXRDYXNlID0gZ2V0Q2FzZTsKCnZhciBnZXRDYXNlc1N0YXR1cyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIHZhciBfcmVmMiA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihzaWduYWwpIHsKICAgIHZhciByZXNwb25zZTsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIF9raWJhbmEuS2liYW5hU2VydmljZXMuZ2V0KCkuaHR0cC5mZXRjaCgiIi5jb25jYXQoX2NvbnN0YW50cy5DQVNFU19VUkwsICIvc3RhdHVzIiksIHsKICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLAogICAgICAgICAgICAgIHNpZ25hbDogc2lnbmFsCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsICgwLCBfdXRpbHMuY29udmVydFRvQ2FtZWxDYXNlKSgoMCwgX3V0aWxzLmRlY29kZUNhc2VzU3RhdHVzUmVzcG9uc2UpKHJlc3BvbnNlKSkpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTIpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIGdldENhc2VzU3RhdHVzKF94MikgewogICAgcmV0dXJuIF9yZWYyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKZXhwb3J0cy5nZXRDYXNlc1N0YXR1cyA9IGdldENhc2VzU3RhdHVzOwoKdmFyIGdldFRhZ3MgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZjMgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoc2lnbmFsKSB7CiAgICB2YXIgcmVzcG9uc2U7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBfa2liYW5hLktpYmFuYVNlcnZpY2VzLmdldCgpLmh0dHAuZmV0Y2goIiIuY29uY2F0KF9jb25zdGFudHMuQ0FTRVNfVVJMLCAiL3RhZ3MiKSwgewogICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgICAgc2lnbmFsOiBzaWduYWwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgcmVzcG9uc2UgIT09IG51bGwgJiYgcmVzcG9uc2UgIT09IHZvaWQgMCA/IHJlc3BvbnNlIDogW10pOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTMpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIGdldFRhZ3MoX3gzKSB7CiAgICByZXR1cm4gX3JlZjMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7CgpleHBvcnRzLmdldFRhZ3MgPSBnZXRUYWdzOwoKdmFyIGdldFJlcG9ydGVycyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIHZhciBfcmVmNCA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChzaWduYWwpIHsKICAgIHZhciByZXNwb25zZTsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIF9raWJhbmEuS2liYW5hU2VydmljZXMuZ2V0KCkuaHR0cC5mZXRjaCgiIi5jb25jYXQoX2NvbnN0YW50cy5DQVNFU19VUkwsICIvcmVwb3J0ZXJzIiksIHsKICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLAogICAgICAgICAgICAgIHNpZ25hbDogc2lnbmFsCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIHJlc3BvbnNlICE9PSBudWxsICYmIHJlc3BvbnNlICE9PSB2b2lkIDAgPyByZXNwb25zZSA6IFtdKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU0KTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBnZXRSZXBvcnRlcnMoX3g0KSB7CiAgICByZXR1cm4gX3JlZjQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7CgpleHBvcnRzLmdldFJlcG9ydGVycyA9IGdldFJlcG9ydGVyczsKCnZhciBnZXRDYXNlVXNlckFjdGlvbnMgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZjUgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoY2FzZUlkLCBzaWduYWwpIHsKICAgIHZhciByZXNwb25zZTsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIF9raWJhbmEuS2liYW5hU2VydmljZXMuZ2V0KCkuaHR0cC5mZXRjaCgiIi5jb25jYXQoX2NvbnN0YW50cy5DQVNFU19VUkwsICIvIikuY29uY2F0KGNhc2VJZCwgIi91c2VyX2FjdGlvbnMiKSwgewogICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgICAgc2lnbmFsOiBzaWduYWwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgKDAsIF91dGlscy5jb252ZXJ0QXJyYXlUb0NhbWVsQ2FzZSkoKDAsIF91dGlscy5kZWNvZGVDYXNlVXNlckFjdGlvbnNSZXNwb25zZSkocmVzcG9uc2UpKSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlNSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gZ2V0Q2FzZVVzZXJBY3Rpb25zKF94NSwgX3g2KSB7CiAgICByZXR1cm4gX3JlZjUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7CgpleHBvcnRzLmdldENhc2VVc2VyQWN0aW9ucyA9IGdldENhc2VVc2VyQWN0aW9uczsKCnZhciBnZXRDYXNlcyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIHZhciBfcmVmNiA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNihfcmVmNykgewogICAgdmFyIF9yZWY3JGZpbHRlck9wdGlvbnMsIGZpbHRlck9wdGlvbnMsIF9yZWY3JHF1ZXJ5UGFyYW1zLCBxdWVyeVBhcmFtcywgc2lnbmFsLCBxdWVyeSwgcmVzcG9uc2U7CgogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX3JlZjckZmlsdGVyT3B0aW9ucyA9IF9yZWY3LmZpbHRlck9wdGlvbnMsIGZpbHRlck9wdGlvbnMgPSBfcmVmNyRmaWx0ZXJPcHRpb25zID09PSB2b2lkIDAgPyB7CiAgICAgICAgICAgICAgc2VhcmNoOiAnJywKICAgICAgICAgICAgICByZXBvcnRlcnM6IFtdLAogICAgICAgICAgICAgIHN0YXR1czogJ29wZW4nLAogICAgICAgICAgICAgIHRhZ3M6IFtdCiAgICAgICAgICAgIH0gOiBfcmVmNyRmaWx0ZXJPcHRpb25zLCBfcmVmNyRxdWVyeVBhcmFtcyA9IF9yZWY3LnF1ZXJ5UGFyYW1zLCBxdWVyeVBhcmFtcyA9IF9yZWY3JHF1ZXJ5UGFyYW1zID09PSB2b2lkIDAgPyB7CiAgICAgICAgICAgICAgcGFnZTogMSwKICAgICAgICAgICAgICBwZXJQYWdlOiAyMCwKICAgICAgICAgICAgICBzb3J0RmllbGQ6IF90eXBlcy5Tb3J0RmllbGRDYXNlLmNyZWF0ZWRBdCwKICAgICAgICAgICAgICBzb3J0T3JkZXI6ICdkZXNjJwogICAgICAgICAgICB9IDogX3JlZjckcXVlcnlQYXJhbXMsIHNpZ25hbCA9IF9yZWY3LnNpZ25hbDsKICAgICAgICAgICAgcXVlcnkgPSBfb2JqZWN0U3ByZWFkKHsKICAgICAgICAgICAgICByZXBvcnRlcnM6IGZpbHRlck9wdGlvbnMucmVwb3J0ZXJzLm1hcChmdW5jdGlvbiAocikgewogICAgICAgICAgICAgICAgdmFyIF9yJHVzZXJuYW1lOwoKICAgICAgICAgICAgICAgIHJldHVybiAoX3IkdXNlcm5hbWUgPSByLnVzZXJuYW1lKSAhPT0gbnVsbCAmJiBfciR1c2VybmFtZSAhPT0gdm9pZCAwID8gX3IkdXNlcm5hbWUgOiAnJzsKICAgICAgICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICAgIHJldHVybiByICE9PSAnJzsKICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICB0YWdzOiBmaWx0ZXJPcHRpb25zLnRhZ3MKICAgICAgICAgICAgfSwgZmlsdGVyT3B0aW9ucy5zdGF0dXMgIT09ICcnID8gewogICAgICAgICAgICAgIHN0YXR1czogZmlsdGVyT3B0aW9ucy5zdGF0dXMKICAgICAgICAgICAgfSA6IHt9LCB7fSwgZmlsdGVyT3B0aW9ucy5zZWFyY2gubGVuZ3RoID4gMCA/IHsKICAgICAgICAgICAgICBzZWFyY2g6IGZpbHRlck9wdGlvbnMuc2VhcmNoCiAgICAgICAgICAgIH0gOiB7fSwge30sIHF1ZXJ5UGFyYW1zKTsKICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0OwogICAgICAgICAgICByZXR1cm4gX2tpYmFuYS5LaWJhbmFTZXJ2aWNlcy5nZXQoKS5odHRwLmZldGNoKCIiLmNvbmNhdChfY29uc3RhbnRzLkNBU0VTX1VSTCwgIi9fZmluZCIpLCB7CiAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJywKICAgICAgICAgICAgICBxdWVyeTogcXVlcnksCiAgICAgICAgICAgICAgc2lnbmFsOiBzaWduYWwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgKDAsIF91dGlscy5jb252ZXJ0QWxsQ2FzZXNUb0NhbWVsKSgoMCwgX3V0aWxzLmRlY29kZUNhc2VzRmluZFJlc3BvbnNlKShyZXNwb25zZSkpKTsKCiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU2KTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBnZXRDYXNlcyhfeDcpIHsKICAgIHJldHVybiBfcmVmNi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKCmV4cG9ydHMuZ2V0Q2FzZXMgPSBnZXRDYXNlczsKCnZhciBwb3N0Q2FzZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIHZhciBfcmVmOCA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNyhuZXdDYXNlLCBzaWduYWwpIHsKICAgIHZhciByZXNwb25zZTsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIF9raWJhbmEuS2liYW5hU2VydmljZXMuZ2V0KCkuaHR0cC5mZXRjaChfY29uc3RhbnRzLkNBU0VTX1VSTCwgewogICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KG5ld0Nhc2UpLAogICAgICAgICAgICAgIHNpZ25hbDogc2lnbmFsCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDcuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIsICgwLCBfdXRpbHMuY29udmVydFRvQ2FtZWxDYXNlKSgoMCwgX3V0aWxzLmRlY29kZUNhc2VSZXNwb25zZSkocmVzcG9uc2UpKSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlNyk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gcG9zdENhc2UoX3g4LCBfeDkpIHsKICAgIHJldHVybiBfcmVmOC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKCmV4cG9ydHMucG9zdENhc2UgPSBwb3N0Q2FzZTsKCnZhciBwYXRjaENhc2UgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZjkgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoY2FzZUlkLCB1cGRhdGVkQ2FzZSwgdmVyc2lvbiwgc2lnbmFsKSB7CiAgICB2YXIgcmVzcG9uc2U7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBfa2liYW5hLktpYmFuYVNlcnZpY2VzLmdldCgpLmh0dHAuZmV0Y2goX2NvbnN0YW50cy5DQVNFU19VUkwsIHsKICAgICAgICAgICAgICBtZXRob2Q6ICdQQVRDSCcsCiAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgY2FzZXM6IFtfb2JqZWN0U3ByZWFkKHt9LCB1cGRhdGVkQ2FzZSwgewogICAgICAgICAgICAgICAgICBpZDogY2FzZUlkLAogICAgICAgICAgICAgICAgICB2ZXJzaW9uOiB2ZXJzaW9uCiAgICAgICAgICAgICAgICB9KV0KICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICBzaWduYWw6IHNpZ25hbAogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQ4LnNlbnQ7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iLCAoMCwgX3V0aWxzLmNvbnZlcnRUb0NhbWVsQ2FzZSkoKDAsIF91dGlscy5kZWNvZGVDYXNlc1Jlc3BvbnNlKShyZXNwb25zZSkpKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU4KTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBwYXRjaENhc2UoX3gxMCwgX3gxMSwgX3gxMiwgX3gxMykgewogICAgcmV0dXJuIF9yZWY5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKZXhwb3J0cy5wYXRjaENhc2UgPSBwYXRjaENhc2U7Cgp2YXIgcGF0Y2hDYXNlc1N0YXR1cyA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIHZhciBfcmVmMTAgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoY2FzZXMsIHNpZ25hbCkgewogICAgdmFyIHJlc3BvbnNlOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAyOwogICAgICAgICAgICByZXR1cm4gX2tpYmFuYS5LaWJhbmFTZXJ2aWNlcy5nZXQoKS5odHRwLmZldGNoKF9jb25zdGFudHMuQ0FTRVNfVVJMLCB7CiAgICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLAogICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgIGNhc2VzOiBjYXNlcwogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIHNpZ25hbDogc2lnbmFsCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDkuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIsICgwLCBfdXRpbHMuY29udmVydFRvQ2FtZWxDYXNlKSgoMCwgX3V0aWxzLmRlY29kZUNhc2VzUmVzcG9uc2UpKHJlc3BvbnNlKSkpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTkpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIHBhdGNoQ2FzZXNTdGF0dXMoX3gxNCwgX3gxNSkgewogICAgcmV0dXJuIF9yZWYxMC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKCmV4cG9ydHMucGF0Y2hDYXNlc1N0YXR1cyA9IHBhdGNoQ2FzZXNTdGF0dXM7Cgp2YXIgcG9zdENvbW1lbnQgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZjExID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgLyojX19QVVJFX18qLwogIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMChuZXdDb21tZW50LCBjYXNlSWQsIHNpZ25hbCkgewogICAgdmFyIHJlc3BvbnNlOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBfa2liYW5hLktpYmFuYVNlcnZpY2VzLmdldCgpLmh0dHAuZmV0Y2goIiIuY29uY2F0KF9jb25zdGFudHMuQ0FTRVNfVVJMLCAiLyIpLmNvbmNhdChjYXNlSWQsICIvY29tbWVudHMiKSwgewogICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KG5ld0NvbW1lbnQpLAogICAgICAgICAgICAgIHNpZ25hbDogc2lnbmFsCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDEwLnNlbnQ7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdCgicmV0dXJuIiwgKDAsIF91dGlscy5jb252ZXJ0VG9DYW1lbENhc2UpKCgwLCBfdXRpbHMuZGVjb2RlQ2FzZVJlc3BvbnNlKShyZXNwb25zZSkpKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMTApOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIHBvc3RDb21tZW50KF94MTYsIF94MTcsIF94MTgpIHsKICAgIHJldHVybiBfcmVmMTEuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7CgpleHBvcnRzLnBvc3RDb21tZW50ID0gcG9zdENvbW1lbnQ7Cgp2YXIgcGF0Y2hDb21tZW50ID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYxMiA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEoY2FzZUlkLCBjb21tZW50SWQsIGNvbW1lbnRVcGRhdGUsIHZlcnNpb24sIHNpZ25hbCkgewogICAgdmFyIHJlc3BvbnNlOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBfa2liYW5hLktpYmFuYVNlcnZpY2VzLmdldCgpLmh0dHAuZmV0Y2goIiIuY29uY2F0KF9jb25zdGFudHMuQ0FTRVNfVVJMLCAiLyIpLmNvbmNhdChjYXNlSWQsICIvY29tbWVudHMiKSwgewogICAgICAgICAgICAgIG1ldGhvZDogJ1BBVENIJywKICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICBjb21tZW50OiBjb21tZW50VXBkYXRlLAogICAgICAgICAgICAgICAgaWQ6IGNvbW1lbnRJZCwKICAgICAgICAgICAgICAgIHZlcnNpb246IHZlcnNpb24KICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICBzaWduYWw6IHNpZ25hbAogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQxMS5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIsICgwLCBfdXRpbHMuY29udmVydFRvQ2FtZWxDYXNlKSgoMCwgX3V0aWxzLmRlY29kZUNhc2VSZXNwb25zZSkocmVzcG9uc2UpKSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTExKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBwYXRjaENvbW1lbnQoX3gxOSwgX3gyMCwgX3gyMSwgX3gyMiwgX3gyMykgewogICAgcmV0dXJuIF9yZWYxMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKCmV4cG9ydHMucGF0Y2hDb21tZW50ID0gcGF0Y2hDb21tZW50OwoKdmFyIGRlbGV0ZUNhc2VzID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYxMyA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTIoY2FzZUlkcywgc2lnbmFsKSB7CiAgICB2YXIgcmVzcG9uc2U7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEyJChfY29udGV4dDEyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIF9raWJhbmEuS2liYW5hU2VydmljZXMuZ2V0KCkuaHR0cC5mZXRjaChfY29uc3RhbnRzLkNBU0VTX1VSTCwgewogICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsCiAgICAgICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgICAgIGlkczogSlNPTi5zdHJpbmdpZnkoY2FzZUlkcykKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHNpZ25hbDogc2lnbmFsCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDEyLnNlbnQ7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLmFicnVwdCgicmV0dXJuIiwgcmVzcG9uc2UgPT09ICd0cnVlJyA/IHRydWUgOiBmYWxzZSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTEyKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBkZWxldGVDYXNlcyhfeDI0LCBfeDI1KSB7CiAgICByZXR1cm4gX3JlZjEzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKZXhwb3J0cy5kZWxldGVDYXNlcyA9IGRlbGV0ZUNhc2VzOwoKdmFyIHB1c2hDYXNlID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYxNCA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTMoY2FzZUlkLCBwdXNoLCBzaWduYWwpIHsKICAgIHZhciByZXNwb25zZTsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTMkKF9jb250ZXh0MTMpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTMucHJldiA9IF9jb250ZXh0MTMubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSAyOwogICAgICAgICAgICByZXR1cm4gX2tpYmFuYS5LaWJhbmFTZXJ2aWNlcy5nZXQoKS5odHRwLmZldGNoKCIiLmNvbmNhdChfY29uc3RhbnRzLkNBU0VTX1VSTCwgIi8iKS5jb25jYXQoY2FzZUlkLCAiL19wdXNoIiksIHsKICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShwdXNoKSwKICAgICAgICAgICAgICBzaWduYWw6IHNpZ25hbAogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQxMy5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5hYnJ1cHQoInJldHVybiIsICgwLCBfdXRpbHMuY29udmVydFRvQ2FtZWxDYXNlKSgoMCwgX3V0aWxzLmRlY29kZUNhc2VSZXNwb25zZSkocmVzcG9uc2UpKSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTEzKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBwdXNoQ2FzZShfeDI2LCBfeDI3LCBfeDI4KSB7CiAgICByZXR1cm4gX3JlZjE0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKZXhwb3J0cy5wdXNoQ2FzZSA9IHB1c2hDYXNlOwoKdmFyIHB1c2hUb1NlcnZpY2UgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZjE1ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgLyojX19QVVJFX18qLwogIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNChjb25uZWN0b3JJZCwgY2FzZVB1c2hQYXJhbXMsIHNpZ25hbCkgewogICAgdmFyIHJlc3BvbnNlLCBfcmVmMTYsIF9yZXNwb25zZSRzZXJ2aWNlTWVzczsKCiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDE0LnByZXYgPSBfY29udGV4dDE0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQxNC5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIF9raWJhbmEuS2liYW5hU2VydmljZXMuZ2V0KCkuaHR0cC5mZXRjaCgiL2FwaS9hY3Rpb24vIi5jb25jYXQoY29ubmVjdG9ySWQsICIvX2V4ZWN1dGUiKSwgewogICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgIHBhcmFtczogY2FzZVB1c2hQYXJhbXMKICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICBzaWduYWw6IHNpZ25hbAogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQxNC5zZW50OwoKICAgICAgICAgICAgaWYgKCEocmVzcG9uc2Uuc3RhdHVzID09PSAnZXJyb3InKSkgewogICAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigoX3JlZjE2ID0gKF9yZXNwb25zZSRzZXJ2aWNlTWVzcyA9IHJlc3BvbnNlLnNlcnZpY2VNZXNzYWdlKSAhPT0gbnVsbCAmJiBfcmVzcG9uc2Ukc2VydmljZU1lc3MgIT09IHZvaWQgMCA/IF9yZXNwb25zZSRzZXJ2aWNlTWVzcyA6IHJlc3BvbnNlLm1lc3NhZ2UpICE9PSBudWxsICYmIF9yZWYxNiAhPT0gdm9pZCAwID8gX3JlZjE2IDogaTE4bi5FUlJPUl9QVVNIX1RPX1NFUlZJQ0UpOwoKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuYWJydXB0KCJyZXR1cm4iLCAoMCwgX3V0aWxzLmRlY29kZVNlcnZpY2VDb25uZWN0b3JDYXNlUmVzcG9uc2UpKHJlc3BvbnNlLmRhdGEpKTsKCiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMTQpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIHB1c2hUb1NlcnZpY2UoX3gyOSwgX3gzMCwgX3gzMSkgewogICAgcmV0dXJuIF9yZWYxNS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKCmV4cG9ydHMucHVzaFRvU2VydmljZSA9IHB1c2hUb1NlcnZpY2U7Cgp2YXIgZ2V0QWN0aW9uTGljZW5zZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIHZhciBfcmVmMTcgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE1KHNpZ25hbCkgewogICAgdmFyIHJlc3BvbnNlOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNSQoX2NvbnRleHQxNSkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNS5wcmV2ID0gX2NvbnRleHQxNS5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0MTUubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBfa2liYW5hLktpYmFuYVNlcnZpY2VzLmdldCgpLmh0dHAuZmV0Y2goIi9hcGkvYWN0aW9uL3R5cGVzIiwgewogICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgICAgc2lnbmFsOiBzaWduYWwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0MTUuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTUuYWJydXB0KCJyZXR1cm4iLCByZXNwb25zZSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTUuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTE1KTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBnZXRBY3Rpb25MaWNlbnNlKF94MzIpIHsKICAgIHJldHVybiBfcmVmMTcuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7CgpleHBvcnRzLmdldEFjdGlvbkxpY2Vuc2UgPSBnZXRBY3Rpb25MaWNlbnNlOw=="},null]}