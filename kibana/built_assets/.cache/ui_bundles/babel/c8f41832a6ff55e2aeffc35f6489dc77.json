{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/canvas/canvas_plugin_src/renderers/pie/plugins/pie.js","dependencies":[{"path":"x-pack/legacy/plugins/canvas/canvas_plugin_src/renderers/pie/plugins/pie.js","mtime":1589249551827},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLnBpZSA9IHZvaWQgMDsKCnZhciBfanF1ZXJ5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJqcXVlcnkiKSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoKICogQ29weXJpZ2h0IEVsYXN0aWNzZWFyY2ggQi5WLiBhbmQvb3IgbGljZW5zZWQgdG8gRWxhc3RpY3NlYXJjaCBCLlYuIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gTGljZW5zZWQgdW5kZXIgdGhlIEVsYXN0aWMgTGljZW5zZTsKICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBFbGFzdGljIExpY2Vuc2UuCiAqLwoKLyogRmxvdCBwbHVnaW4gZm9yIHJlbmRlcmluZyBwaWUgY2hhcnRzLgoKQ29weXJpZ2h0IChjKSAyMDA3LTIwMTQgSU9MQSBhbmQgT2xlIExhdXJzZW4uCgpMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuCgpUaGUgcGx1Z2luIGFzc3VtZXMgdGhhdCBlYWNoIHNlcmllcyBoYXMgYSBzaW5nbGUgZGF0YSB2YWx1ZSwgYW5kIHRoYXQgZWFjaAp2YWx1ZSBpcyBhIHBvc2l0aXZlIGludGVnZXIgb3IgemVyby4gIE5lZ2F0aXZlIG51bWJlcnMgZG9uJ3QgbWFrZSBzZW5zZSBmb3IgYQpwaWUgY2hhcnQsIGFuZCBoYXZlIHVucHJlZGljdGFibGUgcmVzdWx0cy4gIFRoZSB2YWx1ZXMgZG8gTk9UIG5lZWQgdG8gYmUKcGFzc2VkIGluIGFzIHBlcmNlbnRhZ2VzOyB0aGUgcGx1Z2luIHdpbGwgY2FsY3VsYXRlIHRoZSB0b3RhbCBhbmQgcGVyLXNsaWNlCnBlcmNlbnRhZ2VzIGludGVybmFsbHkuCgoqIENyZWF0ZWQgYnkgQnJpYW4gTWVkZW5kb3JwCgoqIFVwZGF0ZWQgd2l0aCBjb250cmlidXRpb25zIGZyb20gYnRidXJuZXR0MywgQW50aG9ueSBBcmFndWVzIGFuZCBYYXZpIEl2YXJzCiogVXBkYXRlZCAyMDE4IGZvciBLaWJhbmEgQ2FudmFzIGJ5IFJhc2hpZCBLaGFuCgpUaGUgcGx1Z2luIHN1cHBvcnRzIHRoZXNlIG9wdGlvbnM6CgoJc2VyaWVzOiB7CgkJcGllOiB7CgkJCXNob3c6IHRydWUvZmFsc2UKCQkJcmFkaXVzOiAwLTEgZm9yIHBlcmNlbnRhZ2Ugb2YgZnVsbHNpemUsIG9yIGEgc3BlY2lmaWVkIHBpeGVsIGxlbmd0aCwgb3IgJ2F1dG8nCgkJCWlubmVyUmFkaXVzOiAwLTEgZm9yIHBlcmNlbnRhZ2Ugb2YgZnVsbHNpemUgb3IgYSBzcGVjaWZpZWQgcGl4ZWwgbGVuZ3RoLCBmb3IgY3JlYXRpbmcgYSBkb251dCBlZmZlY3QKCQkJc3RhcnRBbmdsZTogMC0yIGZhY3RvciBvZiBQSSB1c2VkIGZvciBzdGFydGluZyBhbmdsZSAoaW4gcmFkaWFucykgaS5lIDMvMiBzdGFydHMgYXQgdGhlIHRvcCwgMCBhbmQgMiBoYXZlIHRoZSBzYW1lIHJlc3VsdAoJCQl0aWx0OiAwLTEgZm9yIHBlcmNlbnRhZ2UgdG8gdGlsdCB0aGUgcGllLCB3aGVyZSAxIGlzIG5vIHRpbHQsIGFuZCAwIGlzIGNvbXBsZXRlbHkgZmxhdCAobm90aGluZyB3aWxsIHNob3cpCgkJCW9mZnNldDogewoJCQkJdG9wOiBpbnRlZ2VyIHZhbHVlIHRvIG1vdmUgdGhlIHBpZSB1cCBvciBkb3duCgkJCQlsZWZ0OiBpbnRlZ2VyIHZhbHVlIHRvIG1vdmUgdGhlIHBpZSBsZWZ0IG9yIHJpZ2h0LCBvciAnYXV0bycKCQkJfSwKCQkJc3Ryb2tlOiB7CgkJCQljb2xvcjogYW55IGhleGlkZWNpbWFsIGNvbG9yIHZhbHVlIChvdGhlciBmb3JtYXRzIG1heSBvciBtYXkgbm90IHdvcmssIHNvIGJlc3QgdG8gc3RpY2sgd2l0aCBzb21ldGhpbmcgbGlrZSAnI0ZGRicpCgkJCQl3aWR0aDogaW50ZWdlciBwaXhlbCB3aWR0aCBvZiB0aGUgc3Ryb2tlCgkJCX0sCgkJCWxhYmVsOiB7CgkJCQlzaG93OiB0cnVlL2ZhbHNlLCBvciAnYXV0bycKCQkJCWZvcm1hdHRlcjogIGEgdXNlci1kZWZpbmVkIGZ1bmN0aW9uIHRoYXQgbW9kaWZpZXMgdGhlIHRleHQvc3R5bGUgb2YgdGhlIGxhYmVsIHRleHQKCQkJCXJhZGl1czogMC0xIGZvciBwZXJjZW50YWdlIG9mIGZ1bGxzaXplLCBvciBhIHNwZWNpZmllZCBwaXhlbCBsZW5ndGgKCQkJCWJhY2tncm91bmQ6IHsKCQkJCQljb2xvcjogYW55IGhleGlkZWNpbWFsIGNvbG9yIHZhbHVlIChvdGhlciBmb3JtYXRzIG1heSBvciBtYXkgbm90IHdvcmssIHNvIGJlc3QgdG8gc3RpY2sgd2l0aCBzb21ldGhpbmcgbGlrZSAnIzAwMCcpCgkJCQkJb3BhY2l0eTogMC0xCgkJCQl9LAoJCQkJdGhyZXNob2xkOiAwLTEgZm9yIHRoZSBwZXJjZW50YWdlIHZhbHVlIGF0IHdoaWNoIHRvIGhpZGUgbGFiZWxzIChpZiB0aGV5J3JlIHRvbyBzbWFsbCkKCQkJfSwKCQkJY29tYmluZTogewoJCQkJdGhyZXNob2xkOiAwLTEgZm9yIHRoZSBwZXJjZW50YWdlIHZhbHVlIGF0IHdoaWNoIHRvIGNvbWJpbmUgc2xpY2VzIChpZiB0aGV5J3JlIHRvbyBzbWFsbCkKCQkJCWNvbG9yOiBhbnkgaGV4aWRlY2ltYWwgY29sb3IgdmFsdWUgKG90aGVyIGZvcm1hdHMgbWF5IG9yIG1heSBub3Qgd29yaywgc28gYmVzdCB0byBzdGljayB3aXRoIHNvbWV0aGluZyBsaWtlICcjQ0NDJyksIGlmIG51bGwsIHRoZSBwbHVnaW4gd2lsbCBhdXRvbWF0aWNhbGx5IHVzZSB0aGUgY29sb3Igb2YgdGhlIGZpcnN0IHNsaWNlIHRvIGJlIGNvbWJpbmVkCgkJCQlsYWJlbDogYW55IHRleHQgdmFsdWUgb2Ygd2hhdCB0aGUgY29tYmluZWQgc2xpY2Ugc2hvdWxkIGJlIGxhYmVsZWQKCQkJfQoJCQloaWdobGlnaHQ6IHsKCQkJCW9wYWNpdHk6IDAtMQoJCQl9CgkJfQoJfQoKTW9yZSBkZXRhaWwgYW5kIHNwZWNpZmljIGV4YW1wbGVzIGNhbiBiZSBmb3VuZCBpbiB0aGUgaW5jbHVkZWQgSFRNTCBmaWxlLgoKKi8KLy8gTWF4aW11bSByZWRyYXcgYXR0ZW1wdHMgd2hlbiBmaXR0aW5nIGxhYmVscyB3aXRoaW4gdGhlIHBsb3QKdmFyIFJFRFJBV19BVFRFTVBUUyA9IDEwOyAvLyBGYWN0b3IgYnkgd2hpY2ggdG8gc2hyaW5rIHRoZSBwaWUgd2hlbiBmaXR0aW5nIGxhYmVscyB3aXRoaW4gdGhlIHBsb3QKCnZhciBSRURSQVdfU0hSSU5LID0gMC45NTsKCmZ1bmN0aW9uIGluaXQocGxvdCkgewogIHZhciBjYW52YXMgPSBudWxsOwogIHZhciB0YXJnZXQgPSBudWxsOwogIHZhciBvcHRpb25zID0gbnVsbDsKICB2YXIgbWF4UmFkaXVzID0gbnVsbDsKICB2YXIgY2VudGVyTGVmdCA9IG51bGw7CiAgdmFyIGNlbnRlclRvcCA9IG51bGw7CiAgdmFyIHByb2Nlc3NlZCA9IGZhbHNlOwogIHZhciBjdHggPSBudWxsOyAvLyBpbnRlcmFjdGl2ZSB2YXJpYWJsZXMKCiAgdmFyIGhpZ2hsaWdodHMgPSBbXTsgLy8gYWRkIGhvb2sgdG8gZGV0ZXJtaW5lIGlmIHBpZSBwbHVnaW4gaW4gZW5hYmxlZCwgYW5kIHRoZW4gcGVyZm9ybSBuZWNlc3Nhcnkgb3BlcmF0aW9ucwoKICBwbG90Lmhvb2tzLnByb2Nlc3NPcHRpb25zLnB1c2goZnVuY3Rpb24gKHBsb3QsIG9wdGlvbnMpIHsKICAgIGlmIChvcHRpb25zLnNlcmllcy5waWUuc2hvdykgewogICAgICBvcHRpb25zLmdyaWQuc2hvdyA9IGZhbHNlOyAvLyBzZXQgbGFiZWxzLnNob3cKCiAgICAgIGlmIChvcHRpb25zLnNlcmllcy5waWUubGFiZWwuc2hvdyA9PT0gJ2F1dG8nKSB7CiAgICAgICAgaWYgKG9wdGlvbnMubGVnZW5kLnNob3cpIHsKICAgICAgICAgIG9wdGlvbnMuc2VyaWVzLnBpZS5sYWJlbC5zaG93ID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9wdGlvbnMuc2VyaWVzLnBpZS5sYWJlbC5zaG93ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gLy8gc2V0IHJhZGl1cwoKCiAgICAgIGlmIChvcHRpb25zLnNlcmllcy5waWUucmFkaXVzID09PSAnYXV0bycpIHsKICAgICAgICBpZiAob3B0aW9ucy5zZXJpZXMucGllLmxhYmVsLnNob3cpIHsKICAgICAgICAgIG9wdGlvbnMuc2VyaWVzLnBpZS5yYWRpdXMgPSAzIC8gNDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgb3B0aW9ucy5zZXJpZXMucGllLnJhZGl1cyA9IDE7CiAgICAgICAgfQogICAgICB9IC8vIGVuc3VyZSBzYW5lIHRpbHQKCgogICAgICBpZiAob3B0aW9ucy5zZXJpZXMucGllLnRpbHQgPiAxKSB7CiAgICAgICAgb3B0aW9ucy5zZXJpZXMucGllLnRpbHQgPSAxOwogICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuc2VyaWVzLnBpZS50aWx0IDwgMCkgewogICAgICAgIG9wdGlvbnMuc2VyaWVzLnBpZS50aWx0ID0gMDsKICAgICAgfQogICAgfQogIH0pOwogIHBsb3QuaG9va3MuYmluZEV2ZW50cy5wdXNoKGZ1bmN0aW9uIChwbG90LCBldmVudEhvbGRlcikgewogICAgdmFyIG9wdGlvbnMgPSBwbG90LmdldE9wdGlvbnMoKTsKCiAgICBpZiAob3B0aW9ucy5zZXJpZXMucGllLnNob3cpIHsKICAgICAgaWYgKG9wdGlvbnMuZ3JpZC5ob3ZlcmFibGUpIHsKICAgICAgICBldmVudEhvbGRlci51bmJpbmQoJ21vdXNlbW92ZScpLm1vdXNlbW92ZShvbk1vdXNlTW92ZSk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLmdyaWQuY2xpY2thYmxlKSB7CiAgICAgICAgZXZlbnRIb2xkZXIudW5iaW5kKCdjbGljaycpLmNsaWNrKG9uQ2xpY2spOwogICAgICB9CiAgICB9CiAgfSk7CiAgcGxvdC5ob29rcy5wcm9jZXNzRGF0YXBvaW50cy5wdXNoKGZ1bmN0aW9uIChwbG90LCBzZXJpZXMsIGRhdGEsIGRhdGFwb2ludHMpIHsKICAgIHZhciBvcHRpb25zID0gcGxvdC5nZXRPcHRpb25zKCk7CgogICAgaWYgKG9wdGlvbnMuc2VyaWVzLnBpZS5zaG93KSB7CiAgICAgIHByb2Nlc3NEYXRhcG9pbnRzKHBsb3QsIHNlcmllcywgZGF0YSwgZGF0YXBvaW50cyk7CiAgICB9CiAgfSk7CiAgcGxvdC5ob29rcy5kcmF3T3ZlcmxheS5wdXNoKGZ1bmN0aW9uIChwbG90LCBvY3R4KSB7CiAgICB2YXIgb3B0aW9ucyA9IHBsb3QuZ2V0T3B0aW9ucygpOwoKICAgIGlmIChvcHRpb25zLnNlcmllcy5waWUuc2hvdykgewogICAgICBkcmF3T3ZlcmxheShwbG90LCBvY3R4KTsKICAgIH0KICB9KTsKICBwbG90Lmhvb2tzLmRyYXcucHVzaChmdW5jdGlvbiAocGxvdCwgbmV3Q3R4KSB7CiAgICB2YXIgb3B0aW9ucyA9IHBsb3QuZ2V0T3B0aW9ucygpOwoKICAgIGlmIChvcHRpb25zLnNlcmllcy5waWUuc2hvdykgewogICAgICBkcmF3KHBsb3QsIG5ld0N0eCk7CiAgICB9CiAgfSk7CgogIGZ1bmN0aW9uIHByb2Nlc3NEYXRhcG9pbnRzKHBsb3QpIHsKICAgIGlmICghcHJvY2Vzc2VkKSB7CiAgICAgIHByb2Nlc3NlZCA9IHRydWU7CiAgICAgIGNhbnZhcyA9IHBsb3QuZ2V0Q2FudmFzKCk7CiAgICAgIHRhcmdldCA9ICgwLCBfanF1ZXJ5LmRlZmF1bHQpKGNhbnZhcykucGFyZW50KCk7CiAgICAgIG9wdGlvbnMgPSBwbG90LmdldE9wdGlvbnMoKTsKICAgICAgcGxvdC5zZXREYXRhKGNvbWJpbmUocGxvdC5nZXREYXRhKCkpKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGNvbWJpbmUoZGF0YSkgewogICAgdmFyIHRvdGFsID0gMDsKICAgIHZhciBjb21iaW5lZCA9IDA7CiAgICB2YXIgbnVtQ29tYmluZWQgPSAwOwogICAgdmFyIGNvbG9yID0gb3B0aW9ucy5zZXJpZXMucGllLmNvbWJpbmUuY29sb3I7CiAgICB2YXIgbmV3ZGF0YSA9IFtdOyAvLyBGaXggdXAgdGhlIHJhdyBkYXRhIGZyb20gRmxvdCwgZW5zdXJpbmcgdGhlIGRhdGEgaXMgbnVtZXJpYwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7ICsraSkgewogICAgICB2YXIgdmFsdWUgPSBkYXRhW2ldLmRhdGE7IC8vIElmIHRoZSBkYXRhIGlzIGFuIGFycmF5LCB3ZSdsbCBhc3N1bWUgdGhhdCBpdCdzIGEgc3RhbmRhcmQKICAgICAgLy8gRmxvdCB4LXkgcGFpciwgYW5kIGFyZSBjb25jZXJuZWQgb25seSB3aXRoIHRoZSBzZWNvbmQgdmFsdWUuCiAgICAgIC8vIE5vdGUgaG93IHdlIHVzZSB0aGUgb3JpZ2luYWwgYXJyYXksIHJhdGhlciB0aGFuIGNyZWF0aW5nIGEKICAgICAgLy8gbmV3IG9uZTsgdGhpcyBpcyBtb3JlIGVmZmljaWVudCBhbmQgcHJlc2VydmVzIGFueSBleHRyYSBkYXRhCiAgICAgIC8vIHRoYXQgdGhlIHVzZXIgbWF5IGhhdmUgc3RvcmVkIGluIGhpZ2hlciBpbmRleGVzLgoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gMSkgewogICAgICAgIHZhbHVlID0gdmFsdWVbMF07CiAgICAgIH0KCiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgewogICAgICAgIC8vIEVxdWl2YWxlbnQgdG8gJC5pc051bWVyaWMoKSBidXQgY29tcGF0aWJsZSB3aXRoIGpRdWVyeSA8IDEuNwogICAgICAgIGlmICghaXNOYU4ocGFyc2VGbG9hdCh2YWx1ZVsxXSkpICYmIGlzRmluaXRlKHZhbHVlWzFdKSkgewogICAgICAgICAgdmFsdWVbMV0gPSArdmFsdWVbMV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhbHVlWzFdID0gMDsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoIWlzTmFOKHBhcnNlRmxvYXQodmFsdWUpKSAmJiBpc0Zpbml0ZSh2YWx1ZSkpIHsKICAgICAgICB2YWx1ZSA9IFsxLCArdmFsdWVdOwogICAgICB9IGVsc2UgewogICAgICAgIHZhbHVlID0gWzEsIDBdOwogICAgICB9CgogICAgICBkYXRhW2ldLmRhdGEgPSBbdmFsdWVdOwogICAgfSAvLyBTdW0gdXAgYWxsIHRoZSBzbGljZXMsIHNvIHdlIGNhbiBjYWxjdWxhdGUgcGVyY2VudGFnZXMgZm9yIGVhY2gKCgogICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGRhdGEubGVuZ3RoOyArK19pKSB7CiAgICAgIHRvdGFsICs9IGRhdGFbX2ldLmRhdGFbMF1bMV07CiAgICB9IC8vIENvdW50IHRoZSBudW1iZXIgb2Ygc2xpY2VzIHdpdGggcGVyY2VudGFnZXMgYmVsb3cgdGhlIGNvbWJpbmUKICAgIC8vIHRocmVzaG9sZDsgaWYgaXQgdHVybnMgb3V0IHRvIGJlIGp1c3Qgb25lLCB3ZSB3b24ndCBjb21iaW5lLgoKCiAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBkYXRhLmxlbmd0aDsgKytfaTIpIHsKICAgICAgdmFyIF92YWx1ZSA9IGRhdGFbX2kyXS5kYXRhWzBdWzFdOwoKICAgICAgaWYgKF92YWx1ZSAvIHRvdGFsIDw9IG9wdGlvbnMuc2VyaWVzLnBpZS5jb21iaW5lLnRocmVzaG9sZCkgewogICAgICAgIGNvbWJpbmVkICs9IF92YWx1ZTsKICAgICAgICBudW1Db21iaW5lZCsrOwoKICAgICAgICBpZiAoIWNvbG9yKSB7CiAgICAgICAgICBjb2xvciA9IGRhdGFbX2kyXS5jb2xvcjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKHZhciBfaTMgPSAwOyBfaTMgPCBkYXRhLmxlbmd0aDsgKytfaTMpIHsKICAgICAgdmFyIF92YWx1ZTIgPSBkYXRhW19pM10uZGF0YVswXVsxXTsKCiAgICAgIGlmIChudW1Db21iaW5lZCA8IDIgfHwgX3ZhbHVlMiAvIHRvdGFsID4gb3B0aW9ucy5zZXJpZXMucGllLmNvbWJpbmUudGhyZXNob2xkKSB7CiAgICAgICAgbmV3ZGF0YS5wdXNoKF9qcXVlcnkuZGVmYXVsdC5leHRlbmQoZGF0YVtfaTNdLCB7CiAgICAgICAgICAvKiBleHRlbmQgdG8gYWxsb3cga2VlcGluZyBhbGwgb3RoZXIgb3JpZ2luYWwgZGF0YSB2YWx1ZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCB1c2luZyB0aGVtIGUuZy4gaW4gbGFiZWxGb3JtYXR0ZXIuICovCiAgICAgICAgICBkYXRhOiBbWzEsIF92YWx1ZTJdXSwKICAgICAgICAgIGNvbG9yOiBkYXRhW19pM10uY29sb3IsCiAgICAgICAgICBsYWJlbDogZGF0YVtfaTNdLmxhYmVsLAogICAgICAgICAgYW5nbGU6IF92YWx1ZTIgKiBNYXRoLlBJICogMiAvIHRvdGFsLAogICAgICAgICAgcGVyY2VudDogX3ZhbHVlMiAvICh0b3RhbCAvIDEwMCkKICAgICAgICB9KSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAobnVtQ29tYmluZWQgPiAxKSB7CiAgICAgIG5ld2RhdGEucHVzaCh7CiAgICAgICAgZGF0YTogW1sxLCBjb21iaW5lZF1dLAogICAgICAgIGNvbG9yOiBjb2xvciwKICAgICAgICBsYWJlbDogb3B0aW9ucy5zZXJpZXMucGllLmNvbWJpbmUubGFiZWwsCiAgICAgICAgYW5nbGU6IGNvbWJpbmVkICogTWF0aC5QSSAqIDIgLyB0b3RhbCwKICAgICAgICBwZXJjZW50OiBjb21iaW5lZCAvICh0b3RhbCAvIDEwMCkKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIG5ld2RhdGE7CiAgfQoKICBmdW5jdGlvbiBkcmF3KHBsb3QsIG5ld0N0eCkgewogICAgaWYgKCF0YXJnZXQpIHsKICAgICAgcmV0dXJuOwogICAgfSAvLyBpZiBubyBzZXJpZXMgd2VyZSBwYXNzZWQKCgogICAgdmFyIGNhbnZhc1dpZHRoID0gcGxvdC5nZXRQbGFjZWhvbGRlcigpLndpZHRoKCk7CiAgICB2YXIgY2FudmFzSGVpZ2h0ID0gcGxvdC5nZXRQbGFjZWhvbGRlcigpLmhlaWdodCgpOwogICAgdmFyIGxlZ2VuZFdpZHRoID0gdGFyZ2V0LmNoaWxkcmVuKCkuZmlsdGVyKCcubGVnZW5kJykuY2hpbGRyZW4oKS53aWR0aCgpIHx8IDA7CiAgICBjdHggPSBuZXdDdHg7IC8vIFdBUk5JTkc6IEhBQ0shIFJFV1JJVEUgVEhJUyBDT0RFIEFTIFNPT04gQVMgUE9TU0lCTEUhCiAgICAvLyBXaGVuIGNvbWJpbmluZyBzbWFsbGVyIHNsaWNlcyBpbnRvIGFuICdvdGhlcicgc2xpY2UsIHdlIG5lZWQgdG8KICAgIC8vIGFkZCBhIG5ldyBzZXJpZXMuICBTaW5jZSBGbG90IGdpdmVzIHBsdWdpbnMgbm8gd2F5IHRvIG1vZGlmeSB0aGUKICAgIC8vIGxpc3Qgb2Ygc2VyaWVzLCB0aGUgcGllIHBsdWdpbiB1c2VzIGEgaGFjayB3aGVyZSB0aGUgZmlyc3QgY2FsbAogICAgLy8gdG8gcHJvY2Vzc0RhdGFwb2ludHMgcmVzdWx0cyBpbiBhIGNhbGwgdG8gc2V0RGF0YSB3aXRoIHRoZSBuZXcKICAgIC8vIGxpc3Qgb2Ygc2VyaWVzLCB0aGVuIHN1YnNlcXVlbnQgcHJvY2Vzc0RhdGFwb2ludHMgZG8gbm90aGluZy4KICAgIC8vIFRoZSBwbHVnaW4tZ2xvYmFsICdwcm9jZXNzZWQnIGZsYWcgaXMgdXNlZCB0byBjb250cm9sIHRoaXMgaGFjazsKICAgIC8vIGl0IHN0YXJ0cyBvdXQgZmFsc2UsIGFuZCBpcyBzZXQgdG8gdHJ1ZSBhZnRlciB0aGUgZmlyc3QgY2FsbCB0bwogICAgLy8gcHJvY2Vzc0RhdGFwb2ludHMuCiAgICAvLyBVbmZvcnR1bmF0ZWx5IHRoaXMgdHVybnMgZnV0dXJlIHNldERhdGEgY2FsbHMgaW50byBuby1vcHM7IHRoZXkKICAgIC8vIGNhbGwgcHJvY2Vzc0RhdGFwb2ludHMsIHRoZSBmbGFnIGlzIHRydWUsIGFuZCBub3RoaW5nIGhhcHBlbnMuCiAgICAvLyBUbyBmaXggdGhpcyB3ZSdsbCBzZXQgdGhlIGZsYWcgYmFjayB0byBmYWxzZSBoZXJlIGluIGRyYXcsIHdoZW4KICAgIC8vIGFsbCBzZXJpZXMgaGF2ZSBiZWVuIHByb2Nlc3NlZCwgc28gdGhlIG5leHQgc2VxdWVuY2Ugb2YgY2FsbHMgdG8KICAgIC8vIHByb2Nlc3NEYXRhcG9pbnRzIG9uY2UgYWdhaW4gc3RhcnRzIG91dCB3aXRoIGEgc2xpY2UtY29tYmluZS4KICAgIC8vIFRoaXMgaXMgcmVhbGx5IGEgaGFjazsgaW4gMC45IHdlIG5lZWQgdG8gZ2l2ZSBwbHVnaW5zIGEgcHJvcGVyCiAgICAvLyB3YXkgdG8gbW9kaWZ5IHNlcmllcyBiZWZvcmUgYW55IHByb2Nlc3NpbmcgYmVnaW5zLgoKICAgIHByb2Nlc3NlZCA9IGZhbHNlOyAvLyBjYWxjdWxhdGUgbWF4aW11bSByYWRpdXMgYW5kIGNlbnRlciBwb2ludAoKICAgIG1heFJhZGl1cyA9IE1hdGgubWluKGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQgLyBvcHRpb25zLnNlcmllcy5waWUudGlsdCkgLyAyOwogICAgY2VudGVyVG9wID0gY2FudmFzSGVpZ2h0IC8gMiArIG9wdGlvbnMuc2VyaWVzLnBpZS5vZmZzZXQudG9wOwogICAgY2VudGVyTGVmdCA9IGNhbnZhc1dpZHRoIC8gMjsKCiAgICBpZiAob3B0aW9ucy5zZXJpZXMucGllLm9mZnNldC5sZWZ0ID09PSAnYXV0bycpIHsKICAgICAgaWYgKG9wdGlvbnMubGVnZW5kLnBvc2l0aW9uLm1hdGNoKCd3JykpIHsKICAgICAgICBjZW50ZXJMZWZ0ICs9IGxlZ2VuZFdpZHRoIC8gMjsKICAgICAgfSBlbHNlIHsKICAgICAgICBjZW50ZXJMZWZ0IC09IGxlZ2VuZFdpZHRoIC8gMjsKICAgICAgfQoKICAgICAgaWYgKGNlbnRlckxlZnQgPCBtYXhSYWRpdXMpIHsKICAgICAgICBjZW50ZXJMZWZ0ID0gbWF4UmFkaXVzOwogICAgICB9IGVsc2UgaWYgKGNlbnRlckxlZnQgPiBjYW52YXNXaWR0aCAtIG1heFJhZGl1cykgewogICAgICAgIGNlbnRlckxlZnQgPSBjYW52YXNXaWR0aCAtIG1heFJhZGl1czsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgY2VudGVyTGVmdCArPSBvcHRpb25zLnNlcmllcy5waWUub2Zmc2V0LmxlZnQ7CiAgICB9CgogICAgdmFyIHNsaWNlcyA9IHBsb3QuZ2V0RGF0YSgpOwogICAgdmFyIGF0dGVtcHRzID0gMDsgLy8gS2VlcCBzaHJpbmtpbmcgdGhlIHBpZSdzIHJhZGl1cyB1bnRpbCBkcmF3UGllIHJldHVybnMgdHJ1ZSwKICAgIC8vIGluZGljYXRpbmcgdGhhdCBhbGwgdGhlIGxhYmVscyBmaXQsIG9yIHdlIHRyeSB0b28gbWFueSB0aW1lcy4KCiAgICBkbyB7CiAgICAgIGlmIChhdHRlbXB0cyA+IDApIHsKICAgICAgICBtYXhSYWRpdXMgKj0gUkVEUkFXX1NIUklOSzsKICAgICAgfQoKICAgICAgYXR0ZW1wdHMgKz0gMTsKICAgICAgY2xlYXIoKTsKCiAgICAgIGlmIChvcHRpb25zLnNlcmllcy5waWUudGlsdCA8PSAwLjgpIHsKICAgICAgICBkcmF3U2hhZG93KCk7CiAgICAgIH0KICAgIH0gd2hpbGUgKCFkcmF3UGllKCkgJiYgYXR0ZW1wdHMgPCBSRURSQVdfQVRURU1QVFMpOwoKICAgIGlmIChhdHRlbXB0cyA+PSBSRURSQVdfQVRURU1QVFMpIHsKICAgICAgY2xlYXIoKTsKICAgICAgdGFyZ2V0LnByZXBlbmQoIjxkaXYgY2xhc3M9J2Vycm9yJz5Db3VsZCBub3QgZHJhdyBwaWUgd2l0aCBsYWJlbHMgY29udGFpbmVkIGluc2lkZSBjYW52YXM8L2Rpdj4iKTsKICAgIH0KCiAgICBpZiAocGxvdC5zZXRTZXJpZXMgJiYgcGxvdC5pbnNlcnRMZWdlbmQpIHsKICAgICAgcGxvdC5zZXRTZXJpZXMoc2xpY2VzKTsKICAgICAgcGxvdC5pbnNlcnRMZWdlbmQoKTsKICAgIH0gLy8gd2UncmUgYWN0dWFsbHkgZG9uZSBhdCB0aGlzIHBvaW50LCBqdXN0IGRlZmluaW5nIGludGVybmFsIGZ1bmN0aW9ucyBhdCB0aGlzIHBvaW50CgoKICAgIGZ1bmN0aW9uIGNsZWFyKCkgewogICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpOwogICAgICB0YXJnZXQuY2hpbGRyZW4oKS5maWx0ZXIoJy5waWVMYWJlbCwgLnBpZUxhYmVsQmFja2dyb3VuZCcpLnJlbW92ZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRyYXdTaGFkb3coKSB7CiAgICAgIHZhciBzaGFkb3dMZWZ0ID0gb3B0aW9ucy5zZXJpZXMucGllLnNoYWRvdy5sZWZ0OwogICAgICB2YXIgc2hhZG93VG9wID0gb3B0aW9ucy5zZXJpZXMucGllLnNoYWRvdy50b3A7CiAgICAgIHZhciBlZGdlID0gMTA7CiAgICAgIHZhciBhbHBoYSA9IG9wdGlvbnMuc2VyaWVzLnBpZS5zaGFkb3cuYWxwaGE7CiAgICAgIHZhciByYWRpdXMgPSBvcHRpb25zLnNlcmllcy5waWUucmFkaXVzID4gMSA/IG9wdGlvbnMuc2VyaWVzLnBpZS5yYWRpdXMgOiBtYXhSYWRpdXMgKiBvcHRpb25zLnNlcmllcy5waWUucmFkaXVzOwoKICAgICAgaWYgKHJhZGl1cyA+PSBjYW52YXNXaWR0aCAvIDIgLSBzaGFkb3dMZWZ0IHx8IHJhZGl1cyAqIG9wdGlvbnMuc2VyaWVzLnBpZS50aWx0ID49IGNhbnZhc0hlaWdodCAvIDIgLSBzaGFkb3dUb3AgfHwgcmFkaXVzIDw9IGVkZ2UpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gc2hhZG93IHdvdWxkIGJlIG91dHNpZGUgY2FudmFzLCBzbyBkb24ndCBkcmF3IGl0CgoKICAgICAgY3R4LnNhdmUoKTsKICAgICAgY3R4LnRyYW5zbGF0ZShzaGFkb3dMZWZ0LCBzaGFkb3dUb3ApOwogICAgICBjdHguZ2xvYmFsQWxwaGEgPSBhbHBoYTsKICAgICAgY3R4LmZpbGxTdHlsZSA9ICcjMDAwJzsgLy8gY2VudGVyIGFuZCByb3RhdGUgdG8gc3RhcnRpbmcgcG9zaXRpb24KCiAgICAgIGN0eC50cmFuc2xhdGUoY2VudGVyTGVmdCwgY2VudGVyVG9wKTsKICAgICAgY3R4LnNjYWxlKDEsIG9wdGlvbnMuc2VyaWVzLnBpZS50aWx0KTsgLy9yYWRpdXMgLT0gZWRnZTsKCiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IGVkZ2U7IGkrKykgewogICAgICAgIGN0eC5iZWdpblBhdGgoKTsKICAgICAgICBjdHguYXJjKDAsIDAsIHJhZGl1cywgMCwgTWF0aC5QSSAqIDIsIGZhbHNlKTsKICAgICAgICBjdHguZmlsbCgpOwogICAgICAgIHJhZGl1cyAtPSBpOwogICAgICB9CgogICAgICBjdHgucmVzdG9yZSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRyYXdQaWUoKSB7CiAgICAgIHZhciBzdGFydEFuZ2xlID0gTWF0aC5QSSAqIG9wdGlvbnMuc2VyaWVzLnBpZS5zdGFydEFuZ2xlOwogICAgICB2YXIgcmFkaXVzID0gb3B0aW9ucy5zZXJpZXMucGllLnJhZGl1cyA+IDEgPyBvcHRpb25zLnNlcmllcy5waWUucmFkaXVzIDogbWF4UmFkaXVzICogb3B0aW9ucy5zZXJpZXMucGllLnJhZGl1czsgLy8gY2VudGVyIGFuZCByb3RhdGUgdG8gc3RhcnRpbmcgcG9zaXRpb24KCiAgICAgIGN0eC5zYXZlKCk7CiAgICAgIGN0eC50cmFuc2xhdGUoY2VudGVyTGVmdCwgY2VudGVyVG9wKTsKICAgICAgY3R4LnNjYWxlKDEsIG9wdGlvbnMuc2VyaWVzLnBpZS50aWx0KTsgLy9jdHgucm90YXRlKHN0YXJ0QW5nbGUpOyAvLyBzdGFydCBhdCB0b3A7IC0tIFRoaXMgZG9lc24ndCB3b3JrIHByb3Blcmx5IGluIE9wZXJhCiAgICAgIC8vIGRyYXcgc2xpY2VzCgogICAgICBjdHguc2F2ZSgpOwogICAgICB2YXIgY3VycmVudEFuZ2xlID0gc3RhcnRBbmdsZTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2xpY2VzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgc2xpY2VzW2ldLnN0YXJ0QW5nbGUgPSBjdXJyZW50QW5nbGU7CiAgICAgICAgZHJhd1NsaWNlKHNsaWNlc1tpXS5hbmdsZSwgc2xpY2VzW2ldLmNvbG9yLCB0cnVlKTsKICAgICAgfQoKICAgICAgY3R4LnJlc3RvcmUoKTsgLy8gZHJhdyBzbGljZSBvdXRsaW5lcwoKICAgICAgaWYgKG9wdGlvbnMuc2VyaWVzLnBpZS5zdHJva2Uud2lkdGggPiAwKSB7CiAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICBjdHgubGluZVdpZHRoID0gb3B0aW9ucy5zZXJpZXMucGllLnN0cm9rZS53aWR0aDsKICAgICAgICBjdXJyZW50QW5nbGUgPSBzdGFydEFuZ2xlOwoKICAgICAgICBmb3IgKHZhciBfaTQgPSAwOyBfaTQgPCBzbGljZXMubGVuZ3RoOyArK19pNCkgewogICAgICAgICAgZHJhd1NsaWNlKHNsaWNlc1tfaTRdLmFuZ2xlLCBvcHRpb25zLnNlcmllcy5waWUuc3Ryb2tlLmNvbG9yLCBmYWxzZSk7CiAgICAgICAgfQoKICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICB9IC8vIGRyYXcgZG9udXQgaG9sZQoKCiAgICAgIGRyYXdEb251dEhvbGUoY3R4KTsKICAgICAgY3R4LnJlc3RvcmUoKTsgLy8gRHJhdyB0aGUgbGFiZWxzLCByZXR1cm5pbmcgdHJ1ZSBpZiB0aGV5IGZpdCB3aXRoaW4gdGhlIHBsb3QKCiAgICAgIGlmIChvcHRpb25zLnNlcmllcy5waWUubGFiZWwuc2hvdykgewogICAgICAgIHJldHVybiBkcmF3TGFiZWxzKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGRyYXdTbGljZShhbmdsZSwgY29sb3IsIGZpbGwpIHsKICAgICAgICBpZiAoYW5nbGUgPD0gMCB8fCBpc05hTihhbmdsZSkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChmaWxsKSB7CiAgICAgICAgICBjdHguZmlsbFN0eWxlID0gY29sb3I7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGNvbG9yOwogICAgICAgICAgY3R4LmxpbmVKb2luID0gJ3JvdW5kJzsKICAgICAgICB9CgogICAgICAgIGN0eC5iZWdpblBhdGgoKTsKCiAgICAgICAgaWYgKE1hdGguYWJzKGFuZ2xlIC0gTWF0aC5QSSAqIDIpID4gMC4wMDAwMDAwMDEpIHsKICAgICAgICAgIGN0eC5tb3ZlVG8oMCwgMCk7CiAgICAgICAgfSAvLyBDZW50ZXIgb2YgdGhlIHBpZQogICAgICAgIC8vY3R4LmFyYygwLCAwLCByYWRpdXMsIDAsIGFuZ2xlLCBmYWxzZSk7IC8vIFRoaXMgZG9lc24ndCB3b3JrIHByb3Blcmx5IGluIE9wZXJhCgoKICAgICAgICBjdHguYXJjKDAsIDAsIHJhZGl1cywgY3VycmVudEFuZ2xlLCBjdXJyZW50QW5nbGUgKyBhbmdsZSAvIDIsIGZhbHNlKTsKICAgICAgICBjdHguYXJjKDAsIDAsIHJhZGl1cywgY3VycmVudEFuZ2xlICsgYW5nbGUgLyAyLCBjdXJyZW50QW5nbGUgKyBhbmdsZSwgZmFsc2UpOwogICAgICAgIGN0eC5jbG9zZVBhdGgoKTsgLy9jdHgucm90YXRlKGFuZ2xlKTsgLy8gVGhpcyBkb2Vzbid0IHdvcmsgcHJvcGVybHkgaW4gT3BlcmEKCiAgICAgICAgY3VycmVudEFuZ2xlICs9IGFuZ2xlOwoKICAgICAgICBpZiAoZmlsbCkgewogICAgICAgICAgY3R4LmZpbGwoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gZHJhd0xhYmVscygpIHsKICAgICAgICB2YXIgY3VycmVudEFuZ2xlID0gc3RhcnRBbmdsZTsKICAgICAgICB2YXIgcmFkaXVzID0gb3B0aW9ucy5zZXJpZXMucGllLmxhYmVsLnJhZGl1cyA+IDEgPyBvcHRpb25zLnNlcmllcy5waWUubGFiZWwucmFkaXVzIDogbWF4UmFkaXVzICogb3B0aW9ucy5zZXJpZXMucGllLmxhYmVsLnJhZGl1czsKCiAgICAgICAgZm9yICh2YXIgX2k1ID0gMDsgX2k1IDwgc2xpY2VzLmxlbmd0aDsgKytfaTUpIHsKICAgICAgICAgIGlmIChzbGljZXNbX2k1XS5wZXJjZW50ID49IG9wdGlvbnMuc2VyaWVzLnBpZS5sYWJlbC50aHJlc2hvbGQgKiAxMDApIHsKICAgICAgICAgICAgaWYgKCFkcmF3TGFiZWwoc2xpY2VzW19pNV0sIGN1cnJlbnRBbmdsZSwgX2k1KSkgewogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGN1cnJlbnRBbmdsZSArPSBzbGljZXNbX2k1XS5hbmdsZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICBmdW5jdGlvbiBkcmF3TGFiZWwoc2xpY2UsIHN0YXJ0QW5nbGUsIGluZGV4KSB7CiAgICAgICAgICBpZiAoc2xpY2UuZGF0YVswXVsxXSA9PT0gMCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0gLy8gZm9ybWF0IGxhYmVsIHRleHQKCgogICAgICAgICAgdmFyIGxmID0gb3B0aW9ucy5sZWdlbmQubGFiZWxGb3JtYXR0ZXI7CiAgICAgICAgICB2YXIgdGV4dDsKICAgICAgICAgIHZhciBwbGYgPSBvcHRpb25zLnNlcmllcy5waWUubGFiZWwuZm9ybWF0dGVyOwoKICAgICAgICAgIGlmIChsZikgewogICAgICAgICAgICB0ZXh0ID0gbGYoc2xpY2UubGFiZWwsIHNsaWNlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRleHQgPSBzbGljZS5sYWJlbDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAocGxmKSB7CiAgICAgICAgICAgIHRleHQgPSBwbGYodGV4dCwgc2xpY2UpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBoYWxmQW5nbGUgPSAoc3RhcnRBbmdsZSArIHNsaWNlLmFuZ2xlICsgc3RhcnRBbmdsZSkgLyAyOwogICAgICAgICAgdmFyIHggPSBjZW50ZXJMZWZ0ICsgTWF0aC5yb3VuZChNYXRoLmNvcyhoYWxmQW5nbGUpICogcmFkaXVzKTsKICAgICAgICAgIHZhciB5ID0gY2VudGVyVG9wICsgTWF0aC5yb3VuZChNYXRoLnNpbihoYWxmQW5nbGUpICogcmFkaXVzKSAqIG9wdGlvbnMuc2VyaWVzLnBpZS50aWx0OwogICAgICAgICAgdmFyIGh0bWwgPSAiPHNwYW4gY2xhc3M9J3BpZUxhYmVsJyBpZD0ncGllTGFiZWwiICsgaW5kZXggKyAiJyBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7dG9wOiIgKyB5ICsgJ3B4O2xlZnQ6JyArIHggKyAicHg7Jz4iICsgdGV4dCArICc8L3NwYW4+JzsKICAgICAgICAgIHRhcmdldC5hcHBlbmQoaHRtbCk7CiAgICAgICAgICB2YXIgbGFiZWwgPSB0YXJnZXQuY2hpbGRyZW4oJyNwaWVMYWJlbCcgKyBpbmRleCk7CiAgICAgICAgICB2YXIgbGFiZWxUb3AgPSB5IC0gbGFiZWwuaGVpZ2h0KCkgLyAyOwogICAgICAgICAgdmFyIGxhYmVsTGVmdCA9IHggLSBsYWJlbC53aWR0aCgpIC8gMjsKICAgICAgICAgIGxhYmVsLmNzcygndG9wJywgbGFiZWxUb3ApOwogICAgICAgICAgbGFiZWwuY3NzKCdsZWZ0JywgbGFiZWxMZWZ0KTsgLy8gY2hlY2sgdG8gbWFrZSBzdXJlIHRoYXQgdGhlIGxhYmVsIGlzIG5vdCBvdXRzaWRlIHRoZSBjYW52YXMKCiAgICAgICAgICBpZiAoMCAtIGxhYmVsVG9wID4gMCB8fCAwIC0gbGFiZWxMZWZ0ID4gMCB8fCBjYW52YXNIZWlnaHQgLSAobGFiZWxUb3AgKyBsYWJlbC5oZWlnaHQoKSkgPCAwIHx8IGNhbnZhc1dpZHRoIC0gKGxhYmVsTGVmdCArIGxhYmVsLndpZHRoKCkpIDwgMCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG9wdGlvbnMuc2VyaWVzLnBpZS5sYWJlbC5iYWNrZ3JvdW5kLm9wYWNpdHkgIT09IDApIHsKICAgICAgICAgICAgLy8gcHV0IGluIHRoZSB0cmFuc3BhcmVudCBiYWNrZ3JvdW5kIHNlcGFyYXRlbHkgdG8gYXZvaWQgYmxlbmRlZCBsYWJlbHMgYW5kIGxhYmVsIGJveGVzCiAgICAgICAgICAgIHZhciBjID0gb3B0aW9ucy5zZXJpZXMucGllLmxhYmVsLmJhY2tncm91bmQuY29sb3I7CgogICAgICAgICAgICBpZiAoYyA9PSBudWxsKSB7CiAgICAgICAgICAgICAgYyA9IHNsaWNlLmNvbG9yOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgcG9zID0gJ3RvcDonICsgbGFiZWxUb3AgKyAncHg7bGVmdDonICsgbGFiZWxMZWZ0ICsgJ3B4Oyc7CiAgICAgICAgICAgICgwLCBfanF1ZXJ5LmRlZmF1bHQpKCI8ZGl2IGNsYXNzPSdwaWVMYWJlbEJhY2tncm91bmQnIHN0eWxlPSdwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDoiICsgbGFiZWwud2lkdGgoKSArICdweDtoZWlnaHQ6JyArIGxhYmVsLmhlaWdodCgpICsgJ3B4OycgKyBwb3MgKyAnYmFja2dyb3VuZC1jb2xvcjonICsgYyArICI7Jz48L2Rpdj4iKS5jc3MoJ29wYWNpdHknLCBvcHRpb25zLnNlcmllcy5waWUubGFiZWwuYmFja2dyb3VuZC5vcGFjaXR5KS5pbnNlcnRCZWZvcmUobGFiZWwpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gLy8gZW5kIGluZGl2aWR1YWwgbGFiZWwgZnVuY3Rpb24KCiAgICAgIH0gLy8gZW5kIGRyYXdMYWJlbHMgZnVuY3Rpb24KCiAgICB9IC8vIGVuZCBkcmF3UGllIGZ1bmN0aW9uCgogIH0gLy8gZW5kIGRyYXcgZnVuY3Rpb24KICAvLyBQbGFjZWQgaGVyZSBiZWNhdXNlIGl0IG5lZWRzIHRvIGJlIGFjY2Vzc2VkIGZyb20gbXVsdGlwbGUgbG9jYXRpb25zCgoKICBmdW5jdGlvbiBkcmF3RG9udXRIb2xlKGxheWVyKSB7CiAgICBpZiAob3B0aW9ucy5zZXJpZXMucGllLmlubmVyUmFkaXVzID4gMCkgewogICAgICAvLyBzdWJ0cmFjdCB0aGUgY2VudGVyCiAgICAgIGxheWVyLnNhdmUoKTsKICAgICAgdmFyIGlubmVyUmFkaXVzID0gb3B0aW9ucy5zZXJpZXMucGllLmlubmVyUmFkaXVzID4gMSA/IG9wdGlvbnMuc2VyaWVzLnBpZS5pbm5lclJhZGl1cyA6IG1heFJhZGl1cyAqIG9wdGlvbnMuc2VyaWVzLnBpZS5pbm5lclJhZGl1czsKICAgICAgbGF5ZXIuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ2Rlc3RpbmF0aW9uLW91dCc7IC8vIHRoaXMgZG9lcyBub3Qgd29yayB3aXRoIGV4Y2FudmFzLCBidXQgaXQgd2lsbCBmYWxsIGJhY2sgdG8gdXNpbmcgdGhlIHN0cm9rZSBjb2xvcgoKICAgICAgbGF5ZXIuYmVnaW5QYXRoKCk7CiAgICAgIGxheWVyLmZpbGxTdHlsZSA9IG9wdGlvbnMuc2VyaWVzLnBpZS5zdHJva2UuY29sb3I7CiAgICAgIGxheWVyLmFyYygwLCAwLCBpbm5lclJhZGl1cywgMCwgTWF0aC5QSSAqIDIsIGZhbHNlKTsKICAgICAgbGF5ZXIuZmlsbCgpOwogICAgICBsYXllci5jbG9zZVBhdGgoKTsKICAgICAgbGF5ZXIucmVzdG9yZSgpOyAvLyBhZGQgaW5uZXIgc3Ryb2tlCiAgICAgIC8vIFRPRE86IENhbnZhcyBmb3JrZWQgZmxvdCBoZXJlIQoKICAgICAgaWYgKG9wdGlvbnMuc2VyaWVzLnBpZS5zdHJva2Uud2lkdGggPiAwKSB7CiAgICAgICAgbGF5ZXIuc2F2ZSgpOwogICAgICAgIGxheWVyLmJlZ2luUGF0aCgpOwogICAgICAgIGxheWVyLnN0cm9rZVN0eWxlID0gb3B0aW9ucy5zZXJpZXMucGllLnN0cm9rZS5jb2xvcjsKICAgICAgICBsYXllci5hcmMoMCwgMCwgaW5uZXJSYWRpdXMsIDAsIE1hdGguUEkgKiAyLCBmYWxzZSk7CiAgICAgICAgbGF5ZXIuc3Ryb2tlKCk7CiAgICAgICAgbGF5ZXIuY2xvc2VQYXRoKCk7CiAgICAgICAgbGF5ZXIucmVzdG9yZSgpOwogICAgICB9IC8vIFRPRE86IGFkZCBleHRyYSBzaGFkb3cgaW5zaWRlIGhvbGUgKHdpdGggYSBtYXNrKSBpZiB0aGUgcGllIGlzIHRpbHRlZC4KCiAgICB9CiAgfSAvLy0tIEFkZGl0aW9uYWwgSW50ZXJhY3RpdmUgcmVsYXRlZCBmdW5jdGlvbnMgLS0KCgogIGZ1bmN0aW9uIGlzUG9pbnRJblBvbHkocG9seSwgcHQpIHsKICAgIHZhciBjID0gZmFsc2U7CiAgICB2YXIgbCA9IHBvbHkubGVuZ3RoOwogICAgdmFyIGogPSBsIC0gMTsKCiAgICBmb3IgKHZhciBpID0gLTE7ICsraSA8IGw7IGogPSBpKSB7CiAgICAgIChwb2x5W2ldWzFdIDw9IHB0WzFdICYmIHB0WzFdIDwgcG9seVtqXVsxXSB8fCBwb2x5W2pdWzFdIDw9IHB0WzFdICYmIHB0WzFdIDwgcG9seVtpXVsxXSkgJiYgcHRbMF0gPCAocG9seVtqXVswXSAtIHBvbHlbaV1bMF0pICogKHB0WzFdIC0gcG9seVtpXVsxXSkgLyAocG9seVtqXVsxXSAtIHBvbHlbaV1bMV0pICsgcG9seVtpXVswXSAmJiAoYyA9ICFjKTsKICAgIH0KCiAgICByZXR1cm4gYzsKICB9CgogIGZ1bmN0aW9uIGZpbmROZWFyYnlTbGljZShtb3VzZVgsIG1vdXNlWSkgewogICAgdmFyIHNsaWNlcyA9IHBsb3QuZ2V0RGF0YSgpOwogICAgdmFyIG9wdGlvbnMgPSBwbG90LmdldE9wdGlvbnMoKTsKICAgIHZhciByYWRpdXMgPSBvcHRpb25zLnNlcmllcy5waWUucmFkaXVzID4gMSA/IG9wdGlvbnMuc2VyaWVzLnBpZS5yYWRpdXMgOiBtYXhSYWRpdXMgKiBvcHRpb25zLnNlcmllcy5waWUucmFkaXVzOwogICAgdmFyIHg7CiAgICB2YXIgeTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWNlcy5sZW5ndGg7ICsraSkgewogICAgICB2YXIgcyA9IHNsaWNlc1tpXTsKCiAgICAgIGlmIChzLnBpZS5zaG93KSB7CiAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgY3R4Lm1vdmVUbygwLCAwKTsgLy8gQ2VudGVyIG9mIHRoZSBwaWUKICAgICAgICAvL2N0eC5zY2FsZSgxLCBvcHRpb25zLnNlcmllcy5waWUudGlsdCk7CS8vIHRoaXMgYWN0dWFsbHkgc2VlbXMgdG8gYnJlYWsgZXZlcnl0aGluZyB3aGVuIGhlcmUuCgogICAgICAgIGN0eC5hcmMoMCwgMCwgcmFkaXVzLCBzLnN0YXJ0QW5nbGUsIHMuc3RhcnRBbmdsZSArIHMuYW5nbGUgLyAyLCBmYWxzZSk7CiAgICAgICAgY3R4LmFyYygwLCAwLCByYWRpdXMsIHMuc3RhcnRBbmdsZSArIHMuYW5nbGUgLyAyLCBzLnN0YXJ0QW5nbGUgKyBzLmFuZ2xlLCBmYWxzZSk7CiAgICAgICAgY3R4LmNsb3NlUGF0aCgpOwogICAgICAgIHggPSBtb3VzZVggLSBjZW50ZXJMZWZ0OwogICAgICAgIHkgPSBtb3VzZVkgLSBjZW50ZXJUb3A7CgogICAgICAgIGlmIChjdHguaXNQb2ludEluUGF0aCkgewogICAgICAgICAgaWYgKGN0eC5pc1BvaW50SW5QYXRoKG1vdXNlWCAtIGNlbnRlckxlZnQsIG1vdXNlWSAtIGNlbnRlclRvcCkpIHsKICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBkYXRhcG9pbnQ6IFtzLnBlcmNlbnQsIHMuZGF0YV0sCiAgICAgICAgICAgICAgZGF0YUluZGV4OiAwLAogICAgICAgICAgICAgIHNlcmllczogcywKICAgICAgICAgICAgICBzZXJpZXNJbmRleDogaQogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBleGNhbnZhcyBmb3IgSUUgZG9lc247dCBzdXBwb3J0IGlzUG9pbnRJblBhdGgsIHRoaXMgaXMgYSB3b3JrYXJvdW5kLgogICAgICAgICAgdmFyIHAxWCA9IHJhZGl1cyAqIE1hdGguY29zKHMuc3RhcnRBbmdsZSk7CiAgICAgICAgICB2YXIgcDFZID0gcmFkaXVzICogTWF0aC5zaW4ocy5zdGFydEFuZ2xlKTsKICAgICAgICAgIHZhciBwMlggPSByYWRpdXMgKiBNYXRoLmNvcyhzLnN0YXJ0QW5nbGUgKyBzLmFuZ2xlIC8gNCk7CiAgICAgICAgICB2YXIgcDJZID0gcmFkaXVzICogTWF0aC5zaW4ocy5zdGFydEFuZ2xlICsgcy5hbmdsZSAvIDQpOwogICAgICAgICAgdmFyIHAzWCA9IHJhZGl1cyAqIE1hdGguY29zKHMuc3RhcnRBbmdsZSArIHMuYW5nbGUgLyAyKTsKICAgICAgICAgIHZhciBwM1kgPSByYWRpdXMgKiBNYXRoLnNpbihzLnN0YXJ0QW5nbGUgKyBzLmFuZ2xlIC8gMik7CiAgICAgICAgICB2YXIgcDRYID0gcmFkaXVzICogTWF0aC5jb3Mocy5zdGFydEFuZ2xlICsgcy5hbmdsZSAvIDEuNSk7CiAgICAgICAgICB2YXIgcDRZID0gcmFkaXVzICogTWF0aC5zaW4ocy5zdGFydEFuZ2xlICsgcy5hbmdsZSAvIDEuNSk7CiAgICAgICAgICB2YXIgcDVYID0gcmFkaXVzICogTWF0aC5jb3Mocy5zdGFydEFuZ2xlICsgcy5hbmdsZSk7CiAgICAgICAgICB2YXIgcDVZID0gcmFkaXVzICogTWF0aC5zaW4ocy5zdGFydEFuZ2xlICsgcy5hbmdsZSk7CiAgICAgICAgICB2YXIgYXJyUG9seSA9IFtbMCwgMF0sIFtwMVgsIHAxWV0sIFtwMlgsIHAyWV0sIFtwM1gsIHAzWV0sIFtwNFgsIHA0WV0sIFtwNVgsIHA1WV1dOwogICAgICAgICAgdmFyIGFyclBvaW50ID0gW3gsIHldOyAvLyBUT0RPOiBwZXJoYXBzIGRvIHNvbWUgbWF0aG1hdGljYWwgdHJpY2tlcnkgaGVyZSB3aXRoIHRoZSBZLWNvb3JkaW5hdGUgdG8gY29tcGVuc2F0ZSBmb3IgcGllIHRpbHQ/CgogICAgICAgICAgaWYgKGlzUG9pbnRJblBvbHkoYXJyUG9seSwgYXJyUG9pbnQpKSB7CiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgZGF0YXBvaW50OiBbcy5wZXJjZW50LCBzLmRhdGFdLAogICAgICAgICAgICAgIGRhdGFJbmRleDogMCwKICAgICAgICAgICAgICBzZXJpZXM6IHMsCiAgICAgICAgICAgICAgc2VyaWVzSW5kZXg6IGkKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGN0eC5yZXN0b3JlKCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGZ1bmN0aW9uIG9uTW91c2VNb3ZlKGUpIHsKICAgIHRyaWdnZXJDbGlja0hvdmVyRXZlbnQoJ3Bsb3Rob3ZlcicsIGUpOwogIH0KCiAgZnVuY3Rpb24gb25DbGljayhlKSB7CiAgICB0cmlnZ2VyQ2xpY2tIb3ZlckV2ZW50KCdwbG90Y2xpY2snLCBlKTsKICB9IC8vIHRyaWdnZXIgY2xpY2sgb3IgaG92ZXIgZXZlbnQgKHRoZXkgc2VuZCB0aGUgc2FtZSBwYXJhbWV0ZXJzIHNvIHdlIHNoYXJlIHRoZWlyIGNvZGUpCgoKICBmdW5jdGlvbiB0cmlnZ2VyQ2xpY2tIb3ZlckV2ZW50KGV2ZW50bmFtZSwgZSkgewogICAgdmFyIG9mZnNldCA9IHBsb3Qub2Zmc2V0KCk7CiAgICB2YXIgY2FudmFzWCA9IHBhcnNlSW50KGUucGFnZVggLSBvZmZzZXQubGVmdCwgMTApOwogICAgdmFyIGNhbnZhc1kgPSBwYXJzZUludChlLnBhZ2VZIC0gb2Zmc2V0LnRvcCwgMTApOwogICAgdmFyIGl0ZW0gPSBmaW5kTmVhcmJ5U2xpY2UoY2FudmFzWCwgY2FudmFzWSk7CgogICAgaWYgKG9wdGlvbnMuZ3JpZC5hdXRvSGlnaGxpZ2h0KSB7CiAgICAgIC8vIGNsZWFyIGF1dG8taGlnaGxpZ2h0cwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhpZ2hsaWdodHMubGVuZ3RoOyArK2kpIHsKICAgICAgICB2YXIgaCA9IGhpZ2hsaWdodHNbaV07CgogICAgICAgIGlmIChoLmF1dG8gPT09IGV2ZW50bmFtZSAmJiAhKGl0ZW0gJiYgaC5zZXJpZXMgPT09IGl0ZW0uc2VyaWVzKSkgewogICAgICAgICAgdW5oaWdobGlnaHQoaC5zZXJpZXMpOwogICAgICAgIH0KICAgICAgfQogICAgfSAvLyBoaWdobGlnaHQgdGhlIHNsaWNlCgoKICAgIGlmIChpdGVtKSB7CiAgICAgIGhpZ2hsaWdodChpdGVtLnNlcmllcywgZXZlbnRuYW1lKTsKICAgIH0gLy8gdHJpZ2dlciBhbnkgaG92ZXIgYmluZCBldmVudHMKCgogICAgdmFyIHBvcyA9IHsKICAgICAgcGFnZVg6IGUucGFnZVgsCiAgICAgIHBhZ2VZOiBlLnBhZ2VZCiAgICB9OwogICAgdGFyZ2V0LnRyaWdnZXIoZXZlbnRuYW1lLCBbcG9zLCBpdGVtXSk7CiAgfQoKICBmdW5jdGlvbiBoaWdobGlnaHQocywgYXV0bykgewogICAgLy9pZiAodHlwZW9mIHMgPT0gIm51bWJlciIpIHsKICAgIC8vCXMgPSBzZXJpZXNbc107CiAgICAvL30KICAgIHZhciBpID0gaW5kZXhPZkhpZ2hsaWdodChzKTsKCiAgICBpZiAoaSA9PT0gLTEpIHsKICAgICAgaGlnaGxpZ2h0cy5wdXNoKHsKICAgICAgICBzZXJpZXM6IHMsCiAgICAgICAgYXV0bzogYXV0bwogICAgICB9KTsKICAgICAgcGxvdC50cmlnZ2VyUmVkcmF3T3ZlcmxheSgpOwogICAgfSBlbHNlIGlmICghYXV0bykgewogICAgICBoaWdobGlnaHRzW2ldLmF1dG8gPSBmYWxzZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHVuaGlnaGxpZ2h0KHMpIHsKICAgIGlmIChzID09IG51bGwpIHsKICAgICAgaGlnaGxpZ2h0cyA9IFtdOwogICAgICBwbG90LnRyaWdnZXJSZWRyYXdPdmVybGF5KCk7CiAgICB9IC8vaWYgKHR5cGVvZiBzID09ICJudW1iZXIiKSB7CiAgICAvLwlzID0gc2VyaWVzW3NdOwogICAgLy99CgoKICAgIHZhciBpID0gaW5kZXhPZkhpZ2hsaWdodChzKTsKCiAgICBpZiAoaSAhPT0gLTEpIHsKICAgICAgaGlnaGxpZ2h0cy5zcGxpY2UoaSwgMSk7CiAgICAgIHBsb3QudHJpZ2dlclJlZHJhd092ZXJsYXkoKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGluZGV4T2ZIaWdobGlnaHQocykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoaWdobGlnaHRzLmxlbmd0aDsgKytpKSB7CiAgICAgIHZhciBoID0gaGlnaGxpZ2h0c1tpXTsKCiAgICAgIGlmIChoLnNlcmllcyA9PT0gcykgewogICAgICAgIHJldHVybiBpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIC0xOwogIH0KCiAgZnVuY3Rpb24gZHJhd092ZXJsYXkocGxvdCwgb2N0eCkgewogICAgdmFyIG9wdGlvbnMgPSBwbG90LmdldE9wdGlvbnMoKTsKICAgIHZhciByYWRpdXMgPSBvcHRpb25zLnNlcmllcy5waWUucmFkaXVzID4gMSA/IG9wdGlvbnMuc2VyaWVzLnBpZS5yYWRpdXMgOiBtYXhSYWRpdXMgKiBvcHRpb25zLnNlcmllcy5waWUucmFkaXVzOwogICAgb2N0eC5zYXZlKCk7CiAgICBvY3R4LnRyYW5zbGF0ZShjZW50ZXJMZWZ0LCBjZW50ZXJUb3ApOwogICAgb2N0eC5zY2FsZSgxLCBvcHRpb25zLnNlcmllcy5waWUudGlsdCk7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoaWdobGlnaHRzLmxlbmd0aDsgKytpKSB7CiAgICAgIGRyYXdIaWdobGlnaHQoaGlnaGxpZ2h0c1tpXS5zZXJpZXMpOwogICAgfQoKICAgIGRyYXdEb251dEhvbGUob2N0eCk7CiAgICBvY3R4LnJlc3RvcmUoKTsKCiAgICBmdW5jdGlvbiBkcmF3SGlnaGxpZ2h0KHNlcmllcykgewogICAgICBpZiAoc2VyaWVzLmFuZ2xlIDw9IDAgfHwgaXNOYU4oc2VyaWVzLmFuZ2xlKSkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvL29jdHguZmlsbFN0eWxlID0gcGFyc2VDb2xvcihvcHRpb25zLnNlcmllcy5waWUuaGlnaGxpZ2h0LmNvbG9yKS5zY2FsZShudWxsLCBudWxsLCBudWxsLCBvcHRpb25zLnNlcmllcy5waWUuaGlnaGxpZ2h0Lm9wYWNpdHkpLnRvU3RyaW5nKCk7CgoKICAgICAgb2N0eC5maWxsU3R5bGUgPSAncmdiYSgyNTUsIDI1NSwgMjU1LCAnICsgb3B0aW9ucy5zZXJpZXMucGllLmhpZ2hsaWdodC5vcGFjaXR5ICsgJyknOyAvLyB0aGlzIGlzIHRlbXBvcmFyeSB1bnRpbCB3ZSBoYXZlIGFjY2VzcyB0byBwYXJzZUNvbG9yCgogICAgICBvY3R4LmJlZ2luUGF0aCgpOwoKICAgICAgaWYgKE1hdGguYWJzKHNlcmllcy5hbmdsZSAtIE1hdGguUEkgKiAyKSA+IDAuMDAwMDAwMDAxKSB7CiAgICAgICAgb2N0eC5tb3ZlVG8oMCwgMCk7CiAgICAgIH0gLy8gQ2VudGVyIG9mIHRoZSBwaWUKCgogICAgICBvY3R4LmFyYygwLCAwLCByYWRpdXMsIHNlcmllcy5zdGFydEFuZ2xlLCBzZXJpZXMuc3RhcnRBbmdsZSArIHNlcmllcy5hbmdsZSAvIDIsIGZhbHNlKTsKICAgICAgb2N0eC5hcmMoMCwgMCwgcmFkaXVzLCBzZXJpZXMuc3RhcnRBbmdsZSArIHNlcmllcy5hbmdsZSAvIDIsIHNlcmllcy5zdGFydEFuZ2xlICsgc2VyaWVzLmFuZ2xlLCBmYWxzZSk7CiAgICAgIG9jdHguY2xvc2VQYXRoKCk7CiAgICAgIG9jdHguZmlsbCgpOwogICAgfQogIH0KfSAvLyBlbmQgaW5pdCAocGx1Z2luIGJvZHkpCi8vIGRlZmluZSBwaWUgc3BlY2lmaWMgb3B0aW9ucyBhbmQgdGhlaXIgZGVmYXVsdCB2YWx1ZXMKCgp2YXIgb3B0aW9ucyA9IHsKICBzZXJpZXM6IHsKICAgIHBpZTogewogICAgICBzaG93OiBmYWxzZSwKICAgICAgcmFkaXVzOiAnYXV0bycsCiAgICAgIC8vIGFjdHVhbCByYWRpdXMgb2YgdGhlIHZpc2libGUgcGllIChiYXNlZCBvbiBmdWxsIGNhbGN1bGF0ZWQgcmFkaXVzIGlmIDw9MSwgb3IgaGFyZCBwaXhlbCB2YWx1ZSkKICAgICAgaW5uZXJSYWRpdXM6IDAKICAgICAgLyogZm9yIGRvbnV0ICovCiAgICAgICwKICAgICAgc3RhcnRBbmdsZTogMyAvIDIsCiAgICAgIHRpbHQ6IDEsCiAgICAgIHNoYWRvdzogewogICAgICAgIGxlZnQ6IDUsCiAgICAgICAgLy8gc2hhZG93IGxlZnQgb2Zmc2V0CiAgICAgICAgdG9wOiAxNSwKICAgICAgICAvLyBzaGFkb3cgdG9wIG9mZnNldAogICAgICAgIGFscGhhOiAwLjAyIC8vIHNoYWRvdyBhbHBoYQoKICAgICAgfSwKICAgICAgb2Zmc2V0OiB7CiAgICAgICAgdG9wOiAwLAogICAgICAgIGxlZnQ6ICdhdXRvJwogICAgICB9LAogICAgICBzdHJva2U6IHsKICAgICAgICBjb2xvcjogJyNmZmYnLAogICAgICAgIHdpZHRoOiAxCiAgICAgIH0sCiAgICAgIGxhYmVsOiB7CiAgICAgICAgc2hvdzogJ2F1dG8nLAogICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24gZm9ybWF0dGVyKGxhYmVsLCBzbGljZSkgewogICAgICAgICAgcmV0dXJuICI8ZGl2IHN0eWxlPSdmb250LXNpemU6eC1zbWFsbDt0ZXh0LWFsaWduOmNlbnRlcjtwYWRkaW5nOjJweDtjb2xvcjoiICsgc2xpY2UuY29sb3IgKyAiOyc+IiArIGxhYmVsICsgJzxici8+JyArIE1hdGgucm91bmQoc2xpY2UucGVyY2VudCkgKyAnJTwvZGl2Pic7CiAgICAgICAgfSwKICAgICAgICAvLyBmb3JtYXR0ZXIgZnVuY3Rpb24KICAgICAgICByYWRpdXM6IDEsCiAgICAgICAgLy8gcmFkaXVzIGF0IHdoaWNoIHRvIHBsYWNlIHRoZSBsYWJlbHMgKGJhc2VkIG9uIGZ1bGwgY2FsY3VsYXRlZCByYWRpdXMgaWYgPD0xLCBvciBoYXJkIHBpeGVsIHZhbHVlKQogICAgICAgIGJhY2tncm91bmQ6IHsKICAgICAgICAgIGNvbG9yOiBudWxsLAogICAgICAgICAgb3BhY2l0eTogMAogICAgICAgIH0sCiAgICAgICAgdGhyZXNob2xkOiAwIC8vIHBlcmNlbnRhZ2UgYXQgd2hpY2ggdG8gaGlkZSB0aGUgbGFiZWwgKGkuZS4gdGhlIHNsaWNlIGlzIHRvbyBuYXJyb3cpCgogICAgICB9LAogICAgICBjb21iaW5lOiB7CiAgICAgICAgdGhyZXNob2xkOiAtMSwKICAgICAgICAvLyBwZXJjZW50YWdlIGF0IHdoaWNoIHRvIGNvbWJpbmUgbGl0dGxlIHNsaWNlcyBpbnRvIG9uZSBsYXJnZXIgc2xpY2UKICAgICAgICBjb2xvcjogbnVsbCwKICAgICAgICAvLyBjb2xvciB0byBnaXZlIHRoZSBuZXcgc2xpY2UgKGF1dG8tZ2VuZXJhdGVkIGlmIG51bGwpCiAgICAgICAgbGFiZWw6ICdPdGhlcicgLy8gbGFiZWwgdG8gZ2l2ZSB0aGUgbmV3IHNsaWNlCgogICAgICB9LAogICAgICBoaWdobGlnaHQ6IHsKICAgICAgICAvL2NvbG9yOiAiI2ZmZiIsCQkvLyB3aWxsIGFkZCB0aGlzIGZ1bmN0aW9uYWxpdHkgb25jZSBwYXJzZUNvbG9yIGlzIGF2YWlsYWJsZQogICAgICAgIG9wYWNpdHk6IDAuNQogICAgICB9CiAgICB9CiAgfQp9Owp2YXIgcGllID0gewogIGluaXQ6IGluaXQsCiAgb3B0aW9uczogb3B0aW9ucywKICBuYW1lOiAncGllJywKICB2ZXJzaW9uOiAnMS4xJwp9OwpleHBvcnRzLnBpZSA9IHBpZTs="},null]}