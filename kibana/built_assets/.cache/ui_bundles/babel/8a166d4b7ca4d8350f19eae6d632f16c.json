{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/helpers.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/helpers.js","mtime":1589249553292},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLnVzZXJIYXNOb1Blcm1pc3Npb25zID0gZXhwb3J0cy5nZXRBY3Rpb25NZXNzYWdlUGFyYW1zID0gZXhwb3J0cy5nZXRBY3Rpb25NZXNzYWdlUnVsZVBhcmFtcyA9IGV4cG9ydHMucmVkaXJlY3RUb0RldGVjdGlvbnMgPSBleHBvcnRzLnNldEZpZWxkVmFsdWUgPSBleHBvcnRzLmdldFByZVBhY2thZ2VkUnVsZVN0YXR1cyA9IGV4cG9ydHMudXNlUXVlcnkgPSBleHBvcnRzLmdldE1vZGlmaWVkQWJvdXREZXRhaWxzRGF0YSA9IGV4cG9ydHMuZGV0ZXJtaW5lRGV0YWlsc1ZhbHVlID0gZXhwb3J0cy5nZXRBYm91dFN0ZXBzRGF0YSA9IGV4cG9ydHMuZ2V0SHVtYW5pemVkRHVyYXRpb24gPSBleHBvcnRzLmdldFNjaGVkdWxlU3RlcHNEYXRhID0gZXhwb3J0cy5nZXREZWZpbmVTdGVwc0RhdGEgPSBleHBvcnRzLmdldEFjdGlvbnNTdGVwc0RhdGEgPSBleHBvcnRzLmdldFN0ZXBzRGF0YSA9IHZvaWQgMDsKCnZhciBfZGF0ZW1hdGggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkBlbGFzdGljL2RhdGVtYXRoIikpOwoKdmFyIF9mcCA9IHJlcXVpcmUoImxvZGFzaC9mcCIpOwoKdmFyIF9tb21lbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudCIpKTsKCnZhciBfbWVtb2l6ZU9uZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibWVtb2l6ZS1vbmUiKSk7Cgp2YXIgX3JlYWN0Um91dGVyRG9tID0gcmVxdWlyZSgicmVhY3Qtcm91dGVyLWRvbSIpOwoKdmFyIF9tbF9oZWxwZXJzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tbW9uL2RldGVjdGlvbl9lbmdpbmUvbWxfaGVscGVycyIpOwoKdmFyIF90cmFuc2Zvcm1fYWN0aW9ucyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbW1vbi9kZXRlY3Rpb25fZW5naW5lL3RyYW5zZm9ybV9hY3Rpb25zIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCnZhciBnZXRTdGVwc0RhdGEgPSBmdW5jdGlvbiBnZXRTdGVwc0RhdGEoX3JlZikgewogIHZhciBydWxlID0gX3JlZi5ydWxlLAogICAgICBfcmVmJGRldGFpbHNWaWV3ID0gX3JlZi5kZXRhaWxzVmlldywKICAgICAgZGV0YWlsc1ZpZXcgPSBfcmVmJGRldGFpbHNWaWV3ID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYkZGV0YWlsc1ZpZXc7CiAgdmFyIGRlZmluZVJ1bGVEYXRhID0gZ2V0RGVmaW5lU3RlcHNEYXRhKHJ1bGUpOwogIHZhciBhYm91dFJ1bGVEYXRhID0gZ2V0QWJvdXRTdGVwc0RhdGEocnVsZSwgZGV0YWlsc1ZpZXcpOwogIHZhciBtb2RpZmllZEFib3V0UnVsZURldGFpbHNEYXRhID0gZ2V0TW9kaWZpZWRBYm91dERldGFpbHNEYXRhKHJ1bGUpOwogIHZhciBzY2hlZHVsZVJ1bGVEYXRhID0gZ2V0U2NoZWR1bGVTdGVwc0RhdGEocnVsZSk7CiAgdmFyIHJ1bGVBY3Rpb25zRGF0YSA9IGdldEFjdGlvbnNTdGVwc0RhdGEocnVsZSk7CiAgcmV0dXJuIHsKICAgIGFib3V0UnVsZURhdGE6IGFib3V0UnVsZURhdGEsCiAgICBtb2RpZmllZEFib3V0UnVsZURldGFpbHNEYXRhOiBtb2RpZmllZEFib3V0UnVsZURldGFpbHNEYXRhLAogICAgZGVmaW5lUnVsZURhdGE6IGRlZmluZVJ1bGVEYXRhLAogICAgc2NoZWR1bGVSdWxlRGF0YTogc2NoZWR1bGVSdWxlRGF0YSwKICAgIHJ1bGVBY3Rpb25zRGF0YTogcnVsZUFjdGlvbnNEYXRhCiAgfTsKfTsKCmV4cG9ydHMuZ2V0U3RlcHNEYXRhID0gZ2V0U3RlcHNEYXRhOwoKdmFyIGdldEFjdGlvbnNTdGVwc0RhdGEgPSBmdW5jdGlvbiBnZXRBY3Rpb25zU3RlcHNEYXRhKHJ1bGUpIHsKICB2YXIgZW5hYmxlZCA9IHJ1bGUuZW5hYmxlZCwKICAgICAgdGhyb3R0bGUgPSBydWxlLnRocm90dGxlLAogICAgICBtZXRhID0gcnVsZS5tZXRhLAogICAgICBfcnVsZSRhY3Rpb25zID0gcnVsZS5hY3Rpb25zLAogICAgICBhY3Rpb25zID0gX3J1bGUkYWN0aW9ucyA9PT0gdm9pZCAwID8gW10gOiBfcnVsZSRhY3Rpb25zOwogIHJldHVybiB7CiAgICBhY3Rpb25zOiBhY3Rpb25zID09PSBudWxsIHx8IGFjdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFjdGlvbnMubWFwKF90cmFuc2Zvcm1fYWN0aW9ucy50cmFuc2Zvcm1SdWxlVG9BbGVydEFjdGlvbiksCiAgICBpc05ldzogZmFsc2UsCiAgICB0aHJvdHRsZTogdGhyb3R0bGUsCiAgICBraWJhbmFTaWVtQXBwVXJsOiBtZXRhID09PSBudWxsIHx8IG1ldGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG1ldGEua2liYW5hX3NpZW1fYXBwX3VybCwKICAgIGVuYWJsZWQ6IGVuYWJsZWQKICB9Owp9OwoKZXhwb3J0cy5nZXRBY3Rpb25zU3RlcHNEYXRhID0gZ2V0QWN0aW9uc1N0ZXBzRGF0YTsKCnZhciBnZXREZWZpbmVTdGVwc0RhdGEgPSBmdW5jdGlvbiBnZXREZWZpbmVTdGVwc0RhdGEocnVsZSkgewogIHZhciBfcnVsZSRhbm9tYWx5X3RocmVzaG8sIF9ydWxlJG1hY2hpbmVfbGVhcm5pbiwgX3J1bGUkaW5kZXgsIF9ydWxlJHF1ZXJ5LCBfcnVsZSRsYW5ndWFnZSwgX3J1bGUkZmlsdGVycywgX3J1bGUkdGltZWxpbmVfaWQsIF9ydWxlJHRpbWVsaW5lX3RpdGxlOwoKICByZXR1cm4gewogICAgaXNOZXc6IGZhbHNlLAogICAgcnVsZVR5cGU6IHJ1bGUudHlwZSwKICAgIGFub21hbHlUaHJlc2hvbGQ6IChfcnVsZSRhbm9tYWx5X3RocmVzaG8gPSBydWxlLmFub21hbHlfdGhyZXNob2xkKSAhPT0gbnVsbCAmJiBfcnVsZSRhbm9tYWx5X3RocmVzaG8gIT09IHZvaWQgMCA/IF9ydWxlJGFub21hbHlfdGhyZXNobyA6IDUwLAogICAgbWFjaGluZUxlYXJuaW5nSm9iSWQ6IChfcnVsZSRtYWNoaW5lX2xlYXJuaW4gPSBydWxlLm1hY2hpbmVfbGVhcm5pbmdfam9iX2lkKSAhPT0gbnVsbCAmJiBfcnVsZSRtYWNoaW5lX2xlYXJuaW4gIT09IHZvaWQgMCA/IF9ydWxlJG1hY2hpbmVfbGVhcm5pbiA6ICcnLAogICAgaW5kZXg6IChfcnVsZSRpbmRleCA9IHJ1bGUuaW5kZXgpICE9PSBudWxsICYmIF9ydWxlJGluZGV4ICE9PSB2b2lkIDAgPyBfcnVsZSRpbmRleCA6IFtdLAogICAgcXVlcnlCYXI6IHsKICAgICAgcXVlcnk6IHsKICAgICAgICBxdWVyeTogKF9ydWxlJHF1ZXJ5ID0gcnVsZS5xdWVyeSkgIT09IG51bGwgJiYgX3J1bGUkcXVlcnkgIT09IHZvaWQgMCA/IF9ydWxlJHF1ZXJ5IDogJycsCiAgICAgICAgbGFuZ3VhZ2U6IChfcnVsZSRsYW5ndWFnZSA9IHJ1bGUubGFuZ3VhZ2UpICE9PSBudWxsICYmIF9ydWxlJGxhbmd1YWdlICE9PSB2b2lkIDAgPyBfcnVsZSRsYW5ndWFnZSA6ICcnCiAgICAgIH0sCiAgICAgIGZpbHRlcnM6IChfcnVsZSRmaWx0ZXJzID0gcnVsZS5maWx0ZXJzKSAhPT0gbnVsbCAmJiBfcnVsZSRmaWx0ZXJzICE9PSB2b2lkIDAgPyBfcnVsZSRmaWx0ZXJzIDogW10sCiAgICAgIHNhdmVkX2lkOiBydWxlLnNhdmVkX2lkCiAgICB9LAogICAgdGltZWxpbmU6IHsKICAgICAgaWQ6IChfcnVsZSR0aW1lbGluZV9pZCA9IHJ1bGUudGltZWxpbmVfaWQpICE9PSBudWxsICYmIF9ydWxlJHRpbWVsaW5lX2lkICE9PSB2b2lkIDAgPyBfcnVsZSR0aW1lbGluZV9pZCA6IG51bGwsCiAgICAgIHRpdGxlOiAoX3J1bGUkdGltZWxpbmVfdGl0bGUgPSBydWxlLnRpbWVsaW5lX3RpdGxlKSAhPT0gbnVsbCAmJiBfcnVsZSR0aW1lbGluZV90aXRsZSAhPT0gdm9pZCAwID8gX3J1bGUkdGltZWxpbmVfdGl0bGUgOiBudWxsCiAgICB9CiAgfTsKfTsKCmV4cG9ydHMuZ2V0RGVmaW5lU3RlcHNEYXRhID0gZ2V0RGVmaW5lU3RlcHNEYXRhOwoKdmFyIGdldFNjaGVkdWxlU3RlcHNEYXRhID0gZnVuY3Rpb24gZ2V0U2NoZWR1bGVTdGVwc0RhdGEocnVsZSkgewogIHZhciBpbnRlcnZhbCA9IHJ1bGUuaW50ZXJ2YWwsCiAgICAgIGZyb20gPSBydWxlLmZyb207CiAgdmFyIGZyb21IdW1hbml6ZWRWYWx1ZSA9IGdldEh1bWFuaXplZER1cmF0aW9uKGZyb20sIGludGVydmFsKTsKICByZXR1cm4gewogICAgaXNOZXc6IGZhbHNlLAogICAgaW50ZXJ2YWw6IGludGVydmFsLAogICAgZnJvbTogZnJvbUh1bWFuaXplZFZhbHVlCiAgfTsKfTsKCmV4cG9ydHMuZ2V0U2NoZWR1bGVTdGVwc0RhdGEgPSBnZXRTY2hlZHVsZVN0ZXBzRGF0YTsKCnZhciBnZXRIdW1hbml6ZWREdXJhdGlvbiA9IGZ1bmN0aW9uIGdldEh1bWFuaXplZER1cmF0aW9uKGZyb20sIGludGVydmFsKSB7CiAgdmFyIF9kYXRlTWF0aCRwYXJzZSwgX2RhdGVNYXRoJHBhcnNlMjsKCiAgdmFyIGZyb21WYWx1ZSA9IChfZGF0ZU1hdGgkcGFyc2UgPSBfZGF0ZW1hdGguZGVmYXVsdC5wYXJzZShmcm9tKSkgIT09IG51bGwgJiYgX2RhdGVNYXRoJHBhcnNlICE9PSB2b2lkIDAgPyBfZGF0ZU1hdGgkcGFyc2UgOiAoMCwgX21vbWVudC5kZWZhdWx0KSgpOwogIHZhciBpbnRlcnZhbFZhbHVlID0gKF9kYXRlTWF0aCRwYXJzZTIgPSBfZGF0ZW1hdGguZGVmYXVsdC5wYXJzZSgibm93LSIuY29uY2F0KGludGVydmFsKSkpICE9PSBudWxsICYmIF9kYXRlTWF0aCRwYXJzZTIgIT09IHZvaWQgMCA/IF9kYXRlTWF0aCRwYXJzZTIgOiAoMCwgX21vbWVudC5kZWZhdWx0KSgpOwoKICB2YXIgZnJvbUR1cmF0aW9uID0gX21vbWVudC5kZWZhdWx0LmR1cmF0aW9uKGludGVydmFsVmFsdWUuZGlmZihmcm9tVmFsdWUpKTsKCiAgdmFyIGZyb21IdW1hbml6ZSA9ICIiLmNvbmNhdChNYXRoLmZsb29yKGZyb21EdXJhdGlvbi5hc0hvdXJzKCkpLCAiaCIpOwoKICBpZiAoZnJvbUR1cmF0aW9uLmFzU2Vjb25kcygpIDwgNjApIHsKICAgIHJldHVybiAiIi5jb25jYXQoTWF0aC5mbG9vcihmcm9tRHVyYXRpb24uYXNTZWNvbmRzKCkpLCAicyIpOwogIH0gZWxzZSBpZiAoZnJvbUR1cmF0aW9uLmFzTWludXRlcygpIDwgNjApIHsKICAgIHJldHVybiAiIi5jb25jYXQoTWF0aC5mbG9vcihmcm9tRHVyYXRpb24uYXNNaW51dGVzKCkpLCAibSIpOwogIH0KCiAgcmV0dXJuIGZyb21IdW1hbml6ZTsKfTsKCmV4cG9ydHMuZ2V0SHVtYW5pemVkRHVyYXRpb24gPSBnZXRIdW1hbml6ZWREdXJhdGlvbjsKCnZhciBnZXRBYm91dFN0ZXBzRGF0YSA9IGZ1bmN0aW9uIGdldEFib3V0U3RlcHNEYXRhKHJ1bGUsIGRldGFpbHNWaWV3KSB7CiAgdmFyIF9kZXRlcm1pbmVEZXRhaWxzVmFsdSA9IGRldGVybWluZURldGFpbHNWYWx1ZShydWxlLCBkZXRhaWxzVmlldyksCiAgICAgIG5hbWUgPSBfZGV0ZXJtaW5lRGV0YWlsc1ZhbHUubmFtZSwKICAgICAgZGVzY3JpcHRpb24gPSBfZGV0ZXJtaW5lRGV0YWlsc1ZhbHUuZGVzY3JpcHRpb24sCiAgICAgIG5vdGUgPSBfZGV0ZXJtaW5lRGV0YWlsc1ZhbHUubm90ZTsKCiAgdmFyIHJlZmVyZW5jZXMgPSBydWxlLnJlZmVyZW5jZXMsCiAgICAgIHNldmVyaXR5ID0gcnVsZS5zZXZlcml0eSwKICAgICAgZmFsc2VQb3NpdGl2ZXMgPSBydWxlLmZhbHNlX3Bvc2l0aXZlcywKICAgICAgcmlza1Njb3JlID0gcnVsZS5yaXNrX3Njb3JlLAogICAgICB0YWdzID0gcnVsZS50YWdzLAogICAgICB0aHJlYXQgPSBydWxlLnRocmVhdDsKICByZXR1cm4gewogICAgaXNOZXc6IGZhbHNlLAogICAgbmFtZTogbmFtZSwKICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiwKICAgIG5vdGU6IG5vdGUsCiAgICByZWZlcmVuY2VzOiByZWZlcmVuY2VzLAogICAgc2V2ZXJpdHk6IHNldmVyaXR5LAogICAgdGFnczogdGFncywKICAgIHJpc2tTY29yZTogcmlza1Njb3JlLAogICAgZmFsc2VQb3NpdGl2ZXM6IGZhbHNlUG9zaXRpdmVzLAogICAgdGhyZWF0OiB0aHJlYXQKICB9Owp9OwoKZXhwb3J0cy5nZXRBYm91dFN0ZXBzRGF0YSA9IGdldEFib3V0U3RlcHNEYXRhOwoKdmFyIGRldGVybWluZURldGFpbHNWYWx1ZSA9IGZ1bmN0aW9uIGRldGVybWluZURldGFpbHNWYWx1ZShydWxlLCBkZXRhaWxzVmlldykgewogIHZhciBuYW1lID0gcnVsZS5uYW1lLAogICAgICBkZXNjcmlwdGlvbiA9IHJ1bGUuZGVzY3JpcHRpb24sCiAgICAgIG5vdGUgPSBydWxlLm5vdGU7CgogIGlmIChkZXRhaWxzVmlldykgewogICAgcmV0dXJuIHsKICAgICAgbmFtZTogJycsCiAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgbm90ZTogJycKICAgIH07CiAgfQoKICByZXR1cm4gewogICAgbmFtZTogbmFtZSwKICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiwKICAgIG5vdGU6IG5vdGUgIT09IG51bGwgJiYgbm90ZSAhPT0gdm9pZCAwID8gbm90ZSA6ICcnCiAgfTsKfTsKCmV4cG9ydHMuZGV0ZXJtaW5lRGV0YWlsc1ZhbHVlID0gZGV0ZXJtaW5lRGV0YWlsc1ZhbHVlOwoKdmFyIGdldE1vZGlmaWVkQWJvdXREZXRhaWxzRGF0YSA9IGZ1bmN0aW9uIGdldE1vZGlmaWVkQWJvdXREZXRhaWxzRGF0YShydWxlKSB7CiAgdmFyIF9ydWxlJG5vdGU7CgogIHJldHVybiB7CiAgICBub3RlOiAoX3J1bGUkbm90ZSA9IHJ1bGUubm90ZSkgIT09IG51bGwgJiYgX3J1bGUkbm90ZSAhPT0gdm9pZCAwID8gX3J1bGUkbm90ZSA6ICcnLAogICAgZGVzY3JpcHRpb246IHJ1bGUuZGVzY3JpcHRpb24KICB9Owp9OwoKZXhwb3J0cy5nZXRNb2RpZmllZEFib3V0RGV0YWlsc0RhdGEgPSBnZXRNb2RpZmllZEFib3V0RGV0YWlsc0RhdGE7Cgp2YXIgdXNlUXVlcnkgPSBmdW5jdGlvbiB1c2VRdWVyeSgpIHsKICByZXR1cm4gbmV3IFVSTFNlYXJjaFBhcmFtcygoMCwgX3JlYWN0Um91dGVyRG9tLnVzZUxvY2F0aW9uKSgpLnNlYXJjaCk7Cn07CgpleHBvcnRzLnVzZVF1ZXJ5ID0gdXNlUXVlcnk7Cgp2YXIgZ2V0UHJlUGFja2FnZWRSdWxlU3RhdHVzID0gZnVuY3Rpb24gZ2V0UHJlUGFja2FnZWRSdWxlU3RhdHVzKHJ1bGVzSW5zdGFsbGVkLCBydWxlc05vdEluc3RhbGxlZCwgcnVsZXNOb3RVcGRhdGVkKSB7CiAgaWYgKHJ1bGVzTm90SW5zdGFsbGVkICE9IG51bGwgJiYgcnVsZXNJbnN0YWxsZWQgPT09IDAgJiYgcnVsZXNOb3RJbnN0YWxsZWQgPiAwICYmIHJ1bGVzTm90VXBkYXRlZCA9PT0gMCkgewogICAgcmV0dXJuICdydWxlTm90SW5zdGFsbGVkJzsKICB9IGVsc2UgaWYgKHJ1bGVzSW5zdGFsbGVkICE9IG51bGwgJiYgcnVsZXNJbnN0YWxsZWQgPiAwICYmIHJ1bGVzTm90SW5zdGFsbGVkID09PSAwICYmIHJ1bGVzTm90VXBkYXRlZCA9PT0gMCkgewogICAgcmV0dXJuICdydWxlSW5zdGFsbGVkJzsKICB9IGVsc2UgaWYgKHJ1bGVzSW5zdGFsbGVkICE9IG51bGwgJiYgcnVsZXNOb3RJbnN0YWxsZWQgIT0gbnVsbCAmJiBydWxlc0luc3RhbGxlZCA+IDAgJiYgcnVsZXNOb3RJbnN0YWxsZWQgPiAwICYmIHJ1bGVzTm90VXBkYXRlZCA9PT0gMCkgewogICAgcmV0dXJuICdzb21lUnVsZVVuaW5zdGFsbCc7CiAgfSBlbHNlIGlmIChydWxlc0luc3RhbGxlZCAhPSBudWxsICYmIHJ1bGVzTm90SW5zdGFsbGVkICE9IG51bGwgJiYgcnVsZXNOb3RVcGRhdGVkICE9IG51bGwgJiYgcnVsZXNJbnN0YWxsZWQgPiAwICYmIHJ1bGVzTm90SW5zdGFsbGVkID49IDAgJiYgcnVsZXNOb3RVcGRhdGVkID4gMCkgewogICAgcmV0dXJuICdydWxlTmVlZFVwZGF0ZSc7CiAgfQoKICByZXR1cm4gJ3Vua25vd24nOwp9OwoKZXhwb3J0cy5nZXRQcmVQYWNrYWdlZFJ1bGVTdGF0dXMgPSBnZXRQcmVQYWNrYWdlZFJ1bGVTdGF0dXM7Cgp2YXIgc2V0RmllbGRWYWx1ZSA9IGZ1bmN0aW9uIHNldEZpZWxkVmFsdWUoZm9ybSwgc2NoZW1hLCBkZWZhdWx0VmFsdWVzKSB7CiAgcmV0dXJuIE9iamVjdC5rZXlzKHNjaGVtYSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICB2YXIgdmFsID0gKDAsIF9mcC5nZXQpKGtleSwgZGVmYXVsdFZhbHVlcyk7CgogICAgaWYgKHZhbCAhPSBudWxsKSB7CiAgICAgIGZvcm0uc2V0RmllbGRWYWx1ZShrZXksIHZhbCk7CiAgICB9CiAgfSk7Cn07CgpleHBvcnRzLnNldEZpZWxkVmFsdWUgPSBzZXRGaWVsZFZhbHVlOwoKdmFyIHJlZGlyZWN0VG9EZXRlY3Rpb25zID0gZnVuY3Rpb24gcmVkaXJlY3RUb0RldGVjdGlvbnMoaXNTaWduYWxJbmRleEV4aXN0cywgaXNBdXRoZW50aWNhdGVkLCBoYXNFbmNyeXB0aW9uS2V5KSB7CiAgcmV0dXJuIGlzU2lnbmFsSW5kZXhFeGlzdHMgIT0gbnVsbCAmJiBpc0F1dGhlbnRpY2F0ZWQgIT0gbnVsbCAmJiBoYXNFbmNyeXB0aW9uS2V5ICE9IG51bGwgJiYgKCFpc1NpZ25hbEluZGV4RXhpc3RzIHx8ICFpc0F1dGhlbnRpY2F0ZWQgfHwgIWhhc0VuY3J5cHRpb25LZXkpOwp9OwoKZXhwb3J0cy5yZWRpcmVjdFRvRGV0ZWN0aW9ucyA9IHJlZGlyZWN0VG9EZXRlY3Rpb25zOwoKdmFyIGdldEFjdGlvbk1lc3NhZ2VSdWxlUGFyYW1zID0gZnVuY3Rpb24gZ2V0QWN0aW9uTWVzc2FnZVJ1bGVQYXJhbXMocnVsZVR5cGUpIHsKICB2YXIgY29tbW9uUnVsZVBhcmFtc0tleXMgPSBbJ2lkJywgJ25hbWUnLCAnZGVzY3JpcHRpb24nLCAnZmFsc2VfcG9zaXRpdmVzJywgJ3J1bGVfaWQnLCAnbWF4X3NpZ25hbHMnLCAncmlza19zY29yZScsICdvdXRwdXRfaW5kZXgnLCAncmVmZXJlbmNlcycsICdzZXZlcml0eScsICd0aW1lbGluZV9pZCcsICd0aW1lbGluZV90aXRsZScsICd0aHJlYXQnLCAndHlwZScsICd2ZXJzaW9uJ107CiAgdmFyIHJ1bGVQYXJhbXNLZXlzID0gW10uY29uY2F0KGNvbW1vblJ1bGVQYXJhbXNLZXlzLCBfdG9Db25zdW1hYmxlQXJyYXkoKDAsIF9tbF9oZWxwZXJzLmlzTWxSdWxlKShydWxlVHlwZSkgPyBbJ2Fub21hbHlfdGhyZXNob2xkJywgJ21hY2hpbmVfbGVhcm5pbmdfam9iX2lkJ10gOiBbJ2luZGV4JywgJ2ZpbHRlcnMnLCAnbGFuZ3VhZ2UnLCAncXVlcnknLCAnc2F2ZWRfaWQnXSkpLnNvcnQoKTsKICByZXR1cm4gcnVsZVBhcmFtc0tleXM7Cn07CgpleHBvcnRzLmdldEFjdGlvbk1lc3NhZ2VSdWxlUGFyYW1zID0gZ2V0QWN0aW9uTWVzc2FnZVJ1bGVQYXJhbXM7CnZhciBnZXRBY3Rpb25NZXNzYWdlUGFyYW1zID0gKDAsIF9tZW1vaXplT25lLmRlZmF1bHQpKGZ1bmN0aW9uIChydWxlVHlwZSkgewogIGlmICghcnVsZVR5cGUpIHsKICAgIHJldHVybiBbXTsKICB9CgogIHZhciBhY3Rpb25NZXNzYWdlUnVsZVBhcmFtcyA9IGdldEFjdGlvbk1lc3NhZ2VSdWxlUGFyYW1zKHJ1bGVUeXBlKTsKICByZXR1cm4gWydzdGF0ZS5zaWduYWxzX2NvdW50JywgJ3tjb250ZXh0LnJlc3VsdHNfbGlua30nXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGFjdGlvbk1lc3NhZ2VSdWxlUGFyYW1zLm1hcChmdW5jdGlvbiAocGFyYW0pIHsKICAgIHJldHVybiAiY29udGV4dC5ydWxlLiIuY29uY2F0KHBhcmFtKTsKICB9KSkpOwp9KTsgLy8gdHlwZWQgYXMgbnVsbCBub3QgdW5kZWZpbmVkIGFzIHRoZSBpbml0aWFsIHN0YXRlIGZvciB0aGlzIHZhbHVlIGlzIG51bGwuCgpleHBvcnRzLmdldEFjdGlvbk1lc3NhZ2VQYXJhbXMgPSBnZXRBY3Rpb25NZXNzYWdlUGFyYW1zOwoKdmFyIHVzZXJIYXNOb1Blcm1pc3Npb25zID0gZnVuY3Rpb24gdXNlckhhc05vUGVybWlzc2lvbnMoY2FuVXNlckNSVUQpIHsKICByZXR1cm4gY2FuVXNlckNSVUQgIT0gbnVsbCA/ICFjYW5Vc2VyQ1JVRCA6IGZhbHNlOwp9OwoKZXhwb3J0cy51c2VySGFzTm9QZXJtaXNzaW9ucyA9IHVzZXJIYXNOb1Blcm1pc3Npb25zOw=="},null]}