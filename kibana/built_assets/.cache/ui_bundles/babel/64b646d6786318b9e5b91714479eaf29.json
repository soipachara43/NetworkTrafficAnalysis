{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/plugins/data/public/search/aggs/buckets/date_histogram.js","dependencies":[{"path":"src/plugins/data/public/search/aggs/buckets/date_histogram.js","mtime":1589249550635},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmlzRGF0ZUhpc3RvZ3JhbUJ1Y2tldEFnZ0NvbmZpZyA9IGlzRGF0ZUhpc3RvZ3JhbUJ1Y2tldEFnZ0NvbmZpZzsKZXhwb3J0cy5kYXRlSGlzdG9ncmFtQnVja2V0QWdnID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfbW9tZW50VGltZXpvbmUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudC10aW1lem9uZSIpKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF90aW1lX2J1Y2tldHMgPSByZXF1aXJlKCIuL2xpYi90aW1lX2J1Y2tldHMiKTsKCnZhciBfYnVja2V0X2FnZ190eXBlID0gcmVxdWlyZSgiLi9fYnVja2V0X2FnZ190eXBlIik7Cgp2YXIgX2J1Y2tldF9hZ2dfdHlwZXMgPSByZXF1aXJlKCIuL2J1Y2tldF9hZ2dfdHlwZXMiKTsKCnZhciBfZGF0ZV9oaXN0b2dyYW0gPSByZXF1aXJlKCIuL2NyZWF0ZV9maWx0ZXIvZGF0ZV9oaXN0b2dyYW0iKTsKCnZhciBfaW50ZXJ2YWxfb3B0aW9ucyA9IHJlcXVpcmUoIi4vX2ludGVydmFsX29wdGlvbnMiKTsKCnZhciBfY29tbW9uID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tbW9uIik7Cgp2YXIgX2FnZ19wYXJhbXMgPSByZXF1aXJlKCIuLi9hZ2dfcGFyYW1zIik7Cgp2YXIgX21ldHJpY19hZ2dfdHlwZSA9IHJlcXVpcmUoIi4uL21ldHJpY3MvbWV0cmljX2FnZ190eXBlIik7Cgp2YXIgX3NlcnZpY2VzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vcHVibGljL3NlcnZpY2VzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKdmFyIGRldGVjdGVkVGltZXpvbmUgPSBfbW9tZW50VGltZXpvbmUuZGVmYXVsdC50ei5ndWVzcygpOwoKdmFyIHR6T2Zmc2V0ID0gKDAsIF9tb21lbnRUaW1lem9uZS5kZWZhdWx0KSgpLmZvcm1hdCgnWicpOwoKdmFyIHVwZGF0ZVRpbWVCdWNrZXRzID0gZnVuY3Rpb24gdXBkYXRlVGltZUJ1Y2tldHMoYWdnLCB0aW1lZmlsdGVyLCBjdXN0b21CdWNrZXRzKSB7CiAgdmFyIGJvdW5kcyA9IGFnZy5wYXJhbXMudGltZVJhbmdlID8gdGltZWZpbHRlci5jYWxjdWxhdGVCb3VuZHMoYWdnLnBhcmFtcy50aW1lUmFuZ2UpIDogbnVsbDsKICB2YXIgYnVja2V0cyA9IGN1c3RvbUJ1Y2tldHMgfHwgYWdnLmJ1Y2tldHM7CiAgYnVja2V0cy5zZXRCb3VuZHMoYWdnLmZpZWxkSXNUaW1lRmllbGQoKSAmJiBib3VuZHMpOwogIGJ1Y2tldHMuc2V0SW50ZXJ2YWwoYWdnLnBhcmFtcy5pbnRlcnZhbCk7Cn07IC8vIFRPRE86IE5lZWQgdG8gaW5jb3Jwb3JhdGUgdGhlc2UgcHJvcGVybHkgaW50byBUaW1lQnVja2V0cwoKCmZ1bmN0aW9uIGlzRGF0ZUhpc3RvZ3JhbUJ1Y2tldEFnZ0NvbmZpZyhhZ2cpIHsKICByZXR1cm4gQm9vbGVhbihhZ2cuYnVja2V0cyk7Cn0KCnZhciBkYXRlSGlzdG9ncmFtQnVja2V0QWdnID0gbmV3IF9idWNrZXRfYWdnX3R5cGUuQnVja2V0QWdnVHlwZSh7CiAgbmFtZTogX2J1Y2tldF9hZ2dfdHlwZXMuQlVDS0VUX1RZUEVTLkRBVEVfSElTVE9HUkFNLAogIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgnZGF0YS5zZWFyY2guYWdncy5idWNrZXRzLmRhdGVIaXN0b2dyYW1UaXRsZScsIHsKICAgIGRlZmF1bHRNZXNzYWdlOiAnRGF0ZSBIaXN0b2dyYW0nCiAgfSksCiAgb3JkZXJlZDogewogICAgZGF0ZTogdHJ1ZQogIH0sCiAgbWFrZUxhYmVsOiBmdW5jdGlvbiBtYWtlTGFiZWwoYWdnKSB7CiAgICB2YXIgb3V0cHV0ID0ge307CgogICAgaWYgKHRoaXMucGFyYW1zKSB7CiAgICAgIG91dHB1dCA9ICgwLCBfYWdnX3BhcmFtcy53cml0ZVBhcmFtcykodGhpcy5wYXJhbXMsIGFnZyk7CiAgICB9CgogICAgdmFyIGZpZWxkID0gYWdnLmdldEZpZWxkRGlzcGxheU5hbWUoKTsKICAgIHJldHVybiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgnZGF0YS5zZWFyY2guYWdncy5idWNrZXRzLmRhdGVIaXN0b2dyYW1MYWJlbCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd7ZmllbGROYW1lfSBwZXIge2ludGVydmFsRGVzY3JpcHRpb259JywKICAgICAgdmFsdWVzOiB7CiAgICAgICAgZmllbGROYW1lOiBmaWVsZCwKICAgICAgICBpbnRlcnZhbERlc2NyaXB0aW9uOiBvdXRwdXQubWV0cmljU2NhbGVUZXh0IHx8IG91dHB1dC5idWNrZXRJbnRlcnZhbC5kZXNjcmlwdGlvbgogICAgICB9CiAgICB9KTsKICB9LAogIGNyZWF0ZUZpbHRlcjogX2RhdGVfaGlzdG9ncmFtLmNyZWF0ZUZpbHRlckRhdGVIaXN0b2dyYW0sCiAgZGVjb3JhdGVBZ2dDb25maWc6IGZ1bmN0aW9uIGRlY29yYXRlQWdnQ29uZmlnKCkgewogICAgdmFyIHVpU2V0dGluZ3MgPSAoMCwgX3NlcnZpY2VzLmdldFVpU2V0dGluZ3MpKCk7CiAgICB2YXIgYnVja2V0czsKICAgIHJldHVybiB7CiAgICAgIGJ1Y2tldHM6IHsKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgICBpZiAoYnVja2V0cykgcmV0dXJuIGJ1Y2tldHM7CiAgICAgICAgICB2YXIgdGltZWZpbHRlciA9ICgwLCBfc2VydmljZXMuZ2V0UXVlcnlTZXJ2aWNlKSgpLnRpbWVmaWx0ZXIudGltZWZpbHRlcjsKICAgICAgICAgIGJ1Y2tldHMgPSBuZXcgX3RpbWVfYnVja2V0cy5UaW1lQnVja2V0cyh7CiAgICAgICAgICAgIHVpU2V0dGluZ3M6IHVpU2V0dGluZ3MKICAgICAgICAgIH0pOwogICAgICAgICAgdXBkYXRlVGltZUJ1Y2tldHModGhpcywgdGltZWZpbHRlciwgYnVja2V0cyk7CiAgICAgICAgICByZXR1cm4gYnVja2V0czsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfSwKICBnZXRGb3JtYXQ6IGZ1bmN0aW9uIGdldEZvcm1hdChhZ2cpIHsKICAgIHZhciBEYXRlRmllbGRGb3JtYXQgPSAoMCwgX3NlcnZpY2VzLmdldEZpZWxkRm9ybWF0cykoKS5nZXRUeXBlKF9jb21tb24uRklFTERfRk9STUFUX0lEUy5EQVRFKTsKCiAgICBpZiAoIURhdGVGaWVsZEZvcm1hdCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byByZXRyaWV2ZSBEYXRlIEZpZWxkIEZvcm1hdCcpOwogICAgfQoKICAgIHJldHVybiBuZXcgRGF0ZUZpZWxkRm9ybWF0KHsKICAgICAgcGF0dGVybjogYWdnLmJ1Y2tldHMuZ2V0U2NhbGVkRGF0ZUZvcm1hdCgpCiAgICB9LCBmdW5jdGlvbiAoa2V5KSB7CiAgICAgIHJldHVybiAoMCwgX3NlcnZpY2VzLmdldFVpU2V0dGluZ3MpKCkuZ2V0KGtleSk7CiAgICB9KTsKICB9LAogIHBhcmFtczogW3sKICAgIG5hbWU6ICdmaWVsZCcsCiAgICB0eXBlOiAnZmllbGQnLAogICAgZmlsdGVyRmllbGRUeXBlczogX2NvbW1vbi5LQk5fRklFTERfVFlQRVMuREFURSwKICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KGFnZykgewogICAgICByZXR1cm4gYWdnLmdldEluZGV4UGF0dGVybigpLnRpbWVGaWVsZE5hbWU7CiAgICB9LAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGFnZykgewogICAgICBpZiAoX2xvZGFzaC5kZWZhdWx0LmdldChhZ2csICdwYXJhbXMuaW50ZXJ2YWwnKSA9PT0gJ2F1dG8nICYmICFhZ2cuZmllbGRJc1RpbWVGaWVsZCgpKSB7CiAgICAgICAgZGVsZXRlIGFnZy5wYXJhbXMuaW50ZXJ2YWw7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBuYW1lOiAndGltZVJhbmdlJywKICAgIGRlZmF1bHQ6IG51bGwsCiAgICB3cml0ZTogX2xvZGFzaC5kZWZhdWx0Lm5vb3AKICB9LCB7CiAgICBuYW1lOiAndXNlTm9ybWFsaXplZEVzSW50ZXJ2YWwnLAogICAgZGVmYXVsdDogdHJ1ZSwKICAgIHdyaXRlOiBfbG9kYXNoLmRlZmF1bHQubm9vcAogIH0sIHsKICAgIG5hbWU6ICdzY2FsZU1ldHJpY1ZhbHVlcycsCiAgICBkZWZhdWx0OiBmYWxzZSwKICAgIHdyaXRlOiBfbG9kYXNoLmRlZmF1bHQubm9vcCwKICAgIGFkdmFuY2VkOiB0cnVlCiAgfSwgewogICAgbmFtZTogJ2ludGVydmFsJywKICAgIGRlc2VyaWFsaXplOiBmdW5jdGlvbiBkZXNlcmlhbGl6ZShzdGF0ZSwgYWdnKSB7CiAgICAgIC8vIEZvciB1cGdyYWRpbmcgZnJvbSA3LjAueCB0byA3LjEueCAtIGludGVydmFscyBhcmUgbm93IHN0b3JlZCBhcyBrZXkgb2Ygb3B0aW9ucyBvciBjdXN0b20gdmFsdWUKICAgICAgaWYgKHN0YXRlID09PSAnY3VzdG9tJykgewogICAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuZ2V0KGFnZywgJ3BhcmFtcy5jdXN0b21JbnRlcnZhbCcpOwogICAgICB9CgogICAgICB2YXIgaW50ZXJ2YWwgPSBfbG9kYXNoLmRlZmF1bHQuZmluZChfaW50ZXJ2YWxfb3B0aW9ucy5pbnRlcnZhbE9wdGlvbnMsIHsKICAgICAgICB2YWw6IHN0YXRlCiAgICAgIH0pOyAvLyBGb3IgdXBncmFkaW5nIGZyb20gNC4wLnggdG8gNC4xLnggLSBpbnRlcnZhbHMgYXJlIG5vdyBzdG9yZWQgYXMgJ3knIGluc3RlYWQgb2YgJ3llYXInLAogICAgICAvLyBidXQgdGhpcyBtYXBzIHRoZSBvbGQgdmFsdWVzIHRvIHRoZSBuZXcgdmFsdWVzCgoKICAgICAgaWYgKCFpbnRlcnZhbCAmJiBzdGF0ZSA9PT0gJ3llYXInKSB7CiAgICAgICAgcmV0dXJuICd5JzsKICAgICAgfQoKICAgICAgcmV0dXJuIHN0YXRlOwogICAgfSwKICAgIGRlZmF1bHQ6ICdhdXRvJywKICAgIG9wdGlvbnM6IF9pbnRlcnZhbF9vcHRpb25zLmludGVydmFsT3B0aW9ucywKICAgIHdyaXRlOiBmdW5jdGlvbiB3cml0ZShhZ2csIG91dHB1dCwgYWdncykgewogICAgICB2YXIgdGltZWZpbHRlciA9ICgwLCBfc2VydmljZXMuZ2V0UXVlcnlTZXJ2aWNlKSgpLnRpbWVmaWx0ZXIudGltZWZpbHRlcjsKICAgICAgdXBkYXRlVGltZUJ1Y2tldHMoYWdnLCB0aW1lZmlsdGVyKTsKICAgICAgdmFyIF9hZ2ckcGFyYW1zID0gYWdnLnBhcmFtcywKICAgICAgICAgIHVzZU5vcm1hbGl6ZWRFc0ludGVydmFsID0gX2FnZyRwYXJhbXMudXNlTm9ybWFsaXplZEVzSW50ZXJ2YWwsCiAgICAgICAgICBzY2FsZU1ldHJpY1ZhbHVlcyA9IF9hZ2ckcGFyYW1zLnNjYWxlTWV0cmljVmFsdWVzOwogICAgICB2YXIgaW50ZXJ2YWwgPSBhZ2cuYnVja2V0cy5nZXRJbnRlcnZhbCh1c2VOb3JtYWxpemVkRXNJbnRlcnZhbCk7CiAgICAgIG91dHB1dC5idWNrZXRJbnRlcnZhbCA9IGludGVydmFsOwoKICAgICAgaWYgKGludGVydmFsLmV4cHJlc3Npb24gPT09ICcwbXMnKSB7CiAgICAgICAgLy8gV2UgYXJlIGhpdHRpbmcgdGhpcyBjb2RlIGEgY291cGxlIG9mIHRpbWVzIHdoaWxlIGNvbmZpZ3VyaW5nIGluIGVkaXRvcgogICAgICAgIC8vIHdpdGggYW4gaW50ZXJ2YWwgb2YgMG1zIGJlY2F1c2UgdGhlIG92ZXJhbGwgdGltZSByYW5nZSBoYXMgbm90IHlldCBiZWVuCiAgICAgICAgLy8gc2V0LiBTaW5jZSAwbXMgaXMgbm90IGEgdmFsaWQgRVMgaW50ZXJ2YWwsIHdlIGNhbm5vdCBwYXNzIGl0IHRocm91Z2ggZGF0ZUhpc3RvZ3JhbUludGVydmFsCiAgICAgICAgLy8gYmVsb3csIHNpbmNlIGl0IHdvdWxkIHRocm93IGFuIGV4Y2VwdGlvbi4gU28gaW4gdGhlIGNhc2VzIHdlIHN0aWxsIGhhdmUgYW4gaW50ZXJ2YWwgb2YgMG1zCiAgICAgICAgLy8gaGVyZSB3ZSBzaW1wbHkgc2tpcCB0aGUgcmVzdCBvZiB0aGUgbWV0aG9kIGFuZCBuZXZlciB3cml0ZSBhbiBpbnRlcnZhbCBpbnRvIHRoZSBEU0wsIHNpbmNlCiAgICAgICAgLy8gdGhpcyBEU0wgd2lsbCBhbnl3YXkgbm90IGJlIHVzZWQgYmVmb3JlIHdlJ3JlIHBhc3NpbmcgdGhpcyBjb2RlIHdpdGggYW4gYWN0dWFsIGludGVydmFsLgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgb3V0cHV0LnBhcmFtcyA9IF9vYmplY3RTcHJlYWQoe30sIG91dHB1dC5wYXJhbXMsIHt9LCAoMCwgX2NvbW1vbi5kYXRlSGlzdG9ncmFtSW50ZXJ2YWwpKGludGVydmFsLmV4cHJlc3Npb24pKTsKICAgICAgdmFyIHNjYWxlTWV0cmljcyA9IHNjYWxlTWV0cmljVmFsdWVzICYmIGludGVydmFsLnNjYWxlZCAmJiBpbnRlcnZhbC5zY2FsZSA8IDE7CgogICAgICBpZiAoc2NhbGVNZXRyaWNzICYmIGFnZ3MpIHsKICAgICAgICB2YXIgbWV0cmljcyA9IGFnZ3MuYWdncy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsKICAgICAgICAgIHJldHVybiAoMCwgX21ldHJpY19hZ2dfdHlwZS5pc01ldHJpY0FnZ1R5cGUpKGEudHlwZSk7CiAgICAgICAgfSk7CgogICAgICAgIHZhciBhbGwgPSBfbG9kYXNoLmRlZmF1bHQuZXZlcnkobWV0cmljcywgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgIHZhciB0eXBlID0gYS50eXBlOwoKICAgICAgICAgIGlmICgoMCwgX21ldHJpY19hZ2dfdHlwZS5pc01ldHJpY0FnZ1R5cGUpKHR5cGUpKSB7CiAgICAgICAgICAgIHJldHVybiB0eXBlLmlzU2NhbGFibGUoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgaWYgKGFsbCkgewogICAgICAgICAgb3V0cHV0Lm1ldHJpY1NjYWxlID0gaW50ZXJ2YWwuc2NhbGU7CiAgICAgICAgICBvdXRwdXQubWV0cmljU2NhbGVUZXh0ID0gaW50ZXJ2YWwucHJlU2NhbGVkLmRlc2NyaXB0aW9uOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIG5hbWU6ICd0aW1lX3pvbmUnLAogICAgZGVmYXVsdDogdW5kZWZpbmVkLAogICAgLy8gV2UgZG9uJ3QgZXZlciB3YW50IHRoaXMgcGFyYW1ldGVyIHRvIGJlIHNlcmlhbGl6ZWQgb3V0ICh3aGVuIHNhdmluZyBvciB0byBVUkxzKQogICAgLy8gc2luY2Ugd2UgZG8gYWxsIHRoZSBsb2dpYyBoYW5kbGluZyBpdCAib24gdGhlIGZseSIgaW4gdGhlIGB3cml0ZWAgbWV0aG9kLCB0byBwcmV2ZW50CiAgICAvLyB0aW1lX3pvbmVzIGJlaW5nIHBlcnNpc3RlZCBpbnRvIHNhdmVkX29iamVjdHMKICAgIHNlcmlhbGl6ZTogX2xvZGFzaC5kZWZhdWx0Lm5vb3AsCiAgICB3cml0ZTogZnVuY3Rpb24gd3JpdGUoYWdnLCBvdXRwdXQpIHsKICAgICAgLy8gSWYgYSB0aW1lX3pvbmUgaGFzIGJlZW4gc2V0IGV4cGxpY2l0bHkgYWx3YXlzIHByZWZlciB0aGlzLgogICAgICB2YXIgdHogPSBhZ2cucGFyYW1zLnRpbWVfem9uZTsKCiAgICAgIGlmICghdHogJiYgYWdnLnBhcmFtcy5maWVsZCkgewogICAgICAgIC8vIElmIGEgZmllbGQgaGFzIGJlZW4gY29uZmlndXJlZCBjaGVjayB0aGUgaW5kZXggcGF0dGVybidzIHR5cGVNZXRhIGlmIGEgZGF0ZV9oaXN0b2dyYW0gb24gdGhhdAogICAgICAgIC8vIGZpZWxkIHJlcXVpcmVzIGEgc3BlY2lmaWMgdGltZV96b25lCiAgICAgICAgdHogPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KGFnZy5nZXRJbmRleFBhdHRlcm4oKSwgWyd0eXBlTWV0YScsICdhZ2dzJywgJ2RhdGVfaGlzdG9ncmFtJywgYWdnLnBhcmFtcy5maWVsZC5uYW1lLCAndGltZV96b25lJ10pOwogICAgICB9CgogICAgICBpZiAoIXR6KSB7CiAgICAgICAgdmFyIGNvbmZpZyA9ICgwLCBfc2VydmljZXMuZ2V0VWlTZXR0aW5ncykoKTsgLy8gSWYgdGhlIGluZGV4IHBhdHRlcm4gdHlwZU1ldGEgZGF0YSwgZGlkbid0IGhhZCBhIHRpbWUgem9uZSBhc3NpZ25lZCBmb3IgdGhlIHNlbGVjdGVkIGZpZWxkIHVzZSB0aGUgY29uZmlndXJlZCB0egoKICAgICAgICB2YXIgaXNEZWZhdWx0VGltZXpvbmUgPSBjb25maWcuaXNEZWZhdWx0KCdkYXRlRm9ybWF0OnR6Jyk7CiAgICAgICAgdHogPSBpc0RlZmF1bHRUaW1lem9uZSA/IGRldGVjdGVkVGltZXpvbmUgfHwgdHpPZmZzZXQgOiBjb25maWcuZ2V0KCdkYXRlRm9ybWF0OnR6Jyk7CiAgICAgIH0KCiAgICAgIG91dHB1dC5wYXJhbXMudGltZV96b25lID0gdHo7CiAgICB9CiAgfSwgewogICAgbmFtZTogJ2Ryb3BfcGFydGlhbHMnLAogICAgZGVmYXVsdDogZmFsc2UsCiAgICB3cml0ZTogX2xvZGFzaC5kZWZhdWx0Lm5vb3AsCiAgICBzaG91bGRTaG93OiBmdW5jdGlvbiBzaG91bGRTaG93KGFnZykgewogICAgICB2YXIgZmllbGQgPSBhZ2cucGFyYW1zLmZpZWxkOwogICAgICByZXR1cm4gZmllbGQgJiYgZmllbGQubmFtZSAmJiBmaWVsZC5uYW1lID09PSBhZ2cuZ2V0SW5kZXhQYXR0ZXJuKCkudGltZUZpZWxkTmFtZTsKICAgIH0KICB9LCB7CiAgICBuYW1lOiAnZm9ybWF0JwogIH0sIHsKICAgIG5hbWU6ICdtaW5fZG9jX2NvdW50JywKICAgIGRlZmF1bHQ6IDEKICB9LCB7CiAgICBuYW1lOiAnZXh0ZW5kZWRfYm91bmRzJywKICAgIGRlZmF1bHQ6IHt9LAogICAgd3JpdGU6IGZ1bmN0aW9uIHdyaXRlKGFnZywgb3V0cHV0KSB7CiAgICAgIHZhciB2YWwgPSBhZ2cucGFyYW1zLmV4dGVuZGVkX2JvdW5kczsKCiAgICAgIGlmICh2YWwubWluICE9IG51bGwgfHwgdmFsLm1heCAhPSBudWxsKSB7CiAgICAgICAgb3V0cHV0LnBhcmFtcy5leHRlbmRlZF9ib3VuZHMgPSB7CiAgICAgICAgICBtaW46ICgwLCBfbW9tZW50VGltZXpvbmUuZGVmYXVsdCkodmFsLm1pbikudmFsdWVPZigpLAogICAgICAgICAgbWF4OiAoMCwgX21vbWVudFRpbWV6b25lLmRlZmF1bHQpKHZhbC5tYXgpLnZhbHVlT2YoKQogICAgICAgIH07CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgfV0KfSk7CmV4cG9ydHMuZGF0ZUhpc3RvZ3JhbUJ1Y2tldEFnZyA9IGRhdGVIaXN0b2dyYW1CdWNrZXRBZ2c7"},null]}