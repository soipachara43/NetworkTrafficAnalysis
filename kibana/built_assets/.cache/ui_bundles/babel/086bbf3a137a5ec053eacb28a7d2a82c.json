{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/components/signals/helpers.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/components/signals/helpers.js","mtime":1589249553288},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLnJlcGxhY2VUZW1wbGF0ZUZpZWxkRnJvbURhdGFQcm92aWRlcnMgPSBleHBvcnRzLnJlZm9ybWF0RGF0YVByb3ZpZGVyV2l0aE5ld1ZhbHVlID0gZXhwb3J0cy5yZXBsYWNlVGVtcGxhdGVGaWVsZEZyb21NYXRjaEZpbHRlcnMgPSBleHBvcnRzLnJlcGxhY2VUZW1wbGF0ZUZpZWxkRnJvbVF1ZXJ5ID0gZXhwb3J0cy5maW5kVmFsdWVUb0NoYW5nZUluUXVlcnkgPSBleHBvcnRzLmdldFN0cmluZ0FycmF5ID0gdm9pZCAwOwoKdmFyIF9mcCA9IHJlcXVpcmUoImxvZGFzaC9mcCIpOwoKdmFyIF9wdWJsaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9kYXRhL3B1YmxpYyIpOwoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOwp9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UiKTsKfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZXIpID09PSAiW29iamVjdCBBcmd1bWVudHNdIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7Cn0KCmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KfQovKioKICogRmllbGRzIHRoYXQgd2lsbCBiZSByZXBsYWNlZCB3aXRoIHRoZSB0ZW1wbGF0ZSBzdHJpbmdzIGZyb20gYSBhIHNhdmVkIHRpbWVsaW5lIHRlbXBsYXRlLgogKiBUaGlzIGlzIHVzZWQgZm9yIHRoZSBzaWduYWxzIGRldGVjdGlvbiBlbmdpbmUgZmVhdHVyZSB3aGVuIHlvdSBzYXZlIGEgdGltZWxpbmUgdGVtcGxhdGUKICogYW5kIGFyZSB0aGUgZmllbGRzIHlvdSBjYW4gcmVwbGFjZSB3aGVuIGNyZWF0aW5nIGEgdGVtcGxhdGUuCiAqLwoKCnZhciB0ZW1wbGF0ZUZpZWxkcyA9IFsnaG9zdC5uYW1lJywgJ2hvc3QuaG9zdG5hbWUnLCAnaG9zdC5kb21haW4nLCAnaG9zdC5pZCcsICdob3N0LmlwJywgJ2NsaWVudC5pcCcsICdkZXN0aW5hdGlvbi5pcCcsICdzZXJ2ZXIuaXAnLCAnc291cmNlLmlwJywgJ25ldHdvcmsuY29tbXVuaXR5X2lkJywgJ3VzZXIubmFtZScsICdwcm9jZXNzLm5hbWUnXTsKLyoqCiAqIFRoaXMgd2lsbCByZXR1cm4gYW4gdW5rbm93biBhcyBhIHN0cmluZyBhcnJheSBpZiBpdCBleGlzdHMgZnJvbSBhbiB1bmtub3duIGRhdGEgdHlwZSBhbmQgYSBzdHJpbmcKICogdGhhdCByZXByZXNlbnRzIHRoZSBwYXRoIHdpdGhpbiB0aGUgZGF0YSBvYmplY3QgdGhlIHNhbWUgYXMgbG9kYXNoJ3MgImdldCIuIElmIHRoZSB2YWx1ZSBpcyBub24tZXhpc3RlbnQKICogd2Ugd2lsbCByZXR1cm4gYW4gZW1wdHkgYXJyYXkuIElmIGl0IGlzIGEgbm9uIHN0cmluZyB2YWx1ZSB0aGVuIHRoaXMgd2lsbCBsb2cgYSB0cmFjZSB0byB0aGUgY29uc29sZQogKiB0aGF0IGl0IGVuY291bnRlcmVkIGFuIGVycm9yIGFuZCByZXR1cm4gYW4gZW1wdHkgYXJyYXkuCiAqIEBwYXJhbSBmaWVsZCBzdHJpbmcgb2YgdGhlIGZpZWxkIHRvIGFjY2VzcwogKiBAcGFyYW0gZGF0YSBUaGUgdW5rbm93biBkYXRhIHRoYXQgaXMgdHlwaWNhbGx5IGEgRUNTIHZhbHVlIHRvIGdldCB0aGUgdmFsdWUKICogQHBhcmFtIGxvY2FsQ29uc29sZSBUaGUgbG9jYWwgY29uc29sZSB3aGljaCBjYW4gYmUgc2VudCBpbiB0byBtYWtlIHRoaXMgcHVyZSAoZm9yIHRlc3RzKSBvciB1c2UgdGhlIGRlZmF1bHQgY29uc29sZQogKi8KCnZhciBnZXRTdHJpbmdBcnJheSA9IGZ1bmN0aW9uIGdldFN0cmluZ0FycmF5KGZpZWxkLCBkYXRhKSB7CiAgdmFyIGxvY2FsQ29uc29sZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogY29uc29sZTsKICB2YXIgdmFsdWUgPSAoMCwgX2ZwLmdldCkoZmllbGQsIGRhdGEpOwoKICBpZiAodmFsdWUgPT0gbnVsbCkgewogICAgcmV0dXJuIFtdOwogIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgewogICAgcmV0dXJuIFt2YWx1ZV07CiAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSAmJiB2YWx1ZS5ldmVyeShmdW5jdGlvbiAoZWxlbWVudCkgewogICAgcmV0dXJuIHR5cGVvZiBlbGVtZW50ID09PSAnc3RyaW5nJzsKICB9KSkgewogICAgcmV0dXJuIHZhbHVlOwogIH0gZWxzZSB7CiAgICBsb2NhbENvbnNvbGUudHJhY2UoJ0RhdGEgdHlwZSB0aGF0IGlzIG5vdCBhIHN0cmluZyBvciBzdHJpbmcgYXJyYXkgZGV0ZWN0ZWQ6JywgdmFsdWUsICd3aGVuIHRyeWluZyB0byBhY2Nlc3MgZmllbGQ6JywgZmllbGQsICdmcm9tIGRhdGEgb2JqZWN0IG9mOicsIGRhdGEpOwogICAgcmV0dXJuIFtdOwogIH0KfTsKCmV4cG9ydHMuZ2V0U3RyaW5nQXJyYXkgPSBnZXRTdHJpbmdBcnJheTsKCnZhciBmaW5kVmFsdWVUb0NoYW5nZUluUXVlcnkgPSBmdW5jdGlvbiBmaW5kVmFsdWVUb0NoYW5nZUluUXVlcnkoa3VlcnlOb2RlKSB7CiAgdmFyIHZhbHVlVG9DaGFuZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFtdOwogIHZhciBsb2NhbFZhbHVlVG9DaGFuZ2UgPSB2YWx1ZVRvQ2hhbmdlOwoKICBpZiAoa3VlcnlOb2RlLmZ1bmN0aW9uID09PSAnaXMnICYmIHRlbXBsYXRlRmllbGRzLmluY2x1ZGVzKGt1ZXJ5Tm9kZS5hcmd1bWVudHNbMF0udmFsdWUpKSB7CiAgICBsb2NhbFZhbHVlVG9DaGFuZ2UgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGxvY2FsVmFsdWVUb0NoYW5nZSksIFt7CiAgICAgIGZpZWxkOiBrdWVyeU5vZGUuYXJndW1lbnRzWzBdLnZhbHVlLAogICAgICB2YWx1ZVRvQ2hhbmdlOiBrdWVyeU5vZGUuYXJndW1lbnRzWzFdLnZhbHVlCiAgICB9XSk7CiAgfQoKICByZXR1cm4ga3VlcnlOb2RlLmFyZ3VtZW50cy5yZWR1Y2UoZnVuY3Rpb24gKGFkZFZhbHVlVG9DaGFuZ2UsIGFzdCkgewogICAgaWYgKGFzdC5mdW5jdGlvbiA9PT0gJ2lzJyAmJiB0ZW1wbGF0ZUZpZWxkcy5pbmNsdWRlcyhhc3QuYXJndW1lbnRzWzBdLnZhbHVlKSkgewogICAgICByZXR1cm4gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShhZGRWYWx1ZVRvQ2hhbmdlKSwgW3sKICAgICAgICBmaWVsZDogYXN0LmFyZ3VtZW50c1swXS52YWx1ZSwKICAgICAgICB2YWx1ZVRvQ2hhbmdlOiBhc3QuYXJndW1lbnRzWzFdLnZhbHVlCiAgICAgIH1dKTsKICAgIH0KCiAgICBpZiAoYXN0LmFyZ3VtZW50cykgewogICAgICByZXR1cm4gZmluZFZhbHVlVG9DaGFuZ2VJblF1ZXJ5KGFzdCwgYWRkVmFsdWVUb0NoYW5nZSk7CiAgICB9CgogICAgcmV0dXJuIGFkZFZhbHVlVG9DaGFuZ2U7CiAgfSwgbG9jYWxWYWx1ZVRvQ2hhbmdlKTsKfTsKCmV4cG9ydHMuZmluZFZhbHVlVG9DaGFuZ2VJblF1ZXJ5ID0gZmluZFZhbHVlVG9DaGFuZ2VJblF1ZXJ5OwoKdmFyIHJlcGxhY2VUZW1wbGF0ZUZpZWxkRnJvbVF1ZXJ5ID0gZnVuY3Rpb24gcmVwbGFjZVRlbXBsYXRlRmllbGRGcm9tUXVlcnkocXVlcnksIGVjc0RhdGEpIHsKICBpZiAocXVlcnkudHJpbSgpICE9PSAnJykgewogICAgdmFyIHZhbHVlVG9DaGFuZ2UgPSBmaW5kVmFsdWVUb0NoYW5nZUluUXVlcnkoX3B1YmxpYy5lc0t1ZXJ5LmZyb21LdWVyeUV4cHJlc3Npb24ocXVlcnkpKTsKICAgIHJldHVybiB2YWx1ZVRvQ2hhbmdlLnJlZHVjZShmdW5jdGlvbiAobmV3UXVlcnksIHZ0YykgewogICAgICB2YXIgbmV3VmFsdWUgPSBnZXRTdHJpbmdBcnJheSh2dGMuZmllbGQsIGVjc0RhdGEpOwoKICAgICAgaWYgKG5ld1ZhbHVlLmxlbmd0aCkgewogICAgICAgIHJldHVybiBuZXdRdWVyeS5yZXBsYWNlKHZ0Yy52YWx1ZVRvQ2hhbmdlLCBuZXdWYWx1ZVswXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG5ld1F1ZXJ5OwogICAgICB9CiAgICB9LCBxdWVyeSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiAnJzsKICB9Cn07CgpleHBvcnRzLnJlcGxhY2VUZW1wbGF0ZUZpZWxkRnJvbVF1ZXJ5ID0gcmVwbGFjZVRlbXBsYXRlRmllbGRGcm9tUXVlcnk7Cgp2YXIgcmVwbGFjZVRlbXBsYXRlRmllbGRGcm9tTWF0Y2hGaWx0ZXJzID0gZnVuY3Rpb24gcmVwbGFjZVRlbXBsYXRlRmllbGRGcm9tTWF0Y2hGaWx0ZXJzKGZpbHRlcnMsIGVjc0RhdGEpIHsKICByZXR1cm4gZmlsdGVycy5tYXAoZnVuY3Rpb24gKGZpbHRlcikgewogICAgaWYgKGZpbHRlci5tZXRhLnR5cGUgPT09ICdwaHJhc2UnICYmIGZpbHRlci5tZXRhLmtleSAhPSBudWxsICYmIHRlbXBsYXRlRmllbGRzLmluY2x1ZGVzKGZpbHRlci5tZXRhLmtleSkpIHsKICAgICAgdmFyIG5ld1ZhbHVlID0gZ2V0U3RyaW5nQXJyYXkoZmlsdGVyLm1ldGEua2V5LCBlY3NEYXRhKTsKCiAgICAgIGlmIChuZXdWYWx1ZS5sZW5ndGgpIHsKICAgICAgICBmaWx0ZXIubWV0YS5wYXJhbXMgPSB7CiAgICAgICAgICBxdWVyeTogbmV3VmFsdWVbMF0KICAgICAgICB9OwogICAgICAgIGZpbHRlci5xdWVyeSA9IHsKICAgICAgICAgIG1hdGNoX3BocmFzZTogX2RlZmluZVByb3BlcnR5KHt9LCBmaWx0ZXIubWV0YS5rZXksIG5ld1ZhbHVlWzBdKQogICAgICAgIH07CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmlsdGVyOwogIH0pOwp9OwoKZXhwb3J0cy5yZXBsYWNlVGVtcGxhdGVGaWVsZEZyb21NYXRjaEZpbHRlcnMgPSByZXBsYWNlVGVtcGxhdGVGaWVsZEZyb21NYXRjaEZpbHRlcnM7Cgp2YXIgcmVmb3JtYXREYXRhUHJvdmlkZXJXaXRoTmV3VmFsdWUgPSBmdW5jdGlvbiByZWZvcm1hdERhdGFQcm92aWRlcldpdGhOZXdWYWx1ZShkYXRhUHJvdmlkZXIsIGVjc0RhdGEpIHsKICBpZiAodGVtcGxhdGVGaWVsZHMuaW5jbHVkZXMoZGF0YVByb3ZpZGVyLnF1ZXJ5TWF0Y2guZmllbGQpKSB7CiAgICB2YXIgbmV3VmFsdWUgPSBnZXRTdHJpbmdBcnJheShkYXRhUHJvdmlkZXIucXVlcnlNYXRjaC5maWVsZCwgZWNzRGF0YSk7CgogICAgaWYgKG5ld1ZhbHVlLmxlbmd0aCkgewogICAgICBkYXRhUHJvdmlkZXIuaWQgPSBkYXRhUHJvdmlkZXIuaWQucmVwbGFjZShkYXRhUHJvdmlkZXIubmFtZSwgbmV3VmFsdWVbMF0pOwogICAgICBkYXRhUHJvdmlkZXIubmFtZSA9IG5ld1ZhbHVlWzBdOwogICAgICBkYXRhUHJvdmlkZXIucXVlcnlNYXRjaC52YWx1ZSA9IG5ld1ZhbHVlWzBdOwogICAgICBkYXRhUHJvdmlkZXIucXVlcnlNYXRjaC5kaXNwbGF5RmllbGQgPSB1bmRlZmluZWQ7CiAgICAgIGRhdGFQcm92aWRlci5xdWVyeU1hdGNoLmRpc3BsYXlWYWx1ZSA9IHVuZGVmaW5lZDsKICAgIH0KICB9CgogIHJldHVybiBkYXRhUHJvdmlkZXI7Cn07CgpleHBvcnRzLnJlZm9ybWF0RGF0YVByb3ZpZGVyV2l0aE5ld1ZhbHVlID0gcmVmb3JtYXREYXRhUHJvdmlkZXJXaXRoTmV3VmFsdWU7Cgp2YXIgcmVwbGFjZVRlbXBsYXRlRmllbGRGcm9tRGF0YVByb3ZpZGVycyA9IGZ1bmN0aW9uIHJlcGxhY2VUZW1wbGF0ZUZpZWxkRnJvbURhdGFQcm92aWRlcnMoZGF0YVByb3ZpZGVycywgZWNzRGF0YSkgewogIHJldHVybiBkYXRhUHJvdmlkZXJzLm1hcChmdW5jdGlvbiAoZGF0YVByb3ZpZGVyKSB7CiAgICB2YXIgbmV3RGF0YVByb3ZpZGVyID0gcmVmb3JtYXREYXRhUHJvdmlkZXJXaXRoTmV3VmFsdWUoZGF0YVByb3ZpZGVyLCBlY3NEYXRhKTsKCiAgICBpZiAobmV3RGF0YVByb3ZpZGVyLmFuZCAhPSBudWxsICYmICEoMCwgX2ZwLmlzRW1wdHkpKG5ld0RhdGFQcm92aWRlci5hbmQpKSB7CiAgICAgIG5ld0RhdGFQcm92aWRlci5hbmQgPSBuZXdEYXRhUHJvdmlkZXIuYW5kLm1hcChmdW5jdGlvbiAoYW5kRGF0YVByb3ZpZGVyKSB7CiAgICAgICAgcmV0dXJuIHJlZm9ybWF0RGF0YVByb3ZpZGVyV2l0aE5ld1ZhbHVlKGFuZERhdGFQcm92aWRlciwgZWNzRGF0YSk7CiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBuZXdEYXRhUHJvdmlkZXI7CiAgfSk7Cn07CgpleHBvcnRzLnJlcGxhY2VUZW1wbGF0ZUZpZWxkRnJvbURhdGFQcm92aWRlcnMgPSByZXBsYWNlVGVtcGxhdGVGaWVsZEZyb21EYXRhUHJvdmlkZXJzOw=="},null]}