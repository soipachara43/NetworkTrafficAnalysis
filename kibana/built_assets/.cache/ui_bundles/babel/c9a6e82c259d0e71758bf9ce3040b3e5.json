{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/region_map/public/choropleth_layer.js","dependencies":[{"path":"src/legacy/core_plugins/region_map/public/choropleth_layer.js","mtime":1589249549890},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7Cgp2YXIgX2pxdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgianF1ZXJ5IikpOwoKdmFyIF9sZWFmbGV0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsZWFmbGV0IikpOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiZDMiKSk7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfa2liYW5hX21hcF9sYXllciA9IHJlcXVpcmUoInVpL3Zpcy9tYXAva2liYW5hX21hcF9sYXllciIpOwoKdmFyIHRvcG9qc29uID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgidG9wb2pzb24tY2xpZW50IikpOwoKdmFyIF9ub3RpZnkgPSByZXF1aXJlKCJ1aS9ub3RpZnkiKTsKCnZhciBjb2xvclV0aWwgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJ1aS92aXMvbWFwL2NvbG9yX3V0aWwiKSk7Cgp2YXIgX3B1YmxpYyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3BsdWdpbnMvY2hhcnRzL3B1YmxpYyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgeyB0cnkgeyB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7IHZhciB2YWx1ZSA9IGluZm8udmFsdWU7IH0gY2F0Y2ggKGVycm9yKSB7IHJlamVjdChlcnJvcik7IHJldHVybjsgfSBpZiAoaW5mby5kb25lKSB7IHJlc29sdmUodmFsdWUpOyB9IGVsc2UgeyBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7IH0gfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7IGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7IH0gZnVuY3Rpb24gX3Rocm93KGVycikgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7IH0gX25leHQodW5kZWZpbmVkKTsgfSk7IH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfZ2V0KHRhcmdldCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmICh0eXBlb2YgUmVmbGVjdCAhPT0gInVuZGVmaW5lZCIgJiYgUmVmbGVjdC5nZXQpIHsgX2dldCA9IFJlZmxlY3QuZ2V0OyB9IGVsc2UgeyBfZ2V0ID0gZnVuY3Rpb24gX2dldCh0YXJnZXQsIHByb3BlcnR5LCByZWNlaXZlcikgeyB2YXIgYmFzZSA9IF9zdXBlclByb3BCYXNlKHRhcmdldCwgcHJvcGVydHkpOyBpZiAoIWJhc2UpIHJldHVybjsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGJhc2UsIHByb3BlcnR5KTsgaWYgKGRlc2MuZ2V0KSB7IHJldHVybiBkZXNjLmdldC5jYWxsKHJlY2VpdmVyKTsgfSByZXR1cm4gZGVzYy52YWx1ZTsgfTsgfSByZXR1cm4gX2dldCh0YXJnZXQsIHByb3BlcnR5LCByZWNlaXZlciB8fCB0YXJnZXQpOyB9CgpmdW5jdGlvbiBfc3VwZXJQcm9wQmFzZShvYmplY3QsIHByb3BlcnR5KSB7IHdoaWxlICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpKSB7IG9iamVjdCA9IF9nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAob2JqZWN0ID09PSBudWxsKSBicmVhazsgfSByZXR1cm4gb2JqZWN0OyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9Cgp2YXIgRU1QVFlfU1RZTEUgPSB7CiAgd2VpZ2h0OiAxLAogIG9wYWNpdHk6IDAuNiwKICBjb2xvcjogJ3JnYigyMDAsMjAwLDIwMCknLAogIGZpbGxPcGFjaXR5OiAwCn07Cgp2YXIgQ2hvcm9wbGV0aExheWVyID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0tpYmFuYU1hcExheWVyKSB7CiAgX2luaGVyaXRzKENob3JvcGxldGhMYXllciwgX0tpYmFuYU1hcExheWVyKTsKCiAgX2NyZWF0ZUNsYXNzKENob3JvcGxldGhMYXllciwgbnVsbCwgW3sKICAgIGtleTogIl9kb0lubmVySm9pbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RvSW5uZXJKb2luKHNvcnRlZE1ldHJpY3MsIHNvcnRlZEdlb2pzb25GZWF0dXJlcywgam9pbkZpZWxkKSB7CiAgICAgIHZhciBqID0gMDsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc29ydGVkR2VvanNvbkZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIHByb3BlcnR5ID0gc29ydGVkR2VvanNvbkZlYXR1cmVzW2ldLnByb3BlcnRpZXNbam9pbkZpZWxkXTsKICAgICAgICBzb3J0ZWRHZW9qc29uRmVhdHVyZXNbaV0uX19rYm5Kb2luZWRNZXRyaWMgPSBudWxsOwogICAgICAgIHZhciBwb3NpdGlvbiA9IHNvcnRlZE1ldHJpY3MubGVuZ3RoID8gY29tcGFyZUxleGljb2dyYXBoaWNhbGx5KHByb3BlcnR5LCBzb3J0ZWRNZXRyaWNzW2pdLnRlcm0pIDogLTE7CgogICAgICAgIGlmIChwb3NpdGlvbiA9PT0gLTEpIHsvL2p1c3QgbmVlZCB0byBjeWNsZSBvbgogICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09IDApIHsKICAgICAgICAgIHNvcnRlZEdlb2pzb25GZWF0dXJlc1tpXS5fX2tibkpvaW5lZE1ldHJpYyA9IHNvcnRlZE1ldHJpY3Nbal07CiAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gMSkgewogICAgICAgICAgLy9uZWVkcyB0byBjYXRjaCB1cAogICAgICAgICAgd2hpbGUgKGogPCBzb3J0ZWRNZXRyaWNzLmxlbmd0aCkgewogICAgICAgICAgICB2YXIgbmV3VGVybSA9IHNvcnRlZE1ldHJpY3Nbal0udGVybTsKICAgICAgICAgICAgdmFyIG5ld1Bvc2l0aW9uID0gY29tcGFyZUxleGljb2dyYXBoaWNhbGx5KG5ld1Rlcm0sIHByb3BlcnR5KTsKCiAgICAgICAgICAgIGlmIChuZXdQb3NpdGlvbiA9PT0gLTEpIHsvL25vdCBmYXIgZW5vdWdoCiAgICAgICAgICAgIH0gZWxzZSBpZiAobmV3UG9zaXRpb24gPT09IDApIHsKICAgICAgICAgICAgICBzb3J0ZWRHZW9qc29uRmVhdHVyZXNbaV0uX19rYm5Kb2luZWRNZXRyaWMgPSBzb3J0ZWRNZXRyaWNzW2pdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9IGVsc2UgaWYgKG5ld1Bvc2l0aW9uID09PSAxKSB7CiAgICAgICAgICAgICAgLy90b28gZmFyIQogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoaiA9PT0gc29ydGVkTWV0cmljcy5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgLy9hbHdheXMga2VlcCBhIHJlZmVyZW5jZSB0byB0aGUgbGFzdCBtZXRyaWMKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBqKys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9XSk7CgogIGZ1bmN0aW9uIENob3JvcGxldGhMYXllcihuYW1lLCBhdHRyaWJ1dGlvbiwgZm9ybWF0LCBzaG93QWxsU2hhcGVzLCBtZXRhLCBsYXllckNvbmZpZywgc2VydmljZVNldHRpbmdzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENob3JvcGxldGhMYXllcik7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoQ2hvcm9wbGV0aExheWVyKS5jYWxsKHRoaXMpKTsKICAgIF90aGlzLl9zZXJ2aWNlU2V0dGluZ3MgPSBzZXJ2aWNlU2V0dGluZ3M7CiAgICBfdGhpcy5fbWV0cmljcyA9IG51bGw7CiAgICBfdGhpcy5fam9pbkZpZWxkID0gbnVsbDsKICAgIF90aGlzLl9jb2xvclJhbXAgPSBfcHVibGljLnRydW5jYXRlZENvbG9yTWFwc1tPYmplY3Qua2V5cyhfcHVibGljLnRydW5jYXRlZENvbG9yTWFwcylbMF1dLnZhbHVlOwogICAgX3RoaXMuX2xpbmVXZWlnaHQgPSAxOwoKICAgIF90aGlzLl90b29sdGlwRm9ybWF0dGVyID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gJyc7CiAgICB9OwoKICAgIF90aGlzLl9hdHRyaWJ1dGlvbiA9IGF0dHJpYnV0aW9uOwogICAgX3RoaXMuX2JvdW5kc09mRGF0YSA9IG51bGw7CiAgICBfdGhpcy5fc2hvd0FsbFNoYXBlcyA9IHNob3dBbGxTaGFwZXM7CiAgICBfdGhpcy5fbGF5ZXJOYW1lID0gbmFtZTsKICAgIF90aGlzLl9sYXllckNvbmZpZyA9IGxheWVyQ29uZmlnOwogICAgX3RoaXMuX2xlYWZsZXRMYXllciA9IF9sZWFmbGV0LmRlZmF1bHQuZ2VvSnNvbihudWxsLCB7CiAgICAgIG9uRWFjaEZlYXR1cmU6IGZ1bmN0aW9uIG9uRWFjaEZlYXR1cmUoZmVhdHVyZSwgbGF5ZXIpIHsKICAgICAgICBsYXllci5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5lbWl0KCdzZWxlY3QnLCBmZWF0dXJlLnByb3BlcnRpZXNbX3RoaXMuX2pvaW5GaWVsZF0pOwogICAgICAgIH0pOwogICAgICAgIHZhciBsb2NhdGlvbiA9IG51bGw7CiAgICAgICAgbGF5ZXIub24oewogICAgICAgICAgbW91c2VvdmVyOiBmdW5jdGlvbiBtb3VzZW92ZXIoKSB7CiAgICAgICAgICAgIHZhciB0b29sdGlwQ29udGVudHMgPSBfdGhpcy5fdG9vbHRpcEZvcm1hdHRlcihmZWF0dXJlKTsKCiAgICAgICAgICAgIGlmICghbG9jYXRpb24pIHsKICAgICAgICAgICAgICB2YXIgbGVhZmxldEdlb2pzb24gPSBfbGVhZmxldC5kZWZhdWx0Lmdlb0pzb24oZmVhdHVyZSk7CgogICAgICAgICAgICAgIGxvY2F0aW9uID0gbGVhZmxldEdlb2pzb24uZ2V0Qm91bmRzKCkuZ2V0Q2VudGVyKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzLmVtaXQoJ3Nob3dUb29sdGlwJywgewogICAgICAgICAgICAgIGNvbnRlbnQ6IHRvb2x0aXBDb250ZW50cywKICAgICAgICAgICAgICBwb3NpdGlvbjogbG9jYXRpb24KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9LAogICAgICAgICAgbW91c2VvdXQ6IGZ1bmN0aW9uIG1vdXNlb3V0KCkgewogICAgICAgICAgICBfdGhpcy5lbWl0KCdoaWRlVG9vbHRpcCcpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LAogICAgICBzdHlsZTogX3RoaXMuX21ha2VFbXB0eVN0eWxlRnVuY3Rpb24oKQogICAgfSk7CiAgICBfdGhpcy5fbG9hZGVkID0gZmFsc2U7CiAgICBfdGhpcy5fZXJyb3IgPSBmYWxzZTsKICAgIF90aGlzLl9pc0pvaW5WYWxpZCA9IGZhbHNlOwogICAgX3RoaXMuX3doZW5EYXRhTG9hZGVkID0gbmV3IFByb21pc2UoCiAgICAvKiNfX1BVUkVfXyovCiAgICBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShyZXNvbHZlKSB7CiAgICAgICAgdmFyIGRhdGEsIGZlYXR1cmVDb2xsZWN0aW9uLCBmb3JtYXRUeXBlLCBmZWF0dXJlcywgZXJyb3JNZXNzYWdlOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuX21ha2VKc29uQWpheENhbGwoKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgZGF0YSA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmb3JtYXQgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICAgIGZvcm1hdFR5cGUgPSBmb3JtYXQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCAmJiBmb3JtYXQudHlwZSkgewogICAgICAgICAgICAgICAgICBmb3JtYXRUeXBlID0gZm9ybWF0LnR5cGU7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBmb3JtYXRUeXBlID0gJ2dlb2pzb24nOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghKGZvcm1hdFR5cGUgPT09ICdnZW9qc29uJykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGZlYXR1cmVDb2xsZWN0aW9uID0gZGF0YTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBpZiAoIShmb3JtYXRUeXBlID09PSAndG9wb2pzb24nKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGZlYXR1cmVzID0gX2xvZGFzaC5kZWZhdWx0LmdldChkYXRhLCAnb2JqZWN0cy4nICsgbWV0YS5mZWF0dXJlX2NvbGxlY3Rpb25fcGF0aCk7CiAgICAgICAgICAgICAgICBmZWF0dXJlQ29sbGVjdGlvbiA9IHRvcG9qc29uLmZlYXR1cmUoZGF0YSwgZmVhdHVyZXMpOyAvL2NvbnZlcnNpb24gdG8gZ2VvanNvbgoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKF9pMThuLmkxOG4udHJhbnNsYXRlKCdyZWdpb25NYXAuY2hvcm9wbGV0aExheWVyLnVucmVjb2duaXplZEZvcm1hdEVycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbnJlY29nbml6ZWQgZm9ybWF0IHtmb3JtYXRUeXBlfScsCiAgICAgICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgICAgIGZvcm1hdFR5cGU6IGZvcm1hdFR5cGUKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgX3RoaXMuX3NvcnRlZEZlYXR1cmVzID0gZmVhdHVyZUNvbGxlY3Rpb24uZmVhdHVyZXMuc2xpY2UoKTsKCiAgICAgICAgICAgICAgICBfdGhpcy5fc29ydEZlYXR1cmVzKCk7CgogICAgICAgICAgICAgICAgaWYgKHNob3dBbGxTaGFwZXMpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMuX2xlYWZsZXRMYXllci5hZGREYXRhKGZlYXR1cmVDb2xsZWN0aW9uKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7Ly93ZSBuZWVkIHRvIGRlbGF5IGFkZGluZyB0aGUgZGF0YSB1bnRpbCB3ZSBoYXZlIHBlcmZvcm1lZCB0aGUgam9pbiBhbmQga25vdyB3aGljaCBmZWF0dXJlcwogICAgICAgICAgICAgICAgICAvL3Nob3VsZCBiZSBkaXNwbGF5ZWQKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpcy5fbG9hZGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBfdGhpcy5fc2V0U3R5bGUoKTsKCiAgICAgICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyMzsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMCk7CiAgICAgICAgICAgICAgICBfdGhpcy5fbG9hZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF90aGlzLl9lcnJvciA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKF9jb250ZXh0LnQwLnN0YXR1cyA9PT0gNDA0KSB7CiAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IF9pMThuLmkxOG4udHJhbnNsYXRlKCdyZWdpb25NYXAuY2hvcm9wbGV0aExheWVyLmRvd25sb2FkaW5nVmVjdG9yRGF0YTQwNEVycm9yTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlNlcnZlciByZXNwb25kaW5nIHdpdGggJzQwNCcgd2hlbiBhdHRlbXB0aW5nIHRvIGZldGNoIHtuYW1lfS4gXApNYWtlIHN1cmUgdGhlIGZpbGUgZXhpc3RzIGF0IHRoYXQgbG9jYXRpb24uIiwKICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3JlZ2lvbk1hcC5jaG9yb3BsZXRoTGF5ZXIuZG93bmxvYWRpbmdWZWN0b3JEYXRhRXJyb3JNZXNzYWdlJywgewogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQ2Fubm90IGRvd25sb2FkIHtuYW1lfSBmaWxlLiBQbGVhc2UgZW5zdXJlIHRoZSBcCkNPUlMgY29uZmlndXJhdGlvbiBvZiB0aGUgc2VydmVyIHBlcm1pdHMgcmVxdWVzdHMgZnJvbSB0aGUgS2liYW5hIGFwcGxpY2F0aW9uIG9uIHRoaXMgaG9zdC4nLAogICAgICAgICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkRGFuZ2VyKHsKICAgICAgICAgICAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCdyZWdpb25NYXAuY2hvcm9wbGV0aExheWVyLmRvd25sb2FkaW5nVmVjdG9yRGF0YUVycm9yTWVzc2FnZVRpdGxlJywgewogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRXJyb3IgZG93bmxvYWRpbmcgdmVjdG9yIGRhdGEnCiAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICB0ZXh0OiBlcnJvck1lc3NhZ2UKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJlc29sdmUoKTsKCiAgICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMCwgMjNdXSk7CiAgICAgIH0pKTsKCiAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKICAgIHJldHVybiBfdGhpczsKICB9IC8vVGhpcyBtZXRob2QgaXMgc3R1YmJlZCBpbiB0aGUgdGVzdHMgdG8gYXZvaWQgbmV0d29yayByZXF1ZXN0IGR1cmluZyB1bml0IHRlc3RzLgoKCiAgX2NyZWF0ZUNsYXNzKENob3JvcGxldGhMYXllciwgW3sKICAgIGtleTogIl9tYWtlSnNvbkFqYXhDYWxsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfbWFrZUpzb25BamF4Q2FsbDIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHRoaXMuX3NlcnZpY2VTZXR0aW5ncy5nZXRKc29uRm9yUmVnaW9uTGF5ZXIodGhpcy5fbGF5ZXJDb25maWcpKTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gX21ha2VKc29uQWpheENhbGwoKSB7CiAgICAgICAgcmV0dXJuIF9tYWtlSnNvbkFqYXhDYWxsMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gX21ha2VKc29uQWpheENhbGw7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJfaW52YWxpZGF0ZUpvaW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnZhbGlkYXRlSm9pbigpIHsKICAgICAgdGhpcy5faXNKb2luVmFsaWQgPSBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZG9Jbm5lckpvaW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kb0lubmVySm9pbigpIHsKICAgICAgQ2hvcm9wbGV0aExheWVyLl9kb0lubmVySm9pbih0aGlzLl9tZXRyaWNzLCB0aGlzLl9zb3J0ZWRGZWF0dXJlcywgdGhpcy5fam9pbkZpZWxkKTsKCiAgICAgIHRoaXMuX2lzSm9pblZhbGlkID0gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfc2V0U3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRTdHlsZSgpIHsKICAgICAgaWYgKHRoaXMuX2Vycm9yIHx8ICF0aGlzLl9sb2FkZWQgfHwgIXRoaXMuX21ldHJpY3MgfHwgIXRoaXMuX2pvaW5GaWVsZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLl9pc0pvaW5WYWxpZCkgewogICAgICAgIHRoaXMuX2RvSW5uZXJKb2luKCk7CgogICAgICAgIGlmICghdGhpcy5fc2hvd0FsbFNoYXBlcykgewogICAgICAgICAgdmFyIGZlYXR1cmVDb2xsZWN0aW9uID0gewogICAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgICBmZWF0dXJlczogdGhpcy5fc29ydGVkRmVhdHVyZXMuZmlsdGVyKGZ1bmN0aW9uIChmZWF0dXJlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZlYXR1cmUuX19rYm5Kb2luZWRNZXRyaWM7CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9OwoKICAgICAgICAgIHRoaXMuX2xlYWZsZXRMYXllci5hZGREYXRhKGZlYXR1cmVDb2xsZWN0aW9uKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBzdHlsZXIgPSB0aGlzLl9tYWtlQ2hvcm9wbGV0aFN0eWxlcigpOwoKICAgICAgdGhpcy5fbGVhZmxldExheWVyLnNldFN0eWxlKHN0eWxlci5sZWFmbGV0U3R5bGVGdW5jdGlvbik7CgogICAgICBpZiAodGhpcy5fbWV0cmljcyAmJiB0aGlzLl9tZXRyaWNzLmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgX2dldE1pbk1heCA9IGdldE1pbk1heCh0aGlzLl9tZXRyaWNzKSwKICAgICAgICAgICAgbWluID0gX2dldE1pbk1heC5taW4sCiAgICAgICAgICAgIG1heCA9IF9nZXRNaW5NYXgubWF4OwoKICAgICAgICB0aGlzLl9sZWdlbmRDb2xvcnMgPSBjb2xvclV0aWwuZ2V0TGVnZW5kQ29sb3JzKHRoaXMuX2NvbG9yUmFtcCk7CiAgICAgICAgdmFyIHF1YW50aXplRG9tYWluID0gbWluICE9PSBtYXggPyBbbWluLCBtYXhdIDogX2QuZGVmYXVsdC5zY2FsZS5xdWFudGl6ZSgpLmRvbWFpbigpOwogICAgICAgIHRoaXMuX2xlZ2VuZFF1YW50aXplciA9IF9kLmRlZmF1bHQuc2NhbGUucXVhbnRpemUoKS5kb21haW4ocXVhbnRpemVEb21haW4pLnJhbmdlKHRoaXMuX2xlZ2VuZENvbG9ycyk7CiAgICAgIH0KCiAgICAgIHRoaXMuX2JvdW5kc09mRGF0YSA9IHN0eWxlci5nZXRMZWFmbGV0Qm91bmRzKCk7CiAgICAgIHRoaXMuZW1pdCgnc3R5bGVDaGFuZ2VkJywgewogICAgICAgIG1pc21hdGNoZXM6IHN0eWxlci5nZXRNaXNtYXRjaGVzKCkKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VXJsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRVcmwoKSB7CiAgICAgIHJldHVybiB0aGlzLl9sYXllck5hbWU7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0VG9vbHRpcEZvcm1hdHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0VG9vbHRpcEZvcm1hdHRlcih0b29sdGlwRm9ybWF0dGVyLCBmaWVsZEZvcm1hdHRlciwgZmllbGROYW1lLCBtZXRyaWNMYWJlbCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuX3Rvb2x0aXBGb3JtYXR0ZXIgPSBmdW5jdGlvbiAoZ2VvanNvbkZlYXR1cmUpIHsKICAgICAgICBpZiAoIV90aGlzMi5fbWV0cmljcykgewogICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0KCiAgICAgICAgdmFyIG1hdGNoID0gX3RoaXMyLl9tZXRyaWNzLmZpbmQoZnVuY3Rpb24gKGJ1Y2tldCkgewogICAgICAgICAgcmV0dXJuIGNvbXBhcmVMZXhpY29ncmFwaGljYWxseShidWNrZXQudGVybSwgZ2VvanNvbkZlYXR1cmUucHJvcGVydGllc1tfdGhpczIuX2pvaW5GaWVsZF0pID09PSAwOwogICAgICAgIH0pOwoKICAgICAgICByZXR1cm4gdG9vbHRpcEZvcm1hdHRlcihtYXRjaCwgZmllbGRGb3JtYXR0ZXIsIGZpZWxkTmFtZSwgbWV0cmljTGFiZWwpOwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogInNldEpvaW5GaWVsZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Sm9pbkZpZWxkKGpvaW5maWVsZCkgewogICAgICBpZiAoam9pbmZpZWxkID09PSB0aGlzLl9qb2luRmllbGQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX2pvaW5GaWVsZCA9IGpvaW5maWVsZDsKCiAgICAgIHRoaXMuX3NvcnRGZWF0dXJlcygpOwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9uZUNob3JvcGxldGhMYXllckZvck5ld0RhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lQ2hvcm9wbGV0aExheWVyRm9yTmV3RGF0YShuYW1lLCBhdHRyaWJ1dGlvbiwgZm9ybWF0LCBzaG93QWxsRGF0YSwgbWV0YSwgbGF5ZXJDb25maWcsIHNlcnZpY2VTZXR0aW5ncykgewogICAgICB2YXIgY2xvbmVkTGF5ZXIgPSBuZXcgQ2hvcm9wbGV0aExheWVyKG5hbWUsIGF0dHJpYnV0aW9uLCBmb3JtYXQsIHNob3dBbGxEYXRhLCBtZXRhLCBsYXllckNvbmZpZywgc2VydmljZVNldHRpbmdzKTsKICAgICAgY2xvbmVkTGF5ZXIuc2V0Sm9pbkZpZWxkKHRoaXMuX2pvaW5GaWVsZCk7CiAgICAgIGNsb25lZExheWVyLnNldENvbG9yUmFtcCh0aGlzLl9jb2xvclJhbXApOwogICAgICBjbG9uZWRMYXllci5zZXRMaW5lV2VpZ2h0KHRoaXMuX2xpbmVXZWlnaHQpOwogICAgICBjbG9uZWRMYXllci5zZXRUb29sdGlwRm9ybWF0dGVyKHRoaXMuX3Rvb2x0aXBGb3JtYXR0ZXIpOwoKICAgICAgaWYgKHRoaXMuX21ldHJpY3MpIHsKICAgICAgICBjbG9uZWRMYXllci5zZXRNZXRyaWNzKHRoaXMuX21ldHJpY3MsIHRoaXMuX3ZhbHVlRm9ybWF0dGVyLCB0aGlzLl9tZXRyaWNUaXRsZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjbG9uZWRMYXllcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfc29ydEZlYXR1cmVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc29ydEZlYXR1cmVzKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIGlmICh0aGlzLl9zb3J0ZWRGZWF0dXJlcyAmJiB0aGlzLl9qb2luRmllbGQpIHsKICAgICAgICB0aGlzLl9zb3J0ZWRGZWF0dXJlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICB2YXIgdGVybUEgPSBhLnByb3BlcnRpZXNbX3RoaXMzLl9qb2luRmllbGRdOwogICAgICAgICAgdmFyIHRlcm1CID0gYi5wcm9wZXJ0aWVzW190aGlzMy5fam9pbkZpZWxkXTsKICAgICAgICAgIHJldHVybiBjb21wYXJlTGV4aWNvZ3JhcGhpY2FsbHkodGVybUEsIHRlcm1CKTsKICAgICAgICB9KTsKCiAgICAgICAgdGhpcy5faW52YWxpZGF0ZUpvaW4oKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIndoZW5EYXRhTG9hZGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB3aGVuRGF0YUxvYWRlZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3doZW5EYXRhTG9hZGVkOwogICAgfQogIH0sIHsKICAgIGtleTogInNldE1ldHJpY3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldE1ldHJpY3MobWV0cmljcywgZmllbGRGb3JtYXR0ZXIsIG1ldHJpY1RpdGxlKSB7CiAgICAgIHRoaXMuX21ldHJpY3MgPSBtZXRyaWNzLnNsaWNlKCk7CiAgICAgIHRoaXMuX3ZhbHVlRm9ybWF0dGVyID0gZmllbGRGb3JtYXR0ZXI7CiAgICAgIHRoaXMuX21ldHJpY1RpdGxlID0gbWV0cmljVGl0bGU7CgogICAgICB0aGlzLl9tZXRyaWNzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICByZXR1cm4gY29tcGFyZUxleGljb2dyYXBoaWNhbGx5KGEudGVybSwgYi50ZXJtKTsKICAgICAgfSk7CgogICAgICB0aGlzLl9pbnZhbGlkYXRlSm9pbigpOwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRDb2xvclJhbXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldENvbG9yUmFtcChjb2xvclJhbXApIHsKICAgICAgaWYgKF9sb2Rhc2guZGVmYXVsdC5pc0VxdWFsKGNvbG9yUmFtcCwgdGhpcy5fY29sb3JSYW1wKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5fY29sb3JSYW1wID0gY29sb3JSYW1wOwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRMaW5lV2VpZ2h0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRMaW5lV2VpZ2h0KGxpbmVXZWlnaHQpIHsKICAgICAgaWYgKHRoaXMuX2xpbmVXZWlnaHQgPT09IGxpbmVXZWlnaHQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX2xpbmVXZWlnaHQgPSBsaW5lV2VpZ2h0OwoKICAgICAgdGhpcy5fc2V0U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjYW5SZXVzZUluc3RhbmNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5SZXVzZUluc3RhbmNlKG5hbWUsIHNob3dBbGxTaGFwZXMpIHsKICAgICAgcmV0dXJuIHRoaXMuX2xheWVyTmFtZSA9PT0gbmFtZSAmJiB0aGlzLl9zaG93QWxsU2hhcGVzID09PSBzaG93QWxsU2hhcGVzOwogICAgfQogIH0sIHsKICAgIGtleTogImNhblJldXNlSW5zdGFuY2VGb3JOZXdNZXRyaWNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5SZXVzZUluc3RhbmNlRm9yTmV3TWV0cmljcyhuYW1lLCBzaG93QWxsU2hhcGVzLCBuZXdNZXRyaWNzKSB7CiAgICAgIGlmICh0aGlzLl9sYXllck5hbWUgIT09IG5hbWUpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmIChzaG93QWxsU2hhcGVzKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3dBbGxTaGFwZXMgPT09IHNob3dBbGxTaGFwZXM7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5fbWV0cmljcykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGN1cnJlbnRLZXlzID0gT2JqZWN0LmtleXModGhpcy5fbWV0cmljcyk7CiAgICAgIHZhciBuZXdLZXlzID0gT2JqZWN0LmtleXMobmV3TWV0cmljcyk7CiAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuaXNFcXVhbChjdXJyZW50S2V5cywgbmV3S2V5cyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Qm91bmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCb3VuZHMoKSB7CiAgICAgIHZhciBib3VuZHMgPSBfZ2V0KF9nZXRQcm90b3R5cGVPZihDaG9yb3BsZXRoTGF5ZXIucHJvdG90eXBlKSwgImdldEJvdW5kcyIsIHRoaXMpLmNhbGwodGhpcyk7CgogICAgICByZXR1cm4gdGhpcy5fYm91bmRzT2ZEYXRhID8gdGhpcy5fYm91bmRzT2ZEYXRhIDogYm91bmRzOwogICAgfQogIH0sIHsKICAgIGtleTogImFwcGVuZExlZ2VuZENvbnRlbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBlbmRMZWdlbmRDb250ZW50cyhqcXVlcnlEaXYpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuX2xlZ2VuZENvbG9ycyB8fCAhdGhpcy5fbGVnZW5kUXVhbnRpemVyKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgdGl0bGVUZXh0ID0gdGhpcy5fbWV0cmljVGl0bGU7CiAgICAgIHZhciAkdGl0bGUgPSAoMCwgX2pxdWVyeS5kZWZhdWx0KSgnPGRpdj4nKS5hZGRDbGFzcygndmlzTWFwTGVnZW5kX190aXRsZScpLnRleHQodGl0bGVUZXh0KTsKICAgICAganF1ZXJ5RGl2LmFwcGVuZCgkdGl0bGUpOwoKICAgICAgdGhpcy5fbGVnZW5kQ29sb3JzLmZvckVhY2goZnVuY3Rpb24gKGNvbG9yKSB7CiAgICAgICAgdmFyIGxhYmVsVGV4dCA9IF90aGlzNC5fbGVnZW5kUXVhbnRpemVyLmludmVydEV4dGVudChjb2xvcikubWFwKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgIHJldHVybiBfdGhpczQuX3ZhbHVlRm9ybWF0dGVyLmNvbnZlcnQodmFsKTsKICAgICAgICB9KS5qb2luKCcg4oCTwqAnKTsKCiAgICAgICAgdmFyIGxhYmVsID0gKDAsIF9qcXVlcnkuZGVmYXVsdCkoJzxkaXY+Jyk7CiAgICAgICAgdmFyIGljb24gPSAoMCwgX2pxdWVyeS5kZWZhdWx0KSgnPGk+JykuY3NzKHsKICAgICAgICAgIGJhY2tncm91bmQ6IGNvbG9yLAogICAgICAgICAgJ2JvcmRlci1jb2xvcic6IG1ha2VDb2xvckRhcmtlcihjb2xvcikKICAgICAgICB9KTsKICAgICAgICB2YXIgdGV4dCA9ICgwLCBfanF1ZXJ5LmRlZmF1bHQpKCc8c3Bhbj4nKS50ZXh0KGxhYmVsVGV4dCk7CiAgICAgICAgbGFiZWwuYXBwZW5kKGljb24pOwogICAgICAgIGxhYmVsLmFwcGVuZCh0ZXh0KTsKICAgICAgICBqcXVlcnlEaXYuYXBwZW5kKGxhYmVsKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX21ha2VFbXB0eVN0eWxlRnVuY3Rpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tYWtlRW1wdHlTdHlsZUZ1bmN0aW9uKCkgewogICAgICB2YXIgZW1wdHlTdHlsZSA9IF9sb2Rhc2guZGVmYXVsdC5hc3NpZ24oe30sIEVNUFRZX1NUWUxFLCB7CiAgICAgICAgd2VpZ2h0OiB0aGlzLl9saW5lV2VpZ2h0CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZW1wdHlTdHlsZTsKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfbWFrZUNob3JvcGxldGhTdHlsZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tYWtlQ2hvcm9wbGV0aFN0eWxlcigpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB2YXIgZW1wdHlTdHlsZSA9IHRoaXMuX21ha2VFbXB0eVN0eWxlRnVuY3Rpb24oKTsKCiAgICAgIGlmICh0aGlzLl9tZXRyaWNzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsZWFmbGV0U3R5bGVGdW5jdGlvbjogZnVuY3Rpb24gbGVhZmxldFN0eWxlRnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBlbXB0eVN0eWxlKCk7CiAgICAgICAgICB9LAogICAgICAgICAgZ2V0TWlzbWF0Y2hlczogZnVuY3Rpb24gZ2V0TWlzbWF0Y2hlcygpIHsKICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgICAgfSwKICAgICAgICAgIGdldExlYWZsZXRCb3VuZHM6IGZ1bmN0aW9uIGdldExlYWZsZXRCb3VuZHMoKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHZhciBfZ2V0TWluTWF4MiA9IGdldE1pbk1heCh0aGlzLl9tZXRyaWNzKSwKICAgICAgICAgIG1pbiA9IF9nZXRNaW5NYXgyLm1pbiwKICAgICAgICAgIG1heCA9IF9nZXRNaW5NYXgyLm1heDsKCiAgICAgIHZhciBib3VuZHNPZkFsbEZlYXR1cmVzID0gbmV3IF9sZWFmbGV0LmRlZmF1bHQuTGF0TG5nQm91bmRzKCk7CiAgICAgIHJldHVybiB7CiAgICAgICAgbGVhZmxldFN0eWxlRnVuY3Rpb246IGZ1bmN0aW9uIGxlYWZsZXRTdHlsZUZ1bmN0aW9uKGdlb2pzb25GZWF0dXJlKSB7CiAgICAgICAgICB2YXIgbWF0Y2ggPSBnZW9qc29uRmVhdHVyZS5fX2tibkpvaW5lZE1ldHJpYzsKCiAgICAgICAgICBpZiAoIW1hdGNoKSB7CiAgICAgICAgICAgIHJldHVybiBlbXB0eVN0eWxlKCk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGJvdW5kc09mRmVhdHVyZSA9IF9sZWFmbGV0LmRlZmF1bHQuZ2VvSnNvbihnZW9qc29uRmVhdHVyZSkuZ2V0Qm91bmRzKCk7CgogICAgICAgICAgYm91bmRzT2ZBbGxGZWF0dXJlcy5leHRlbmQoYm91bmRzT2ZGZWF0dXJlKTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGZpbGxDb2xvcjogZ2V0Q2hvcm9wbGV0aENvbG9yKG1hdGNoLnZhbHVlLCBtaW4sIG1heCwgX3RoaXM1Ll9jb2xvclJhbXApLAogICAgICAgICAgICB3ZWlnaHQ6IF90aGlzNS5fbGluZVdlaWdodCwKICAgICAgICAgICAgb3BhY2l0eTogMSwKICAgICAgICAgICAgY29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjcKICAgICAgICAgIH07CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogc2hvdWxkIG5vdCBiZSBjYWxsZWQgdW50aWwgZ2V0TGVhZmxldFN0eWxlRnVuY3Rpb24gaGFzIGJlZW4gY2FsbGVkCiAgICAgICAgICogQHJldHVybiB7QXJyYXl9CiAgICAgICAgICovCiAgICAgICAgZ2V0TWlzbWF0Y2hlczogZnVuY3Rpb24gZ2V0TWlzbWF0Y2hlcygpIHsKICAgICAgICAgIHZhciBtaXNtYXRjaGVzID0gX3RoaXM1Ll9tZXRyaWNzLnNsaWNlKCk7CgogICAgICAgICAgX3RoaXM1Ll9zb3J0ZWRGZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7CiAgICAgICAgICAgIHZhciBpbmRleCA9IG1pc21hdGNoZXMuaW5kZXhPZihmZWF0dXJlLl9fa2JuSm9pbmVkTWV0cmljKTsKCiAgICAgICAgICAgIGlmIChpbmRleCA+PSAwKSB7CiAgICAgICAgICAgICAgbWlzbWF0Y2hlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm4gbWlzbWF0Y2hlcy5tYXAoZnVuY3Rpb24gKGIpIHsKICAgICAgICAgICAgcmV0dXJuIGIudGVybTsKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgZ2V0TGVhZmxldEJvdW5kczogZnVuY3Rpb24gZ2V0TGVhZmxldEJvdW5kcygpIHsKICAgICAgICAgIHJldHVybiBib3VuZHNPZkFsbEZlYXR1cmVzLmlzVmFsaWQoKSA/IGJvdW5kc09mQWxsRmVhdHVyZXMgOiBudWxsOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9XSk7CgogIHJldHVybiBDaG9yb3BsZXRoTGF5ZXI7Cn0oX2tpYmFuYV9tYXBfbGF5ZXIuS2liYW5hTWFwTGF5ZXIpOyAvL2xleGljb2dyYXBoaWMgY29tcGFyZQoKCmV4cG9ydHMuZGVmYXVsdCA9IENob3JvcGxldGhMYXllcjsKCmZ1bmN0aW9uIGNvbXBhcmVMZXhpY29ncmFwaGljYWxseSh0ZXJtQSwgdGVybUIpIHsKICB0ZXJtQSA9IHR5cGVvZiB0ZXJtQSA9PT0gJ3N0cmluZycgPyB0ZXJtQSA6IHRlcm1BLnRvU3RyaW5nKCk7CiAgdGVybUIgPSB0eXBlb2YgdGVybUIgPT09ICdzdHJpbmcnID8gdGVybUIgOiB0ZXJtQi50b1N0cmluZygpOwogIHJldHVybiB0ZXJtQS5sb2NhbGVDb21wYXJlKHRlcm1CKTsKfQoKZnVuY3Rpb24gbWFrZUNvbG9yRGFya2VyKGNvbG9yKSB7CiAgdmFyIGFtb3VudCA9IDEuMzsgLy9tYWdpYyBudW1iZXIsIGNhcnJ5IG92ZXIgZnJvbSBlYXJsaWVyCgogIHJldHVybiBfZC5kZWZhdWx0LmhjbChjb2xvcikuZGFya2VyKGFtb3VudCkudG9TdHJpbmcoKTsKfQoKZnVuY3Rpb24gZ2V0TWluTWF4KGRhdGEpIHsKICB2YXIgbWluID0gZGF0YVswXS52YWx1ZTsKICB2YXIgbWF4ID0gZGF0YVswXS52YWx1ZTsKCiAgZm9yICh2YXIgaSA9IDE7IGkgPCBkYXRhLmxlbmd0aDsgaSArPSAxKSB7CiAgICBtaW4gPSBNYXRoLm1pbihkYXRhW2ldLnZhbHVlLCBtaW4pOwogICAgbWF4ID0gTWF0aC5tYXgoZGF0YVtpXS52YWx1ZSwgbWF4KTsKICB9CgogIHJldHVybiB7CiAgICBtaW46IG1pbiwKICAgIG1heDogbWF4CiAgfTsKfQoKZnVuY3Rpb24gZ2V0Q2hvcm9wbGV0aENvbG9yKHZhbHVlLCBtaW4sIG1heCwgY29sb3JSYW1wKSB7CiAgaWYgKG1pbiA9PT0gbWF4KSB7CiAgICByZXR1cm4gY29sb3JVdGlsLmdldENvbG9yKGNvbG9yUmFtcCwgY29sb3JSYW1wLmxlbmd0aCAtIDEpOwogIH0KCiAgdmFyIGZyYWN0aW9uID0gKHZhbHVlIC0gbWluKSAvIChtYXggLSBtaW4pOwogIHZhciBpbmRleCA9IE1hdGgucm91bmQoY29sb3JSYW1wLmxlbmd0aCAqIGZyYWN0aW9uKSAtIDE7CiAgdmFyIGkgPSBNYXRoLm1heChNYXRoLm1pbihjb2xvclJhbXAubGVuZ3RoIC0gMSwgaW5kZXgpLCAwKTsKICByZXR1cm4gY29sb3JVdGlsLmdldENvbG9yKGNvbG9yUmFtcCwgaSk7Cn0KCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cy5kZWZhdWx0Ow=="},null]}