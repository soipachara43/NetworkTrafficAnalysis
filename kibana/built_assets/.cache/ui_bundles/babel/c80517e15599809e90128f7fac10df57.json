{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/plugins/data/public/ui/search_bar/search_bar.js","dependencies":[{"path":"src/plugins/data/public/ui/search_bar/search_bar.js","mtime":1589249550695},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuU2VhcmNoQmFyID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfcmVhY3QgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfY2xhc3NuYW1lcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiY2xhc3NuYW1lcyIpKTsKCnZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3Jlc2l6ZU9ic2VydmVyUG9seWZpbGwgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInJlc2l6ZS1vYnNlcnZlci1wb2x5ZmlsbCIpKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4va2liYW5hX3JlYWN0L3B1YmxpYyIpOwoKdmFyIF9xdWVyeV9iYXJfdG9wX3JvdyA9IHJlcXVpcmUoIi4uL3F1ZXJ5X3N0cmluZ19pbnB1dC9xdWVyeV9iYXJfdG9wX3JvdyIpOwoKdmFyIF8gPSByZXF1aXJlKCIuLiIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogIGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YyKFN5bWJvbC5pdGVyYXRvcikgPT09ICJzeW1ib2wiKSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIF90eXBlb2YyKG9iaik7CiAgICB9OwogIH0gZWxzZSB7CiAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfQoKICByZXR1cm4gX3R5cGVvZihvYmopOwp9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7CiAgdHJ5IHsKICAgIHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsKICAgIHZhciB2YWx1ZSA9IGluZm8udmFsdWU7CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIHJlamVjdChlcnJvcik7CiAgICByZXR1cm47CiAgfQoKICBpZiAoaW5mby5kb25lKSB7CiAgICByZXNvbHZlKHZhbHVlKTsKICB9IGVsc2UgewogICAgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOwogIH0KfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsKICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgdmFyIHNlbGYgPSB0aGlzLAogICAgICAgIGFyZ3MgPSBhcmd1bWVudHM7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7CgogICAgICBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsKICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7CiAgICAgIH0KCiAgICAgIF9uZXh0KHVuZGVmaW5lZCk7CiAgICB9KTsKICB9Owp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICB9Cn0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgcmV0dXJuIENvbnN0cnVjdG9yOwp9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7CiAgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgewogICAgcmV0dXJuIGNhbGw7CiAgfQoKICByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsKfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogICAgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsKICB9OwogIHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7Cn0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgewogIGlmIChzZWxmID09PSB2b2lkIDApIHsKICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7CiAgfQoKICByZXR1cm4gc2VsZjsKfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7CiAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7CiAgfQoKICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsKICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgIHZhbHVlOiBzdWJDbGFzcywKICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgfQogIH0pOwogIGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOwp9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgewogIF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgewogICAgby5fX3Byb3RvX18gPSBwOwogICAgcmV0dXJuIG87CiAgfTsKCiAgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCnZhciBTZWFyY2hCYXJVSSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoU2VhcmNoQmFyVUksIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBTZWFyY2hCYXJVSSgpIHsKICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyOwoKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2VhcmNoQmFyVUkpOwoKICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSBfZ2V0UHJvdG90eXBlT2YoU2VhcmNoQmFyVUkpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzXS5jb25jYXQoYXJncykpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzZXJ2aWNlcyIsIF90aGlzLnByb3BzLmtpYmFuYS5zZXJ2aWNlcyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic2F2ZWRRdWVyeVNlcnZpY2UiLCBfdGhpcy5zZXJ2aWNlcy5kYXRhLnF1ZXJ5LnNhdmVkUXVlcmllcyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmlsdGVyQmFyUmVmIiwgbnVsbCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiZmlsdGVyQmFyV3JhcHBlclJlZiIsIG51bGwpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInN0YXRlIiwgewogICAgICBpc0ZpbHRlcnNWaXNpYmxlOiB0cnVlLAogICAgICBzaG93U2F2ZVF1ZXJ5TW9kYWw6IGZhbHNlLAogICAgICBzaG93U2F2ZU5ld1F1ZXJ5TW9kYWw6IGZhbHNlLAogICAgICBzaG93U2F2ZWRRdWVyeVBvcG92ZXI6IGZhbHNlLAogICAgICBjdXJyZW50UHJvcHM6IF90aGlzLnByb3BzLAogICAgICBxdWVyeTogX3RoaXMucHJvcHMucXVlcnkgPyBfb2JqZWN0U3ByZWFkKHt9LCBfdGhpcy5wcm9wcy5xdWVyeSkgOiB1bmRlZmluZWQsCiAgICAgIGRhdGVSYW5nZUZyb206ICgwLCBfbG9kYXNoLmdldCkoX3RoaXMucHJvcHMsICdkYXRlUmFuZ2VGcm9tJywgJ25vdy0xNW0nKSwKICAgICAgZGF0ZVJhbmdlVG86ICgwLCBfbG9kYXNoLmdldCkoX3RoaXMucHJvcHMsICdkYXRlUmFuZ2VUbycsICdub3cnKQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaXNEaXJ0eSIsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFfdGhpcy5wcm9wcy5zaG93RGF0ZVBpY2tlciAmJiBfdGhpcy5zdGF0ZS5xdWVyeSAmJiBfdGhpcy5wcm9wcy5xdWVyeSkgewogICAgICAgIHJldHVybiBfdGhpcy5zdGF0ZS5xdWVyeS5xdWVyeSAhPT0gX3RoaXMucHJvcHMucXVlcnkucXVlcnk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfdGhpcy5zdGF0ZS5xdWVyeSAmJiBfdGhpcy5wcm9wcy5xdWVyeSAmJiBfdGhpcy5zdGF0ZS5xdWVyeS5xdWVyeSAhPT0gX3RoaXMucHJvcHMucXVlcnkucXVlcnkgfHwgX3RoaXMuc3RhdGUuZGF0ZVJhbmdlRnJvbSAhPT0gX3RoaXMucHJvcHMuZGF0ZVJhbmdlRnJvbSB8fCBfdGhpcy5zdGF0ZS5kYXRlUmFuZ2VUbyAhPT0gX3RoaXMucHJvcHMuZGF0ZVJhbmdlVG87CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzZXRGaWx0ZXJCYXJIZWlnaHQiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGhlaWdodCA9IF90aGlzLmZpbHRlckJhclJlZiAmJiBfdGhpcy5zdGF0ZS5pc0ZpbHRlcnNWaXNpYmxlID8gX3RoaXMuZmlsdGVyQmFyUmVmLmNsaWVudEhlaWdodCA6IDA7CgogICAgICAgIGlmIChfdGhpcy5maWx0ZXJCYXJXcmFwcGVyUmVmKSB7CiAgICAgICAgICBfdGhpcy5maWx0ZXJCYXJXcmFwcGVyUmVmLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAiaGVpZ2h0OiAiLmNvbmNhdChoZWlnaHQsICJweCIpKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicm8iLCBuZXcgX3Jlc2l6ZU9ic2VydmVyUG9seWZpbGwuZGVmYXVsdChfdGhpcy5zZXRGaWx0ZXJCYXJIZWlnaHQpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblNhdmUiLAogICAgLyojX19QVVJFX18qLwogICAgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoc2F2ZWRRdWVyeU1ldGEpIHsKICAgICAgICB2YXIgc2F2ZUFzTmV3LAogICAgICAgICAgICBzYXZlZFF1ZXJ5QXR0cmlidXRlcywKICAgICAgICAgICAgcmVzcG9uc2UsCiAgICAgICAgICAgIF9hcmdzID0gYXJndW1lbnRzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHNhdmVBc05ldyA9IF9hcmdzLmxlbmd0aCA+IDEgJiYgX2FyZ3NbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzFdIDogZmFsc2U7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzLnN0YXRlLnF1ZXJ5KSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgc2F2ZWRRdWVyeUF0dHJpYnV0ZXMgPSB7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiBzYXZlZFF1ZXJ5TWV0YS50aXRsZSwKICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHNhdmVkUXVlcnlNZXRhLmRlc2NyaXB0aW9uLAogICAgICAgICAgICAgICAgICBxdWVyeTogX3RoaXMuc3RhdGUucXVlcnkKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgaWYgKHNhdmVkUXVlcnlNZXRhLnNob3VsZEluY2x1ZGVGaWx0ZXJzKSB7CiAgICAgICAgICAgICAgICAgIHNhdmVkUXVlcnlBdHRyaWJ1dGVzLmZpbHRlcnMgPSBfdGhpcy5wcm9wcy5maWx0ZXJzOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzYXZlZFF1ZXJ5TWV0YS5zaG91bGRJbmNsdWRlVGltZWZpbHRlciAmJiBfdGhpcy5zdGF0ZS5kYXRlUmFuZ2VUbyAhPT0gdW5kZWZpbmVkICYmIF90aGlzLnN0YXRlLmRhdGVSYW5nZUZyb20gIT09IHVuZGVmaW5lZCAmJiBfdGhpcy5wcm9wcy5yZWZyZXNoSW50ZXJ2YWwgIT09IHVuZGVmaW5lZCAmJiBfdGhpcy5wcm9wcy5pc1JlZnJlc2hQYXVzZWQgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICBzYXZlZFF1ZXJ5QXR0cmlidXRlcy50aW1lZmlsdGVyID0gewogICAgICAgICAgICAgICAgICAgIGZyb206IF90aGlzLnN0YXRlLmRhdGVSYW5nZUZyb20sCiAgICAgICAgICAgICAgICAgICAgdG86IF90aGlzLnN0YXRlLmRhdGVSYW5nZVRvLAogICAgICAgICAgICAgICAgICAgIHJlZnJlc2hJbnRlcnZhbDogewogICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IF90aGlzLnByb3BzLnJlZnJlc2hJbnRlcnZhbCwKICAgICAgICAgICAgICAgICAgICAgIHBhdXNlOiBfdGhpcy5wcm9wcy5pc1JlZnJlc2hQYXVzZWQKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDY7CgogICAgICAgICAgICAgICAgaWYgKCEoX3RoaXMucHJvcHMuc2F2ZWRRdWVyeSAmJiAhc2F2ZUFzTmV3KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zYXZlZFF1ZXJ5U2VydmljZS5zYXZlUXVlcnkoc2F2ZWRRdWVyeUF0dHJpYnV0ZXMsIHsKICAgICAgICAgICAgICAgICAgb3ZlcndyaXRlOiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNhdmVkUXVlcnlTZXJ2aWNlLnNhdmVRdWVyeShzYXZlZFF1ZXJ5QXR0cmlidXRlcyk7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICBfdGhpcy5zZXJ2aWNlcy5ub3RpZmljYXRpb25zLnRvYXN0cy5hZGRTdWNjZXNzKCJZb3VyIHF1ZXJ5IFwiIi5jb25jYXQocmVzcG9uc2UuYXR0cmlidXRlcy50aXRsZSwgIlwiIHdhcyBzYXZlZCIpKTsKCiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIHNob3dTYXZlUXVlcnlNb2RhbDogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHNob3dTYXZlTmV3UXVlcnlNb2RhbDogZmFsc2UKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpcy5wcm9wcy5vblNhdmVkKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLnByb3BzLm9uU2F2ZWQocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDIxOwogICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSg2KTsKCiAgICAgICAgICAgICAgICBfdGhpcy5zZXJ2aWNlcy5ub3RpZmljYXRpb25zLnRvYXN0cy5hZGREYW5nZXIoIkFuIGVycm9yIG9jY3VyZWQgd2hpbGUgc2F2aW5nIHlvdXIgcXVlcnk6ICIuY29uY2F0KF9jb250ZXh0LnQwLm1lc3NhZ2UpKTsKCiAgICAgICAgICAgICAgICB0aHJvdyBfY29udGV4dC50MDsKCiAgICAgICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbNiwgMjFdXSk7CiAgICAgIH0pKTsKCiAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkluaXRpYXRlU2F2ZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNob3dTYXZlUXVlcnlNb2RhbDogdHJ1ZQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9uSW5pdGlhdGVTYXZlTmV3IiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2hvd1NhdmVOZXdRdWVyeU1vZGFsOiB0cnVlCiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25RdWVyeUJhckNoYW5nZSIsIGZ1bmN0aW9uIChxdWVyeUFuZERhdGVSYW5nZSkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgcXVlcnk6IHF1ZXJ5QW5kRGF0ZVJhbmdlLnF1ZXJ5LAogICAgICAgIGRhdGVSYW5nZUZyb206IHF1ZXJ5QW5kRGF0ZVJhbmdlLmRhdGVSYW5nZS5mcm9tLAogICAgICAgIGRhdGVSYW5nZVRvOiBxdWVyeUFuZERhdGVSYW5nZS5kYXRlUmFuZ2UudG8KICAgICAgfSk7CgogICAgICBpZiAoX3RoaXMucHJvcHMub25RdWVyeUNoYW5nZSkgewogICAgICAgIF90aGlzLnByb3BzLm9uUXVlcnlDaGFuZ2UocXVlcnlBbmREYXRlUmFuZ2UpOwogICAgICB9CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblF1ZXJ5QmFyU3VibWl0IiwgZnVuY3Rpb24gKHF1ZXJ5QW5kRGF0ZVJhbmdlKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBxdWVyeTogcXVlcnlBbmREYXRlUmFuZ2UucXVlcnksCiAgICAgICAgZGF0ZVJhbmdlRnJvbTogcXVlcnlBbmREYXRlUmFuZ2UuZGF0ZVJhbmdlICYmIHF1ZXJ5QW5kRGF0ZVJhbmdlLmRhdGVSYW5nZS5mcm9tIHx8IF90aGlzLnN0YXRlLmRhdGVSYW5nZUZyb20sCiAgICAgICAgZGF0ZVJhbmdlVG86IHF1ZXJ5QW5kRGF0ZVJhbmdlLmRhdGVSYW5nZSAmJiBxdWVyeUFuZERhdGVSYW5nZS5kYXRlUmFuZ2UudG8gfHwgX3RoaXMuc3RhdGUuZGF0ZVJhbmdlVG8KICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChfdGhpcy5wcm9wcy5vblF1ZXJ5U3VibWl0KSB7CiAgICAgICAgICBfdGhpcy5wcm9wcy5vblF1ZXJ5U3VibWl0KHsKICAgICAgICAgICAgcXVlcnk6IF90aGlzLnN0YXRlLnF1ZXJ5LAogICAgICAgICAgICBkYXRlUmFuZ2U6IHsKICAgICAgICAgICAgICBmcm9tOiBfdGhpcy5zdGF0ZS5kYXRlUmFuZ2VGcm9tLAogICAgICAgICAgICAgIHRvOiBfdGhpcy5zdGF0ZS5kYXRlUmFuZ2VUbwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAib25Mb2FkU2F2ZWRRdWVyeSIsIGZ1bmN0aW9uIChzYXZlZFF1ZXJ5KSB7CiAgICAgIHZhciBkYXRlUmFuZ2VGcm9tID0gKDAsIF9sb2Rhc2guZ2V0KShzYXZlZFF1ZXJ5LCAnYXR0cmlidXRlcy50aW1lZmlsdGVyLmZyb20nLCBfdGhpcy5zdGF0ZS5kYXRlUmFuZ2VGcm9tKTsKICAgICAgdmFyIGRhdGVSYW5nZVRvID0gKDAsIF9sb2Rhc2guZ2V0KShzYXZlZFF1ZXJ5LCAnYXR0cmlidXRlcy50aW1lZmlsdGVyLnRvJywgX3RoaXMuc3RhdGUuZGF0ZVJhbmdlVG8pOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHF1ZXJ5OiBzYXZlZFF1ZXJ5LmF0dHJpYnV0ZXMucXVlcnksCiAgICAgICAgZGF0ZVJhbmdlRnJvbTogZGF0ZVJhbmdlRnJvbSwKICAgICAgICBkYXRlUmFuZ2VUbzogZGF0ZVJhbmdlVG8KICAgICAgfSk7CgogICAgICBpZiAoX3RoaXMucHJvcHMub25TYXZlZFF1ZXJ5VXBkYXRlZCkgewogICAgICAgIF90aGlzLnByb3BzLm9uU2F2ZWRRdWVyeVVwZGF0ZWQoc2F2ZWRRdWVyeSk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhTZWFyY2hCYXJVSSwgW3sKICAgIGtleTogInNob3VsZFJlbmRlclF1ZXJ5QmFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzaG91bGRSZW5kZXJRdWVyeUJhcigpIHsKICAgICAgdmFyIHNob3dEYXRlUGlja2VyID0gdGhpcy5wcm9wcy5zaG93RGF0ZVBpY2tlciB8fCB0aGlzLnByb3BzLnNob3dBdXRvUmVmcmVzaE9ubHk7CiAgICAgIHZhciBzaG93UXVlcnlJbnB1dCA9IHRoaXMucHJvcHMuc2hvd1F1ZXJ5SW5wdXQgJiYgdGhpcy5wcm9wcy5pbmRleFBhdHRlcm5zICYmIHRoaXMuc3RhdGUucXVlcnk7CiAgICAgIHJldHVybiB0aGlzLnByb3BzLnNob3dRdWVyeUJhciAmJiAoc2hvd0RhdGVQaWNrZXIgfHwgc2hvd1F1ZXJ5SW5wdXQpOwogICAgfQogIH0sIHsKICAgIGtleTogInNob3VsZFJlbmRlckZpbHRlckJhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdWxkUmVuZGVyRmlsdGVyQmFyKCkgewogICAgICByZXR1cm4gdGhpcy5wcm9wcy5zaG93RmlsdGVyQmFyICYmIHRoaXMucHJvcHMuZmlsdGVycyAmJiB0aGlzLnByb3BzLmluZGV4UGF0dGVybnMgJiYgKDAsIF9sb2Rhc2guY29tcGFjdCkodGhpcy5wcm9wcy5pbmRleFBhdHRlcm5zKS5sZW5ndGggPiAwOwogICAgfQogICAgLyoKICAgICAqIFRoaXMgRnVuY3Rpb24gaXMgaGVyZSB0byBzaG93IHRoZSB0b2dnbGUgaW4gc2F2ZWQgcXVlcnkgZm9ybQogICAgICogaW4gY2FzZSB5b3UgdGhlIGRhdGUgcmFuZ2UgKGZyb20vdG8pCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic2hvdWxkUmVuZGVyVGltZUZpbHRlckluU2F2ZWRRdWVyeUZvcm0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNob3VsZFJlbmRlclRpbWVGaWx0ZXJJblNhdmVkUXVlcnlGb3JtKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMgPSB0aGlzLnByb3BzLAogICAgICAgICAgZGF0ZVJhbmdlRnJvbSA9IF90aGlzJHByb3BzLmRhdGVSYW5nZUZyb20sCiAgICAgICAgICBkYXRlUmFuZ2VUbyA9IF90aGlzJHByb3BzLmRhdGVSYW5nZVRvLAogICAgICAgICAgc2hvd0RhdGVQaWNrZXIgPSBfdGhpcyRwcm9wcy5zaG93RGF0ZVBpY2tlcjsKICAgICAgcmV0dXJuIHNob3dEYXRlUGlja2VyIHx8ICFzaG93RGF0ZVBpY2tlciAmJiBkYXRlUmFuZ2VGcm9tICE9PSB1bmRlZmluZWQgJiYgZGF0ZVJhbmdlVG8gIT09IHVuZGVmaW5lZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnREaWRNb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7CiAgICAgIGlmICh0aGlzLmZpbHRlckJhclJlZikgewogICAgICAgIHRoaXMuc2V0RmlsdGVyQmFySGVpZ2h0KCk7CiAgICAgICAgdGhpcy5yby5vYnNlcnZlKHRoaXMuZmlsdGVyQmFyUmVmKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImNvbXBvbmVudERpZFVwZGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkVXBkYXRlKCkgewogICAgICBpZiAodGhpcy5maWx0ZXJCYXJSZWYpIHsKICAgICAgICB0aGlzLnNldEZpbHRlckJhckhlaWdodCgpOwogICAgICAgIHRoaXMucm8udW5vYnNlcnZlKHRoaXMuZmlsdGVyQmFyUmVmKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBzYXZlZFF1ZXJ5TWFuYWdlbWVudCA9IHRoaXMuc3RhdGUucXVlcnkgJiYgdGhpcy5wcm9wcy5vbkNsZWFyU2F2ZWRRdWVyeSAmJiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfLlNhdmVkUXVlcnlNYW5hZ2VtZW50Q29tcG9uZW50LCB7CiAgICAgICAgc2hvd1NhdmVRdWVyeTogdGhpcy5wcm9wcy5zaG93U2F2ZVF1ZXJ5LAogICAgICAgIGxvYWRlZFNhdmVkUXVlcnk6IHRoaXMucHJvcHMuc2F2ZWRRdWVyeSwKICAgICAgICBvblNhdmU6IHRoaXMub25Jbml0aWF0ZVNhdmUsCiAgICAgICAgb25TYXZlQXNOZXc6IHRoaXMub25Jbml0aWF0ZVNhdmVOZXcsCiAgICAgICAgb25Mb2FkOiB0aGlzLm9uTG9hZFNhdmVkUXVlcnksCiAgICAgICAgc2F2ZWRRdWVyeVNlcnZpY2U6IHRoaXMuc2F2ZWRRdWVyeVNlcnZpY2UsCiAgICAgICAgb25DbGVhclNhdmVkUXVlcnk6IHRoaXMucHJvcHMub25DbGVhclNhdmVkUXVlcnkKICAgICAgfSk7CgogICAgICB2YXIgcXVlcnlCYXI7CgogICAgICBpZiAodGhpcy5zaG91bGRSZW5kZXJRdWVyeUJhcigpKSB7CiAgICAgICAgcXVlcnlCYXIgPSBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcXVlcnlfYmFyX3RvcF9yb3cuUXVlcnlCYXJUb3BSb3csIHsKICAgICAgICAgIHRpbWVIaXN0b3J5OiB0aGlzLnByb3BzLnRpbWVIaXN0b3J5LAogICAgICAgICAgcXVlcnk6IHRoaXMuc3RhdGUucXVlcnksCiAgICAgICAgICBzY3JlZW5UaXRsZTogdGhpcy5wcm9wcy5zY3JlZW5UaXRsZSwKICAgICAgICAgIG9uU3VibWl0OiB0aGlzLm9uUXVlcnlCYXJTdWJtaXQsCiAgICAgICAgICBpbmRleFBhdHRlcm5zOiB0aGlzLnByb3BzLmluZGV4UGF0dGVybnMsCiAgICAgICAgICBpc0xvYWRpbmc6IHRoaXMucHJvcHMuaXNMb2FkaW5nLAogICAgICAgICAgcHJlcGVuZDogdGhpcy5wcm9wcy5zaG93RmlsdGVyQmFyID8gc2F2ZWRRdWVyeU1hbmFnZW1lbnQgOiB1bmRlZmluZWQsCiAgICAgICAgICBzaG93RGF0ZVBpY2tlcjogdGhpcy5wcm9wcy5zaG93RGF0ZVBpY2tlciwKICAgICAgICAgIGRhdGVSYW5nZUZyb206IHRoaXMuc3RhdGUuZGF0ZVJhbmdlRnJvbSwKICAgICAgICAgIGRhdGVSYW5nZVRvOiB0aGlzLnN0YXRlLmRhdGVSYW5nZVRvLAogICAgICAgICAgaXNSZWZyZXNoUGF1c2VkOiB0aGlzLnByb3BzLmlzUmVmcmVzaFBhdXNlZCwKICAgICAgICAgIHJlZnJlc2hJbnRlcnZhbDogdGhpcy5wcm9wcy5yZWZyZXNoSW50ZXJ2YWwsCiAgICAgICAgICBzaG93QXV0b1JlZnJlc2hPbmx5OiB0aGlzLnByb3BzLnNob3dBdXRvUmVmcmVzaE9ubHksCiAgICAgICAgICBzaG93UXVlcnlJbnB1dDogdGhpcy5wcm9wcy5zaG93UXVlcnlJbnB1dCwKICAgICAgICAgIG9uUmVmcmVzaDogdGhpcy5wcm9wcy5vblJlZnJlc2gsCiAgICAgICAgICBvblJlZnJlc2hDaGFuZ2U6IHRoaXMucHJvcHMub25SZWZyZXNoQ2hhbmdlLAogICAgICAgICAgb25DaGFuZ2U6IHRoaXMub25RdWVyeUJhckNoYW5nZSwKICAgICAgICAgIGlzRGlydHk6IHRoaXMuaXNEaXJ0eSgpLAogICAgICAgICAgY3VzdG9tU3VibWl0QnV0dG9uOiB0aGlzLnByb3BzLmN1c3RvbVN1Ym1pdEJ1dHRvbiA/IHRoaXMucHJvcHMuY3VzdG9tU3VibWl0QnV0dG9uIDogdW5kZWZpbmVkLAogICAgICAgICAgZGF0YVRlc3RTdWJqOiB0aGlzLnByb3BzLmRhdGFUZXN0U3ViagogICAgICAgIH0pOwogICAgICB9CgogICAgICB2YXIgZmlsdGVyQmFyOwoKICAgICAgaWYgKHRoaXMuc2hvdWxkUmVuZGVyRmlsdGVyQmFyKCkpIHsKICAgICAgICB2YXIgZmlsdGVyR3JvdXBDbGFzc2VzID0gKDAsIF9jbGFzc25hbWVzLmRlZmF1bHQpKCdnbG9iYWxGaWx0ZXJHcm91cF9fd3JhcHBlcicsIHsKICAgICAgICAgICdnbG9iYWxGaWx0ZXJHcm91cF9fd3JhcHBlci1pc1Zpc2libGUnOiB0aGlzLnN0YXRlLmlzRmlsdGVyc1Zpc2libGUKICAgICAgICB9KTsKICAgICAgICBmaWx0ZXJCYXIgPSBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgaWQ6ICJHbG9iYWxGaWx0ZXJHcm91cCIsCiAgICAgICAgICByZWY6IGZ1bmN0aW9uIHJlZihub2RlKSB7CiAgICAgICAgICAgIF90aGlzMi5maWx0ZXJCYXJXcmFwcGVyUmVmID0gbm9kZTsKICAgICAgICAgIH0sCiAgICAgICAgICBjbGFzc05hbWU6IGZpbHRlckdyb3VwQ2xhc3NlcwogICAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICByZWY6IGZ1bmN0aW9uIHJlZihub2RlKSB7CiAgICAgICAgICAgIF90aGlzMi5maWx0ZXJCYXJSZWYgPSBub2RlOwogICAgICAgICAgfQogICAgICAgIH0sIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF8uRmlsdGVyQmFyLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJnbG9iYWxGaWx0ZXJHcm91cF9fZmlsdGVyQmFyIiwKICAgICAgICAgIGZpbHRlcnM6IHRoaXMucHJvcHMuZmlsdGVycywKICAgICAgICAgIG9uRmlsdGVyc1VwZGF0ZWQ6IHRoaXMucHJvcHMub25GaWx0ZXJzVXBkYXRlZCwKICAgICAgICAgIGluZGV4UGF0dGVybnM6IHRoaXMucHJvcHMuaW5kZXhQYXR0ZXJucwogICAgICAgIH0pKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogImdsb2JhbFF1ZXJ5QmFyIgogICAgICB9LCBxdWVyeUJhciwgZmlsdGVyQmFyLCB0aGlzLnN0YXRlLnNob3dTYXZlUXVlcnlNb2RhbCA/IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF8uU2F2ZVF1ZXJ5Rm9ybSwgewogICAgICAgIHNhdmVkUXVlcnk6IHRoaXMucHJvcHMuc2F2ZWRRdWVyeSA/IHRoaXMucHJvcHMuc2F2ZWRRdWVyeS5hdHRyaWJ1dGVzIDogdW5kZWZpbmVkLAogICAgICAgIHNhdmVkUXVlcnlTZXJ2aWNlOiB0aGlzLnNhdmVkUXVlcnlTZXJ2aWNlLAogICAgICAgIG9uU2F2ZTogdGhpcy5vblNhdmUsCiAgICAgICAgb25DbG9zZTogZnVuY3Rpb24gb25DbG9zZSgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuc2V0U3RhdGUoewogICAgICAgICAgICBzaG93U2F2ZVF1ZXJ5TW9kYWw6IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHNob3dGaWx0ZXJPcHRpb246IHRoaXMucHJvcHMuc2hvd0ZpbHRlckJhciwKICAgICAgICBzaG93VGltZUZpbHRlck9wdGlvbjogdGhpcy5zaG91bGRSZW5kZXJUaW1lRmlsdGVySW5TYXZlZFF1ZXJ5Rm9ybSgpCiAgICAgIH0pIDogbnVsbCwgdGhpcy5zdGF0ZS5zaG93U2F2ZU5ld1F1ZXJ5TW9kYWwgPyBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfLlNhdmVRdWVyeUZvcm0sIHsKICAgICAgICBzYXZlZFF1ZXJ5U2VydmljZTogdGhpcy5zYXZlZFF1ZXJ5U2VydmljZSwKICAgICAgICBvblNhdmU6IGZ1bmN0aW9uIG9uU2F2ZShzYXZlZFF1ZXJ5TWV0YSkgewogICAgICAgICAgcmV0dXJuIF90aGlzMi5vblNhdmUoc2F2ZWRRdWVyeU1ldGEsIHRydWUpOwogICAgICAgIH0sCiAgICAgICAgb25DbG9zZTogZnVuY3Rpb24gb25DbG9zZSgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuc2V0U3RhdGUoewogICAgICAgICAgICBzaG93U2F2ZU5ld1F1ZXJ5TW9kYWw6IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHNob3dGaWx0ZXJPcHRpb246IHRoaXMucHJvcHMuc2hvd0ZpbHRlckJhciwKICAgICAgICBzaG93VGltZUZpbHRlck9wdGlvbjogdGhpcy5zaG91bGRSZW5kZXJUaW1lRmlsdGVySW5TYXZlZFF1ZXJ5Rm9ybSgpCiAgICAgIH0pIDogbnVsbCk7CiAgICB9CiAgfV0sIFt7CiAgICBrZXk6ICJnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhuZXh0UHJvcHMsIHByZXZTdGF0ZSkgewogICAgICBpZiAoKDAsIF9sb2Rhc2guaXNFcXVhbCkocHJldlN0YXRlLmN1cnJlbnRQcm9wcywgbmV4dFByb3BzKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgbmV4dFF1ZXJ5ID0gbnVsbDsKCiAgICAgIGlmIChuZXh0UHJvcHMucXVlcnkgJiYgbmV4dFByb3BzLnF1ZXJ5LnF1ZXJ5ICE9PSAoMCwgX2xvZGFzaC5nZXQpKHByZXZTdGF0ZSwgJ2N1cnJlbnRQcm9wcy5xdWVyeS5xdWVyeScpKSB7CiAgICAgICAgbmV4dFF1ZXJ5ID0gewogICAgICAgICAgcXVlcnk6IG5leHRQcm9wcy5xdWVyeS5xdWVyeSwKICAgICAgICAgIGxhbmd1YWdlOiBuZXh0UHJvcHMucXVlcnkubGFuZ3VhZ2UKICAgICAgICB9OwogICAgICB9IGVsc2UgaWYgKG5leHRQcm9wcy5xdWVyeSAmJiBwcmV2U3RhdGUucXVlcnkgJiYgbmV4dFByb3BzLnF1ZXJ5Lmxhbmd1YWdlICE9PSBwcmV2U3RhdGUucXVlcnkubGFuZ3VhZ2UpIHsKICAgICAgICBuZXh0UXVlcnkgPSB7CiAgICAgICAgICBxdWVyeTogJycsCiAgICAgICAgICBsYW5ndWFnZTogbmV4dFByb3BzLnF1ZXJ5Lmxhbmd1YWdlCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgdmFyIG5leHREYXRlUmFuZ2UgPSBudWxsOwoKICAgICAgaWYgKG5leHRQcm9wcy5kYXRlUmFuZ2VGcm9tICE9PSAoMCwgX2xvZGFzaC5nZXQpKHByZXZTdGF0ZSwgJ2N1cnJlbnRQcm9wcy5kYXRlUmFuZ2VGcm9tJykgfHwgbmV4dFByb3BzLmRhdGVSYW5nZVRvICE9PSAoMCwgX2xvZGFzaC5nZXQpKHByZXZTdGF0ZSwgJ2N1cnJlbnRQcm9wcy5kYXRlUmFuZ2VUbycpKSB7CiAgICAgICAgbmV4dERhdGVSYW5nZSA9IHsKICAgICAgICAgIGRhdGVSYW5nZUZyb206IG5leHRQcm9wcy5kYXRlUmFuZ2VGcm9tLAogICAgICAgICAgZGF0ZVJhbmdlVG86IG5leHRQcm9wcy5kYXRlUmFuZ2VUbwogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHZhciBuZXh0U3RhdGUgPSB7CiAgICAgICAgY3VycmVudFByb3BzOiBuZXh0UHJvcHMKICAgICAgfTsKCiAgICAgIGlmIChuZXh0UXVlcnkpIHsKICAgICAgICBuZXh0U3RhdGUucXVlcnkgPSBuZXh0UXVlcnk7CiAgICAgIH0KCiAgICAgIGlmIChuZXh0RGF0ZVJhbmdlKSB7CiAgICAgICAgbmV4dFN0YXRlLmRhdGVSYW5nZUZyb20gPSBuZXh0RGF0ZVJhbmdlLmRhdGVSYW5nZUZyb207CiAgICAgICAgbmV4dFN0YXRlLmRhdGVSYW5nZVRvID0gbmV4dERhdGVSYW5nZS5kYXRlUmFuZ2VUbzsKICAgICAgfQoKICAgICAgcmV0dXJuIG5leHRTdGF0ZTsKICAgIH0KICAgIC8qCiAgICAgS2VlcCB0aGUgImRyYWZ0IiB2YWx1ZSBpbiBsb2NhbCBzdGF0ZSB1bnRpbCB0aGUgdXNlciBhY3R1YWxseSBzdWJtaXRzIHRoZSBxdWVyeS4gVGhlcmUgYXJlIGEgY291cGxlIGFkdmFudGFnZXM6CiAgICAgICAxLiBFYWNoIGFwcCBkb2Vzbid0IGhhdmUgdG8gbWFpbnRhaW4gaXRzIG93biAiZHJhZnQiIHZhbHVlIGlmIGl0IHdhbnRzIHRvIHB1dCBvZmYgdXBkYXRpbmcgdGhlIHF1ZXJ5IGluIGFwcCBzdGF0ZQogICAgICB1bnRpbCB0aGUgdXNlciBtYW51YWxseSBzdWJtaXRzIHRoZWlyIGNoYW5nZXMuIE1vc3QgYXBwcyBoYXZlIHdhdGNoZXMgb24gdGhlIHF1ZXJ5IHZhbHVlIGluIGFwcCBzdGF0ZSBzbyB3ZSBkb24ndAogICAgICB3YW50IHRvIHRyaWdnZXIgdGhvc2Ugb24gZXZlcnkga2V5cHJlc3MuIEFsc28sIHNvbWUgYXBwcyAoZS5nLiBkYXNoYm9hcmQpIGFscmVhZHkganVnZ2xlIG11bHRpcGxlIHF1ZXJ5IHZhbHVlcywKICAgICAgZWFjaCB3aXRoIHNsaWdodGx5IGRpZmZlcmVudCBzZW1hbnRpY3MgYW5kIEknZCByYXRoZXIgbm90IGFkZCB5ZXQgYW5vdGhlciB2YXJpYWJsZSB0byB0aGUgbWl4LgogICAgICAgMi4gQ2hhbmdlcyB0byB0aGUgbG9jYWwgY29tcG9uZW50IHN0YXRlIHdvbid0IHRyaWdnZXIgYW4gQW5ndWxhciBkaWdlc3QgY3ljbGUuIFRyaWdnZXJpbmcgZGlnZXN0IGN5Y2xlcyBvbiBldmVyeQogICAgICBrZXlwcmVzcyBoYXMgYmVlbiBhIG1ham9yIHNvdXJjZSBvZiBwZXJmb3JtYW5jZSBpc3N1ZXMgZm9yIHVzIGluIHByZXZpb3VzIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgcXVlcnkgYmFyLgogICAgICBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsYXN0aWMva2liYW5hL2lzc3Vlcy8xNDA4NgogICAgKi8KCiAgfV0pOwoKICByZXR1cm4gU2VhcmNoQmFyVUk7Cn0oX3JlYWN0Mi5Db21wb25lbnQpOwoKX2RlZmluZVByb3BlcnR5KFNlYXJjaEJhclVJLCAiZGVmYXVsdFByb3BzIiwgewogIHNob3dRdWVyeUJhcjogdHJ1ZSwKICBzaG93RmlsdGVyQmFyOiB0cnVlLAogIHNob3dEYXRlUGlja2VyOiB0cnVlLAogIHNob3dBdXRvUmVmcmVzaE9ubHk6IGZhbHNlCn0pOwoKdmFyIFNlYXJjaEJhciA9ICgwLCBfcmVhY3QuaW5qZWN0STE4bikoKDAsIF9wdWJsaWMud2l0aEtpYmFuYSkoU2VhcmNoQmFyVUkpKTsKZXhwb3J0cy5TZWFyY2hCYXIgPSBTZWFyY2hCYXI7"},null]}