{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/plugins/data/public/search/aggs/buckets/lib/time_buckets/time_buckets.js","dependencies":[{"path":"src/plugins/data/public/search/aggs/buckets/lib/time_buckets/time_buckets.js","mtime":1589249550651},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlRpbWVCdWNrZXRzID0gdm9pZCAwOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfbW9tZW50ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJtb21lbnQiKSk7Cgp2YXIgX2NvbW1vbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uL2NvbW1vbiIpOwoKdmFyIF9jYWxjX2F1dG9faW50ZXJ2YWwgPSByZXF1aXJlKCIuL2NhbGNfYXV0b19pbnRlcnZhbCIpOwoKdmFyIF9jYWxjX2VzX2ludGVydmFsID0gcmVxdWlyZSgiLi9jYWxjX2VzX2ludGVydmFsIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICB9Cn0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgcmV0dXJuIENvbnN0cnVjdG9yOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gaXNPYmplY3QobykgewogIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuaXNPYmplY3Qobyk7Cn0KCmZ1bmN0aW9uIGlzU3RyaW5nKHMpIHsKICByZXR1cm4gX2xvZGFzaC5kZWZhdWx0LmlzU3RyaW5nKHMpOwp9CgpmdW5jdGlvbiBpc1ZhbGlkTW9tZW50KG0pIHsKICByZXR1cm4gbSAmJiAnaXNWYWxpZCcgaW4gbSAmJiBtLmlzVmFsaWQoKTsKfQovKioKICogSGVscGVyIGNsYXNzIGZvciB3cmFwcGluZyB0aGUgY29uY2VwdCBvZiBhbiAiSW50ZXJ2YWwiLAogKiB3aGljaCBkZXNjcmliZXMgYSB0aW1lc3BhbiB0aGF0IHdpbGwgc2VwYXJhdGUgbW9tZW50cy4KICoKICogQHBhcmFtIHtzdGF0ZX0gb2JqZWN0IC0gb25lIG9mICIiCiAqIEBwYXJhbSB7W3R5cGVdfSBkaXNwbGF5IFtkZXNjcmlwdGlvbl0KICovCgoKdmFyIFRpbWVCdWNrZXRzID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgX2NyZWF0ZUNsYXNzKFRpbWVCdWNrZXRzLCBudWxsLCBbewogICAga2V5OiAiX19jYWNoZWRfXyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX19jYWNoZWRfXyhzZWxmKSB7CiAgICAgIHZhciBjYWNoZSA9IHt9OwogICAgICB2YXIgc2FtZU1vbWVudCA9IHNhbWUoX21vbWVudC5kZWZhdWx0LmlzTW9tZW50KTsKICAgICAgdmFyIHNhbWVEdXJhdGlvbiA9IHNhbWUoX21vbWVudC5kZWZhdWx0LmlzRHVyYXRpb24pOwogICAgICB2YXIgZGVzYyA9IHsKICAgICAgICBfX2NhY2hlZF9fOiB7CiAgICAgICAgICB2YWx1ZTogc2VsZgogICAgICAgIH0KICAgICAgfTsKICAgICAgdmFyIGJyZWFrZXJzID0gewogICAgICAgIHNldEJvdW5kczogJ2JvdW5kcycsCiAgICAgICAgY2xlYXJCb3VuZHM6ICdib3VuZHMnLAogICAgICAgIHNldEludGVydmFsOiAnaW50ZXJ2YWwnCiAgICAgIH07CiAgICAgIHZhciByZXNvdXJjZXMgPSB7CiAgICAgICAgYm91bmRzOiB7CiAgICAgICAgICBzZXR1cDogZnVuY3Rpb24gc2V0dXAoKSB7CiAgICAgICAgICAgIHJldHVybiBbc2VsZi5fbGIsIHNlbGYuX3ViXTsKICAgICAgICAgIH0sCiAgICAgICAgICBjaGFuZ2VzOiBmdW5jdGlvbiBjaGFuZ2VzKHByZXYpIHsKICAgICAgICAgICAgcmV0dXJuICFzYW1lTW9tZW50KHByZXZbMF0sIHNlbGYuX2xiKSB8fCAhc2FtZU1vbWVudChwcmV2WzFdLCBzZWxmLl91Yik7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBpbnRlcnZhbDogewogICAgICAgICAgc2V0dXA6IGZ1bmN0aW9uIHNldHVwKCkgewogICAgICAgICAgICByZXR1cm4gc2VsZi5faTsKICAgICAgICAgIH0sCiAgICAgICAgICBjaGFuZ2VzOiBmdW5jdGlvbiBjaGFuZ2VzKHByZXYpIHsKICAgICAgICAgICAgcmV0dXJuICFzYW1lRHVyYXRpb24ocHJldiwgc2VsZi5faSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwoKICAgICAgZnVuY3Rpb24gY2FjaGVkR2V0dGVyKHByb3ApIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICAgICAgICBpZiAoY2FjaGUuaGFzT3duUHJvcGVydHkocHJvcCkpIHsKICAgICAgICAgICAgICByZXR1cm4gY2FjaGVbcHJvcF07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBjYWNoZVtwcm9wXSA9IHNlbGZbcHJvcF0uYXBwbHkoc2VsZiwgYXJndW1lbnRzKTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CgogICAgICBmdW5jdGlvbiBjYWNoZUJyZWFrZXIocHJvcCkgewogICAgICAgIHZhciByZXNvdXJjZSA9IHJlc291cmNlc1ticmVha2Vyc1twcm9wXV07CiAgICAgICAgdmFyIHNldHVwID0gcmVzb3VyY2Uuc2V0dXA7CiAgICAgICAgdmFyIGNoYW5nZXMgPSByZXNvdXJjZS5jaGFuZ2VzOwogICAgICAgIHZhciBmbiA9IHNlbGZbcHJvcF07CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHsKICAgICAgICAgICAgdmFyIHByZXYgPSBzZXR1cC5jYWxsKHNlbGYpOwoKICAgICAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgICAgICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHJldCA9IGZuLmFwcGx5LmFwcGx5KGZuLCBbc2VsZl0uY29uY2F0KGFyZ3MpKTsKCiAgICAgICAgICAgIGlmIChjaGFuZ2VzLmNhbGwoc2VsZiwgcHJldikpIHsKICAgICAgICAgICAgICBjYWNoZSA9IHt9OwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gcmV0OwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHNhbWUoY2hlY2tUeXBlKSB7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICBpZiAoYSA9PT0gYikgcmV0dXJuIHRydWU7CiAgICAgICAgICBpZiAoY2hlY2tUeXBlKGEpID09PSBjaGVja1R5cGUoYikpIHJldHVybiArYSA9PT0gK2I7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgX2xvZGFzaC5kZWZhdWx0LmZvck93bihUaW1lQnVja2V0cy5wcm90b3R5cGUsIGZ1bmN0aW9uIChmbiwgcHJvcCkgewogICAgICAgIGlmICghcHJvcCB8fCBwcm9wWzBdID09PSAnXycpIHJldHVybjsKCiAgICAgICAgaWYgKGJyZWFrZXJzLmhhc093blByb3BlcnR5KHByb3ApKSB7CiAgICAgICAgICBkZXNjW3Byb3BdID0gY2FjaGVCcmVha2VyKHByb3ApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkZXNjW3Byb3BdID0gY2FjaGVkR2V0dGVyKHByb3ApOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICByZXR1cm4gT2JqZWN0LmNyZWF0ZShzZWxmLCBkZXNjKTsKICAgIH0KICB9XSk7CgogIGZ1bmN0aW9uIFRpbWVCdWNrZXRzKF9yZWYpIHsKICAgIHZhciB1aVNldHRpbmdzID0gX3JlZi51aVNldHRpbmdzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUaW1lQnVja2V0cyk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJnZXRDb25maWciLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiX2xiIiwgbnVsbCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfdWIiLCBudWxsKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIl9vcmlnaW5hbEludGVydmFsIiwgbnVsbCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfaSIsIHZvaWQgMCk7CgogICAgdGhpcy5nZXRDb25maWcgPSBmdW5jdGlvbiAoa2V5KSB7CiAgICAgIHJldHVybiB1aVNldHRpbmdzLmdldChrZXkpOwogICAgfTsKCiAgICByZXR1cm4gVGltZUJ1Y2tldHMuX19jYWNoZWRfXyh0aGlzKTsKICB9CiAgLyoqCiAgICogR2V0IGEgbW9tZW50IGR1cmF0aW9uIG9iamVjdCByZXByZXNlbnRpbmcKICAgKiB0aGUgZGlzdGFuY2UgYmV0d2VlbiB0aGUgYm91bmRzLCBpZiB0aGUgYm91bmRzCiAgICogYXJlIHNldC4KICAgKgogICAqIEByZXR1cm4ge21vbWVudC5kdXJhdGlvbnx1bmRlZmluZWR9CiAgICovCgoKICBfY3JlYXRlQ2xhc3MoVGltZUJ1Y2tldHMsIFt7CiAgICBrZXk6ICJnZXREdXJhdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RHVyYXRpb24oKSB7CiAgICAgIGlmICh0aGlzLl91YiA9PT0gbnVsbCB8fCB0aGlzLl9sYiA9PT0gbnVsbCB8fCAhdGhpcy5oYXNCb3VuZHMoKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGRpZmZlcmVuY2UgPSB0aGlzLl91YiAtIHRoaXMuX2xiOwogICAgICByZXR1cm4gX21vbWVudC5kZWZhdWx0LmR1cmF0aW9uKGRpZmZlcmVuY2UsICdtcycpOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIGJvdW5kcyB0aGF0IHRoZXNlIGJ1Y2tldHMgYXJlIGV4cGVjdGVkIHRvIGNvdmVyLgogICAgICogVGhpcyBpcyByZXF1aXJlZCB0byBzdXBwb3J0IGludGVydmFsICJhdXRvIiBhcyB3ZWxsCiAgICAgKiBhcyBpbnRlcnZhbCBzY2FsaW5nLgogICAgICoKICAgICAqIEBwYXJhbSB7b2JqZWN0fSBpbnB1dCAtIGFuIG9iamVjdCB3aXRoIHByb3BlcnRpZXMgbWluIGFuZCBtYXgsCiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgcmVwcmVzZW50aW5nIHRoZSBlZGdlcyBmb3IgdGhlIHRpbWUgc3BhbgogICAgICogICAgICAgICAgICAgICAgICAgICAgIHdlIHNob3VsZCBjb3ZlcgogICAgICoKICAgICAqIEByZXR1cm5zIHt1bmRlZmluZWR9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic2V0Qm91bmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRCb3VuZHMoaW5wdXQpIHsKICAgICAgaWYgKCFpbnB1dCkgcmV0dXJuIHRoaXMuY2xlYXJCb3VuZHMoKTsKICAgICAgdmFyIGJvdW5kczsKCiAgICAgIGlmIChfbG9kYXNoLmRlZmF1bHQuaXNQbGFpbk9iamVjdChpbnB1dCkgJiYgIUFycmF5LmlzQXJyYXkoaW5wdXQpKSB7CiAgICAgICAgLy8gYWNjZXB0IHRoZSByZXNwb25zZSBmcm9tIHRpbWVmaWx0ZXIuZ2V0QWN0aXZlQm91bmRzKCkKICAgICAgICBib3VuZHMgPSBbaW5wdXQubWluLCBpbnB1dC5tYXhdOwogICAgICB9IGVsc2UgewogICAgICAgIGJvdW5kcyA9IEFycmF5LmlzQXJyYXkoaW5wdXQpID8gaW5wdXQgOiBbXTsKICAgICAgfQoKICAgICAgdmFyIG1vbWVudHMgPSAoMCwgX2xvZGFzaC5kZWZhdWx0KShib3VuZHMpLm1hcChfbG9kYXNoLmRlZmF1bHQuYXJ5KF9tb21lbnQuZGVmYXVsdCwgMSkpLnNvcnRCeShOdW1iZXIpOwogICAgICB2YXIgdmFsaWQgPSBtb21lbnRzLnNpemUoKSA9PT0gMiAmJiBtb21lbnRzLmV2ZXJ5KGlzVmFsaWRNb21lbnQpOwoKICAgICAgaWYgKCF2YWxpZCkgewogICAgICAgIHRoaXMuY2xlYXJCb3VuZHMoKTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgYm91bmRzIHNldDogJyArIGlucHV0KTsKICAgICAgfQoKICAgICAgdGhpcy5fbGIgPSBtb21lbnRzLnNoaWZ0KCk7CiAgICAgIHRoaXMuX3ViID0gbW9tZW50cy5wb3AoKTsKICAgICAgdmFyIGR1cmF0aW9uID0gdGhpcy5nZXREdXJhdGlvbigpOwoKICAgICAgaWYgKCFkdXJhdGlvbiB8fCBkdXJhdGlvbi5hc1NlY29uZHMoKSA8IDApIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnRlcnZhbHMgbXVzdCBiZSBwb3NpdGl2ZScpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENsZWFyIHRoZSBzdG9yZWQgYm91bmRzCiAgICAgKgogICAgICogQHJldHVybiB7dW5kZWZpbmVkfQogICAgICovCgogIH0sIHsKICAgIGtleTogImNsZWFyQm91bmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhckJvdW5kcygpIHsKICAgICAgdGhpcy5fbGIgPSB0aGlzLl91YiA9IG51bGw7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIHRvIHNlZSBpZiB3ZSBoYXZlIHJlY2VpdmVkIGJvdW5kcyB5ZXQKICAgICAqCiAgICAgKiBAcmV0dXJuIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogImhhc0JvdW5kcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzQm91bmRzKCkgewogICAgICByZXR1cm4gaXNWYWxpZE1vbWVudCh0aGlzLl91YikgJiYgaXNWYWxpZE1vbWVudCh0aGlzLl9sYik7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY3VycmVudCBib3VuZHMsIGlmIHdlIGhhdmUgYW55LgogICAgICoKICAgICAqIFRISVMgRE9FUyBOT1QgQ0xPTkUgVEhFIEJPVU5EUywgc28gZWRpdGluZyB0aGVtCiAgICAgKiBtYXkgaGF2ZSB1bmV4cGVjdGVkIHNpZGUtZWZmZWN0cy4gQWx3YXlzCiAgICAgKiBjYWxsIGJvdW5kcy5taW4uY2xvbmUoKSBiZWZvcmUgZWRpdGluZwogICAgICoKICAgICAqIEByZXR1cm4ge29iamVjdHx1bmRlZmluZWR9IC0gSWYgYm91bmRzIGFyZSBub3QgZGVmaW5lZCwgdGhpcwogICAgICogICAgICAgICAgICAgICAgICAgICAgcmV0dXJucyB1bmRlZmluZWQsIGVsc2UgaXQgcmV0dXJucyB0aGUgYm91bmRzCiAgICAgKiAgICAgICAgICAgICAgICAgICAgICBmb3IgdGhlc2UgYnVja2V0cy4gVGhpcyBvYmplY3QgaGFzIHR3byBwcm9wcywKICAgICAqICAgICAgICAgICAgICAgICAgICAgIG1pbiBhbmQgbWF4LiBFYWNoIHByb3BlcnR5IHdpbGwgYmUgYSBtb21lbnQoKQogICAgICogICAgICAgICAgICAgICAgICAgICAgb2JqZWN0CiAgICAgKgogICAgICovCgogIH0sIHsKICAgIGtleTogImdldEJvdW5kcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Qm91bmRzKCkgewogICAgICBpZiAoIXRoaXMuaGFzQm91bmRzKCkpIHJldHVybjsKICAgICAgcmV0dXJuIHsKICAgICAgICBtaW46IHRoaXMuX2xiLAogICAgICAgIG1heDogdGhpcy5fdWIKICAgICAgfTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBpbnRlcnZhbCBhdCB3aGljaCBidWNrZXRzIHNob3VsZCBiZQogICAgICogZ2VuZXJhdGVkLgogICAgICoKICAgICAqIElucHV0IGNhbiBiZSBvbmUgb2YgdGhlIGZvbGxvd2luZzoKICAgICAqICAtIEFueSBvYmplY3QgZnJvbSBzcmMvbGVnYWN5L3VpL2FnZ190eXBlcy5qcwogICAgICogIC0gImF1dG8iCiAgICAgKiAgLSBQYXNzIGEgdmFsaWQgbW9tZW50IHVuaXQKICAgICAqICAtIGEgbW9tZW50LmR1cmF0aW9uIG9iamVjdC4KICAgICAqCiAgICAgKiBAcGFyYW0ge29iamVjdHxzdHJpbmd8bW9tZW50LmR1cmF0aW9ufSBpbnB1dCAtIHNlZSBkZXNjCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic2V0SW50ZXJ2YWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEludGVydmFsKGlucHV0KSB7CiAgICAgIHZhciBpbnRlcnZhbCA9IGlucHV0OyAvLyBzZWxlY3Rpb24gb2JqZWN0IC0+IHZhbAoKICAgICAgaWYgKGlzT2JqZWN0KGlucHV0KSAmJiAhX21vbWVudC5kZWZhdWx0LmlzRHVyYXRpb24oaW5wdXQpKSB7CiAgICAgICAgaW50ZXJ2YWwgPSBpbnB1dC52YWw7CiAgICAgIH0KCiAgICAgIGlmICghaW50ZXJ2YWwgfHwgaW50ZXJ2YWwgPT09ICdhdXRvJykgewogICAgICAgIHRoaXMuX2kgPSAnYXV0byc7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoaXNTdHJpbmcoaW50ZXJ2YWwpKSB7CiAgICAgICAgaW5wdXQgPSBpbnRlcnZhbDsgLy8gUHJlc2VydmUgdGhlIG9yaWdpbmFsIHVuaXRzIGJlY2F1c2UgdGhleSdyZSBsb3N0IHdoZW4gdGhlIGludGVydmFsIGlzIGNvbnZlcnRlZCB0byBhCiAgICAgICAgLy8gbW9tZW50IGR1cmF0aW9uIG9iamVjdC4KCiAgICAgICAgdGhpcy5fb3JpZ2luYWxJbnRlcnZhbCA9IGlucHV0OwogICAgICAgIGludGVydmFsID0gKDAsIF9jb21tb24ucGFyc2VJbnRlcnZhbCkoaW50ZXJ2YWwpOwoKICAgICAgICBpZiAoaW50ZXJ2YWwgPT09IG51bGwgfHwgK2ludGVydmFsID09PSAwKSB7CiAgICAgICAgICBpbnRlcnZhbCA9IG51bGw7CiAgICAgICAgfQogICAgICB9IC8vIGlmIHRoZSB2YWx1ZSB3YXNuJ3QgY29udmVydGVkIHRvIGEgZHVyYXRpb24sIGFuZCBpc24ndAogICAgICAvLyBhbHJlYWR5IGEgZHVyYXRpb24sIHdlIGhhdmUgYSBwcm9ibGVtCgoKICAgICAgaWYgKCFfbW9tZW50LmRlZmF1bHQuaXNEdXJhdGlvbihpbnRlcnZhbCkpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCciJyArIGlucHV0ICsgJyIgaXMgbm90IGEgdmFsaWQgaW50ZXJ2YWwuJyk7CiAgICAgIH0KCiAgICAgIHRoaXMuX2kgPSBpbnRlcnZhbDsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBpbnRlcnZhbCBmb3IgdGhlIGJ1Y2tldHMuIElmIHRoZQogICAgICogbnVtYmVyIG9mIGJ1Y2tldHMgY3JlYXRlZCBieSB0aGUgaW50ZXJ2YWwgc2V0CiAgICAgKiBpcyBsYXJnZXIgdGhhbiBjb25maWc6aGlzdG9ncmFtOm1heEJhcnMgdGhlbiB0aGUKICAgICAqIGludGVydmFsIHdpbGwgYmUgc2NhbGVkIHVwLiBJZiB0aGUgbnVtYmVyIG9mIGJ1Y2tldHMKICAgICAqIGNyZWF0ZWQgaXMgbGVzcyB0aGFuIG9uZSwgdGhlIGludGVydmFsIGlzIHNjYWxlZCBiYWNrLgogICAgICoKICAgICAqIFRoZSBpbnRlcnZhbCBvYmplY3QgcmV0dXJuZWQgaXMgYSBtb21lbnQuZHVyYXRpb24KICAgICAqIG9iamVjdCB0aGF0IGhhcyBiZWVuIGRlY29yYXRlZCB3aXRoIHRoZSBmb2xsb3dpbmcKICAgICAqIHByb3BlcnRpZXMuCiAgICAgKgogICAgICogaW50ZXJ2YWwuZGVzY3JpcHRpb246IGEgdGV4dCBkZXNjcmlwdGlvbiBvZiB0aGUgaW50ZXJ2YWwuCiAgICAgKiAgIGRlc2lnbmVkIHRvIGJlIHVzZWQgbGlzdCAiZmllbGQgcGVyIHt7IGRlc2MgfX0iLgogICAgICogICAgIC0gIm1pbnV0ZSIKICAgICAqICAgICAtICIxMCBkYXlzIgogICAgICogICAgIC0gIjMgeWVhcnMiCiAgICAgKgogICAgICogaW50ZXJ2YWwuZXhwcmVzc2lvbjogdGhlIGVsYXN0aWNzZWFyY2ggZXhwcmVzc2lvbiB0aGF0IGNyZWF0ZXMgdGhpcwogICAgICogICBpbnRlcnZhbC4gSWYgdGhlIGludGVydmFsIGRvZXMgbm90IHByb3Blcmx5IGZvcm0gYW4gZWxhc3RpY3NlYXJjaAogICAgICogICBleHByZXNzaW9uIGl0IHdpbGwgYmUgZm9yY2VkIGludG8gb25lLgogICAgICoKICAgICAqIGludGVydmFsLnNjYWxlZDogdGhlIGludGVydmFsIHdhcyBhZGp1c3RlZCB0bwogICAgICogICBhY2NvbW1vZGF0ZSB0aGUgbWF4QmFycyBzZXR0aW5nLgogICAgICoKICAgICAqIGludGVydmFsLnNjYWxlOiB0aGUgbnVtYmVyIHRoYXQgeS12YWx1ZXMgc2hvdWxkIGJlCiAgICAgKiAgIG11bHRpcGxpZWQgYnkKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRJbnRlcnZhbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SW50ZXJ2YWwoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgdXNlTm9ybWFsaXplZEVzSW50ZXJ2YWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHRydWU7CiAgICAgIHZhciBkdXJhdGlvbiA9IHRoaXMuZ2V0RHVyYXRpb24oKTsgLy8gZWl0aGVyIHB1bGwgdGhlIGludGVydmFsIGZyb20gc3RhdGUgb3IgY2FsY3VsYXRlIHRoZSBhdXRvLWludGVydmFsCgogICAgICB2YXIgcmVhZEludGVydmFsID0gZnVuY3Rpb24gcmVhZEludGVydmFsKCkgewogICAgICAgIHZhciBpbnRlcnZhbCA9IF90aGlzLl9pOwogICAgICAgIGlmIChfbW9tZW50LmRlZmF1bHQuaXNEdXJhdGlvbihpbnRlcnZhbCkpIHJldHVybiBpbnRlcnZhbDsKICAgICAgICByZXR1cm4gKDAsIF9jYWxjX2F1dG9faW50ZXJ2YWwuY2FsY0F1dG9JbnRlcnZhbE5lYXIpKF90aGlzLmdldENvbmZpZygnaGlzdG9ncmFtOmJhclRhcmdldCcpLCBOdW1iZXIoZHVyYXRpb24pKTsKICAgICAgfTsKCiAgICAgIHZhciBwYXJzZWRJbnRlcnZhbCA9IHJlYWRJbnRlcnZhbCgpOyAvLyBjaGVjayB0byBzZWUgaWYgdGhlIGludGVydmFsIHNob3VsZCBiZSBzY2FsZWQsIGFuZCBzY2FsZSBpdCBpZiBzbwoKICAgICAgdmFyIG1heWJlU2NhbGVJbnRlcnZhbCA9IGZ1bmN0aW9uIG1heWJlU2NhbGVJbnRlcnZhbChpbnRlcnZhbCkgewogICAgICAgIGlmICghX3RoaXMuaGFzQm91bmRzKCkgfHwgIWR1cmF0aW9uKSB7CiAgICAgICAgICByZXR1cm4gaW50ZXJ2YWw7CiAgICAgICAgfQoKICAgICAgICB2YXIgbWF4TGVuZ3RoID0gX3RoaXMuZ2V0Q29uZmlnKCdoaXN0b2dyYW06bWF4QmFycycpOwoKICAgICAgICB2YXIgYXBwcm94TGVuID0gTnVtYmVyKGR1cmF0aW9uKSAvIE51bWJlcihpbnRlcnZhbCk7CiAgICAgICAgdmFyIHNjYWxlZDsKCiAgICAgICAgaWYgKGFwcHJveExlbiA+IG1heExlbmd0aCkgewogICAgICAgICAgc2NhbGVkID0gKDAsIF9jYWxjX2F1dG9faW50ZXJ2YWwuY2FsY0F1dG9JbnRlcnZhbExlc3NUaGFuKShtYXhMZW5ndGgsIE51bWJlcihkdXJhdGlvbikpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gaW50ZXJ2YWw7CiAgICAgICAgfQoKICAgICAgICBpZiAoK3NjYWxlZCA9PT0gK2ludGVydmFsKSByZXR1cm4gaW50ZXJ2YWw7CiAgICAgICAgaW50ZXJ2YWwgPSBkZWNvcmF0ZUludGVydmFsKGludGVydmFsKTsKICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihzY2FsZWQsIHsKICAgICAgICAgIHByZVNjYWxlZDogaW50ZXJ2YWwsCiAgICAgICAgICBzY2FsZTogTnVtYmVyKGludGVydmFsKSAvIE51bWJlcihzY2FsZWQpLAogICAgICAgICAgc2NhbGVkOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH07IC8vIGFwcGVuZCBzb21lIFRpbWVCdWNrZXRzIHNwZWNpZmljIHByb3BzIHRvIHRoZSBpbnRlcnZhbAoKCiAgICAgIHZhciBkZWNvcmF0ZUludGVydmFsID0gZnVuY3Rpb24gZGVjb3JhdGVJbnRlcnZhbChpbnRlcnZhbCkgewogICAgICAgIHZhciBlc0ludGVydmFsID0gdXNlTm9ybWFsaXplZEVzSW50ZXJ2YWwgPyAoMCwgX2NhbGNfZXNfaW50ZXJ2YWwuY29udmVydER1cmF0aW9uVG9Ob3JtYWxpemVkRXNJbnRlcnZhbCkoaW50ZXJ2YWwpIDogKDAsIF9jYWxjX2VzX2ludGVydmFsLmNvbnZlcnRJbnRlcnZhbFRvRXNJbnRlcnZhbCkoU3RyaW5nKF90aGlzLl9vcmlnaW5hbEludGVydmFsKSk7CgogICAgICAgIHZhciBwcmV0dHlVbml0cyA9IF9tb21lbnQuZGVmYXVsdC5ub3JtYWxpemVVbml0cyhlc0ludGVydmFsLnVuaXQpOwoKICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihpbnRlcnZhbCwgewogICAgICAgICAgZGVzY3JpcHRpb246IGVzSW50ZXJ2YWwudmFsdWUgPT09IDEgPyBwcmV0dHlVbml0cyA6IGVzSW50ZXJ2YWwudmFsdWUgKyAnICcgKyBwcmV0dHlVbml0cyArICdzJywKICAgICAgICAgIGVzVmFsdWU6IGVzSW50ZXJ2YWwudmFsdWUsCiAgICAgICAgICBlc1VuaXQ6IGVzSW50ZXJ2YWwudW5pdCwKICAgICAgICAgIGV4cHJlc3Npb246IGVzSW50ZXJ2YWwuZXhwcmVzc2lvbiwKICAgICAgICAgIG92ZXJmbG93OiBOdW1iZXIoZHVyYXRpb24pID4gTnVtYmVyKGludGVydmFsKSA/IF9tb21lbnQuZGVmYXVsdC5kdXJhdGlvbihOdW1iZXIoaW50ZXJ2YWwpIC0gTnVtYmVyKGR1cmF0aW9uKSkgOiBmYWxzZQogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgaWYgKHVzZU5vcm1hbGl6ZWRFc0ludGVydmFsKSB7CiAgICAgICAgcmV0dXJuIGRlY29yYXRlSW50ZXJ2YWwobWF5YmVTY2FsZUludGVydmFsKHBhcnNlZEludGVydmFsKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGRlY29yYXRlSW50ZXJ2YWwocGFyc2VkSW50ZXJ2YWwpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIGRhdGUgZm9ybWF0IHN0cmluZyB0aGF0IHdpbGwgcmVwcmVzZW50IGRhdGVzIHRoYXQKICAgICAqIHByb2dyZXNzIGF0IG91ciBpbnRlcnZhbC4KICAgICAqCiAgICAgKiBTaW5jZSBvdXIgaW50ZXJ2YWwgY2FuIGJlIGFzIHNtYWxsIGFzIDFtcywgdGhlIGRlZmF1bHQKICAgICAqIGRhdGUgZm9ybWF0IGlzIHVzdWFsbHkgd2F5IHRvbyBtdWNoLiB3aXRoIGBkYXRlRm9ybWF0OnNjYWxlZGAKICAgICAqIHVzZXJzIGNhbiBtb2RpZnkgaG93IGRhdGVzIGFyZSBmb3JtYXR0ZWQgd2l0aGluIHNlcmllcwogICAgICogcHJvZHVjZWQgYnkgVGltZUJ1Y2tldHMKICAgICAqCiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0U2NhbGVkRGF0ZUZvcm1hdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U2NhbGVkRGF0ZUZvcm1hdCgpIHsKICAgICAgdmFyIGludGVydmFsID0gdGhpcy5nZXRJbnRlcnZhbCgpOwogICAgICB2YXIgcnVsZXMgPSB0aGlzLmdldENvbmZpZygnZGF0ZUZvcm1hdDpzY2FsZWQnKTsKCiAgICAgIGZvciAodmFyIGkgPSBydWxlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIHZhciBydWxlID0gcnVsZXNbaV07CgogICAgICAgIGlmICghcnVsZVswXSB8fCBpbnRlcnZhbCAmJiBpbnRlcnZhbCA+PSBfbW9tZW50LmRlZmF1bHQuZHVyYXRpb24ocnVsZVswXSkpIHsKICAgICAgICAgIHJldHVybiBydWxlWzFdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuZ2V0Q29uZmlnKCdkYXRlRm9ybWF0Jyk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVGltZUJ1Y2tldHM7Cn0oKTsKCmV4cG9ydHMuVGltZUJ1Y2tldHMgPSBUaW1lQnVja2V0czs="},null]}