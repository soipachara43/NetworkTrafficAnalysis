{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/index_lifecycle_management/public/np_ready/application/sections/policy_table/components/policy_table/policy_table.js","dependencies":[{"path":"x-pack/legacy/plugins/index_lifecycle_management/public/np_ready/application/sections/policy_table/components/policy_table/policy_table.js","mtime":1589249552256},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlBvbGljeVRhYmxlID0gdm9pZCAwOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9tb21lbnRUaW1lem9uZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibW9tZW50LXRpbWV6b25lIikpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX3JlYWN0MiA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfc2VydmljZXMgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkvbGliL3NlcnZpY2VzIik7Cgp2YXIgX3B1YmxpYyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3BsdWdpbnMvaW5kZXhfbWFuYWdlbWVudC9wdWJsaWMiKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cyIpOwoKdmFyIF9jb25zdGFudHMyID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29uc3RhbnRzIik7Cgp2YXIgX25hdmlnYXRpb24gPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9zZXJ2aWNlcy9uYXZpZ2F0aW9uIik7Cgp2YXIgX2ZsYXR0ZW5fcGFuZWxfdHJlZSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3NlcnZpY2VzL2ZsYXR0ZW5fcGFuZWxfdHJlZSIpOwoKdmFyIF91aV9tZXRyaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9zZXJ2aWNlcy91aV9tZXRyaWMiKTsKCnZhciBfbm9fbWF0Y2ggPSByZXF1aXJlKCIuLi9ub19tYXRjaCIpOwoKdmFyIF9jb25maXJtX2RlbGV0ZSA9IHJlcXVpcmUoIi4vY29uZmlybV9kZWxldGUiKTsKCnZhciBfYWRkX3BvbGljeV90b190ZW1wbGF0ZV9jb25maXJtX21vZGFsID0gcmVxdWlyZSgiLi9hZGRfcG9saWN5X3RvX3RlbXBsYXRlX2NvbmZpcm1fbW9kYWwiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgQ09MVU1OUyA9IHsKICBuYW1lOiB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5oZWFkZXJzLm5hbWVIZWFkZXInLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTmFtZScKICAgIH0pCiAgfSwKICBsaW5rZWRJbmRpY2VzOiB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5oZWFkZXJzLmxpbmtlZEluZGljZXNIZWFkZXInLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTGlua2VkIGluZGljZXMnCiAgICB9KSwKICAgIHdpZHRoOiAxMjAKICB9LAogIHZlcnNpb246IHsKICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLmhlYWRlcnMudmVyc2lvbkhlYWRlcicsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdWZXJzaW9uJwogICAgfSksCiAgICB3aWR0aDogMTIwCiAgfSwKICBtb2RpZmllZF9kYXRlOiB7CiAgICBsYWJlbDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5oZWFkZXJzLm1vZGlmaWVkRGF0ZUhlYWRlcicsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdNb2RpZmllZCBkYXRlJwogICAgfSksCiAgICB3aWR0aDogMjAwCiAgfQp9OwoKdmFyIFBvbGljeVRhYmxlID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhQb2xpY3lUYWJsZSwgX0NvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFBvbGljeVRhYmxlKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBvbGljeVRhYmxlKTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihQb2xpY3lUYWJsZSkuY2FsbCh0aGlzLCBwcm9wcykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlckRlbGV0ZUNvbmZpcm1Nb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHBvbGljeVRvRGVsZXRlID0gX3RoaXMuc3RhdGUucG9saWN5VG9EZWxldGU7CgogICAgICBpZiAoIXBvbGljeVRvRGVsZXRlKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb25maXJtX2RlbGV0ZS5Db25maXJtRGVsZXRlLCB7CiAgICAgICAgcG9saWN5VG9EZWxldGU6IHBvbGljeVRvRGVsZXRlLAogICAgICAgIGNhbGxiYWNrOiBfdGhpcy5oYW5kbGVEZWxldGUsCiAgICAgICAgb25DYW5jZWw6IGZ1bmN0aW9uIG9uQ2FuY2VsKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgcmVuZGVyQ29uZmlybU1vZGFsOiBudWxsLAogICAgICAgICAgICBwb2xpY3lUb0RlbGV0ZTogbnVsbAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlckFkZFBvbGljeVRvVGVtcGxhdGVDb25maXJtTW9kYWwiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBwb2xpY3lUb0FkZFRvVGVtcGxhdGUgPSBfdGhpcy5zdGF0ZS5wb2xpY3lUb0FkZFRvVGVtcGxhdGU7CgogICAgICBpZiAoIXBvbGljeVRvQWRkVG9UZW1wbGF0ZSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWRkX3BvbGljeV90b190ZW1wbGF0ZV9jb25maXJtX21vZGFsLkFkZFBvbGljeVRvVGVtcGxhdGVDb25maXJtTW9kYWwsIHsKICAgICAgICBwb2xpY3k6IHBvbGljeVRvQWRkVG9UZW1wbGF0ZSwKICAgICAgICBvbkNhbmNlbDogZnVuY3Rpb24gb25DYW5jZWwoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICByZW5kZXJDb25maXJtTW9kYWw6IG51bGwsCiAgICAgICAgICAgIHBvbGljeVRvQWRkVG9UZW1wbGF0ZTogbnVsbAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImhhbmRsZURlbGV0ZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMucHJvcHMuZmV0Y2hQb2xpY2llcyh0cnVlKTsKCiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICByZW5kZXJEZWxldGVDb25maXJtTW9kYWw6IG51bGwsCiAgICAgICAgcG9saWN5VG9EZWxldGU6IG51bGwKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvblNvcnQiLCBmdW5jdGlvbiAoY29sdW1uKSB7CiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IF90aGlzLnByb3BzLAogICAgICAgICAgc29ydEZpZWxkID0gX3RoaXMkcHJvcHMuc29ydEZpZWxkLAogICAgICAgICAgaXNTb3J0QXNjZW5kaW5nID0gX3RoaXMkcHJvcHMuaXNTb3J0QXNjZW5kaW5nLAogICAgICAgICAgcG9saWN5U29ydENoYW5nZWQgPSBfdGhpcyRwcm9wcy5wb2xpY3lTb3J0Q2hhbmdlZDsKICAgICAgdmFyIG5ld0lzU29ydEFzY2VuZGluZyA9IHNvcnRGaWVsZCA9PT0gY29sdW1uID8gIWlzU29ydEFzY2VuZGluZyA6IHRydWU7CiAgICAgIHBvbGljeVNvcnRDaGFuZ2VkKGNvbHVtbiwgbmV3SXNTb3J0QXNjZW5kaW5nKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInRvZ2dsZVBvbGljeVBvcG92ZXIiLCBmdW5jdGlvbiAocG9saWN5KSB7CiAgICAgIGlmIChfdGhpcy5pc1BvbGljeVBvcG92ZXJPcGVuKHBvbGljeSkpIHsKICAgICAgICBfdGhpcy5jbG9zZVBvbGljeVBvcG92ZXIocG9saWN5KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5vcGVuUG9saWN5UG9wb3Zlcihwb2xpY3kpOwogICAgICB9CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJpc1BvbGljeVBvcG92ZXJPcGVuIiwgZnVuY3Rpb24gKHBvbGljeSkgewogICAgICByZXR1cm4gX3RoaXMuc3RhdGUucG9saWN5UG9wb3ZlciA9PT0gcG9saWN5Lm5hbWU7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjbG9zZVBvbGljeVBvcG92ZXIiLCBmdW5jdGlvbiAocG9saWN5KSB7CiAgICAgIGlmIChfdGhpcy5pc1BvbGljeVBvcG92ZXJPcGVuKHBvbGljeSkpIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBwb2xpY3lQb3BvdmVyOiBudWxsCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9wZW5Qb2xpY3lQb3BvdmVyIiwgZnVuY3Rpb24gKHBvbGljeSkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgcG9saWN5UG9wb3ZlcjogcG9saWN5Lm5hbWUKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkl0ZW1TZWxlY3Rpb25DaGFuZ2VkIiwgZnVuY3Rpb24gKHNlbGVjdGVkUG9saWNpZXMpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHNlbGVjdGVkUG9saWNpZXM6IHNlbGVjdGVkUG9saWNpZXMKICAgICAgfSk7CiAgICB9KTsKCiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgc2VsZWN0ZWRQb2xpY2llc01hcDoge30sCiAgICAgIHJlbmRlckNvbmZpcm1Nb2RhbDogbnVsbAogICAgfTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhQb2xpY3lUYWJsZSwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdGhpcy5wcm9wcy5mZXRjaFBvbGljaWVzKHRydWUpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckVtcHR5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJFbXB0eSgpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlFbXB0eVByb21wdCwgewogICAgICAgIGljb25UeXBlOiAibWFuYWdlbWVudEFwcCIsCiAgICAgICAgdGl0bGU6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImgxIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLmVtcHR5UHJvbXB0VGl0bGUiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDcmVhdGUgeW91ciBmaXJzdCBpbmRleCBsaWZlY3ljbGUgcG9saWN5IgogICAgICAgIH0pKSwKICAgICAgICBib2R5OiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5lbXB0eVByb21wdERlc2NyaXB0aW9uIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiIEFuIGluZGV4IGxpZmVjeWNsZSBwb2xpY3kgaGVscHMgeW91IG1hbmFnZSB5b3VyIGluZGljZXMgYXMgdGhleSBhZ2UuIgogICAgICAgIH0pKSksCiAgICAgICAgYWN0aW9uczogdGhpcy5yZW5kZXJDcmVhdGVQb2xpY3lCdXR0b24oKQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJidWlsZEhlYWRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGRIZWFkZXIoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHByb3BzMiA9IHRoaXMucHJvcHMsCiAgICAgICAgICBzb3J0RmllbGQgPSBfdGhpcyRwcm9wczIuc29ydEZpZWxkLAogICAgICAgICAgaXNTb3J0QXNjZW5kaW5nID0gX3RoaXMkcHJvcHMyLmlzU29ydEFzY2VuZGluZzsKICAgICAgdmFyIGhlYWRlcnMgPSBPYmplY3QuZW50cmllcyhDT0xVTU5TKS5tYXAoZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAyKSwKICAgICAgICAgICAgZmllbGROYW1lID0gX3JlZjJbMF0sCiAgICAgICAgICAgIF9yZWYyJCA9IF9yZWYyWzFdLAogICAgICAgICAgICBsYWJlbCA9IF9yZWYyJC5sYWJlbCwKICAgICAgICAgICAgd2lkdGggPSBfcmVmMiQud2lkdGg7CgogICAgICAgIHZhciBpc1NvcnRlZCA9IHNvcnRGaWVsZCA9PT0gZmllbGROYW1lOwogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGFibGVIZWFkZXJDZWxsLCB7CiAgICAgICAgICBrZXk6IGZpZWxkTmFtZSwKICAgICAgICAgIG9uU29ydDogZnVuY3Rpb24gb25Tb3J0KCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMyLm9uU29ydChmaWVsZE5hbWUpOwogICAgICAgICAgfSwKICAgICAgICAgIGlzU29ydGVkOiBpc1NvcnRlZCwKICAgICAgICAgIGlzU29ydEFzY2VuZGluZzogaXNTb3J0QXNjZW5kaW5nLAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInBvbGljeVRhYmxlSGVhZGVyQ2VsbC0iLmNvbmNhdChmaWVsZE5hbWUpLAogICAgICAgICAgY2xhc3NOYW1lOiAncG9saWN5VGFibGVfX2hlYWRlci0tJyArIGZpZWxkTmFtZSwKICAgICAgICAgIHdpZHRoOiB3aWR0aAogICAgICAgIH0sIGxhYmVsKTsKICAgICAgfSk7CiAgICAgIGhlYWRlcnMucHVzaChfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGFibGVIZWFkZXJDZWxsLCB7CiAgICAgICAga2V5OiAiZGVsZXRlSGVhZGVyIiwKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicG9saWN5VGFibGVIZWFkZXJDZWxsLWRlbGV0ZSIsCiAgICAgICAgd2lkdGg6IDE1MAogICAgICB9KSk7CiAgICAgIHJldHVybiBoZWFkZXJzOwogICAgfQogIH0sIHsKICAgIGtleTogImJ1aWxkUm93Q2VsbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGRSb3dDZWxsKGZpZWxkTmFtZSwgdmFsdWUpIHsKICAgICAgaWYgKGZpZWxkTmFtZSA9PT0gJ25hbWUnKSB7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAZWxhc3RpYy9ldWkvaHJlZi1vci1vbi1jbGljayAqLwogICAgICAgICAgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAicG9saWN5VGFibGVfX2xpbmsiLAogICAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicG9saWN5VGFibGVQb2xpY3lOYW1lTGluayIsCiAgICAgICAgICAgIGhyZWY6ICgwLCBfbmF2aWdhdGlvbi5nZXRQb2xpY3lQYXRoKSh2YWx1ZSksCiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgcmV0dXJuICgwLCBfdWlfbWV0cmljLnRyYWNrVWlNZXRyaWMpKCdjbGljaycsIF9jb25zdGFudHMyLlVJTV9FRElUX0NMSUNLKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgdmFsdWUpCiAgICAgICAgKTsKICAgICAgfSBlbHNlIGlmIChmaWVsZE5hbWUgPT09ICdsaW5rZWRJbmRpY2VzJykgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiYiIsIG51bGwsIHZhbHVlID8gdmFsdWUubGVuZ3RoIDogJzAnKSk7CiAgICAgIH0gZWxzZSBpZiAoZmllbGROYW1lID09PSAnbW9kaWZpZWRfZGF0ZScgJiYgdmFsdWUpIHsKICAgICAgICByZXR1cm4gKDAsIF9tb21lbnRUaW1lem9uZS5kZWZhdWx0KSh2YWx1ZSkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJDcmVhdGVQb2xpY3lCdXR0b24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckNyZWF0ZVBvbGljeUJ1dHRvbigpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgICAgICBocmVmOiAiIyIuY29uY2F0KF9jb25zdGFudHMuQkFTRV9QQVRILCAicG9saWNpZXMvZWRpdCIpLAogICAgICAgIGZpbGw6IHRydWUsCiAgICAgICAgaWNvblR5cGU6ICJwbHVzSW5DaXJjbGUiLAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJjcmVhdGVQb2xpY3lCdXR0b24iCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5pbmRleExpZmVjeWNsZU1nbXQucG9saWN5VGFibGUuZW1wdHlQcm9tcHQuY3JlYXRlQnV0dG9uTGFiZWwiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ3JlYXRlIHBvbGljeSIKICAgICAgfSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckNvbmZpcm1Nb2RhbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyQ29uZmlybU1vZGFsKCkgewogICAgICB2YXIgcmVuZGVyQ29uZmlybU1vZGFsID0gdGhpcy5zdGF0ZS5yZW5kZXJDb25maXJtTW9kYWw7CgogICAgICBpZiAocmVuZGVyQ29uZmlybU1vZGFsKSB7CiAgICAgICAgcmV0dXJuIHJlbmRlckNvbmZpcm1Nb2RhbCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiYnVpbGRBY3Rpb25QYW5lbFRyZWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJ1aWxkQWN0aW9uUGFuZWxUcmVlKHBvbGljeSkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBoYXNMaW5rZWRJbmRpY2VzID0gQm9vbGVhbihwb2xpY3kubGlua2VkSW5kaWNlcyAmJiBwb2xpY3kubGlua2VkSW5kaWNlcy5sZW5ndGgpOwoKICAgICAgdmFyIHZpZXdJbmRpY2VzTGFiZWwgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLnZpZXdJbmRpY2VzQnV0dG9uVGV4dCcsIHsKICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1ZpZXcgaW5kaWNlcyBsaW5rZWQgdG8gcG9saWN5JwogICAgICB9KTsKCiAgICAgIHZhciBhZGRQb2xpY3lUb1RlbXBsYXRlTGFiZWwgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLmFkZFBvbGljeVRvVGVtcGxhdGVCdXR0b25UZXh0JywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQWRkIHBvbGljeSB0byBpbmRleCB0ZW1wbGF0ZScKICAgICAgfSk7CgogICAgICB2YXIgZGVsZXRlUG9saWN5TGFiZWwgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLmRlbGV0ZVBvbGljeUJ1dHRvblRleHQnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZWxldGUgcG9saWN5JwogICAgICB9KTsKCiAgICAgIHZhciBkZWxldGVQb2xpY3lUb29sdGlwID0gaGFzTGlua2VkSW5kaWNlcyA/IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pbmRleExpZmVjeWNsZU1nbXQucG9saWN5VGFibGUuZGVsZXRlUG9saWN5QnV0dG9uRGlzYWJsZWRUb29sdGlwJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnWW91IGNhbm5vdCBkZWxldGUgYSBwb2xpY3kgdGhhdCBpcyBiZWluZyB1c2VkIGJ5IGFuIGluZGV4JwogICAgICB9KSA6IG51bGw7CiAgICAgIHZhciBpdGVtcyA9IFtdOwoKICAgICAgaWYgKGhhc0xpbmtlZEluZGljZXMpIHsKICAgICAgICBpdGVtcy5wdXNoKHsKICAgICAgICAgIG5hbWU6IHZpZXdJbmRpY2VzTGFiZWwsCiAgICAgICAgICBpY29uOiAnbGlzdCcsCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICgwLCBfcHVibGljLmdldEluZGV4TGlzdFVyaSkoImlsbS5wb2xpY3k6Ii5jb25jYXQocG9saWN5Lm5hbWUpKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaXRlbXMucHVzaCh7CiAgICAgICAgbmFtZTogYWRkUG9saWN5VG9UZW1wbGF0ZUxhYmVsLAogICAgICAgIGljb246ICdwbHVzSW5DaXJjbGUnLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMzLnNldFN0YXRlKHsKICAgICAgICAgICAgcmVuZGVyQ29uZmlybU1vZGFsOiBfdGhpczMucmVuZGVyQWRkUG9saWN5VG9UZW1wbGF0ZUNvbmZpcm1Nb2RhbCwKICAgICAgICAgICAgcG9saWN5VG9BZGRUb1RlbXBsYXRlOiBwb2xpY3kKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGl0ZW1zLnB1c2goewogICAgICAgIG5hbWU6IGRlbGV0ZVBvbGljeUxhYmVsLAogICAgICAgIGRpc2FibGVkOiBoYXNMaW5rZWRJbmRpY2VzLAogICAgICAgIGljb246ICd0cmFzaCcsCiAgICAgICAgdG9vbFRpcENvbnRlbnQ6IGRlbGV0ZVBvbGljeVRvb2x0aXAsCiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgIHJldHVybiBfdGhpczMuc2V0U3RhdGUoewogICAgICAgICAgICByZW5kZXJDb25maXJtTW9kYWw6IF90aGlzMy5yZW5kZXJEZWxldGVDb25maXJtTW9kYWwsCiAgICAgICAgICAgIHBvbGljeVRvRGVsZXRlOiBwb2xpY3kKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHZhciBwYW5lbFRyZWUgPSB7CiAgICAgICAgaWQ6IDAsCiAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pbmRleExpZmVjeWNsZU1nbXQucG9saWN5VGFibGUucG9saWN5QWN0aW9uc01lbnUucGFuZWxUaXRsZScsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnUG9saWN5IG9wdGlvbnMnCiAgICAgICAgfSksCiAgICAgICAgaXRlbXM6IGl0ZW1zCiAgICAgIH07CiAgICAgIHJldHVybiAoMCwgX2ZsYXR0ZW5fcGFuZWxfdHJlZS5mbGF0dGVuUGFuZWxUcmVlKShwYW5lbFRyZWUpOwogICAgfQogIH0sIHsKICAgIGtleTogImJ1aWxkUm93Q2VsbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJ1aWxkUm93Q2VsbHMocG9saWN5KSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIG5hbWUgPSBwb2xpY3kubmFtZTsKICAgICAgdmFyIGNlbGxzID0gT2JqZWN0LmVudHJpZXMoQ09MVU1OUykubWFwKGZ1bmN0aW9uIChfcmVmMykgewogICAgICAgIHZhciBfcmVmNCA9IF9zbGljZWRUb0FycmF5KF9yZWYzLCAyKSwKICAgICAgICAgICAgZmllbGROYW1lID0gX3JlZjRbMF0sCiAgICAgICAgICAgIHdpZHRoID0gX3JlZjRbMV0ud2lkdGg7CgogICAgICAgIHZhciB2YWx1ZSA9IHBvbGljeVtmaWVsZE5hbWVdOwoKICAgICAgICBpZiAoZmllbGROYW1lID09PSAnbmFtZScpIHsKICAgICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJ0aCIsIHsKICAgICAgICAgICAga2V5OiAiIi5jb25jYXQoZmllbGROYW1lLCAiLSIpLmNvbmNhdChuYW1lKSwKICAgICAgICAgICAgY2xhc3NOYW1lOiAiZXVpVGFibGVSb3dDZWxsIiwKICAgICAgICAgICAgc2NvcGU6ICJyb3ciLAogICAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAicG9saWN5VGFibGVDZWxsLSIuY29uY2F0KGZpZWxkTmFtZSkKICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAiZXVpVGFibGVDZWxsQ29udGVudCBwb2xpY3lUYWJsZV9fY29udGVudC0tIi5jb25jYXQoZmllbGROYW1lKQogICAgICAgICAgfSwgX3RoaXM0LmJ1aWxkUm93Q2VsbChmaWVsZE5hbWUsIHZhbHVlKSkpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJsZVJvd0NlbGwsIHsKICAgICAgICAgIGtleTogIiIuY29uY2F0KGZpZWxkTmFtZSwgIi0iKS5jb25jYXQobmFtZSksCiAgICAgICAgICB0cnVuY2F0ZVRleHQ6IGZhbHNlLAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInBvbGljeVRhYmxlQ2VsbC0iLmNvbmNhdChmaWVsZE5hbWUpLAogICAgICAgICAgY2xhc3NOYW1lOiAncG9saWN5VGFibGVfX2NvbnRlbnQtLScgKyBmaWVsZE5hbWUsCiAgICAgICAgICB3aWR0aDogd2lkdGgKICAgICAgICB9LCBfdGhpczQuYnVpbGRSb3dDZWxsKGZpZWxkTmFtZSwgdmFsdWUpKTsKICAgICAgfSk7CgogICAgICB2YXIgYnV0dG9uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkVtcHR5LCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInBvbGljeUFjdGlvbnNDb250ZXh0TWVudUJ1dHRvbiIsCiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgIHJldHVybiBfdGhpczQudG9nZ2xlUG9saWN5UG9wb3Zlcihwb2xpY3kpOwogICAgICAgIH0sCiAgICAgICAgY29sb3I6ICJwcmltYXJ5IgogICAgICB9LCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLmFjdGlvbnNCdXR0b25UZXh0JywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQWN0aW9ucycKICAgICAgfSkpOwoKICAgICAgY2VsbHMucHVzaChfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGFibGVSb3dDZWxsLCB7CiAgICAgICAgYWxpZ246IF9zZXJ2aWNlcy5SSUdIVF9BTElHTk1FTlQsCiAgICAgICAga2V5OiAiZGVsZXRlLSIuY29uY2F0KG5hbWUpLAogICAgICAgIHRydW5jYXRlVGV4dDogZmFsc2UsCiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInBvbGljeVRhYmxlQ2VsbC1hY3Rpb25zLSIuY29uY2F0KG5hbWUpLAogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICB3aWR0aDogMTUwCiAgICAgICAgfQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUG9wb3ZlciwgewogICAgICAgIGlkOiAiY29udGV4dE1lbnVQb2xpY3kiLAogICAgICAgIGJ1dHRvbjogYnV0dG9uLAogICAgICAgIGlzT3BlbjogdGhpcy5pc1BvbGljeVBvcG92ZXJPcGVuKHBvbGljeSksCiAgICAgICAgY2xvc2VQb3BvdmVyOiBmdW5jdGlvbiBjbG9zZVBvcG92ZXIoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXM0LmNsb3NlUG9saWN5UG9wb3Zlcihwb2xpY3kpOwogICAgICAgIH0sCiAgICAgICAgcGFuZWxQYWRkaW5nU2l6ZTogIm5vbmUiLAogICAgICAgIHdpdGhUaXRsZTogdHJ1ZSwKICAgICAgICBhbmNob3JQb3NpdGlvbjogInJpZ2h0VXAiLAogICAgICAgIHJlcG9zaXRpb25PblNjcm9sbDogdHJ1ZQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29udGV4dE1lbnUsIHsKICAgICAgICBpbml0aWFsUGFuZWxJZDogMCwKICAgICAgICBwYW5lbHM6IHRoaXMuYnVpbGRBY3Rpb25QYW5lbFRyZWUocG9saWN5KQogICAgICB9KSkpKTsKICAgICAgcmV0dXJuIGNlbGxzOwogICAgfQogIH0sIHsKICAgIGtleTogImJ1aWxkUm93cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGRSb3dzKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyRwcm9wcyRwb2xpY2llcyA9IHRoaXMucHJvcHMucG9saWNpZXMsCiAgICAgICAgICBwb2xpY2llcyA9IF90aGlzJHByb3BzJHBvbGljaWVzID09PSB2b2lkIDAgPyBbXSA6IF90aGlzJHByb3BzJHBvbGljaWVzOwogICAgICByZXR1cm4gcG9saWNpZXMubWFwKGZ1bmN0aW9uIChwb2xpY3kpIHsKICAgICAgICB2YXIgbmFtZSA9IHBvbGljeS5uYW1lOwogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGFibGVSb3csIHsKICAgICAgICAgIGtleTogIiIuY29uY2F0KG5hbWUsICItcm93IikKICAgICAgICB9LCBfdGhpczUuYnVpbGRSb3dDZWxscyhwb2xpY3kpKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyUGFnZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclBhZ2VyKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMzID0gdGhpcy5wcm9wcywKICAgICAgICAgIHBhZ2VyID0gX3RoaXMkcHJvcHMzLnBhZ2VyLAogICAgICAgICAgcG9saWN5UGFnZUNoYW5nZWQgPSBfdGhpcyRwcm9wczMucG9saWN5UGFnZUNoYW5nZWQsCiAgICAgICAgICBwb2xpY3lQYWdlU2l6ZUNoYW5nZWQgPSBfdGhpcyRwcm9wczMucG9saWN5UGFnZVNpemVDaGFuZ2VkOwogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRhYmxlUGFnaW5hdGlvbiwgewogICAgICAgIGFjdGl2ZVBhZ2U6IHBhZ2VyLmdldEN1cnJlbnRQYWdlSW5kZXgoKSwKICAgICAgICBpdGVtc1BlclBhZ2U6IHBhZ2VyLml0ZW1zUGVyUGFnZSwKICAgICAgICBpdGVtc1BlclBhZ2VPcHRpb25zOiBbMTAsIDUwLCAxMDBdLAogICAgICAgIHBhZ2VDb3VudDogcGFnZXIuZ2V0VG90YWxQYWdlcygpLAogICAgICAgIG9uQ2hhbmdlSXRlbXNQZXJQYWdlOiBwb2xpY3lQYWdlU2l6ZUNoYW5nZWQsCiAgICAgICAgb25DaGFuZ2VQYWdlOiBwb2xpY3lQYWdlQ2hhbmdlZAogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkcHJvcHM0ID0gdGhpcy5wcm9wcywKICAgICAgICAgIHRvdGFsTnVtYmVyT2ZQb2xpY2llcyA9IF90aGlzJHByb3BzNC50b3RhbE51bWJlck9mUG9saWNpZXMsCiAgICAgICAgICBwb2xpY3lGaWx0ZXJDaGFuZ2VkID0gX3RoaXMkcHJvcHM0LnBvbGljeUZpbHRlckNoYW5nZWQsCiAgICAgICAgICBmaWx0ZXIgPSBfdGhpcyRwcm9wczQuZmlsdGVyLAogICAgICAgICAgcG9saWN5TGlzdExvYWRlZCA9IF90aGlzJHByb3BzNC5wb2xpY3lMaXN0TG9hZGVkLAogICAgICAgICAgcG9saWNpZXMgPSBfdGhpcyRwcm9wczQucG9saWNpZXM7CiAgICAgIHZhciBzZWxlY3RlZFBvbGljaWVzTWFwID0gdGhpcy5zdGF0ZS5zZWxlY3RlZFBvbGljaWVzTWFwOwogICAgICB2YXIgbnVtU2VsZWN0ZWQgPSBPYmplY3Qua2V5cyhzZWxlY3RlZFBvbGljaWVzTWFwKS5sZW5ndGg7CiAgICAgIHZhciBjb250ZW50OwogICAgICB2YXIgdGFibGVDb250ZW50OwoKICAgICAgaWYgKHRvdGFsTnVtYmVyT2ZQb2xpY2llcyB8fCAhcG9saWN5TGlzdExvYWRlZCkgewogICAgICAgIGlmICghcG9saWN5TGlzdExvYWRlZCkgewogICAgICAgICAgdGFibGVDb250ZW50ID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxvYWRpbmdTcGlubmVyLCB7CiAgICAgICAgICAgIHNpemU6ICJtIgogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmICh0b3RhbE51bWJlck9mUG9saWNpZXMgPiAwKSB7CiAgICAgICAgICB0YWJsZUNvbnRlbnQgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGFibGUsIHsKICAgICAgICAgICAgY2xhc3NOYW1lOiAicG9saWN5VGFibGVfX2hvcml6b250YWxTY3JvbGwiCiAgICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU2NyZWVuUmVhZGVyT25seSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiY2FwdGlvbiIsIHsKICAgICAgICAgICAgcm9sZTogInN0YXR1cyIsCiAgICAgICAgICAgICJhcmlhLXJlbGV2YW50IjogInRleHQiLAogICAgICAgICAgICAiYXJpYS1saXZlIjogInBvbGl0ZSIKICAgICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICAgIGlkOiAieHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLmNhcHRpb25UZXh0IiwKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJCZWxvdyBpcyB0aGUgaW5kZXggbGlmZWN5Y2xlIHBvbGljeSB0YWJsZSBjb250YWluaW5nIHtjb3VudCwgcGx1cmFsLCBvbmUgeyMgcm93fSBvdGhlciB7IyByb3dzfX0gb3V0IG9mIHt0b3RhbH0uIiwKICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgY291bnQ6IHBvbGljaWVzLmxlbmd0aCwKICAgICAgICAgICAgICB0b3RhbDogdG90YWxOdW1iZXJPZlBvbGljaWVzCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUYWJsZUhlYWRlciwgbnVsbCwgdGhpcy5idWlsZEhlYWRlcigpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRhYmxlQm9keSwgbnVsbCwgdGhpcy5idWlsZFJvd3MoKSkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0YWJsZUNvbnRlbnQgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ub19tYXRjaC5Ob01hdGNoLCBudWxsKTsKICAgICAgICB9CgogICAgICAgIGNvbnRlbnQgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgewogICAgICAgICAgZ3V0dGVyU2l6ZTogImwiLAogICAgICAgICAgYWxpZ25JdGVtczogImNlbnRlciIKICAgICAgICB9LCBudW1TZWxlY3RlZCA+IDAgPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIHsKICAgICAgICAgIGdyb3c6IGZhbHNlCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbiwgewogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogImRlbGV0ZVBvbGljeUJ1dHRvbiIsCiAgICAgICAgICBjb2xvcjogImRhbmdlciIsCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXM2LnNldFN0YXRlKHsKICAgICAgICAgICAgICBzaG93RGVsZXRlQ29uZmlybWF0aW9uOiB0cnVlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLmluZGV4TGlmZWN5Y2xlTWdtdC5wb2xpY3lUYWJsZS5kZWxldGVkUG9saWNpZXNUZXh0IiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiRGVsZXRlZCB7bnVtU2VsZWN0ZWR9IHtudW1TZWxlY3RlZCwgcGx1cmFsLCBvbmUge3BvbGljeX0gb3RoZXIge3BvbGljaWVzfX0iLAogICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgIG51bVNlbGVjdGVkOiBudW1TZWxlY3RlZAogICAgICAgICAgfQogICAgICAgIH0pKSkgOiBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEl0ZW0sIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGaWVsZFNlYXJjaCwgewogICAgICAgICAgZnVsbFdpZHRoOiB0cnVlLAogICAgICAgICAgdmFsdWU6IGZpbHRlciwKICAgICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShldmVudCkgewogICAgICAgICAgICBwb2xpY3lGaWx0ZXJDaGFuZ2VkKGV2ZW50LnRhcmdldC52YWx1ZSk7CiAgICAgICAgICB9LAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogInBvbGljeVRhYmxlRmlsdGVySW5wdXQiLAogICAgICAgICAgcGxhY2Vob2xkZXI6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pbmRleExpZmVjeWNsZU1nbXQucG9saWN5VGFibGUuc3lzdGVtcG9saWNpZXNTZWFyY2hJbnB1dFBsYWNlaG9sZGVyJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1NlYXJjaCcKICAgICAgICAgIH0pLAogICAgICAgICAgImFyaWEtbGFiZWwiOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLnN5c3RlbXBvbGljaWVzU2VhcmNoSW5wdXRBcmlhTGFiZWwnLCB7CiAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnU2VhcmNoIHBvbGljaWVzJwogICAgICAgICAgfSkKICAgICAgICB9KSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCB7CiAgICAgICAgICBzaXplOiAibSIKICAgICAgICB9KSwgdGFibGVDb250ZW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb250ZW50ID0gdGhpcy5yZW5kZXJFbXB0eSgpOwogICAgICB9CgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhZ2VCb2R5LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnZUNvbnRlbnQsIHsKICAgICAgICB2ZXJ0aWNhbFBvc2l0aW9uOiAiY2VudGVyIiwKICAgICAgICBob3Jpem9udGFsUG9zaXRpb246ICJjZW50ZXIiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIHRoaXMucmVuZGVyQ29uZmlybU1vZGFsKCksIHRvdGFsTnVtYmVyT2ZQb2xpY2llcyB8fCAhcG9saWN5TGlzdExvYWRlZCA/IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICAgICAganVzdGlmeUNvbnRlbnQ6ICJzcGFjZUJldHdlZW4iLAogICAgICAgIGFsaWduSXRlbXM6ICJjZW50ZXIiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgICAgIGdyb3c6IGZhbHNlCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUaXRsZSwgewogICAgICAgIHNpemU6ICJsIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJoMSIsIHsKICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAic2VjdGlvbkhlYWRpbmciCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5pbmRleExpZmVjeWNsZU1nbXQucG9saWN5VGFibGUuc2VjdGlvbkhlYWRpbmciLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiSW5kZXggTGlmZWN5Y2xlIFBvbGljaWVzIgogICAgICB9KSkpKSwgdG90YWxOdW1iZXJPZlBvbGljaWVzID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgZ3JvdzogZmFsc2UKICAgICAgfSwgdGhpcy5yZW5kZXJDcmVhdGVQb2xpY3lCdXR0b24oKSkgOiBudWxsKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJzIgogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRleHQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suaW5kZXhMaWZlY3ljbGVNZ210LnBvbGljeVRhYmxlLnNlY3Rpb25EZXNjcmlwdGlvbiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJNYW5hZ2UgeW91ciBpbmRpY2VzIGFzIHRoZXkgYWdlLiAgQXR0YWNoIGEgcG9saWN5IHRvIGF1dG9tYXRlIHdoZW4gYW5kIGhvdyB0byB0cmFuc2l0aW9uIGFuIGluZGV4IHRocm91Z2ggaXRzIGxpZmVjeWNsZS4iCiAgICAgIH0pKSkpIDogbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgbnVsbCksIGNvbnRlbnQsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgICBzaXplOiAibSIKICAgICAgfSksIHRvdGFsTnVtYmVyT2ZQb2xpY2llcyAmJiB0b3RhbE51bWJlck9mUG9saWNpZXMgPiAxMCA/IHRoaXMucmVuZGVyUGFnZXIoKSA6IG51bGwpKSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUG9saWN5VGFibGU7Cn0oX3JlYWN0LkNvbXBvbmVudCk7CgpleHBvcnRzLlBvbGljeVRhYmxlID0gUG9saWN5VGFibGU7"},null]}