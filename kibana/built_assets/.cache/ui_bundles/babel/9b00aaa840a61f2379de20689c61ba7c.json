{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/components/timeline/body/events/stateful_event.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/components/timeline/body/events/stateful_event.js","mtime":1589249553156},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlN0YXRlZnVsRXZlbnQgPSBleHBvcnRzLmdldE5ld05vdGVJZCA9IHZvaWQgMDsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfdXVpZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidXVpZCIpKTsKCnZhciBfcmVhY3RWaXNpYmlsaXR5U2Vuc29yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJyZWFjdC12aXNpYmlsaXR5LXNlbnNvciIpKTsKCnZhciBfZGV0YWlscyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbnRhaW5lcnMvdGltZWxpbmUvZGV0YWlscyIpOwoKdmFyIF9zY2hlZHVsZXIgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9saWIvaGVscGVycy9zY2hlZHVsZXIiKTsKCnZhciBfc2tlbGV0b25fcm93ID0gcmVxdWlyZSgiLi4vLi4vLi4vc2tlbGV0b25fcm93Iik7Cgp2YXIgX2V4cGFuZGFibGVfZXZlbnQgPSByZXF1aXJlKCIuLi8uLi9leHBhbmRhYmxlX2V2ZW50Iik7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuLi8uLi9oZWxwZXJzIik7Cgp2YXIgX3N0eWxlcyA9IHJlcXVpcmUoIi4uLy4uL3N0eWxlcyIpOwoKdmFyIF9nZXRfcm93X3JlbmRlcmVyID0gcmVxdWlyZSgiLi4vcmVuZGVyZXJzL2dldF9yb3dfcmVuZGVyZXIiKTsKCnZhciBfaGVscGVyczIgPSByZXF1aXJlKCIuLi9oZWxwZXJzIik7Cgp2YXIgX25vdGVfY2FyZHMgPSByZXF1aXJlKCIuLi8uLi8uLi9ub3Rlcy9ub3RlX2NhcmRzIik7Cgp2YXIgX2V2ZW50X2RldGFpbHNfd2lkdGhfY29udGV4dCA9IHJlcXVpcmUoIi4uLy4uLy4uL2V2ZW50c192aWV3ZXIvZXZlbnRfZGV0YWlsc193aWR0aF9jb250ZXh0Iik7Cgp2YXIgX2V2ZW50X2NvbHVtbl92aWV3ID0gcmVxdWlyZSgiLi9ldmVudF9jb2x1bW5fdmlldyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgZGVmYXVsdDogb2JqCiAgfTsKfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7CiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgewogICAgcmV0dXJuIG9iajsKICB9IGVsc2UgewogICAgdmFyIG5ld09iaiA9IHt9OwoKICAgIGlmIChvYmogIT0gbnVsbCkgewogICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OwoKICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajsKICAgIHJldHVybiBuZXdPYmo7CiAgfQp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKdmFyIGdldE5ld05vdGVJZCA9IGZ1bmN0aW9uIGdldE5ld05vdGVJZCgpIHsKICByZXR1cm4gX3V1aWQuZGVmYXVsdC52NCgpOwp9OwoKZXhwb3J0cy5nZXROZXdOb3RlSWQgPSBnZXROZXdOb3RlSWQ7CnZhciBlbXB0eURldGFpbHMgPSBbXTsKLyoqCiAqIFRoaXMgaXMgdGhlIGRlZmF1bHQgcm93IGhlaWdodCB3aGVuZXZlciBpdCBpcyBhIHBsYWluIHJvdyByZW5kZXJlciBhbmQgbm90IGEgY3VzdG9tIHJvdyBoZWlnaHQuCiAqIFdlIHVzZSB0aGlzIHZhbHVlIHdoZW4gd2UgZG8gbm90IGtub3cgdGhlIGhlaWdodCBvZiBhIHBhcnRpY3VsYXIgcm93LgogKi8KCnZhciBERUZBVUxUX1JPV19IRUlHSFQgPSAnMzJweCc7Ci8qKgogKiBUaGlzIGlzIHRoZSB0b3Agb2Zmc2V0IGluIHBpeGVscyBvZiB0aGUgdG9wIHBhcnQgb2YgdGhlIHRpbWVsaW5lLiBUaGUgVUkgYXJlYSB3aGVyZSB5b3UgZG8geW91cgogKiBkcmFnIGFuZCBkcm9wIGFuZCBmaWx0ZXJpbmcuICBJdCBpcyBhIHBvc2l0aXZlIG51bWJlciBpbiBwaXhlbHMgb2YgX1BBUlRfIG9mIHRoZSBoZWFkZXIgYnV0IG5vdAogKiB0aGUgZW50aXJlIGhlYWRlci4gV2UgbGVhdmUgcm9vbSBmb3Igc29tZSByb3dzIHRvIHJlbmRlciBiZWhpbmQgdGhlIGRyYWcgYW5kIGRyb3Agc28gdGhleSBtaWdodCBiZQogKiB2aXNpYmxlIGJ5IHRoZSB0aW1lIHRoZSB1c2VyIHNjcm9sbHMgdXB3YXJkcy4gQWxsIG90aGVyIERPTSBlbGVtZW50cyBhcmUgcmVwbGFjZWQgd2l0aCB0aGVpciAiYmxhbmsiCiAqIHJvd3MuCiAqLwoKdmFyIFRPUF9PRkZTRVQgPSA1MDsKLyoqCiAqIFRoaXMgaXMgdGhlIGJvdHRvbSBvZmZzZXQgaW4gcGl4ZWxzIG9mIHRoZSBib3R0b20gcGFydCBvZiB0aGUgdGltZWxpbmUuIFRoZSBVSSBhcmVhIHJpZ2h0IGJlbG93IHRoZQogKiB0aW1lbGluZSB3aGljaCBpcyB0aGUgZm9vdGVyLiAgU2luY2UgdGhlIGZvb3RlciBpcyBzbyBpbmNyZWRpYmx5IHNtYWxsIHdlIGRvbid0IGhhdmUgZW5vdWdoIHJvb20gdG8KICogcmVuZGVyIGFyb3VuZCA1IHJvd3MgYmVsb3cgdGhlIHRpbWVsaW5lIHRvIGdldCB0aGUgdXNlciB0aGUgYmVzdCBjaGFuY2Ugb2YgYWx3YXlzIHNjcm9sbGluZyB3aXRob3V0IHNlZWluZwogKiAiYmxhbmsgcm93cyIuIFRoZSBuZWdhdGl2ZSBudW1iZXIgaXMgdG8gZ2l2ZSB0aGUgYm90dG9tIG9mIHRoZSBicm93c2VyIHdpbmRvdyBhIGJpdCBvZiBpbnZpc2libGUgc3BhY2UgdG8KICoga2VlcCBhcm91bmQgNSByb3dzIHJlbmRlcmluZyBiZWxvdyBpdC4gQWxsIG90aGVyIERPTSBlbGVtZW50cyBhcmUgcmVwbGFjZWQgd2l0aCB0aGVpciAiYmxhbmsiCiAqIHJvd3MuCiAqLwoKdmFyIEJPVFRPTV9PRkZTRVQgPSAtNTAwOwp2YXIgZW1wdHlOb3RlcyA9IFtdOwoKdmFyIEV2ZW50c1RyU3VwcGxlbWVudENvbnRhaW5lcldyYXBwZXIgPSBfcmVhY3QuZGVmYXVsdC5tZW1vKGZ1bmN0aW9uIChfcmVmKSB7CiAgdmFyIGNoaWxkcmVuID0gX3JlZi5jaGlsZHJlbjsKICB2YXIgd2lkdGggPSAoMCwgX2V2ZW50X2RldGFpbHNfd2lkdGhfY29udGV4dC51c2VFdmVudERldGFpbHNXaWR0aENvbnRleHQpKCk7CiAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3N0eWxlcy5FdmVudHNUclN1cHBsZW1lbnRDb250YWluZXIsIHsKICAgIHdpZHRoOiB3aWR0aAogIH0sIGNoaWxkcmVuKTsKfSk7CgpFdmVudHNUclN1cHBsZW1lbnRDb250YWluZXJXcmFwcGVyLmRpc3BsYXlOYW1lID0gJ0V2ZW50c1RyU3VwcGxlbWVudENvbnRhaW5lcldyYXBwZXInOwoKdmFyIFN0YXRlZnVsRXZlbnRDb21wb25lbnQgPSBmdW5jdGlvbiBTdGF0ZWZ1bEV2ZW50Q29tcG9uZW50KF9yZWYyKSB7CiAgdmFyIGFjdGlvbnNDb2x1bW5XaWR0aCA9IF9yZWYyLmFjdGlvbnNDb2x1bW5XaWR0aCwKICAgICAgYWRkTm90ZVRvRXZlbnQgPSBfcmVmMi5hZGROb3RlVG9FdmVudCwKICAgICAgYnJvd3NlckZpZWxkcyA9IF9yZWYyLmJyb3dzZXJGaWVsZHMsCiAgICAgIGNvbnRhaW5lckVsZW1lbnRSZWYgPSBfcmVmMi5jb250YWluZXJFbGVtZW50UmVmLAogICAgICBjb2x1bW5IZWFkZXJzID0gX3JlZjIuY29sdW1uSGVhZGVycywKICAgICAgY29sdW1uUmVuZGVyZXJzID0gX3JlZjIuY29sdW1uUmVuZGVyZXJzLAogICAgICBldmVudCA9IF9yZWYyLmV2ZW50LAogICAgICBldmVudElkVG9Ob3RlSWRzID0gX3JlZjIuZXZlbnRJZFRvTm90ZUlkcywKICAgICAgZ2V0Tm90ZXNCeUlkcyA9IF9yZWYyLmdldE5vdGVzQnlJZHMsCiAgICAgIF9yZWYyJGlzRXZlbnRWaWV3ZXIgPSBfcmVmMi5pc0V2ZW50Vmlld2VyLAogICAgICBpc0V2ZW50Vmlld2VyID0gX3JlZjIkaXNFdmVudFZpZXdlciA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmMiRpc0V2ZW50Vmlld2VyLAogICAgICBfcmVmMiRpc0V2ZW50UGlubmVkID0gX3JlZjIuaXNFdmVudFBpbm5lZCwKICAgICAgaXNFdmVudFBpbm5lZCA9IF9yZWYyJGlzRXZlbnRQaW5uZWQgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjIkaXNFdmVudFBpbm5lZCwKICAgICAgbG9hZGluZ0V2ZW50SWRzID0gX3JlZjIubG9hZGluZ0V2ZW50SWRzLAogICAgICBfcmVmMiRtYXhEZWxheSA9IF9yZWYyLm1heERlbGF5LAogICAgICBtYXhEZWxheSA9IF9yZWYyJG1heERlbGF5ID09PSB2b2lkIDAgPyAwIDogX3JlZjIkbWF4RGVsYXksCiAgICAgIG9uQ29sdW1uUmVzaXplZCA9IF9yZWYyLm9uQ29sdW1uUmVzaXplZCwKICAgICAgb25QaW5FdmVudCA9IF9yZWYyLm9uUGluRXZlbnQsCiAgICAgIG9uUm93U2VsZWN0ZWQgPSBfcmVmMi5vblJvd1NlbGVjdGVkLAogICAgICBvblVuUGluRXZlbnQgPSBfcmVmMi5vblVuUGluRXZlbnQsCiAgICAgIG9uVXBkYXRlQ29sdW1ucyA9IF9yZWYyLm9uVXBkYXRlQ29sdW1ucywKICAgICAgcm93UmVuZGVyZXJzID0gX3JlZjIucm93UmVuZGVyZXJzLAogICAgICBzZWxlY3RlZEV2ZW50SWRzID0gX3JlZjIuc2VsZWN0ZWRFdmVudElkcywKICAgICAgc2hvd0NoZWNrYm94ZXMgPSBfcmVmMi5zaG93Q2hlY2tib3hlcywKICAgICAgdGltZWxpbmVJZCA9IF9yZWYyLnRpbWVsaW5lSWQsCiAgICAgIHRvZ2dsZUNvbHVtbiA9IF9yZWYyLnRvZ2dsZUNvbHVtbiwKICAgICAgdXBkYXRlTm90ZSA9IF9yZWYyLnVwZGF0ZU5vdGU7CgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSh7fSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBleHBhbmRlZCA9IF91c2VTdGF0ZTJbMF0sCiAgICAgIHNldEV4cGFuZGVkID0gX3VzZVN0YXRlMlsxXTsKCiAgdmFyIF91c2VTdGF0ZTMgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKShmYWxzZSksCiAgICAgIF91c2VTdGF0ZTQgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUzLCAyKSwKICAgICAgaW5pdGlhbFJlbmRlciA9IF91c2VTdGF0ZTRbMF0sCiAgICAgIHNldEluaXRpYWxSZW5kZXIgPSBfdXNlU3RhdGU0WzFdOwoKICB2YXIgX3VzZVN0YXRlNSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKHt9KSwKICAgICAgX3VzZVN0YXRlNiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTUsIDIpLAogICAgICBzaG93Tm90ZXMgPSBfdXNlU3RhdGU2WzBdLAogICAgICBzZXRTaG93Tm90ZXMgPSBfdXNlU3RhdGU2WzFdOwoKICB2YXIgZGl2RWxlbWVudCA9ICgwLCBfcmVhY3QudXNlUmVmKShudWxsKTsKICB2YXIgb25Ub2dnbGVTaG93Tm90ZXMgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoKSB7CiAgICB2YXIgZXZlbnRJZCA9IGV2ZW50Ll9pZDsKICAgIHNldFNob3dOb3Rlcyhfb2JqZWN0U3ByZWFkKHt9LCBzaG93Tm90ZXMsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgZXZlbnRJZCwgIXNob3dOb3Rlc1tldmVudElkXSkpKTsKICB9LCBbZXZlbnQsIHNob3dOb3Rlc10pOwogIHZhciBvblRvZ2dsZUV4cGFuZGVkID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKCkgewogICAgdmFyIGV2ZW50SWQgPSBldmVudC5faWQ7CiAgICBzZXRFeHBhbmRlZChfb2JqZWN0U3ByZWFkKHt9LCBleHBhbmRlZCwgX2RlZmluZVByb3BlcnR5KHt9LCBldmVudElkLCAhZXhwYW5kZWRbZXZlbnRJZF0pKSk7CiAgfSwgW2V2ZW50LCBleHBhbmRlZF0pOwogIHZhciBhc3NvY2lhdGVOb3RlID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKG5vdGVJZCkgewogICAgYWRkTm90ZVRvRXZlbnQoewogICAgICBldmVudElkOiBldmVudC5faWQsCiAgICAgIG5vdGVJZDogbm90ZUlkCiAgICB9KTsKCiAgICBpZiAoIWlzRXZlbnRQaW5uZWQpIHsKICAgICAgb25QaW5FdmVudChldmVudC5faWQpOyAvLyBwaW4gdGhlIGV2ZW50LCBiZWNhdXNlIGl0IGhhcyBub3RlcwogICAgfQogIH0sIFthZGROb3RlVG9FdmVudCwgZXZlbnQsIGlzRXZlbnRQaW5uZWQsIG9uUGluRXZlbnRdKTsKICAvKioKICAgKiBJbmNyZW1lbnRhbGx5IGxvYWRzIHRoZSBldmVudHMgd2hlbiBpdCBtb3VudHMgYnkgdHJ5aW5nIHRvCiAgICogc2VlIGlmIGl0IHJlc2lkZXMgd2l0aGluIGEgd2luZG93IGZyYW1lIGFuZCBpZiBpdCBpcyBpdCB3aWxsCiAgICogaW5kaWNhdGUgdG8gUmVhY3QgdGhhdCBpdCBzaG91bGQgcmVuZGVyIGl0cyBzZWxmIGJ5IHNldHRpbmcKICAgKiBpdHMgaW5pdGlhbFJlbmRlciB0byB0cnVlLgogICAqLwoKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgdmFyIF9pc01vdW50ZWQgPSB0cnVlOwogICAgKDAsIF9zY2hlZHVsZXIucmVxdWVzdElkbGVDYWxsYmFja1ZpYVNjaGVkdWxlcikoZnVuY3Rpb24gKCkgewogICAgICBpZiAoIWluaXRpYWxSZW5kZXIgJiYgX2lzTW91bnRlZCkgewogICAgICAgIHNldEluaXRpYWxSZW5kZXIodHJ1ZSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAgdGltZW91dDogbWF4RGVsYXkKICAgIH0pOwogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgX2lzTW91bnRlZCA9IGZhbHNlOwogICAgfTsKICB9LCBbXSk7IC8vIE51bWJlciBvZiBjdXJyZW50IGNvbHVtbnMgcGx1cyBvbmUgZm9yIGFjdGlvbnMuCgogIHZhciBjb2x1bW5Db3VudCA9IGNvbHVtbkhlYWRlcnMubGVuZ3RoICsgMTsgLy8gSWYgd2UgYXJlIG5vdCByZWFkeSB0byByZW5kZXIgeWV0LCBqdXN0IHJldHVybiBudWxsCiAgLy8gc2VlIHVzZUVmZmVjdCgpIGZvciB3aGVuIGl0IHNjaGVkdWxlcyB0aGUgZmlyc3QKICAvLyB0aW1lIHRoaXMgc3RhdGVmdWwgY29tcG9uZW50IHNob3VsZCBiZSByZW5kZXJlZC4KCiAgaWYgKCFpbml0aWFsUmVuZGVyKSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2tlbGV0b25fcm93LlNrZWxldG9uUm93LCB7CiAgICAgIGNlbGxDb3VudDogY29sdW1uQ291bnQKICAgIH0pOwogIH0KCiAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0VmlzaWJpbGl0eVNlbnNvci5kZWZhdWx0LCB7CiAgICBwYXJ0aWFsVmlzaWJpbGl0eTogdHJ1ZSwKICAgIHNjcm9sbENoZWNrOiB0cnVlLAogICAgY29udGFpbm1lbnQ6IGNvbnRhaW5lckVsZW1lbnRSZWYsCiAgICBvZmZzZXQ6IHsKICAgICAgdG9wOiBUT1BfT0ZGU0VULAogICAgICBib3R0b206IEJPVFRPTV9PRkZTRVQKICAgIH0KICB9LCBmdW5jdGlvbiAoX3JlZjMpIHsKICAgIHZhciBpc1Zpc2libGUgPSBfcmVmMy5pc1Zpc2libGU7CgogICAgaWYgKGlzVmlzaWJsZSkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZGV0YWlscy5UaW1lbGluZURldGFpbHNRdWVyeSwgewogICAgICAgIHNvdXJjZUlkOiAiZGVmYXVsdCIsCiAgICAgICAgaW5kZXhOYW1lOiBldmVudC5faW5kZXgsCiAgICAgICAgZXZlbnRJZDogZXZlbnQuX2lkLAogICAgICAgIGV4ZWN1dGVRdWVyeTogISFleHBhbmRlZFtldmVudC5faWRdCiAgICAgIH0sIGZ1bmN0aW9uIChfcmVmNCkgewogICAgICAgIHZhciBkZXRhaWxzRGF0YSA9IF9yZWY0LmRldGFpbHNEYXRhLAogICAgICAgICAgICBsb2FkaW5nID0gX3JlZjQubG9hZGluZzsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3R5bGVzLkV2ZW50c1RyR3JvdXAsIHsKICAgICAgICAgIGNsYXNzTmFtZTogX2hlbHBlcnMuU1RBVEVGVUxfRVZFTlRfQ1NTX0NMQVNTX05BTUUsCiAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiZXZlbnQiLAogICAgICAgICAgZXZlbnRUeXBlOiAoMCwgX2hlbHBlcnMyLmdldEV2ZW50VHlwZSkoZXZlbnQuZWNzKSwKICAgICAgICAgIHNob3dMZWZ0Qm9yZGVyOiAhaXNFdmVudFZpZXdlciwKICAgICAgICAgIHJlZjogZGl2RWxlbWVudAogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V2ZW50X2NvbHVtbl92aWV3LkV2ZW50Q29sdW1uVmlldywgewogICAgICAgICAgaWQ6IGV2ZW50Ll9pZCwKICAgICAgICAgIGFjdGlvbnNDb2x1bW5XaWR0aDogYWN0aW9uc0NvbHVtbldpZHRoLAogICAgICAgICAgYXNzb2NpYXRlTm90ZTogYXNzb2NpYXRlTm90ZSwKICAgICAgICAgIGNvbHVtbkhlYWRlcnM6IGNvbHVtbkhlYWRlcnMsCiAgICAgICAgICBjb2x1bW5SZW5kZXJlcnM6IGNvbHVtblJlbmRlcmVycywKICAgICAgICAgIGRhdGE6IGV2ZW50LmRhdGEsCiAgICAgICAgICBlY3NEYXRhOiBldmVudC5lY3MsCiAgICAgICAgICBleHBhbmRlZDogISFleHBhbmRlZFtldmVudC5faWRdLAogICAgICAgICAgZXZlbnRJZFRvTm90ZUlkczogZXZlbnRJZFRvTm90ZUlkcywKICAgICAgICAgIGdldE5vdGVzQnlJZHM6IGdldE5vdGVzQnlJZHMsCiAgICAgICAgICBpc0V2ZW50UGlubmVkOiBpc0V2ZW50UGlubmVkLAogICAgICAgICAgaXNFdmVudFZpZXdlcjogaXNFdmVudFZpZXdlciwKICAgICAgICAgIGxvYWRpbmc6IGxvYWRpbmcsCiAgICAgICAgICBsb2FkaW5nRXZlbnRJZHM6IGxvYWRpbmdFdmVudElkcywKICAgICAgICAgIG9uQ29sdW1uUmVzaXplZDogb25Db2x1bW5SZXNpemVkLAogICAgICAgICAgb25FdmVudFRvZ2dsZWQ6IG9uVG9nZ2xlRXhwYW5kZWQsCiAgICAgICAgICBvblBpbkV2ZW50OiBvblBpbkV2ZW50LAogICAgICAgICAgb25Sb3dTZWxlY3RlZDogb25Sb3dTZWxlY3RlZCwKICAgICAgICAgIG9uVW5QaW5FdmVudDogb25VblBpbkV2ZW50LAogICAgICAgICAgc2VsZWN0ZWRFdmVudElkczogc2VsZWN0ZWRFdmVudElkcywKICAgICAgICAgIHNob3dDaGVja2JveGVzOiBzaG93Q2hlY2tib3hlcywKICAgICAgICAgIHNob3dOb3RlczogISFzaG93Tm90ZXNbZXZlbnQuX2lkXSwKICAgICAgICAgIHRpbWVsaW5lSWQ6IHRpbWVsaW5lSWQsCiAgICAgICAgICB0b2dnbGVTaG93Tm90ZXM6IG9uVG9nZ2xlU2hvd05vdGVzLAogICAgICAgICAgdXBkYXRlTm90ZTogdXBkYXRlTm90ZQogICAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEV2ZW50c1RyU3VwcGxlbWVudENvbnRhaW5lcldyYXBwZXIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3N0eWxlcy5FdmVudHNUclN1cHBsZW1lbnQsIHsKICAgICAgICAgIGNsYXNzTmFtZTogInNpZW1FdmVudHNUYWJsZV9fdHJTdXBwbGVtZW50LS1ub3RlcyIsCiAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiZXZlbnQtbm90ZXMtZmxleC1pdGVtIgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX25vdGVfY2FyZHMuTm90ZUNhcmRzLCB7CiAgICAgICAgICBhc3NvY2lhdGVOb3RlOiBhc3NvY2lhdGVOb3RlLAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogIm5vdGUtY2FyZHMiLAogICAgICAgICAgZ2V0TmV3Tm90ZUlkOiBnZXROZXdOb3RlSWQsCiAgICAgICAgICBnZXROb3Rlc0J5SWRzOiBnZXROb3Rlc0J5SWRzLAogICAgICAgICAgbm90ZUlkczogZXZlbnRJZFRvTm90ZUlkc1tldmVudC5faWRdIHx8IGVtcHR5Tm90ZXMsCiAgICAgICAgICBzaG93QWRkTm90ZTogISFzaG93Tm90ZXNbZXZlbnQuX2lkXSwKICAgICAgICAgIHRvZ2dsZVNob3dBZGROb3RlOiBvblRvZ2dsZVNob3dOb3RlcywKICAgICAgICAgIHVwZGF0ZU5vdGU6IHVwZGF0ZU5vdGUKICAgICAgICB9KSksICgwLCBfZ2V0X3Jvd19yZW5kZXJlci5nZXRSb3dSZW5kZXJlcikoZXZlbnQuZWNzLCByb3dSZW5kZXJlcnMpLnJlbmRlclJvdyh7CiAgICAgICAgICBicm93c2VyRmllbGRzOiBicm93c2VyRmllbGRzLAogICAgICAgICAgZGF0YTogZXZlbnQuZWNzLAogICAgICAgICAgdGltZWxpbmVJZDogdGltZWxpbmVJZAogICAgICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zdHlsZXMuRXZlbnRzVHJTdXBwbGVtZW50LCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJzaWVtRXZlbnRzVGFibGVfX3RyU3VwcGxlbWVudC0tYXR0cmlidXRlcyIsCiAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiZXZlbnQtZGV0YWlscyIKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9leHBhbmRhYmxlX2V2ZW50LkV4cGFuZGFibGVFdmVudCwgewogICAgICAgICAgYnJvd3NlckZpZWxkczogYnJvd3NlckZpZWxkcywKICAgICAgICAgIGNvbHVtbkhlYWRlcnM6IGNvbHVtbkhlYWRlcnMsCiAgICAgICAgICBldmVudDogZGV0YWlsc0RhdGEgfHwgZW1wdHlEZXRhaWxzLAogICAgICAgICAgZm9yY2VFeHBhbmQ6ICEhZXhwYW5kZWRbZXZlbnQuX2lkXSAmJiAhbG9hZGluZywKICAgICAgICAgIGlkOiBldmVudC5faWQsCiAgICAgICAgICBvblVwZGF0ZUNvbHVtbnM6IG9uVXBkYXRlQ29sdW1ucywKICAgICAgICAgIHRpbWVsaW5lSWQ6IHRpbWVsaW5lSWQsCiAgICAgICAgICB0b2dnbGVDb2x1bW46IHRvZ2dsZUNvbHVtbgogICAgICAgIH0pKSkpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIEhlaWdodCBwbGFjZSBob2xkZXIgZm9yIHZpc2liaWxpdHkgZGV0ZWN0aW9uIGFzIHdlbGwgYXMgcmUtcmVuZGVyaW5nIHNlY3Rpb25zLgogICAgICB2YXIgaGVpZ2h0ID0gZGl2RWxlbWVudC5jdXJyZW50ICE9IG51bGwgJiYgZGl2RWxlbWVudC5jdXJyZW50LmNsaWVudEhlaWdodCA/ICIiLmNvbmNhdChkaXZFbGVtZW50LmN1cnJlbnQuY2xpZW50SGVpZ2h0LCAicHgiKSA6IERFRkFVTFRfUk9XX0hFSUdIVDsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NrZWxldG9uX3Jvdy5Ta2VsZXRvblJvdywgewogICAgICAgIGNlbGxDb3VudDogY29sdW1uQ291bnQsCiAgICAgICAgcm93SGVpZ2h0OiBoZWlnaHQKICAgICAgfSk7CiAgICB9CiAgfSk7Cn07Cgp2YXIgU3RhdGVmdWxFdmVudCA9IF9yZWFjdC5kZWZhdWx0Lm1lbW8oU3RhdGVmdWxFdmVudENvbXBvbmVudCk7CgpleHBvcnRzLlN0YXRlZnVsRXZlbnQgPSBTdGF0ZWZ1bEV2ZW50Ow=="},null]}