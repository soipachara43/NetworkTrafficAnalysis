{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/lens/public/indexpattern_datasource/loader.js","dependencies":[{"path":"x-pack/legacy/plugins/lens/public/indexpattern_datasource/loader.js","mtime":1589249552308},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmxvYWRJbmRleFBhdHRlcm5zID0gbG9hZEluZGV4UGF0dGVybnM7CmV4cG9ydHMubG9hZEluaXRpYWxTdGF0ZSA9IGxvYWRJbml0aWFsU3RhdGU7CmV4cG9ydHMuY2hhbmdlSW5kZXhQYXR0ZXJuID0gY2hhbmdlSW5kZXhQYXR0ZXJuOwpleHBvcnRzLmNoYW5nZUxheWVySW5kZXhQYXR0ZXJuID0gY2hhbmdlTGF5ZXJJbmRleFBhdHRlcm47CmV4cG9ydHMuc3luY0V4aXN0aW5nRmllbGRzID0gc3luY0V4aXN0aW5nRmllbGRzOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfc3RhdGVfaGVscGVycyA9IHJlcXVpcmUoIi4vc3RhdGVfaGVscGVycyIpOwoKdmFyIF9jb21tb24gPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9wbHVnaW5zL2xlbnMvY29tbW9uIik7Cgp2YXIgX2RvY3VtZW50X2ZpZWxkID0gcmVxdWlyZSgiLi9kb2N1bWVudF9maWVsZCIpOwoKdmFyIF9wdWJsaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9kYXRhL3B1YmxpYyIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogewogICAgZGVmYXVsdDogb2JqCiAgfTsKfQoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICB9CgogICAgcmV0dXJuIGFycjI7CiAgfQp9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgewogIHRyeSB7CiAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7CiAgICB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICByZWplY3QoZXJyb3IpOwogICAgcmV0dXJuOwogIH0KCiAgaWYgKGluZm8uZG9uZSkgewogICAgcmVzb2x2ZSh2YWx1ZSk7CiAgfSBlbHNlIHsKICAgIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsKICB9Cn0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICBhcmdzID0gYXJndW1lbnRzOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOwoKICAgICAgZnVuY3Rpb24gX25leHQodmFsdWUpIHsKICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOwogICAgICB9CgogICAgICBfbmV4dCh1bmRlZmluZWQpOwogICAgfSk7CiAgfTsKfQoKZnVuY3Rpb24gbG9hZEluZGV4UGF0dGVybnMoX3gpIHsKICByZXR1cm4gX2xvYWRJbmRleFBhdHRlcm5zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9sb2FkSW5kZXhQYXR0ZXJucygpIHsKICBfbG9hZEluZGV4UGF0dGVybnMgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShfcmVmKSB7CiAgICB2YXIgcGF0dGVybnMsIHNhdmVkT2JqZWN0c0NsaWVudCwgY2FjaGUsIG1pc3NpbmdJZHMsIHJlc3A7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHBhdHRlcm5zID0gX3JlZi5wYXR0ZXJucywgc2F2ZWRPYmplY3RzQ2xpZW50ID0gX3JlZi5zYXZlZE9iamVjdHNDbGllbnQsIGNhY2hlID0gX3JlZi5jYWNoZTsKICAgICAgICAgICAgbWlzc2luZ0lkcyA9IHBhdHRlcm5zLmZpbHRlcihmdW5jdGlvbiAoaWQpIHsKICAgICAgICAgICAgICByZXR1cm4gIWNhY2hlW2lkXTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAoIShtaXNzaW5nSWRzLmxlbmd0aCA9PT0gMCkpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgY2FjaGUpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgIHJldHVybiBzYXZlZE9iamVjdHNDbGllbnQuYnVsa0dldChtaXNzaW5nSWRzLm1hcChmdW5jdGlvbiAoaWQpIHsKICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgdHlwZTogJ2luZGV4LXBhdHRlcm4nCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSkpOwoKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHJlc3Auc2F2ZWRPYmplY3RzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBzYXZlZE9iamVjdCkgewogICAgICAgICAgICAgIHZhciBpbmRleFBhdHRlcm4gPSBmcm9tU2F2ZWRPYmplY3Qoc2F2ZWRPYmplY3QpOwogICAgICAgICAgICAgIGFjY1tpbmRleFBhdHRlcm4uaWRdID0gaW5kZXhQYXR0ZXJuOwogICAgICAgICAgICAgIHJldHVybiBhY2M7CiAgICAgICAgICAgIH0sIF9vYmplY3RTcHJlYWQoe30sIGNhY2hlKSkpOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSk7CiAgcmV0dXJuIF9sb2FkSW5kZXhQYXR0ZXJucy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBsb2FkSW5pdGlhbFN0YXRlKF94MikgewogIHJldHVybiBfbG9hZEluaXRpYWxTdGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfbG9hZEluaXRpYWxTdGF0ZSgpIHsKICBfbG9hZEluaXRpYWxTdGF0ZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihfcmVmMikgewogICAgdmFyIHN0YXRlLCBzYXZlZE9iamVjdHNDbGllbnQsIGRlZmF1bHRJbmRleFBhdHRlcm5JZCwgaW5kZXhQYXR0ZXJuUmVmcywgcmVxdWlyZWRQYXR0ZXJucywgY3VycmVudEluZGV4UGF0dGVybklkLCBpbmRleFBhdHRlcm5zOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgc3RhdGUgPSBfcmVmMi5zdGF0ZSwgc2F2ZWRPYmplY3RzQ2xpZW50ID0gX3JlZjIuc2F2ZWRPYmplY3RzQ2xpZW50LCBkZWZhdWx0SW5kZXhQYXR0ZXJuSWQgPSBfcmVmMi5kZWZhdWx0SW5kZXhQYXR0ZXJuSWQ7CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgcmV0dXJuIGxvYWRJbmRleFBhdHRlcm5SZWZzKHNhdmVkT2JqZWN0c0NsaWVudCk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBpbmRleFBhdHRlcm5SZWZzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgIHJlcXVpcmVkUGF0dGVybnMgPSBfbG9kYXNoLmRlZmF1bHQudW5pcXVlKHN0YXRlID8gT2JqZWN0LnZhbHVlcyhzdGF0ZS5sYXllcnMpLm1hcChmdW5jdGlvbiAobCkgewogICAgICAgICAgICAgIHJldHVybiBsLmluZGV4UGF0dGVybklkOwogICAgICAgICAgICB9KS5jb25jYXQoc3RhdGUuY3VycmVudEluZGV4UGF0dGVybklkKSA6IFtkZWZhdWx0SW5kZXhQYXR0ZXJuSWQgfHwgaW5kZXhQYXR0ZXJuUmVmc1swXS5pZF0pOwogICAgICAgICAgICBjdXJyZW50SW5kZXhQYXR0ZXJuSWQgPSByZXF1aXJlZFBhdHRlcm5zWzBdOwogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDg7CiAgICAgICAgICAgIHJldHVybiBsb2FkSW5kZXhQYXR0ZXJucyh7CiAgICAgICAgICAgICAgc2F2ZWRPYmplY3RzQ2xpZW50OiBzYXZlZE9iamVjdHNDbGllbnQsCiAgICAgICAgICAgICAgY2FjaGU6IHt9LAogICAgICAgICAgICAgIHBhdHRlcm5zOiByZXF1aXJlZFBhdHRlcm5zCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgaW5kZXhQYXR0ZXJucyA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgaWYgKCFzdGF0ZSkgewogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBfb2JqZWN0U3ByZWFkKHt9LCBzdGF0ZSwgewogICAgICAgICAgICAgIGN1cnJlbnRJbmRleFBhdHRlcm5JZDogY3VycmVudEluZGV4UGF0dGVybklkLAogICAgICAgICAgICAgIGluZGV4UGF0dGVyblJlZnM6IGluZGV4UGF0dGVyblJlZnMsCiAgICAgICAgICAgICAgaW5kZXhQYXR0ZXJuczogaW5kZXhQYXR0ZXJucywKICAgICAgICAgICAgICBzaG93RW1wdHlGaWVsZHM6IGZhbHNlLAogICAgICAgICAgICAgIGV4aXN0aW5nRmllbGRzOiB7fQogICAgICAgICAgICB9KSk7CgogICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICBjdXJyZW50SW5kZXhQYXR0ZXJuSWQ6IGN1cnJlbnRJbmRleFBhdHRlcm5JZCwKICAgICAgICAgICAgICBpbmRleFBhdHRlcm5SZWZzOiBpbmRleFBhdHRlcm5SZWZzLAogICAgICAgICAgICAgIGluZGV4UGF0dGVybnM6IGluZGV4UGF0dGVybnMsCiAgICAgICAgICAgICAgbGF5ZXJzOiB7fSwKICAgICAgICAgICAgICBzaG93RW1wdHlGaWVsZHM6IGZhbHNlLAogICAgICAgICAgICAgIGV4aXN0aW5nRmllbGRzOiB7fQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMik7CiAgfSkpOwogIHJldHVybiBfbG9hZEluaXRpYWxTdGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBjaGFuZ2VJbmRleFBhdHRlcm4oX3gzKSB7CiAgcmV0dXJuIF9jaGFuZ2VJbmRleFBhdHRlcm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2NoYW5nZUluZGV4UGF0dGVybigpIHsKICBfY2hhbmdlSW5kZXhQYXR0ZXJuID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgLyojX19QVVJFX18qLwogIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKF9yZWYzKSB7CiAgICB2YXIgaWQsIHNhdmVkT2JqZWN0c0NsaWVudCwgc3RhdGUsIHNldFN0YXRlLCBvbkVycm9yLCBpbmRleFBhdHRlcm5zOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgaWQgPSBfcmVmMy5pZCwgc2F2ZWRPYmplY3RzQ2xpZW50ID0gX3JlZjMuc2F2ZWRPYmplY3RzQ2xpZW50LCBzdGF0ZSA9IF9yZWYzLnN0YXRlLCBzZXRTdGF0ZSA9IF9yZWYzLnNldFN0YXRlLCBvbkVycm9yID0gX3JlZjMub25FcnJvcjsKICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAxOwogICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDQ7CiAgICAgICAgICAgIHJldHVybiBsb2FkSW5kZXhQYXR0ZXJucyh7CiAgICAgICAgICAgICAgc2F2ZWRPYmplY3RzQ2xpZW50OiBzYXZlZE9iamVjdHNDbGllbnQsCiAgICAgICAgICAgICAgY2FjaGU6IHN0YXRlLmluZGV4UGF0dGVybnMsCiAgICAgICAgICAgICAgcGF0dGVybnM6IFtpZF0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBpbmRleFBhdHRlcm5zID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgIHNldFN0YXRlKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIHMsIHsKICAgICAgICAgICAgICAgIGxheWVyczogaXNTaW5nbGVFbXB0eUxheWVyKHN0YXRlLmxheWVycykgPyBfbG9kYXNoLmRlZmF1bHQubWFwVmFsdWVzKHN0YXRlLmxheWVycywgZnVuY3Rpb24gKGxheWVyKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX3N0YXRlX2hlbHBlcnMudXBkYXRlTGF5ZXJJbmRleFBhdHRlcm4pKGxheWVyLCBpbmRleFBhdHRlcm5zW2lkXSk7CiAgICAgICAgICAgICAgICB9KSA6IHN0YXRlLmxheWVycywKICAgICAgICAgICAgICAgIGluZGV4UGF0dGVybnM6IF9vYmplY3RTcHJlYWQoe30sIHMuaW5kZXhQYXR0ZXJucywgX2RlZmluZVByb3BlcnR5KHt9LCBpZCwgaW5kZXhQYXR0ZXJuc1tpZF0pKSwKICAgICAgICAgICAgICAgIGN1cnJlbnRJbmRleFBhdHRlcm5JZDogaWQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTE7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSA4OwogICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oMSk7CiAgICAgICAgICAgIG9uRXJyb3IoX2NvbnRleHQzLnQwKTsKCiAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMywgbnVsbCwgW1sxLCA4XV0pOwogIH0pKTsKICByZXR1cm4gX2NoYW5nZUluZGV4UGF0dGVybi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBjaGFuZ2VMYXllckluZGV4UGF0dGVybihfeDQpIHsKICByZXR1cm4gX2NoYW5nZUxheWVySW5kZXhQYXR0ZXJuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9jaGFuZ2VMYXllckluZGV4UGF0dGVybigpIHsKICBfY2hhbmdlTGF5ZXJJbmRleFBhdHRlcm4gPSBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoX3JlZjQpIHsKICAgIHZhciBpbmRleFBhdHRlcm5JZCwgbGF5ZXJJZCwgc2F2ZWRPYmplY3RzQ2xpZW50LCBzdGF0ZSwgc2V0U3RhdGUsIG9uRXJyb3IsIHJlcGxhY2VJZlBvc3NpYmxlLCBpbmRleFBhdHRlcm5zOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgaW5kZXhQYXR0ZXJuSWQgPSBfcmVmNC5pbmRleFBhdHRlcm5JZCwgbGF5ZXJJZCA9IF9yZWY0LmxheWVySWQsIHNhdmVkT2JqZWN0c0NsaWVudCA9IF9yZWY0LnNhdmVkT2JqZWN0c0NsaWVudCwgc3RhdGUgPSBfcmVmNC5zdGF0ZSwgc2V0U3RhdGUgPSBfcmVmNC5zZXRTdGF0ZSwgb25FcnJvciA9IF9yZWY0Lm9uRXJyb3IsIHJlcGxhY2VJZlBvc3NpYmxlID0gX3JlZjQucmVwbGFjZUlmUG9zc2libGU7CiAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gMTsKICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA0OwogICAgICAgICAgICByZXR1cm4gbG9hZEluZGV4UGF0dGVybnMoewogICAgICAgICAgICAgIHNhdmVkT2JqZWN0c0NsaWVudDogc2F2ZWRPYmplY3RzQ2xpZW50LAogICAgICAgICAgICAgIGNhY2hlOiBzdGF0ZS5pbmRleFBhdHRlcm5zLAogICAgICAgICAgICAgIHBhdHRlcm5zOiBbaW5kZXhQYXR0ZXJuSWRdCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgaW5kZXhQYXR0ZXJucyA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICBzZXRTdGF0ZShmdW5jdGlvbiAocykgewogICAgICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHt9LCBzLCB7CiAgICAgICAgICAgICAgICBsYXllcnM6IF9vYmplY3RTcHJlYWQoe30sIHMubGF5ZXJzLCBfZGVmaW5lUHJvcGVydHkoe30sIGxheWVySWQsICgwLCBfc3RhdGVfaGVscGVycy51cGRhdGVMYXllckluZGV4UGF0dGVybikocy5sYXllcnNbbGF5ZXJJZF0sIGluZGV4UGF0dGVybnNbaW5kZXhQYXR0ZXJuSWRdKSkpLAogICAgICAgICAgICAgICAgaW5kZXhQYXR0ZXJuczogX29iamVjdFNwcmVhZCh7fSwgcy5pbmRleFBhdHRlcm5zLCBfZGVmaW5lUHJvcGVydHkoe30sIGluZGV4UGF0dGVybklkLCBpbmRleFBhdHRlcm5zW2luZGV4UGF0dGVybklkXSkpLAogICAgICAgICAgICAgICAgY3VycmVudEluZGV4UGF0dGVybklkOiByZXBsYWNlSWZQb3NzaWJsZSA/IGluZGV4UGF0dGVybklkIDogcy5jdXJyZW50SW5kZXhQYXR0ZXJuSWQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTE7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSA4OwogICAgICAgICAgICBfY29udGV4dDQudDAgPSBfY29udGV4dDRbImNhdGNoIl0oMSk7CiAgICAgICAgICAgIG9uRXJyb3IoX2NvbnRleHQ0LnQwKTsKCiAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlNCwgbnVsbCwgW1sxLCA4XV0pOwogIH0pKTsKICByZXR1cm4gX2NoYW5nZUxheWVySW5kZXhQYXR0ZXJuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIGxvYWRJbmRleFBhdHRlcm5SZWZzKF94NSkgewogIHJldHVybiBfbG9hZEluZGV4UGF0dGVyblJlZnMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2xvYWRJbmRleFBhdHRlcm5SZWZzKCkgewogIF9sb2FkSW5kZXhQYXR0ZXJuUmVmcyA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNShzYXZlZE9iamVjdHNDbGllbnQpIHsKICAgIHZhciByZXN1bHQ7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBzYXZlZE9iamVjdHNDbGllbnQuZmluZCh7CiAgICAgICAgICAgICAgdHlwZTogJ2luZGV4LXBhdHRlcm4nLAogICAgICAgICAgICAgIGZpZWxkczogWyd0aXRsZSddLAogICAgICAgICAgICAgIHBlclBhZ2U6IDEwMDAwCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCByZXN1bHQuc2F2ZWRPYmplY3RzLm1hcChmdW5jdGlvbiAobykgewogICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBpZDogU3RyaW5nKG8uaWQpLAogICAgICAgICAgICAgICAgdGl0bGU6IG8uYXR0cmlidXRlcy50aXRsZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICByZXR1cm4gYS50aXRsZS5sb2NhbGVDb21wYXJlKGIudGl0bGUpOwogICAgICAgICAgICB9KSk7CgogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlNSk7CiAgfSkpOwogIHJldHVybiBfbG9hZEluZGV4UGF0dGVyblJlZnMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gc3luY0V4aXN0aW5nRmllbGRzKF94NikgewogIHJldHVybiBfc3luY0V4aXN0aW5nRmllbGRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9zeW5jRXhpc3RpbmdGaWVsZHMoKSB7CiAgX3N5bmNFeGlzdGluZ0ZpZWxkcyA9IF9hc3luY1RvR2VuZXJhdG9yKAogIC8qI19fUFVSRV9fKi8KICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNihfcmVmNSkgewogICAgdmFyIGluZGV4UGF0dGVybnMsIGRhdGVSYW5nZSwgZmV0Y2hKc29uLCBzZXRTdGF0ZSwgZHNsUXVlcnksIGVtcHRpbmVzc0luZm87CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBpbmRleFBhdHRlcm5zID0gX3JlZjUuaW5kZXhQYXR0ZXJucywgZGF0ZVJhbmdlID0gX3JlZjUuZGF0ZVJhbmdlLCBmZXRjaEpzb24gPSBfcmVmNS5mZXRjaEpzb24sIHNldFN0YXRlID0gX3JlZjUuc2V0U3RhdGUsIGRzbFF1ZXJ5ID0gX3JlZjUuZHNsUXVlcnk7CiAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGluZGV4UGF0dGVybnMubWFwKGZ1bmN0aW9uIChwYXR0ZXJuKSB7CiAgICAgICAgICAgICAgdmFyIGJvZHkgPSB7CiAgICAgICAgICAgICAgICBkc2xRdWVyeTogZHNsUXVlcnksCiAgICAgICAgICAgICAgICBmcm9tRGF0ZTogZGF0ZVJhbmdlLmZyb21EYXRlLAogICAgICAgICAgICAgICAgdG9EYXRlOiBkYXRlUmFuZ2UudG9EYXRlCiAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgaWYgKHBhdHRlcm4udGltZUZpZWxkTmFtZSkgewogICAgICAgICAgICAgICAgYm9keS50aW1lRmllbGROYW1lID0gcGF0dGVybi50aW1lRmllbGROYW1lOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIGZldGNoSnNvbigiIi5jb25jYXQoX2NvbW1vbi5CQVNFX0FQSV9VUkwsICIvZXhpc3RpbmdfZmllbGRzLyIpLmNvbmNhdChwYXR0ZXJuLmlkKSwgewogICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSkKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSkpOwoKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgZW1wdGluZXNzSW5mbyA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICBzZXRTdGF0ZShmdW5jdGlvbiAoc3RhdGUpIHsKICAgICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgc3RhdGUsIHsKICAgICAgICAgICAgICAgIGV4aXN0aW5nRmllbGRzOiBlbXB0aW5lc3NJbmZvLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBpbmZvKSB7CiAgICAgICAgICAgICAgICAgIGFjY1tpbmZvLmluZGV4UGF0dGVyblRpdGxlXSA9IGJvb2xlYW5NYXAoaW5mby5leGlzdGluZ0ZpZWxkTmFtZXMpOwogICAgICAgICAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgICAgICAgICAgfSwgc3RhdGUuZXhpc3RpbmdGaWVsZHMpCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTYpOwogIH0pKTsKICByZXR1cm4gX3N5bmNFeGlzdGluZ0ZpZWxkcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBib29sZWFuTWFwKGtleXMpIHsKICByZXR1cm4ga2V5cy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywga2V5KSB7CiAgICBhY2Nba2V5XSA9IHRydWU7CiAgICByZXR1cm4gYWNjOwogIH0sIHt9KTsKfQoKZnVuY3Rpb24gaXNTaW5nbGVFbXB0eUxheWVyKGxheWVyTWFwKSB7CiAgdmFyIGxheWVycyA9IE9iamVjdC52YWx1ZXMobGF5ZXJNYXApOwogIHJldHVybiBsYXllcnMubGVuZ3RoID09PSAxICYmIGxheWVyc1swXS5jb2x1bW5PcmRlci5sZW5ndGggPT09IDA7Cn0KCmZ1bmN0aW9uIGZyb21TYXZlZE9iamVjdChzYXZlZE9iamVjdCkgewogIHZhciBpZCA9IHNhdmVkT2JqZWN0LmlkLAogICAgICBhdHRyaWJ1dGVzID0gc2F2ZWRPYmplY3QuYXR0cmlidXRlcywKICAgICAgdHlwZSA9IHNhdmVkT2JqZWN0LnR5cGU7CgogIHZhciBpbmRleFBhdHRlcm4gPSBfb2JqZWN0U3ByZWFkKHt9LCBhdHRyaWJ1dGVzLCB7CiAgICBpZDogaWQsCiAgICB0eXBlOiB0eXBlLAogICAgdGl0bGU6IGF0dHJpYnV0ZXMudGl0bGUsCiAgICBmaWVsZHM6IEpTT04ucGFyc2UoYXR0cmlidXRlcy5maWVsZHMpLmZpbHRlcihmdW5jdGlvbiAoZmllbGQpIHsKICAgICAgcmV0dXJuICFfcHVibGljLmluZGV4UGF0dGVybnMuaXNOZXN0ZWRGaWVsZChmaWVsZCkgJiYgKCEhZmllbGQuYWdncmVnYXRhYmxlIHx8ICEhZmllbGQuc2NyaXB0ZWQpOwogICAgfSkuY29uY2F0KF9kb2N1bWVudF9maWVsZC5kb2N1bWVudEZpZWxkKSwKICAgIHR5cGVNZXRhOiBhdHRyaWJ1dGVzLnR5cGVNZXRhID8gSlNPTi5wYXJzZShhdHRyaWJ1dGVzLnR5cGVNZXRhKSA6IHVuZGVmaW5lZCwKICAgIGZpZWxkRm9ybWF0TWFwOiBhdHRyaWJ1dGVzLmZpZWxkRm9ybWF0TWFwID8gSlNPTi5wYXJzZShhdHRyaWJ1dGVzLmZpZWxkRm9ybWF0TWFwKSA6IHVuZGVmaW5lZAogIH0pOwoKICB2YXIgdHlwZU1ldGEgPSBpbmRleFBhdHRlcm4udHlwZU1ldGE7CgogIGlmICghdHlwZU1ldGEpIHsKICAgIHJldHVybiBpbmRleFBhdHRlcm47CiAgfQoKICB2YXIgbmV3RmllbGRzID0gX3RvQ29uc3VtYWJsZUFycmF5KGluZGV4UGF0dGVybi5maWVsZHMpOwoKICBpZiAodHlwZU1ldGEuYWdncykgewogICAgdmFyIGFnZ3MgPSBPYmplY3Qua2V5cyh0eXBlTWV0YS5hZ2dzKTsKICAgIG5ld0ZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChmaWVsZCwgaW5kZXgpIHsKICAgICAgdmFyIHJlc3RyaWN0aW9uc09iaiA9IHt9OwogICAgICBhZ2dzLmZvckVhY2goZnVuY3Rpb24gKGFnZykgewogICAgICAgIHZhciByZXN0cmljdGlvbiA9IHR5cGVNZXRhLmFnZ3MgJiYgdHlwZU1ldGEuYWdnc1thZ2ddICYmIHR5cGVNZXRhLmFnZ3NbYWdnXVtmaWVsZC5uYW1lXTsKCiAgICAgICAgaWYgKHJlc3RyaWN0aW9uKSB7CiAgICAgICAgICByZXN0cmljdGlvbnNPYmpbYWdnXSA9IHJlc3RyaWN0aW9uOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICBpZiAoT2JqZWN0LmtleXMocmVzdHJpY3Rpb25zT2JqKS5sZW5ndGgpIHsKICAgICAgICBuZXdGaWVsZHNbaW5kZXhdID0gX29iamVjdFNwcmVhZCh7fSwgZmllbGQsIHsKICAgICAgICAgIGFnZ3JlZ2F0aW9uUmVzdHJpY3Rpb25zOiByZXN0cmljdGlvbnNPYmoKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CiAgfQoKICByZXR1cm4gewogICAgaWQ6IGluZGV4UGF0dGVybi5pZCwKICAgIHRpdGxlOiBpbmRleFBhdHRlcm4udGl0bGUsCiAgICB0aW1lRmllbGROYW1lOiBpbmRleFBhdHRlcm4udGltZUZpZWxkTmFtZSB8fCB1bmRlZmluZWQsCiAgICBmaWVsZHM6IG5ld0ZpZWxkcwogIH07Cn0="},null]}