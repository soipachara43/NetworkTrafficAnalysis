{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/plugins/index_management/public/application/sections/home/index_list/index_actions_context_menu/index_actions_context_menu.js","dependencies":[{"path":"x-pack/plugins/index_management/public/application/sections/home/index_list/index_actions_context_menu/index_actions_context_menu.js","mtime":1589249554136},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkluZGV4QWN0aW9uc0NvbnRleHRNZW51ID0gdm9pZCAwOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9yZWFjdDIgPSByZXF1aXJlKCJAa2JuL2kxOG4vcmVhY3QiKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9sb2Rhc2ggPSByZXF1aXJlKCJsb2Rhc2giKTsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2ZsYXR0ZW5fcGFuZWxfdHJlZSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2xpYi9mbGF0dGVuX3BhbmVsX3RyZWUiKTsKCnZhciBfY29uc3RhbnRzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cyIpOwoKdmFyIF9hcHBfY29udGV4dCA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2FwcF9jb250ZXh0Iik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7IHZhciBkZXNjID0gT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSA6IHt9OyBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsgfSBlbHNlIHsgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOyB9IH0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCnZhciBJbmRleEFjdGlvbnNDb250ZXh0TWVudSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9Db21wb25lbnQpIHsKICBfaW5oZXJpdHMoSW5kZXhBY3Rpb25zQ29udGV4dE1lbnUsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBJbmRleEFjdGlvbnNDb250ZXh0TWVudShwcm9wcykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbmRleEFjdGlvbnNDb250ZXh0TWVudSk7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoSW5kZXhBY3Rpb25zQ29udGV4dE1lbnUpLmNhbGwodGhpcywgcHJvcHMpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjbG9zZUNvbmZpcm1Nb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIHJlbmRlckNvbmZpcm1Nb2RhbDogbnVsbAogICAgICB9KTsKCiAgICAgIF90aGlzLnByb3BzLnJlc2V0U2VsZWN0aW9uICYmIF90aGlzLnByb3BzLnJlc2V0U2VsZWN0aW9uKCk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjb25maXJtQWN0aW9uIiwgZnVuY3Rpb24gKGlzQWN0aW9uQ29uZmlybWVkKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc0FjdGlvbkNvbmZpcm1lZDogaXNBY3Rpb25Db25maXJtZWQKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJvbkJ1dHRvbkNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAocHJldlN0YXRlKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGlzUG9wb3Zlck9wZW46ICFwcmV2U3RhdGUuaXNQb3BvdmVyT3BlbgogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2xvc2VQb3BvdmVyQW5kRXhlY3V0ZSIsIGZ1bmN0aW9uIChmdW5jKSB7CiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBpc1BvcG92ZXJPcGVuOiBmYWxzZSwKICAgICAgICByZW5kZXJDb25maXJtTW9kYWw6IGZhbHNlCiAgICAgIH0pOwoKICAgICAgZnVuYygpOwogICAgICBfdGhpcy5wcm9wcy5yZXNldFNlbGVjdGlvbiAmJiBfdGhpcy5wcm9wcy5yZXNldFNlbGVjdGlvbigpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2xvc2VQb3BvdmVyIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgaXNQb3BvdmVyT3BlbjogZmFsc2UKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJmb3JjZW1lcmdlU2VnbWVudHNFcnJvciIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGZvcmNlbWVyZ2VTZWdtZW50cyA9IF90aGlzLnN0YXRlLmZvcmNlbWVyZ2VTZWdtZW50czsKCiAgICAgIGlmICghZm9yY2VtZXJnZVNlZ21lbnRzIHx8IGZvcmNlbWVyZ2VTZWdtZW50cy5tYXRjaCgvXihbMS05XVswLTldKik/JC8pKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LnNlZ21lbnRzTnVtYmVyRXJyb3JNZXNzYWdlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGUgbnVtYmVyIG9mIHNlZ21lbnRzIG11c3QgYmUgZ3JlYXRlciB0aGFuIHplcm8uJwogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZW5kZXJGb3JjZW1lcmdlU2VnbWVudHNNb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF90aGlzJHByb3BzID0gX3RoaXMucHJvcHMsCiAgICAgICAgICBmb3JjZW1lcmdlSW5kaWNlcyA9IF90aGlzJHByb3BzLmZvcmNlbWVyZ2VJbmRpY2VzLAogICAgICAgICAgaW5kZXhOYW1lcyA9IF90aGlzJHByb3BzLmluZGV4TmFtZXM7CgogICAgICB2YXIgaGVscFRleHQgPSBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmZvcmNlTWVyZ2UuZm9yY2VNZXJnZVNlZ21lbnRzSGVscFRleHQnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdNZXJnZSB0aGUgc2VnbWVudHMgaW4gYW4gaW5kZXggdW50aWwgdGhlIG51bWJlciBpcyByZWR1Y2VkIHRvIHRoaXMgb3IgZmV3ZXIgc2VnbWVudHMuIFRoZSBkZWZhdWx0IGlzIDEuJwogICAgICB9KTsKCiAgICAgIHZhciBzZWxlY3RlZEluZGV4Q291bnQgPSBpbmRleE5hbWVzLmxlbmd0aDsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlPdmVybGF5TWFzaywgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvbmZpcm1Nb2RhbCwgewogICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmZvcmNlTWVyZ2UuY29uZmlybU1vZGFsLm1vZGFsVGl0bGUnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ZvcmNlIG1lcmdlJwogICAgICAgIH0pLAogICAgICAgIG9uQ2FuY2VsOiBfdGhpcy5jbG9zZUNvbmZpcm1Nb2RhbCwKICAgICAgICBvbkNvbmZpcm06IGZ1bmN0aW9uIG9uQ29uZmlybSgpIHsKICAgICAgICAgIGlmICghX3RoaXMuZm9yY2VtZXJnZVNlZ21lbnRzRXJyb3IoKSkgewogICAgICAgICAgICBfdGhpcy5jbG9zZVBvcG92ZXJBbmRFeGVjdXRlKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBmb3JjZW1lcmdlSW5kaWNlcyhfdGhpcy5zdGF0ZS5mb3JjZW1lcmdlU2VnbWVudHMpOwoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBmb3JjZW1lcmdlU2VnbWVudHM6IG51bGwsCiAgICAgICAgICAgICAgICBzaG93Rm9yY2VtZXJnZVNlZ21lbnRzTW9kYWw6IG51bGwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmZvcmNlTWVyZ2UuY29uZmlybU1vZGFsLmNhbmNlbEJ1dHRvblRleHQnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0NhbmNlbCcKICAgICAgICB9KSwKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5mb3JjZU1lcmdlLmNvbmZpcm1Nb2RhbC5jb25maXJtQnV0dG9uVGV4dCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRm9yY2UgbWVyZ2UnCiAgICAgICAgfSkKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuZm9yY2VNZXJnZS5mb3JjZU1lcmdlRGVzY3JpcHRpb24iLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiWW91IGFyZSBhYm91dCB0byBmb3JjZSBtZXJnZSB7c2VsZWN0ZWRJbmRleENvdW50LCBwbHVyYWwsIG9uZSB7dGhpcyBpbmRleH0gb3RoZXIge3RoZXNlIGluZGljZXN9IH06IiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIHNlbGVjdGVkSW5kZXhDb3VudDogc2VsZWN0ZWRJbmRleENvdW50CiAgICAgICAgfQogICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInVsIiwgbnVsbCwgaW5kZXhOYW1lcy5tYXAoZnVuY3Rpb24gKGluZGV4TmFtZSkgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJsaSIsIHsKICAgICAgICAgIGtleTogaW5kZXhOYW1lCiAgICAgICAgfSwgaW5kZXhOYW1lKTsKICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ2FsbE91dCwgewogICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmZvcmNlTWVyZ2UucHJvY2VlZFdpdGhDYXV0aW9uQ2FsbE91dFRpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdQcm9jZWVkIHdpdGggY2F1dGlvbiEnCiAgICAgICAgfSksCiAgICAgICAgY29sb3I6ICJ3YXJuaW5nIiwKICAgICAgICBpY29uVHlwZTogImhlbHAiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmZvcmNlTWVyZ2UuZm9yY2VNZXJnZVdhcm5pbmdEZXNjcmlwdGlvbiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICIgRm9yY2UgbWVyZ2luZyBhIGxhcmdlIGluZGV4IG9yIGFuIGluZGV4IHRoYXQgaXMgbm90IHJlYWQtb25seSBjYW4gcG90ZW50aWFsbHkgY2F1c2UgcGVyZm9ybWFuY2UgYW5kIHN0YWJpbGl0eSBpc3N1ZXMgaW4gdGhlIGNsdXN0ZXIgaWYgaXQgaXMgbm90IHJ1biBwcm9wZXJseSAocnVuIGFnYWluc3Qgbm9uLXJlYWQtb25seSBpbmRpY2VzKSBvciBydW4gZHVyaW5nIHBlYWsgaG91cnMuICIKICAgICAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgICAgIHNpemU6ICJtIgogICAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZvcm0sIHsKICAgICAgICBpc0ludmFsaWQ6ICEhX3RoaXMuZm9yY2VtZXJnZVNlZ21lbnRzRXJyb3IoKSwKICAgICAgICBlcnJvcjogX3RoaXMuZm9yY2VtZXJnZVNlZ21lbnRzRXJyb3IoKQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRm9ybVJvdywgewogICAgICAgIGxhYmVsOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmZvcmNlTWVyZ2UubWF4aW11bU51bWJlck9mU2VnbWVudHNGb3JtUm93TGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ01heGltdW0gbnVtYmVyIG9mIHNlZ21lbnRzIHBlciBzaGFyZCcKICAgICAgICB9KSwKICAgICAgICBoZWxwVGV4dDogaGVscFRleHQKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZpZWxkTnVtYmVyLCB7CiAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGV2ZW50KSB7CiAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgIGZvcmNlbWVyZ2VTZWdtZW50czogZXZlbnQudGFyZ2V0LnZhbHVlCiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIG1pbjogMSwKICAgICAgICBuYW1lOiAibWF4TnVtYmVyU2VnbWVudHMiCiAgICAgIH0pKSkpKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlckNvbmZpcm1EZWxldGVNb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF90aGlzJHByb3BzMiA9IF90aGlzLnByb3BzLAogICAgICAgICAgZGVsZXRlSW5kaWNlcyA9IF90aGlzJHByb3BzMi5kZWxldGVJbmRpY2VzLAogICAgICAgICAgaW5kZXhOYW1lcyA9IF90aGlzJHByb3BzMi5pbmRleE5hbWVzLAogICAgICAgICAgaGFzU3lzdGVtSW5kZXggPSBfdGhpcyRwcm9wczIuaGFzU3lzdGVtSW5kZXgsCiAgICAgICAgICBpc1N5c3RlbUluZGV4QnlOYW1lID0gX3RoaXMkcHJvcHMyLmlzU3lzdGVtSW5kZXhCeU5hbWU7CiAgICAgIHZhciBpc0FjdGlvbkNvbmZpcm1lZCA9IF90aGlzLnN0YXRlLmlzQWN0aW9uQ29uZmlybWVkOwogICAgICB2YXIgc2VsZWN0ZWRJbmRleENvdW50ID0gaW5kZXhOYW1lcy5sZW5ndGg7CgogICAgICB2YXIgc3RhbmRhcmRJbmRleE1vZGFsQm9keSA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5kZWxldGVJbmRleC5kZWxldGVEZXNjcmlwdGlvbiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJZb3UgYXJlIGFib3V0IHRvIGRlbGV0ZSB7c2VsZWN0ZWRJbmRleENvdW50LCBwbHVyYWwsIG9uZSB7dGhpcyBpbmRleH0gb3RoZXIge3RoZXNlIGluZGljZXN9IH06IiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIHNlbGVjdGVkSW5kZXhDb3VudDogc2VsZWN0ZWRJbmRleENvdW50CiAgICAgICAgfQogICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInVsIiwgbnVsbCwgaW5kZXhOYW1lcy5tYXAoZnVuY3Rpb24gKGluZGV4TmFtZSkgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJsaSIsIHsKICAgICAgICAgIGtleTogaW5kZXhOYW1lCiAgICAgICAgfSwgaW5kZXhOYW1lKTsKICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogInhwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5kZWxldGVJbmRleC5kZWxldGVXYXJuaW5nRGVzY3JpcHRpb24iLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiWW91IGNhbid0IHJlY292ZXIgYSBkZWxldGVkIGluZGV4LiBNYWtlIHN1cmUgeW91IGhhdmUgYXBwcm9wcmlhdGUgYmFja3Vwcy4iCiAgICAgIH0pKSk7CgogICAgICB2YXIgc3lzdGVtSW5kZXhNb2RhbEJvZHkgPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuZGVsZXRlSW5kZXguZGVsZXRlRGVzY3JpcHRpb24iLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiWW91IGFyZSBhYm91dCB0byBkZWxldGUge3NlbGVjdGVkSW5kZXhDb3VudCwgcGx1cmFsLCBvbmUge3RoaXMgaW5kZXh9IG90aGVyIHt0aGVzZSBpbmRpY2VzfSB9OiIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBzZWxlY3RlZEluZGV4Q291bnQ6IHNlbGVjdGVkSW5kZXhDb3VudAogICAgICAgIH0KICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJ1bCIsIG51bGwsIGluZGV4TmFtZXMubWFwKGZ1bmN0aW9uIChpbmRleE5hbWUpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgibGkiLCB7CiAgICAgICAgICBrZXk6IGluZGV4TmFtZQogICAgICAgIH0sIGluZGV4TmFtZSwgaXNTeXN0ZW1JbmRleEJ5TmFtZVtpbmRleE5hbWVdID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsICcgJywgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJhZGdlLCB7CiAgICAgICAgICBpY29uVHlwZTogImFsZXJ0IiwKICAgICAgICAgIGNvbG9yOiAiaG9sbG93IgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5kZWxldGVJbmRleC5zeXN0ZW1JbmRleExhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU3lzdGVtIGluZGV4IgogICAgICAgIH0pKSkgOiAnJyk7CiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNhbGxPdXQsIHsKICAgICAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5kZWxldGVJbmRleC5wcm9jZWVkV2l0aENhdXRpb25DYWxsT3V0VGl0bGUnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0RlbGV0aW5nIGEgc3lzdGVtIGluZGV4IGNhbiBicmVhayBLaWJhbmEnCiAgICAgICAgfSksCiAgICAgICAgY29sb3I6ICJkYW5nZXIiLAogICAgICAgIGljb25UeXBlOiAiYWxlcnQiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmRlbGV0ZUluZGV4LnByb2NlZWRXaXRoQ2F1dGlvbkNhbGxPdXREZXNjcmlwdGlvbiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTeXN0ZW0gaW5kaWNlcyBhcmUgY3JpdGljYWwgZm9yIGludGVybmFsIG9wZXJhdGlvbnMuIElmIHlvdSBkZWxldGUgYSBzeXN0ZW0gaW5kZXgsIHlvdSBjYW4ndCByZWNvdmVyIGl0LiBNYWtlIHN1cmUgeW91IGhhdmUgYXBwcm9wcmlhdGUgYmFja3Vwcy4iCiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNoZWNrYm94LCB7CiAgICAgICAgaWQ6ICJjb25maXJtRGVsZXRlSW5kaWNlc0NoZWNrYm94IiwKICAgICAgICBsYWJlbDogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAieHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmRlbGV0ZUluZGV4LmNoZWNrYm94TGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJJIHVuZGVyc3RhbmQgdGhlIGNvbnNlcXVlbmNlcyBvZiBkZWxldGluZyBhIHN5c3RlbSBpbmRleCIKICAgICAgICB9KSwKICAgICAgICBjaGVja2VkOiBpc0FjdGlvbkNvbmZpcm1lZCwKICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZSkgewogICAgICAgICAgcmV0dXJuIF90aGlzLmNvbmZpcm1BY3Rpb24oZS50YXJnZXQuY2hlY2tlZCk7CiAgICAgICAgfQogICAgICB9KSkpOwoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlPdmVybGF5TWFzaywgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvbmZpcm1Nb2RhbCwgewogICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmRlbGV0ZUluZGV4LmNvbmZpcm1Nb2RhbC5tb2RhbFRpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZWxldGUge3NlbGVjdGVkSW5kZXhDb3VudCwgcGx1cmFsLCBvbmUge2luZGV4fSBvdGhlciB7IyBpbmRpY2VzfSB9JywKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICBzZWxlY3RlZEluZGV4Q291bnQ6IHNlbGVjdGVkSW5kZXhDb3VudAogICAgICAgICAgfQogICAgICAgIH0pLAogICAgICAgIG9uQ2FuY2VsOiBmdW5jdGlvbiBvbkNhbmNlbCgpIHsKICAgICAgICAgIF90aGlzLmNvbmZpcm1BY3Rpb24oZmFsc2UpOwoKICAgICAgICAgIF90aGlzLmNsb3NlQ29uZmlybU1vZGFsKCk7CiAgICAgICAgfSwKICAgICAgICBvbkNvbmZpcm06IGZ1bmN0aW9uIG9uQ29uZmlybSgpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy5jbG9zZVBvcG92ZXJBbmRFeGVjdXRlKGRlbGV0ZUluZGljZXMpOwogICAgICAgIH0sCiAgICAgICAgYnV0dG9uQ29sb3I6ICJkYW5nZXIiLAogICAgICAgIGNvbmZpcm1CdXR0b25EaXNhYmxlZDogaGFzU3lzdGVtSW5kZXggPyAhaXNBY3Rpb25Db25maXJtZWQgOiBmYWxzZSwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmRlbGV0ZUluZGV4LmNvbmZpcm1Nb2RhbC5jYW5jZWxCdXR0b25UZXh0JywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDYW5jZWwnCiAgICAgICAgfSksCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuZGVsZXRlSW5kZXguY29uZmlybU1vZGFsLmNvbmZpcm1CdXR0b25UZXh0JywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEZWxldGUge3NlbGVjdGVkSW5kZXhDb3VudCwgcGx1cmFsLCBvbmUge2luZGV4fSBvdGhlciB7aW5kaWNlc30gfScsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgc2VsZWN0ZWRJbmRleENvdW50OiBzZWxlY3RlZEluZGV4Q291bnQKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9LCBoYXNTeXN0ZW1JbmRleCA/IHN5c3RlbUluZGV4TW9kYWxCb2R5IDogc3RhbmRhcmRJbmRleE1vZGFsQm9keSkpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAicmVuZGVyQ29uZmlybUNsb3NlTW9kYWwiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfdGhpcyRwcm9wczMgPSBfdGhpcy5wcm9wcywKICAgICAgICAgIGNsb3NlSW5kaWNlcyA9IF90aGlzJHByb3BzMy5jbG9zZUluZGljZXMsCiAgICAgICAgICBpbmRleE5hbWVzID0gX3RoaXMkcHJvcHMzLmluZGV4TmFtZXMsCiAgICAgICAgICBpc1N5c3RlbUluZGV4QnlOYW1lID0gX3RoaXMkcHJvcHMzLmlzU3lzdGVtSW5kZXhCeU5hbWU7CiAgICAgIHZhciBpc0FjdGlvbkNvbmZpcm1lZCA9IF90aGlzLnN0YXRlLmlzQWN0aW9uQ29uZmlybWVkOwogICAgICB2YXIgc2VsZWN0ZWRJbmRleENvdW50ID0gaW5kZXhOYW1lcy5sZW5ndGg7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpT3ZlcmxheU1hc2ssIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlDb25maXJtTW9kYWwsIHsKICAgICAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5jbG9zZUluZGV4LmNvbmZpcm1Nb2RhbC5tb2RhbFRpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDbG9zZSB7c2VsZWN0ZWRJbmRleENvdW50LCBwbHVyYWwsIG9uZSB7aW5kZXh9IG90aGVyIHsjIGluZGljZXN9IH0nLAogICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgIHNlbGVjdGVkSW5kZXhDb3VudDogc2VsZWN0ZWRJbmRleENvdW50CiAgICAgICAgICB9CiAgICAgICAgfSksCiAgICAgICAgb25DYW5jZWw6IGZ1bmN0aW9uIG9uQ2FuY2VsKCkgewogICAgICAgICAgX3RoaXMuY29uZmlybUFjdGlvbihmYWxzZSk7CgogICAgICAgICAgX3RoaXMuY2xvc2VDb25maXJtTW9kYWwoKTsKICAgICAgICB9LAogICAgICAgIG9uQ29uZmlybTogZnVuY3Rpb24gb25Db25maXJtKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLmNsb3NlUG9wb3ZlckFuZEV4ZWN1dGUoY2xvc2VJbmRpY2VzKTsKICAgICAgICB9LAogICAgICAgIGJ1dHRvbkNvbG9yOiAiZGFuZ2VyIiwKICAgICAgICBjb25maXJtQnV0dG9uRGlzYWJsZWQ6ICFpc0FjdGlvbkNvbmZpcm1lZCwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmRlbGV0ZUluZGV4LmNvbmZpcm1Nb2RhbC5jYW5jZWxCdXR0b25UZXh0JywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDYW5jZWwnCiAgICAgICAgfSksCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuY2xvc2VJbmRleC5jb25maXJtTW9kYWwuY29uZmlybUJ1dHRvblRleHQnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0Nsb3NlIHtzZWxlY3RlZEluZGV4Q291bnQsIHBsdXJhbCwgb25lIHtpbmRleH0gb3RoZXIge2luZGljZXN9IH0nLAogICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgIHNlbGVjdGVkSW5kZXhDb3VudDogc2VsZWN0ZWRJbmRleENvdW50CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuY2xvc2VJbmRleC5jbG9zZURlc2NyaXB0aW9uIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIllvdSBhcmUgYWJvdXQgdG8gY2xvc2Uge3NlbGVjdGVkSW5kZXhDb3VudCwgcGx1cmFsLCBvbmUge3RoaXMgaW5kZXh9IG90aGVyIHt0aGVzZSBpbmRpY2VzfSB9OiIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBzZWxlY3RlZEluZGV4Q291bnQ6IHNlbGVjdGVkSW5kZXhDb3VudAogICAgICAgIH0KICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJ1bCIsIG51bGwsIGluZGV4TmFtZXMubWFwKGZ1bmN0aW9uIChpbmRleE5hbWUpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgibGkiLCB7CiAgICAgICAgICBrZXk6IGluZGV4TmFtZQogICAgICAgIH0sIGluZGV4TmFtZSwgaXNTeXN0ZW1JbmRleEJ5TmFtZVtpbmRleE5hbWVdID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QuRnJhZ21lbnQsIG51bGwsICcgJywgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJhZGdlLCB7CiAgICAgICAgICBpY29uVHlwZTogImFsZXJ0IiwKICAgICAgICAgIGNvbG9yOiAiaG9sbG93IgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5jbG9zZUluZGV4LnN5c3RlbUluZGV4TGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTeXN0ZW0gaW5kZXgiCiAgICAgICAgfSkpKSA6ICcnKTsKICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ2FsbE91dCwgewogICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmNsb3NlSW5kZXgucHJvY2VlZFdpdGhDYXV0aW9uQ2FsbE91dFRpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDbG9zaW5nIGEgc3lzdGVtIGluZGV4IGNhbiBicmVhayBLaWJhbmEnCiAgICAgICAgfSksCiAgICAgICAgY29sb3I6ICJkYW5nZXIiLAogICAgICAgIGljb25UeXBlOiAiYWxlcnQiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAieHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmNsb3NlSW5kZXgucHJvY2VlZFdpdGhDYXV0aW9uQ2FsbE91dERlc2NyaXB0aW9uIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlN5c3RlbSBpbmRpY2VzIGFyZSBjcml0aWNhbCBmb3IgaW50ZXJuYWwgb3BlcmF0aW9ucy4gWW91IGNhbiByZW9wZW4gdGhlIGluZGV4IHVzaW5nIHRoZSBPcGVuIEluZGV4IEFQSS4iCiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNoZWNrYm94LCB7CiAgICAgICAgaWQ6ICJjb25maXJtQ2xvc2VJbmRpY2VzQ2hlY2tib3giLAogICAgICAgIGxhYmVsOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuY2xvc2VJbmRleC5jaGVja2JveExhYmVsIiwKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiSSB1bmRlcnN0YW5kIHRoZSBjb25zZXF1ZW5jZXMgb2YgY2xvc2luZyBhIHN5c3RlbSBpbmRleCIKICAgICAgICB9KSwKICAgICAgICBjaGVja2VkOiBpc0FjdGlvbkNvbmZpcm1lZCwKICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZSkgewogICAgICAgICAgcmV0dXJuIF90aGlzLmNvbmZpcm1BY3Rpb24oZS50YXJnZXQuY2hlY2tlZCk7CiAgICAgICAgfQogICAgICB9KSkpKTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInJlbmRlckNvbmZpcm1GcmVlemVNb2RhbCIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF90aGlzJHByb3BzNCA9IF90aGlzLnByb3BzLAogICAgICAgICAgZnJlZXplSW5kaWNlcyA9IF90aGlzJHByb3BzNC5mcmVlemVJbmRpY2VzLAogICAgICAgICAgaW5kZXhOYW1lcyA9IF90aGlzJHByb3BzNC5pbmRleE5hbWVzOwogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aU92ZXJsYXlNYXNrLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ29uZmlybU1vZGFsLCB7CiAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuZnJlZXplRW50aXR5LmNvbmZpcm1Nb2RhbC5tb2RhbFRpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDb25maXJtIGZyZWV6ZSB7Y291bnQsIHBsdXJhbCwgb25lIHtpbmRleH0gb3RoZXIge2luZGljZXN9fScsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgY291bnQ6IGluZGV4TmFtZXMubGVuZ3RoCiAgICAgICAgICB9CiAgICAgICAgfSksCiAgICAgICAgb25DYW5jZWw6IF90aGlzLmNsb3NlQ29uZmlybU1vZGFsLAogICAgICAgIG9uQ29uZmlybTogZnVuY3Rpb24gb25Db25maXJtKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLmNsb3NlUG9wb3ZlckFuZEV4ZWN1dGUoZnJlZXplSW5kaWNlcyk7CiAgICAgICAgfSwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmZyZWV6ZUVudGl0eS5jb25maXJtTW9kYWwuY2FuY2VsQnV0dG9uVGV4dCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQ2FuY2VsJwogICAgICAgIH0pLAogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmZyZWV6ZUVudGl0eS5jb25maXJtTW9kYWwuY29uZmlybUJ1dHRvblRleHQnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ZyZWV6ZSB7Y291bnQsIHBsdXJhbCwgb25lIHtpbmRleH0gb3RoZXIge2luZGljZXN9fScsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgY291bnQ6IGluZGV4TmFtZXMubGVuZ3RoCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuZnJlZXplRW50aXR5LmZyZWV6ZURlc2NyaXB0aW9uIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIllvdSBhcmUgYWJvdXQgdG8gZnJlZXplIHtjb3VudCwgcGx1cmFsLCBvbmUge3RoaXMgaW5kZXh9IG90aGVyIHt0aGVzZSBpbmRpY2VzfX06IiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIGNvdW50OiBpbmRleE5hbWVzLmxlbmd0aAogICAgICAgIH0KICAgICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJ1bCIsIG51bGwsIGluZGV4TmFtZXMubWFwKGZ1bmN0aW9uIChpbmRleE5hbWUpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgibGkiLCB7CiAgICAgICAgICBrZXk6IGluZGV4TmFtZQogICAgICAgIH0sIGluZGV4TmFtZSk7CiAgICAgIH0pKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNhbGxPdXQsIHsKICAgICAgICB0aXRsZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5mcmVlemVFbnRpdHkucHJvY2VlZFdpdGhDYXV0aW9uQ2FsbE91dFRpdGxlJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdQcm9jZWVkIHdpdGggY2F1dGlvbicKICAgICAgICB9KSwKICAgICAgICBjb2xvcjogIndhcm5pbmciLAogICAgICAgIGljb25UeXBlOiAiaGVscCIKICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuZnJlZXplRW50aXR5LmZyZWV6ZUVudGl0eVdhcm5pbmdEZXNjcmlwdGlvbiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICIgQSBmcm96ZW4gaW5kZXggaGFzIGxpdHRsZSBvdmVyaGVhZCBvbiB0aGUgY2x1c3RlciBhbmQgaXMgYmxvY2tlZCBmb3Igd3JpdGUgb3BlcmF0aW9ucy4gWW91IGNhbiBzZWFyY2ggYSBmcm96ZW4gaW5kZXgsIGJ1dCBleHBlY3QgcXVlcmllcyB0byBiZSBzbG93ZXIuICIKICAgICAgfSkpKSkpOwogICAgfSk7CgogICAgX3RoaXMuc3RhdGUgPSB7CiAgICAgIGlzUG9wb3Zlck9wZW46IGZhbHNlLAogICAgICByZW5kZXJDb25maXJtTW9kYWw6IG51bGwsCiAgICAgIGlzQWN0aW9uQ29uZmlybWVkOiBmYWxzZQogICAgfTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhJbmRleEFjdGlvbnNDb250ZXh0TWVudSwgW3sKICAgIGtleTogInBhbmVscyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGFuZWxzKF9yZWYpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgZmF0YWxFcnJvcnMgPSBfcmVmLmNvcmUuZmF0YWxFcnJvcnMsCiAgICAgICAgICBfcmVmJHNlcnZpY2VzID0gX3JlZi5zZXJ2aWNlcywKICAgICAgICAgIGV4dGVuc2lvbnNTZXJ2aWNlID0gX3JlZiRzZXJ2aWNlcy5leHRlbnNpb25zU2VydmljZSwKICAgICAgICAgIGh0dHBTZXJ2aWNlID0gX3JlZiRzZXJ2aWNlcy5odHRwU2VydmljZSwKICAgICAgICAgIG5vdGlmaWNhdGlvblNlcnZpY2UgPSBfcmVmJHNlcnZpY2VzLm5vdGlmaWNhdGlvblNlcnZpY2UsCiAgICAgICAgICB1c2FnZUNvbGxlY3Rpb24gPSBfcmVmLnBsdWdpbnMudXNhZ2VDb2xsZWN0aW9uOwogICAgICB2YXIgX3RoaXMkcHJvcHM1ID0gdGhpcy5wcm9wcywKICAgICAgICAgIGNsb3NlSW5kaWNlcyA9IF90aGlzJHByb3BzNS5jbG9zZUluZGljZXMsCiAgICAgICAgICBvcGVuSW5kaWNlcyA9IF90aGlzJHByb3BzNS5vcGVuSW5kaWNlcywKICAgICAgICAgIGZsdXNoSW5kaWNlcyA9IF90aGlzJHByb3BzNS5mbHVzaEluZGljZXMsCiAgICAgICAgICByZWZyZXNoSW5kaWNlcyA9IF90aGlzJHByb3BzNS5yZWZyZXNoSW5kaWNlcywKICAgICAgICAgIGNsZWFyQ2FjaGVJbmRpY2VzID0gX3RoaXMkcHJvcHM1LmNsZWFyQ2FjaGVJbmRpY2VzLAogICAgICAgICAgZWRpdEluZGV4ID0gX3RoaXMkcHJvcHM1LmVkaXRJbmRleCwKICAgICAgICAgIHNob3dNYXBwaW5nID0gX3RoaXMkcHJvcHM1LnNob3dNYXBwaW5nLAogICAgICAgICAgc2hvd1N0YXRzID0gX3RoaXMkcHJvcHM1LnNob3dTdGF0cywKICAgICAgICAgIHNob3dTZXR0aW5ncyA9IF90aGlzJHByb3BzNS5zaG93U2V0dGluZ3MsCiAgICAgICAgICBkZXRhaWxQYW5lbCA9IF90aGlzJHByb3BzNS5kZXRhaWxQYW5lbCwKICAgICAgICAgIGluZGV4TmFtZXMgPSBfdGhpcyRwcm9wczUuaW5kZXhOYW1lcywKICAgICAgICAgIGluZGV4U3RhdHVzQnlOYW1lID0gX3RoaXMkcHJvcHM1LmluZGV4U3RhdHVzQnlOYW1lLAogICAgICAgICAgcGVyZm9ybUV4dGVuc2lvbkFjdGlvbiA9IF90aGlzJHByb3BzNS5wZXJmb3JtRXh0ZW5zaW9uQWN0aW9uLAogICAgICAgICAgaW5kaWNlcyA9IF90aGlzJHByb3BzNS5pbmRpY2VzLAogICAgICAgICAgcmVsb2FkSW5kaWNlcyA9IF90aGlzJHByb3BzNS5yZWxvYWRJbmRpY2VzLAogICAgICAgICAgdW5mcmVlemVJbmRpY2VzID0gX3RoaXMkcHJvcHM1LnVuZnJlZXplSW5kaWNlcywKICAgICAgICAgIGhhc1N5c3RlbUluZGV4ID0gX3RoaXMkcHJvcHM1Lmhhc1N5c3RlbUluZGV4OwogICAgICB2YXIgYWxsT3BlbiA9ICgwLCBfbG9kYXNoLmFsbCkoaW5kZXhOYW1lcywgZnVuY3Rpb24gKGluZGV4TmFtZSkgewogICAgICAgIHJldHVybiBpbmRleFN0YXR1c0J5TmFtZVtpbmRleE5hbWVdID09PSBfY29uc3RhbnRzLklOREVYX09QRU47CiAgICAgIH0pOwogICAgICB2YXIgYWxsRnJvemVuID0gKDAsIF9sb2Rhc2guYWxsKShpbmRpY2VzLCBmdW5jdGlvbiAoaW5kZXgpIHsKICAgICAgICByZXR1cm4gaW5kZXguaXNGcm96ZW47CiAgICAgIH0pOwogICAgICB2YXIgYWxsVW5mcm96ZW4gPSAoMCwgX2xvZGFzaC5hbGwpKGluZGljZXMsIGZ1bmN0aW9uIChpbmRleCkgewogICAgICAgIHJldHVybiAhaW5kZXguaXNGcm96ZW47CiAgICAgIH0pOwogICAgICB2YXIgc2VsZWN0ZWRJbmRleENvdW50ID0gaW5kZXhOYW1lcy5sZW5ndGg7CiAgICAgIHZhciBpdGVtcyA9IFtdOwoKICAgICAgaWYgKCFkZXRhaWxQYW5lbCAmJiBzZWxlY3RlZEluZGV4Q291bnQgPT09IDEpIHsKICAgICAgICBpdGVtcy5wdXNoKHsKICAgICAgICAgIG5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuc2hvd0luZGV4U2V0dGluZ3NMYWJlbCcsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTaG93IHtzZWxlY3RlZEluZGV4Q291bnQsIHBsdXJhbCwgb25lIHtpbmRleH0gb3RoZXIge2luZGljZXN9IH0gc2V0dGluZ3MnLAogICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4Q291bnQ6IHNlbGVjdGVkSW5kZXhDb3VudAogICAgICAgICAgICB9CiAgICAgICAgICB9KSwKICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgIF90aGlzMi5jbG9zZVBvcG92ZXJBbmRFeGVjdXRlKHNob3dTZXR0aW5ncyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgaXRlbXMucHVzaCh7CiAgICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LnNob3dJbmRleE1hcHBpbmdMYWJlbCcsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdTaG93IHtzZWxlY3RlZEluZGV4Q291bnQsIHBsdXJhbCwgb25lIHtpbmRleH0gb3RoZXIge2luZGljZXN9IH0gbWFwcGluZycsCiAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgIHNlbGVjdGVkSW5kZXhDb3VudDogc2VsZWN0ZWRJbmRleENvdW50CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgX3RoaXMyLmNsb3NlUG9wb3ZlckFuZEV4ZWN1dGUoc2hvd01hcHBpbmcpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAoYWxsT3BlbikgewogICAgICAgICAgaXRlbXMucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuc2hvd0luZGV4U3RhdHNMYWJlbCcsIHsKICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1Nob3cge3NlbGVjdGVkSW5kZXhDb3VudCwgcGx1cmFsLCBvbmUge2luZGV4fSBvdGhlciB7aW5kaWNlc30gfSBzdGF0cycsCiAgICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4Q291bnQ6IHNlbGVjdGVkSW5kZXhDb3VudAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSksCiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgX3RoaXMyLmNsb3NlUG9wb3ZlckFuZEV4ZWN1dGUoc2hvd1N0YXRzKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBpdGVtcy5wdXNoKHsKICAgICAgICAgIG5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5pZHhNZ210LmluZGV4QWN0aW9uc01lbnUuZWRpdEluZGV4U2V0dGluZ3NMYWJlbCcsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdFZGl0IHtzZWxlY3RlZEluZGV4Q291bnQsIHBsdXJhbCwgb25lIHtpbmRleH0gb3RoZXIge2luZGljZXN9IH0gc2V0dGluZ3MnLAogICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4Q291bnQ6IHNlbGVjdGVkSW5kZXhDb3VudAogICAgICAgICAgICB9CiAgICAgICAgICB9KSwKICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgIF90aGlzMi5jbG9zZVBvcG92ZXJBbmRFeGVjdXRlKGVkaXRJbmRleCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChhbGxPcGVuKSB7CiAgICAgICAgaXRlbXMucHVzaCh7CiAgICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmNsb3NlSW5kZXhMYWJlbCcsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDbG9zZSB7c2VsZWN0ZWRJbmRleENvdW50LCBwbHVyYWwsIG9uZSB7aW5kZXh9IG90aGVyIHtpbmRpY2VzfSB9JywKICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleENvdW50OiBzZWxlY3RlZEluZGV4Q291bnQKICAgICAgICAgICAgfQogICAgICAgICAgfSksCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICBpZiAoaGFzU3lzdGVtSW5kZXgpIHsKICAgICAgICAgICAgICBfdGhpczIuY2xvc2VQb3BvdmVyKCk7CgogICAgICAgICAgICAgIF90aGlzMi5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICByZW5kZXJDb25maXJtTW9kYWw6IF90aGlzMi5yZW5kZXJDb25maXJtQ2xvc2VNb2RhbAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzMi5jbG9zZVBvcG92ZXJBbmRFeGVjdXRlKGNsb3NlSW5kaWNlcyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgaXRlbXMucHVzaCh7CiAgICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmZvcmNlTWVyZ2VJbmRleExhYmVsJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0ZvcmNlIG1lcmdlIHtzZWxlY3RlZEluZGV4Q291bnQsIHBsdXJhbCwgb25lIHtpbmRleH0gb3RoZXIge2luZGljZXN9IH0nLAogICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4Q291bnQ6IHNlbGVjdGVkSW5kZXhDb3VudAogICAgICAgICAgICB9CiAgICAgICAgICB9KSwKICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgIF90aGlzMi5jbG9zZVBvcG92ZXIoKTsKCiAgICAgICAgICAgIF90aGlzMi5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgcmVuZGVyQ29uZmlybU1vZGFsOiBfdGhpczIucmVuZGVyRm9yY2VtZXJnZVNlZ21lbnRzTW9kYWwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgaXRlbXMucHVzaCh7CiAgICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LnJlZnJlc2hJbmRleExhYmVsJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1JlZnJlc2gge3NlbGVjdGVkSW5kZXhDb3VudCwgcGx1cmFsLCBvbmUge2luZGV4fSBvdGhlciB7aW5kaWNlc30gfScsCiAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgIHNlbGVjdGVkSW5kZXhDb3VudDogc2VsZWN0ZWRJbmRleENvdW50CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgX3RoaXMyLmNsb3NlUG9wb3ZlckFuZEV4ZWN1dGUocmVmcmVzaEluZGljZXMpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGl0ZW1zLnB1c2goewogICAgICAgICAgbmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5jbGVhckluZGV4Q2FjaGVMYWJlbCcsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDbGVhciB7c2VsZWN0ZWRJbmRleENvdW50LCBwbHVyYWwsIG9uZSB7aW5kZXh9IG90aGVyIHtpbmRpY2VzfSB9IGNhY2hlJywKICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleENvdW50OiBzZWxlY3RlZEluZGV4Q291bnQKICAgICAgICAgICAgfQogICAgICAgICAgfSksCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICBfdGhpczIuY2xvc2VQb3BvdmVyQW5kRXhlY3V0ZShjbGVhckNhY2hlSW5kaWNlcyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgaXRlbXMucHVzaCh7CiAgICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmZsdXNoSW5kZXhMYWJlbCcsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdGbHVzaCB7c2VsZWN0ZWRJbmRleENvdW50LCBwbHVyYWwsIG9uZSB7aW5kZXh9IG90aGVyIHtpbmRpY2VzfSB9JywKICAgICAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleENvdW50OiBzZWxlY3RlZEluZGV4Q291bnQKICAgICAgICAgICAgfQogICAgICAgICAgfSksCiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICBfdGhpczIuY2xvc2VQb3BvdmVyQW5kRXhlY3V0ZShmbHVzaEluZGljZXMpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAoYWxsRnJvemVuKSB7CiAgICAgICAgICBpdGVtcy5wdXNoKHsKICAgICAgICAgICAgbmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS51bmZyZWV6ZUluZGV4TGFiZWwnLCB7CiAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmZyZWV6ZSB7c2VsZWN0ZWRJbmRleENvdW50LCBwbHVyYWwsIG9uZSB7aW5kZXh9IG90aGVyIHtpbmRpY2VzfSB9JywKICAgICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICAgIHNlbGVjdGVkSW5kZXhDb3VudDogc2VsZWN0ZWRJbmRleENvdW50CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSwKICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgICBfdGhpczIuY2xvc2VQb3BvdmVyQW5kRXhlY3V0ZSh1bmZyZWV6ZUluZGljZXMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKGFsbFVuZnJvemVuKSB7CiAgICAgICAgICBpdGVtcy5wdXNoKHsKICAgICAgICAgICAgbmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5mcmVlemVJbmRleExhYmVsJywgewogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnRnJlZXplIHtzZWxlY3RlZEluZGV4Q291bnQsIHBsdXJhbCwgb25lIHtpbmRleH0gb3RoZXIge2luZGljZXN9IH0nLAogICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgc2VsZWN0ZWRJbmRleENvdW50OiBzZWxlY3RlZEluZGV4Q291bnQKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgIF90aGlzMi5jbG9zZVBvcG92ZXIoKTsKCiAgICAgICAgICAgICAgX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIHJlbmRlckNvbmZpcm1Nb2RhbDogX3RoaXMyLnJlbmRlckNvbmZpcm1GcmVlemVNb2RhbAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaXRlbXMucHVzaCh7CiAgICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51Lm9wZW5JbmRleExhYmVsJywgewogICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ09wZW4ge3NlbGVjdGVkSW5kZXhDb3VudCwgcGx1cmFsLCBvbmUge2luZGV4fSBvdGhlciB7aW5kaWNlc30gfScsCiAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgIHNlbGVjdGVkSW5kZXhDb3VudDogc2VsZWN0ZWRJbmRleENvdW50CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgICAgX3RoaXMyLmNsb3NlUG9wb3ZlckFuZEV4ZWN1dGUob3BlbkluZGljZXMpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICBpdGVtcy5wdXNoKHsKICAgICAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LmRlbGV0ZUluZGV4TGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0RlbGV0ZSB7c2VsZWN0ZWRJbmRleENvdW50LCBwbHVyYWwsIG9uZSB7aW5kZXh9IG90aGVyIHtpbmRpY2VzfSB9JywKICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICBzZWxlY3RlZEluZGV4Q291bnQ6IHNlbGVjdGVkSW5kZXhDb3VudAogICAgICAgICAgfQogICAgICAgIH0pLAogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICBfdGhpczIuY2xvc2VQb3BvdmVyKCk7CgogICAgICAgICAgX3RoaXMyLnNldFN0YXRlKHsKICAgICAgICAgICAgcmVuZGVyQ29uZmlybU1vZGFsOiBfdGhpczIucmVuZGVyQ29uZmlybURlbGV0ZU1vZGFsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBleHRlbnNpb25zU2VydmljZS5hY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGFjdGlvbkV4dGVuc2lvbikgewogICAgICAgIHZhciBhY3Rpb25FeHRlbnNpb25EZWZpbml0aW9uID0gYWN0aW9uRXh0ZW5zaW9uKHsKICAgICAgICAgIGluZGljZXM6IGluZGljZXMsCiAgICAgICAgICByZWxvYWRJbmRpY2VzOiByZWxvYWRJbmRpY2VzLAogICAgICAgICAgLy8gVGhlc2UgY29uZmlnIG9wdGlvbnMgY2FuIGJlIHJlbW92ZWQgb25jZSB0aGUgTlAgbWlncmF0aW9uIG91dCBvZiBsZWdhY3kgaXMgY29tcGxldGUuCiAgICAgICAgICAvLyBUaGV5J3JlIG5lZWRlZCBmb3Igbm93IGJlY2F1c2UgSUxNJ3MgZXh0ZW5zaW9ucyBtYWtlIEFQSSBjYWxscyB3aGljaCByZXF1aXJlIHRoZXNlCiAgICAgICAgICAvLyBkZXBlbmRlbmNpZXMsIGJ1dCB0aGV5J3JlIG5vdCBhdmFpbGFibGUgdW5sZXNzIHRoZSBhcHAncyAic2V0dXAiIGxpZmVjeWNsZSBzdGFnZSBvY2N1cnMuCiAgICAgICAgICAvLyBXaXRoaW4gdGhlIG9sZCBwbGF0Zm9ybSwgInNldHVwIiBvbmx5IG9jY3VycyBvbmNlIHRoZSB1c2VyIGFjdHVhbGx5IHZpc2l0cyB0aGUgYXBwLgogICAgICAgICAgLy8gT25jZSBJTE0gYW5kIElNIGhhdmUgYmVlbiBtb3ZlZCBvdXQgb2YgbGVnYWN5IHRoaXMgaGFjayB3b24ndCBiZSBuZWNlc3NhcnkuCiAgICAgICAgICB1c2FnZUNvbGxlY3Rpb246IHVzYWdlQ29sbGVjdGlvbiwKICAgICAgICAgIHRvYXN0czogbm90aWZpY2F0aW9uU2VydmljZS50b2FzdHMsCiAgICAgICAgICBmYXRhbEVycm9yczogZmF0YWxFcnJvcnMsCiAgICAgICAgICBodHRwQ2xpZW50OiBodHRwU2VydmljZS5odHRwQ2xpZW50CiAgICAgICAgfSk7CgogICAgICAgIGlmIChhY3Rpb25FeHRlbnNpb25EZWZpbml0aW9uKSB7CiAgICAgICAgICB2YXIgYnV0dG9uTGFiZWwgPSBhY3Rpb25FeHRlbnNpb25EZWZpbml0aW9uLmJ1dHRvbkxhYmVsLAogICAgICAgICAgICAgIHJlcXVlc3RNZXRob2QgPSBhY3Rpb25FeHRlbnNpb25EZWZpbml0aW9uLnJlcXVlc3RNZXRob2QsCiAgICAgICAgICAgICAgc3VjY2Vzc01lc3NhZ2UgPSBhY3Rpb25FeHRlbnNpb25EZWZpbml0aW9uLnN1Y2Nlc3NNZXNzYWdlLAogICAgICAgICAgICAgIHJlbmRlckNvbmZpcm1Nb2RhbCA9IGFjdGlvbkV4dGVuc2lvbkRlZmluaXRpb24ucmVuZGVyQ29uZmlybU1vZGFsOwoKICAgICAgICAgIGlmIChyZXF1ZXN0TWV0aG9kKSB7CiAgICAgICAgICAgIGl0ZW1zLnB1c2goewogICAgICAgICAgICAgIG5hbWU6IGJ1dHRvbkxhYmVsLAogICAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgICAgICBfdGhpczIuY2xvc2VQb3BvdmVyQW5kRXhlY3V0ZSgKICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICAgICAgICAgIF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwZXJmb3JtRXh0ZW5zaW9uQWN0aW9uKHJlcXVlc3RNZXRob2QsIHN1Y2Nlc3NNZXNzYWdlKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgICAgICAgICAgICB9KSkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpdGVtcy5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiBidXR0b25MYWJlbCwKICAgICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICAgICAgX3RoaXMyLmNsb3NlUG9wb3ZlcigpOwoKICAgICAgICAgICAgICAgIF90aGlzMi5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIHJlbmRlckNvbmZpcm1Nb2RhbDogcmVuZGVyQ29uZmlybU1vZGFsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBpdGVtWydkYXRhLXRlc3Qtc3ViaiddID0gJ2luZGV4VGFibGVDb250ZXh0TWVudUJ1dHRvbic7CiAgICAgIH0pOwogICAgICB2YXIgcGFuZWxUcmVlID0gewogICAgICAgIGlkOiAwLAogICAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51LnBhbmVsVGl0bGUnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ3tzZWxlY3RlZEluZGV4Q291bnQsIHBsdXJhbCwgb25lIHtJbmRleH0gb3RoZXIge0luZGljZXN9IH0gb3B0aW9ucycsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgc2VsZWN0ZWRJbmRleENvdW50OiBzZWxlY3RlZEluZGV4Q291bnQKICAgICAgICAgIH0KICAgICAgICB9KSwKICAgICAgICBpdGVtczogaXRlbXMKICAgICAgfTsKICAgICAgcmV0dXJuICgwLCBfZmxhdHRlbl9wYW5lbF90cmVlLmZsYXR0ZW5QYW5lbFRyZWUpKHBhbmVsVHJlZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2FwcF9jb250ZXh0LkFwcENvbnRleHRDb25zdW1lciwgbnVsbCwgZnVuY3Rpb24gKGFwcERlcGVuZGVuY2llcykgewogICAgICAgIHZhciBpbmRleE5hbWVzID0gX3RoaXMzLnByb3BzLmluZGV4TmFtZXM7CiAgICAgICAgdmFyIHNlbGVjdGVkSW5kZXhDb3VudCA9IGluZGV4TmFtZXMubGVuZ3RoOwogICAgICAgIHZhciBfdGhpczMkcHJvcHMgPSBfdGhpczMucHJvcHMsCiAgICAgICAgICAgIF90aGlzMyRwcm9wcyRpY29uU2lkZSA9IF90aGlzMyRwcm9wcy5pY29uU2lkZSwKICAgICAgICAgICAgaWNvblNpZGUgPSBfdGhpczMkcHJvcHMkaWNvblNpZGUgPT09IHZvaWQgMCA/ICdyaWdodCcgOiBfdGhpczMkcHJvcHMkaWNvblNpZGUsCiAgICAgICAgICAgIF90aGlzMyRwcm9wcyRhbmNob3JQbyA9IF90aGlzMyRwcm9wcy5hbmNob3JQb3NpdGlvbiwKICAgICAgICAgICAgYW5jaG9yUG9zaXRpb24gPSBfdGhpczMkcHJvcHMkYW5jaG9yUG8gPT09IHZvaWQgMCA/ICdyaWdodFVwJyA6IF90aGlzMyRwcm9wcyRhbmNob3JQbywKICAgICAgICAgICAgX3RoaXMzJHByb3BzJGxhYmVsID0gX3RoaXMzJHByb3BzLmxhYmVsLAogICAgICAgICAgICBsYWJlbCA9IF90aGlzMyRwcm9wcyRsYWJlbCA9PT0gdm9pZCAwID8gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmlkeE1nbXQuaW5kZXhBY3Rpb25zTWVudS5tYW5hZ2VCdXR0b25MYWJlbCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTWFuYWdlIHtzZWxlY3RlZEluZGV4Q291bnQsIHBsdXJhbCwgb25lIHtpbmRleH0gb3RoZXIge2luZGljZXN9fScsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgc2VsZWN0ZWRJbmRleENvdW50OiBzZWxlY3RlZEluZGV4Q291bnQKICAgICAgICAgIH0KICAgICAgICB9KSA6IF90aGlzMyRwcm9wcyRsYWJlbCwKICAgICAgICAgICAgX3RoaXMzJHByb3BzJGljb25UeXBlID0gX3RoaXMzJHByb3BzLmljb25UeXBlLAogICAgICAgICAgICBpY29uVHlwZSA9IF90aGlzMyRwcm9wcyRpY29uVHlwZSA9PT0gdm9pZCAwID8gJ2Fycm93RG93bicgOiBfdGhpczMkcHJvcHMkaWNvblR5cGU7CgogICAgICAgIHZhciBwYW5lbHMgPSBfdGhpczMucGFuZWxzKGFwcERlcGVuZGVuY2llcyk7CgogICAgICAgIHZhciBidXR0b24gPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiaW5kZXhBY3Rpb25zQ29udGV4dE1lbnVCdXR0b24iLAogICAgICAgICAgaWNvblNpZGU6IGljb25TaWRlLAogICAgICAgICAgImFyaWEtbGFiZWwiOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2suaWR4TWdtdC5pbmRleEFjdGlvbnNNZW51Lm1hbmFnZUJ1dHRvbkFyaWFMYWJlbCcsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd7c2VsZWN0ZWRJbmRleENvdW50LCBwbHVyYWwsIG9uZSB7aW5kZXh9IG90aGVyIHtpbmRpY2VzfSB9IG9wdGlvbnMnLAogICAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgICBzZWxlY3RlZEluZGV4Q291bnQ6IHNlbGVjdGVkSW5kZXhDb3VudAogICAgICAgICAgICB9CiAgICAgICAgICB9KSwKICAgICAgICAgIG9uQ2xpY2s6IF90aGlzMy5vbkJ1dHRvbkNsaWNrLAogICAgICAgICAgaWNvblR5cGU6IGljb25UeXBlLAogICAgICAgICAgZmlsbDogdHJ1ZQogICAgICAgIH0sIGxhYmVsKTsKCiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIG51bGwsIF90aGlzMy5zdGF0ZS5yZW5kZXJDb25maXJtTW9kYWwgPyBfdGhpczMuc3RhdGUucmVuZGVyQ29uZmlybU1vZGFsKF90aGlzMy5jbG9zZUNvbmZpcm1Nb2RhbCkgOiBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUG9wb3ZlciwgewogICAgICAgICAgaWQ6ICJjb250ZXh0TWVudUluZGljZXMiLAogICAgICAgICAgYnV0dG9uOiBidXR0b24sCiAgICAgICAgICBpc09wZW46IF90aGlzMy5zdGF0ZS5pc1BvcG92ZXJPcGVuLAogICAgICAgICAgY2xvc2VQb3BvdmVyOiBfdGhpczMuY2xvc2VQb3BvdmVyLAogICAgICAgICAgcGFuZWxQYWRkaW5nU2l6ZTogIm5vbmUiLAogICAgICAgICAgd2l0aFRpdGxlOiB0cnVlLAogICAgICAgICAgYW5jaG9yUG9zaXRpb246IGFuY2hvclBvc2l0aW9uLAogICAgICAgICAgcmVwb3NpdGlvbk9uU2Nyb2xsOiB0cnVlCiAgICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUNvbnRleHRNZW51LCB7CiAgICAgICAgICBpbml0aWFsUGFuZWxJZDogMCwKICAgICAgICAgIHBhbmVsczogcGFuZWxzCiAgICAgICAgfSkpKTsKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gSW5kZXhBY3Rpb25zQ29udGV4dE1lbnU7Cn0oX3JlYWN0LkNvbXBvbmVudCk7CgpleHBvcnRzLkluZGV4QWN0aW9uc0NvbnRleHRNZW51ID0gSW5kZXhBY3Rpb25zQ29udGV4dE1lbnU7"},null]}