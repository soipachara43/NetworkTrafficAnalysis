{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/index.js","mtime":1589249553292},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlJ1bGVzUGFnZSA9IHZvaWQgMDsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3JlYWN0Um91dGVyRG9tID0gcmVxdWlyZSgicmVhY3Qtcm91dGVyLWRvbSIpOwoKdmFyIF9ydWxlcyA9IHJlcXVpcmUoIi4uLy4uLy4uL2NvbnRhaW5lcnMvZGV0ZWN0aW9uX2VuZ2luZS9ydWxlcyIpOwoKdmFyIF9yZWRpcmVjdF90b19kZXRlY3Rpb25fZW5naW5lID0gcmVxdWlyZSgiLi4vLi4vLi4vY29tcG9uZW50cy9saW5rX3RvL3JlZGlyZWN0X3RvX2RldGVjdGlvbl9lbmdpbmUiKTsKCnZhciBfZGV0ZWN0aW9uX2VuZ2luZV9oZWFkZXJfcGFnZSA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvZGV0ZWN0aW9uX2VuZ2luZV9oZWFkZXJfcGFnZSIpOwoKdmFyIF93cmFwcGVyX3BhZ2UgPSByZXF1aXJlKCIuLi8uLi8uLi9jb21wb25lbnRzL3dyYXBwZXJfcGFnZSIpOwoKdmFyIF9zcHlfcm91dGVzID0gcmVxdWlyZSgiLi4vLi4vLi4vdXRpbHMvcm91dGUvc3B5X3JvdXRlcyIpOwoKdmFyIF91c2VyX2luZm8gPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL3VzZXJfaW5mbyIpOwoKdmFyIF9hbGwgPSByZXF1aXJlKCIuL2FsbCIpOwoKdmFyIF9pbXBvcnRfZGF0YV9tb2RhbCA9IHJlcXVpcmUoIi4uLy4uLy4uL2NvbXBvbmVudHMvaW1wb3J0X2RhdGFfbW9kYWwiKTsKCnZhciBfcmVhZF9vbmx5X2NhbGxvdXQgPSByZXF1aXJlKCIuL2NvbXBvbmVudHMvcmVhZF9vbmx5X2NhbGxvdXQiKTsKCnZhciBfdXBkYXRlX2NhbGxvdXQgPSByZXF1aXJlKCIuL2NvbXBvbmVudHMvcHJlX3BhY2thZ2VkX3J1bGVzL3VwZGF0ZV9jYWxsb3V0Iik7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuL2hlbHBlcnMiKTsKCnZhciBpMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi90cmFuc2xhdGlvbnMiKSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsKICB0cnkgewogICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOwogICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVqZWN0KGVycm9yKTsKICAgIHJldHVybjsKICB9CgogIGlmIChpbmZvLmRvbmUpIHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0gZWxzZSB7CiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7CiAgfQp9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgYXJncyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsKCiAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsKICAgICAgfQoKICAgICAgX25leHQodW5kZWZpbmVkKTsKICAgIH0pOwogIH07Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciBSdWxlc1BhZ2VDb21wb25lbnQgPSBmdW5jdGlvbiBSdWxlc1BhZ2VDb21wb25lbnQoKSB7CiAgdmFyIF91c2VTdGF0ZSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksCiAgICAgIHNob3dJbXBvcnRNb2RhbCA9IF91c2VTdGF0ZTJbMF0sCiAgICAgIHNldFNob3dJbXBvcnRNb2RhbCA9IF91c2VTdGF0ZTJbMV07CgogIHZhciByZWZyZXNoUnVsZXNEYXRhID0gKDAsIF9yZWFjdC51c2VSZWYpKG51bGwpOwoKICB2YXIgX3VzZVVzZXJJbmZvID0gKDAsIF91c2VyX2luZm8udXNlVXNlckluZm8pKCksCiAgICAgIGxvYWRpbmcgPSBfdXNlVXNlckluZm8ubG9hZGluZywKICAgICAgaXNTaWduYWxJbmRleEV4aXN0cyA9IF91c2VVc2VySW5mby5pc1NpZ25hbEluZGV4RXhpc3RzLAogICAgICBpc0F1dGhlbnRpY2F0ZWQgPSBfdXNlVXNlckluZm8uaXNBdXRoZW50aWNhdGVkLAogICAgICBoYXNFbmNyeXB0aW9uS2V5ID0gX3VzZVVzZXJJbmZvLmhhc0VuY3J5cHRpb25LZXksCiAgICAgIGNhblVzZXJDUlVEID0gX3VzZVVzZXJJbmZvLmNhblVzZXJDUlVELAogICAgICBoYXNJbmRleFdyaXRlID0gX3VzZVVzZXJJbmZvLmhhc0luZGV4V3JpdGU7CgogIHZhciBfdXNlUHJlUGFja2FnZWRSdWxlcyA9ICgwLCBfcnVsZXMudXNlUHJlUGFja2FnZWRSdWxlcykoewogICAgY2FuVXNlckNSVUQ6IGNhblVzZXJDUlVELAogICAgaGFzSW5kZXhXcml0ZTogaGFzSW5kZXhXcml0ZSwKICAgIGlzU2lnbmFsSW5kZXhFeGlzdHM6IGlzU2lnbmFsSW5kZXhFeGlzdHMsCiAgICBpc0F1dGhlbnRpY2F0ZWQ6IGlzQXV0aGVudGljYXRlZCwKICAgIGhhc0VuY3J5cHRpb25LZXk6IGhhc0VuY3J5cHRpb25LZXkKICB9KSwKICAgICAgY3JlYXRlUHJlUGFja2FnZWRSdWxlcyA9IF91c2VQcmVQYWNrYWdlZFJ1bGVzLmNyZWF0ZVByZVBhY2thZ2VkUnVsZXMsCiAgICAgIHByZVBhY2thZ2VkUnVsZUxvYWRpbmcgPSBfdXNlUHJlUGFja2FnZWRSdWxlcy5sb2FkaW5nLAogICAgICBsb2FkaW5nQ3JlYXRlUHJlUGFja2FnZWRSdWxlcyA9IF91c2VQcmVQYWNrYWdlZFJ1bGVzLmxvYWRpbmdDcmVhdGVQcmVQYWNrYWdlZFJ1bGVzLAogICAgICByZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1cyA9IF91c2VQcmVQYWNrYWdlZFJ1bGVzLnJlZmV0Y2hQcmVQYWNrYWdlZFJ1bGVzU3RhdHVzLAogICAgICBydWxlc0N1c3RvbUluc3RhbGxlZCA9IF91c2VQcmVQYWNrYWdlZFJ1bGVzLnJ1bGVzQ3VzdG9tSW5zdGFsbGVkLAogICAgICBydWxlc0luc3RhbGxlZCA9IF91c2VQcmVQYWNrYWdlZFJ1bGVzLnJ1bGVzSW5zdGFsbGVkLAogICAgICBydWxlc05vdEluc3RhbGxlZCA9IF91c2VQcmVQYWNrYWdlZFJ1bGVzLnJ1bGVzTm90SW5zdGFsbGVkLAogICAgICBydWxlc05vdFVwZGF0ZWQgPSBfdXNlUHJlUGFja2FnZWRSdWxlcy5ydWxlc05vdFVwZGF0ZWQ7CgogIHZhciBwcmVQYWNrYWdlZFJ1bGVTdGF0dXMgPSAoMCwgX2hlbHBlcnMuZ2V0UHJlUGFja2FnZWRSdWxlU3RhdHVzKShydWxlc0luc3RhbGxlZCwgcnVsZXNOb3RJbnN0YWxsZWQsIHJ1bGVzTm90VXBkYXRlZCk7CiAgdmFyIGhhbmRsZVJlZnJlc2hSdWxlcyA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKAogIC8qI19fUFVSRV9fKi8KICBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgaWYgKHJlZnJlc2hSdWxlc0RhdGEuY3VycmVudCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgcmVmcmVzaFJ1bGVzRGF0YS5jdXJyZW50KHRydWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKSwgW3JlZnJlc2hSdWxlc0RhdGFdKTsKICB2YXIgaGFuZGxlQ3JlYXRlUHJlUGFja2FnZWRSdWxlcyA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKAogIC8qI19fUFVSRV9fKi8KICBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBpZiAoIShjcmVhdGVQcmVQYWNrYWdlZFJ1bGVzICE9IG51bGwpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgIHJldHVybiBjcmVhdGVQcmVQYWNrYWdlZFJ1bGVzKCk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBoYW5kbGVSZWZyZXNoUnVsZXMoKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUyKTsKICB9KSksIFtjcmVhdGVQcmVQYWNrYWdlZFJ1bGVzLCBoYW5kbGVSZWZyZXNoUnVsZXNdKTsKICB2YXIgaGFuZGxlUmVmZXRjaFByZVBhY2thZ2VkUnVsZXNTdGF0dXMgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoKSB7CiAgICBpZiAocmVmZXRjaFByZVBhY2thZ2VkUnVsZXNTdGF0dXMgIT0gbnVsbCkgewogICAgICByZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1cygpOwogICAgfQogIH0sIFtyZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1c10pOwogIHZhciBoYW5kbGVTZXRSZWZyZXNoUnVsZXNEYXRhID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKHJlZnJlc2hSdWxlKSB7CiAgICByZWZyZXNoUnVsZXNEYXRhLmN1cnJlbnQgPSByZWZyZXNoUnVsZTsKICB9LCBbXSk7CgogIGlmICgoMCwgX2hlbHBlcnMucmVkaXJlY3RUb0RldGVjdGlvbnMpKGlzU2lnbmFsSW5kZXhFeGlzdHMsIGlzQXV0aGVudGljYXRlZCwgaGFzRW5jcnlwdGlvbktleSkpIHsKICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdFJvdXRlckRvbS5SZWRpcmVjdCwgewogICAgICB0bzogIi8iLmNvbmNhdChfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZS5ERVRFQ1RJT05fRU5HSU5FX1BBR0VfTkFNRSkKICAgIH0pOwogIH0KCiAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsICgwLCBfaGVscGVycy51c2VySGFzTm9QZXJtaXNzaW9ucykoY2FuVXNlckNSVUQpICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWRfb25seV9jYWxsb3V0LlJlYWRPbmx5Q2FsbE91dCwgbnVsbCksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2ltcG9ydF9kYXRhX21vZGFsLkltcG9ydERhdGFNb2RhbCwgewogICAgY2hlY2tCb3hMYWJlbDogaTE4bi5PVkVSV1JJVEVfV0lUSF9TQU1FX05BTUUsCiAgICBjbG9zZU1vZGFsOiBmdW5jdGlvbiBjbG9zZU1vZGFsKCkgewogICAgICByZXR1cm4gc2V0U2hvd0ltcG9ydE1vZGFsKGZhbHNlKTsKICAgIH0sCiAgICBkZXNjcmlwdGlvbjogaTE4bi5TRUxFQ1RfUlVMRSwKICAgIGVycm9yTWVzc2FnZTogaTE4bi5JTVBPUlRfRkFJTEVELAogICAgZmFpbGVkRGV0YWlsZWQ6IGkxOG4uSU1QT1JUX0ZBSUxFRF9ERVRBSUxFRCwKICAgIGltcG9ydENvbXBsZXRlOiBoYW5kbGVSZWZyZXNoUnVsZXMsCiAgICBpbXBvcnREYXRhOiBfcnVsZXMuaW1wb3J0UnVsZXMsCiAgICBzdWNjZXNzTWVzc2FnZTogaTE4bi5TVUNDRVNTRlVMTFlfSU1QT1JURURfUlVMRVMsCiAgICBzaG93Q2hlY2tCb3g6IHRydWUsCiAgICBzaG93TW9kYWw6IHNob3dJbXBvcnRNb2RhbCwKICAgIHN1Ym1pdEJ0blRleHQ6IGkxOG4uSU1QT1JUX1JVTEVfQlROX1RJVExFLAogICAgc3VidGl0bGU6IGkxOG4uSU5JVElBTF9QUk9NUFRfVEVYVCwKICAgIHRpdGxlOiBpMThuLklNUE9SVF9SVUxFCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3dyYXBwZXJfcGFnZS5XcmFwcGVyUGFnZSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZGV0ZWN0aW9uX2VuZ2luZV9oZWFkZXJfcGFnZS5EZXRlY3Rpb25FbmdpbmVIZWFkZXJQYWdlLCB7CiAgICBiYWNrT3B0aW9uczogewogICAgICBocmVmOiAoMCwgX3JlZGlyZWN0X3RvX2RldGVjdGlvbl9lbmdpbmUuZ2V0RGV0ZWN0aW9uRW5naW5lVXJsKSgpLAogICAgICB0ZXh0OiBpMThuLkJBQ0tfVE9fREVURUNUSU9OX0VOR0lORQogICAgfSwKICAgIHRpdGxlOiBpMThuLlBBR0VfVElUTEUKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIiwKICAgIGd1dHRlclNpemU6ICJzIiwKICAgIHJlc3BvbnNpdmU6IGZhbHNlLAogICAgd3JhcDogdHJ1ZQogIH0sIHByZVBhY2thZ2VkUnVsZVN0YXR1cyA9PT0gJ3J1bGVOb3RJbnN0YWxsZWQnICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICBpY29uVHlwZTogImluZGV4T3BlbiIsCiAgICBpc0xvYWRpbmc6IGxvYWRpbmdDcmVhdGVQcmVQYWNrYWdlZFJ1bGVzLAogICAgaXNEaXNhYmxlZDogKDAsIF9oZWxwZXJzLnVzZXJIYXNOb1Blcm1pc3Npb25zKShjYW5Vc2VyQ1JVRCkgfHwgbG9hZGluZywKICAgIG9uQ2xpY2s6IGhhbmRsZUNyZWF0ZVByZVBhY2thZ2VkUnVsZXMKICB9LCBpMThuLkxPQURfUFJFUEFDS0FHRURfUlVMRVMpKSwgcHJlUGFja2FnZWRSdWxlU3RhdHVzID09PSAnc29tZVJ1bGVVbmluc3RhbGwnICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICAiZGF0YS10ZXN0LXN1YmoiOiAicmVsb2FkUHJlYnVpbHRSdWxlc0J0biIsCiAgICBpY29uVHlwZTogInBsdXNJbkNpcmNsZSIsCiAgICBpc0xvYWRpbmc6IGxvYWRpbmdDcmVhdGVQcmVQYWNrYWdlZFJ1bGVzLAogICAgaXNEaXNhYmxlZDogKDAsIF9oZWxwZXJzLnVzZXJIYXNOb1Blcm1pc3Npb25zKShjYW5Vc2VyQ1JVRCkgfHwgbG9hZGluZywKICAgIG9uQ2xpY2s6IGhhbmRsZUNyZWF0ZVByZVBhY2thZ2VkUnVsZXMKICB9LCBpMThuLlJFTE9BRF9NSVNTSU5HX1BSRVBBQ0tBR0VEX1JVTEVTKHJ1bGVzTm90SW5zdGFsbGVkICE9PSBudWxsICYmIHJ1bGVzTm90SW5zdGFsbGVkICE9PSB2b2lkIDAgPyBydWxlc05vdEluc3RhbGxlZCA6IDApKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgewogICAgZ3JvdzogZmFsc2UKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQnV0dG9uLCB7CiAgICBpY29uVHlwZTogImltcG9ydEFjdGlvbiIsCiAgICBpc0Rpc2FibGVkOiAoMCwgX2hlbHBlcnMudXNlckhhc05vUGVybWlzc2lvbnMpKGNhblVzZXJDUlVEKSB8fCBsb2FkaW5nLAogICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgc2V0U2hvd0ltcG9ydE1vZGFsKHRydWUpOwogICAgfQogIH0sIGkxOG4uSU1QT1JUX1JVTEUpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b24sIHsKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJjcmVhdGUtbmV3LXJ1bGUiLAogICAgZmlsbDogdHJ1ZSwKICAgIGhyZWY6ICgwLCBfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZS5nZXRDcmVhdGVSdWxlVXJsKSgpLAogICAgaWNvblR5cGU6ICJwbHVzSW5DaXJjbGUiLAogICAgaXNEaXNhYmxlZDogKDAsIF9oZWxwZXJzLnVzZXJIYXNOb1Blcm1pc3Npb25zKShjYW5Vc2VyQ1JVRCkgfHwgbG9hZGluZwogIH0sIGkxOG4uQUREX05FV19SVUxFKSkpKSwgcHJlUGFja2FnZWRSdWxlU3RhdHVzID09PSAncnVsZU5lZWRVcGRhdGUnICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3VwZGF0ZV9jYWxsb3V0LlVwZGF0ZVByZVBhY2thZ2VkUnVsZXNDYWxsT3V0LCB7CiAgICBsb2FkaW5nOiBsb2FkaW5nQ3JlYXRlUHJlUGFja2FnZWRSdWxlcywKICAgIG51bWJlck9mVXBkYXRlZFJ1bGVzOiBydWxlc05vdFVwZGF0ZWQgIT09IG51bGwgJiYgcnVsZXNOb3RVcGRhdGVkICE9PSB2b2lkIDAgPyBydWxlc05vdFVwZGF0ZWQgOiAwLAogICAgdXBkYXRlUnVsZXM6IGhhbmRsZUNyZWF0ZVByZVBhY2thZ2VkUnVsZXMKICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWxsLkFsbFJ1bGVzLCB7CiAgICBjcmVhdGVQcmVQYWNrYWdlZFJ1bGVzOiBjcmVhdGVQcmVQYWNrYWdlZFJ1bGVzLAogICAgbG9hZGluZzogbG9hZGluZyB8fCBwcmVQYWNrYWdlZFJ1bGVMb2FkaW5nLAogICAgbG9hZGluZ0NyZWF0ZVByZVBhY2thZ2VkUnVsZXM6IGxvYWRpbmdDcmVhdGVQcmVQYWNrYWdlZFJ1bGVzLAogICAgaGFzTm9QZXJtaXNzaW9uczogKDAsIF9oZWxwZXJzLnVzZXJIYXNOb1Blcm1pc3Npb25zKShjYW5Vc2VyQ1JVRCksCiAgICByZWZldGNoUHJlUGFja2FnZWRSdWxlc1N0YXR1czogaGFuZGxlUmVmZXRjaFByZVBhY2thZ2VkUnVsZXNTdGF0dXMsCiAgICBydWxlc0N1c3RvbUluc3RhbGxlZDogcnVsZXNDdXN0b21JbnN0YWxsZWQsCiAgICBydWxlc0luc3RhbGxlZDogcnVsZXNJbnN0YWxsZWQsCiAgICBydWxlc05vdEluc3RhbGxlZDogcnVsZXNOb3RJbnN0YWxsZWQsCiAgICBydWxlc05vdFVwZGF0ZWQ6IHJ1bGVzTm90VXBkYXRlZCwKICAgIHNldFJlZnJlc2hSdWxlc0RhdGE6IGhhbmRsZVNldFJlZnJlc2hSdWxlc0RhdGEKICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NweV9yb3V0ZXMuU3B5Um91dGUsIG51bGwpKTsKfTsKCnZhciBSdWxlc1BhZ2UgPSBfcmVhY3QuZGVmYXVsdC5tZW1vKFJ1bGVzUGFnZUNvbXBvbmVudCk7CgpleHBvcnRzLlJ1bGVzUGFnZSA9IFJ1bGVzUGFnZTs="},null]}