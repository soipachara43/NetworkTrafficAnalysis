{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/components/signals/actions.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/components/signals/actions.js","mtime":1589249553284},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLnNlbmRTaWduYWxUb1RpbWVsaW5lQWN0aW9uID0gZXhwb3J0cy5kZXRlcm1pbmVUb0FuZEZyb20gPSBleHBvcnRzLnVwZGF0ZVNpZ25hbFN0YXR1c0FjdGlvbiA9IGV4cG9ydHMuZ2V0RmlsdGVyQW5kUnVsZUJvdW5kcyA9IGV4cG9ydHMuZ2V0VXBkYXRlU2lnbmFsc1F1ZXJ5ID0gdm9pZCAwOwoKdmFyIF9kYXRlbWF0aCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQGVsYXN0aWMvZGF0ZW1hdGgiKSk7Cgp2YXIgX2ZwID0gcmVxdWlyZSgibG9kYXNoL2ZwIik7Cgp2YXIgX21vbWVudCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibW9tZW50IikpOwoKdmFyIF9hcGkgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb250YWluZXJzL2RldGVjdGlvbl9lbmdpbmUvc2lnbmFscy9hcGkiKTsKCnZhciBfaW5kZXggPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb250YWluZXJzL3RpbWVsaW5lL29uZS9pbmRleC5ncWxfcXVlcnkiKTsKCnZhciBfaGVscGVycyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvb3Blbl90aW1lbGluZS9oZWxwZXJzIik7Cgp2YXIgX2tldXJ5ID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vbGliL2tldXJ5Iik7Cgp2YXIgX2RlZmF1bHRzID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vc3RvcmUvdGltZWxpbmUvZGVmYXVsdHMiKTsKCnZhciBfaGVscGVyczIgPSByZXF1aXJlKCIuL2hlbHBlcnMiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7CiAgdHJ5IHsKICAgIHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsKICAgIHZhciB2YWx1ZSA9IGluZm8udmFsdWU7CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIHJlamVjdChlcnJvcik7CiAgICByZXR1cm47CiAgfQoKICBpZiAoaW5mby5kb25lKSB7CiAgICByZXNvbHZlKHZhbHVlKTsKICB9IGVsc2UgewogICAgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOwogIH0KfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsKICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgdmFyIHNlbGYgPSB0aGlzLAogICAgICAgIGFyZ3MgPSBhcmd1bWVudHM7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7CgogICAgICBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsKICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7CiAgICAgIH0KCiAgICAgIF9uZXh0KHVuZGVmaW5lZCk7CiAgICB9KTsKICB9Owp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCnZhciBnZXRVcGRhdGVTaWduYWxzUXVlcnkgPSBmdW5jdGlvbiBnZXRVcGRhdGVTaWduYWxzUXVlcnkoZXZlbnRJZHMpIHsKICByZXR1cm4gewogICAgcXVlcnk6IHsKICAgICAgYm9vbDogewogICAgICAgIGZpbHRlcjogewogICAgICAgICAgdGVybXM6IHsKICAgICAgICAgICAgX2lkOiBfdG9Db25zdW1hYmxlQXJyYXkoZXZlbnRJZHMpCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfTsKfTsKCmV4cG9ydHMuZ2V0VXBkYXRlU2lnbmFsc1F1ZXJ5ID0gZ2V0VXBkYXRlU2lnbmFsc1F1ZXJ5OwoKdmFyIGdldEZpbHRlckFuZFJ1bGVCb3VuZHMgPSBmdW5jdGlvbiBnZXRGaWx0ZXJBbmRSdWxlQm91bmRzKGRhdGEpIHsKICB2YXIgX3JlZiwgX2RhdGEkMCRmaWx0ZXIsIF9kYXRhJDAkZmlsdGVyJDsKCiAgdmFyIHN0cmluZ0ZpbHRlciA9IChfcmVmID0gZGF0YSA9PT0gbnVsbCB8fCBkYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2RhdGEkMCRmaWx0ZXIgPSBkYXRhWzBdLmZpbHRlcihmdW5jdGlvbiAoZCkgewogICAgcmV0dXJuIGQuZmllbGQgPT09ICdzaWduYWwucnVsZS5maWx0ZXJzJzsKICB9KSkgPT09IG51bGwgfHwgX2RhdGEkMCRmaWx0ZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZGF0YSQwJGZpbHRlciQgPSBfZGF0YSQwJGZpbHRlclswXSkgPT09IG51bGwgfHwgX2RhdGEkMCRmaWx0ZXIkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZGF0YSQwJGZpbHRlciQudmFsdWUpICE9PSBudWxsICYmIF9yZWYgIT09IHZvaWQgMCA/IF9yZWYgOiBbXTsKICB2YXIgZXZlbnRUaW1lcyA9IGRhdGEuZmxhdE1hcChmdW5jdGlvbiAoc2lnbmFsKSB7CiAgICB2YXIgX3JlZjIsIF9zaWduYWwkZmlsdGVyLCBfc2lnbmFsJGZpbHRlciQ7CgogICAgcmV0dXJuIChfcmVmMiA9IChfc2lnbmFsJGZpbHRlciA9IHNpZ25hbC5maWx0ZXIoZnVuY3Rpb24gKGQpIHsKICAgICAgcmV0dXJuIGQuZmllbGQgPT09ICdzaWduYWwub3JpZ2luYWxfdGltZSc7CiAgICB9KSkgPT09IG51bGwgfHwgX3NpZ25hbCRmaWx0ZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfc2lnbmFsJGZpbHRlciQgPSBfc2lnbmFsJGZpbHRlclswXSkgPT09IG51bGwgfHwgX3NpZ25hbCRmaWx0ZXIkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc2lnbmFsJGZpbHRlciQudmFsdWUpICE9PSBudWxsICYmIF9yZWYyICE9PSB2b2lkIDAgPyBfcmVmMiA6IFtdOwogIH0pLm1hcChmdW5jdGlvbiAoZCkgewogICAgcmV0dXJuICgwLCBfbW9tZW50LmRlZmF1bHQpKGQpOwogIH0pOwogIHJldHVybiBbc3RyaW5nRmlsdGVyLCBfbW9tZW50LmRlZmF1bHQubWluKGV2ZW50VGltZXMpLnZhbHVlT2YoKSwgX21vbWVudC5kZWZhdWx0Lm1heChldmVudFRpbWVzKS52YWx1ZU9mKCldOwp9OwoKZXhwb3J0cy5nZXRGaWx0ZXJBbmRSdWxlQm91bmRzID0gZ2V0RmlsdGVyQW5kUnVsZUJvdW5kczsKCnZhciB1cGRhdGVTaWduYWxTdGF0dXNBY3Rpb24gPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZjMgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShfcmVmNCkgewogICAgdmFyIHF1ZXJ5LCBzaWduYWxJZHMsIHN0YXR1cywgc2V0RXZlbnRzTG9hZGluZywgc2V0RXZlbnRzRGVsZXRlZCwgcXVlcnlPYmplY3Q7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHF1ZXJ5ID0gX3JlZjQucXVlcnksIHNpZ25hbElkcyA9IF9yZWY0LnNpZ25hbElkcywgc3RhdHVzID0gX3JlZjQuc3RhdHVzLCBzZXRFdmVudHNMb2FkaW5nID0gX3JlZjQuc2V0RXZlbnRzTG9hZGluZywgc2V0RXZlbnRzRGVsZXRlZCA9IF9yZWY0LnNldEV2ZW50c0RlbGV0ZWQ7CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxOwogICAgICAgICAgICBzZXRFdmVudHNMb2FkaW5nKHsKICAgICAgICAgICAgICBldmVudElkczogc2lnbmFsSWRzLAogICAgICAgICAgICAgIGlzTG9hZGluZzogdHJ1ZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcXVlcnlPYmplY3QgPSBxdWVyeSA/IHsKICAgICAgICAgICAgICBxdWVyeTogSlNPTi5wYXJzZShxdWVyeSkKICAgICAgICAgICAgfSA6IGdldFVwZGF0ZVNpZ25hbHNRdWVyeShzaWduYWxJZHMpOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgcmV0dXJuICgwLCBfYXBpLnVwZGF0ZVNpZ25hbFN0YXR1cykoewogICAgICAgICAgICAgIHF1ZXJ5OiBxdWVyeU9iamVjdCwKICAgICAgICAgICAgICBzdGF0dXM6IHN0YXR1cwogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIC8vIFRPRE86IE9ubHkgZGVsZXRlIHRob3NlIHRoYXQgd2VyZSBzdWNjZXNzZnVsbHkgdXBkYXRlZCBmcm9tIHVwZGF0ZWRSdWxlcwogICAgICAgICAgICBzZXRFdmVudHNEZWxldGVkKHsKICAgICAgICAgICAgICBldmVudElkczogc2lnbmFsSWRzLAogICAgICAgICAgICAgIGlzRGVsZXRlZDogdHJ1ZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA5OwogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDEpOwoKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMTsKICAgICAgICAgICAgc2V0RXZlbnRzTG9hZGluZyh7CiAgICAgICAgICAgICAgZXZlbnRJZHM6IHNpZ25hbElkcywKICAgICAgICAgICAgICBpc0xvYWRpbmc6IGZhbHNlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuZmluaXNoKDExKTsKCiAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMSwgOSwgMTEsIDE0XV0pOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZVNpZ25hbFN0YXR1c0FjdGlvbihfeCkgewogICAgcmV0dXJuIF9yZWYzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKZXhwb3J0cy51cGRhdGVTaWduYWxTdGF0dXNBY3Rpb24gPSB1cGRhdGVTaWduYWxTdGF0dXNBY3Rpb247Cgp2YXIgZGV0ZXJtaW5lVG9BbmRGcm9tID0gZnVuY3Rpb24gZGV0ZXJtaW5lVG9BbmRGcm9tKF9yZWY1KSB7CiAgdmFyIF9lY3NEYXRhJHNpZ25hbCwgX2Vjc0RhdGEkc2lnbmFsJHJ1bGUsIF9lY3NEYXRhJHNpZ25hbDIsIF9lY3NEYXRhJHNpZ25hbDIkcnVsZSwgX2Vjc0RhdGEkdGltZXN0YW1wLCBfZWNzRGF0YSR0aW1lc3RhbXAyOwoKICB2YXIgZWNzRGF0YSA9IF9yZWY1LmVjc0RhdGE7CgogIHZhciBlbGxhcHNlZFRpbWVSdWxlID0gX21vbWVudC5kZWZhdWx0LmR1cmF0aW9uKCgwLCBfbW9tZW50LmRlZmF1bHQpKCkuZGlmZihfZGF0ZW1hdGguZGVmYXVsdC5wYXJzZSgoKF9lY3NEYXRhJHNpZ25hbCA9IGVjc0RhdGEuc2lnbmFsKSA9PT0gbnVsbCB8fCBfZWNzRGF0YSRzaWduYWwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZWNzRGF0YSRzaWduYWwkcnVsZSA9IF9lY3NEYXRhJHNpZ25hbC5ydWxlKSA9PT0gbnVsbCB8fCBfZWNzRGF0YSRzaWduYWwkcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Vjc0RhdGEkc2lnbmFsJHJ1bGUuZnJvbSkgIT0gbnVsbCA/IChfZWNzRGF0YSRzaWduYWwyID0gZWNzRGF0YS5zaWduYWwpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZWNzRGF0YSRzaWduYWwyJHJ1bGUgPSBfZWNzRGF0YSRzaWduYWwyLnJ1bGUpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbDIkcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Vjc0RhdGEkc2lnbmFsMiRydWxlLmZyb21bMF0gOiAnbm93LTBzJykpKTsKCiAgdmFyIGZyb20gPSAoMCwgX21vbWVudC5kZWZhdWx0KSgoX2Vjc0RhdGEkdGltZXN0YW1wID0gZWNzRGF0YS50aW1lc3RhbXApICE9PSBudWxsICYmIF9lY3NEYXRhJHRpbWVzdGFtcCAhPT0gdm9pZCAwID8gX2Vjc0RhdGEkdGltZXN0YW1wIDogbmV3IERhdGUoKSkuc3VidHJhY3QoZWxsYXBzZWRUaW1lUnVsZSkudmFsdWVPZigpOwogIHZhciB0byA9ICgwLCBfbW9tZW50LmRlZmF1bHQpKChfZWNzRGF0YSR0aW1lc3RhbXAyID0gZWNzRGF0YS50aW1lc3RhbXApICE9PSBudWxsICYmIF9lY3NEYXRhJHRpbWVzdGFtcDIgIT09IHZvaWQgMCA/IF9lY3NEYXRhJHRpbWVzdGFtcDIgOiBuZXcgRGF0ZSgpKS52YWx1ZU9mKCk7CiAgcmV0dXJuIHsKICAgIHRvOiB0bywKICAgIGZyb206IGZyb20KICB9Owp9OwoKZXhwb3J0cy5kZXRlcm1pbmVUb0FuZEZyb20gPSBkZXRlcm1pbmVUb0FuZEZyb207Cgp2YXIgc2VuZFNpZ25hbFRvVGltZWxpbmVBY3Rpb24gPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZjYgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAvKiNfX1BVUkVfXyovCiAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoX3JlZjcpIHsKICAgIHZhciBfZWNzRGF0YSRzaWduYWwzLCBfZWNzRGF0YSRzaWduYWwzJHJ1bGUsIF9lY3NEYXRhJHNpZ25hbDQsIF9lY3NEYXRhJHNpZ25hbDQkcnVsZSwgX2Vjc0RhdGEkc2lnbmFsNSwgX2Vjc0RhdGEkc2lnbmFsNSRydWxlLCBfZWNzRGF0YSRzaWduYWw2LCBfZWNzRGF0YSRzaWduYWw2JHJ1bGU7CgogICAgdmFyIGFwb2xsb0NsaWVudCwgY3JlYXRlVGltZWxpbmUsIGVjc0RhdGEsIHVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nLCBvcGVuU2lnbmFsSW5CYXNpY1RpbWVsaW5lLCBub3RlQ29udGVudCwgdGltZWxpbmVJZCwgX2RldGVybWluZVRvQW5kRnJvbSwgdG8sIGZyb20sIHJlc3BvbnNlVGltZWxpbmUsIHJlc3VsdGluZ1RpbWVsaW5lLCBfcmVmOCwgX3RpbWVsaW5lJGtxbFF1ZXJ5LCBfdGltZWxpbmUka3FsUXVlcnkkZmksIF90aW1lbGluZSRrcWxRdWVyeSRmaTIsIF90aW1lbGluZSRmaWx0ZXJzLCBfdGltZWxpbmUkZGF0YVByb3ZpZGUsIF9yZWY5LCBfdGltZWxpbmUka3FsUXVlcnkyLCBfdGltZWxpbmUka3FsUXVlcnkyJGYsIF90aW1lbGluZSRrcWxRdWVyeTIkZjIsIF9yZWYxMCwgX3RpbWVsaW5lJGtxbFF1ZXJ5MywgX3RpbWVsaW5lJGtxbFF1ZXJ5MyRmLCBfdGltZWxpbmUka3FsUXVlcnkzJGYyLCB0aW1lbGluZVRlbXBsYXRlLCBfZm9ybWF0VGltZWxpbmVSZXN1bHQsIHRpbWVsaW5lLCBxdWVyeSwgZmlsdGVycywgZGF0YVByb3ZpZGVyczsKCiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBhcG9sbG9DbGllbnQgPSBfcmVmNy5hcG9sbG9DbGllbnQsIGNyZWF0ZVRpbWVsaW5lID0gX3JlZjcuY3JlYXRlVGltZWxpbmUsIGVjc0RhdGEgPSBfcmVmNy5lY3NEYXRhLCB1cGRhdGVUaW1lbGluZUlzTG9hZGluZyA9IF9yZWY3LnVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nOwogICAgICAgICAgICBvcGVuU2lnbmFsSW5CYXNpY1RpbWVsaW5lID0gdHJ1ZTsKICAgICAgICAgICAgbm90ZUNvbnRlbnQgPSAoKF9lY3NEYXRhJHNpZ25hbDMgPSBlY3NEYXRhLnNpZ25hbCkgPT09IG51bGwgfHwgX2Vjc0RhdGEkc2lnbmFsMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9lY3NEYXRhJHNpZ25hbDMkcnVsZSA9IF9lY3NEYXRhJHNpZ25hbDMucnVsZSkgPT09IG51bGwgfHwgX2Vjc0RhdGEkc2lnbmFsMyRydWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZWNzRGF0YSRzaWduYWwzJHJ1bGUubm90ZSkgIT0gbnVsbCA/IChfZWNzRGF0YSRzaWduYWw0ID0gZWNzRGF0YS5zaWduYWwpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbDQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZWNzRGF0YSRzaWduYWw0JHJ1bGUgPSBfZWNzRGF0YSRzaWduYWw0LnJ1bGUpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbDQkcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Vjc0RhdGEkc2lnbmFsNCRydWxlLm5vdGVbMF0gOiAnJzsKICAgICAgICAgICAgdGltZWxpbmVJZCA9ICgoX2Vjc0RhdGEkc2lnbmFsNSA9IGVjc0RhdGEuc2lnbmFsKSA9PT0gbnVsbCB8fCBfZWNzRGF0YSRzaWduYWw1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2Vjc0RhdGEkc2lnbmFsNSRydWxlID0gX2Vjc0RhdGEkc2lnbmFsNS5ydWxlKSA9PT0gbnVsbCB8fCBfZWNzRGF0YSRzaWduYWw1JHJ1bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lY3NEYXRhJHNpZ25hbDUkcnVsZS50aW1lbGluZV9pZCkgIT0gbnVsbCA/IChfZWNzRGF0YSRzaWduYWw2ID0gZWNzRGF0YS5zaWduYWwpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbDYgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfZWNzRGF0YSRzaWduYWw2JHJ1bGUgPSBfZWNzRGF0YSRzaWduYWw2LnJ1bGUpID09PSBudWxsIHx8IF9lY3NEYXRhJHNpZ25hbDYkcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Vjc0RhdGEkc2lnbmFsNiRydWxlLnRpbWVsaW5lX2lkWzBdIDogJyc7CiAgICAgICAgICAgIF9kZXRlcm1pbmVUb0FuZEZyb20gPSBkZXRlcm1pbmVUb0FuZEZyb20oewogICAgICAgICAgICAgIGVjc0RhdGE6IGVjc0RhdGEKICAgICAgICAgICAgfSksIHRvID0gX2RldGVybWluZVRvQW5kRnJvbS50bywgZnJvbSA9IF9kZXRlcm1pbmVUb0FuZEZyb20uZnJvbTsKCiAgICAgICAgICAgIGlmICghKHRpbWVsaW5lSWQgIT09ICcnICYmIGFwb2xsb0NsaWVudCAhPSBudWxsKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gNjsKICAgICAgICAgICAgdXBkYXRlVGltZWxpbmVJc0xvYWRpbmcoewogICAgICAgICAgICAgIGlkOiAndGltZWxpbmUtMScsCiAgICAgICAgICAgICAgaXNMb2FkaW5nOiB0cnVlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEwOwogICAgICAgICAgICByZXR1cm4gYXBvbGxvQ2xpZW50LnF1ZXJ5KHsKICAgICAgICAgICAgICBxdWVyeTogX2luZGV4Lm9uZVRpbWVsaW5lUXVlcnksCiAgICAgICAgICAgICAgZmV0Y2hQb2xpY3k6ICduby1jYWNoZScsCiAgICAgICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgICAgICBpZDogdGltZWxpbmVJZAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgcmVzcG9uc2VUaW1lbGluZSA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICByZXN1bHRpbmdUaW1lbGluZSA9ICgwLCBfZnAuZ2V0T3IpKHt9LCAnZGF0YS5nZXRPbmVUaW1lbGluZScsIHJlc3BvbnNlVGltZWxpbmUpOwoKICAgICAgICAgICAgaWYgKCEoMCwgX2ZwLmlzRW1wdHkpKHJlc3VsdGluZ1RpbWVsaW5lKSkgewogICAgICAgICAgICAgIHRpbWVsaW5lVGVtcGxhdGUgPSAoMCwgX2hlbHBlcnMub21pdFR5cGVuYW1lSW5UaW1lbGluZSkocmVzdWx0aW5nVGltZWxpbmUpOwogICAgICAgICAgICAgIG9wZW5TaWduYWxJbkJhc2ljVGltZWxpbmUgPSBmYWxzZTsKICAgICAgICAgICAgICBfZm9ybWF0VGltZWxpbmVSZXN1bHQgPSAoMCwgX2hlbHBlcnMuZm9ybWF0VGltZWxpbmVSZXN1bHRUb01vZGVsKSh0aW1lbGluZVRlbXBsYXRlLCB0cnVlKSwgdGltZWxpbmUgPSBfZm9ybWF0VGltZWxpbmVSZXN1bHQudGltZWxpbmU7CiAgICAgICAgICAgICAgcXVlcnkgPSAoMCwgX2hlbHBlcnMyLnJlcGxhY2VUZW1wbGF0ZUZpZWxkRnJvbVF1ZXJ5KSgoX3JlZjggPSAoX3RpbWVsaW5lJGtxbFF1ZXJ5ID0gdGltZWxpbmUua3FsUXVlcnkpID09PSBudWxsIHx8IF90aW1lbGluZSRrcWxRdWVyeSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF90aW1lbGluZSRrcWxRdWVyeSRmaSA9IF90aW1lbGluZSRrcWxRdWVyeS5maWx0ZXJRdWVyeSkgPT09IG51bGwgfHwgX3RpbWVsaW5lJGtxbFF1ZXJ5JGZpID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RpbWVsaW5lJGtxbFF1ZXJ5JGZpMiA9IF90aW1lbGluZSRrcWxRdWVyeSRmaS5rdWVyeSkgPT09IG51bGwgfHwgX3RpbWVsaW5lJGtxbFF1ZXJ5JGZpMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RpbWVsaW5lJGtxbFF1ZXJ5JGZpMi5leHByZXNzaW9uKSAhPT0gbnVsbCAmJiBfcmVmOCAhPT0gdm9pZCAwID8gX3JlZjggOiAnJywgZWNzRGF0YSk7CiAgICAgICAgICAgICAgZmlsdGVycyA9ICgwLCBfaGVscGVyczIucmVwbGFjZVRlbXBsYXRlRmllbGRGcm9tTWF0Y2hGaWx0ZXJzKSgoX3RpbWVsaW5lJGZpbHRlcnMgPSB0aW1lbGluZS5maWx0ZXJzKSAhPT0gbnVsbCAmJiBfdGltZWxpbmUkZmlsdGVycyAhPT0gdm9pZCAwID8gX3RpbWVsaW5lJGZpbHRlcnMgOiBbXSwgZWNzRGF0YSk7CiAgICAgICAgICAgICAgZGF0YVByb3ZpZGVycyA9ICgwLCBfaGVscGVyczIucmVwbGFjZVRlbXBsYXRlRmllbGRGcm9tRGF0YVByb3ZpZGVycykoKF90aW1lbGluZSRkYXRhUHJvdmlkZSA9IHRpbWVsaW5lLmRhdGFQcm92aWRlcnMpICE9PSBudWxsICYmIF90aW1lbGluZSRkYXRhUHJvdmlkZSAhPT0gdm9pZCAwID8gX3RpbWVsaW5lJGRhdGFQcm92aWRlIDogW10sIGVjc0RhdGEpOwogICAgICAgICAgICAgIGNyZWF0ZVRpbWVsaW5lKHsKICAgICAgICAgICAgICAgIGZyb206IGZyb20sCiAgICAgICAgICAgICAgICB0aW1lbGluZTogX29iamVjdFNwcmVhZCh7fSwgdGltZWxpbmUsIHsKICAgICAgICAgICAgICAgICAgZGF0YVByb3ZpZGVyczogZGF0YVByb3ZpZGVycywKICAgICAgICAgICAgICAgICAgZXZlbnRUeXBlOiAnYWxsJywKICAgICAgICAgICAgICAgICAgZmlsdGVyczogZmlsdGVycywKICAgICAgICAgICAgICAgICAgZGF0ZVJhbmdlOiB7CiAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGZyb20sCiAgICAgICAgICAgICAgICAgICAgZW5kOiB0bwogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBrcWxRdWVyeTogewogICAgICAgICAgICAgICAgICAgIGZpbHRlclF1ZXJ5OiB7CiAgICAgICAgICAgICAgICAgICAgICBrdWVyeTogewogICAgICAgICAgICAgICAgICAgICAgICBraW5kOiAoX3JlZjkgPSAoX3RpbWVsaW5lJGtxbFF1ZXJ5MiA9IHRpbWVsaW5lLmtxbFF1ZXJ5KSA9PT0gbnVsbCB8fCBfdGltZWxpbmUka3FsUXVlcnkyID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmID0gX3RpbWVsaW5lJGtxbFF1ZXJ5Mi5maWx0ZXJRdWVyeSkgPT09IG51bGwgfHwgX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmMiA9IF90aW1lbGluZSRrcWxRdWVyeTIkZi5rdWVyeSkgPT09IG51bGwgfHwgX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RpbWVsaW5lJGtxbFF1ZXJ5MiRmMi5raW5kKSAhPT0gbnVsbCAmJiBfcmVmOSAhPT0gdm9pZCAwID8gX3JlZjkgOiAna3VlcnknLAogICAgICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uOiBxdWVyeQogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgIHNlcmlhbGl6ZWRRdWVyeTogKDAsIF9rZXVyeS5jb252ZXJ0S3VlcnlUb0VsYXN0aWNTZWFyY2hRdWVyeSkocXVlcnkpCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBmaWx0ZXJRdWVyeURyYWZ0OiB7CiAgICAgICAgICAgICAgICAgICAgICBraW5kOiAoX3JlZjEwID0gKF90aW1lbGluZSRrcWxRdWVyeTMgPSB0aW1lbGluZS5rcWxRdWVyeSkgPT09IG51bGwgfHwgX3RpbWVsaW5lJGtxbFF1ZXJ5MyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF90aW1lbGluZSRrcWxRdWVyeTMkZiA9IF90aW1lbGluZSRrcWxRdWVyeTMuZmlsdGVyUXVlcnkpID09PSBudWxsIHx8IF90aW1lbGluZSRrcWxRdWVyeTMkZiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF90aW1lbGluZSRrcWxRdWVyeTMkZjIgPSBfdGltZWxpbmUka3FsUXVlcnkzJGYua3VlcnkpID09PSBudWxsIHx8IF90aW1lbGluZSRrcWxRdWVyeTMkZjIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aW1lbGluZSRrcWxRdWVyeTMkZjIua2luZCkgIT09IG51bGwgJiYgX3JlZjEwICE9PSB2b2lkIDAgPyBfcmVmMTAgOiAna3VlcnknLAogICAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogcXVlcnkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHNob3c6IHRydWUKICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgdG86IHRvLAogICAgICAgICAgICAgICAgcnVsZU5vdGU6IG5vdGVDb250ZW50CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMTU7CiAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MlsiY2F0Y2giXSg2KTsKICAgICAgICAgICAgb3BlblNpZ25hbEluQmFzaWNUaW1lbGluZSA9IHRydWU7CiAgICAgICAgICAgIHVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nKHsKICAgICAgICAgICAgICBpZDogJ3RpbWVsaW5lLTEnLAogICAgICAgICAgICAgIGlzTG9hZGluZzogZmFsc2UKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgaWYgKG9wZW5TaWduYWxJbkJhc2ljVGltZWxpbmUpIHsKICAgICAgICAgICAgICBjcmVhdGVUaW1lbGluZSh7CiAgICAgICAgICAgICAgICBmcm9tOiBmcm9tLAogICAgICAgICAgICAgICAgdGltZWxpbmU6IF9vYmplY3RTcHJlYWQoe30sIF9kZWZhdWx0cy50aW1lbGluZURlZmF1bHRzLCB7CiAgICAgICAgICAgICAgICAgIGRhdGFQcm92aWRlcnM6IFt7CiAgICAgICAgICAgICAgICAgICAgYW5kOiBbXSwKICAgICAgICAgICAgICAgICAgICBpZDogInNlbmQtc2lnbmFsLXRvLXRpbWVsaW5lLWFjdGlvbi1kZWZhdWx0LWRyYWdnYWJsZS1ldmVudC1kZXRhaWxzLXZhbHVlLWZvcm1hdHRlZC1maWVsZC12YWx1ZS10aW1lbGluZS0xLXNpZ25hbC1pZC0iLmNvbmNhdChlY3NEYXRhLl9pZCksCiAgICAgICAgICAgICAgICAgICAgbmFtZTogZWNzRGF0YS5faWQsCiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBleGNsdWRlZDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAga3FsUXVlcnk6ICcnLAogICAgICAgICAgICAgICAgICAgIHF1ZXJ5TWF0Y2g6IHsKICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiAnX2lkJywKICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlY3NEYXRhLl9pZCwKICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiAnOicKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH1dLAogICAgICAgICAgICAgICAgICBpZDogJ3RpbWVsaW5lLTEnLAogICAgICAgICAgICAgICAgICBkYXRlUmFuZ2U6IHsKICAgICAgICAgICAgICAgICAgICBzdGFydDogZnJvbSwKICAgICAgICAgICAgICAgICAgICBlbmQ6IHRvCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogJ2FsbCcsCiAgICAgICAgICAgICAgICAgIGtxbFF1ZXJ5OiB7CiAgICAgICAgICAgICAgICAgICAgZmlsdGVyUXVlcnk6IHsKICAgICAgICAgICAgICAgICAgICAgIGt1ZXJ5OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6ICdrdWVyeScsCiAgICAgICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb246ICcnCiAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgc2VyaWFsaXplZFF1ZXJ5OiAnJwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyUXVlcnlEcmFmdDogewogICAgICAgICAgICAgICAgICAgICAga2luZDogJ2t1ZXJ5JywKICAgICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb246ICcnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIHRvOiB0bywKICAgICAgICAgICAgICAgIHJ1bGVOb3RlOiBub3RlQ29udGVudAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbNiwgMTVdXSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gc2VuZFNpZ25hbFRvVGltZWxpbmVBY3Rpb24oX3gyKSB7CiAgICByZXR1cm4gX3JlZjYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7CgpleHBvcnRzLnNlbmRTaWduYWxUb1RpbWVsaW5lQWN0aW9uID0gc2VuZFNpZ25hbFRvVGltZWxpbmVBY3Rpb247"},null]}