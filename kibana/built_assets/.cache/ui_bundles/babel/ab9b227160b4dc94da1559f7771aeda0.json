{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/maps/public/layers/layer.js","dependencies":[{"path":"x-pack/legacy/plugins/maps/public/layers/layer.js","mtime":1589249552432},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFic3RyYWN0TGF5ZXIgPSB2b2lkIDA7Cgp2YXIgX2xvZGFzaCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibG9kYXNoIikpOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9kYXRhX3JlcXVlc3QgPSByZXF1aXJlKCIuL3V0aWwvZGF0YV9yZXF1ZXN0Iik7Cgp2YXIgX2NvbnN0YW50cyA9IHJlcXVpcmUoIi4uLy4uL2NvbW1vbi9jb25zdGFudHMiKTsKCnZhciBfdiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidXVpZC92NCIpKTsKCnZhciBfdXRpbCA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL3BsdWdpbnMvbWFwcy9wdWJsaWMvcmVkdWNlcnMvdXRpbC5qcyIpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9Cgp2YXIgQWJzdHJhY3RMYXllciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEFic3RyYWN0TGF5ZXIoX3JlZikgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgbGF5ZXJEZXNjcmlwdG9yID0gX3JlZi5sYXllckRlc2NyaXB0b3IsCiAgICAgICAgc291cmNlID0gX3JlZi5zb3VyY2U7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFic3RyYWN0TGF5ZXIpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAicmVuZGVyU291cmNlU2V0dGluZ3NFZGl0b3IiLCBmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgdmFyIG9uQ2hhbmdlID0gX3JlZjIub25DaGFuZ2U7CiAgICAgIHJldHVybiBfdGhpcy5nZXRTb3VyY2VGb3JFZGl0aW5nKCkucmVuZGVyU291cmNlU2V0dGluZ3NFZGl0b3IoewogICAgICAgIG9uQ2hhbmdlOiBvbkNoYW5nZQogICAgICB9KTsKICAgIH0pOwoKICAgIHRoaXMuX2Rlc2NyaXB0b3IgPSBBYnN0cmFjdExheWVyLmNyZWF0ZURlc2NyaXB0b3IobGF5ZXJEZXNjcmlwdG9yKTsKICAgIHRoaXMuX3NvdXJjZSA9IHNvdXJjZTsKCiAgICBpZiAodGhpcy5fZGVzY3JpcHRvci5fX2RhdGFSZXF1ZXN0cykgewogICAgICB0aGlzLl9kYXRhUmVxdWVzdHMgPSB0aGlzLl9kZXNjcmlwdG9yLl9fZGF0YVJlcXVlc3RzLm1hcChmdW5jdGlvbiAoZGF0YVJlcXVlc3QpIHsKICAgICAgICByZXR1cm4gbmV3IF9kYXRhX3JlcXVlc3QuRGF0YVJlcXVlc3QoZGF0YVJlcXVlc3QpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuX2RhdGFSZXF1ZXN0cyA9IFtdOwogICAgfQogIH0KCiAgX2NyZWF0ZUNsYXNzKEFic3RyYWN0TGF5ZXIsIFt7CiAgICBrZXk6ICJkZXN0cm95IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICBpZiAodGhpcy5fc291cmNlKSB7CiAgICAgICAgdGhpcy5fc291cmNlLmRlc3Ryb3koKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImNsb25lRGVzY3JpcHRvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2Nsb25lRGVzY3JpcHRvciA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGNsb25lZERlc2NyaXB0b3IsIGRpc3BsYXlOYW1lOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNsb25lZERlc2NyaXB0b3IgPSAoMCwgX3V0aWwuY29weVBlcnNpc3RlbnRTdGF0ZSkodGhpcy5fZGVzY3JpcHRvcik7IC8vIGxheWVyIGlkIGlzIHV1aWQgdXNlZCB0byB0cmFjayBzdHlsZXMvbGF5ZXJzIGluIG1hcGJveAoKICAgICAgICAgICAgICAgIGNsb25lZERlc2NyaXB0b3IuaWQgPSAoMCwgX3YuZGVmYXVsdCkoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlzcGxheU5hbWUoKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgZGlzcGxheU5hbWUgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgY2xvbmVkRGVzY3JpcHRvci5sYWJlbCA9ICJDbG9uZSBvZiAiLmNvbmNhdChkaXNwbGF5TmFtZSk7CiAgICAgICAgICAgICAgICBjbG9uZWREZXNjcmlwdG9yLnNvdXJjZURlc2NyaXB0b3IgPSB0aGlzLmdldFNvdXJjZSgpLmNsb25lRGVzY3JpcHRvcigpOwoKICAgICAgICAgICAgICAgIGlmIChjbG9uZWREZXNjcmlwdG9yLmpvaW5zKSB7CiAgICAgICAgICAgICAgICAgIGNsb25lZERlc2NyaXB0b3Iuam9pbnMuZm9yRWFjaChmdW5jdGlvbiAoam9pbkRlc2NyaXB0b3IpIHsKICAgICAgICAgICAgICAgICAgICAvLyByaWdodC5pZCBpcyB1dWlkIHVzZWQgdG8gdHJhY2sgcmVxdWVzdHMgaW4gaW5zcGVjdG9yCiAgICAgICAgICAgICAgICAgICAgam9pbkRlc2NyaXB0b3IucmlnaHQuaWQgPSAoMCwgX3YuZGVmYXVsdCkoKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgY2xvbmVkRGVzY3JpcHRvcik7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBjbG9uZURlc2NyaXB0b3IoKSB7CiAgICAgICAgcmV0dXJuIF9jbG9uZURlc2NyaXB0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGNsb25lRGVzY3JpcHRvcjsKICAgIH0oKQogIH0sIHsKICAgIGtleTogIm1ha2VNYkxheWVySWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1ha2VNYkxheWVySWQobGF5ZXJOYW1lU3VmZml4KSB7CiAgICAgIHJldHVybiAiIi5jb25jYXQodGhpcy5nZXRJZCgpKS5jb25jYXQoX2NvbnN0YW50cy5NQl9TT1VSQ0VfSURfTEFZRVJfSURfUFJFRklYX0RFTElNSVRFUikuY29uY2F0KGxheWVyTmFtZVN1ZmZpeCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNKb2luYWJsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNKb2luYWJsZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuZ2V0U291cmNlKCkuaXNKb2luYWJsZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogInN1cHBvcnRzRWxhc3RpY3NlYXJjaEZpbHRlcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN1cHBvcnRzRWxhc3RpY3NlYXJjaEZpbHRlcnMoKSB7CiAgICAgIHJldHVybiB0aGlzLmdldFNvdXJjZSgpLmlzRVNTb3VyY2UoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdXBwb3J0c0ZpdFRvQm91bmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfc3VwcG9ydHNGaXRUb0JvdW5kcyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRTb3VyY2UoKS5zdXBwb3J0c0ZpdFRvQm91bmRzKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDIuc2VudCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHN1cHBvcnRzRml0VG9Cb3VuZHMoKSB7CiAgICAgICAgcmV0dXJuIF9zdXBwb3J0c0ZpdFRvQm91bmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBzdXBwb3J0c0ZpdFRvQm91bmRzOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZ2V0RGlzcGxheU5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXREaXNwbGF5TmFtZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKHNvdXJjZSkgewogICAgICAgIHZhciBzb3VyY2VEaXNwbGF5TmFtZTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9kZXNjcmlwdG9yLmxhYmVsKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIHRoaXMuX2Rlc2NyaXB0b3IubGFiZWwpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBpZiAoIXNvdXJjZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2UuZ2V0RGlzcGxheU5hbWUoKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX2NvbnRleHQzLnQwID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDExOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRTb3VyY2UoKS5nZXREaXNwbGF5TmFtZSgpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLnQwID0gX2NvbnRleHQzLnNlbnQ7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBzb3VyY2VEaXNwbGF5TmFtZSA9IF9jb250ZXh0My50MDsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCBzb3VyY2VEaXNwbGF5TmFtZSB8fCAiTGF5ZXIgIi5jb25jYXQodGhpcy5fZGVzY3JpcHRvci5pZCkpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0RGlzcGxheU5hbWUoX3gpIHsKICAgICAgICByZXR1cm4gX2dldERpc3BsYXlOYW1lLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXREaXNwbGF5TmFtZTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImdldEF0dHJpYnV0aW9ucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldEF0dHJpYnV0aW9ucyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNFcnJvcnMoKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFNvdXJjZSgpLmdldEF0dHJpYnV0aW9ucygpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ0LnNlbnQpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgW10pOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRBdHRyaWJ1dGlvbnMoKSB7CiAgICAgICAgcmV0dXJuIF9nZXRBdHRyaWJ1dGlvbnMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldEF0dHJpYnV0aW9uczsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImdldExhYmVsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMYWJlbCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2Rlc2NyaXB0b3IubGFiZWwgPyB0aGlzLl9kZXNjcmlwdG9yLmxhYmVsIDogJyc7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Q3VzdG9tSWNvbkFuZFRvb2x0aXBDb250ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDdXN0b21JY29uQW5kVG9vbHRpcENvbnRlbnQoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgaWNvbjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUljb24sIHsKICAgICAgICAgIHNpemU6ICJtIiwKICAgICAgICAgIHR5cGU6IHRoaXMuZ2V0TGF5ZXJUeXBlSWNvbk5hbWUoKQogICAgICAgIH0pCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0SWNvbkFuZFRvb2x0aXBDb250ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJY29uQW5kVG9vbHRpcENvbnRlbnQoem9vbUxldmVsLCBpc1VzaW5nU2VhcmNoKSB7CiAgICAgIHZhciBpY29uOwogICAgICB2YXIgdG9vbHRpcENvbnRlbnQgPSBudWxsOwogICAgICB2YXIgZm9vdG5vdGVzID0gW107CgogICAgICBpZiAodGhpcy5oYXNFcnJvcnMoKSkgewogICAgICAgIGljb24gPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICAgICAgImFyaWEtbGFiZWwiOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5sYXllci5sb2FkV2FybmluZ0FyaWFMYWJlbCcsIHsKICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdMb2FkIHdhcm5pbmcnCiAgICAgICAgICB9KSwKICAgICAgICAgIHNpemU6ICJtIiwKICAgICAgICAgIHR5cGU6ICJhbGVydCIsCiAgICAgICAgICBjb2xvcjogIndhcm5pbmciCiAgICAgICAgfSk7CiAgICAgICAgdG9vbHRpcENvbnRlbnQgPSB0aGlzLmdldEVycm9ycygpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuaXNMYXllckxvYWRpbmcoKSkgewogICAgICAgIGljb24gPSBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTG9hZGluZ1NwaW5uZXIsIHsKICAgICAgICAgIHNpemU6ICJtIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLmlzVmlzaWJsZSgpKSB7CiAgICAgICAgaWNvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgICBzaXplOiAibSIsCiAgICAgICAgICB0eXBlOiAiZXllQ2xvc2VkIgogICAgICAgIH0pOwogICAgICAgIHRvb2x0aXBDb250ZW50ID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMubGF5ZXIubGF5ZXJIaWRkZW5Ub29sdGlwJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJMYXllciBpcyBoaWRkZW4uIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnNob3dBdFpvb21MZXZlbCh6b29tTGV2ZWwpKSB7CiAgICAgICAgdmFyIF90aGlzJGdldFpvb21Db25maWcgPSB0aGlzLmdldFpvb21Db25maWcoKSwKICAgICAgICAgICAgbWluWm9vbSA9IF90aGlzJGdldFpvb21Db25maWcubWluWm9vbSwKICAgICAgICAgICAgbWF4Wm9vbSA9IF90aGlzJGdldFpvb21Db25maWcubWF4Wm9vbTsKCiAgICAgICAgaWNvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgICAgICBzaXplOiAibSIsCiAgICAgICAgICB0eXBlOiAiZXhwYW5kIgogICAgICAgIH0pOwogICAgICAgIHRvb2x0aXBDb250ZW50ID0gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMubGF5ZXIuem9vbUZlZWRiYWNrVG9vbHRpcCcsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTGF5ZXIgaXMgdmlzaWJsZSBiZXR3ZWVuIHpvb20gbGV2ZWxzIHttaW5ab29tfSBhbmQge21heFpvb219LiIsCiAgICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgICAgbWluWm9vbTogbWluWm9vbSwKICAgICAgICAgICAgbWF4Wm9vbTogbWF4Wm9vbQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBjdXN0b21JY29uQW5kVG9vbHRpcENvbnRlbnQgPSB0aGlzLmdldEN1c3RvbUljb25BbmRUb29sdGlwQ29udGVudCgpOwoKICAgICAgICBpZiAoY3VzdG9tSWNvbkFuZFRvb2x0aXBDb250ZW50KSB7CiAgICAgICAgICBpY29uID0gY3VzdG9tSWNvbkFuZFRvb2x0aXBDb250ZW50Lmljb247CgogICAgICAgICAgaWYgKCFjdXN0b21JY29uQW5kVG9vbHRpcENvbnRlbnQuYXJlUmVzdWx0c1RyaW1tZWQpIHsKICAgICAgICAgICAgdG9vbHRpcENvbnRlbnQgPSBjdXN0b21JY29uQW5kVG9vbHRpcENvbnRlbnQudG9vbHRpcENvbnRlbnQ7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb290bm90ZXMucHVzaCh7CiAgICAgICAgICAgICAgaWNvbjogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUljb24sIHsKICAgICAgICAgICAgICAgIGNvbG9yOiAic3ViZHVlZCIsCiAgICAgICAgICAgICAgICB0eXBlOiAicGFydGlhbCIsCiAgICAgICAgICAgICAgICBzaXplOiAicyIKICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICBtZXNzYWdlOiBjdXN0b21JY29uQW5kVG9vbHRpcENvbnRlbnQudG9vbHRpcENvbnRlbnQKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoaXNVc2luZ1NlYXJjaCAmJiB0aGlzLmdldFF1ZXJ5YWJsZUluZGV4UGF0dGVybklkcygpLmxlbmd0aCkgewogICAgICAgICAgZm9vdG5vdGVzLnB1c2goewogICAgICAgICAgICBpY29uOiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSWNvbiwgewogICAgICAgICAgICAgIGNvbG9yOiAic3ViZHVlZCIsCiAgICAgICAgICAgICAgdHlwZTogImZpbHRlciIsCiAgICAgICAgICAgICAgc2l6ZTogInMiCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBtZXNzYWdlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subWFwcy5sYXllci5pc1VzaW5nU2VhcmNoTXNnJywgewogICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnUmVzdWx0cyBuYXJyb3dlZCBieSBzZWFyY2ggYmFyJwogICAgICAgICAgICB9KQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIGljb246IGljb24sCiAgICAgICAgdG9vbHRpcENvbnRlbnQ6IHRvb2x0aXBDb250ZW50LAogICAgICAgIGZvb3Rub3RlczogZm9vdG5vdGVzCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFzTGVnZW5kRGV0YWlscyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2hhc0xlZ2VuZERldGFpbHMgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaGFzTGVnZW5kRGV0YWlscygpIHsKICAgICAgICByZXR1cm4gX2hhc0xlZ2VuZERldGFpbHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGhhc0xlZ2VuZERldGFpbHM7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJyZW5kZXJMZWdlbmREZXRhaWxzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJMZWdlbmREZXRhaWxzKCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRJZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SWQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kZXNjcmlwdG9yLmlkOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFNvdXJjZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U291cmNlKCkgewogICAgICByZXR1cm4gdGhpcy5fc291cmNlOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFNvdXJjZUZvckVkaXRpbmciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNvdXJjZUZvckVkaXRpbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zb3VyY2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNWaXNpYmxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc1Zpc2libGUoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kZXNjcmlwdG9yLnZpc2libGU7CiAgICB9CiAgfSwgewogICAga2V5OiAic2hvd0F0Wm9vbUxldmVsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzaG93QXRab29tTGV2ZWwoem9vbSkgewogICAgICByZXR1cm4gem9vbSA+PSB0aGlzLl9kZXNjcmlwdG9yLm1pblpvb20gJiYgem9vbSA8PSB0aGlzLl9kZXNjcmlwdG9yLm1heFpvb207CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TWluWm9vbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWluWm9vbSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2Rlc2NyaXB0b3IubWluWm9vbTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRNYXhab29tIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRNYXhab29tKCkgewogICAgICByZXR1cm4gdGhpcy5fZGVzY3JpcHRvci5tYXhab29tOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEFscGhhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbHBoYSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2Rlc2NyaXB0b3IuYWxwaGE7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UXVlcnkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFF1ZXJ5KCkgewogICAgICByZXR1cm4gdGhpcy5fZGVzY3JpcHRvci5xdWVyeTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRab29tQ29uZmlnIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRab29tQ29uZmlnKCkgewogICAgICByZXR1cm4gewogICAgICAgIG1pblpvb206IHRoaXMuX2Rlc2NyaXB0b3IubWluWm9vbSwKICAgICAgICBtYXhab29tOiB0aGlzLl9kZXNjcmlwdG9yLm1heFpvb20KICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRDdXJyZW50U3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEN1cnJlbnRTdHlsZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFN0eWxlRm9yRWRpdGluZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U3R5bGVGb3JFZGl0aW5nKCkgewogICAgICByZXR1cm4gdGhpcy5fc3R5bGU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0SW1tdXRhYmxlU291cmNlUHJvcGVydGllcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldEltbXV0YWJsZVNvdXJjZVByb3BlcnRpZXMgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHRoaXMuZ2V0U291cmNlKCkuZ2V0SW1tdXRhYmxlUHJvcGVydGllcygpKTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU2LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0SW1tdXRhYmxlU291cmNlUHJvcGVydGllcygpIHsKICAgICAgICByZXR1cm4gX2dldEltbXV0YWJsZVNvdXJjZVByb3BlcnRpZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldEltbXV0YWJsZVNvdXJjZVByb3BlcnRpZXM7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJnZXRQcmV2UmVxdWVzdFRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQcmV2UmVxdWVzdFRva2VuKGRhdGFJZCkgewogICAgICB2YXIgcHJldkRhdGFSZXF1ZXN0ID0gdGhpcy5nZXREYXRhUmVxdWVzdChkYXRhSWQpOwoKICAgICAgaWYgKCFwcmV2RGF0YVJlcXVlc3QpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHJldHVybiBwcmV2RGF0YVJlcXVlc3QuZ2V0UmVxdWVzdFRva2VuKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0SW5GbGlnaHRSZXF1ZXN0VG9rZW5zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJbkZsaWdodFJlcXVlc3RUb2tlbnMoKSB7CiAgICAgIGlmICghdGhpcy5fZGF0YVJlcXVlc3RzKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CgogICAgICB2YXIgcmVxdWVzdFRva2VucyA9IHRoaXMuX2RhdGFSZXF1ZXN0cy5tYXAoZnVuY3Rpb24gKGRhdGFSZXF1ZXN0KSB7CiAgICAgICAgcmV0dXJuIGRhdGFSZXF1ZXN0LmdldFJlcXVlc3RUb2tlbigpOwogICAgICB9KTsKCiAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuY29tcGFjdChyZXF1ZXN0VG9rZW5zKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTb3VyY2VEYXRhUmVxdWVzdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U291cmNlRGF0YVJlcXVlc3QoKSB7CiAgICAgIHJldHVybiB0aGlzLmdldERhdGFSZXF1ZXN0KF9jb25zdGFudHMuU09VUkNFX0RBVEFfSURfT1JJR0lOKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXREYXRhUmVxdWVzdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF0YVJlcXVlc3QoaWQpIHsKICAgICAgcmV0dXJuIHRoaXMuX2RhdGFSZXF1ZXN0cy5maW5kKGZ1bmN0aW9uIChkYXRhUmVxdWVzdCkgewogICAgICAgIHJldHVybiBkYXRhUmVxdWVzdC5nZXREYXRhSWQoKSA9PT0gaWQ7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImlzTGF5ZXJMb2FkaW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0xheWVyTG9hZGluZygpIHsKICAgICAgcmV0dXJuIHRoaXMuX2RhdGFSZXF1ZXN0cy5zb21lKGZ1bmN0aW9uIChkYXRhUmVxdWVzdCkgewogICAgICAgIHJldHVybiBkYXRhUmVxdWVzdC5pc0xvYWRpbmcoKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFzRXJyb3JzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYXNFcnJvcnMoKSB7CiAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuZ2V0KHRoaXMuX2Rlc2NyaXB0b3IsICdfX2lzSW5FcnJvclN0YXRlJywgZmFsc2UpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEVycm9ycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RXJyb3JzKCkgewogICAgICByZXR1cm4gdGhpcy5oYXNFcnJvcnMoKSA/IHRoaXMuX2Rlc2NyaXB0b3IuX19lcnJvck1lc3NhZ2UgOiAnJzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0b0xheWVyRGVzY3JpcHRvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9MYXllckRlc2NyaXB0b3IoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kZXNjcmlwdG9yOwogICAgfQogIH0sIHsKICAgIGtleTogInN5bmNEYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfc3luY0RhdGEgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3KTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gc3luY0RhdGEoKSB7CiAgICAgICAgcmV0dXJuIF9zeW5jRGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gc3luY0RhdGE7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJnZXRNYkxheWVySWRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRNYkxheWVySWRzKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Nob3VsZCBpbXBsZW1lbnQgQWJzdHJhY3RMYXllciNnZXRNYkxheWVySWRzJyk7CiAgICB9CiAgfSwgewogICAga2V5OiAib3duc01iTGF5ZXJJZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb3duc01iTGF5ZXJJZCgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgaW1wbGVtZW50IEFic3RyYWN0TGF5ZXIjb3duc01iTGF5ZXJJZCcpOwogICAgfQogIH0sIHsKICAgIGtleTogIm93bnNNYlNvdXJjZUlkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvd25zTWJTb3VyY2VJZCgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgaW1wbGVtZW50IEFic3RyYWN0TGF5ZXIjb3duc01iU291cmNlSWQnKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjYW5TaG93VG9vbHRpcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2FuU2hvd1Rvb2x0aXAoKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzeW5jTGF5ZXJXaXRoTUIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN5bmNMYXllcldpdGhNQigpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgaW1wbGVtZW50IEFic3RyYWN0TGF5ZXIjc3luY0xheWVyV2l0aE1CJyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TGF5ZXJUeXBlSWNvbk5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldExheWVyVHlwZUljb25OYW1lKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Nob3VsZCBpbXBsZW1lbnQgTGF5ZXIjZ2V0TGF5ZXJUeXBlSWNvbk5hbWUnKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0RhdGFMb2FkZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzRGF0YUxvYWRlZCgpIHsKICAgICAgdmFyIHNvdXJjZURhdGFSZXF1ZXN0ID0gdGhpcy5nZXRTb3VyY2VEYXRhUmVxdWVzdCgpOwogICAgICByZXR1cm4gc291cmNlRGF0YVJlcXVlc3QgJiYgc291cmNlRGF0YVJlcXVlc3QuaGFzRGF0YSgpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEJvdW5kcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldEJvdW5kcyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgewogICAgICAgICAgICAgICAgICBtaW5fbG9uOiAtMTgwLAogICAgICAgICAgICAgICAgICBtYXhfbG9uOiAxODAsCiAgICAgICAgICAgICAgICAgIG1pbl9sYXQ6IC04OSwKICAgICAgICAgICAgICAgICAgbWF4X2xhdDogODkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTgpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRCb3VuZHMoKSB7CiAgICAgICAgcmV0dXJuIF9nZXRCb3VuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldEJvdW5kczsKICAgIH0oKQogIH0sIHsKICAgIGtleTogInJlbmRlclN0eWxlRWRpdG9yIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJTdHlsZUVkaXRvcihfcmVmMykgewogICAgICB2YXIgb25TdHlsZURlc2NyaXB0b3JDaGFuZ2UgPSBfcmVmMy5vblN0eWxlRGVzY3JpcHRvckNoYW5nZTsKICAgICAgdmFyIHN0eWxlID0gdGhpcy5nZXRTdHlsZUZvckVkaXRpbmcoKTsKCiAgICAgIGlmICghc3R5bGUpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIHN0eWxlLnJlbmRlckVkaXRvcih7CiAgICAgICAgbGF5ZXI6IHRoaXMsCiAgICAgICAgb25TdHlsZURlc2NyaXB0b3JDaGFuZ2U6IG9uU3R5bGVEZXNjcmlwdG9yQ2hhbmdlCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEluZGV4UGF0dGVybklkcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SW5kZXhQYXR0ZXJuSWRzKCkgewogICAgICByZXR1cm4gW107CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UXVlcnlhYmxlSW5kZXhQYXR0ZXJuSWRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRRdWVyeWFibGVJbmRleFBhdHRlcm5JZHMoKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzeW5jVmlzaWJpbGl0eVdpdGhNYiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3luY1Zpc2liaWxpdHlXaXRoTWIobWJNYXAsIG1iTGF5ZXJJZCkgewogICAgICBtYk1hcC5zZXRMYXlvdXRQcm9wZXJ0eShtYkxheWVySWQsICd2aXNpYmlsaXR5JywgdGhpcy5pc1Zpc2libGUoKSA/ICd2aXNpYmxlJyA6ICdub25lJyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VHlwZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VHlwZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2Rlc2NyaXB0b3IudHlwZTsKICAgIH0KICB9XSwgW3sKICAgIGtleTogImdldEJvdW5kRGF0YUZvclNvdXJjZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Qm91bmREYXRhRm9yU291cmNlKG1iTWFwLCBzb3VyY2VJZCkgewogICAgICB2YXIgbWJTdHlsZSA9IG1iTWFwLmdldFN0eWxlKCk7CiAgICAgIHJldHVybiBtYlN0eWxlLnNvdXJjZXNbc291cmNlSWRdLmRhdGE7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlRGVzY3JpcHRvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlRGVzY3JpcHRvcigpIHsKICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwoKICAgICAgdmFyIGxheWVyRGVzY3JpcHRvciA9IF9vYmplY3RTcHJlYWQoe30sIG9wdGlvbnMpOwoKICAgICAgbGF5ZXJEZXNjcmlwdG9yLl9fZGF0YVJlcXVlc3RzID0gX2xvZGFzaC5kZWZhdWx0LmdldChvcHRpb25zLCAnX19kYXRhUmVxdWVzdHMnLCBbXSk7CiAgICAgIGxheWVyRGVzY3JpcHRvci5pZCA9IF9sb2Rhc2guZGVmYXVsdC5nZXQob3B0aW9ucywgJ2lkJywgKDAsIF92LmRlZmF1bHQpKCkpOwogICAgICBsYXllckRlc2NyaXB0b3IubGFiZWwgPSBvcHRpb25zLmxhYmVsICYmIG9wdGlvbnMubGFiZWwubGVuZ3RoID4gMCA/IG9wdGlvbnMubGFiZWwgOiBudWxsOwogICAgICBsYXllckRlc2NyaXB0b3IubWluWm9vbSA9IF9sb2Rhc2guZGVmYXVsdC5nZXQob3B0aW9ucywgJ21pblpvb20nLCBfY29uc3RhbnRzLk1JTl9aT09NKTsKICAgICAgbGF5ZXJEZXNjcmlwdG9yLm1heFpvb20gPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KG9wdGlvbnMsICdtYXhab29tJywgX2NvbnN0YW50cy5NQVhfWk9PTSk7CiAgICAgIGxheWVyRGVzY3JpcHRvci5hbHBoYSA9IF9sb2Rhc2guZGVmYXVsdC5nZXQob3B0aW9ucywgJ2FscGhhJywgMC43NSk7CiAgICAgIGxheWVyRGVzY3JpcHRvci52aXNpYmxlID0gX2xvZGFzaC5kZWZhdWx0LmdldChvcHRpb25zLCAndmlzaWJsZScsIHRydWUpOwogICAgICBsYXllckRlc2NyaXB0b3Iuc3R5bGUgPSBfbG9kYXNoLmRlZmF1bHQuZ2V0KG9wdGlvbnMsICdzdHlsZScsIHt9KTsKICAgICAgcmV0dXJuIGxheWVyRGVzY3JpcHRvcjsKICAgIH0KICB9XSk7CgogIHJldHVybiBBYnN0cmFjdExheWVyOwp9KCk7CgpleHBvcnRzLkFic3RyYWN0TGF5ZXIgPSBBYnN0cmFjdExheWVyOw=="},null]}