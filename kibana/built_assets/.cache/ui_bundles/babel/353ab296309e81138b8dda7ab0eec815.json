{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/ui/public/vis/map/service_settings.js","dependencies":[{"path":"src/legacy/ui/public/vis/map/service_settings.js","mtime":1589249550387},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9tb2R1bGVzID0gcmVxdWlyZSgiLi4vLi4vbW9kdWxlcyIpOwoKdmFyIF9sb2Rhc2ggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImxvZGFzaCIpKTsKCnZhciBfbWFya2Rvd25JdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibWFya2Rvd24taXQiKSk7Cgp2YXIgX29yaWdpbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvcmVfcGx1Z2lucy90aWxlX21hcC9jb21tb24vb3JpZ2luIik7Cgp2YXIgX2Vtc0NsaWVudCA9IHJlcXVpcmUoIkBlbGFzdGljL2Vtcy1jbGllbnQiKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKcmVxdWlyZSgiYW5ndWxhci1zYW5pdGl6ZSIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOyB9IH0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKdmFyIG1hcmtkb3duSXQgPSBuZXcgX21hcmtkb3duSXQuZGVmYXVsdCh7CiAgaHRtbDogZmFsc2UsCiAgbGlua2lmeTogdHJ1ZQp9KTsKdmFyIFRNU19JTl9ZTUxfSUQgPSAnVE1TIGluIGNvbmZpZy9raWJhbmEueW1sJzsKCl9tb2R1bGVzLnVpTW9kdWxlcy5nZXQoJ2tpYmFuYScsIFsnbmdTYW5pdGl6ZSddKS5zZXJ2aWNlKCdzZXJ2aWNlU2V0dGluZ3MnLCBmdW5jdGlvbiAoJHNhbml0aXplLCBtYXBDb25maWcsIHRpbGVtYXBzQ29uZmlnLCBrYm5WZXJzaW9uKSB7CiAgdmFyIGF0dHJpYnV0aW9uRnJvbUNvbmZpZyA9ICRzYW5pdGl6ZShtYXJrZG93bkl0LnJlbmRlcih0aWxlbWFwc0NvbmZpZy5kZXByZWNhdGVkLmNvbmZpZy5vcHRpb25zLmF0dHJpYnV0aW9uIHx8ICcnKSk7CgogIHZhciB0bXNPcHRpb25zRnJvbUNvbmZpZyA9IF9sb2Rhc2guZGVmYXVsdC5hc3NpZ24oe30sIHRpbGVtYXBzQ29uZmlnLmRlcHJlY2F0ZWQuY29uZmlnLm9wdGlvbnMsIHsKICAgIGF0dHJpYnV0aW9uOiBhdHRyaWJ1dGlvbkZyb21Db25maWcKICB9KTsKCiAgdmFyIFNlcnZpY2VTZXR0aW5ncyA9CiAgLyojX19QVVJFX18qLwogIGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFNlcnZpY2VTZXR0aW5ncygpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNlcnZpY2VTZXR0aW5ncyk7CgogICAgICB0aGlzLl9zaG93Wm9vbU1lc3NhZ2UgPSB0cnVlOwogICAgICB0aGlzLl9lbXNDbGllbnQgPSBuZXcgX2Vtc0NsaWVudC5FTVNDbGllbnQoewogICAgICAgIGxhbmd1YWdlOiBfaTE4bi5pMThuLmdldExvY2FsZSgpLAogICAgICAgIGFwcFZlcnNpb246IGtiblZlcnNpb24sCiAgICAgICAgYXBwTmFtZTogJ2tpYmFuYScsCiAgICAgICAgZmlsZUFwaVVybDogbWFwQ29uZmlnLmVtc0ZpbGVBcGlVcmwsCiAgICAgICAgdGlsZUFwaVVybDogbWFwQ29uZmlnLmVtc1RpbGVBcGlVcmwsCiAgICAgICAgaHRtbFNhbml0aXplcjogJHNhbml0aXplLAogICAgICAgIGxhbmRpbmdQYWdlVXJsOiBtYXBDb25maWcuZW1zTGFuZGluZ1BhZ2VVcmwKICAgICAgfSk7CiAgICB9CgogICAgX2NyZWF0ZUNsYXNzKFNlcnZpY2VTZXR0aW5ncywgW3sKICAgICAga2V5OiAic2hvdWxkU2hvd1pvb21NZXNzYWdlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNob3VsZFNob3dab29tTWVzc2FnZShfcmVmKSB7CiAgICAgICAgdmFyIG9yaWdpbiA9IF9yZWYub3JpZ2luOwogICAgICAgIHJldHVybiBvcmlnaW4gPT09IF9vcmlnaW4uT1JJR0lOLkVNUyAmJiB0aGlzLl9zaG93Wm9vbU1lc3NhZ2U7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZGlzYWJsZVpvb21NZXNzYWdlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2FibGVab29tTWVzc2FnZSgpIHsKICAgICAgICB0aGlzLl9zaG93Wm9vbU1lc3NhZ2UgPSBmYWxzZTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJfX2RlYnVnU3R1Yk1hbmlmZXN0Q2FsbHMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gX19kZWJ1Z1N0dWJNYW5pZmVzdENhbGxzKG1hbmlmZXN0UmV0cmlldmFsKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgICAgdmFyIG9sZEdldE1hbmlmZXN0ID0gdGhpcy5fZW1zQ2xpZW50LmdldE1hbmlmZXN0OwogICAgICAgIHRoaXMuX2Vtc0NsaWVudC5nZXRNYW5pZmVzdCA9IG1hbmlmZXN0UmV0cmlldmFsOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICByZW1vdmVTdHViOiBmdW5jdGlvbiByZW1vdmVTdHViKCkgewogICAgICAgICAgICBkZWxldGUgX3RoaXMuX2Vtc0NsaWVudC5nZXRNYW5pZmVzdDsgLy9ub3Qgc3RyaWN0bHkgbmVjZXNzYXJ5IHNpbmNlIHRoaXMgaXMgcHJvdG90eXBlIG1ldGhvZAoKICAgICAgICAgICAgaWYgKF90aGlzLl9lbXNDbGllbnQuZ2V0TWFuaWZlc3QgIT09IG9sZEdldE1hbmlmZXN0KSB7CiAgICAgICAgICAgICAgX3RoaXMuX2Vtc0NsaWVudC5nZXRNYW5pZmVzdCA9IG9sZEdldE1hbmlmZXN0OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnZXRGaWxlTGF5ZXJzIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2dldEZpbGVMYXllcnMgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICAgIHZhciBmaWxlTGF5ZXJzOwogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBpZiAobWFwQ29uZmlnLmluY2x1ZGVFbGFzdGljTWFwc1NlcnZpY2UpIHsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgW10pOwoKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9lbXNDbGllbnQuZ2V0RmlsZUxheWVycygpOwoKICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgZmlsZUxheWVycyA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGZpbGVMYXllcnMubWFwKGZ1bmN0aW9uIChmaWxlTGF5ZXIpIHsKICAgICAgICAgICAgICAgICAgICAvL2JhY2tmaWxsIHRvIG9sZGVyIHNldHRpbmdzCiAgICAgICAgICAgICAgICAgICAgdmFyIGZvcm1hdCA9IGZpbGVMYXllci5nZXREZWZhdWx0Rm9ybWF0VHlwZSgpOwogICAgICAgICAgICAgICAgICAgIHZhciBtZXRhID0gZmlsZUxheWVyLmdldERlZmF1bHRGb3JtYXRNZXRhKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGZpbGVMYXllci5nZXREaXNwbGF5TmFtZSgpLAogICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBmaWxlTGF5ZXIuZ2V0T3JpZ2luKCksCiAgICAgICAgICAgICAgICAgICAgICBpZDogZmlsZUxheWVyLmdldElkKCksCiAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiBmaWxlTGF5ZXIuZ2V0Q3JlYXRlZEF0KCksCiAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjogZmlsZUxheWVyLmdldEhUTUxBdHRyaWJ1dGlvbigpLAogICAgICAgICAgICAgICAgICAgICAgZmllbGRzOiBmaWxlTGF5ZXIuZ2V0RmllbGRzSW5MYW5ndWFnZSgpLAogICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBmb3JtYXQsCiAgICAgICAgICAgICAgICAgICAgICAvL2xlZ2FjeTogZm9ybWF0IGFuZCBtZXRhIGFyZSBzcGxpdCB1cAogICAgICAgICAgICAgICAgICAgICAgbWV0YTogbWV0YSAvL2xlZ2FjeSwgZm9ybWF0IGFuZCBtZXRhIGFyZSBzcGxpdCB1cAoKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpOwogICAgICAgIH0pKTsKCiAgICAgICAgZnVuY3Rpb24gZ2V0RmlsZUxheWVycygpIHsKICAgICAgICAgIHJldHVybiBfZ2V0RmlsZUxheWVycy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGdldEZpbGVMYXllcnM7CiAgICAgIH0oKQogICAgICAvKioKICAgICAgICogUmV0dXJucyBhbGwgdGhlIHNlcnZpY2VzIHB1Ymxpc2hlZCBieSBFTVMgKGlmIGNvbmZpZ3VyZXMpCiAgICAgICAqIEl0IGFsc28gaW5jbHVkZXMgdGhlIHNlcnZpY2UgY29uZmlndXJlZCBpbiB0aWxlbWFwIChvdmVycmlkZSkKICAgICAgICovCgogICAgfSwgewogICAgICBrZXk6ICJnZXRUTVNTZXJ2aWNlcyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9nZXRUTVNTZXJ2aWNlcyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICAgIHZhciBhbGxTZXJ2aWNlcywgdG1zU2VydmljZSwgc2VydmljZXNGcm9tTWFuaWZlc3QsIHN0cmlwcGVkU2VydmljZUZyb21NYW5pZmVzdDsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIGFsbFNlcnZpY2VzID0gW107CgogICAgICAgICAgICAgICAgICBpZiAodGlsZW1hcHNDb25maWcuZGVwcmVjYXRlZC5pc092ZXJyaWRkZW4pIHsKICAgICAgICAgICAgICAgICAgICAvL3VzZSB0aWxlbWFwLiogc2V0dGluZ3MgZnJvbSB5bWwKICAgICAgICAgICAgICAgICAgICB0bXNTZXJ2aWNlID0gX2xvZGFzaC5kZWZhdWx0LmNsb25lRGVlcCh0bXNPcHRpb25zRnJvbUNvbmZpZyk7CiAgICAgICAgICAgICAgICAgICAgdG1zU2VydmljZS5pZCA9IFRNU19JTl9ZTUxfSUQ7CiAgICAgICAgICAgICAgICAgICAgdG1zU2VydmljZS5vcmlnaW4gPSBfb3JpZ2luLk9SSUdJTi5LSUJBTkFfWU1MOwogICAgICAgICAgICAgICAgICAgIGFsbFNlcnZpY2VzLnB1c2godG1zU2VydmljZSk7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGlmICghbWFwQ29uZmlnLmluY2x1ZGVFbGFzdGljTWFwc1NlcnZpY2UpIHsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9lbXNDbGllbnQuZ2V0VE1TU2VydmljZXMoKTsKCiAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgIHNlcnZpY2VzRnJvbU1hbmlmZXN0ID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHNlcnZpY2VzRnJvbU1hbmlmZXN0LmZpbHRlcihmdW5jdGlvbiAodG1zU2VydmljZSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0bXNTZXJ2aWNlLmdldElkKCkgPT09IG1hcENvbmZpZy5lbXNUaWxlTGF5ZXJJZC5icmlnaHQ7CiAgICAgICAgICAgICAgICAgIH0pLm1hcCgKICAgICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKHRtc1NlcnZpY2UpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBzaGltOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gdG1zU2VydmljZS5nZXRPcmlnaW4oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnQxID0gdG1zU2VydmljZS5nZXRJZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0bXNTZXJ2aWNlLmdldE1pblpvb20oKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MiA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0bXNTZXJ2aWNlLmdldE1heFpvb20oKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MyA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIudDQgPSB0bXNTZXJ2aWNlLmdldEhUTUxBdHRyaWJ1dGlvbigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGltID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogX2NvbnRleHQyLnQwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBfY29udGV4dDIudDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluWm9vbTogX2NvbnRleHQyLnQyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFpvb206IF9jb250ZXh0Mi50MywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjogX2NvbnRleHQyLnQ0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBzaGltKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9KCkpKTsKCiAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgIHN0cmlwcGVkU2VydmljZUZyb21NYW5pZmVzdCA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgICBhbGxTZXJ2aWNlcyA9IGFsbFNlcnZpY2VzLmNvbmNhdChzdHJpcHBlZFNlcnZpY2VGcm9tTWFuaWZlc3QpOwoKICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCBhbGxTZXJ2aWNlcyk7CgogICAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpOwogICAgICAgIH0pKTsKCiAgICAgICAgZnVuY3Rpb24gZ2V0VE1TU2VydmljZXMoKSB7CiAgICAgICAgICByZXR1cm4gX2dldFRNU1NlcnZpY2VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZ2V0VE1TU2VydmljZXM7CiAgICAgIH0oKQogICAgICAvKioKICAgICAgICogQWRkIG9wdGlvbmFsIHF1ZXJ5LXBhcmFtZXRlcnMgdG8gYWxsIHJlcXVlc3RzCiAgICAgICAqCiAgICAgICAqIEBwYXJhbSBhZGRpdGlvbmFsUXVlcnlQYXJhbXMKICAgICAgICovCgogICAgfSwgewogICAgICBrZXk6ICJhZGRRdWVyeVBhcmFtcyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRRdWVyeVBhcmFtcyhhZGRpdGlvbmFsUXVlcnlQYXJhbXMpIHsKICAgICAgICB0aGlzLl9lbXNDbGllbnQuYWRkUXVlcnlQYXJhbXMoYWRkaXRpb25hbFF1ZXJ5UGFyYW1zKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnZXRFTVNIb3RMaW5rIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2dldEVNU0hvdExpbmsgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoZmlsZUxheWVyQ29uZmlnKSB7CiAgICAgICAgICB2YXIgZmlsZUxheWVycywgbGF5ZXI7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9lbXNDbGllbnQuZ2V0RmlsZUxheWVycygpOwoKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgZmlsZUxheWVycyA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgICBsYXllciA9IGZpbGVMYXllcnMuZmluZChmdW5jdGlvbiAoZmlsZUxheWVyKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0lkQnlOYW1lID0gZmlsZUxheWVyLmhhc0lkKGZpbGVMYXllckNvbmZpZy5uYW1lKTsgLy9sZWdhY3kKCiAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0lkQnlJZCA9IGZpbGVMYXllci5oYXNJZChmaWxlTGF5ZXJDb25maWcuaWQpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBoYXNJZEJ5TmFtZSB8fCBoYXNJZEJ5SWQ7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgbGF5ZXIgPyBsYXllci5nZXRFTVNIb3RMaW5rKCkgOiBudWxsKTsKCiAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIF9jYWxsZWU0LCB0aGlzKTsKICAgICAgICB9KSk7CgogICAgICAgIGZ1bmN0aW9uIGdldEVNU0hvdExpbmsoX3gyKSB7CiAgICAgICAgICByZXR1cm4gX2dldEVNU0hvdExpbmsuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBnZXRFTVNIb3RMaW5rOwogICAgICB9KCkKICAgIH0sIHsKICAgICAga2V5OiAiX2dldEF0dHJpYnV0ZXNGb3JFTVNUTVNMYXllciIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9nZXRBdHRyaWJ1dGVzRm9yRU1TVE1TTGF5ZXIyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KGlzRGVzYXR1cmF0ZWQsIGlzRGFya01vZGUpIHsKICAgICAgICAgIHZhciB0bXNTZXJ2aWNlcywgZW1zVGlsZUxheWVySWQsIHNlcnZpY2VJZCwgdG1zU2VydmljZTsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Vtc0NsaWVudC5nZXRUTVNTZXJ2aWNlcygpOwoKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgdG1zU2VydmljZXMgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgICAgZW1zVGlsZUxheWVySWQgPSBtYXBDb25maWcuZW1zVGlsZUxheWVySWQ7CgogICAgICAgICAgICAgICAgICBpZiAoaXNEYXJrTW9kZSkgewogICAgICAgICAgICAgICAgICAgIHNlcnZpY2VJZCA9IGVtc1RpbGVMYXllcklkLmRhcms7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRGVzYXR1cmF0ZWQpIHsKICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VJZCA9IGVtc1RpbGVMYXllcklkLmRlc2F0dXJhdGVkOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlSWQgPSBlbXNUaWxlTGF5ZXJJZC5icmlnaHQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB0bXNTZXJ2aWNlID0gdG1zU2VydmljZXMuZmluZChmdW5jdGlvbiAoc2VydmljZSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLmdldElkKCkgPT09IHNlcnZpY2VJZDsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRtc1NlcnZpY2UuZ2V0VXJsVGVtcGxhdGUoKTsKCiAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS50MCA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDExOwogICAgICAgICAgICAgICAgICByZXR1cm4gdG1zU2VydmljZS5nZXRNaW5ab29tKCk7CgogICAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1LnQxID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0bXNTZXJ2aWNlLmdldE1heFpvb20oKTsKCiAgICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgICBfY29udGV4dDUudDIgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxNzsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRtc1NlcnZpY2UuZ2V0SFRNTEF0dHJpYnV0aW9uKCk7CgogICAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1LnQzID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS50NCA9IF9vcmlnaW4uT1JJR0lOLkVNUzsKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICAgICAgICB1cmw6IF9jb250ZXh0NS50MCwKICAgICAgICAgICAgICAgICAgICBtaW5ab29tOiBfY29udGV4dDUudDEsCiAgICAgICAgICAgICAgICAgICAgbWF4Wm9vbTogX2NvbnRleHQ1LnQyLAogICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0aW9uOiBfY29udGV4dDUudDMsCiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBfY29udGV4dDUudDQKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZTUsIHRoaXMpOwogICAgICAgIH0pKTsKCiAgICAgICAgZnVuY3Rpb24gX2dldEF0dHJpYnV0ZXNGb3JFTVNUTVNMYXllcihfeDMsIF94NCkgewogICAgICAgICAgcmV0dXJuIF9nZXRBdHRyaWJ1dGVzRm9yRU1TVE1TTGF5ZXIyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gX2dldEF0dHJpYnV0ZXNGb3JFTVNUTVNMYXllcjsKICAgICAgfSgpCiAgICB9LCB7CiAgICAgIGtleTogImdldEF0dHJpYnV0ZXNGb3JUTVNMYXllciIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9nZXRBdHRyaWJ1dGVzRm9yVE1TTGF5ZXIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYodG1zU2VydmljZUNvbmZpZywgaXNEZXNhdHVyYXRlZCwgaXNEYXJrTW9kZSkgewogICAgICAgICAgdmFyIGNvbmZpZywgYXR0cnMsIF9jb25maWcsIF9hdHRyczsKCiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBpZiAoISh0bXNTZXJ2aWNlQ29uZmlnLm9yaWdpbiA9PT0gX29yaWdpbi5PUklHSU4uRU1TKSkgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHRoaXMuX2dldEF0dHJpYnV0ZXNGb3JFTVNUTVNMYXllcihpc0Rlc2F0dXJhdGVkLCBpc0RhcmtNb2RlKSk7CgogICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICBpZiAoISh0bXNTZXJ2aWNlQ29uZmlnLm9yaWdpbiA9PT0gX29yaWdpbi5PUklHSU4uS0lCQU5BX1lNTCkpIHsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBjb25maWcgPSB0aWxlbWFwc0NvbmZpZy5kZXByZWNhdGVkLmNvbmZpZzsKICAgICAgICAgICAgICAgICAgYXR0cnMgPSBfbG9kYXNoLmRlZmF1bHQucGljayhjb25maWcsIFsndXJsJywgJ21pbnpvb20nLCAnbWF4em9vbScsICdhdHRyaWJ1dGlvbiddKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIF9vYmplY3RTcHJlYWQoe30sIGF0dHJzLCB7fSwgewogICAgICAgICAgICAgICAgICAgIG9yaWdpbjogX29yaWdpbi5PUklHSU4uS0lCQU5BX1lNTAogICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgaWYgKCEodG1zU2VydmljZUNvbmZpZy5pZCA9PT0gVE1TX0lOX1lNTF9JRCkpIHsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBfY29uZmlnID0gdGlsZW1hcHNDb25maWcuZGVwcmVjYXRlZC5jb25maWc7CiAgICAgICAgICAgICAgICAgIF9hdHRycyA9IF9sb2Rhc2guZGVmYXVsdC5waWNrKF9jb25maWcsIFsndXJsJywgJ21pbnpvb20nLCAnbWF4em9vbScsICdhdHRyaWJ1dGlvbiddKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIF9vYmplY3RTcHJlYWQoe30sIF9hdHRycywge30sIHsKICAgICAgICAgICAgICAgICAgICBvcmlnaW46IF9vcmlnaW4uT1JJR0lOLktJQkFOQV9ZTUwKICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iLCB0aGlzLl9nZXRBdHRyaWJ1dGVzRm9yRU1TVE1TTGF5ZXIoaXNEZXNhdHVyYXRlZCwgaXNEYXJrTW9kZSkpOwoKICAgICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIF9jYWxsZWU2LCB0aGlzKTsKICAgICAgICB9KSk7CgogICAgICAgIGZ1bmN0aW9uIGdldEF0dHJpYnV0ZXNGb3JUTVNMYXllcihfeDUsIF94NiwgX3g3KSB7CiAgICAgICAgICByZXR1cm4gX2dldEF0dHJpYnV0ZXNGb3JUTVNMYXllci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGdldEF0dHJpYnV0ZXNGb3JUTVNMYXllcjsKICAgICAgfSgpCiAgICB9LCB7CiAgICAgIGtleTogIl9nZXRGaWxlVXJsRnJvbUVNUyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9nZXRGaWxlVXJsRnJvbUVNUzIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoZmlsZUxheWVyQ29uZmlnKSB7CiAgICAgICAgICB2YXIgZmlsZUxheWVycywgbGF5ZXI7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9lbXNDbGllbnQuZ2V0RmlsZUxheWVycygpOwoKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgZmlsZUxheWVycyA9IF9jb250ZXh0Ny5zZW50OwogICAgICAgICAgICAgICAgICBsYXllciA9IGZpbGVMYXllcnMuZmluZChmdW5jdGlvbiAoZmlsZUxheWVyKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0lkQnlOYW1lID0gZmlsZUxheWVyLmhhc0lkKGZpbGVMYXllckNvbmZpZy5uYW1lKTsgLy9sZWdhY3kKCiAgICAgICAgICAgICAgICAgICAgdmFyIGhhc0lkQnlJZCA9IGZpbGVMYXllci5oYXNJZChmaWxlTGF5ZXJDb25maWcuaWQpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBoYXNJZEJ5TmFtZSB8fCBoYXNJZEJ5SWQ7CiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgaWYgKCFsYXllcikgewogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIsIGxheWVyLmdldERlZmF1bHRGb3JtYXRVcmwoKSk7CgogICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkZpbGUgICIuY29uY2F0KGZpbGVMYXllckNvbmZpZy5uYW1lLCAiIG5vdCByZWNvZ25pemVkIikpOwoKICAgICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZTcsIHRoaXMpOwogICAgICAgIH0pKTsKCiAgICAgICAgZnVuY3Rpb24gX2dldEZpbGVVcmxGcm9tRU1TKF94OCkgewogICAgICAgICAgcmV0dXJuIF9nZXRGaWxlVXJsRnJvbUVNUzIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBfZ2V0RmlsZVVybEZyb21FTVM7CiAgICAgIH0oKQogICAgfSwgewogICAgICBrZXk6ICJnZXRVcmxGb3JSZWdpb25MYXllciIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9nZXRVcmxGb3JSZWdpb25MYXllciA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOChmaWxlTGF5ZXJDb25maWcpIHsKICAgICAgICAgIHZhciB1cmw7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBpZiAoZmlsZUxheWVyQ29uZmlnLm9yaWdpbiA9PT0gX29yaWdpbi5PUklHSU4uRU1TKSB7CiAgICAgICAgICAgICAgICAgICAgdXJsID0gdGhpcy5fZ2V0RmlsZVVybEZyb21FTVMoZmlsZUxheWVyQ29uZmlnKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlTGF5ZXJDb25maWcubGF5ZXJJZCAmJiBmaWxlTGF5ZXJDb25maWcubGF5ZXJJZC5zdGFydHNXaXRoKCIiLmNvbmNhdChfb3JpZ2luLk9SSUdJTi5FTVMsICIuIikpKSB7CiAgICAgICAgICAgICAgICAgICAgLy9mYWxsYmFjayBmb3Igb2xkZXIgc2F2ZWQgb2JqZWN0cwogICAgICAgICAgICAgICAgICAgIHVybCA9IHRoaXMuX2dldEZpbGVVcmxGcm9tRU1TKGZpbGVMYXllckNvbmZpZyk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZUxheWVyQ29uZmlnLmxheWVySWQgJiYgZmlsZUxheWVyQ29uZmlnLmxheWVySWQuc3RhcnRzV2l0aCgiIi5jb25jYXQoX29yaWdpbi5PUklHSU4uS0lCQU5BX1lNTCwgIi4iKSkpIHsKICAgICAgICAgICAgICAgICAgICAvL2ZhbGxiYWNrIGZvciBvbGRlciBzYXZlZCBvYmplY3RzCiAgICAgICAgICAgICAgICAgICAgdXJsID0gZmlsZUxheWVyQ29uZmlnLnVybDsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvL2dlbmVyaWMgZmFsbGJhY2sKICAgICAgICAgICAgICAgICAgICB1cmwgPSBmaWxlTGF5ZXJDb25maWcudXJsOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgdXJsKTsKCiAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIF9jYWxsZWU4LCB0aGlzKTsKICAgICAgICB9KSk7CgogICAgICAgIGZ1bmN0aW9uIGdldFVybEZvclJlZ2lvbkxheWVyKF94OSkgewogICAgICAgICAgcmV0dXJuIF9nZXRVcmxGb3JSZWdpb25MYXllci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGdldFVybEZvclJlZ2lvbkxheWVyOwogICAgICB9KCkKICAgIH0sIHsKICAgICAga2V5OiAiZ2V0SnNvbkZvclJlZ2lvbkxheWVyIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2dldEpzb25Gb3JSZWdpb25MYXllciA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOShmaWxlTGF5ZXJDb25maWcpIHsKICAgICAgICAgIHZhciB1cmwsIHJlc3BvbnNlOwogICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRVcmxGb3JSZWdpb25MYXllcihmaWxlTGF5ZXJDb25maWcpOwoKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgdXJsID0gX2NvbnRleHQ5LnNlbnQ7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGZldGNoKHVybCk7CgogICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0OS5zZW50OwogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CgogICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ5LnNlbnQpOwoKICAgICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZTksIHRoaXMpOwogICAgICAgIH0pKTsKCiAgICAgICAgZnVuY3Rpb24gZ2V0SnNvbkZvclJlZ2lvbkxheWVyKF94MTApIHsKICAgICAgICAgIHJldHVybiBfZ2V0SnNvbkZvclJlZ2lvbkxheWVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZ2V0SnNvbkZvclJlZ2lvbkxheWVyOwogICAgICB9KCkKICAgIH1dKTsKCiAgICByZXR1cm4gU2VydmljZVNldHRpbmdzOwogIH0oKTsKCiAgcmV0dXJuIG5ldyBTZXJ2aWNlU2V0dGluZ3MoKTsKfSk7"},null]}