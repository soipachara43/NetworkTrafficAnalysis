{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/components/signals/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/components/signals/index.js","mtime":1589249553288},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlNpZ25hbHNUYWJsZSA9IGV4cG9ydHMuU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lEID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfZnAgPSByZXF1aXJlKCJsb2Rhc2gvZnAiKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfcmVhY3RSZWR1eCA9IHJlcXVpcmUoInJlYWN0LXJlZHV4Iik7Cgp2YXIgX3B1YmxpYyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3NyYy9wbHVnaW5zL2RhdGEvcHVibGljIik7Cgp2YXIgX2ZldGNoX2luZGV4X3BhdHRlcm5zID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29udGFpbmVycy9kZXRlY3Rpb25fZW5naW5lL3J1bGVzL2ZldGNoX2luZGV4X3BhdHRlcm5zIik7Cgp2YXIgX2V2ZW50c192aWV3ZXIgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL2V2ZW50c192aWV3ZXIiKTsKCnZhciBfaGVhZGVyX3NlY3Rpb24gPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL2hlYWRlcl9zZWN0aW9uIik7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL3RpbWVsaW5lL2hlbHBlcnMiKTsKCnZhciBfa2liYW5hID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vbGliL2tpYmFuYSIpOwoKdmFyIF9zdG9yZSA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3N0b3JlIik7Cgp2YXIgX3RpbWVsaW5lID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vc3RvcmUvdGltZWxpbmUiKTsKCnZhciBfZGVmYXVsdHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9zdG9yZS90aW1lbGluZS9kZWZhdWx0cyIpOwoKdmFyIF9hcG9sbG9fY29udGV4dCA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL3V0aWxzL2Fwb2xsb19jb250ZXh0Iik7Cgp2YXIgX2FjdGlvbnMgPSByZXF1aXJlKCIuL2FjdGlvbnMiKTsKCnZhciBfZGVmYXVsdF9jb25maWcgPSByZXF1aXJlKCIuL2RlZmF1bHRfY29uZmlnIik7Cgp2YXIgX3NpZ25hbHNfZmlsdGVyX2dyb3VwID0gcmVxdWlyZSgiLi9zaWduYWxzX2ZpbHRlcl9ncm91cCIpOwoKdmFyIF9zaWduYWxzX3V0aWxpdHlfYmFyID0gcmVxdWlyZSgiLi9zaWduYWxzX3V0aWxpdHlfYmFyIik7Cgp2YXIgaTE4biA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIi4vdHJhbnNsYXRpb25zIikpOwoKdmFyIF9oZWxwZXJzMiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbXBvbmVudHMvb3Blbl90aW1lbGluZS9oZWxwZXJzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsKICB0cnkgewogICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOwogICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVqZWN0KGVycm9yKTsKICAgIHJldHVybjsKICB9CgogIGlmIChpbmZvLmRvbmUpIHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0gZWxzZSB7CiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7CiAgfQp9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgYXJncyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsKCiAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsKICAgICAgfQoKICAgICAgX25leHQodW5kZWZpbmVkKTsKICAgIH0pOwogIH07Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciBTSUdOQUxTX1BBR0VfVElNRUxJTkVfSUQgPSAnc2lnbmFscy1wYWdlJzsKZXhwb3J0cy5TSUdOQUxTX1BBR0VfVElNRUxJTkVfSUQgPSBTSUdOQUxTX1BBR0VfVElNRUxJTkVfSUQ7Cgp2YXIgU2lnbmFsc1RhYmxlQ29tcG9uZW50ID0gZnVuY3Rpb24gU2lnbmFsc1RhYmxlQ29tcG9uZW50KF9yZWYpIHsKICB2YXIgY2FuVXNlckNSVUQgPSBfcmVmLmNhblVzZXJDUlVELAogICAgICBjbGVhckV2ZW50c0RlbGV0ZWQgPSBfcmVmLmNsZWFyRXZlbnRzRGVsZXRlZCwKICAgICAgY2xlYXJFdmVudHNMb2FkaW5nID0gX3JlZi5jbGVhckV2ZW50c0xvYWRpbmcsCiAgICAgIGNsZWFyU2VsZWN0ZWQgPSBfcmVmLmNsZWFyU2VsZWN0ZWQsCiAgICAgIGRlZmF1bHRGaWx0ZXJzID0gX3JlZi5kZWZhdWx0RmlsdGVycywKICAgICAgZnJvbSA9IF9yZWYuZnJvbSwKICAgICAgZ2xvYmFsRmlsdGVycyA9IF9yZWYuZ2xvYmFsRmlsdGVycywKICAgICAgZ2xvYmFsUXVlcnkgPSBfcmVmLmdsb2JhbFF1ZXJ5LAogICAgICBoYXNJbmRleFdyaXRlID0gX3JlZi5oYXNJbmRleFdyaXRlLAogICAgICBpc1NlbGVjdEFsbENoZWNrZWQgPSBfcmVmLmlzU2VsZWN0QWxsQ2hlY2tlZCwKICAgICAgbG9hZGluZyA9IF9yZWYubG9hZGluZywKICAgICAgbG9hZGluZ0V2ZW50SWRzID0gX3JlZi5sb2FkaW5nRXZlbnRJZHMsCiAgICAgIHNlbGVjdGVkRXZlbnRJZHMgPSBfcmVmLnNlbGVjdGVkRXZlbnRJZHMsCiAgICAgIHNldEV2ZW50c0RlbGV0ZWQgPSBfcmVmLnNldEV2ZW50c0RlbGV0ZWQsCiAgICAgIHNldEV2ZW50c0xvYWRpbmcgPSBfcmVmLnNldEV2ZW50c0xvYWRpbmcsCiAgICAgIHNpZ25hbHNJbmRleCA9IF9yZWYuc2lnbmFsc0luZGV4LAogICAgICB0byA9IF9yZWYudG8sCiAgICAgIHVwZGF0ZVRpbWVsaW5lID0gX3JlZi51cGRhdGVUaW1lbGluZSwKICAgICAgdXBkYXRlVGltZWxpbmVJc0xvYWRpbmcgPSBfcmVmLnVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nOwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgc2VsZWN0QWxsID0gX3VzZVN0YXRlMlswXSwKICAgICAgc2V0U2VsZWN0QWxsID0gX3VzZVN0YXRlMlsxXTsKCiAgdmFyIGFwb2xsb0NsaWVudCA9ICgwLCBfYXBvbGxvX2NvbnRleHQudXNlQXBvbGxvQ2xpZW50KSgpOwoKICB2YXIgX3VzZVN0YXRlMyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTMsIDIpLAogICAgICBzaG93Q2xlYXJTZWxlY3Rpb25BY3Rpb24gPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRTaG93Q2xlYXJTZWxlY3Rpb25BY3Rpb24gPSBfdXNlU3RhdGU0WzFdOwoKICB2YXIgX3VzZVN0YXRlNSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKF9zaWduYWxzX2ZpbHRlcl9ncm91cC5GSUxURVJfT1BFTiksCiAgICAgIF91c2VTdGF0ZTYgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGU1LCAyKSwKICAgICAgZmlsdGVyR3JvdXAgPSBfdXNlU3RhdGU2WzBdLAogICAgICBzZXRGaWx0ZXJHcm91cCA9IF91c2VTdGF0ZTZbMV07CgogIHZhciBfdXNlRmV0Y2hJbmRleFBhdHRlcm4gPSAoMCwgX2ZldGNoX2luZGV4X3BhdHRlcm5zLnVzZUZldGNoSW5kZXhQYXR0ZXJucykoc2lnbmFsc0luZGV4ICE9PSAnJyA/IFtzaWduYWxzSW5kZXhdIDogW10pLAogICAgICBfdXNlRmV0Y2hJbmRleFBhdHRlcm4yID0gX3NsaWNlZFRvQXJyYXkoX3VzZUZldGNoSW5kZXhQYXR0ZXJuLCAxKSwKICAgICAgX3VzZUZldGNoSW5kZXhQYXR0ZXJuMyA9IF91c2VGZXRjaEluZGV4UGF0dGVybjJbMF0sCiAgICAgIGJyb3dzZXJGaWVsZHMgPSBfdXNlRmV0Y2hJbmRleFBhdHRlcm4zLmJyb3dzZXJGaWVsZHMsCiAgICAgIGluZGV4UGF0dGVybnMgPSBfdXNlRmV0Y2hJbmRleFBhdHRlcm4zLmluZGV4UGF0dGVybnM7CgogIHZhciBraWJhbmEgPSAoMCwgX2tpYmFuYS51c2VLaWJhbmEpKCk7CiAgdmFyIGdldEdsb2JhbFF1ZXJ5ID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKCkgewogICAgaWYgKGJyb3dzZXJGaWVsZHMgIT0gbnVsbCAmJiBpbmRleFBhdHRlcm5zICE9IG51bGwpIHsKICAgICAgcmV0dXJuICgwLCBfaGVscGVycy5jb21iaW5lUXVlcmllcykoewogICAgICAgIGNvbmZpZzogX3B1YmxpYy5lc1F1ZXJ5LmdldEVzUXVlcnlDb25maWcoa2liYW5hLnNlcnZpY2VzLnVpU2V0dGluZ3MpLAogICAgICAgIGRhdGFQcm92aWRlcnM6IFtdLAogICAgICAgIGluZGV4UGF0dGVybjogaW5kZXhQYXR0ZXJucywKICAgICAgICBicm93c2VyRmllbGRzOiBicm93c2VyRmllbGRzLAogICAgICAgIGZpbHRlcnM6ICgwLCBfZnAuaXNFbXB0eSkoZGVmYXVsdEZpbHRlcnMpID8gZ2xvYmFsRmlsdGVycyA6IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZGVmYXVsdEZpbHRlcnMgIT09IG51bGwgJiYgZGVmYXVsdEZpbHRlcnMgIT09IHZvaWQgMCA/IGRlZmF1bHRGaWx0ZXJzIDogW10pLCBfdG9Db25zdW1hYmxlQXJyYXkoZ2xvYmFsRmlsdGVycykpLAogICAgICAgIGtxbFF1ZXJ5OiBnbG9iYWxRdWVyeSwKICAgICAgICBrcWxNb2RlOiBnbG9iYWxRdWVyeS5sYW5ndWFnZSwKICAgICAgICBzdGFydDogZnJvbSwKICAgICAgICBlbmQ6IHRvLAogICAgICAgIGlzRXZlbnRWaWV3ZXI6IHRydWUKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfSwgW2Jyb3dzZXJGaWVsZHMsIGdsb2JhbEZpbHRlcnMsIGdsb2JhbFF1ZXJ5LCBpbmRleFBhdHRlcm5zLCBraWJhbmEsIHRvLCBmcm9tXSk7IC8vIENhbGxiYWNrIGZvciBjcmVhdGluZyBhIG5ldyB0aW1lbGluZSAtLSB1dGlsaXplZCBieSByb3cvYmF0Y2ggYWN0aW9ucwoKICB2YXIgY3JlYXRlVGltZWxpbmVDYWxsYmFjayA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChfcmVmMikgewogICAgdmFyIGZyb21UaW1lbGluZSA9IF9yZWYyLmZyb20sCiAgICAgICAgdGltZWxpbmUgPSBfcmVmMi50aW1lbGluZSwKICAgICAgICB0b1RpbWVsaW5lID0gX3JlZjIudG8sCiAgICAgICAgcnVsZU5vdGUgPSBfcmVmMi5ydWxlTm90ZTsKICAgIHVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nKHsKICAgICAgaWQ6ICd0aW1lbGluZS0xJywKICAgICAgaXNMb2FkaW5nOiBmYWxzZQogICAgfSk7CiAgICB1cGRhdGVUaW1lbGluZSh7CiAgICAgIGR1cGxpY2F0ZTogdHJ1ZSwKICAgICAgZnJvbTogZnJvbVRpbWVsaW5lLAogICAgICBpZDogJ3RpbWVsaW5lLTEnLAogICAgICBub3RlczogW10sCiAgICAgIHRpbWVsaW5lOiBfb2JqZWN0U3ByZWFkKHt9LCB0aW1lbGluZSwgewogICAgICAgIHNob3c6IHRydWUKICAgICAgfSksCiAgICAgIHRvOiB0b1RpbWVsaW5lLAogICAgICBydWxlTm90ZTogcnVsZU5vdGUKICAgIH0pKCk7CiAgfSwgW3VwZGF0ZVRpbWVsaW5lLCB1cGRhdGVUaW1lbGluZUlzTG9hZGluZ10pOwogIHZhciBzZXRFdmVudHNMb2FkaW5nQ2FsbGJhY2sgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoX3JlZjMpIHsKICAgIHZhciBldmVudElkcyA9IF9yZWYzLmV2ZW50SWRzLAogICAgICAgIGlzTG9hZGluZyA9IF9yZWYzLmlzTG9hZGluZzsKICAgIHNldEV2ZW50c0xvYWRpbmcoewogICAgICBpZDogU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lELAogICAgICBldmVudElkczogZXZlbnRJZHMsCiAgICAgIGlzTG9hZGluZzogaXNMb2FkaW5nCiAgICB9KTsKICB9LCBbc2V0RXZlbnRzTG9hZGluZywgU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lEXSk7CiAgdmFyIHNldEV2ZW50c0RlbGV0ZWRDYWxsYmFjayA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChfcmVmNCkgewogICAgdmFyIGV2ZW50SWRzID0gX3JlZjQuZXZlbnRJZHMsCiAgICAgICAgaXNEZWxldGVkID0gX3JlZjQuaXNEZWxldGVkOwogICAgc2V0RXZlbnRzRGVsZXRlZCh7CiAgICAgIGlkOiBTSUdOQUxTX1BBR0VfVElNRUxJTkVfSUQsCiAgICAgIGV2ZW50SWRzOiBldmVudElkcywKICAgICAgaXNEZWxldGVkOiBpc0RlbGV0ZWQKICAgIH0pOwogIH0sIFtzZXRFdmVudHNEZWxldGVkLCBTSUdOQUxTX1BBR0VfVElNRUxJTkVfSURdKTsgLy8gQ2F0Y2hlcyBzdGF0ZSBjaGFuZ2UgaXNTZWxlY3RBbGxDaGVja2VkLT5mYWxzZSB1cG9uIHVzZXIgc2VsZWN0aW9uIGNoYW5nZSB0byByZXNldCB1dGlsaXR5IGJhcgoKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgaWYgKCFpc1NlbGVjdEFsbENoZWNrZWQpIHsKICAgICAgc2V0U2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uKGZhbHNlKTsKICAgIH0gZWxzZSB7CiAgICAgIHNldFNlbGVjdEFsbChmYWxzZSk7CiAgICB9CiAgfSwgW2lzU2VsZWN0QWxsQ2hlY2tlZF0pOyAvLyBDYWxsYmFjayBmb3Igd2hlbiBvcGVuL2Nsb3NlZCBmaWx0ZXIgY2hhbmdlcwoKICB2YXIgb25GaWx0ZXJHcm91cENoYW5nZWRDYWxsYmFjayA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChuZXdGaWx0ZXJHcm91cCkgewogICAgY2xlYXJFdmVudHNMb2FkaW5nKHsKICAgICAgaWQ6IFNJR05BTFNfUEFHRV9USU1FTElORV9JRAogICAgfSk7CiAgICBjbGVhckV2ZW50c0RlbGV0ZWQoewogICAgICBpZDogU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lECiAgICB9KTsKICAgIGNsZWFyU2VsZWN0ZWQoewogICAgICBpZDogU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lECiAgICB9KTsKICAgIHNldEZpbHRlckdyb3VwKG5ld0ZpbHRlckdyb3VwKTsKICB9LCBbY2xlYXJFdmVudHNMb2FkaW5nLCBjbGVhckV2ZW50c0RlbGV0ZWQsIGNsZWFyU2VsZWN0ZWQsIHNldEZpbHRlckdyb3VwXSk7IC8vIENhbGxiYWNrIGZvciBjbGVhcmluZyBlbnRpcmUgc2VsZWN0aW9uIGZyb20gdXRpbGl0eSBiYXIKCiAgdmFyIGNsZWFyU2VsZWN0aW9uQ2FsbGJhY2sgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoKSB7CiAgICBjbGVhclNlbGVjdGVkKHsKICAgICAgaWQ6IFNJR05BTFNfUEFHRV9USU1FTElORV9JRAogICAgfSk7CiAgICBzZXRTZWxlY3RBbGwoZmFsc2UpOwogICAgc2V0U2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uKGZhbHNlKTsKICB9LCBbY2xlYXJTZWxlY3RlZCwgc2V0U2VsZWN0QWxsLCBzZXRTaG93Q2xlYXJTZWxlY3Rpb25BY3Rpb25dKTsgLy8gQ2FsbGJhY2sgZm9yIHNlbGVjdGluZyBhbGwgZXZlbnRzIG9uIGFsbCBwYWdlcyBmcm9tIHV0aWxpdHkgYmFyCiAgLy8gRGlzcGF0Y2hlcyB0byBzdGF0ZWZ1bF9ib2R5J3Mgc2VsZWN0QWxsIHZpYSBUaW1lbGluZVR5cGVDb250ZXh0IHByb3BzCiAgLy8gYXMgc2NvcGUgb2YgcmVzcG9uc2UgZGF0YSByZXF1aXJlZCB0byBhY3R1YWxseSBzZXQgc2VsZWN0ZWRFdmVudHMKCiAgdmFyIHNlbGVjdEFsbENhbGxiYWNrID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKCkgewogICAgc2V0U2VsZWN0QWxsKHRydWUpOwogICAgc2V0U2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uKHRydWUpOwogIH0sIFtzZXRTZWxlY3RBbGwsIHNldFNob3dDbGVhclNlbGVjdGlvbkFjdGlvbl0pOwogIHZhciB1cGRhdGVTaWduYWxzU3RhdHVzQ2FsbGJhY2sgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKSgKICAvKiNfX1BVUkVfXyovCiAgZnVuY3Rpb24gKCkgewogICAgdmFyIF9yZWY1ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAvKiNfX1BVUkVfXyovCiAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHJlZmV0Y2hRdWVyeSwgX3JlZjYpIHsKICAgICAgdmFyIF9nZXRHbG9iYWxRdWVyeTsKCiAgICAgIHZhciBzaWduYWxJZHMsIHN0YXR1czsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHNpZ25hbElkcyA9IF9yZWY2LnNpZ25hbElkcywgc3RhdHVzID0gX3JlZjYuc3RhdHVzOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiAoMCwgX2FjdGlvbnMudXBkYXRlU2lnbmFsU3RhdHVzQWN0aW9uKSh7CiAgICAgICAgICAgICAgICBxdWVyeTogc2hvd0NsZWFyU2VsZWN0aW9uQWN0aW9uID8gKF9nZXRHbG9iYWxRdWVyeSA9IGdldEdsb2JhbFF1ZXJ5KCkpID09PSBudWxsIHx8IF9nZXRHbG9iYWxRdWVyeSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2dldEdsb2JhbFF1ZXJ5LmZpbHRlclF1ZXJ5IDogdW5kZWZpbmVkLAogICAgICAgICAgICAgICAgc2lnbmFsSWRzOiBPYmplY3Qua2V5cyhzZWxlY3RlZEV2ZW50SWRzKSwKICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzLAogICAgICAgICAgICAgICAgc2V0RXZlbnRzRGVsZXRlZDogc2V0RXZlbnRzRGVsZXRlZENhbGxiYWNrLAogICAgICAgICAgICAgICAgc2V0RXZlbnRzTG9hZGluZzogc2V0RXZlbnRzTG9hZGluZ0NhbGxiYWNrCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgcmVmZXRjaFF1ZXJ5KCk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpOwoKICAgIHJldHVybiBmdW5jdGlvbiAoX3gsIF94MikgewogICAgICByZXR1cm4gX3JlZjUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfSgpLCBbZ2V0R2xvYmFsUXVlcnksIHNlbGVjdGVkRXZlbnRJZHMsIHNldEV2ZW50c0RlbGV0ZWRDYWxsYmFjaywgc2V0RXZlbnRzTG9hZGluZ0NhbGxiYWNrLCBzaG93Q2xlYXJTZWxlY3Rpb25BY3Rpb25dKTsgLy8gQ2FsbGJhY2sgZm9yIGNyZWF0aW5nIHRoZSBTaWduYWxVdGlsaXR5QmFyIHdoaWNoIHJlY2VpdmVzIHRvdGFsQ291bnQgZnJvbSBFdmVudHNWaWV3ZXIgY29tcG9uZW50CgogIHZhciB1dGlsaXR5QmFyQ2FsbGJhY2sgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAocmVmZXRjaFF1ZXJ5LCB0b3RhbENvdW50KSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2lnbmFsc191dGlsaXR5X2Jhci5TaWduYWxzVXRpbGl0eUJhciwgewogICAgICBjYW5Vc2VyQ1JVRDogY2FuVXNlckNSVUQsCiAgICAgIGFyZUV2ZW50c0xvYWRpbmc6IGxvYWRpbmdFdmVudElkcy5sZW5ndGggPiAwLAogICAgICBjbGVhclNlbGVjdGlvbjogY2xlYXJTZWxlY3Rpb25DYWxsYmFjaywKICAgICAgaGFzSW5kZXhXcml0ZTogaGFzSW5kZXhXcml0ZSwKICAgICAgaXNGaWx0ZXJlZFRvT3BlbjogZmlsdGVyR3JvdXAgPT09IF9zaWduYWxzX2ZpbHRlcl9ncm91cC5GSUxURVJfT1BFTiwKICAgICAgc2VsZWN0QWxsOiBzZWxlY3RBbGxDYWxsYmFjaywKICAgICAgc2VsZWN0ZWRFdmVudElkczogc2VsZWN0ZWRFdmVudElkcywKICAgICAgc2hvd0NsZWFyU2VsZWN0aW9uOiBzaG93Q2xlYXJTZWxlY3Rpb25BY3Rpb24sCiAgICAgIHRvdGFsQ291bnQ6IHRvdGFsQ291bnQsCiAgICAgIHVwZGF0ZVNpZ25hbHNTdGF0dXM6IHVwZGF0ZVNpZ25hbHNTdGF0dXNDYWxsYmFjay5iaW5kKG51bGwsIHJlZmV0Y2hRdWVyeSkKICAgIH0pOwogIH0sIFtjYW5Vc2VyQ1JVRCwgaGFzSW5kZXhXcml0ZSwgY2xlYXJTZWxlY3Rpb25DYWxsYmFjaywgZmlsdGVyR3JvdXAsIGxvYWRpbmdFdmVudElkcy5sZW5ndGgsIHNlbGVjdEFsbENhbGxiYWNrLCBzZWxlY3RlZEV2ZW50SWRzLCBzaG93Q2xlYXJTZWxlY3Rpb25BY3Rpb24sIHVwZGF0ZVNpZ25hbHNTdGF0dXNDYWxsYmFja10pOyAvLyBTZW5kIHRvIFRpbWVsaW5lIC8gVXBkYXRlIFNpZ25hbCBTdGF0dXMgQWN0aW9ucyBmb3IgZWFjaCB0YWJsZSByb3cKCiAgdmFyIGFkZGl0aW9uYWxBY3Rpb25zID0gKDAsIF9yZWFjdC51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gKDAsIF9kZWZhdWx0X2NvbmZpZy5nZXRTaWduYWxzQWN0aW9ucykoewogICAgICBhcG9sbG9DbGllbnQ6IGFwb2xsb0NsaWVudCwKICAgICAgY2FuVXNlckNSVUQ6IGNhblVzZXJDUlVELAogICAgICBoYXNJbmRleFdyaXRlOiBoYXNJbmRleFdyaXRlLAogICAgICBjcmVhdGVUaW1lbGluZTogY3JlYXRlVGltZWxpbmVDYWxsYmFjaywKICAgICAgc2V0RXZlbnRzTG9hZGluZzogc2V0RXZlbnRzTG9hZGluZ0NhbGxiYWNrLAogICAgICBzZXRFdmVudHNEZWxldGVkOiBzZXRFdmVudHNEZWxldGVkQ2FsbGJhY2ssCiAgICAgIHN0YXR1czogZmlsdGVyR3JvdXAgPT09IF9zaWduYWxzX2ZpbHRlcl9ncm91cC5GSUxURVJfT1BFTiA/IF9zaWduYWxzX2ZpbHRlcl9ncm91cC5GSUxURVJfQ0xPU0VEIDogX3NpZ25hbHNfZmlsdGVyX2dyb3VwLkZJTFRFUl9PUEVOLAogICAgICB1cGRhdGVUaW1lbGluZUlzTG9hZGluZzogdXBkYXRlVGltZWxpbmVJc0xvYWRpbmcKICAgIH0pOwogIH0sIFthcG9sbG9DbGllbnQsIGNhblVzZXJDUlVELCBjcmVhdGVUaW1lbGluZUNhbGxiYWNrLCBoYXNJbmRleFdyaXRlLCBmaWx0ZXJHcm91cCwgc2V0RXZlbnRzTG9hZGluZ0NhbGxiYWNrLCBzZXRFdmVudHNEZWxldGVkQ2FsbGJhY2ssIHVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nXSk7CiAgdmFyIGRlZmF1bHRJbmRpY2VzID0gKDAsIF9yZWFjdC51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gW3NpZ25hbHNJbmRleF07CiAgfSwgW3NpZ25hbHNJbmRleF0pOwogIHZhciBkZWZhdWx0RmlsdGVyc01lbW8gPSAoMCwgX3JlYWN0LnVzZU1lbW8pKGZ1bmN0aW9uICgpIHsKICAgIGlmICgoMCwgX2ZwLmlzRW1wdHkpKGRlZmF1bHRGaWx0ZXJzKSkgewogICAgICByZXR1cm4gZmlsdGVyR3JvdXAgPT09IF9zaWduYWxzX2ZpbHRlcl9ncm91cC5GSUxURVJfT1BFTiA/IF9kZWZhdWx0X2NvbmZpZy5zaWduYWxzT3BlbkZpbHRlcnMgOiBfZGVmYXVsdF9jb25maWcuc2lnbmFsc0Nsb3NlZEZpbHRlcnM7CiAgICB9IGVsc2UgaWYgKGRlZmF1bHRGaWx0ZXJzICE9IG51bGwgJiYgISgwLCBfZnAuaXNFbXB0eSkoZGVmYXVsdEZpbHRlcnMpKSB7CiAgICAgIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGRlZmF1bHRGaWx0ZXJzKSwgX3RvQ29uc3VtYWJsZUFycmF5KGZpbHRlckdyb3VwID09PSBfc2lnbmFsc19maWx0ZXJfZ3JvdXAuRklMVEVSX09QRU4gPyBfZGVmYXVsdF9jb25maWcuc2lnbmFsc09wZW5GaWx0ZXJzIDogX2RlZmF1bHRfY29uZmlnLnNpZ25hbHNDbG9zZWRGaWx0ZXJzKSk7CiAgICB9CiAgfSwgW2RlZmF1bHRGaWx0ZXJzLCBmaWx0ZXJHcm91cF0pOwogIHZhciB0aW1lbGluZVR5cGVDb250ZXh0ID0gKDAsIF9yZWFjdC51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICBkb2N1bWVudFR5cGU6IGkxOG4uU0lHTkFMU19ET0NVTUVOVF9UWVBFLAogICAgICBmb290ZXJUZXh0OiBpMThuLlRPVEFMX0NPVU5UX09GX1NJR05BTFMsCiAgICAgIGxvYWRpbmdUZXh0OiBpMThuLkxPQURJTkdfU0lHTkFMUywKICAgICAgcXVlcnlGaWVsZHM6IF9kZWZhdWx0X2NvbmZpZy5yZXF1aXJlZEZpZWxkc0ZvckFjdGlvbnMsCiAgICAgIHRpbWVsaW5lQWN0aW9uczogYWRkaXRpb25hbEFjdGlvbnMsCiAgICAgIHRpdGxlOiBpMThuLlNJR05BTFNfVEFCTEVfVElUTEUsCiAgICAgIHNlbGVjdEFsbDogY2FuVXNlckNSVUQgPyBzZWxlY3RBbGwgOiBmYWxzZQogICAgfTsKICB9LCBbYWRkaXRpb25hbEFjdGlvbnMsIGNhblVzZXJDUlVELCBzZWxlY3RBbGxdKTsKICB2YXIgaGVhZGVyRmlsdGVyR3JvdXAgPSAoMCwgX3JlYWN0LnVzZU1lbW8pKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zaWduYWxzX2ZpbHRlcl9ncm91cC5TaWduYWxzVGFibGVGaWx0ZXJHcm91cCwgewogICAgICBvbkZpbHRlckdyb3VwQ2hhbmdlZDogb25GaWx0ZXJHcm91cENoYW5nZWRDYWxsYmFjawogICAgfSk7CiAgfSwgW29uRmlsdGVyR3JvdXBDaGFuZ2VkQ2FsbGJhY2tdKTsKCiAgaWYgKGxvYWRpbmcgfHwgKDAsIF9mcC5pc0VtcHR5KShzaWduYWxzSW5kZXgpKSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVBhbmVsLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9oZWFkZXJfc2VjdGlvbi5IZWFkZXJTZWN0aW9uLCB7CiAgICAgIHRpdGxlOiBpMThuLlNJR05BTFNfVEFCTEVfVElUTEUKICAgIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTG9hZGluZ0NvbnRlbnQsIHsKICAgICAgImRhdGEtdGVzdC1zdWJqIjogImxvYWRpbmctc2lnbmFscy1wYW5lbCIKICAgIH0pKTsKICB9CgogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldmVudHNfdmlld2VyLlN0YXRlZnVsRXZlbnRzVmlld2VyLCB7CiAgICBkZWZhdWx0SW5kaWNlczogZGVmYXVsdEluZGljZXMsCiAgICBwYWdlRmlsdGVyczogZGVmYXVsdEZpbHRlcnNNZW1vLAogICAgZGVmYXVsdE1vZGVsOiBfZGVmYXVsdF9jb25maWcuc2lnbmFsc0RlZmF1bHRNb2RlbCwKICAgIGVuZDogdG8sCiAgICBoZWFkZXJGaWx0ZXJHcm91cDogaGVhZGVyRmlsdGVyR3JvdXAsCiAgICBpZDogU0lHTkFMU19QQUdFX1RJTUVMSU5FX0lELAogICAgc3RhcnQ6IGZyb20sCiAgICB0aW1lbGluZVR5cGVDb250ZXh0OiB0aW1lbGluZVR5cGVDb250ZXh0LAogICAgdXRpbGl0eUJhcjogdXRpbGl0eUJhckNhbGxiYWNrCiAgfSk7Cn07Cgp2YXIgbWFrZU1hcFN0YXRlVG9Qcm9wcyA9IGZ1bmN0aW9uIG1ha2VNYXBTdGF0ZVRvUHJvcHMoKSB7CiAgdmFyIGdldFRpbWVsaW5lID0gX3RpbWVsaW5lLnRpbWVsaW5lU2VsZWN0b3JzLmdldFRpbWVsaW5lQnlJZFNlbGVjdG9yKCk7CgogIHZhciBnZXRHbG9iYWxJbnB1dHMgPSBfc3RvcmUuaW5wdXRzU2VsZWN0b3JzLmdsb2JhbFNlbGVjdG9yKCk7CgogIHZhciBtYXBTdGF0ZVRvUHJvcHMgPSBmdW5jdGlvbiBtYXBTdGF0ZVRvUHJvcHMoc3RhdGUpIHsKICAgIHZhciBfZ2V0VGltZWxpbmU7CgogICAgdmFyIHRpbWVsaW5lID0gKF9nZXRUaW1lbGluZSA9IGdldFRpbWVsaW5lKHN0YXRlLCBTSUdOQUxTX1BBR0VfVElNRUxJTkVfSUQpKSAhPT0gbnVsbCAmJiBfZ2V0VGltZWxpbmUgIT09IHZvaWQgMCA/IF9nZXRUaW1lbGluZSA6IF9kZWZhdWx0cy50aW1lbGluZURlZmF1bHRzOwogICAgdmFyIGRlbGV0ZWRFdmVudElkcyA9IHRpbWVsaW5lLmRlbGV0ZWRFdmVudElkcywKICAgICAgICBpc1NlbGVjdEFsbENoZWNrZWQgPSB0aW1lbGluZS5pc1NlbGVjdEFsbENoZWNrZWQsCiAgICAgICAgbG9hZGluZ0V2ZW50SWRzID0gdGltZWxpbmUubG9hZGluZ0V2ZW50SWRzLAogICAgICAgIHNlbGVjdGVkRXZlbnRJZHMgPSB0aW1lbGluZS5zZWxlY3RlZEV2ZW50SWRzOwogICAgdmFyIGdsb2JhbElucHV0cyA9IGdldEdsb2JhbElucHV0cyhzdGF0ZSk7CiAgICB2YXIgcXVlcnkgPSBnbG9iYWxJbnB1dHMucXVlcnksCiAgICAgICAgZmlsdGVycyA9IGdsb2JhbElucHV0cy5maWx0ZXJzOwogICAgcmV0dXJuIHsKICAgICAgZ2xvYmFsUXVlcnk6IHF1ZXJ5LAogICAgICBnbG9iYWxGaWx0ZXJzOiBmaWx0ZXJzLAogICAgICBkZWxldGVkRXZlbnRJZHM6IGRlbGV0ZWRFdmVudElkcywKICAgICAgaXNTZWxlY3RBbGxDaGVja2VkOiBpc1NlbGVjdEFsbENoZWNrZWQsCiAgICAgIGxvYWRpbmdFdmVudElkczogbG9hZGluZ0V2ZW50SWRzLAogICAgICBzZWxlY3RlZEV2ZW50SWRzOiBzZWxlY3RlZEV2ZW50SWRzCiAgICB9OwogIH07CgogIHJldHVybiBtYXBTdGF0ZVRvUHJvcHM7Cn07Cgp2YXIgbWFwRGlzcGF0Y2hUb1Byb3BzID0gZnVuY3Rpb24gbWFwRGlzcGF0Y2hUb1Byb3BzKGRpc3BhdGNoKSB7CiAgcmV0dXJuIHsKICAgIGNsZWFyU2VsZWN0ZWQ6IGZ1bmN0aW9uIGNsZWFyU2VsZWN0ZWQoX3JlZjcpIHsKICAgICAgdmFyIGlkID0gX3JlZjcuaWQ7CiAgICAgIHJldHVybiBkaXNwYXRjaChfdGltZWxpbmUudGltZWxpbmVBY3Rpb25zLmNsZWFyU2VsZWN0ZWQoewogICAgICAgIGlkOiBpZAogICAgICB9KSk7CiAgICB9LAogICAgc2V0RXZlbnRzTG9hZGluZzogZnVuY3Rpb24gc2V0RXZlbnRzTG9hZGluZyhfcmVmOCkgewogICAgICB2YXIgaWQgPSBfcmVmOC5pZCwKICAgICAgICAgIGV2ZW50SWRzID0gX3JlZjguZXZlbnRJZHMsCiAgICAgICAgICBpc0xvYWRpbmcgPSBfcmVmOC5pc0xvYWRpbmc7CiAgICAgIHJldHVybiBkaXNwYXRjaChfdGltZWxpbmUudGltZWxpbmVBY3Rpb25zLnNldEV2ZW50c0xvYWRpbmcoewogICAgICAgIGlkOiBpZCwKICAgICAgICBldmVudElkczogZXZlbnRJZHMsCiAgICAgICAgaXNMb2FkaW5nOiBpc0xvYWRpbmcKICAgICAgfSkpOwogICAgfSwKICAgIGNsZWFyRXZlbnRzTG9hZGluZzogZnVuY3Rpb24gY2xlYXJFdmVudHNMb2FkaW5nKF9yZWY5KSB7CiAgICAgIHZhciBpZCA9IF9yZWY5LmlkOwogICAgICByZXR1cm4gZGlzcGF0Y2goX3RpbWVsaW5lLnRpbWVsaW5lQWN0aW9ucy5jbGVhckV2ZW50c0xvYWRpbmcoewogICAgICAgIGlkOiBpZAogICAgICB9KSk7CiAgICB9LAogICAgc2V0RXZlbnRzRGVsZXRlZDogZnVuY3Rpb24gc2V0RXZlbnRzRGVsZXRlZChfcmVmMTApIHsKICAgICAgdmFyIGlkID0gX3JlZjEwLmlkLAogICAgICAgICAgZXZlbnRJZHMgPSBfcmVmMTAuZXZlbnRJZHMsCiAgICAgICAgICBpc0RlbGV0ZWQgPSBfcmVmMTAuaXNEZWxldGVkOwogICAgICByZXR1cm4gZGlzcGF0Y2goX3RpbWVsaW5lLnRpbWVsaW5lQWN0aW9ucy5zZXRFdmVudHNEZWxldGVkKHsKICAgICAgICBpZDogaWQsCiAgICAgICAgZXZlbnRJZHM6IGV2ZW50SWRzLAogICAgICAgIGlzRGVsZXRlZDogaXNEZWxldGVkCiAgICAgIH0pKTsKICAgIH0sCiAgICBjbGVhckV2ZW50c0RlbGV0ZWQ6IGZ1bmN0aW9uIGNsZWFyRXZlbnRzRGVsZXRlZChfcmVmMTEpIHsKICAgICAgdmFyIGlkID0gX3JlZjExLmlkOwogICAgICByZXR1cm4gZGlzcGF0Y2goX3RpbWVsaW5lLnRpbWVsaW5lQWN0aW9ucy5jbGVhckV2ZW50c0RlbGV0ZWQoewogICAgICAgIGlkOiBpZAogICAgICB9KSk7CiAgICB9LAogICAgdXBkYXRlVGltZWxpbmVJc0xvYWRpbmc6IGZ1bmN0aW9uIHVwZGF0ZVRpbWVsaW5lSXNMb2FkaW5nKF9yZWYxMikgewogICAgICB2YXIgaWQgPSBfcmVmMTIuaWQsCiAgICAgICAgICBpc0xvYWRpbmcgPSBfcmVmMTIuaXNMb2FkaW5nOwogICAgICByZXR1cm4gZGlzcGF0Y2goX3RpbWVsaW5lLnRpbWVsaW5lQWN0aW9ucy51cGRhdGVJc0xvYWRpbmcoewogICAgICAgIGlkOiBpZCwKICAgICAgICBpc0xvYWRpbmc6IGlzTG9hZGluZwogICAgICB9KSk7CiAgICB9LAogICAgdXBkYXRlVGltZWxpbmU6ICgwLCBfaGVscGVyczIuZGlzcGF0Y2hVcGRhdGVUaW1lbGluZSkoZGlzcGF0Y2gpCiAgfTsKfTsKCnZhciBjb25uZWN0b3IgPSAoMCwgX3JlYWN0UmVkdXguY29ubmVjdCkobWFrZU1hcFN0YXRlVG9Qcm9wcywgbWFwRGlzcGF0Y2hUb1Byb3BzKTsKdmFyIFNpZ25hbHNUYWJsZSA9IGNvbm5lY3RvcihfcmVhY3QuZGVmYXVsdC5tZW1vKFNpZ25hbHNUYWJsZUNvbXBvbmVudCkpOwpleHBvcnRzLlNpZ25hbHNUYWJsZSA9IFNpZ25hbHNUYWJsZTs="},null]}