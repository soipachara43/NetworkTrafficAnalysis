{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/plugins/data/public/search/aggs/buckets/_terms_other_bucket_helper.js","dependencies":[{"path":"src/plugins/data/public/search/aggs/buckets/_terms_other_bucket_helper.js","mtime":1589249550635},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLnVwZGF0ZU1pc3NpbmdCdWNrZXQgPSBleHBvcnRzLm1lcmdlT3RoZXJCdWNrZXRBZ2dSZXNwb25zZSA9IGV4cG9ydHMuYnVpbGRPdGhlckJ1Y2tldEFnZyA9IHZvaWQgMDsKCnZhciBfbG9kYXNoID0gcmVxdWlyZSgibG9kYXNoIik7Cgp2YXIgX2NvbW1vbiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbW1vbiIpOwoKdmFyIF9hZ2dfZ3JvdXBzID0gcmVxdWlyZSgiLi4vYWdnX2dyb3VwcyIpOwoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFycjJbaV0gPSBhcnJbaV07CiAgICB9CgogICAgcmV0dXJuIGFycjI7CiAgfQp9Ci8qKgogKiB3YWxrcyB0aGUgYWdncmVnYXRpb24gRFNMIGFuZCByZXR1cm5zIERTTCBzdGFydGluZyBhdCBhZ2dyZWdhdGlvbiB3aXRoIGlkIG9mIHN0YXJ0RnJvbUFnZ0lkCiAqIEBwYXJhbSBhZ2dOZXN0ZWREc2w6IGFnZ3JlZ2F0aW9uIGNvbmZpZyBEU0wgKHRvcCBsZXZlbCkKICogQHBhcmFtIHN0YXJ0RnJvbUlkOiBpZCBvZiBhbiBhZ2dyZWdhdGlvbiBmcm9tIHdoZXJlIHdlIHdhbnQgdG8gZ2V0IHRoZSBuZXN0ZWQgRFNMCiAqLwoKCnZhciBnZXROZXN0ZWRBZ2dEU0wgPSBmdW5jdGlvbiBnZXROZXN0ZWRBZ2dEU0woYWdnTmVzdGVkRHNsLCBzdGFydEZyb21BZ2dJZCkgewogIGlmIChhZ2dOZXN0ZWREc2xbc3RhcnRGcm9tQWdnSWRdKSB7CiAgICByZXR1cm4gYWdnTmVzdGVkRHNsW3N0YXJ0RnJvbUFnZ0lkXTsKICB9CgogIHZhciBuZXN0ZWRBZ2dzID0gKDAsIF9sb2Rhc2gudmFsdWVzKShhZ2dOZXN0ZWREc2wpOwogIHZhciBhZ2dzOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IG5lc3RlZEFnZ3MubGVuZ3RoOyBpKyspIHsKICAgIGlmIChuZXN0ZWRBZ2dzW2ldLmFnZ3MgJiYgKGFnZ3MgPSBnZXROZXN0ZWRBZ2dEU0wobmVzdGVkQWdnc1tpXS5hZ2dzLCBzdGFydEZyb21BZ2dJZCkpKSB7CiAgICAgIHJldHVybiBhZ2dzOwogICAgfQogIH0KfTsKLyoqCiAqIHJldHVybnMgYnVja2V0cyBmcm9tIHJlc3BvbnNlIGZvciBhIHNwZWNpZmljIG90aGVyIGJ1Y2tldAogKiBAcGFyYW0gYWdnQ29uZmlnczogY29uZmlndXJhdGlvbiBmb3IgdGhlIGFnZ3JlZ2F0aW9ucwogKiBAcGFyYW0gcmVzcG9uc2U6IHJlc3BvbnNlIGZyb20gZWxhc3RpY3NlYXJjaAogKiBAcGFyYW0gYWdnV2l0aE90aGVyQnVja2V0OiBBZ2dDb25maWcgb2YgdGhlIGFnZ3JlZ2F0aW9uIHdpdGggb3RoZXIgYnVja2V0IGVuYWJsZWQKICogQHBhcmFtIGtleToga2V5IGZyb20gdGhlIG90aGVyIGJ1Y2tldCByZXF1ZXN0IGZvciBhIHNwZWNpZmljIG90aGVyIGJ1Y2tldAogKi8KCgp2YXIgZ2V0QWdnUmVzdWx0QnVja2V0cyA9IGZ1bmN0aW9uIGdldEFnZ1Jlc3VsdEJ1Y2tldHMoYWdnQ29uZmlncywgcmVzcG9uc2UsIGFnZ1dpdGhPdGhlckJ1Y2tldCwga2V5KSB7CiAgdmFyIGtleVBhcnRzID0ga2V5LnNwbGl0KCctJyk7CiAgdmFyIHJlc3BvbnNlQWdnID0gcmVzcG9uc2U7CgogIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGkpIHsKICAgIGlmIChrZXlQYXJ0c1tpXSkgewogICAgICB2YXIgcmVzcG9uc2VBZ2dzID0gKDAsIF9sb2Rhc2gudmFsdWVzKShyZXNwb25zZUFnZyk7IC8vIElmIHlvdSBoYXZlIG11bHRpIGFnZ3MsIHdlIGNhbm5vdCBqdXN0IGFzc3VtZSB0aGUgZmlyc3Qgb25lIGlzIHRoZSBgb3RoZXJgIGJ1Y2tldCwKICAgICAgLy8gc28gd2UgbmVlZCB0byBsb29wIG92ZXIgZWFjaCBhZ2cgdW50aWwgd2UgZmluZCBpdC4KCiAgICAgIHZhciBfbG9vcDIgPSBmdW5jdGlvbiBfbG9vcDIoYWdnSWQpIHsKICAgICAgICB2YXIgYWdnQnlJZCA9IHJlc3BvbnNlQWdnc1thZ2dJZF07CiAgICAgICAgdmFyIGFnZ0tleSA9ICgwLCBfbG9kYXNoLmtleXMpKHJlc3BvbnNlQWdnKVthZ2dJZF07CiAgICAgICAgdmFyIGFnZ0NvbmZpZyA9ICgwLCBfbG9kYXNoLmZpbmQpKGFnZ0NvbmZpZ3MuYWdncywgZnVuY3Rpb24gKGFnZykgewogICAgICAgICAgcmV0dXJuIGFnZy5pZCA9PT0gYWdnS2V5OwogICAgICAgIH0pOwoKICAgICAgICBpZiAoYWdnQ29uZmlnKSB7CiAgICAgICAgICB2YXIgYWdnUmVzdWx0QnVja2V0ID0gKDAsIF9sb2Rhc2guZmluZCkoYWdnQnlJZC5idWNrZXRzLCBmdW5jdGlvbiAoYnVja2V0LCBidWNrZXRPYmpLZXkpIHsKICAgICAgICAgICAgdmFyIGJ1Y2tldEtleSA9IGFnZ0NvbmZpZy5nZXRLZXkoYnVja2V0LCAoMCwgX2xvZGFzaC5pc051bWJlcikoYnVja2V0T2JqS2V5KSA/IHVuZGVmaW5lZCA6IGJ1Y2tldE9iaktleSkudG9TdHJpbmcoKTsKICAgICAgICAgICAgcmV0dXJuIGJ1Y2tldEtleSA9PT0ga2V5UGFydHNbaV07CiAgICAgICAgICB9KTsKCiAgICAgICAgICBpZiAoYWdnUmVzdWx0QnVja2V0KSB7CiAgICAgICAgICAgIHJlc3BvbnNlQWdnID0gYWdnUmVzdWx0QnVja2V0OwogICAgICAgICAgICByZXR1cm4gImJyZWFrIjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CgogICAgICBmb3IgKHZhciBhZ2dJZCA9IDA7IGFnZ0lkIDwgcmVzcG9uc2VBZ2dzLmxlbmd0aDsgYWdnSWQrKykgewogICAgICAgIHZhciBfcmV0ID0gX2xvb3AyKGFnZ0lkKTsKCiAgICAgICAgaWYgKF9yZXQgPT09ICJicmVhayIpIGJyZWFrOwogICAgICB9CiAgICB9CiAgfTsKCiAgZm9yICh2YXIgaSBpbiBrZXlQYXJ0cykgewogICAgX2xvb3AoaSk7CiAgfQoKICBpZiAocmVzcG9uc2VBZ2dbYWdnV2l0aE90aGVyQnVja2V0LmlkXSkgewogICAgcmV0dXJuIHJlc3BvbnNlQWdnW2FnZ1dpdGhPdGhlckJ1Y2tldC5pZF0uYnVja2V0czsKICB9CgogIHJldHVybiBbXTsKfTsKLyoqCiAqIGdldHMgYWxsIHRoZSBtaXNzaW5nIGJ1Y2tldHMgaW4gb3VyIHJlc3BvbnNlIGZvciBhIHNwZWNpZmljIGFnZ3JlZ2F0aW9uIGlkCiAqIEBwYXJhbSByZXNwb25zZUFnZ3M6IGFycmF5IG9mIGFnZ3JlZ2F0aW9ucyBmcm9tIHJlc3BvbnNlCiAqIEBwYXJhbSBhZ2dJZDogaWQgb2YgdGhlIGFnZ3JlZ2F0aW9uIHdpdGggbWlzc2luZyBidWNrZXQKICovCgoKdmFyIGdldEFnZ0NvbmZpZ1Jlc3VsdE1pc3NpbmdCdWNrZXRzID0gZnVuY3Rpb24gZ2V0QWdnQ29uZmlnUmVzdWx0TWlzc2luZ0J1Y2tldHMocmVzcG9uc2VBZ2dzLCBhZ2dJZCkgewogIHZhciBtaXNzaW5nS2V5ID0gJ19fbWlzc2luZ19fJzsKICB2YXIgcmVzdWx0QnVja2V0cyA9IFtdOwoKICBpZiAocmVzcG9uc2VBZ2dzW2FnZ0lkXSkgewogICAgdmFyIG1hdGNoaW5nQnVja2V0ID0gcmVzcG9uc2VBZ2dzW2FnZ0lkXS5idWNrZXRzLmZpbmQoZnVuY3Rpb24gKGJ1Y2tldCkgewogICAgICByZXR1cm4gYnVja2V0LmtleSA9PT0gbWlzc2luZ0tleTsKICAgIH0pOwogICAgaWYgKG1hdGNoaW5nQnVja2V0KSByZXN1bHRCdWNrZXRzLnB1c2gobWF0Y2hpbmdCdWNrZXQpOwogICAgcmV0dXJuIHJlc3VsdEJ1Y2tldHM7CiAgfQoKICAoMCwgX2xvZGFzaC5lYWNoKShyZXNwb25zZUFnZ3MsIGZ1bmN0aW9uIChhZ2cpIHsKICAgIGlmIChhZ2cuYnVja2V0cykgewogICAgICAoMCwgX2xvZGFzaC5lYWNoKShhZ2cuYnVja2V0cywgZnVuY3Rpb24gKGJ1Y2tldCkgewogICAgICAgIHJlc3VsdEJ1Y2tldHMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHJlc3VsdEJ1Y2tldHMpLCBfdG9Db25zdW1hYmxlQXJyYXkoZ2V0QWdnQ29uZmlnUmVzdWx0TWlzc2luZ0J1Y2tldHMoYnVja2V0LCBhZ2dJZCkpKTsKICAgICAgfSk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIHJlc3VsdEJ1Y2tldHM7Cn07Ci8qKgogKiBnZXRzIGFsbCB0aGUgdGVybXMgdGhhdCBhcmUgTk9UIGluIHRoZSBvdGhlciBidWNrZXQKICogQHBhcmFtIHJlcXVlc3RBZ2c6IGFuIGFnZ3JlZ2F0aW9uIHdlIGFyZSBsb29raW5nIGF0CiAqIEBwYXJhbSBrZXk6IHRoZSBrZXkgZm9yIHRoaXMgc3BlY2lmaWMgb3RoZXIgYnVja2V0CiAqIEBwYXJhbSBvdGhlckFnZzogQWdnQ29uZmlnIG9mIHRoZSBhZ2dyZWdhdGlvbiB3aXRoIG90aGVyIGJ1Y2tldAogKi8KCgp2YXIgZ2V0T3RoZXJBZ2dUZXJtcyA9IGZ1bmN0aW9uIGdldE90aGVyQWdnVGVybXMocmVxdWVzdEFnZywga2V5LCBvdGhlckFnZykgewogIHJldHVybiByZXF1ZXN0QWdnWydvdGhlci1maWx0ZXInXS5maWx0ZXJzLmZpbHRlcnNba2V5XS5ib29sLm11c3Rfbm90LmZpbHRlcihmdW5jdGlvbiAoZmlsdGVyKSB7CiAgICByZXR1cm4gZmlsdGVyLm1hdGNoX3BocmFzZSAmJiBmaWx0ZXIubWF0Y2hfcGhyYXNlW290aGVyQWdnLnBhcmFtcy5maWVsZC5uYW1lXTsKICB9KS5tYXAoZnVuY3Rpb24gKGZpbHRlcikgewogICAgcmV0dXJuIGZpbHRlci5tYXRjaF9waHJhc2Vbb3RoZXJBZ2cucGFyYW1zLmZpZWxkLm5hbWVdOwogIH0pOwp9OwoKdmFyIGJ1aWxkT3RoZXJCdWNrZXRBZ2cgPSBmdW5jdGlvbiBidWlsZE90aGVyQnVja2V0QWdnKGFnZ0NvbmZpZ3MsIGFnZ1dpdGhPdGhlckJ1Y2tldCwgcmVzcG9uc2UpIHsKICB2YXIgYnVja2V0QWdncyA9IGFnZ0NvbmZpZ3MuYWdncy5maWx0ZXIoZnVuY3Rpb24gKGFnZykgewogICAgcmV0dXJuIGFnZy50eXBlLnR5cGUgPT09IF9hZ2dfZ3JvdXBzLkFnZ0dyb3VwTmFtZXMuQnVja2V0czsKICB9KTsKICB2YXIgaW5kZXggPSBidWNrZXRBZ2dzLmZpbmRJbmRleChmdW5jdGlvbiAoYWdnKSB7CiAgICByZXR1cm4gYWdnLmlkID09PSBhZ2dXaXRoT3RoZXJCdWNrZXQuaWQ7CiAgfSk7CiAgdmFyIGFnZ3MgPSBhZ2dDb25maWdzLnRvRHNsKCk7CiAgdmFyIGluZGV4UGF0dGVybiA9IGFnZ1dpdGhPdGhlckJ1Y2tldC5wYXJhbXMuZmllbGQuaW5kZXhQYXR0ZXJuOyAvLyBjcmVhdGUgZmlsdGVycyBhZ2dyZWdhdGlvbgoKICB2YXIgZmlsdGVyQWdnID0gYWdnQ29uZmlncy5jcmVhdGVBZ2dDb25maWcoewogICAgdHlwZTogJ2ZpbHRlcnMnLAogICAgaWQ6ICdvdGhlcicsCiAgICBwYXJhbXM6IHsKICAgICAgZmlsdGVyczogW10KICAgIH0sCiAgICBlbmFibGVkOiBmYWxzZQogIH0sIHsKICAgIGFkZFRvQWdnQ29uZmlnczogZmFsc2UKICB9KTsgLy8gbmVzdCBhbGwgdGhlIGNoaWxkIGFnZ3JlZ2F0aW9ucyBvZiBhZ2dXaXRoT3RoZXJCdWNrZXQKCiAgdmFyIHJlc3VsdEFnZyA9IHsKICAgIGFnZ3M6IGdldE5lc3RlZEFnZ0RTTChhZ2dzLCBhZ2dXaXRoT3RoZXJCdWNrZXQuaWQpLmFnZ3MsCiAgICBmaWx0ZXJzOiBmaWx0ZXJBZ2cudG9Ec2woKQogIH07CiAgdmFyIG5vQWdnQnVja2V0UmVzdWx0cyA9IGZhbHNlOyAvLyByZWN1cnNpdmVseSBjcmVhdGUgZmlsdGVycyBmb3IgYWxsIHBhcmVudCBhZ2dyZWdhdGlvbiBidWNrZXRzCgogIHZhciB3YWxrQnVja2V0VHJlZSA9IGZ1bmN0aW9uIHdhbGtCdWNrZXRUcmVlKGFnZ0luZGV4LCBhZ2dyZWdhdGlvbnMsIGFnZ0lkLCBmaWx0ZXJzLCBrZXkpIHsKICAgIC8vIG1ha2Ugc3VyZSB0aGVyZSBhcmUgYWN0dWFsbHkgcmVzdWx0cyBmb3IgdGhlIGJ1Y2tldHMKICAgIGlmIChhZ2dyZWdhdGlvbnNbYWdnSWRdLmJ1Y2tldHMubGVuZ3RoIDwgMSkgewogICAgICBub0FnZ0J1Y2tldFJlc3VsdHMgPSB0cnVlOwogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGFnZyA9IGFnZ3JlZ2F0aW9uc1thZ2dJZF07CiAgICB2YXIgbmV3QWdnSW5kZXggPSBhZ2dJbmRleCArIDE7CiAgICB2YXIgbmV3QWdnID0gYnVja2V0QWdnc1tuZXdBZ2dJbmRleF07CiAgICB2YXIgY3VycmVudEFnZyA9IGJ1Y2tldEFnZ3NbYWdnSW5kZXhdOwoKICAgIGlmIChhZ2dJbmRleCA8IGluZGV4KSB7CiAgICAgICgwLCBfbG9kYXNoLmVhY2gpKGFnZy5idWNrZXRzLCBmdW5jdGlvbiAoYnVja2V0LCBidWNrZXRPYmpLZXkpIHsKICAgICAgICB2YXIgYnVja2V0S2V5ID0gY3VycmVudEFnZy5nZXRLZXkoYnVja2V0LCAoMCwgX2xvZGFzaC5pc051bWJlcikoYnVja2V0T2JqS2V5KSA/IHVuZGVmaW5lZCA6IGJ1Y2tldE9iaktleSk7CiAgICAgICAgdmFyIGZpbHRlciA9ICgwLCBfbG9kYXNoLmNsb25lRGVlcCkoYnVja2V0LmZpbHRlcnMpIHx8IGN1cnJlbnRBZ2cuY3JlYXRlRmlsdGVyKGJ1Y2tldEtleSk7CiAgICAgICAgdmFyIG5ld0ZpbHRlcnMgPSAoMCwgX2xvZGFzaC5mbGF0dGVuKShbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGZpbHRlcnMpLCBbZmlsdGVyXSkpOwogICAgICAgIHdhbGtCdWNrZXRUcmVlKG5ld0FnZ0luZGV4LCBidWNrZXQsIG5ld0FnZy5pZCwgbmV3RmlsdGVycywgIiIuY29uY2F0KGtleSwgIi0iKS5jb25jYXQoYnVja2V0S2V5LnRvU3RyaW5nKCkpKTsKICAgICAgfSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoIWFnZ1dpdGhPdGhlckJ1Y2tldC5wYXJhbXMubWlzc2luZ0J1Y2tldCB8fCBhZ2cuYnVja2V0cy5zb21lKGZ1bmN0aW9uIChidWNrZXQpIHsKICAgICAgcmV0dXJuIGJ1Y2tldC5rZXkgPT09ICdfX21pc3NpbmdfXyc7CiAgICB9KSkgewogICAgICBmaWx0ZXJzLnB1c2goKDAsIF9jb21tb24uYnVpbGRFeGlzdHNGaWx0ZXIpKGFnZ1dpdGhPdGhlckJ1Y2tldC5wYXJhbXMuZmllbGQsIGFnZ1dpdGhPdGhlckJ1Y2tldC5wYXJhbXMuZmllbGQuaW5kZXhQYXR0ZXJuKSk7CiAgICB9IC8vIGNyZWF0ZSBub3QgZmlsdGVycyBmb3IgYWxsIHRoZSBidWNrZXRzCgoKICAgICgwLCBfbG9kYXNoLmVhY2gpKGFnZy5idWNrZXRzLCBmdW5jdGlvbiAoYnVja2V0KSB7CiAgICAgIGlmIChidWNrZXQua2V5ID09PSAnX19taXNzaW5nX18nKSByZXR1cm47CiAgICAgIHZhciBmaWx0ZXIgPSBjdXJyZW50QWdnLmNyZWF0ZUZpbHRlcihidWNrZXQua2V5KTsKICAgICAgZmlsdGVyLm1ldGEubmVnYXRlID0gdHJ1ZTsKICAgICAgZmlsdGVycy5wdXNoKGZpbHRlcik7CiAgICB9KTsKICAgIHJlc3VsdEFnZy5maWx0ZXJzLmZpbHRlcnNba2V5XSA9IHsKICAgICAgYm9vbDogKDAsIF9jb21tb24uYnVpbGRRdWVyeUZyb21GaWx0ZXJzKShmaWx0ZXJzLCBpbmRleFBhdHRlcm4pCiAgICB9OwogIH07CgogIHdhbGtCdWNrZXRUcmVlKDAsIHJlc3BvbnNlLmFnZ3JlZ2F0aW9ucywgYnVja2V0QWdnc1swXS5pZCwgW10sICcnKTsgLy8gYmFpbCBpZiB0aGVyZSB3ZXJlIG5vIGJ1Y2tldCByZXN1bHRzCgogIGlmIChub0FnZ0J1Y2tldFJlc3VsdHMpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICAnb3RoZXItZmlsdGVyJzogcmVzdWx0QWdnCiAgICB9OwogIH07Cn07CgpleHBvcnRzLmJ1aWxkT3RoZXJCdWNrZXRBZ2cgPSBidWlsZE90aGVyQnVja2V0QWdnOwoKdmFyIG1lcmdlT3RoZXJCdWNrZXRBZ2dSZXNwb25zZSA9IGZ1bmN0aW9uIG1lcmdlT3RoZXJCdWNrZXRBZ2dSZXNwb25zZShhZ2dzQ29uZmlnLCByZXNwb25zZSwgb3RoZXJSZXNwb25zZSwgb3RoZXJBZ2csIHJlcXVlc3RBZ2cpIHsKICB2YXIgdXBkYXRlZFJlc3BvbnNlID0gKDAsIF9sb2Rhc2guY2xvbmVEZWVwKShyZXNwb25zZSk7CiAgKDAsIF9sb2Rhc2guZWFjaCkob3RoZXJSZXNwb25zZS5hZ2dyZWdhdGlvbnNbJ290aGVyLWZpbHRlciddLmJ1Y2tldHMsIGZ1bmN0aW9uIChidWNrZXQsIGtleSkgewogICAgaWYgKCFidWNrZXQuZG9jX2NvdW50IHx8IGtleSA9PT0gdW5kZWZpbmVkKSByZXR1cm47CiAgICB2YXIgYnVja2V0S2V5ID0ga2V5LnJlcGxhY2UoL14tLywgJycpOwogICAgdmFyIGFnZ1Jlc3VsdEJ1Y2tldHMgPSBnZXRBZ2dSZXN1bHRCdWNrZXRzKGFnZ3NDb25maWcsIHVwZGF0ZWRSZXNwb25zZS5hZ2dyZWdhdGlvbnMsIG90aGVyQWdnLCBidWNrZXRLZXkpOwogICAgdmFyIHJlcXVlc3RGaWx0ZXJUZXJtcyA9IGdldE90aGVyQWdnVGVybXMocmVxdWVzdEFnZywga2V5LCBvdGhlckFnZyk7CiAgICB2YXIgcGhyYXNlRmlsdGVyID0gKDAsIF9jb21tb24uYnVpbGRQaHJhc2VzRmlsdGVyKShvdGhlckFnZy5wYXJhbXMuZmllbGQsIHJlcXVlc3RGaWx0ZXJUZXJtcywgb3RoZXJBZ2cucGFyYW1zLmZpZWxkLmluZGV4UGF0dGVybik7CiAgICBwaHJhc2VGaWx0ZXIubWV0YS5uZWdhdGUgPSB0cnVlOwogICAgYnVja2V0LmZpbHRlcnMgPSBbcGhyYXNlRmlsdGVyXTsKICAgIGJ1Y2tldC5rZXkgPSAnX19vdGhlcl9fJzsKCiAgICBpZiAoYWdnUmVzdWx0QnVja2V0cy5zb21lKGZ1bmN0aW9uIChhZ2dSZXN1bHRCdWNrZXQpIHsKICAgICAgcmV0dXJuIGFnZ1Jlc3VsdEJ1Y2tldC5rZXkgPT09ICdfX21pc3NpbmdfXyc7CiAgICB9KSkgewogICAgICBidWNrZXQuZmlsdGVycy5wdXNoKCgwLCBfY29tbW9uLmJ1aWxkRXhpc3RzRmlsdGVyKShvdGhlckFnZy5wYXJhbXMuZmllbGQsIG90aGVyQWdnLnBhcmFtcy5maWVsZC5pbmRleFBhdHRlcm4pKTsKICAgIH0KCiAgICBhZ2dSZXN1bHRCdWNrZXRzLnB1c2goYnVja2V0KTsKICB9KTsKICByZXR1cm4gdXBkYXRlZFJlc3BvbnNlOwp9OwoKZXhwb3J0cy5tZXJnZU90aGVyQnVja2V0QWdnUmVzcG9uc2UgPSBtZXJnZU90aGVyQnVja2V0QWdnUmVzcG9uc2U7Cgp2YXIgdXBkYXRlTWlzc2luZ0J1Y2tldCA9IGZ1bmN0aW9uIHVwZGF0ZU1pc3NpbmdCdWNrZXQocmVzcG9uc2UsIGFnZ0NvbmZpZ3MsIGFnZykgewogIHZhciB1cGRhdGVkUmVzcG9uc2UgPSAoMCwgX2xvZGFzaC5jbG9uZURlZXApKHJlc3BvbnNlKTsKICB2YXIgYWdnUmVzdWx0QnVja2V0cyA9IGdldEFnZ0NvbmZpZ1Jlc3VsdE1pc3NpbmdCdWNrZXRzKHVwZGF0ZWRSZXNwb25zZS5hZ2dyZWdhdGlvbnMsIGFnZy5pZCk7CiAgYWdnUmVzdWx0QnVja2V0cy5mb3JFYWNoKGZ1bmN0aW9uIChidWNrZXQpIHsKICAgIGJ1Y2tldC5rZXkgPSAnX19taXNzaW5nX18nOwogIH0pOwogIHJldHVybiB1cGRhdGVkUmVzcG9uc2U7Cn07CgpleHBvcnRzLnVwZGF0ZU1pc3NpbmdCdWNrZXQgPSB1cGRhdGVNaXNzaW5nQnVja2V0Ow=="},null]}