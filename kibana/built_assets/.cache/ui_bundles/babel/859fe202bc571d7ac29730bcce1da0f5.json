{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!src/legacy/core_plugins/tile_map/public/base_maps_visualization.js","dependencies":[{"path":"src/legacy/core_plugins/tile_map/public/base_maps_visualization.js","mtime":1589249549906},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkJhc2VNYXBzVmlzdWFsaXphdGlvblByb3ZpZGVyID0gQmFzZU1hcHNWaXN1YWxpemF0aW9uUHJvdmlkZXI7Cgp2YXIgX2xvZGFzaCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgibG9kYXNoIikpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX2tpYmFuYV9tYXAgPSByZXF1aXJlKCJ1aS92aXMvbWFwL2tpYmFuYV9tYXAiKTsKCnZhciBSeCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJ4anMiKSk7Cgp2YXIgX29wZXJhdG9ycyA9IHJlcXVpcmUoInJ4anMvb3BlcmF0b3JzIik7CgpyZXF1aXJlKCJ1aS92aXMvbWFwL3NlcnZpY2Vfc2V0dGluZ3MiKTsKCnZhciBfbm90aWZ5ID0gcmVxdWlyZSgidWkvbm90aWZ5Iik7Cgp2YXIgX2Nocm9tZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidWkvY2hyb21lIikpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOyB9IH0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKdmFyIFdNU19NSU5aT09NID0gMDsKdmFyIFdNU19NQVhaT09NID0gMjI7IC8vaW5jcmVhc2UgdGhpcyB0byAyMi4gQmV0dGVyIGZvciBXTVMKCmZ1bmN0aW9uIEJhc2VNYXBzVmlzdWFsaXphdGlvblByb3ZpZGVyKHNlcnZpY2VTZXR0aW5ncykgewogIC8qKgogICAqIEFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIGEgdmlzdWFsaXphdGlvbiBjb25zaXN0aW5nIG9mIGEgbWFwIHdpdGggYSBzaW5nbGUgYmFzZWxheWVyLgogICAqIEBjbGFzcyBCYXNlTWFwc1Zpc3VhbGl6YXRpb24KICAgKiBAY29uc3RydWN0b3IKICAgKi8KICByZXR1cm4gKAogICAgLyojX19QVVJFX18qLwogICAgZnVuY3Rpb24gKCkgewogICAgICBmdW5jdGlvbiBCYXNlTWFwc1Zpc3VhbGl6YXRpb24oZWxlbWVudCwgdmlzKSB7CiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhc2VNYXBzVmlzdWFsaXphdGlvbik7CgogICAgICAgIHRoaXMudmlzID0gdmlzOwogICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGVsZW1lbnQ7CiAgICAgICAgdGhpcy5fa2liYW5hTWFwID0gbnVsbDsKICAgICAgICB0aGlzLl9jaGFydERhdGEgPSBudWxsOyAvL3JlZmVyZW5jZSB0byBkYXRhIGN1cnJlbnRseSBvbiB0aGUgbWFwLgoKICAgICAgICB0aGlzLl9iYXNlTGF5ZXJEaXJ0eSA9IHRydWU7CiAgICAgICAgdGhpcy5fbWFwSXNMb2FkZWQgPSB0aGlzLl9tYWtlS2liYW5hTWFwKCk7CiAgICAgIH0KCiAgICAgIF9jcmVhdGVDbGFzcyhCYXNlTWFwc1Zpc3VhbGl6YXRpb24sIFt7CiAgICAgICAga2V5OiAiaXNMb2FkZWQiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc0xvYWRlZCgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLl9tYXBJc0xvYWRlZDsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJkZXN0cm95IiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHsKICAgICAgICAgIGlmICh0aGlzLl9raWJhbmFNYXApIHsKICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLmRlc3Ryb3koKTsKCiAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcCA9IG51bGw7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8qKgogICAgICAgICAqIEltcGxlbWVudGF0aW9uIG9mIFZpc3VhbGl6YXRpb24jcmVuZGVyLgogICAgICAgICAqIENoaWxkLWNsYXNzZXMgY2FuIGV4dGVuZCB0aGlzIG1ldGhvZCBpZiB0aGUgcmVuZGVyLWNvbXBsZXRlIGZ1bmN0aW9uIHJlcXVpcmVzIG1vcmUgdGltZSB1bnRpbCByZW5kZXJpbmcgaGFzIGNvbXBsZXRlZC4KICAgICAgICAgKiBAcGFyYW0gZXNSZXNwb25zZQogICAgICAgICAqIEBwYXJhbSBzdGF0dXMKICAgICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfQogICAgICAgICAqLwoKICAgICAgfSwgewogICAgICAgIGtleTogInJlbmRlciIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBfcmVuZGVyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGVzUmVzcG9uc2UsIHZpc1BhcmFtcykgewogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2tpYmFuYU1hcCkgewogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9tYXBJc0xvYWRlZDsKCiAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAucmVzaXplKCk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuX3BhcmFtcyA9IHZpc1BhcmFtczsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdXBkYXRlUGFyYW1zKCk7CgogICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9oYXNFU1Jlc3BvbnNlQ2hhbmdlZChlc1Jlc3BvbnNlKSkgewogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZURhdGEoZXNSZXNwb25zZSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC51c2VVaVN0YXRlRnJvbVZpc3VhbGl6YXRpb24odGhpcy52aXMpOwoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3doZW5CYXNlTGF5ZXJJc0xvYWRlZCgpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgICAgICB9KSk7CgogICAgICAgICAgZnVuY3Rpb24gcmVuZGVyKF94LCBfeDIpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZW5kZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcmVuZGVyOwogICAgICAgIH0oKQogICAgICAgIC8qKgogICAgICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYSBraWJhbmEtbWFwIHdpdGggYSBzaW5nbGUgYmFzZWxheWVyIGFuZCBhc3NpZ25zIGl0IHRvIHRoZSB0aGlzLl9raWJhbmFNYXAgcHJvcGVydHkuCiAgICAgICAgICogQ2xpZW50cyBjYW4gb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gY3VzdG9taXplIHRoZSBpbml0aWFsaXphdGlvbi4KICAgICAgICAgKiBAcHJpdmF0ZQogICAgICAgICAqLwoKICAgICAgfSwgewogICAgICAgIGtleTogIl9tYWtlS2liYW5hTWFwIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIF9tYWtlS2liYW5hTWFwMiA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAgICAgICB2YXIgb3B0aW9ucywgdWlTdGF0ZSwgem9vbUZyb21VaVN0YXRlLCBjZW50ZXJGcm9tVUlTdGF0ZTsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBvcHRpb25zID0ge307CiAgICAgICAgICAgICAgICAgICAgdWlTdGF0ZSA9IHRoaXMudmlzLmdldFVpU3RhdGUoKTsKICAgICAgICAgICAgICAgICAgICB6b29tRnJvbVVpU3RhdGUgPSBwYXJzZUludCh1aVN0YXRlLmdldCgnbWFwWm9vbScpKTsKICAgICAgICAgICAgICAgICAgICBjZW50ZXJGcm9tVUlTdGF0ZSA9IHVpU3RhdGUuZ2V0KCdtYXBDZW50ZXInKTsKICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnpvb20gPSAhaXNOYU4oem9vbUZyb21VaVN0YXRlKSA/IHpvb21Gcm9tVWlTdGF0ZSA6IHRoaXMudmlzLnBhcmFtcy5tYXBab29tOwogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuY2VudGVyID0gY2VudGVyRnJvbVVJU3RhdGUgPyBjZW50ZXJGcm9tVUlTdGF0ZSA6IHRoaXMudmlzLnBhcmFtcy5tYXBDZW50ZXI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwID0gbmV3IF9raWJhbmFfbWFwLktpYmFuYU1hcCh0aGlzLl9jb250YWluZXIsIG9wdGlvbnMpOwoKICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAuc2V0TWluWm9vbShXTVNfTUlOWk9PTSk7IC8vdXNlIGEgZGVmYXVsdAoKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnNldE1heFpvb20oV01TX01BWFpPT00pOyAvL3VzZSBhIGRlZmF1bHQKCgogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5hZGRMZWdlbmRDb250cm9sKCk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5hZGRGaXRDb250cm9sKCk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5wZXJzaXN0VWlTdGF0ZUZvclZpc3VhbGl6YXRpb24odGhpcy52aXMpOwoKICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAub24oJ2Jhc2VMYXllcjpsb2FkZWQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fYmFzZUxheWVyRGlydHkgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLm9uKCdiYXNlTGF5ZXI6bG9hZGluZycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9iYXNlTGF5ZXJEaXJ0eSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZUJhc2VMYXllcigpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTsKICAgICAgICAgIH0pKTsKCiAgICAgICAgICBmdW5jdGlvbiBfbWFrZUtpYmFuYU1hcCgpIHsKICAgICAgICAgICAgcmV0dXJuIF9tYWtlS2liYW5hTWFwMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBfbWFrZUtpYmFuYU1hcDsKICAgICAgICB9KCkKICAgICAgfSwgewogICAgICAgIGtleTogIl90bXNDb25maWd1cmVkIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3Rtc0NvbmZpZ3VyZWQoKSB7CiAgICAgICAgICB2YXIgX3RoaXMkX2dldE1hcHNQYXJhbXMgPSB0aGlzLl9nZXRNYXBzUGFyYW1zKCksCiAgICAgICAgICAgICAgd21zID0gX3RoaXMkX2dldE1hcHNQYXJhbXMud21zOwoKICAgICAgICAgIHZhciBoYXNUbXNCYXNlTGF5ZXIgPSAhIXdtcy5zZWxlY3RlZFRtc0xheWVyOwogICAgICAgICAgcmV0dXJuIGhhc1Rtc0Jhc2VMYXllcjsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJfd21zQ29uZmlndXJlZCIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF93bXNDb25maWd1cmVkKCkgewogICAgICAgICAgdmFyIF90aGlzJF9nZXRNYXBzUGFyYW1zMiA9IHRoaXMuX2dldE1hcHNQYXJhbXMoKSwKICAgICAgICAgICAgICB3bXMgPSBfdGhpcyRfZ2V0TWFwc1BhcmFtczIud21zOwoKICAgICAgICAgIHZhciBoYXNXbXNCYXNlTGF5ZXIgPSAhIXdtcy5lbmFibGVkOwogICAgICAgICAgcmV0dXJuIGhhc1dtc0Jhc2VMYXllcjsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBrZXk6ICJfdXBkYXRlQmFzZUxheWVyIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIF91cGRhdGVCYXNlTGF5ZXIyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICAgICAgdmFyIGVtc1RpbGVMYXllcklkLCBtYXBQYXJhbXMsIHRtc1NlcnZpY2VzLCB1c2VyQ29uZmlndXJlZFRtc0xheWVyLCBpbml0QmFzZW1hcExheWVyLCBzZWxlY3RlZFRtc0xheWVyOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGVtc1RpbGVMYXllcklkID0gX2Nocm9tZS5kZWZhdWx0LmdldEluamVjdGVkKCdlbXNUaWxlTGF5ZXJJZCcsIHRydWUpOwoKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fa2liYW5hTWFwKSB7CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICBtYXBQYXJhbXMgPSB0aGlzLl9nZXRNYXBzUGFyYW1zKCk7CgogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl90bXNDb25maWd1cmVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gNTsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2VTZXR0aW5ncy5nZXRUTVNTZXJ2aWNlcygpOwoKICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgIHRtc1NlcnZpY2VzID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgdXNlckNvbmZpZ3VyZWRUbXNMYXllciA9IHRtc1NlcnZpY2VzWzBdOwogICAgICAgICAgICAgICAgICAgIGluaXRCYXNlbWFwTGF5ZXIgPSB1c2VyQ29uZmlndXJlZFRtc0xheWVyID8gdXNlckNvbmZpZ3VyZWRUbXNMYXllciA6IHRtc1NlcnZpY2VzLmZpbmQoZnVuY3Rpb24gKHMpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzLmlkID09PSBlbXNUaWxlTGF5ZXJJZC5icmlnaHQ7CiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIGlmIChpbml0QmFzZW1hcExheWVyKSB7CiAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRUbXNMYXllcihpbml0QmFzZW1hcExheWVyKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMTQ7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLnQwID0gX2NvbnRleHQzWyJjYXRjaCJdKDUpOwoKICAgICAgICAgICAgICAgICAgICBfbm90aWZ5LnRvYXN0Tm90aWZpY2F0aW9ucy5hZGRXYXJuaW5nKF9jb250ZXh0My50MC5tZXNzYWdlKTsKCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fd21zQ29uZmlndXJlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChXTVNfTUlOWk9PTSA+IHRoaXMuX2tpYmFuYU1hcC5nZXRNYXhab29tTGV2ZWwoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5zZXRNaW5ab29tKFdNU19NSU5aT09NKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnNldE1heFpvb20oV01TX01BWFpPT00pOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAuc2V0QmFzZUxheWVyKHsKICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlTGF5ZXJUeXBlOiAnd21zJywKICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBfb2JqZWN0U3ByZWFkKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblpvb206IFdNU19NSU5aT09NLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4Wm9vbTogV01TX01BWFpPT00sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IG1hcFBhcmFtcy53bXMudXJsCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgbWFwUGFyYW1zLndtcy5vcHRpb25zKQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5fdG1zQ29uZmlndXJlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkVG1zTGF5ZXIgPSBtYXBQYXJhbXMud21zLnNlbGVjdGVkVG1zTGF5ZXI7CgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRUbXNMYXllcihzZWxlY3RlZFRtc0xheWVyKTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0bXNMb2FkaW5nRXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgIF9ub3RpZnkudG9hc3ROb3RpZmljYXRpb25zLmFkZFdhcm5pbmcodG1zTG9hZGluZ0Vycm9yLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBfY2FsbGVlMywgdGhpcywgW1s1LCAxNF1dKTsKICAgICAgICAgIH0pKTsKCiAgICAgICAgICBmdW5jdGlvbiBfdXBkYXRlQmFzZUxheWVyKCkgewogICAgICAgICAgICByZXR1cm4gX3VwZGF0ZUJhc2VMYXllcjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gX3VwZGF0ZUJhc2VMYXllcjsKICAgICAgICB9KCkKICAgICAgfSwgewogICAgICAgIGtleTogIl9zZXRUbXNMYXllciIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBfc2V0VG1zTGF5ZXIyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCh0bXNMYXllcikgewogICAgICAgICAgICB2YXIgaXNEZXNhdHVyYXRlZCwgaXNEYXJrTW9kZSwgbWV0YSwgc2hvd1pvb21NZXNzYWdlLCBvcHRpb25zOwogICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5zZXRNaW5ab29tKHRtc0xheWVyLm1pblpvb20pOwoKICAgICAgICAgICAgICAgICAgICB0aGlzLl9raWJhbmFNYXAuc2V0TWF4Wm9vbSh0bXNMYXllci5tYXhab29tKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2tpYmFuYU1hcC5nZXRab29tTGV2ZWwoKSA+IHRtc0xheWVyLm1heFpvb20pIHsKICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5zZXRab29tTGV2ZWwodG1zTGF5ZXIubWF4Wm9vbSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpc0Rlc2F0dXJhdGVkID0gdGhpcy5fZ2V0TWFwc1BhcmFtcygpLmlzRGVzYXR1cmF0ZWQ7CgogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaXNEZXNhdHVyYXRlZCAhPT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgICAgICAgICAgICAgICBpc0Rlc2F0dXJhdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlzRGFya01vZGUgPSBfY2hyb21lLmRlZmF1bHQuZ2V0VWlTZXR0aW5nc0NsaWVudCgpLmdldCgndGhlbWU6ZGFya01vZGUnKTsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2VTZXR0aW5ncy5nZXRBdHRyaWJ1dGVzRm9yVE1TTGF5ZXIodG1zTGF5ZXIsIGlzRGVzYXR1cmF0ZWQsIGlzRGFya01vZGUpOwoKICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgIG1ldGEgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgICAgICBzaG93Wm9vbU1lc3NhZ2UgPSBzZXJ2aWNlU2V0dGluZ3Muc2hvdWxkU2hvd1pvb21NZXNzYWdlKHRtc0xheWVyKTsKICAgICAgICAgICAgICAgICAgICBvcHRpb25zID0gX2xvZGFzaC5kZWZhdWx0LmNsb25lRGVlcCh0bXNMYXllcik7CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuaWQ7CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuc3ViZG9tYWluczsKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnNldEJhc2VMYXllcih7CiAgICAgICAgICAgICAgICAgICAgICBiYXNlTGF5ZXJUeXBlOiAndG1zJywKICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IF9vYmplY3RTcHJlYWQoe30sIG9wdGlvbnMsIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1pvb21NZXNzYWdlOiBzaG93Wm9vbU1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgIH0sIG1ldGEpCiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICAgICAgfSkpOwoKICAgICAgICAgIGZ1bmN0aW9uIF9zZXRUbXNMYXllcihfeDMpIHsKICAgICAgICAgICAgcmV0dXJuIF9zZXRUbXNMYXllcjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gX3NldFRtc0xheWVyOwogICAgICAgIH0oKQogICAgICB9LCB7CiAgICAgICAga2V5OiAiX3VwZGF0ZURhdGEiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgX3VwZGF0ZURhdGEyID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3RpbGVNYXAuYmFzZU1hcHNWaXN1YWxpemF0aW9uLmNoaWxkU2hvdWxkSW1wbGVtZW50TWV0aG9kRXJyb3JNZXNzYWdlJywgewogICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDaGlsZCBzaG91bGQgaW1wbGVtZW50IHRoaXMgbWV0aG9kIHRvIHJlc3BvbmQgdG8gZGF0YS11cGRhdGUnCiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICAgICAgfSkpOwoKICAgICAgICAgIGZ1bmN0aW9uIF91cGRhdGVEYXRhKCkgewogICAgICAgICAgICByZXR1cm4gX3VwZGF0ZURhdGEyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIF91cGRhdGVEYXRhOwogICAgICAgIH0oKQogICAgICB9LCB7CiAgICAgICAga2V5OiAiX2hhc0VTUmVzcG9uc2VDaGFuZ2VkIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2hhc0VTUmVzcG9uc2VDaGFuZ2VkKGRhdGEpIHsKICAgICAgICAgIHJldHVybiB0aGlzLl9jaGFydERhdGEgIT09IGRhdGE7CiAgICAgICAgfQogICAgICAgIC8qKgogICAgICAgICAqIGNhbGxlZCBvbiBvcHRpb25zIGNoYW5nZSAodmlzLnBhcmFtcyBjaGFuZ2UpCiAgICAgICAgICovCgogICAgICB9LCB7CiAgICAgICAga2V5OiAiX3VwZGF0ZVBhcmFtcyIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBfdXBkYXRlUGFyYW1zMiA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgICAgIHZhciBtYXBQYXJhbXM7CiAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgbWFwUGFyYW1zID0gdGhpcy5fZ2V0TWFwc1BhcmFtcygpOwogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdXBkYXRlQmFzZUxheWVyKCk7CgogICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2liYW5hTWFwLnNldExlZ2VuZFBvc2l0aW9uKG1hcFBhcmFtcy5sZWdlbmRQb3NpdGlvbik7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC5zZXRTaG93VG9vbHRpcChtYXBQYXJhbXMuYWRkVG9vbHRpcCk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuX2tpYmFuYU1hcC51c2VVaVN0YXRlRnJvbVZpc3VhbGl6YXRpb24odGhpcy52aXMpOwoKICAgICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTYsIHRoaXMpOwogICAgICAgICAgfSkpOwoKICAgICAgICAgIGZ1bmN0aW9uIF91cGRhdGVQYXJhbXMoKSB7CiAgICAgICAgICAgIHJldHVybiBfdXBkYXRlUGFyYW1zMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBfdXBkYXRlUGFyYW1zOwogICAgICAgIH0oKQogICAgICB9LCB7CiAgICAgICAga2V5OiAiX2dldE1hcHNQYXJhbXMiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0TWFwc1BhcmFtcygpIHsKICAgICAgICAgIHJldHVybiBfbG9kYXNoLmRlZmF1bHQuYXNzaWduKHt9LCB0aGlzLnZpcy50eXBlLnZpc0NvbmZpZy5kZWZhdWx0cywgewogICAgICAgICAgICB0eXBlOiB0aGlzLnZpcy50eXBlLm5hbWUKICAgICAgICAgIH0sIHRoaXMuX3BhcmFtcyk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAga2V5OiAiX3doZW5CYXNlTGF5ZXJJc0xvYWRlZCIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF93aGVuQmFzZUxheWVySXNMb2FkZWQoKSB7CiAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgICAgICBpZiAoIXRoaXMuX3Rtc0NvbmZpZ3VyZWQoKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgbWF4VGltZUZvckJhc2VMYXllciA9IDEwMDAwOwogICAgICAgICAgdmFyIGludGVydmFsJCA9IFJ4LmludGVydmFsKDEwKS5waXBlKCgwLCBfb3BlcmF0b3JzLmZpbHRlcikoZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gIV90aGlzMi5fYmFzZUxheWVyRGlydHk7CiAgICAgICAgICB9KSk7CiAgICAgICAgICB2YXIgdGltZXIkID0gUngudGltZXIobWF4VGltZUZvckJhc2VMYXllcik7CiAgICAgICAgICByZXR1cm4gUngucmFjZShpbnRlcnZhbCQsIHRpbWVyJCkucGlwZSgoMCwgX29wZXJhdG9ycy5maXJzdCkoKSkudG9Qcm9taXNlKCk7CiAgICAgICAgfQogICAgICB9XSk7CgogICAgICByZXR1cm4gQmFzZU1hcHNWaXN1YWxpemF0aW9uOwogICAgfSgpCiAgKTsKfQ=="},null]}