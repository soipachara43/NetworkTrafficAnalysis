{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/create/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/create/index.js","mtime":1589249553316},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkNyZWF0ZVJ1bGVQYWdlID0gdm9pZCAwOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfcmVhY3QgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJyZWFjdCIpKTsKCnZhciBfcmVhY3RSb3V0ZXJEb20gPSByZXF1aXJlKCJyZWFjdC1yb3V0ZXItZG9tIik7Cgp2YXIgX3N0eWxlZENvbXBvbmVudHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInN0eWxlZC1jb21wb25lbnRzIikpOwoKdmFyIF9ydWxlcyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uL2NvbnRhaW5lcnMvZGV0ZWN0aW9uX2VuZ2luZS9ydWxlcyIpOwoKdmFyIF9yZWRpcmVjdF90b19kZXRlY3Rpb25fZW5naW5lID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy9saW5rX3RvL3JlZGlyZWN0X3RvX2RldGVjdGlvbl9lbmdpbmUiKTsKCnZhciBfd3JhcHBlcl9wYWdlID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vY29tcG9uZW50cy93cmFwcGVyX3BhZ2UiKTsKCnZhciBfdG9hc3RlcnMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21wb25lbnRzL3RvYXN0ZXJzIik7Cgp2YXIgX3NweV9yb3V0ZXMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi91dGlscy9yb3V0ZS9zcHlfcm91dGVzIik7Cgp2YXIgX3VzZXJfaW5mbyA9IHJlcXVpcmUoIi4uLy4uL2NvbXBvbmVudHMvdXNlcl9pbmZvIik7Cgp2YXIgX2FjY29yZGlvbl90aXRsZSA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvYWNjb3JkaW9uX3RpdGxlIik7Cgp2YXIgX3N0ZXBfYWJvdXRfcnVsZSA9IHJlcXVpcmUoIi4uL2NvbXBvbmVudHMvc3RlcF9hYm91dF9ydWxlIik7Cgp2YXIgX3N0ZXBfZGVmaW5lX3J1bGUgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL3N0ZXBfZGVmaW5lX3J1bGUiKTsKCnZhciBfc3RlcF9zY2hlZHVsZV9ydWxlID0gcmVxdWlyZSgiLi4vY29tcG9uZW50cy9zdGVwX3NjaGVkdWxlX3J1bGUiKTsKCnZhciBfc3RlcF9ydWxlX2FjdGlvbnMgPSByZXF1aXJlKCIuLi9jb21wb25lbnRzL3N0ZXBfcnVsZV9hY3Rpb25zIik7Cgp2YXIgX2RldGVjdGlvbl9lbmdpbmVfaGVhZGVyX3BhZ2UgPSByZXF1aXJlKCIuLi8uLi9jb21wb25lbnRzL2RldGVjdGlvbl9lbmdpbmVfaGVhZGVyX3BhZ2UiKTsKCnZhciBSdWxlSTE4biA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIi4uL3RyYW5zbGF0aW9ucyIpKTsKCnZhciBfaGVscGVycyA9IHJlcXVpcmUoIi4uL2hlbHBlcnMiKTsKCnZhciBfdHlwZXMgPSByZXF1aXJlKCIuLi90eXBlcyIpOwoKdmFyIF9oZWxwZXJzMiA9IHJlcXVpcmUoIi4vaGVscGVycyIpOwoKdmFyIGkxOG4gPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCIuL3RyYW5zbGF0aW9ucyIpKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgewogIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKICAgIHJldHVybiBvYmo7CiAgfSBlbHNlIHsKICAgIHZhciBuZXdPYmogPSB7fTsKCiAgICBpZiAob2JqICE9IG51bGwpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsKCiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7CiAgICByZXR1cm4gbmV3T2JqOwogIH0KfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgewogIHRyeSB7CiAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7CiAgICB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICByZWplY3QoZXJyb3IpOwogICAgcmV0dXJuOwogIH0KCiAgaWYgKGluZm8uZG9uZSkgewogICAgcmVzb2x2ZSh2YWx1ZSk7CiAgfSBlbHNlIHsKICAgIFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsKICB9Cn0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICBhcmdzID0gYXJndW1lbnRzOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOwoKICAgICAgZnVuY3Rpb24gX25leHQodmFsdWUpIHsKICAgICAgICBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOwogICAgICB9CgogICAgICBfbmV4dCh1bmRlZmluZWQpOwogICAgfSk7CiAgfTsKfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoc291cmNlLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciBzdGVwc1J1bGVPcmRlciA9IFtfdHlwZXMuUnVsZVN0ZXAuZGVmaW5lUnVsZSwgX3R5cGVzLlJ1bGVTdGVwLmFib3V0UnVsZSwgX3R5cGVzLlJ1bGVTdGVwLnNjaGVkdWxlUnVsZSwgX3R5cGVzLlJ1bGVTdGVwLnJ1bGVBY3Rpb25zXTsKdmFyIE15RXVpUGFuZWwgPSAoMCwgX3N0eWxlZENvbXBvbmVudHMuZGVmYXVsdCkoX2V1aS5FdWlQYW5lbCkud2l0aENvbmZpZyh7CiAgZGlzcGxheU5hbWU6ICJNeUV1aVBhbmVsIiwKICBjb21wb25lbnRJZDogInl5aDhmZS0wIgp9KShbInBvc2l0aW9uOnJlbGF0aXZlO3otaW5kZXg6IiwgIjs+IC5ldWlBY2NvcmRpb24gPiAuZXVpQWNjb3JkaW9uX190cmlnZ2VyV3JhcHBlcnsuZXVpQWNjb3JkaW9uX19idXR0b257Y3Vyc29yOmRlZmF1bHQgIWltcG9ydGFudDsmOmhvdmVye3RleHQtZGVjb3JhdGlvbjpub25lICFpbXBvcnRhbnQ7fX0uZXVpQWNjb3JkaW9uX19pY29uV3JhcHBlcntkaXNwbGF5Om5vbmU7fX0iXSwgZnVuY3Rpb24gKHByb3BzKSB7CiAgcmV0dXJuIHByb3BzLnppbmRleDsKfSk7Ck15RXVpUGFuZWwuZGlzcGxheU5hbWUgPSAnTXlFdWlQYW5lbCc7CnZhciBTdGVwRGVmaW5lUnVsZUFjY29yZGlvbiA9ICgwLCBfc3R5bGVkQ29tcG9uZW50cy5kZWZhdWx0KShfZXVpLkV1aUFjY29yZGlvbikud2l0aENvbmZpZyh7CiAgZGlzcGxheU5hbWU6ICJTdGVwRGVmaW5lUnVsZUFjY29yZGlvbiIsCiAgY29tcG9uZW50SWQ6ICJ5eWg4ZmUtMSIKfSkoWyIuZXVpQWNjb3JkaW9uX19jaGlsZFdyYXBwZXJ7b3ZlcmZsb3c6dmlzaWJsZTt9Il0pOwpTdGVwRGVmaW5lUnVsZUFjY29yZGlvbi5kaXNwbGF5TmFtZSA9ICdTdGVwRGVmaW5lUnVsZUFjY29yZGlvbic7Cgp2YXIgQ3JlYXRlUnVsZVBhZ2VDb21wb25lbnQgPSBmdW5jdGlvbiBDcmVhdGVSdWxlUGFnZUNvbXBvbmVudCgpIHsKICB2YXIgX3VzZVJlZiwgX3VzZVJlZjIsIF91c2VTdGF0ZTUsIF9yZWYyLCBfcmVmMywgX3JlZjQ7CgogIHZhciBfdXNlVXNlckluZm8gPSAoMCwgX3VzZXJfaW5mby51c2VVc2VySW5mbykoKSwKICAgICAgbG9hZGluZyA9IF91c2VVc2VySW5mby5sb2FkaW5nLAogICAgICBpc1NpZ25hbEluZGV4RXhpc3RzID0gX3VzZVVzZXJJbmZvLmlzU2lnbmFsSW5kZXhFeGlzdHMsCiAgICAgIGlzQXV0aGVudGljYXRlZCA9IF91c2VVc2VySW5mby5pc0F1dGhlbnRpY2F0ZWQsCiAgICAgIGhhc0VuY3J5cHRpb25LZXkgPSBfdXNlVXNlckluZm8uaGFzRW5jcnlwdGlvbktleSwKICAgICAgY2FuVXNlckNSVUQgPSBfdXNlVXNlckluZm8uY2FuVXNlckNSVUQ7CgogIHZhciBfdXNlU3RhdGVUb2FzdGVyID0gKDAsIF90b2FzdGVycy51c2VTdGF0ZVRvYXN0ZXIpKCksCiAgICAgIF91c2VTdGF0ZVRvYXN0ZXIyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlVG9hc3RlciwgMiksCiAgICAgIGRpc3BhdGNoVG9hc3RlciA9IF91c2VTdGF0ZVRvYXN0ZXIyWzFdOwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoX3R5cGVzLlJ1bGVTdGVwLmRlZmluZVJ1bGUpLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgb3BlbkFjY29yZGlvbklkID0gX3VzZVN0YXRlMlswXSwKICAgICAgc2V0T3BlbkFjY29yZGlvbklkID0gX3VzZVN0YXRlMlsxXTsKCiAgdmFyIGRlZmluZVJ1bGVSZWYgPSAoMCwgX3JlYWN0LnVzZVJlZikobnVsbCk7CiAgdmFyIGFib3V0UnVsZVJlZiA9ICgwLCBfcmVhY3QudXNlUmVmKShudWxsKTsKICB2YXIgc2NoZWR1bGVSdWxlUmVmID0gKDAsIF9yZWFjdC51c2VSZWYpKG51bGwpOwogIHZhciBydWxlQWN0aW9uc1JlZiA9ICgwLCBfcmVhY3QudXNlUmVmKShudWxsKTsKICB2YXIgc3RlcHNGb3JtID0gKDAsIF9yZWFjdC51c2VSZWYpKChfdXNlUmVmID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfdXNlUmVmLCBfdHlwZXMuUnVsZVN0ZXAuZGVmaW5lUnVsZSwgbnVsbCksIF9kZWZpbmVQcm9wZXJ0eShfdXNlUmVmLCBfdHlwZXMuUnVsZVN0ZXAuYWJvdXRSdWxlLCBudWxsKSwgX2RlZmluZVByb3BlcnR5KF91c2VSZWYsIF90eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGUsIG51bGwpLCBfZGVmaW5lUHJvcGVydHkoX3VzZVJlZiwgX3R5cGVzLlJ1bGVTdGVwLnJ1bGVBY3Rpb25zLCBudWxsKSwgX3VzZVJlZikpOwogIHZhciBzdGVwc0RhdGEgPSAoMCwgX3JlYWN0LnVzZVJlZikoKF91c2VSZWYyID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfdXNlUmVmMiwgX3R5cGVzLlJ1bGVTdGVwLmRlZmluZVJ1bGUsIHsKICAgIGlzVmFsaWQ6IGZhbHNlLAogICAgZGF0YToge30KICB9KSwgX2RlZmluZVByb3BlcnR5KF91c2VSZWYyLCBfdHlwZXMuUnVsZVN0ZXAuYWJvdXRSdWxlLCB7CiAgICBpc1ZhbGlkOiBmYWxzZSwKICAgIGRhdGE6IHt9CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfdXNlUmVmMiwgX3R5cGVzLlJ1bGVTdGVwLnNjaGVkdWxlUnVsZSwgewogICAgaXNWYWxpZDogZmFsc2UsCiAgICBkYXRhOiB7fQogIH0pLCBfZGVmaW5lUHJvcGVydHkoX3VzZVJlZjIsIF90eXBlcy5SdWxlU3RlcC5ydWxlQWN0aW9ucywgewogICAgaXNWYWxpZDogZmFsc2UsCiAgICBkYXRhOiB7fQogIH0pLCBfdXNlUmVmMikpOwoKICB2YXIgX3VzZVN0YXRlMyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKChfdXNlU3RhdGU1ID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfdXNlU3RhdGU1LCBfdHlwZXMuUnVsZVN0ZXAuZGVmaW5lUnVsZSwgZmFsc2UpLCBfZGVmaW5lUHJvcGVydHkoX3VzZVN0YXRlNSwgX3R5cGVzLlJ1bGVTdGVwLmFib3V0UnVsZSwgZmFsc2UpLCBfZGVmaW5lUHJvcGVydHkoX3VzZVN0YXRlNSwgX3R5cGVzLlJ1bGVTdGVwLnNjaGVkdWxlUnVsZSwgZmFsc2UpLCBfZGVmaW5lUHJvcGVydHkoX3VzZVN0YXRlNSwgX3R5cGVzLlJ1bGVTdGVwLnJ1bGVBY3Rpb25zLCBmYWxzZSksIF91c2VTdGF0ZTUpKSwKICAgICAgX3VzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTMsIDIpLAogICAgICBpc1N0ZXBSdWxlSW5SZWFkT25seVZpZXcgPSBfdXNlU3RhdGU0WzBdLAogICAgICBzZXRJc1N0ZXBSdWxlSW5FZGl0VmlldyA9IF91c2VTdGF0ZTRbMV07CgogIHZhciBfdXNlUGVyc2lzdFJ1bGUgPSAoMCwgX3J1bGVzLnVzZVBlcnNpc3RSdWxlKSgpLAogICAgICBfdXNlUGVyc2lzdFJ1bGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVBlcnNpc3RSdWxlLCAyKSwKICAgICAgX3VzZVBlcnNpc3RSdWxlMiQgPSBfdXNlUGVyc2lzdFJ1bGUyWzBdLAogICAgICBpc0xvYWRpbmcgPSBfdXNlUGVyc2lzdFJ1bGUyJC5pc0xvYWRpbmcsCiAgICAgIGlzU2F2ZWQgPSBfdXNlUGVyc2lzdFJ1bGUyJC5pc1NhdmVkLAogICAgICBzZXRSdWxlID0gX3VzZVBlcnNpc3RSdWxlMlsxXTsKCiAgdmFyIGFjdGlvbk1lc3NhZ2VQYXJhbXMgPSAoMCwgX3JlYWN0LnVzZU1lbW8pKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiAoMCwgX2hlbHBlcnMuZ2V0QWN0aW9uTWVzc2FnZVBhcmFtcykoc3RlcHNEYXRhLmN1cnJlbnRbJ2RlZmluZS1ydWxlJ10uZGF0YS5ydWxlVHlwZSk7CiAgfSwgW3N0ZXBzRGF0YS5jdXJyZW50WydkZWZpbmUtcnVsZSddLmRhdGFdKTsKICB2YXIgc2V0U3RlcERhdGEgPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoc3RlcCwgZGF0YSwgaXNWYWxpZCkgewogICAgc3RlcHNEYXRhLmN1cnJlbnRbc3RlcF0gPSBfb2JqZWN0U3ByZWFkKHt9LCBzdGVwc0RhdGEuY3VycmVudFtzdGVwXSwgewogICAgICBkYXRhOiBkYXRhLAogICAgICBpc1ZhbGlkOiBpc1ZhbGlkCiAgICB9KTsKCiAgICBpZiAoaXNWYWxpZCkgewogICAgICB2YXIgc3RlcFJ1bGVJZHggPSBzdGVwc1J1bGVPcmRlci5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gc3RlcCA9PT0gaXRlbTsKICAgICAgfSk7CgogICAgICBpZiAoWzAsIDEsIDJdLmluY2x1ZGVzKHN0ZXBSdWxlSWR4KSkgewogICAgICAgIGlmIChpc1N0ZXBSdWxlSW5SZWFkT25seVZpZXdbc3RlcHNSdWxlT3JkZXJbc3RlcFJ1bGVJZHggKyAxXV0pIHsKICAgICAgICAgIHZhciBfb2JqZWN0U3ByZWFkMjsKCiAgICAgICAgICBzZXRPcGVuQWNjb3JkaW9uSWQoc3RlcHNSdWxlT3JkZXJbc3RlcFJ1bGVJZHggKyAxXSk7CiAgICAgICAgICBzZXRJc1N0ZXBSdWxlSW5FZGl0Vmlldyhfb2JqZWN0U3ByZWFkKHt9LCBpc1N0ZXBSdWxlSW5SZWFkT25seVZpZXcsIChfb2JqZWN0U3ByZWFkMiA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX29iamVjdFNwcmVhZDIsIHN0ZXAsIHRydWUpLCBfZGVmaW5lUHJvcGVydHkoX29iamVjdFNwcmVhZDIsIHN0ZXBzUnVsZU9yZGVyW3N0ZXBSdWxlSWR4ICsgMV0sIGZhbHNlKSwgX29iamVjdFNwcmVhZDIpKSk7CiAgICAgICAgfSBlbHNlIGlmIChvcGVuQWNjb3JkaW9uSWQgIT09IHN0ZXBzUnVsZU9yZGVyW3N0ZXBSdWxlSWR4ICsgMV0pIHsKICAgICAgICAgIHNldElzU3RlcFJ1bGVJbkVkaXRWaWV3KF9vYmplY3RTcHJlYWQoe30sIGlzU3RlcFJ1bGVJblJlYWRPbmx5VmlldywgX2RlZmluZVByb3BlcnR5KHt9LCBzdGVwLCB0cnVlKSkpOwogICAgICAgICAgb3BlbkNsb3NlQWNjb3JkaW9uKHN0ZXBzUnVsZU9yZGVyW3N0ZXBSdWxlSWR4ICsgMV0pOwogICAgICAgICAgc2V0T3BlbkFjY29yZGlvbklkKHN0ZXBzUnVsZU9yZGVyW3N0ZXBSdWxlSWR4ICsgMV0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChzdGVwUnVsZUlkeCA9PT0gMyAmJiBzdGVwc0RhdGEuY3VycmVudFtfdHlwZXMuUnVsZVN0ZXAuZGVmaW5lUnVsZV0uaXNWYWxpZCAmJiBzdGVwc0RhdGEuY3VycmVudFtfdHlwZXMuUnVsZVN0ZXAuYWJvdXRSdWxlXS5pc1ZhbGlkICYmIHN0ZXBzRGF0YS5jdXJyZW50W190eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGVdLmlzVmFsaWQpIHsKICAgICAgICBzZXRSdWxlKCgwLCBfaGVscGVyczIuZm9ybWF0UnVsZSkoc3RlcHNEYXRhLmN1cnJlbnRbX3R5cGVzLlJ1bGVTdGVwLmRlZmluZVJ1bGVdLmRhdGEsIHN0ZXBzRGF0YS5jdXJyZW50W190eXBlcy5SdWxlU3RlcC5hYm91dFJ1bGVdLmRhdGEsIHN0ZXBzRGF0YS5jdXJyZW50W190eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGVdLmRhdGEsIHN0ZXBzRGF0YS5jdXJyZW50W190eXBlcy5SdWxlU3RlcC5ydWxlQWN0aW9uc10uZGF0YSkpOwogICAgICB9CiAgICB9CiAgfSwgW2lzU3RlcFJ1bGVJblJlYWRPbmx5Vmlldywgb3BlbkFjY29yZGlvbklkLCBzdGVwc0RhdGEuY3VycmVudCwgc2V0UnVsZV0pOwogIHZhciBzZXRTdGVwc0Zvcm0gPSAoMCwgX3JlYWN0LnVzZUNhbGxiYWNrKShmdW5jdGlvbiAoc3RlcCwgZm9ybSkgewogICAgc3RlcHNGb3JtLmN1cnJlbnRbc3RlcF0gPSBmb3JtOwogIH0sIFtdKTsKICB2YXIgZ2V0QWNjb3JkaW9uVHlwZSA9ICgwLCBfcmVhY3QudXNlQ2FsbGJhY2spKGZ1bmN0aW9uIChhY2NvcmRpb25JZCkgewogICAgaWYgKGFjY29yZGlvbklkID09PSBvcGVuQWNjb3JkaW9uSWQpIHsKICAgICAgcmV0dXJuICdhY3RpdmUnOwogICAgfSBlbHNlIGlmIChzdGVwc0RhdGEuY3VycmVudFthY2NvcmRpb25JZF0uaXNWYWxpZCkgewogICAgICByZXR1cm4gJ3ZhbGlkJzsKICAgIH0KCiAgICByZXR1cm4gJ3Bhc3NpdmUnOwogIH0sIFtvcGVuQWNjb3JkaW9uSWQsIHN0ZXBzRGF0YS5jdXJyZW50XSk7CgogIHZhciBkZWZpbmVSdWxlQnV0dG9uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWNjb3JkaW9uX3RpdGxlLkFjY29yZGlvblRpdGxlLCB7CiAgICBuYW1lOiAiMSIsCiAgICB0aXRsZTogUnVsZUkxOG4uREVGSU5FX1JVTEUsCiAgICB0eXBlOiBnZXRBY2NvcmRpb25UeXBlKF90eXBlcy5SdWxlU3RlcC5kZWZpbmVSdWxlKQogIH0pOwoKICB2YXIgYWJvdXRSdWxlQnV0dG9uID0gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfYWNjb3JkaW9uX3RpdGxlLkFjY29yZGlvblRpdGxlLCB7CiAgICBuYW1lOiAiMiIsCiAgICB0aXRsZTogUnVsZUkxOG4uQUJPVVRfUlVMRSwKICAgIHR5cGU6IGdldEFjY29yZGlvblR5cGUoX3R5cGVzLlJ1bGVTdGVwLmFib3V0UnVsZSkKICB9KTsKCiAgdmFyIHNjaGVkdWxlUnVsZUJ1dHRvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2FjY29yZGlvbl90aXRsZS5BY2NvcmRpb25UaXRsZSwgewogICAgbmFtZTogIjMiLAogICAgdGl0bGU6IFJ1bGVJMThuLlNDSEVEVUxFX1JVTEUsCiAgICB0eXBlOiBnZXRBY2NvcmRpb25UeXBlKF90eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGUpCiAgfSk7CgogIHZhciBydWxlQWN0aW9uc0J1dHRvbiA9IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2FjY29yZGlvbl90aXRsZS5BY2NvcmRpb25UaXRsZSwgewogICAgbmFtZTogIjQiLAogICAgdGl0bGU6IFJ1bGVJMThuLlJVTEVfQUNUSU9OUywKICAgIHR5cGU6IGdldEFjY29yZGlvblR5cGUoX3R5cGVzLlJ1bGVTdGVwLnJ1bGVBY3Rpb25zKQogIH0pOwoKICB2YXIgb3BlbkNsb3NlQWNjb3JkaW9uID0gZnVuY3Rpb24gb3BlbkNsb3NlQWNjb3JkaW9uKGFjY29yZGlvbklkKSB7CiAgICBpZiAoYWNjb3JkaW9uSWQgIT0gbnVsbCkgewogICAgICBpZiAoYWNjb3JkaW9uSWQgPT09IF90eXBlcy5SdWxlU3RlcC5kZWZpbmVSdWxlICYmIGRlZmluZVJ1bGVSZWYuY3VycmVudCAhPSBudWxsKSB7CiAgICAgICAgZGVmaW5lUnVsZVJlZi5jdXJyZW50Lm9uVG9nZ2xlKCk7CiAgICAgIH0gZWxzZSBpZiAoYWNjb3JkaW9uSWQgPT09IF90eXBlcy5SdWxlU3RlcC5hYm91dFJ1bGUgJiYgYWJvdXRSdWxlUmVmLmN1cnJlbnQgIT0gbnVsbCkgewogICAgICAgIGFib3V0UnVsZVJlZi5jdXJyZW50Lm9uVG9nZ2xlKCk7CiAgICAgIH0gZWxzZSBpZiAoYWNjb3JkaW9uSWQgPT09IF90eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGUgJiYgc2NoZWR1bGVSdWxlUmVmLmN1cnJlbnQgIT0gbnVsbCkgewogICAgICAgIHNjaGVkdWxlUnVsZVJlZi5jdXJyZW50Lm9uVG9nZ2xlKCk7CiAgICAgIH0gZWxzZSBpZiAoYWNjb3JkaW9uSWQgPT09IF90eXBlcy5SdWxlU3RlcC5ydWxlQWN0aW9ucyAmJiBydWxlQWN0aW9uc1JlZi5jdXJyZW50ICE9IG51bGwpIHsKICAgICAgICBydWxlQWN0aW9uc1JlZi5jdXJyZW50Lm9uVG9nZ2xlKCk7CiAgICAgIH0KICAgIH0KICB9OyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvcnVsZXMtb2YtaG9va3MKCgogIHZhciBtYW5hZ2VBY2NvcmRpb25zID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoZnVuY3Rpb24gKGlkLCBpc09wZW4pIHsKICAgIHZhciBhY3RpdmVSdWxlSWR4ID0gc3RlcHNSdWxlT3JkZXIuZmluZEluZGV4KGZ1bmN0aW9uIChzdGVwKSB7CiAgICAgIHJldHVybiBzdGVwID09PSBvcGVuQWNjb3JkaW9uSWQ7CiAgICB9KTsKICAgIHZhciBzdGVwUnVsZUlkeCA9IHN0ZXBzUnVsZU9yZGVyLmZpbmRJbmRleChmdW5jdGlvbiAoc3RlcCkgewogICAgICByZXR1cm4gc3RlcCA9PT0gaWQ7CiAgICB9KTsKCiAgICBpZiAoKGlkID09PSBvcGVuQWNjb3JkaW9uSWQgfHwgc3RlcFJ1bGVJZHggPCBhY3RpdmVSdWxlSWR4KSAmJiAhaXNPcGVuKSB7CiAgICAgIG9wZW5DbG9zZUFjY29yZGlvbihpZCk7CiAgICB9IGVsc2UgaWYgKHN0ZXBSdWxlSWR4ID49IGFjdGl2ZVJ1bGVJZHgpIHsKICAgICAgaWYgKG9wZW5BY2NvcmRpb25JZCAhPT0gaWQgJiYgIXN0ZXBzRGF0YS5jdXJyZW50W29wZW5BY2NvcmRpb25JZF0uaXNWYWxpZCAmJiAhaXNTdGVwUnVsZUluUmVhZE9ubHlWaWV3W2lkXSAmJiBpc09wZW4pIHsKICAgICAgICBvcGVuQ2xvc2VBY2NvcmRpb24oaWQpOwogICAgICB9CiAgICB9CiAgfSwgW2lzU3RlcFJ1bGVJblJlYWRPbmx5Vmlldywgb3BlbkFjY29yZGlvbklkLCBzdGVwc0RhdGFdKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzCgogIHZhciBtYW5hZ2VJc0VkaXRhYmxlID0gKDAsIF9yZWFjdC51c2VDYWxsYmFjaykoCiAgLyojX19QVVJFX18qLwogIGZ1bmN0aW9uICgpIHsKICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAvKiNfX1BVUkVfXyovCiAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGlkKSB7CiAgICAgIHZhciBfc3RlcHNGb3JtJGN1cnJlbnQkb3A7CgogICAgICB2YXIgYWN0aXZlRm9ybSwgX29iamVjdFNwcmVhZDQ7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIChfc3RlcHNGb3JtJGN1cnJlbnQkb3AgPSBzdGVwc0Zvcm0uY3VycmVudFtvcGVuQWNjb3JkaW9uSWRdKSA9PT0gbnVsbCB8fCBfc3RlcHNGb3JtJGN1cnJlbnQkb3AgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zdGVwc0Zvcm0kY3VycmVudCRvcC5zdWJtaXQoKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBhY3RpdmVGb3JtID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgaWYgKGFjdGl2ZUZvcm0gIT0gbnVsbCAmJiAoYWN0aXZlRm9ybSA9PT0gbnVsbCB8fCBhY3RpdmVGb3JtID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhY3RpdmVGb3JtLmlzVmFsaWQpKSB7CiAgICAgICAgICAgICAgICBzdGVwc0RhdGEuY3VycmVudFtvcGVuQWNjb3JkaW9uSWRdID0gX29iamVjdFNwcmVhZCh7fSwgc3RlcHNEYXRhLmN1cnJlbnRbb3BlbkFjY29yZGlvbklkXSwgewogICAgICAgICAgICAgICAgICBkYXRhOiBhY3RpdmVGb3JtLmRhdGEsCiAgICAgICAgICAgICAgICAgIGlzVmFsaWQ6IGFjdGl2ZUZvcm0uaXNWYWxpZAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBzZXRPcGVuQWNjb3JkaW9uSWQoaWQpOwogICAgICAgICAgICAgICAgc2V0SXNTdGVwUnVsZUluRWRpdFZpZXcoX29iamVjdFNwcmVhZCh7fSwgaXNTdGVwUnVsZUluUmVhZE9ubHlWaWV3LCAoX29iamVjdFNwcmVhZDQgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9vYmplY3RTcHJlYWQ0LCBvcGVuQWNjb3JkaW9uSWQsIHRydWUpLCBfZGVmaW5lUHJvcGVydHkoX29iamVjdFNwcmVhZDQsIGlkLCBmYWxzZSksIF9vYmplY3RTcHJlYWQ0KSkpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSk7CgogICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfTsKICB9KCksIFtpc1N0ZXBSdWxlSW5SZWFkT25seVZpZXcsIG9wZW5BY2NvcmRpb25JZF0pOwoKICBpZiAoaXNTYXZlZCkgewogICAgdmFyIHJ1bGVOYW1lID0gc3RlcHNEYXRhLmN1cnJlbnRbX3R5cGVzLlJ1bGVTdGVwLmFib3V0UnVsZV0uZGF0YS5uYW1lOwogICAgKDAsIF90b2FzdGVycy5kaXNwbGF5U3VjY2Vzc1RvYXN0KShpMThuLlNVQ0NFU1NGVUxMWV9DUkVBVEVEX1JVTEVTKHJ1bGVOYW1lKSwgZGlzcGF0Y2hUb2FzdGVyKTsKICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdFJvdXRlckRvbS5SZWRpcmVjdCwgewogICAgICB0bzogIi8iLmNvbmNhdChfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZS5ERVRFQ1RJT05fRU5HSU5FX1BBR0VfTkFNRSwgIi9ydWxlcyIpCiAgICB9KTsKICB9CgogIGlmICgoMCwgX2hlbHBlcnMucmVkaXJlY3RUb0RldGVjdGlvbnMpKGlzU2lnbmFsSW5kZXhFeGlzdHMsIGlzQXV0aGVudGljYXRlZCwgaGFzRW5jcnlwdGlvbktleSkpIHsKICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdFJvdXRlckRvbS5SZWRpcmVjdCwgewogICAgICB0bzogIi8iLmNvbmNhdChfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZS5ERVRFQ1RJT05fRU5HSU5FX1BBR0VfTkFNRSkKICAgIH0pOwogIH0gZWxzZSBpZiAoKDAsIF9oZWxwZXJzLnVzZXJIYXNOb1Blcm1pc3Npb25zKShjYW5Vc2VyQ1JVRCkpIHsKICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdFJvdXRlckRvbS5SZWRpcmVjdCwgewogICAgICB0bzogIi8iLmNvbmNhdChfcmVkaXJlY3RfdG9fZGV0ZWN0aW9uX2VuZ2luZS5ERVRFQ1RJT05fRU5HSU5FX1BBR0VfTkFNRSwgIi9ydWxlcyIpCiAgICB9KTsKICB9CgogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5kZWZhdWx0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF93cmFwcGVyX3BhZ2UuV3JhcHBlclBhZ2UsIHsKICAgIHJlc3RyaWN0V2lkdGg6IHRydWUKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9kZXRlY3Rpb25fZW5naW5lX2hlYWRlcl9wYWdlLkRldGVjdGlvbkVuZ2luZUhlYWRlclBhZ2UsIHsKICAgIGJhY2tPcHRpb25zOiB7CiAgICAgIGhyZWY6ICcjZGV0ZWN0aW9ucy9ydWxlcycsCiAgICAgIHRleHQ6IGkxOG4uQkFDS19UT19SVUxFUwogICAgfSwKICAgIGJvcmRlcjogdHJ1ZSwKICAgIGlzTG9hZGluZzogaXNMb2FkaW5nIHx8IGxvYWRpbmcsCiAgICB0aXRsZTogaTE4bi5QQUdFX1RJVExFCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTXlFdWlQYW5lbCwgewogICAgemluZGV4OiA0CiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChTdGVwRGVmaW5lUnVsZUFjY29yZGlvbiwgewogICAgaW5pdGlhbElzT3BlbjogdHJ1ZSwKICAgIGlkOiBfdHlwZXMuUnVsZVN0ZXAuZGVmaW5lUnVsZSwKICAgIGJ1dHRvbkNvbnRlbnQ6IGRlZmluZVJ1bGVCdXR0b24sCiAgICBwYWRkaW5nU2l6ZTogInhzIiwKICAgIHJlZjogZGVmaW5lUnVsZVJlZiwKICAgIG9uVG9nZ2xlOiBtYW5hZ2VBY2NvcmRpb25zLmJpbmQobnVsbCwgX3R5cGVzLlJ1bGVTdGVwLmRlZmluZVJ1bGUpLAogICAgZXh0cmFBY3Rpb246IHN0ZXBzRGF0YS5jdXJyZW50W190eXBlcy5SdWxlU3RlcC5kZWZpbmVSdWxlXS5pc1ZhbGlkICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25FbXB0eSwgewogICAgICBpY29uVHlwZTogInBlbmNpbCIsCiAgICAgIHNpemU6ICJ4cyIsCiAgICAgIG9uQ2xpY2s6IG1hbmFnZUlzRWRpdGFibGUuYmluZChudWxsLCBfdHlwZXMuUnVsZVN0ZXAuZGVmaW5lUnVsZSkKICAgIH0sIGkxOG4uRURJVF9SVUxFKQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlIb3Jpem9udGFsUnVsZSwgewogICAgbWFyZ2luOiAibSIKICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc3RlcF9kZWZpbmVfcnVsZS5TdGVwRGVmaW5lUnVsZSwgewogICAgYWRkUGFkZGluZzogdHJ1ZSwKICAgIGRlZmF1bHRWYWx1ZXM6IChfcmVmMiA9IHN0ZXBzRGF0YS5jdXJyZW50W190eXBlcy5SdWxlU3RlcC5kZWZpbmVSdWxlXS5kYXRhKSAhPT0gbnVsbCAmJiBfcmVmMiAhPT0gdm9pZCAwID8gX3JlZjIgOiBudWxsLAogICAgaXNSZWFkT25seVZpZXc6IGlzU3RlcFJ1bGVJblJlYWRPbmx5Vmlld1tfdHlwZXMuUnVsZVN0ZXAuZGVmaW5lUnVsZV0sCiAgICBpc0xvYWRpbmc6IGlzTG9hZGluZyB8fCBsb2FkaW5nLAogICAgc2V0Rm9ybTogc2V0U3RlcHNGb3JtLAogICAgc2V0U3RlcERhdGE6IHNldFN0ZXBEYXRhLAogICAgZGVzY3JpcHRpb25Db2x1bW5zOiAic2luZ2xlU3BsaXQiCiAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgc2l6ZTogImwiCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTXlFdWlQYW5lbCwgewogICAgemluZGV4OiAzCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUFjY29yZGlvbiwgewogICAgaW5pdGlhbElzT3BlbjogZmFsc2UsCiAgICBpZDogX3R5cGVzLlJ1bGVTdGVwLmFib3V0UnVsZSwKICAgIGJ1dHRvbkNvbnRlbnQ6IGFib3V0UnVsZUJ1dHRvbiwKICAgIHBhZGRpbmdTaXplOiAieHMiLAogICAgcmVmOiBhYm91dFJ1bGVSZWYsCiAgICBvblRvZ2dsZTogbWFuYWdlQWNjb3JkaW9ucy5iaW5kKG51bGwsIF90eXBlcy5SdWxlU3RlcC5hYm91dFJ1bGUpLAogICAgZXh0cmFBY3Rpb246IHN0ZXBzRGF0YS5jdXJyZW50W190eXBlcy5SdWxlU3RlcC5hYm91dFJ1bGVdLmlzVmFsaWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkVtcHR5LCB7CiAgICAgIGljb25UeXBlOiAicGVuY2lsIiwKICAgICAgc2l6ZTogInhzIiwKICAgICAgb25DbGljazogbWFuYWdlSXNFZGl0YWJsZS5iaW5kKG51bGwsIF90eXBlcy5SdWxlU3RlcC5hYm91dFJ1bGUpCiAgICB9LCBpMThuLkVESVRfUlVMRSkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSG9yaXpvbnRhbFJ1bGUsIHsKICAgIG1hcmdpbjogIm0iCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3N0ZXBfYWJvdXRfcnVsZS5TdGVwQWJvdXRSdWxlLCB7CiAgICBhZGRQYWRkaW5nOiB0cnVlLAogICAgZGVmYXVsdFZhbHVlczogKF9yZWYzID0gc3RlcHNEYXRhLmN1cnJlbnRbX3R5cGVzLlJ1bGVTdGVwLmFib3V0UnVsZV0uZGF0YSkgIT09IG51bGwgJiYgX3JlZjMgIT09IHZvaWQgMCA/IF9yZWYzIDogbnVsbCwKICAgIGRlc2NyaXB0aW9uQ29sdW1uczogInNpbmdsZVNwbGl0IiwKICAgIGlzUmVhZE9ubHlWaWV3OiBpc1N0ZXBSdWxlSW5SZWFkT25seVZpZXdbX3R5cGVzLlJ1bGVTdGVwLmFib3V0UnVsZV0sCiAgICBpc0xvYWRpbmc6IGlzTG9hZGluZyB8fCBsb2FkaW5nLAogICAgc2V0Rm9ybTogc2V0U3RlcHNGb3JtLAogICAgc2V0U3RlcERhdGE6IHNldFN0ZXBEYXRhCiAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgc2l6ZTogImwiCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTXlFdWlQYW5lbCwgewogICAgemluZGV4OiAyCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUFjY29yZGlvbiwgewogICAgaW5pdGlhbElzT3BlbjogZmFsc2UsCiAgICBpZDogX3R5cGVzLlJ1bGVTdGVwLnNjaGVkdWxlUnVsZSwKICAgIGJ1dHRvbkNvbnRlbnQ6IHNjaGVkdWxlUnVsZUJ1dHRvbiwKICAgIHBhZGRpbmdTaXplOiAieHMiLAogICAgcmVmOiBzY2hlZHVsZVJ1bGVSZWYsCiAgICBvblRvZ2dsZTogbWFuYWdlQWNjb3JkaW9ucy5iaW5kKG51bGwsIF90eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGUpLAogICAgZXh0cmFBY3Rpb246IHN0ZXBzRGF0YS5jdXJyZW50W190eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGVdLmlzVmFsaWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUJ1dHRvbkVtcHR5LCB7CiAgICAgIGljb25UeXBlOiAicGVuY2lsIiwKICAgICAgc2l6ZTogInhzIiwKICAgICAgb25DbGljazogbWFuYWdlSXNFZGl0YWJsZS5iaW5kKG51bGwsIF90eXBlcy5SdWxlU3RlcC5zY2hlZHVsZVJ1bGUpCiAgICB9LCBpMThuLkVESVRfUlVMRSkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSG9yaXpvbnRhbFJ1bGUsIHsKICAgIG1hcmdpbjogIm0iCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3N0ZXBfc2NoZWR1bGVfcnVsZS5TdGVwU2NoZWR1bGVSdWxlLCB7CiAgICBhZGRQYWRkaW5nOiB0cnVlLAogICAgZGVmYXVsdFZhbHVlczogKF9yZWY0ID0gc3RlcHNEYXRhLmN1cnJlbnRbX3R5cGVzLlJ1bGVTdGVwLnNjaGVkdWxlUnVsZV0uZGF0YSkgIT09IG51bGwgJiYgX3JlZjQgIT09IHZvaWQgMCA/IF9yZWY0IDogbnVsbCwKICAgIGRlc2NyaXB0aW9uQ29sdW1uczogInNpbmdsZVNwbGl0IiwKICAgIGlzUmVhZE9ubHlWaWV3OiBpc1N0ZXBSdWxlSW5SZWFkT25seVZpZXdbX3R5cGVzLlJ1bGVTdGVwLnNjaGVkdWxlUnVsZV0sCiAgICBpc0xvYWRpbmc6IGlzTG9hZGluZyB8fCBsb2FkaW5nLAogICAgc2V0Rm9ybTogc2V0U3RlcHNGb3JtLAogICAgc2V0U3RlcERhdGE6IHNldFN0ZXBEYXRhCiAgfSkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVNwYWNlciwgewogICAgc2l6ZTogImwiCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTXlFdWlQYW5lbCwgewogICAgemluZGV4OiAxCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUFjY29yZGlvbiwgewogICAgaW5pdGlhbElzT3BlbjogZmFsc2UsCiAgICBpZDogX3R5cGVzLlJ1bGVTdGVwLnJ1bGVBY3Rpb25zLAogICAgYnV0dG9uQ29udGVudDogcnVsZUFjdGlvbnNCdXR0b24sCiAgICBwYWRkaW5nU2l6ZTogInhzIiwKICAgIHJlZjogcnVsZUFjdGlvbnNSZWYsCiAgICBvblRvZ2dsZTogbWFuYWdlQWNjb3JkaW9ucy5iaW5kKG51bGwsIF90eXBlcy5SdWxlU3RlcC5ydWxlQWN0aW9ucyksCiAgICBleHRyYUFjdGlvbjogc3RlcHNEYXRhLmN1cnJlbnRbX3R5cGVzLlJ1bGVTdGVwLnJ1bGVBY3Rpb25zXS5pc1ZhbGlkICYmIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25FbXB0eSwgewogICAgICBpY29uVHlwZTogInBlbmNpbCIsCiAgICAgIHNpemU6ICJ4cyIsCiAgICAgIG9uQ2xpY2s6IG1hbmFnZUlzRWRpdGFibGUuYmluZChudWxsLCBfdHlwZXMuUnVsZVN0ZXAucnVsZUFjdGlvbnMpCiAgICB9LCBpMThuLkVESVRfUlVMRSkKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSG9yaXpvbnRhbFJ1bGUsIHsKICAgIG1hcmdpbjogIm0iCiAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3N0ZXBfcnVsZV9hY3Rpb25zLlN0ZXBSdWxlQWN0aW9ucywgewogICAgYWRkUGFkZGluZzogdHJ1ZSwKICAgIGlzUmVhZE9ubHlWaWV3OiBpc1N0ZXBSdWxlSW5SZWFkT25seVZpZXdbX3R5cGVzLlJ1bGVTdGVwLnJ1bGVBY3Rpb25zXSwKICAgIGlzTG9hZGluZzogaXNMb2FkaW5nIHx8IGxvYWRpbmcsCiAgICBzZXRGb3JtOiBzZXRTdGVwc0Zvcm0sCiAgICBzZXRTdGVwRGF0YTogc2V0U3RlcERhdGEsCiAgICBhY3Rpb25NZXNzYWdlUGFyYW1zOiBhY3Rpb25NZXNzYWdlUGFyYW1zCiAgfSkpKSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NweV9yb3V0ZXMuU3B5Um91dGUsIG51bGwpKTsKfTsKCnZhciBDcmVhdGVSdWxlUGFnZSA9IF9yZWFjdC5kZWZhdWx0Lm1lbW8oQ3JlYXRlUnVsZVBhZ2VDb21wb25lbnQpOwoKZXhwb3J0cy5DcmVhdGVSdWxlUGFnZSA9IENyZWF0ZVJ1bGVQYWdlOw=="},null]}