{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/monitoring/public/components/cluster/listing/listing.js","dependencies":[{"path":"x-pack/legacy/plugins/monitoring/public/components/cluster/listing/listing.js","mtime":1589249552516},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkxpc3RpbmcgPSB2b2lkIDA7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX2Nocm9tZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicGx1Z2lucy9tb25pdG9yaW5nL25wX2ltcG9ydHMvdWkvY2hyb21lIikpOwoKdmFyIF9tb21lbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm1vbWVudCIpKTsKCnZhciBfbnVtZXJhbCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQGVsYXN0aWMvbnVtZXJhbCIpKTsKCnZhciBfbG9kYXNoID0gcmVxdWlyZSgibG9kYXNoIik7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9ub3RpZnkgPSByZXF1aXJlKCJ1aS9ub3RpZnkiKTsKCnZhciBfdGFibGUgPSByZXF1aXJlKCJwbHVnaW5zL21vbml0b3JpbmcvY29tcG9uZW50cy90YWJsZSIpOwoKdmFyIF9hbGVydHNfaW5kaWNhdG9yID0gcmVxdWlyZSgicGx1Z2lucy9tb25pdG9yaW5nL2NvbXBvbmVudHMvY2x1c3Rlci9saXN0aW5nL2FsZXJ0c19pbmRpY2F0b3IiKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2kxOG4gPSByZXF1aXJlKCJAa2JuL2kxOG4iKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3BsdWdpbnMva2liYW5hX3JlYWN0L3B1YmxpYyIpOwoKdmFyIF9jb25zdGFudHMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi9jb21tb24vY29uc3RhbnRzIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgeyB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7IH0gZWxzZSB7IG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKdmFyIElzQ2x1c3RlclN1cHBvcnRlZCA9IGZ1bmN0aW9uIElzQ2x1c3RlclN1cHBvcnRlZChfcmVmKSB7CiAgdmFyIGlzU3VwcG9ydGVkID0gX3JlZi5pc1N1cHBvcnRlZCwKICAgICAgY2hpbGRyZW4gPSBfcmVmLmNoaWxkcmVuOwogIHJldHVybiBpc1N1cHBvcnRlZCA/IGNoaWxkcmVuIDogJy0nOwp9OwoKdmFyIFNUQU5EQUxPTkVfQ0xVU1RFUl9TVE9SQUdFX0tFWSA9ICd2aWV3ZWRTdGFuZGFsb25lQ2x1c3Rlcic7Ci8qCiAqIFRoaXMgY2hlY2tzIGlmIGFsZXJ0cyBmZWF0dXJlIGlzIHN1cHBvcnRlZCB2aWEgbW9uaXRvcmluZyBjbHVzdGVyCiAqIGxpY2Vuc2UuIElmIHRoZSBhbGVydHMgZmVhdHVyZSBpcyBub3Qgc3VwcG9ydGVkIGJlY2F1c2UgdGhlIHByb2QgY2x1c3RlcgogKiBsaWNlbnNlIGlzIGJhc2ljLCBJc0NsdXN0ZXJTdXBwb3J0ZWQgbWFrZXMgdGhlIHN0YXR1cyBjb2wgaGlkZGVuCiAqIGNvbXBsZXRlbHkKICovCgp2YXIgSXNBbGVydHNTdXBwb3J0ZWQgPSBmdW5jdGlvbiBJc0FsZXJ0c1N1cHBvcnRlZChwcm9wcykgewogIHZhciBfcHJvcHMkY2x1c3RlciRhbGVydHMgPSBwcm9wcy5jbHVzdGVyLmFsZXJ0cywKICAgICAgX3Byb3BzJGNsdXN0ZXIkYWxlcnRzMiA9IF9wcm9wcyRjbHVzdGVyJGFsZXJ0cy5hbGVydHNNZXRhLAogICAgICBhbGVydHNNZXRhID0gX3Byb3BzJGNsdXN0ZXIkYWxlcnRzMiA9PT0gdm9pZCAwID8gewogICAgZW5hYmxlZDogdHJ1ZQogIH0gOiBfcHJvcHMkY2x1c3RlciRhbGVydHMyLAogICAgICBfcHJvcHMkY2x1c3RlciRhbGVydHMzID0gX3Byb3BzJGNsdXN0ZXIkYWxlcnRzLmNsdXN0ZXJNZXRhLAogICAgICBjbHVzdGVyTWV0YSA9IF9wcm9wcyRjbHVzdGVyJGFsZXJ0czMgPT09IHZvaWQgMCA/IHsKICAgIGVuYWJsZWQ6IHRydWUKICB9IDogX3Byb3BzJGNsdXN0ZXIkYWxlcnRzMzsKCiAgaWYgKGFsZXJ0c01ldGEuZW5hYmxlZCAmJiBjbHVzdGVyTWV0YS5lbmFibGVkKSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsIHByb3BzLmNoaWxkcmVuKTsKICB9CgogIHZhciBtZXNzYWdlID0gYWxlcnRzTWV0YS5tZXNzYWdlIHx8IGNsdXN0ZXJNZXRhLm1lc3NhZ2UgfHwgX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1vbml0b3JpbmcuY2x1c3Rlci5saXN0aW5nLnVua25vd25IZWFsdGhNZXNzYWdlJywgewogICAgZGVmYXVsdE1lc3NhZ2U6ICdVbmtub3duJwogIH0pOwoKICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRvb2xUaXAsIHsKICAgIGNvbnRlbnQ6IG1lc3NhZ2UsCiAgICBwb3NpdGlvbjogImJvdHRvbSIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpSGVhbHRoLCB7CiAgICBjb2xvcjogInN1YmR1ZWQiLAogICAgImRhdGEtdGVzdC1zdWJqIjogImFsZXJ0SWNvbiIKICB9LCAiTi9BIikpOwp9OwoKdmFyIGdldENvbHVtbnMgPSBmdW5jdGlvbiBnZXRDb2x1bW5zKHNob3dMaWNlbnNlRXhwaXJhdGlvbiwgY2hhbmdlQ2x1c3RlciwgaGFuZGxlQ2xpY2tJbmNvbXBhdGlibGVMaWNlbnNlLCBoYW5kbGVDbGlja0ludmFsaWRMaWNlbnNlKSB7CiAgcmV0dXJuIFt7CiAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subW9uaXRvcmluZy5jbHVzdGVyLmxpc3RpbmcubmFtZUNvbHVtblRpdGxlJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ05hbWUnCiAgICB9KSwKICAgIGZpZWxkOiAnY2x1c3Rlcl9uYW1lJywKICAgIHNvcnRhYmxlOiB0cnVlLAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIodmFsdWUsIGNsdXN0ZXIpIHsKICAgICAgaWYgKGNsdXN0ZXIuaXNTdXBwb3J0ZWQpIHsKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICAgIHJldHVybiBjaGFuZ2VDbHVzdGVyKGNsdXN0ZXIuY2x1c3Rlcl91dWlkLCBjbHVzdGVyLmNjcyk7CiAgICAgICAgICB9LAogICAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogImNsdXN0ZXJMaW5rIgogICAgICAgIH0sIHZhbHVlKTsKICAgICAgfSAvLyBub3Qgc3VwcG9ydGVkIGJlY2F1c2UgbGljZW5zZSBpcyBiYXNpYy9ub3QgY29tcGF0aWJsZSB3aXRoIG11bHRpLWNsdXN0ZXIKCgogICAgICBpZiAoY2x1c3Rlci5saWNlbnNlKSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgICByZXR1cm4gaGFuZGxlQ2xpY2tJbmNvbXBhdGlibGVMaWNlbnNlKGNsdXN0ZXIuY2x1c3Rlcl9uYW1lKTsKICAgICAgICAgIH0sCiAgICAgICAgICAiZGF0YS10ZXN0LXN1YmoiOiAiY2x1c3RlckxpbmsiCiAgICAgICAgfSwgdmFsdWUpOwogICAgICB9IC8vIG5vdCBzdXBwb3J0ZWQgYmVjYXVzZSBsaWNlbnNlIGlzIGludmFsaWQKCgogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIGhhbmRsZUNsaWNrSW52YWxpZExpY2Vuc2UoY2x1c3Rlci5jbHVzdGVyX25hbWUpOwogICAgICAgIH0sCiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogImNsdXN0ZXJMaW5rIgogICAgICB9LCB2YWx1ZSk7CiAgICB9CiAgfSwgewogICAgbmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1vbml0b3JpbmcuY2x1c3Rlci5saXN0aW5nLnN0YXR1c0NvbHVtblRpdGxlJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ1N0YXR1cycKICAgIH0pLAogICAgZmllbGQ6ICdzdGF0dXMnLAogICAgJ2RhdGEtdGVzdC1zdWJqJzogJ2FsZXJ0c1N0YXR1cycsCiAgICBzb3J0YWJsZTogdHJ1ZSwKICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKF9zdGF0dXMsIGNsdXN0ZXIpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoSXNDbHVzdGVyU3VwcG9ydGVkLCBjbHVzdGVyLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KElzQWxlcnRzU3VwcG9ydGVkLCB7CiAgICAgICAgY2x1c3RlcjogY2x1c3RlcgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9hbGVydHNfaW5kaWNhdG9yLkFsZXJ0c0luZGljYXRvciwgewogICAgICAgIGFsZXJ0czogY2x1c3Rlci5hbGVydHMKICAgICAgfSkpKTsKICAgIH0KICB9LCB7CiAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subW9uaXRvcmluZy5jbHVzdGVyLmxpc3Rpbmcubm9kZXNDb2x1bW5UaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdOb2RlcycKICAgIH0pLAogICAgZmllbGQ6ICdlbGFzdGljc2VhcmNoLmNsdXN0ZXJfc3RhdHMubm9kZXMuY291bnQudG90YWwnLAogICAgJ2RhdGEtdGVzdC1zdWJqJzogJ25vZGVzQ291bnQnLAogICAgc29ydGFibGU6IHRydWUsCiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcih0b3RhbCwgY2x1c3RlcikgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChJc0NsdXN0ZXJTdXBwb3J0ZWQsIGNsdXN0ZXIsICgwLCBfbnVtZXJhbC5kZWZhdWx0KSh0b3RhbCkuZm9ybWF0KCcwLDAnKSk7CiAgICB9CiAgfSwgewogICAgbmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1vbml0b3JpbmcuY2x1c3Rlci5saXN0aW5nLmluZGljZXNDb2x1bW5UaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdJbmRpY2VzJwogICAgfSksCiAgICBmaWVsZDogJ2VsYXN0aWNzZWFyY2guY2x1c3Rlcl9zdGF0cy5pbmRpY2VzLmNvdW50JywKICAgICdkYXRhLXRlc3Qtc3Viaic6ICdpbmRpY2VzQ291bnQnLAogICAgc29ydGFibGU6IHRydWUsCiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihjb3VudCwgY2x1c3RlcikgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChJc0NsdXN0ZXJTdXBwb3J0ZWQsIGNsdXN0ZXIsICgwLCBfbnVtZXJhbC5kZWZhdWx0KShjb3VudCkuZm9ybWF0KCcwLDAnKSk7CiAgICB9CiAgfSwgewogICAgbmFtZTogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1vbml0b3JpbmcuY2x1c3Rlci5saXN0aW5nLmRhdGFDb2x1bW5UaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdEYXRhJwogICAgfSksCiAgICBmaWVsZDogJ2VsYXN0aWNzZWFyY2guY2x1c3Rlcl9zdGF0cy5pbmRpY2VzLnN0b3JlLnNpemVfaW5fYnl0ZXMnLAogICAgJ2RhdGEtdGVzdC1zdWJqJzogJ2RhdGFTaXplJywKICAgIHNvcnRhYmxlOiB0cnVlLAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoc2l6ZSwgY2x1c3RlcikgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChJc0NsdXN0ZXJTdXBwb3J0ZWQsIGNsdXN0ZXIsICgwLCBfbnVtZXJhbC5kZWZhdWx0KShzaXplKS5mb3JtYXQoJzAsMFsuXTAgYicpKTsKICAgIH0KICB9LCB7CiAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subW9uaXRvcmluZy5jbHVzdGVyLmxpc3RpbmcubG9nc3Rhc2hDb2x1bW5UaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdMb2dzdGFzaCcKICAgIH0pLAogICAgZmllbGQ6ICdsb2dzdGFzaC5ub2RlX2NvdW50JywKICAgICdkYXRhLXRlc3Qtc3Viaic6ICdsb2dzdGFzaENvdW50JywKICAgIHNvcnRhYmxlOiB0cnVlLAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoY291bnQsIGNsdXN0ZXIpIHsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoSXNDbHVzdGVyU3VwcG9ydGVkLCBjbHVzdGVyLCAoMCwgX251bWVyYWwuZGVmYXVsdCkoY291bnQpLmZvcm1hdCgnMCwwJykpOwogICAgfQogIH0sIHsKICAgIG5hbWU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tb25pdG9yaW5nLmNsdXN0ZXIubGlzdGluZy5raWJhbmFDb2x1bW5UaXRsZScsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdLaWJhbmEnCiAgICB9KSwKICAgIGZpZWxkOiAna2liYW5hLmNvdW50JywKICAgICdkYXRhLXRlc3Qtc3Viaic6ICdraWJhbmFDb3VudCcsCiAgICBzb3J0YWJsZTogdHJ1ZSwKICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGNvdW50LCBjbHVzdGVyKSB7CiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KElzQ2x1c3RlclN1cHBvcnRlZCwgY2x1c3RlciwgKDAsIF9udW1lcmFsLmRlZmF1bHQpKGNvdW50KS5mb3JtYXQoJzAsMCcpKTsKICAgIH0KICB9LCB7CiAgICBuYW1lOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subW9uaXRvcmluZy5jbHVzdGVyLmxpc3RpbmcubGljZW5zZUNvbHVtblRpdGxlJywgewogICAgICBkZWZhdWx0TWVzc2FnZTogJ0xpY2Vuc2UnCiAgICB9KSwKICAgIGZpZWxkOiAnbGljZW5zZS50eXBlJywKICAgICdkYXRhLXRlc3Qtc3Viaic6ICdjbHVzdGVyTGljZW5zZScsCiAgICBzb3J0YWJsZTogdHJ1ZSwKICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGxpY2Vuc2VUeXBlLCBjbHVzdGVyKSB7CiAgICAgIHZhciBsaWNlbnNlID0gY2x1c3Rlci5saWNlbnNlOwoKICAgICAgaWYgKCFsaWNlbnNlVHlwZSkgewogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJtb25UYWJsZUNlbGxfX2NsdXN0ZXJDZWxsTGlzY2Vuc2UiCiAgICAgICAgfSwgIk4vQSIpKTsKICAgICAgfQoKICAgICAgaWYgKGxpY2Vuc2UpIHsKICAgICAgICB2YXIgbGljZW5zZUV4cGlyeSA9IGZ1bmN0aW9uIGxpY2Vuc2VFeHBpcnkoKSB7CiAgICAgICAgICBpZiAobGljZW5zZS5leHBpcnlfZGF0ZV9pbl9taWxsaXMgPCAoMCwgX21vbWVudC5kZWZhdWx0KSgpLnZhbHVlT2YoKSkgewogICAgICAgICAgICAvLyBsaWNlbnNlIGlzIGV4cGlyZWQKICAgICAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgICAgICAgY2xhc3NOYW1lOiAibW9uVGFibGVDZWxsX19jbHVzdGVyQ2VsbEV4cGlyZWQiCiAgICAgICAgICAgIH0sICJFeHBpcmVkIik7CiAgICAgICAgICB9IC8vIGxpY2Vuc2UgaXMgZmluZQoKCiAgICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsICJFeHBpcmVzICIsICgwLCBfbW9tZW50LmRlZmF1bHQpKGxpY2Vuc2UuZXhwaXJ5X2RhdGVfaW5fbWlsbGlzKS5mb3JtYXQoJ0QgTU1NIFlZJykpOwogICAgICAgIH07CgogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJtb25UYWJsZUNlbGxfX2NsdXN0ZXJDZWxsTGlzY2Vuc2UiCiAgICAgICAgfSwgKDAsIF9sb2Rhc2guY2FwaXRhbGl6ZSkobGljZW5zZVR5cGUpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgICAgY2xhc3NOYW1lOiAibW9uVGFibGVDZWxsX19jbHVzdGVyQ2VsbEV4cGlyYXRpb24iCiAgICAgICAgfSwgc2hvd0xpY2Vuc2VFeHBpcmF0aW9uID8gbGljZW5zZUV4cGlyeSgpIDogbnVsbCkpOwogICAgICB9IC8vIHRoZXJlIGlzIG5vIGxpY2Vuc2UhCgoKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgIHJldHVybiBoYW5kbGVDbGlja0ludmFsaWRMaWNlbnNlKGNsdXN0ZXIuY2x1c3Rlcl9uYW1lKTsKICAgICAgICB9CiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlIZWFsdGgsIHsKICAgICAgICBjb2xvcjogInN1YmR1ZWQiLAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJhbGVydEljb24iCiAgICAgIH0sICJOL0EiKSk7CiAgICB9CiAgfV07Cn07Cgp2YXIgY2hhbmdlQ2x1c3RlciA9IGZ1bmN0aW9uIGNoYW5nZUNsdXN0ZXIoc2NvcGUsIGdsb2JhbFN0YXRlLCBrYm5VcmwsIGNsdXN0ZXJVdWlkLCBjY3MpIHsKICBzY29wZS4kZXZhbEFzeW5jKGZ1bmN0aW9uICgpIHsKICAgIGdsb2JhbFN0YXRlLmNsdXN0ZXJfdXVpZCA9IGNsdXN0ZXJVdWlkOwogICAgZ2xvYmFsU3RhdGUuY2NzID0gY2NzOwogICAgZ2xvYmFsU3RhdGUuc2F2ZSgpOwogICAga2JuVXJsLmNoYW5nZVBhdGgoJy9vdmVydmlldycpOwogIH0pOwp9OwoKdmFyIGxpY2Vuc2VXYXJuaW5nID0gZnVuY3Rpb24gbGljZW5zZVdhcm5pbmcoc2NvcGUsIF9yZWYyKSB7CiAgdmFyIHRpdGxlID0gX3JlZjIudGl0bGUsCiAgICAgIHRleHQgPSBfcmVmMi50ZXh0OwogIHNjb3BlLiRldmFsQXN5bmMoZnVuY3Rpb24gKCkgewogICAgX25vdGlmeS50b2FzdE5vdGlmaWNhdGlvbnMuYWRkV2FybmluZyh7CiAgICAgIHRpdGxlOiB0aXRsZSwKICAgICAgdGV4dDogdGV4dCwKICAgICAgJ2RhdGEtdGVzdC1zdWJqJzogJ21vbml0b3JpbmdMaWNlbnNlV2FybmluZycKICAgIH0pOwogIH0pOwp9OwoKdmFyIGhhbmRsZUNsaWNrSW5jb21wYXRpYmxlTGljZW5zZSA9IGZ1bmN0aW9uIGhhbmRsZUNsaWNrSW5jb21wYXRpYmxlTGljZW5zZShzY29wZSwgY2x1c3Rlck5hbWUpIHsKICBsaWNlbnNlV2FybmluZyhzY29wZSwgewogICAgdGl0bGU6ICgwLCBfcHVibGljLnRvTW91bnRQb2ludCkoX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgaWQ6ICJ4cGFjay5tb25pdG9yaW5nLmNsdXN0ZXIubGlzdGluZy5pbmNvbXBhdGlibGVMaWNlbnNlLndhcm5pbmdNZXNzYWdlVGl0bGUiLAogICAgICBkZWZhdWx0TWVzc2FnZTogIllvdSBjYW4ndCB2aWV3IHRoZSB7Y2x1c3Rlck5hbWV9IGNsdXN0ZXIiLAogICAgICB2YWx1ZXM6IHsKICAgICAgICBjbHVzdGVyTmFtZTogJyInICsgY2x1c3Rlck5hbWUgKyAnIicKICAgICAgfQogICAgfSkpLAogICAgdGV4dDogKDAsIF9wdWJsaWMudG9Nb3VudFBvaW50KShfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdC5GcmFnbWVudCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgIGlkOiAieHBhY2subW9uaXRvcmluZy5jbHVzdGVyLmxpc3RpbmcuaW5jb21wYXRpYmxlTGljZW5zZS5ub011bHRpQ2x1c3RlclN1cHBvcnRNZXNzYWdlIiwKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJUaGUgQmFzaWMgbGljZW5zZSBkb2VzIG5vdCBzdXBwb3J0IG11bHRpLWNsdXN0ZXIgbW9uaXRvcmluZy4iCiAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICBpZDogInhwYWNrLm1vbml0b3JpbmcuY2x1c3Rlci5saXN0aW5nLmluY29tcGF0aWJsZUxpY2Vuc2UuaW5mb01lc3NhZ2UiLAogICAgICBkZWZhdWx0TWVzc2FnZTogIk5lZWQgdG8gbW9uaXRvciBtdWx0aXBsZSBjbHVzdGVycz8ge2dldExpY2Vuc2VJbmZvTGlua30gdG8gZW5qb3kgbXVsdGktY2x1c3RlciBtb25pdG9yaW5nLiIsCiAgICAgIHZhbHVlczogewogICAgICAgIGdldExpY2Vuc2VJbmZvTGluazogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgIGhyZWY6ICJodHRwczovL3d3dy5lbGFzdGljLmNvL3N1YnNjcmlwdGlvbnMiLAogICAgICAgICAgdGFyZ2V0OiAiX2JsYW5rIgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLm1vbml0b3JpbmcuY2x1c3Rlci5saXN0aW5nLmluY29tcGF0aWJsZUxpY2Vuc2UuZ2V0TGljZW5zZUxpbmtMYWJlbCIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkdldCBhIGxpY2Vuc2Ugd2l0aCBmdWxsIGZ1bmN0aW9uYWxpdHkiCiAgICAgICAgfSkpCiAgICAgIH0KICAgIH0pKSkpCiAgfSk7Cn07Cgp2YXIgaGFuZGxlQ2xpY2tJbnZhbGlkTGljZW5zZSA9IGZ1bmN0aW9uIGhhbmRsZUNsaWNrSW52YWxpZExpY2Vuc2Uoc2NvcGUsIGNsdXN0ZXJOYW1lKSB7CiAgdmFyIGxpY2Vuc2luZ1BhdGggPSAiIi5jb25jYXQoX2Nocm9tZS5kZWZhdWx0LmdldEJhc2VQYXRoKCksICIvYXBwL2tpYmFuYSMvbWFuYWdlbWVudC9lbGFzdGljc2VhcmNoL2xpY2Vuc2VfbWFuYWdlbWVudC9ob21lIik7CiAgbGljZW5zZVdhcm5pbmcoc2NvcGUsIHsKICAgIHRpdGxlOiAoMCwgX3B1YmxpYy50b01vdW50UG9pbnQpKF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgIGlkOiAieHBhY2subW9uaXRvcmluZy5jbHVzdGVyLmxpc3RpbmcuaW52YWxpZExpY2Vuc2Uud2FybmluZ01lc3NhZ2VUaXRsZSIsCiAgICAgIGRlZmF1bHRNZXNzYWdlOiAiWW91IGNhbid0IHZpZXcgdGhlIHtjbHVzdGVyTmFtZX0gY2x1c3RlciIsCiAgICAgIHZhbHVlczogewogICAgICAgIGNsdXN0ZXJOYW1lOiAnIicgKyBjbHVzdGVyTmFtZSArICciJwogICAgICB9CiAgICB9KSksCiAgICB0ZXh0OiAoMCwgX3B1YmxpYy50b01vdW50UG9pbnQpKF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0LkZyYWdtZW50LCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgaWQ6ICJ4cGFjay5tb25pdG9yaW5nLmNsdXN0ZXIubGlzdGluZy5pbnZhbGlkTGljZW5zZS5pbnZhbGlkSW5mb01lc3NhZ2UiLAogICAgICBkZWZhdWx0TWVzc2FnZTogIlRoZSBsaWNlbnNlIGluZm9ybWF0aW9uIGlzIGludmFsaWQuIgogICAgfSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3QyLkZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgaWQ6ICJ4cGFjay5tb25pdG9yaW5nLmNsdXN0ZXIubGlzdGluZy5pbnZhbGlkTGljZW5zZS5pbmZvTWVzc2FnZSIsCiAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTmVlZCBhIGxpY2Vuc2U/IHtnZXRCYXNpY0xpY2Vuc2VMaW5rfSBvciB7Z2V0TGljZW5zZUluZm9MaW5rfSB0byBlbmpveSBtdWx0aS1jbHVzdGVyIG1vbml0b3JpbmcuIiwKICAgICAgdmFsdWVzOiB7CiAgICAgICAgZ2V0QmFzaWNMaWNlbnNlTGluazogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgIGhyZWY6IGxpY2Vuc2luZ1BhdGgKICAgICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJ4cGFjay5tb25pdG9yaW5nLmNsdXN0ZXIubGlzdGluZy5pbnZhbGlkTGljZW5zZS5nZXRCYXNpY0xpY2Vuc2VMaW5rTGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJHZXQgYSBmcmVlIEJhc2ljIGxpY2Vuc2UiCiAgICAgICAgfSkpLAogICAgICAgIGdldExpY2Vuc2VJbmZvTGluazogX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICAgIGhyZWY6ICJodHRwczovL3d3dy5lbGFzdGljLmNvL3N1YnNjcmlwdGlvbnMiLAogICAgICAgICAgdGFyZ2V0OiAiX2JsYW5rIgogICAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInhwYWNrLm1vbml0b3JpbmcuY2x1c3Rlci5saXN0aW5nLmludmFsaWRMaWNlbnNlLmdldExpY2Vuc2VMaW5rTGFiZWwiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJHZXQgYSBsaWNlbnNlIHdpdGggZnVsbCBmdW5jdGlvbmFsaXR5IgogICAgICAgIH0pKQogICAgICB9CiAgICB9KSkpKQogIH0pOwp9OwoKdmFyIExpc3RpbmcgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfQ29tcG9uZW50KSB7CiAgX2luaGVyaXRzKExpc3RpbmcsIF9Db21wb25lbnQpOwoKICBmdW5jdGlvbiBMaXN0aW5nKHByb3BzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpc3RpbmcpOwoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKExpc3RpbmcpLmNhbGwodGhpcywgcHJvcHMpKTsKICAgIF90aGlzLnN0YXRlID0gX2RlZmluZVByb3BlcnR5KHt9LCBTVEFOREFMT05FX0NMVVNURVJfU1RPUkFHRV9LRVksIGZhbHNlKTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhMaXN0aW5nLCBbewogICAga2V5OiAicmVuZGVyU3RhbmRhbG9uZUNsdXN0ZXJDYWxsb3V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJTdGFuZGFsb25lQ2x1c3RlckNhbGxvdXQoY2hhbmdlQ2x1c3Rlciwgc3RvcmFnZSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmIChzdG9yYWdlLmdldChTVEFOREFMT05FX0NMVVNURVJfU1RPUkFHRV9LRVkpKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpQ2FsbE91dCwgewogICAgICAgIGNvbG9yOiAid2FybmluZyIsCiAgICAgICAgdGl0bGU6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5tb25pdG9yaW5nLmNsdXN0ZXIubGlzdGluZy5zdGFuZGFsb25lQ2x1c3RlckNhbGxPdXRUaXRsZScsIHsKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiSXQgbG9va3MgbGlrZSB5b3UgaGF2ZSBpbnN0YW5jZXMgdGhhdCBhcmVuJ3QgY29ubmVjdGVkIHRvIGFuIEVsYXN0aWNzZWFyY2ggY2x1c3Rlci4iCiAgICAgICAgfSksCiAgICAgICAgaWNvblR5cGU6ICJsaW5rIgogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJwIiwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUxpbmssIHsKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIGNoYW5nZUNsdXN0ZXIoX2NvbnN0YW50cy5TVEFOREFMT05FX0NMVVNURVJfQ0xVU1RFUl9VVUlEKTsKICAgICAgICB9LAogICAgICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJzdGFuZGFsb25lQ2x1c3RlckxpbmsiCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5tb25pdG9yaW5nLmNsdXN0ZXIubGlzdGluZy5zdGFuZGFsb25lQ2x1c3RlckNhbGxPdXRMaW5rIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlZpZXcgdGhlc2UgaW5zdGFuY2VzLiIKICAgICAgfSkpLCAiXHhBMCIsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5tb25pdG9yaW5nLmNsdXN0ZXIubGlzdGluZy5zdGFuZGFsb25lQ2x1c3RlckNhbGxPdXRUZXh0IiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk9yLCBjbGljayBTdGFuZGFsb25lIENsdXN0ZXIgaW4gdGhlIHRhYmxlIGJlbG93IgogICAgICB9KSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInAiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpTGluaywgewogICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7CiAgICAgICAgICBzdG9yYWdlLnNldChTVEFOREFMT05FX0NMVVNURVJfU1RPUkFHRV9LRVksIHRydWUpOwoKICAgICAgICAgIF90aGlzMi5zZXRTdGF0ZShfZGVmaW5lUHJvcGVydHkoe30sIFNUQU5EQUxPTkVfQ0xVU1RFUl9TVE9SQUdFX0tFWSwgdHJ1ZSkpOwogICAgICAgIH0KICAgICAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUljb24sIHsKICAgICAgICB0eXBlOiAiY3Jvc3MiCiAgICAgIH0pLCAiXHhBMCIsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJ4cGFjay5tb25pdG9yaW5nLmNsdXN0ZXIubGlzdGluZy5zdGFuZGFsb25lQ2x1c3RlckNhbGxPdXREaXNtaXNzIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkRpc21pc3MiCiAgICAgIH0pKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpU3BhY2VyLCBudWxsKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IHRoaXMucHJvcHMsCiAgICAgICAgICBhbmd1bGFyID0gX3RoaXMkcHJvcHMuYW5ndWxhciwKICAgICAgICAgIGNsdXN0ZXJzID0gX3RoaXMkcHJvcHMuY2x1c3RlcnMsCiAgICAgICAgICBzb3J0aW5nID0gX3RoaXMkcHJvcHMuc29ydGluZywKICAgICAgICAgIHBhZ2luYXRpb24gPSBfdGhpcyRwcm9wcy5wYWdpbmF0aW9uLAogICAgICAgICAgb25UYWJsZUNoYW5nZSA9IF90aGlzJHByb3BzLm9uVGFibGVDaGFuZ2U7CgogICAgICB2YXIgX2NoYW5nZUNsdXN0ZXIgPSAoMCwgX2xvZGFzaC5wYXJ0aWFsKShjaGFuZ2VDbHVzdGVyLCBhbmd1bGFyLnNjb3BlLCBhbmd1bGFyLmdsb2JhbFN0YXRlLCBhbmd1bGFyLmtiblVybCk7CgogICAgICB2YXIgX2hhbmRsZUNsaWNrSW5jb21wYXRpYmxlTGljZW5zZSA9ICgwLCBfbG9kYXNoLnBhcnRpYWwpKGhhbmRsZUNsaWNrSW5jb21wYXRpYmxlTGljZW5zZSwgYW5ndWxhci5zY29wZSk7CgogICAgICB2YXIgX2hhbmRsZUNsaWNrSW52YWxpZExpY2Vuc2UgPSAoMCwgX2xvZGFzaC5wYXJ0aWFsKShoYW5kbGVDbGlja0ludmFsaWRMaWNlbnNlLCBhbmd1bGFyLnNjb3BlKTsKCiAgICAgIHZhciBoYXNTdGFuZGFsb25lQ2x1c3RlciA9ICEhY2x1c3RlcnMuZmluZChmdW5jdGlvbiAoY2x1c3RlcikgewogICAgICAgIHJldHVybiBjbHVzdGVyLmNsdXN0ZXJfdXVpZCA9PT0gX2NvbnN0YW50cy5TVEFOREFMT05FX0NMVVNURVJfQ0xVU1RFUl9VVUlEOwogICAgICB9KTsKICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpUGFnZUJvZHksIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlQYWdlQ29udGVudCwgbnVsbCwgaGFzU3RhbmRhbG9uZUNsdXN0ZXIgPyB0aGlzLnJlbmRlclN0YW5kYWxvbmVDbHVzdGVyQ2FsbG91dChfY2hhbmdlQ2x1c3RlciwgYW5ndWxhci5zdG9yYWdlKSA6IG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3RhYmxlLkV1aU1vbml0b3JpbmdUYWJsZSwgewogICAgICAgIGNsYXNzTmFtZTogImNsdXN0ZXJUYWJsZSIsCiAgICAgICAgcm93czogY2x1c3RlcnMsCiAgICAgICAgY29sdW1uczogZ2V0Q29sdW1ucyhhbmd1bGFyLnNob3dMaWNlbnNlRXhwaXJhdGlvbiwgX2NoYW5nZUNsdXN0ZXIsIF9oYW5kbGVDbGlja0luY29tcGF0aWJsZUxpY2Vuc2UsIF9oYW5kbGVDbGlja0ludmFsaWRMaWNlbnNlKSwKICAgICAgICByb3dQcm9wczogZnVuY3Rpb24gcm93UHJvcHMoaXRlbSkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgJ2RhdGEtdGVzdC1zdWJqJzogImNsdXN0ZXJSb3dfIi5jb25jYXQoaXRlbS5jbHVzdGVyX3V1aWQpCiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgc29ydGluZzogX29iamVjdFNwcmVhZCh7fSwgc29ydGluZywgewogICAgICAgICAgc29ydDogX29iamVjdFNwcmVhZCh7fSwgc29ydGluZy5zb3J0LCB7CiAgICAgICAgICAgIGZpZWxkOiAnY2x1c3Rlcl9uYW1lJwogICAgICAgICAgfSkKICAgICAgICB9KSwKICAgICAgICBwYWdpbmF0aW9uOiBwYWdpbmF0aW9uLAogICAgICAgIHNlYXJjaDogewogICAgICAgICAgYm94OiB7CiAgICAgICAgICAgIGluY3JlbWVudGFsOiB0cnVlLAogICAgICAgICAgICBwbGFjZWhvbGRlcjogYW5ndWxhci5zY29wZS5maWx0ZXJUZXh0CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBvblRhYmxlQ2hhbmdlOiBvblRhYmxlQ2hhbmdlLAogICAgICAgIGV4ZWN1dGVRdWVyeU9wdGlvbnM6IHsKICAgICAgICAgIGRlZmF1bHRGaWVsZHM6IFsnY2x1c3Rlcl9uYW1lJ10KICAgICAgICB9CiAgICAgIH0pKSkpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIExpc3Rpbmc7Cn0oX3JlYWN0LkNvbXBvbmVudCk7CgpleHBvcnRzLkxpc3RpbmcgPSBMaXN0aW5nOw=="},null]}