{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/maps/public/layers/blended_vector_layer.js","dependencies":[{"path":"x-pack/legacy/plugins/maps/public/layers/blended_vector_layer.js","mtime":1589249552428},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuQmxlbmRlZFZlY3RvckxheWVyID0gdm9pZCAwOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX3ZlY3Rvcl9sYXllciA9IHJlcXVpcmUoIi4vdmVjdG9yX2xheWVyIik7Cgp2YXIgX3ZlY3Rvcl9zdHlsZSA9IHJlcXVpcmUoIi4vc3R5bGVzL3ZlY3Rvci92ZWN0b3Jfc3R5bGUiKTsKCnZhciBfdmVjdG9yX3N0eWxlX2RlZmF1bHRzID0gcmVxdWlyZSgiLi9zdHlsZXMvdmVjdG9yL3ZlY3Rvcl9zdHlsZV9kZWZhdWx0cyIpOwoKdmFyIF9jb25zdGFudHMgPSByZXF1aXJlKCIuLi8uLi9jb21tb24vY29uc3RhbnRzIik7Cgp2YXIgX2VzX2dlb19ncmlkX3NvdXJjZSA9IHJlcXVpcmUoIi4vc291cmNlcy9lc19nZW9fZ3JpZF9zb3VyY2UvZXNfZ2VvX2dyaWRfc291cmNlIik7Cgp2YXIgX2Nhbl9za2lwX2ZldGNoID0gcmVxdWlyZSgiLi91dGlsL2Nhbl9za2lwX2ZldGNoIik7Cgp2YXIgX2RhdGFfcmVxdWVzdCA9IHJlcXVpcmUoIi4vdXRpbC9kYXRhX3JlcXVlc3QiKTsKCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZjIoU3ltYm9sLml0ZXJhdG9yKSA9PT0gInN5bWJvbCIpIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gX3R5cGVvZjIob2JqKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mMihvYmopOwogICAgfTsKICB9CgogIHJldHVybiBfdHlwZW9mKG9iaik7Cn0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsKICB0cnkgewogICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOwogICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVqZWN0KGVycm9yKTsKICAgIHJldHVybjsKICB9CgogIGlmIChpbmZvLmRvbmUpIHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0gZWxzZSB7CiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7CiAgfQp9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgYXJncyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsKCiAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsKICAgICAgfQoKICAgICAgX25leHQodW5kZWZpbmVkKTsKICAgIH0pOwogIH07Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7CiAgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgewogICAgcmV0dXJuIGNhbGw7CiAgfQoKICByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsKfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgaWYgKHNlbGYgPT09IHZvaWQgMCkgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBzZWxmOwp9CgpmdW5jdGlvbiBfZ2V0KHRhcmdldCwgcHJvcGVydHksIHJlY2VpdmVyKSB7CiAgaWYgKHR5cGVvZiBSZWZsZWN0ICE9PSAidW5kZWZpbmVkIiAmJiBSZWZsZWN0LmdldCkgewogICAgX2dldCA9IFJlZmxlY3QuZ2V0OwogIH0gZWxzZSB7CiAgICBfZ2V0ID0gZnVuY3Rpb24gX2dldCh0YXJnZXQsIHByb3BlcnR5LCByZWNlaXZlcikgewogICAgICB2YXIgYmFzZSA9IF9zdXBlclByb3BCYXNlKHRhcmdldCwgcHJvcGVydHkpOwoKICAgICAgaWYgKCFiYXNlKSByZXR1cm47CiAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihiYXNlLCBwcm9wZXJ0eSk7CgogICAgICBpZiAoZGVzYy5nZXQpIHsKICAgICAgICByZXR1cm4gZGVzYy5nZXQuY2FsbChyZWNlaXZlcik7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZXNjLnZhbHVlOwogICAgfTsKICB9CgogIHJldHVybiBfZ2V0KHRhcmdldCwgcHJvcGVydHksIHJlY2VpdmVyIHx8IHRhcmdldCk7Cn0KCmZ1bmN0aW9uIF9zdXBlclByb3BCYXNlKG9iamVjdCwgcHJvcGVydHkpIHsKICB3aGlsZSAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KSkgewogICAgb2JqZWN0ID0gX2dldFByb3RvdHlwZU9mKG9iamVjdCk7CiAgICBpZiAob2JqZWN0ID09PSBudWxsKSBicmVhazsKICB9CgogIHJldHVybiBvYmplY3Q7Cn0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7CiAgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7CiAgfTsKICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOwogIH0KCiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9KTsKICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsKfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgIG8uX19wcm90b19fID0gcDsKICAgIHJldHVybiBvOwogIH07CgogIHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCnZhciBBQ1RJVkVfQ09VTlRfREFUQV9JRCA9ICdBQ1RJVkVfQ09VTlRfREFUQV9JRCc7CgpmdW5jdGlvbiBnZXRBZ2dUeXBlKGR5bmFtaWNQcm9wZXJ0eSkgewogIHJldHVybiBkeW5hbWljUHJvcGVydHkuaXNPcmRpbmFsKCkgPyBfY29uc3RhbnRzLkFHR19UWVBFLkFWRyA6IF9jb25zdGFudHMuQUdHX1RZUEUuVEVSTVM7Cn0KCmZ1bmN0aW9uIGdldENsdXN0ZXJTb3VyY2UoZG9jdW1lbnRTb3VyY2UsIGRvY3VtZW50U3R5bGUpIHsKICB2YXIgY2x1c3RlclNvdXJjZURlc2NyaXB0b3IgPSBfZXNfZ2VvX2dyaWRfc291cmNlLkVTR2VvR3JpZFNvdXJjZS5jcmVhdGVEZXNjcmlwdG9yKHsKICAgIGluZGV4UGF0dGVybklkOiBkb2N1bWVudFNvdXJjZS5nZXRJbmRleFBhdHRlcm5JZCgpLAogICAgZ2VvRmllbGQ6IGRvY3VtZW50U291cmNlLmdldEdlb0ZpZWxkTmFtZSgpLAogICAgcmVxdWVzdFR5cGU6IF9jb25zdGFudHMuUkVOREVSX0FTLlBPSU5UCiAgfSk7CgogIGNsdXN0ZXJTb3VyY2VEZXNjcmlwdG9yLm1ldHJpY3MgPSBbewogICAgdHlwZTogX2NvbnN0YW50cy5BR0dfVFlQRS5DT1VOVCwKICAgIGxhYmVsOiBfY29uc3RhbnRzLkNPVU5UX1BST1BfTEFCRUwKICB9XS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGRvY3VtZW50U3R5bGUuZ2V0RHluYW1pY1Byb3BlcnRpZXNBcnJheSgpLm1hcChmdW5jdGlvbiAoZHluYW1pY1Byb3BlcnR5KSB7CiAgICByZXR1cm4gewogICAgICB0eXBlOiBnZXRBZ2dUeXBlKGR5bmFtaWNQcm9wZXJ0eSksCiAgICAgIGZpZWxkOiBkeW5hbWljUHJvcGVydHkuZ2V0RmllbGROYW1lKCkKICAgIH07CiAgfSkpKTsKICBjbHVzdGVyU291cmNlRGVzY3JpcHRvci5pZCA9IGRvY3VtZW50U291cmNlLmdldElkKCk7CiAgcmV0dXJuIG5ldyBfZXNfZ2VvX2dyaWRfc291cmNlLkVTR2VvR3JpZFNvdXJjZShjbHVzdGVyU291cmNlRGVzY3JpcHRvciwgZG9jdW1lbnRTb3VyY2UuZ2V0SW5zcGVjdG9yQWRhcHRlcnMoKSk7Cn0KCmZ1bmN0aW9uIGdldENsdXN0ZXJTdHlsZURlc2NyaXB0b3IoZG9jdW1lbnRTdHlsZSwgY2x1c3RlclNvdXJjZSkgewogIHZhciBfcHJvcGVydGllczsKCiAgdmFyIGRlZmF1bHREeW5hbWljUHJvcGVydGllcyA9ICgwLCBfdmVjdG9yX3N0eWxlX2RlZmF1bHRzLmdldERlZmF1bHREeW5hbWljUHJvcGVydGllcykoKTsKICB2YXIgY2x1c3RlclN0eWxlRGVzY3JpcHRvciA9IHsKICAgIHR5cGU6IF9jb25zdGFudHMuTEFZRVJfU1RZTEVfVFlQRS5WRUNUT1IsCiAgICBwcm9wZXJ0aWVzOiAoX3Byb3BlcnRpZXMgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9wcm9wZXJ0aWVzLCBfY29uc3RhbnRzLlZFQ1RPUl9TVFlMRVMuTEFCRUxfVEVYVCwgewogICAgICB0eXBlOiBfY29uc3RhbnRzLlNUWUxFX1RZUEUuRFlOQU1JQywKICAgICAgb3B0aW9uczogX29iamVjdFNwcmVhZCh7fSwgZGVmYXVsdER5bmFtaWNQcm9wZXJ0aWVzW19jb25zdGFudHMuVkVDVE9SX1NUWUxFUy5MQUJFTF9URVhUXS5vcHRpb25zLCB7CiAgICAgICAgZmllbGQ6IHsKICAgICAgICAgIG5hbWU6IF9jb25zdGFudHMuQ09VTlRfUFJPUF9OQU1FLAogICAgICAgICAgb3JpZ2luOiBfY29uc3RhbnRzLkZJRUxEX09SSUdJTi5TT1VSQ0UKICAgICAgICB9CiAgICAgIH0pCiAgICB9KSwgX2RlZmluZVByb3BlcnR5KF9wcm9wZXJ0aWVzLCBfY29uc3RhbnRzLlZFQ1RPUl9TVFlMRVMuSUNPTl9TSVpFLCB7CiAgICAgIHR5cGU6IF9jb25zdGFudHMuU1RZTEVfVFlQRS5EWU5BTUlDLAogICAgICBvcHRpb25zOiBfb2JqZWN0U3ByZWFkKHt9LCBkZWZhdWx0RHluYW1pY1Byb3BlcnRpZXNbX2NvbnN0YW50cy5WRUNUT1JfU1RZTEVTLklDT05fU0laRV0ub3B0aW9ucywgewogICAgICAgIGZpZWxkOiB7CiAgICAgICAgICBuYW1lOiBfY29uc3RhbnRzLkNPVU5UX1BST1BfTkFNRSwKICAgICAgICAgIG9yaWdpbjogX2NvbnN0YW50cy5GSUVMRF9PUklHSU4uU09VUkNFCiAgICAgICAgfQogICAgICB9KQogICAgfSksIF9wcm9wZXJ0aWVzKQogIH07CiAgZG9jdW1lbnRTdHlsZS5nZXRBbGxTdHlsZVByb3BlcnRpZXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChzdHlsZVByb3BlcnR5KSB7CiAgICB2YXIgc3R5bGVOYW1lID0gc3R5bGVQcm9wZXJ0eS5nZXRTdHlsZU5hbWUoKTsKCiAgICBpZiAoW19jb25zdGFudHMuVkVDVE9SX1NUWUxFUy5MQUJFTF9URVhULCBfY29uc3RhbnRzLlZFQ1RPUl9TVFlMRVMuSUNPTl9TSVpFXS5pbmNsdWRlcyhzdHlsZU5hbWUpICYmICghc3R5bGVQcm9wZXJ0eS5pc0R5bmFtaWMoKSB8fCAhc3R5bGVQcm9wZXJ0eS5pc0NvbXBsZXRlKCkpKSB7CiAgICAgIC8vIERvIG5vdCBtaWdyYXRlIHN0YXRpYyBsYWJlbCBhbmQgaWNvbiBzaXplIHByb3BlcnRpZXMgdG8gcHJvdmlkZSB1bmlxdWUgY2x1c3RlciBzdHlsaW5nIG91dCBvZiB0aGUgYm94CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoc3R5bGVOYW1lID09PSBfY29uc3RhbnRzLlZFQ1RPUl9TVFlMRVMuU1lNQk9MSVpFX0FTIHx8IHN0eWxlTmFtZSA9PT0gX2NvbnN0YW50cy5WRUNUT1JfU1RZTEVTLkxBQkVMX0JPUkRFUl9TSVpFKSB7CiAgICAgIC8vIGNvcHkgbm9uZSBzdGF0aWMvZHluYW1pYyBzdHlsZXMgdG8gY2x1c3RlciBzdHlsZQogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIGNsdXN0ZXJTdHlsZURlc2NyaXB0b3IucHJvcGVydGllc1tzdHlsZU5hbWVdID0gewogICAgICAgIG9wdGlvbnM6IF9vYmplY3RTcHJlYWQoe30sIHN0eWxlUHJvcGVydHkuZ2V0T3B0aW9ucygpKQogICAgICB9OwogICAgfSBlbHNlIGlmIChzdHlsZVByb3BlcnR5LmlzRHluYW1pYygpKSB7CiAgICAgIC8vIGNvcHkgZHluYW1pYyBzdHlsZXMgdG8gY2x1c3RlciBzdHlsZQogICAgICB2YXIgb3B0aW9ucyA9IHN0eWxlUHJvcGVydHkuZ2V0T3B0aW9ucygpOwogICAgICB2YXIgZmllbGQgPSBvcHRpb25zICYmIG9wdGlvbnMuZmllbGQgJiYgb3B0aW9ucy5maWVsZC5uYW1lID8gX29iamVjdFNwcmVhZCh7fSwgb3B0aW9ucy5maWVsZCwgewogICAgICAgIG5hbWU6IGNsdXN0ZXJTb3VyY2UuZ2V0QWdnS2V5KGdldEFnZ1R5cGUoc3R5bGVQcm9wZXJ0eSksIG9wdGlvbnMuZmllbGQubmFtZSkKICAgICAgfSkgOiB1bmRlZmluZWQ7IC8vIEB0cy1pZ25vcmUKCiAgICAgIGNsdXN0ZXJTdHlsZURlc2NyaXB0b3IucHJvcGVydGllc1tzdHlsZU5hbWVdID0gewogICAgICAgIHR5cGU6IF9jb25zdGFudHMuU1RZTEVfVFlQRS5EWU5BTUlDLAogICAgICAgIG9wdGlvbnM6IF9vYmplY3RTcHJlYWQoe30sIG9wdGlvbnMsIHsKICAgICAgICAgIGZpZWxkOiBmaWVsZAogICAgICAgIH0pCiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICAvLyBjb3B5IHN0YXRpYyBzdHlsZXMgdG8gY2x1c3RlciBzdHlsZQogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIGNsdXN0ZXJTdHlsZURlc2NyaXB0b3IucHJvcGVydGllc1tzdHlsZU5hbWVdID0gewogICAgICAgIHR5cGU6IF9jb25zdGFudHMuU1RZTEVfVFlQRS5TVEFUSUMsCiAgICAgICAgb3B0aW9uczogX29iamVjdFNwcmVhZCh7fSwgc3R5bGVQcm9wZXJ0eS5nZXRPcHRpb25zKCkpCiAgICAgIH07CiAgICB9CiAgfSk7CiAgcmV0dXJuIGNsdXN0ZXJTdHlsZURlc2NyaXB0b3I7Cn0KCnZhciBCbGVuZGVkVmVjdG9yTGF5ZXIgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfVmVjdG9yTGF5ZXIpIHsKICBfaW5oZXJpdHMoQmxlbmRlZFZlY3RvckxheWVyLCBfVmVjdG9yTGF5ZXIpOwoKICBfY3JlYXRlQ2xhc3MoQmxlbmRlZFZlY3RvckxheWVyLCBudWxsLCBbewogICAga2V5OiAiY3JlYXRlRGVzY3JpcHRvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlRGVzY3JpcHRvcihvcHRpb25zLCBtYXBDb2xvcnMpIHsKICAgICAgdmFyIGxheWVyRGVzY3JpcHRvciA9IF92ZWN0b3JfbGF5ZXIuVmVjdG9yTGF5ZXIuY3JlYXRlRGVzY3JpcHRvcihvcHRpb25zLCBtYXBDb2xvcnMpOwoKICAgICAgbGF5ZXJEZXNjcmlwdG9yLnR5cGUgPSBCbGVuZGVkVmVjdG9yTGF5ZXIudHlwZTsKICAgICAgcmV0dXJuIGxheWVyRGVzY3JpcHRvcjsKICAgIH0KICB9XSk7CgogIGZ1bmN0aW9uIEJsZW5kZWRWZWN0b3JMYXllcihvcHRpb25zKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJsZW5kZWRWZWN0b3JMYXllcik7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoQmxlbmRlZFZlY3RvckxheWVyKS5jYWxsKHRoaXMsIG9wdGlvbnMpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfaXNDbHVzdGVyZWQiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9jbHVzdGVyU291cmNlIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfY2x1c3RlclN0eWxlIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfZG9jdW1lbnRTb3VyY2UiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9kb2N1bWVudFN0eWxlIiwgdm9pZCAwKTsKCiAgICBfdGhpcy5fZG9jdW1lbnRTb3VyY2UgPSBfdGhpcy5fc291cmNlOyAvLyBWZWN0b3JMYXllciBjb25zdHJ1Y3RvciBzZXRzIF9zb3VyY2UgYXMgZG9jdW1lbnQgc291cmNlCgogICAgX3RoaXMuX2RvY3VtZW50U3R5bGUgPSBfdGhpcy5fc3R5bGU7IC8vIFZlY3RvckxheWVyIGNvbnN0cnVjdG9yIHNldHMgX3N0eWxlIGFzIGRvY3VtZW50IHNvdXJjZQoKICAgIF90aGlzLl9jbHVzdGVyU291cmNlID0gZ2V0Q2x1c3RlclNvdXJjZShfdGhpcy5fZG9jdW1lbnRTb3VyY2UsIF90aGlzLl9kb2N1bWVudFN0eWxlKTsKICAgIHZhciBjbHVzdGVyU3R5bGVEZXNjcmlwdG9yID0gZ2V0Q2x1c3RlclN0eWxlRGVzY3JpcHRvcihfdGhpcy5fZG9jdW1lbnRTdHlsZSwgX3RoaXMuX2NsdXN0ZXJTb3VyY2UpOwogICAgX3RoaXMuX2NsdXN0ZXJTdHlsZSA9IG5ldyBfdmVjdG9yX3N0eWxlLlZlY3RvclN0eWxlKGNsdXN0ZXJTdHlsZURlc2NyaXB0b3IsIF90aGlzLl9jbHVzdGVyU291cmNlLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7CiAgICB2YXIgaXNDbHVzdGVyZWQgPSBmYWxzZTsKCiAgICB2YXIgc291cmNlRGF0YVJlcXVlc3QgPSBfdGhpcy5nZXRTb3VyY2VEYXRhUmVxdWVzdCgpOwoKICAgIGlmIChzb3VyY2VEYXRhUmVxdWVzdCkgewogICAgICB2YXIgcmVxdWVzdE1ldGEgPSBzb3VyY2VEYXRhUmVxdWVzdC5nZXRNZXRhKCk7CgogICAgICBpZiAocmVxdWVzdE1ldGEgJiYgcmVxdWVzdE1ldGEuc291cmNlVHlwZSAmJiByZXF1ZXN0TWV0YS5zb3VyY2VUeXBlID09PSBfY29uc3RhbnRzLkVTX0dFT19HUklEKSB7CiAgICAgICAgaXNDbHVzdGVyZWQgPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgX3RoaXMuX2lzQ2x1c3RlcmVkID0gaXNDbHVzdGVyZWQ7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQmxlbmRlZFZlY3RvckxheWVyLCBbewogICAga2V5OiAiZGVzdHJveSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHsKICAgICAgaWYgKHRoaXMuX2RvY3VtZW50U291cmNlKSB7CiAgICAgICAgdGhpcy5fZG9jdW1lbnRTb3VyY2UuZGVzdHJveSgpOwogICAgICB9CgogICAgICBpZiAodGhpcy5fY2x1c3RlclNvdXJjZSkgewogICAgICAgIHRoaXMuX2NsdXN0ZXJTb3VyY2UuZGVzdHJveSgpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RGlzcGxheU5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXREaXNwbGF5TmFtZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoc291cmNlKSB7CiAgICAgICAgdmFyIGRpc3BsYXlOYW1lOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF9nZXQoX2dldFByb3RvdHlwZU9mKEJsZW5kZWRWZWN0b3JMYXllci5wcm90b3R5cGUpLCAiZ2V0RGlzcGxheU5hbWUiLCB0aGlzKS5jYWxsKHRoaXMsIHNvdXJjZSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHRoaXMuX2lzQ2x1c3RlcmVkID8gX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLm1hcHMuYmxlbmRlZFZlY3RvckxheWVyLmNsdXN0ZXJlZExheWVyTmFtZScsIHsKICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDbHVzdGVyZWQge2Rpc3BsYXlOYW1lfScsCiAgICAgICAgICAgICAgICAgIHZhbHVlczogewogICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBkaXNwbGF5TmFtZQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KSA6IGRpc3BsYXlOYW1lKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldERpc3BsYXlOYW1lKF94KSB7CiAgICAgICAgcmV0dXJuIF9nZXREaXNwbGF5TmFtZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0RGlzcGxheU5hbWU7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJpc0pvaW5hYmxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0pvaW5hYmxlKCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Sm9pbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEpvaW5zKCkgewogICAgICByZXR1cm4gW107CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0U291cmNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTb3VyY2UoKSB7CiAgICAgIHJldHVybiB0aGlzLl9pc0NsdXN0ZXJlZCA/IHRoaXMuX2NsdXN0ZXJTb3VyY2UgOiB0aGlzLl9kb2N1bWVudFNvdXJjZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTb3VyY2VGb3JFZGl0aW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTb3VyY2VGb3JFZGl0aW5nKCkgewogICAgICAvLyBMYXllciBpcyBiYXNlZCBvbiB0aGlzLl9kb2N1bWVudFNvdXJjZQogICAgICAvLyB0aGlzLl9jbHVzdGVyU291cmNlIGlzIGEgZGVyaXZlZCBzb3VyY2UgZm9yIHJlbmRlcmluZyBvbmx5LgogICAgICAvLyBSZWdhcmRsZXNzIG9mIHRoaXMuX2FjdGl2ZVNvdXJjZSwgdGhpcy5fZG9jdW1lbnRTb3VyY2Ugc2hvdWxkIGFsd2F5cyBiZSBkaXNwbGF5ZWQgaW4gdGhlIGVkaXRvcgogICAgICByZXR1cm4gdGhpcy5fZG9jdW1lbnRTb3VyY2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Q3VycmVudFN0eWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDdXJyZW50U3R5bGUoKSB7CiAgICAgIHJldHVybiB0aGlzLl9pc0NsdXN0ZXJlZCA/IHRoaXMuX2NsdXN0ZXJTdHlsZSA6IHRoaXMuX2RvY3VtZW50U3R5bGU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0U3R5bGVGb3JFZGl0aW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTdHlsZUZvckVkaXRpbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kb2N1bWVudFN0eWxlOwogICAgfQogIH0sIHsKICAgIGtleTogInN5bmNEYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfc3luY0RhdGEgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihzeW5jQ29udGV4dCkgewogICAgICAgIHZhciBkYXRhUmVxdWVzdElkLCByZXF1ZXN0VG9rZW4sIHNlYXJjaEZpbHRlcnMsIGNhblNraXBGZXRjaCwgaXNTeW5jQ2x1c3RlcmVkLCBzZWFyY2hTb3VyY2UsIHJlc3AsIG1heFJlc3VsdFdpbmRvdywgYWN0aXZlU291cmNlLCBhY3RpdmVTdHlsZTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZGF0YVJlcXVlc3RJZCA9IEFDVElWRV9DT1VOVF9EQVRBX0lEOwogICAgICAgICAgICAgICAgcmVxdWVzdFRva2VuID0gU3ltYm9sKCJsYXllci1hY3RpdmUtY291bnQ6Ii5jb25jYXQodGhpcy5nZXRJZCgpKSk7CiAgICAgICAgICAgICAgICBzZWFyY2hGaWx0ZXJzID0gdGhpcy5fZ2V0U2VhcmNoRmlsdGVycyhzeW5jQ29udGV4dC5kYXRhRmlsdGVycywgdGhpcy5nZXRTb3VyY2UoKSwgdGhpcy5nZXRDdXJyZW50U3R5bGUoKSk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gKDAsIF9jYW5fc2tpcF9mZXRjaC5jYW5Ta2lwU291cmNlVXBkYXRlKSh7CiAgICAgICAgICAgICAgICAgIHNvdXJjZTogdGhpcy5nZXRTb3VyY2UoKSwKICAgICAgICAgICAgICAgICAgcHJldkRhdGFSZXF1ZXN0OiB0aGlzLmdldERhdGFSZXF1ZXN0KGRhdGFSZXF1ZXN0SWQpLAogICAgICAgICAgICAgICAgICBuZXh0TWV0YTogc2VhcmNoRmlsdGVycwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGNhblNraXBGZXRjaCA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICAgIGlmICghY2FuU2tpcEZldGNoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDg7CiAgICAgICAgICAgICAgICBzeW5jQ29udGV4dC5zdGFydExvYWRpbmcoZGF0YVJlcXVlc3RJZCwgcmVxdWVzdFRva2VuLCBzZWFyY2hGaWx0ZXJzKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZG9jdW1lbnRTb3VyY2UubWFrZVNlYXJjaFNvdXJjZShzZWFyY2hGaWx0ZXJzLCAwKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIHNlYXJjaFNvdXJjZSA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIHJldHVybiBzZWFyY2hTb3VyY2UuZmV0Y2goKTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIHJlc3AgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZG9jdW1lbnRTb3VyY2UuZ2V0TWF4UmVzdWx0V2luZG93KCk7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgICBtYXhSZXN1bHRXaW5kb3cgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIGlzU3luY0NsdXN0ZXJlZCA9IHJlc3AuaGl0cy50b3RhbCA+IG1heFJlc3VsdFdpbmRvdzsKICAgICAgICAgICAgICAgIHN5bmNDb250ZXh0LnN0b3BMb2FkaW5nKGRhdGFSZXF1ZXN0SWQsIHJlcXVlc3RUb2tlbiwgewogICAgICAgICAgICAgICAgICBpc1N5bmNDbHVzdGVyZWQ6IGlzU3luY0NsdXN0ZXJlZAogICAgICAgICAgICAgICAgfSwgc2VhcmNoRmlsdGVycyk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI3OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDIzOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyWyJjYXRjaCJdKDgpOwoKICAgICAgICAgICAgICAgIGlmICghKF9jb250ZXh0Mi50MCBpbnN0YW5jZW9mIF9kYXRhX3JlcXVlc3QuRGF0YVJlcXVlc3RBYm9ydEVycm9yKSkgewogICAgICAgICAgICAgICAgICBzeW5jQ29udGV4dC5vbkxvYWRFcnJvcihkYXRhUmVxdWVzdElkLCByZXF1ZXN0VG9rZW4sIF9jb250ZXh0Mi50MC5tZXNzYWdlKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgICAgICBpZiAoaXNTeW5jQ2x1c3RlcmVkKSB7CiAgICAgICAgICAgICAgICAgIGFjdGl2ZVNvdXJjZSA9IHRoaXMuX2NsdXN0ZXJTb3VyY2U7CiAgICAgICAgICAgICAgICAgIGFjdGl2ZVN0eWxlID0gdGhpcy5fY2x1c3RlclN0eWxlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgYWN0aXZlU291cmNlID0gdGhpcy5fZG9jdW1lbnRTb3VyY2U7CiAgICAgICAgICAgICAgICAgIGFjdGl2ZVN0eWxlID0gdGhpcy5fZG9jdW1lbnRTdHlsZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihCbGVuZGVkVmVjdG9yTGF5ZXIucHJvdG90eXBlKSwgIl9zeW5jRGF0YSIsIHRoaXMpLmNhbGwodGhpcywgc3luY0NvbnRleHQsIGFjdGl2ZVNvdXJjZSwgYWN0aXZlU3R5bGUpOwoKICAgICAgICAgICAgICBjYXNlIDI5OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzLCBbWzgsIDIzXV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBzeW5jRGF0YShfeDIpIHsKICAgICAgICByZXR1cm4gX3N5bmNEYXRhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBzeW5jRGF0YTsKICAgIH0oKQogIH1dKTsKCiAgcmV0dXJuIEJsZW5kZWRWZWN0b3JMYXllcjsKfShfdmVjdG9yX2xheWVyLlZlY3RvckxheWVyKTsKCmV4cG9ydHMuQmxlbmRlZFZlY3RvckxheWVyID0gQmxlbmRlZFZlY3RvckxheWVyOwoKX2RlZmluZVByb3BlcnR5KEJsZW5kZWRWZWN0b3JMYXllciwgInR5cGUiLCBfY29uc3RhbnRzLkxBWUVSX1RZUEUuQkxFTkRFRF9WRUNUT1IpOw=="},null]}