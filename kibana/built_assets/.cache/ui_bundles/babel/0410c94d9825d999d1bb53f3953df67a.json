{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/components/description_step/index.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/pages/detection_engine/rules/components/description_step/index.js","mtime":1589249553304},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmdldERlc2NyaXB0aW9uSXRlbSA9IGV4cG9ydHMuYWRkRmlsdGVyU3RhdGVJZk5vdFRoZXJlID0gZXhwb3J0cy5idWlsZExpc3RJdGVtcyA9IGV4cG9ydHMuU3RlcFJ1bGVEZXNjcmlwdGlvbiA9IGV4cG9ydHMuU3RlcFJ1bGVEZXNjcmlwdGlvbkNvbXBvbmVudCA9IHZvaWQgMDsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX2ZwID0gcmVxdWlyZSgibG9kYXNoL2ZwIik7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3N0eWxlZENvbXBvbmVudHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInN0eWxlZC1jb21wb25lbnRzIikpOwoKdmFyIF9wdWJsaWMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9kYXRhL3B1YmxpYyIpOwoKdmFyIF90cmFuc2xhdGlvbnMgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9jb21wb25lbnRzL3RpbWVsaW5lL3RyYW5zbGF0aW9ucyIpOwoKdmFyIF9raWJhbmEgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi9saWIva2liYW5hIik7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuL2hlbHBlcnMiKTsKCnZhciBfdXNlX3NpZW1fam9icyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uL2NvbXBvbmVudHMvbWxfcG9wb3Zlci9ob29rcy91c2Vfc2llbV9qb2JzIik7Cgp2YXIgX21sX2pvYl9kZXNjcmlwdGlvbiA9IHJlcXVpcmUoIi4vbWxfam9iX2Rlc2NyaXB0aW9uIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgewogIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CiAgICBkZWZhdWx0OiBvYmoKICB9Owp9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgewogIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gIltvYmplY3QgQXJndW1lbnRzXSIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgewogICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciBEZXNjcmlwdGlvbkxpc3RDb250YWluZXIgPSAoMCwgX3N0eWxlZENvbXBvbmVudHMuZGVmYXVsdCkoX2V1aS5FdWlEZXNjcmlwdGlvbkxpc3QpLndpdGhDb25maWcoewogIGRpc3BsYXlOYW1lOiAiRGVzY3JpcHRpb25MaXN0Q29udGFpbmVyIiwKICBjb21wb25lbnRJZDogInNjLTE2MDk3MGgtMCIKfSkoWyImLmV1aURlc2NyaXB0aW9uTGlzdC0tY29sdW1uIC5ldWlEZXNjcmlwdGlvbkxpc3RfX3RpdGxle3dpZHRoOjMwJTt9Ji5ldWlEZXNjcmlwdGlvbkxpc3QtLWNvbHVtbiAuZXVpRGVzY3JpcHRpb25MaXN0X19kZXNjcmlwdGlvbnt3aWR0aDo3MCU7fSJdKTsKCnZhciBTdGVwUnVsZURlc2NyaXB0aW9uQ29tcG9uZW50ID0gZnVuY3Rpb24gU3RlcFJ1bGVEZXNjcmlwdGlvbkNvbXBvbmVudChfcmVmKSB7CiAgdmFyIGRhdGEgPSBfcmVmLmRhdGEsCiAgICAgIF9yZWYkY29sdW1ucyA9IF9yZWYuY29sdW1ucywKICAgICAgY29sdW1ucyA9IF9yZWYkY29sdW1ucyA9PT0gdm9pZCAwID8gJ211bHRpJyA6IF9yZWYkY29sdW1ucywKICAgICAgaW5kZXhQYXR0ZXJucyA9IF9yZWYuaW5kZXhQYXR0ZXJucywKICAgICAgc2NoZW1hID0gX3JlZi5zY2hlbWE7CiAgdmFyIGtpYmFuYSA9ICgwLCBfa2liYW5hLnVzZUtpYmFuYSkoKTsKCiAgdmFyIF91c2VTdGF0ZSA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKG5ldyBfcHVibGljLkZpbHRlck1hbmFnZXIoa2liYW5hLnNlcnZpY2VzLnVpU2V0dGluZ3MpKSwKICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMSksCiAgICAgIGZpbHRlck1hbmFnZXIgPSBfdXNlU3RhdGUyWzBdOwoKICB2YXIgX3VzZVNpZW1Kb2JzID0gKDAsIF91c2Vfc2llbV9qb2JzLnVzZVNpZW1Kb2JzKSh0cnVlKSwKICAgICAgX3VzZVNpZW1Kb2JzMiA9IF9zbGljZWRUb0FycmF5KF91c2VTaWVtSm9icywgMiksCiAgICAgIHNpZW1Kb2JzID0gX3VzZVNpZW1Kb2JzMlsxXTsKCiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhzY2hlbWEpOwogIHZhciBsaXN0SXRlbXMgPSBrZXlzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBrZXkpIHsKICAgIGlmIChrZXkgPT09ICdtYWNoaW5lTGVhcm5pbmdKb2JJZCcpIHsKICAgICAgcmV0dXJuIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoYWNjKSwgWygwLCBfbWxfam9iX2Rlc2NyaXB0aW9uLmJ1aWxkTWxKb2JEZXNjcmlwdGlvbikoKDAsIF9mcC5nZXQpKGtleSwgZGF0YSksICgwLCBfZnAuZ2V0KShrZXksIHNjaGVtYSkubGFiZWwsIHNpZW1Kb2JzKV0pOwogICAgfQoKICAgIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGFjYyksIF90b0NvbnN1bWFibGVBcnJheShidWlsZExpc3RJdGVtcyhkYXRhLCAoMCwgX2ZwLnBpY2spKGtleSwgc2NoZW1hKSwgZmlsdGVyTWFuYWdlciwgaW5kZXhQYXR0ZXJucykpKTsKICB9LCBbXSk7CgogIGlmIChjb2x1bW5zID09PSAnbXVsdGknKSB7CiAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgbnVsbCwgKDAsIF9mcC5jaHVuaykoTWF0aC5jZWlsKGxpc3RJdGVtcy5sZW5ndGggLyAyKSwgbGlzdEl0ZW1zKS5tYXAoZnVuY3Rpb24gKGNodW5rTGlzdEl0ZW1zLCBpbmRleCkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAgICAgImRhdGEtdGVzdC1zdWJqIjogImxpc3RJdGVtQ29sdW1uU3RlcFJ1bGVEZXNjcmlwdGlvbiIsCiAgICAgICAga2V5OiAiZGVzY3JpcHRpb24tc3RlcC1ydWxlLSIuY29uY2F0KGluZGV4KQogICAgICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRGVzY3JpcHRpb25MaXN0LCB7CiAgICAgICAgbGlzdEl0ZW1zOiBjaHVua0xpc3RJdGVtcwogICAgICB9KSk7CiAgICB9KSk7CiAgfQoKICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhHcm91cCwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICAiZGF0YS10ZXN0LXN1YmoiOiAibGlzdEl0ZW1Db2x1bW5TdGVwUnVsZURlc2NyaXB0aW9uIgogIH0sIGNvbHVtbnMgPT09ICdzaW5nbGUnID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aURlc2NyaXB0aW9uTGlzdCwgewogICAgbGlzdEl0ZW1zOiBsaXN0SXRlbXMKICB9KSA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRGVzY3JpcHRpb25MaXN0Q29udGFpbmVyLCB7CiAgICAiZGF0YS10ZXN0LXN1YmoiOiAic2luZ2xlU3BsaXRTdGVwUnVsZURlc2NyaXB0aW9uTGlzdCIsCiAgICB0eXBlOiAiY29sdW1uIiwKICAgIGxpc3RJdGVtczogbGlzdEl0ZW1zCiAgfSkpKTsKfTsKCmV4cG9ydHMuU3RlcFJ1bGVEZXNjcmlwdGlvbkNvbXBvbmVudCA9IFN0ZXBSdWxlRGVzY3JpcHRpb25Db21wb25lbnQ7CnZhciBTdGVwUnVsZURlc2NyaXB0aW9uID0gKDAsIF9yZWFjdC5tZW1vKShTdGVwUnVsZURlc2NyaXB0aW9uQ29tcG9uZW50KTsKZXhwb3J0cy5TdGVwUnVsZURlc2NyaXB0aW9uID0gU3RlcFJ1bGVEZXNjcmlwdGlvbjsKCnZhciBidWlsZExpc3RJdGVtcyA9IGZ1bmN0aW9uIGJ1aWxkTGlzdEl0ZW1zKGRhdGEsIHNjaGVtYSwgZmlsdGVyTWFuYWdlciwgaW5kZXhQYXR0ZXJucykgewogIHJldHVybiBPYmplY3Qua2V5cyhzY2hlbWEpLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBmaWVsZCkgewogICAgcmV0dXJuIFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoYWNjKSwgX3RvQ29uc3VtYWJsZUFycmF5KGdldERlc2NyaXB0aW9uSXRlbShmaWVsZCwgKDAsIF9mcC5nZXQpKFtmaWVsZCwgJ2xhYmVsJ10sIHNjaGVtYSksIGRhdGEsIGZpbHRlck1hbmFnZXIsIGluZGV4UGF0dGVybnMpKSk7CiAgfSwgW10pOwp9OwoKZXhwb3J0cy5idWlsZExpc3RJdGVtcyA9IGJ1aWxkTGlzdEl0ZW1zOwoKdmFyIGFkZEZpbHRlclN0YXRlSWZOb3RUaGVyZSA9IGZ1bmN0aW9uIGFkZEZpbHRlclN0YXRlSWZOb3RUaGVyZShmaWx0ZXJzKSB7CiAgcmV0dXJuIGZpbHRlcnMubWFwKGZ1bmN0aW9uIChmaWx0ZXIpIHsKICAgIGlmIChmaWx0ZXIuJHN0YXRlID09IG51bGwpIHsKICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoewogICAgICAgICRzdGF0ZTogewogICAgICAgICAgc3RvcmU6IF9wdWJsaWMuZXNGaWx0ZXJzLkZpbHRlclN0YXRlU3RvcmUuQVBQX1NUQVRFCiAgICAgICAgfQogICAgICB9LCBmaWx0ZXIpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZpbHRlcjsKICAgIH0KICB9KTsKfTsKCmV4cG9ydHMuYWRkRmlsdGVyU3RhdGVJZk5vdFRoZXJlID0gYWRkRmlsdGVyU3RhdGVJZk5vdFRoZXJlOwoKdmFyIGdldERlc2NyaXB0aW9uSXRlbSA9IGZ1bmN0aW9uIGdldERlc2NyaXB0aW9uSXRlbShmaWVsZCwgbGFiZWwsIGRhdGEsIGZpbHRlck1hbmFnZXIsIGluZGV4UGF0dGVybnMpIHsKICBpZiAoZmllbGQgPT09ICdxdWVyeUJhcicpIHsKICAgIHZhciBfZ2V0OwoKICAgIHZhciBmaWx0ZXJzID0gYWRkRmlsdGVyU3RhdGVJZk5vdFRoZXJlKChfZ2V0ID0gKDAsIF9mcC5nZXQpKCdxdWVyeUJhci5maWx0ZXJzJywgZGF0YSkpICE9PSBudWxsICYmIF9nZXQgIT09IHZvaWQgMCA/IF9nZXQgOiBbXSk7CiAgICB2YXIgcXVlcnkgPSAoMCwgX2ZwLmdldCkoJ3F1ZXJ5QmFyLnF1ZXJ5LnF1ZXJ5JywgZGF0YSk7CiAgICB2YXIgc2F2ZWRJZCA9ICgwLCBfZnAuZ2V0KSgncXVlcnlCYXIuc2F2ZWRfaWQnLCBkYXRhKTsKICAgIHJldHVybiAoMCwgX2hlbHBlcnMuYnVpbGRRdWVyeUJhckRlc2NyaXB0aW9uKSh7CiAgICAgIGZpZWxkOiBmaWVsZCwKICAgICAgZmlsdGVyczogZmlsdGVycywKICAgICAgZmlsdGVyTWFuYWdlcjogZmlsdGVyTWFuYWdlciwKICAgICAgcXVlcnk6IHF1ZXJ5LAogICAgICBzYXZlZElkOiBzYXZlZElkLAogICAgICBpbmRleFBhdHRlcm5zOiBpbmRleFBhdHRlcm5zCiAgICB9KTsKICB9IGVsc2UgaWYgKGZpZWxkID09PSAndGhyZWF0JykgewogICAgdmFyIHRocmVhdCA9ICgwLCBfZnAuZ2V0KShmaWVsZCwgZGF0YSkuZmlsdGVyKGZ1bmN0aW9uIChzaW5nbGVUaHJlYXQpIHsKICAgICAgcmV0dXJuIHNpbmdsZVRocmVhdC50YWN0aWMubmFtZSAhPT0gJ25vbmUnOwogICAgfSk7CiAgICByZXR1cm4gKDAsIF9oZWxwZXJzLmJ1aWxkVGhyZWF0RGVzY3JpcHRpb24pKHsKICAgICAgbGFiZWw6IGxhYmVsLAogICAgICB0aHJlYXQ6IHRocmVhdAogICAgfSk7CiAgfSBlbHNlIGlmIChmaWVsZCA9PT0gJ3JlZmVyZW5jZXMnKSB7CiAgICB2YXIgdXJscyA9ICgwLCBfZnAuZ2V0KShmaWVsZCwgZGF0YSk7CiAgICByZXR1cm4gKDAsIF9oZWxwZXJzLmJ1aWxkVXJsc0Rlc2NyaXB0aW9uKShsYWJlbCwgdXJscyk7CiAgfSBlbHNlIGlmIChmaWVsZCA9PT0gJ2ZhbHNlUG9zaXRpdmVzJykgewogICAgdmFyIHZhbHVlcyA9ICgwLCBfZnAuZ2V0KShmaWVsZCwgZGF0YSk7CiAgICByZXR1cm4gKDAsIF9oZWxwZXJzLmJ1aWxkVW5vcmRlcmVkTGlzdEFycmF5RGVzY3JpcHRpb24pKGxhYmVsLCBmaWVsZCwgdmFsdWVzKTsKICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoKDAsIF9mcC5nZXQpKGZpZWxkLCBkYXRhKSkpIHsKICAgIHZhciBfdmFsdWVzID0gKDAsIF9mcC5nZXQpKGZpZWxkLCBkYXRhKTsKCiAgICByZXR1cm4gKDAsIF9oZWxwZXJzLmJ1aWxkU3RyaW5nQXJyYXlEZXNjcmlwdGlvbikobGFiZWwsIGZpZWxkLCBfdmFsdWVzKTsKICB9IGVsc2UgaWYgKGZpZWxkID09PSAnc2V2ZXJpdHknKSB7CiAgICB2YXIgdmFsID0gKDAsIF9mcC5nZXQpKGZpZWxkLCBkYXRhKTsKICAgIHJldHVybiAoMCwgX2hlbHBlcnMuYnVpbGRTZXZlcml0eURlc2NyaXB0aW9uKShsYWJlbCwgdmFsKTsKICB9IGVsc2UgaWYgKGZpZWxkID09PSAndGltZWxpbmUnKSB7CiAgICB2YXIgX3RpbWVsaW5lJHRpdGxlOwoKICAgIHZhciB0aW1lbGluZSA9ICgwLCBfZnAuZ2V0KShmaWVsZCwgZGF0YSk7CiAgICByZXR1cm4gW3sKICAgICAgdGl0bGU6IGxhYmVsLAogICAgICBkZXNjcmlwdGlvbjogKF90aW1lbGluZSR0aXRsZSA9IHRpbWVsaW5lLnRpdGxlKSAhPT0gbnVsbCAmJiBfdGltZWxpbmUkdGl0bGUgIT09IHZvaWQgMCA/IF90aW1lbGluZSR0aXRsZSA6IF90cmFuc2xhdGlvbnMuREVGQVVMVF9USU1FTElORV9USVRMRQogICAgfV07CiAgfSBlbHNlIGlmIChmaWVsZCA9PT0gJ25vdGUnKSB7CiAgICB2YXIgX3ZhbCA9ICgwLCBfZnAuZ2V0KShmaWVsZCwgZGF0YSk7CgogICAgcmV0dXJuICgwLCBfaGVscGVycy5idWlsZE5vdGVEZXNjcmlwdGlvbikobGFiZWwsIF92YWwpOwogIH0gZWxzZSBpZiAoZmllbGQgPT09ICdydWxlVHlwZScpIHsKICAgIHZhciBydWxlVHlwZSA9ICgwLCBfZnAuZ2V0KShmaWVsZCwgZGF0YSk7CiAgICByZXR1cm4gKDAsIF9oZWxwZXJzLmJ1aWxkUnVsZVR5cGVEZXNjcmlwdGlvbikobGFiZWwsIHJ1bGVUeXBlKTsKICB9CgogIHZhciBkZXNjcmlwdGlvbiA9ICgwLCBfZnAuZ2V0KShmaWVsZCwgZGF0YSk7CgogIGlmICgoMCwgX2ZwLmlzTnVtYmVyKShkZXNjcmlwdGlvbikgfHwgISgwLCBfZnAuaXNFbXB0eSkoZGVzY3JpcHRpb24pKSB7CiAgICByZXR1cm4gW3sKICAgICAgdGl0bGU6IGxhYmVsLAogICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24KICAgIH1dOwogIH0KCiAgcmV0dXJuIFtdOwp9OwoKZXhwb3J0cy5nZXREZXNjcmlwdGlvbkl0ZW0gPSBnZXREZXNjcmlwdGlvbkl0ZW07"},null]}