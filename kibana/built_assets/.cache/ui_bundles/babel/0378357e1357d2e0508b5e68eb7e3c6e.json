{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/canvas/common/lib/autocomplete.js","dependencies":[{"path":"x-pack/legacy/plugins/canvas/common/lib/autocomplete.js","mtime":1589249551879},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0gfQoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhzb3VyY2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UiKTsgfQoKZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9lID0gdW5kZWZpbmVkOyB0cnkgeyBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5nZXRGbkFyZ0RlZkF0UG9zaXRpb24gPSBnZXRGbkFyZ0RlZkF0UG9zaXRpb247CmV4cG9ydHMuZ2V0QXV0b2NvbXBsZXRlU3VnZ2VzdGlvbnMgPSBnZXRBdXRvY29tcGxldGVTdWdnZXN0aW9uczsKCnZhciBfbG9kYXNoID0gcmVxdWlyZSgibG9kYXNoIik7Cgp2YXIgX2NvbW1vbiA9IHJlcXVpcmUoIkBrYm4vaW50ZXJwcmV0ZXIvY29tbW9uIik7Cgp2YXIgX2V4cHJlc3Npb25zID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3BsdWdpbnMvZXhwcmVzc2lvbnMiKTsKLyoKICogQ29weXJpZ2h0IEVsYXN0aWNzZWFyY2ggQi5WLiBhbmQvb3IgbGljZW5zZWQgdG8gRWxhc3RpY3NlYXJjaCBCLlYuIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gTGljZW5zZWQgdW5kZXIgdGhlIEVsYXN0aWMgTGljZW5zZTsKICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBFbGFzdGljIExpY2Vuc2UuCiAqLwovLyBAdHMtaWdub3JlIFVudHlwZWQgTGlicmFyeQoKCnZhciBNQVJLRVIgPSAnQ0FOVkFTX1NVR0dFU1RJT05fTUFSS0VSJzsgLy8gVHlwZWd1YXJkIGZvciBjaGVja2luZyBpZiBFeHByZXNzaW9uQXJnIGlzIGEgbmV3IGV4cHJlc3Npb24KCmZ1bmN0aW9uIGlzRXhwcmVzc2lvbihtYXliZUV4cHJlc3Npb24pIHsKICByZXR1cm4gX3R5cGVvZihtYXliZUV4cHJlc3Npb24ubm9kZSkgPT09ICdvYmplY3QnOwp9Ci8qKgogKiBHZW5lcmF0ZXMgdGhlIEFTVCB3aXRoIHRoZSBnaXZlbiBleHByZXNzaW9uIGFuZCB0aGVuIHJldHVybnMgdGhlIGZ1bmN0aW9uIGFuZCBhcmd1bWVudCBkZWZpbml0aW9ucwogKiBhdCB0aGUgZ2l2ZW4gcG9zaXRpb24gaW4gdGhlIGV4cHJlc3Npb24sIGlmIHRoZXJlIGFyZSBhbnkuCiAqLwoKCmZ1bmN0aW9uIGdldEZuQXJnRGVmQXRQb3NpdGlvbihzcGVjcywgZXhwcmVzc2lvbiwgcG9zaXRpb24pIHsKICB0cnkgewogICAgdmFyIGFzdCA9ICgwLCBfY29tbW9uLnBhcnNlKShleHByZXNzaW9uLCB7CiAgICAgIGFkZE1ldGE6IHRydWUKICAgIH0pOwoKICAgIHZhciBfZ2V0Rm5BcmdBdFBvc2l0aW9uID0gZ2V0Rm5BcmdBdFBvc2l0aW9uKGFzdCwgcG9zaXRpb24pLAogICAgICAgIG5ld0FzdCA9IF9nZXRGbkFyZ0F0UG9zaXRpb24uYXN0LAogICAgICAgIGZuSW5kZXggPSBfZ2V0Rm5BcmdBdFBvc2l0aW9uLmZuSW5kZXgsCiAgICAgICAgYXJnTmFtZSA9IF9nZXRGbkFyZ0F0UG9zaXRpb24uYXJnTmFtZSwKICAgICAgICBhcmdTdGFydCA9IF9nZXRGbkFyZ0F0UG9zaXRpb24uYXJnU3RhcnQsCiAgICAgICAgYXJnRW5kID0gX2dldEZuQXJnQXRQb3NpdGlvbi5hcmdFbmQ7CgogICAgdmFyIGZuID0gbmV3QXN0Lm5vZGUuY2hhaW5bZm5JbmRleF0ubm9kZTsKICAgIHZhciBmbkRlZiA9ICgwLCBfZXhwcmVzc2lvbnMuZ2V0QnlBbGlhcykoc3BlY3MsIGZuLmZ1bmN0aW9uKTsKCiAgICBpZiAoZm5EZWYgJiYgYXJnTmFtZSkgewogICAgICB2YXIgYXJnRGVmID0gKDAsIF9leHByZXNzaW9ucy5nZXRCeUFsaWFzKShmbkRlZi5hcmdzLCBhcmdOYW1lKTsKICAgICAgcmV0dXJuIHsKICAgICAgICBmbkRlZjogZm5EZWYsCiAgICAgICAgYXJnRGVmOiBhcmdEZWYsCiAgICAgICAgYXJnU3RhcnQ6IGFyZ1N0YXJ0LAogICAgICAgIGFyZ0VuZDogYXJnRW5kCiAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgZm5EZWY6IGZuRGVmCiAgICB9OwogIH0gY2F0Y2ggKGUpIHsvLyBGYWlsIHNpbGVudGx5CiAgfQoKICByZXR1cm4ge307Cn0KLyoqCiAqIEdldHMgYSBsaXN0IG9mIHN1Z2dlc3Rpb25zIGZvciB0aGUgZ2l2ZW4gZXhwcmVzc2lvbiBhdCB0aGUgZ2l2ZW4gcG9zaXRpb24uIEl0IGRvZXMgdGhpcyBieQogKiBpbnNlcnRpbmcgYSBtYXJrZXIgYXQgdGhlIGdpdmVuIHBvc2l0aW9uLCB0aGVuIHBhcnNpbmcgdGhlIHJlc3VsdGluZyBleHByZXNzaW9uLiBUaGlzIHdheSB3ZSBjYW4KICogc2VlIHdoYXQgdGhlIG1hcmtlciB3b3VsZCB0dXJuIGludG8sIHdoaWNoIHRlbGxzIHVzIHdoYXQgc29ydHMgb2YgdGhpbmdzIHRvIHN1Z2dlc3QuIEZvcgogKiBleGFtcGxlLCBpZiB0aGUgbWFya2VyIHR1cm5zIGludG8gYSBmdW5jdGlvbiBuYW1lLCB0aGVuIHdlIHN1Z2dlc3QgZnVuY3Rpb25zLiBJZiBpdCB0dXJucyBpbnRvCiAqIGFuIHVubmFtZWQgYXJndW1lbnQsIHdlIHN1Z2dlc3QgYXJndW1lbnQgbmFtZXMuIElmIGl0IHR1cm5zIGludG8gYSB2YWx1ZSwgd2Ugc3VnZ2VzdCB2YWx1ZXMuCiAqLwoKCmZ1bmN0aW9uIGdldEF1dG9jb21wbGV0ZVN1Z2dlc3Rpb25zKHNwZWNzLCBleHByZXNzaW9uLCBwb3NpdGlvbikgewogIHZhciB0ZXh0ID0gZXhwcmVzc2lvbi5zdWJzdHIoMCwgcG9zaXRpb24pICsgTUFSS0VSICsgZXhwcmVzc2lvbi5zdWJzdHIocG9zaXRpb24pOwoKICB0cnkgewogICAgdmFyIGFzdCA9ICgwLCBfY29tbW9uLnBhcnNlKSh0ZXh0LCB7CiAgICAgIGFkZE1ldGE6IHRydWUKICAgIH0pOwoKICAgIHZhciBfZ2V0Rm5BcmdBdFBvc2l0aW9uMiA9IGdldEZuQXJnQXRQb3NpdGlvbihhc3QsIHBvc2l0aW9uKSwKICAgICAgICBuZXdBc3QgPSBfZ2V0Rm5BcmdBdFBvc2l0aW9uMi5hc3QsCiAgICAgICAgZm5JbmRleCA9IF9nZXRGbkFyZ0F0UG9zaXRpb24yLmZuSW5kZXgsCiAgICAgICAgYXJnTmFtZSA9IF9nZXRGbkFyZ0F0UG9zaXRpb24yLmFyZ05hbWUsCiAgICAgICAgYXJnSW5kZXggPSBfZ2V0Rm5BcmdBdFBvc2l0aW9uMi5hcmdJbmRleCwKICAgICAgICBwYXJlbnRGbiA9IF9nZXRGbkFyZ0F0UG9zaXRpb24yLnBhcmVudEZuLAogICAgICAgIGNvbnRleHRGbiA9IF9nZXRGbkFyZ0F0UG9zaXRpb24yLmNvbnRleHRGbjsKCiAgICB2YXIgZm4gPSBuZXdBc3Qubm9kZS5jaGFpbltmbkluZGV4XS5ub2RlOwoKICAgIGlmIChwYXJlbnRGbiAmJiBmbi5mdW5jdGlvbi5pbmNsdWRlcyhNQVJLRVIpICYmIGFyZ05hbWUpIHsKICAgICAgLy8gV2UgYXJlIGluIGEgc3ViLWZ1bmN0aW9uIGxpa2UgYHBsb3QgZm9udD17fWAKICAgICAgcmV0dXJuIGdldFN1YkZuTmFtZVN1Z2dlc3Rpb25zKHNwZWNzLCBuZXdBc3QsIGZuSW5kZXgsIHBhcmVudEZuLCBhcmdOYW1lLCBjb250ZXh0Rm4pOwogICAgfQoKICAgIGlmIChmbi5mdW5jdGlvbi5pbmNsdWRlcyhNQVJLRVIpKSB7CiAgICAgIHJldHVybiBnZXRGbk5hbWVTdWdnZXN0aW9ucyhzcGVjcywgbmV3QXN0LCBmbkluZGV4KTsKICAgIH0KCiAgICBpZiAoYXJnTmFtZSA9PT0gJ18nICYmIGFyZ0luZGV4ICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIGdldEFyZ05hbWVTdWdnZXN0aW9ucyhzcGVjcywgbmV3QXN0LCBmbkluZGV4LCBhcmdOYW1lLCBhcmdJbmRleCk7CiAgICB9CgogICAgaWYgKGFyZ05hbWUgJiYgYXJnSW5kZXggIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gZ2V0QXJnVmFsdWVTdWdnZXN0aW9ucyhzcGVjcywgbmV3QXN0LCBmbkluZGV4LCBhcmdOYW1lLCBhcmdJbmRleCk7CiAgICB9CiAgfSBjYXRjaCAoZSkgey8vIEZhaWwgc2lsZW50bHkKICB9CgogIHJldHVybiBbXTsKfQovKioKICAgIEVhY2ggZW50cnkgb2YgdGhlIG5vZGUuY2hhaW4gaGFzIGl0J3Mgb3ZlcmFsbCBzdGFydCBhbmQgZW5kIHBvc2l0aW9uLiAgRm9yIGluc3RhbmNlLAogICAgZ2l2ZW4gdGhlIGV4cHJlc3Npb24gImxpbmsgYXJnPSdzb21ldGhpbmcnIHwgcmVuZGVyIiB0aGUgbGluayBmdW5jdGlvbnMgc3RhcnQgcG9zaXRpb24gaXMgMCBhbmQgZW5kCiAgICBwb3NpdGlvbiBpcyAyMS4KCiAgICBUaGlzIGZ1bmN0aW9uIGlzIGdpdmVuIHRoZSBmdWxsIGFzdCBhbmQgdGhlIGN1cnJlbnQgY3Vyc29yIHBvc2l0aW9uIGluIHRoZSBleHByZXNzaW9uIHN0cmluZy4KCiAgICBJdCByZXR1cm5zIHdoaWNoIGZ1bmN0aW9uIHRoZSBjdXJzb3IgaXMgaW4sIGFzIHdlbGwgYXMgd2hpY2ggYXJndW1lbnQgZm9yIHRoYXQgZnVuY3Rpb24gdGhlIGN1cnNvciBpcyBpbgogICAgaWYgYW55LgoKICAgIElmIHRoZSBleHByZXNzaW9uIGlzIGZvdW5kIGluIGEgc3ViLWV4cHJlc3Npb24sIHRoaXMgaWRlbnRpZmllcyB0aGUgYXJndW1lbnQgbmFtZSBmb3IgcmV0dXJuIHR5cGUgY2hlY2tpbmcuCiAgICBJdCBhbHNvIGlkZW50aWZpZXMgdGhlIGNvbnRleHQgZnVuY3Rpb24sIHdoaWNoIG1heSBub3QgYmUgdGhlIHNhbWUgYXMgdGhlIGN1cnJlbnQgZnVuY3Rpb24uCiAgICBJbiB0aGlzIGV4YW1wbGU6CgogICAgYG1hdGggInJhbmRvbSgpIiB8IHByb2dyZXNzIGxhYmVsPXthcyAidmFsdWUiIHwgbWF0aCAiZGl2aWRlKHZhbHVlLCAyKSIgfCBmb3JtYXRudW1iZXIgIjAlIn1gCgogICAgVGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgYGxhYmVsYCBmdW5jdGlvbiBpcyBhbHdheXMgZXhwZWN0ZWQgdG8gYmUgYSBzdHJpbmcgb3IgYm9vbGVhbi4KICAgIFRoZSBjb250ZXh0IGZ1bmN0aW9uIGZvciB0aGUgZmlyc3QgZXhwcmVzc2lvbiBpbiB0aGUgY2hhaW4gaXMgYG1hdGhgLCBzaW5jZSBpdCdzIHRoZSBwYXJlbnQncyBwcmV2aW91cwogICAgaXRlbS4gVGhlIGNvbnRleHQgZnVuY3Rpb24gZm9yIGBmb3JtYXRudW1iZXJgIGlzIHRoZSByZXR1cm4gb2YgYG1hdGggImRpdmlkZSh2YWx1ZSwgMikiYC4KKi8KCgpmdW5jdGlvbiBnZXRGbkFyZ0F0UG9zaXRpb24oYXN0LCBwb3NpdGlvbikgewogIHZhciBmbkluZGV4ID0gYXN0Lm5vZGUuY2hhaW4uZmluZEluZGV4KGZ1bmN0aW9uIChmbikgewogICAgcmV0dXJuIGZuLnN0YXJ0IDw9IHBvc2l0aW9uICYmIHBvc2l0aW9uIDw9IGZuLmVuZDsKICB9KTsKICB2YXIgZm4gPSBhc3Qubm9kZS5jaGFpbltmbkluZGV4XTsKCiAgZm9yICh2YXIgX2kgPSAwLCBfT2JqZWN0JGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhmbi5ub2RlLmFyZ3VtZW50cyk7IF9pIDwgX09iamVjdCRlbnRyaWVzLmxlbmd0aDsgX2krKykgewogICAgdmFyIF9PYmplY3QkZW50cmllcyRfaSA9IF9zbGljZWRUb0FycmF5KF9PYmplY3QkZW50cmllc1tfaV0sIDIpLAogICAgICAgIGFyZ05hbWUgPSBfT2JqZWN0JGVudHJpZXMkX2lbMF0sCiAgICAgICAgYXJnVmFsdWVzID0gX09iamVjdCRlbnRyaWVzJF9pWzFdOwoKICAgIGZvciAodmFyIGFyZ0luZGV4ID0gMDsgYXJnSW5kZXggPCBhcmdWYWx1ZXMubGVuZ3RoOyBhcmdJbmRleCsrKSB7CiAgICAgIHZhciB2YWx1ZSA9IGFyZ1ZhbHVlc1thcmdJbmRleF07CiAgICAgIHZhciBhcmdTdGFydCA9IHZhbHVlLnN0YXJ0OwogICAgICB2YXIgYXJnRW5kID0gdmFsdWUuZW5kOwoKICAgICAgaWYgKGFyZ05hbWUgIT09ICdfJykgewogICAgICAgIC8vIElmIGFuIGFyZyBuYW1lIGlzIHNwZWNpZmllZCwgZXhwYW5kIG91ciBzdGFydCBwb3NpdGlvbiB0byBpbmNsdWRlCiAgICAgICAgLy8gdGhlIGFyZyBuYW1lIHBsdXMgdGhlIGA9YCBjaGFyYWN0ZXIKICAgICAgICBhcmdTdGFydCA9IGFyZ1N0YXJ0IC0gKGFyZ05hbWUubGVuZ3RoICsgMSk7IC8vIElmIHRoZSBhcmcgdmFsdWUgaXMgYW4gZXhwcmVzc2lvbiwgZXhwYW5kIG91ciBzdGFydCBhbmQgZW5kIHBvc2l0aW9uCiAgICAgICAgLy8gdG8gaW5jbHVkZSB0aGUgb3BlbmluZyBhbmQgY2xvc2luZyBicmFjZXMKCiAgICAgICAgaWYgKHZhbHVlLm5vZGUgIT09IG51bGwgJiYgaXNFeHByZXNzaW9uKHZhbHVlKSkgewogICAgICAgICAgYXJnU3RhcnQtLTsKICAgICAgICAgIGFyZ0VuZCsrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGFyZ1N0YXJ0IDw9IHBvc2l0aW9uICYmIHBvc2l0aW9uIDw9IGFyZ0VuZCkgewogICAgICAgIC8vIElmIHRoZSBjdXJyZW50IHBvc2l0aW9uIGlzIG9uIGFuIGV4cHJlc3Npb24gYW5kIE5PVCBvbiB0aGUgZXhwcmVzc2lvbidzCiAgICAgICAgLy8gYXJndW1lbnQgbmFtZSAoYGZvbnQ9YCBmb3IgZXhhbXBsZSksIHJlY3Vyc2Ugd2l0aGluIHRoZSBleHByZXNzaW9uCiAgICAgICAgaWYgKHZhbHVlLm5vZGUgIT09IG51bGwgJiYgaXNFeHByZXNzaW9uKHZhbHVlKSAmJiAoYXJnTmFtZSA9PT0gJ18nIHx8ICEoYXJnU3RhcnQgPD0gcG9zaXRpb24gJiYgcG9zaXRpb24gPD0gYXJnU3RhcnQgKyBhcmdOYW1lLmxlbmd0aCArIDEpKSkgewogICAgICAgICAgdmFyIHJlc3VsdCA9IGdldEZuQXJnQXRQb3NpdGlvbih2YWx1ZSwgcG9zaXRpb24pOwoKICAgICAgICAgIGlmICghcmVzdWx0LmFyZ05hbWUpIHsKICAgICAgICAgICAgdmFyIGNvbnRleHRGbiA9IHJlc3VsdC5mbkluZGV4ID09PSAwID8gZm5JbmRleCA+IDAgPyBhc3Qubm9kZS5jaGFpbltmbkluZGV4IC0gMV0ubm9kZS5mdW5jdGlvbiA6IG51bGwgOiByZXN1bHQuYXN0Lm5vZGUuY2hhaW5bcmVzdWx0LmZuSW5kZXggLSAxXS5ub2RlLmZ1bmN0aW9uOwogICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgcmVzdWx0LCB7CiAgICAgICAgICAgICAgYXJnTmFtZTogYXJnTmFtZSwKICAgICAgICAgICAgICBhcmdJbmRleDogYXJnSW5kZXgsCiAgICAgICAgICAgICAgYXJnU3RhcnQ6IGFyZ1N0YXJ0LAogICAgICAgICAgICAgIGFyZ0VuZDogYXJnRW5kLAogICAgICAgICAgICAgIHBhcmVudEZuOiBmbi5ub2RlLmZ1bmN0aW9uLAogICAgICAgICAgICAgIGNvbnRleHRGbjogY29udGV4dEZuCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gewogICAgICAgICAgYXN0OiBhc3QsCiAgICAgICAgICBmbkluZGV4OiBmbkluZGV4LAogICAgICAgICAgYXJnTmFtZTogYXJnTmFtZSwKICAgICAgICAgIGFyZ0luZGV4OiBhcmdJbmRleCwKICAgICAgICAgIGFyZ1N0YXJ0OiBhcmdTdGFydCwKICAgICAgICAgIGFyZ0VuZDogYXJnRW5kCiAgICAgICAgfTsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIHsKICAgIGFzdDogYXN0LAogICAgZm5JbmRleDogZm5JbmRleAogIH07Cn0KCmZ1bmN0aW9uIGdldEZuTmFtZVN1Z2dlc3Rpb25zKHNwZWNzLCBhc3QsIGZuSW5kZXgpIHsKICAvLyBGaWx0ZXIgdGhlIGxpc3Qgb2YgZnVuY3Rpb25zIGJ5IHRoZSB0ZXh0IGF0IHRoZSBtYXJrZXIKICB2YXIgX2FzdCRub2RlJGNoYWluJGZuSW5kID0gYXN0Lm5vZGUuY2hhaW5bZm5JbmRleF0sCiAgICAgIHN0YXJ0ID0gX2FzdCRub2RlJGNoYWluJGZuSW5kLnN0YXJ0LAogICAgICBlbmQgPSBfYXN0JG5vZGUkY2hhaW4kZm5JbmQuZW5kOyAvLyBTb3J0IGJ5IHdoZXRoZXIgb3Igbm90IHRoZSBmdW5jdGlvbiBleHBlY3RzIHRoZSBwcmV2aW91cyBmdW5jdGlvbidzIHJldHVybiB0eXBlLCB0aGVuIGJ5CiAgLy8gd2hldGhlciBvciBub3QgdGhlIGZ1bmN0aW9uIG5hbWUgc3RhcnRzIHdpdGggdGhlIHRleHQgYXQgdGhlIG1hcmtlciwgdGhlbiBhbHBoYWJldGljYWxseQoKICB2YXIgcHJldkZuID0gYXN0Lm5vZGUuY2hhaW5bZm5JbmRleCAtIDFdOwogIHZhciBuZXh0Rm4gPSBhc3Qubm9kZS5jaGFpbi5sZW5ndGggPiBmbkluZGV4ICsgMSA/IGFzdC5ub2RlLmNoYWluW2ZuSW5kZXggKyAxXSA6IG51bGw7CiAgdmFyIHByZXZGbkRlZiA9IHByZXZGbiAmJiAoMCwgX2V4cHJlc3Npb25zLmdldEJ5QWxpYXMpKHNwZWNzLCBwcmV2Rm4ubm9kZS5mdW5jdGlvbik7CiAgdmFyIHByZXZGblR5cGUgPSBwcmV2Rm5EZWYgJiYgcHJldkZuRGVmLnR5cGU7CiAgdmFyIG5leHRGbkRlZiA9IG5leHRGbiAmJiAoMCwgX2V4cHJlc3Npb25zLmdldEJ5QWxpYXMpKHNwZWNzLCBuZXh0Rm4ubm9kZS5mdW5jdGlvbik7CiAgdmFyIG5leHRGbklucHV0VHlwZXMgPSBuZXh0Rm5EZWYgJiYgbmV4dEZuRGVmLmlucHV0VHlwZXM7CiAgdmFyIGZuRGVmcyA9IHNwZWNzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgIHZhciBhU2NvcmUgPSBnZXRTY29yZShhLCBwcmV2Rm5UeXBlLCBuZXh0Rm5JbnB1dFR5cGVzLCBmYWxzZSk7CiAgICB2YXIgYlNjb3JlID0gZ2V0U2NvcmUoYiwgcHJldkZuVHlwZSwgbmV4dEZuSW5wdXRUeXBlcywgZmFsc2UpOwoKICAgIGlmIChhU2NvcmUgPT09IGJTY29yZSkgewogICAgICByZXR1cm4gYS5uYW1lIDwgYi5uYW1lID8gLTEgOiAxOwogICAgfQoKICAgIHJldHVybiBhU2NvcmUgPiBiU2NvcmUgPyAtMSA6IDE7CiAgfSk7CiAgcmV0dXJuIGZuRGVmcy5tYXAoZnVuY3Rpb24gKGZuRGVmKSB7CiAgICByZXR1cm4gewogICAgICB0eXBlOiAnZnVuY3Rpb24nLAogICAgICB0ZXh0OiAiIi5jb25jYXQoZm5EZWYubmFtZSwgIiAiKSwKICAgICAgc3RhcnQ6IHN0YXJ0LAogICAgICBlbmQ6IGVuZCAtIE1BUktFUi5sZW5ndGgsCiAgICAgIGZuRGVmOiBmbkRlZgogICAgfTsKICB9KTsKfQoKZnVuY3Rpb24gZ2V0U3ViRm5OYW1lU3VnZ2VzdGlvbnMoc3BlY3MsIGFzdCwgZm5JbmRleCwgcGFyZW50Rm4sIHBhcmVudEZuQXJnTmFtZSwgY29udGV4dEZuKSB7CiAgLy8gRmlsdGVyIHRoZSBsaXN0IG9mIGZ1bmN0aW9ucyBieSB0aGUgdGV4dCBhdCB0aGUgbWFya2VyCiAgdmFyIF9hc3Qkbm9kZSRjaGFpbiRmbkluZDIgPSBhc3Qubm9kZS5jaGFpbltmbkluZGV4XSwKICAgICAgc3RhcnQgPSBfYXN0JG5vZGUkY2hhaW4kZm5JbmQyLnN0YXJ0LAogICAgICBlbmQgPSBfYXN0JG5vZGUkY2hhaW4kZm5JbmQyLmVuZCwKICAgICAgZm4gPSBfYXN0JG5vZGUkY2hhaW4kZm5JbmQyLm5vZGU7CiAgdmFyIHF1ZXJ5ID0gZm4uZnVuY3Rpb24ucmVwbGFjZShNQVJLRVIsICcnKTsKICB2YXIgbWF0Y2hpbmdGbkRlZnMgPSBzcGVjcy5maWx0ZXIoZnVuY3Rpb24gKF9yZWYpIHsKICAgIHZhciBuYW1lID0gX3JlZi5uYW1lOwogICAgcmV0dXJuIHRleHRNYXRjaGVzKG5hbWUsIHF1ZXJ5KTsKICB9KTsKICB2YXIgcGFyZW50Rm5EZWYgPSAoMCwgX2V4cHJlc3Npb25zLmdldEJ5QWxpYXMpKHNwZWNzLCBwYXJlbnRGbik7CiAgdmFyIG1hdGNoaW5nQXJnRGVmID0gKDAsIF9leHByZXNzaW9ucy5nZXRCeUFsaWFzKShwYXJlbnRGbkRlZi5hcmdzLCBwYXJlbnRGbkFyZ05hbWUpOwoKICBpZiAoIW1hdGNoaW5nQXJnRGVmKSB7CiAgICByZXR1cm4gW107CiAgfQoKICB2YXIgY29udGV4dEZuRGVmID0gY29udGV4dEZuID8gKDAsIF9leHByZXNzaW9ucy5nZXRCeUFsaWFzKShzcGVjcywgY29udGV4dEZuKSA6IG51bGw7CiAgdmFyIGNvbnRleHRGblR5cGUgPSBjb250ZXh0Rm5EZWYgJiYgY29udGV4dEZuRGVmLnR5cGU7CiAgdmFyIGV4cGVjdGVkUmV0dXJuVHlwZXMgPSBtYXRjaGluZ0FyZ0RlZi50eXBlczsKICB2YXIgZm5EZWZzID0gbWF0Y2hpbmdGbkRlZnMuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgdmFyIGFTY29yZSA9IGdldFNjb3JlKGEsIGNvbnRleHRGblR5cGUsIGV4cGVjdGVkUmV0dXJuVHlwZXMsIHRydWUpOwogICAgdmFyIGJTY29yZSA9IGdldFNjb3JlKGIsIGNvbnRleHRGblR5cGUsIGV4cGVjdGVkUmV0dXJuVHlwZXMsIHRydWUpOwoKICAgIGlmIChhU2NvcmUgPT09IGJTY29yZSkgewogICAgICByZXR1cm4gYS5uYW1lIDwgYi5uYW1lID8gLTEgOiAxOwogICAgfQoKICAgIHJldHVybiBhU2NvcmUgPiBiU2NvcmUgPyAtMSA6IDE7CiAgfSk7CiAgcmV0dXJuIGZuRGVmcy5tYXAoZnVuY3Rpb24gKGZuRGVmKSB7CiAgICByZXR1cm4gewogICAgICB0eXBlOiAnZnVuY3Rpb24nLAogICAgICB0ZXh0OiBmbkRlZi5uYW1lICsgJyAnLAogICAgICBzdGFydDogc3RhcnQsCiAgICAgIGVuZDogZW5kIC0gTUFSS0VSLmxlbmd0aCwKICAgICAgZm5EZWY6IGZuRGVmCiAgICB9OwogIH0pOwp9CgpmdW5jdGlvbiBnZXRTY29yZShmdW5jLCBjb250ZXh0VHlwZSwgcmV0dXJuVHlwZXMsIGlzU3ViRnVuYykgewogIHZhciBzY29yZSA9IDA7CgogIGlmICghY29udGV4dFR5cGUpIHsKICAgIGNvbnRleHRUeXBlID0gJ251bGwnOwogIH0KCiAgdmFyIGlucHV0VHlwZXNOb3JtYWxpemVkID0gZnVuYy5pbnB1dFR5cGVzIHx8IFtdOwoKICBpZiAoaXNTdWJGdW5jKSB7CiAgICBpZiAocmV0dXJuVHlwZXMgJiYgZnVuYy50eXBlKSB7CiAgICAgIC8vIElmIGluIGEgc3ViLWV4cHJlc3Npb24sIGZhdm9yIHR5cGVzIHRoYXQgbWF0Y2ggdGhlIGV4cGVjdGVkIHJldHVybiB0eXBlIGZvciB0aGUgYXJndW1lbnQKICAgICAgLy8gd2l0aCB0b3AgcmVzdWx0cyBtYXRjaGluZyB0aGUgcGFzc2VkIGluIGNvbnRleHQKICAgICAgaWYgKHJldHVyblR5cGVzLmxlbmd0aCAmJiByZXR1cm5UeXBlcy5pbmNsdWRlcyhmdW5jLnR5cGUpKSB7CiAgICAgICAgc2NvcmUrKzsKCiAgICAgICAgaWYgKGlucHV0VHlwZXNOb3JtYWxpemVkLmluY2x1ZGVzKGNvbnRleHRUeXBlKSkgewogICAgICAgICAgc2NvcmUrKzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9IGVsc2UgewogICAgaWYgKGZ1bmMuaW5wdXRUeXBlcykgewogICAgICB2YXIgZXhwZWN0c051bGwgPSBpbnB1dFR5cGVzTm9ybWFsaXplZC5pbmNsdWRlcygnbnVsbCcpOwoKICAgICAgaWYgKCFleHBlY3RzTnVsbCAmJiBjb250ZXh0VHlwZSAhPT0gJ251bGwnKSB7CiAgICAgICAgLy8gSWYgbm90IGluIGEgc3ViLWV4cHJlc3Npb24gYW5kIHRoZXJlJ3MgYSBwcmVjZWRpbmcgZnVuY3Rpb24sCiAgICAgICAgLy8gZmF2b3IgZnVuY3Rpb25zIHRoYXQgZXhwZWN0IGEgY29udGV4dCB3aXRoIHRvcCByZXN1bHRzIG1hdGNoaW5nIHRoZSBwYXNzZWQgaW4gY29udGV4dAogICAgICAgIHNjb3JlKys7CgogICAgICAgIGlmIChmdW5jLmlucHV0VHlwZXMuaW5jbHVkZXMoY29udGV4dFR5cGUpKSB7CiAgICAgICAgICBzY29yZSsrOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChleHBlY3RzTnVsbCAmJiBjb250ZXh0VHlwZSA9PT0gJ251bGwnKSB7CiAgICAgICAgLy8gSWYgbm90IGluIGEgc3ViLWV4cHJlc3Npb24gYW5kIHRoZXJlJ3MgTk9UIGEgcHJlY2VkaW5nIGZ1bmN0aW9uLAogICAgICAgIC8vIGZhdm9yIGZ1bmN0aW9ucyB0aGF0IGRvbid0IGV4cGVjdCBhbnl0aGluZyBiZWluZyBwYXNzZWQgaW4gd2l0aCB0b3AgcmVzdWx0cyByZXR1cm5pbmcgYSBub24tbnVsbAogICAgICAgIHNjb3JlKys7CgogICAgICAgIGlmIChmdW5jLnR5cGUgJiYgZnVuYy50eXBlICE9PSAnbnVsbCcpIHsKICAgICAgICAgIHNjb3JlKys7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4gc2NvcmU7Cn0KCmZ1bmN0aW9uIGdldEFyZ05hbWVTdWdnZXN0aW9ucyhzcGVjcywgYXN0LCBmbkluZGV4LCBhcmdOYW1lLCBhcmdJbmRleCkgewogIC8vIEdldCB0aGUgbGlzdCBvZiBhcmdzIGZyb20gdGhlIGZ1bmN0aW9uIGRlZmluaXRpb24KICB2YXIgZm4gPSBhc3Qubm9kZS5jaGFpbltmbkluZGV4XS5ub2RlOwogIHZhciBmbkRlZiA9ICgwLCBfZXhwcmVzc2lvbnMuZ2V0QnlBbGlhcykoc3BlY3MsIGZuLmZ1bmN0aW9uKTsKCiAgaWYgKCFmbkRlZikgewogICAgcmV0dXJuIFtdOwogIH0gLy8gV2UgdXNlIHRoZSBleGFjdCB0ZXh0IGluc3RlYWQgb2YgdGhlIHZhbHVlIGJlY2F1c2UgaXQgaXMgYWx3YXlzIGEgc3RyaW5nIGFuZCBtaWdodCBiZSBxdW90ZWQKCgogIHZhciBfZm4kYXJndW1lbnRzJGFyZ05hbWUgPSBmbi5hcmd1bWVudHNbYXJnTmFtZV1bYXJnSW5kZXhdLAogICAgICBzdGFydCA9IF9mbiRhcmd1bWVudHMkYXJnTmFtZS5zdGFydCwKICAgICAgZW5kID0gX2ZuJGFyZ3VtZW50cyRhcmdOYW1lLmVuZDsgLy8gRmlsdGVyIHRoZSBsaXN0IG9mIGFyZ3MgYnkgdGhvc2Ugd2hpY2ggYXJlbid0IGFscmVhZHkgcHJlc2VudCAodW5sZXNzIHRoZXkgYWxsb3cgbXVsdGkpCgogIHZhciBhcmdFbnRyaWVzID0gT2JqZWN0LmVudHJpZXMoZm4uYXJndW1lbnRzKS5tYXAoZnVuY3Rpb24gKF9yZWYyKSB7CiAgICB2YXIgX3JlZjMgPSBfc2xpY2VkVG9BcnJheShfcmVmMiwgMiksCiAgICAgICAgbmFtZSA9IF9yZWYzWzBdLAogICAgICAgIHZhbHVlcyA9IF9yZWYzWzFdOwoKICAgIHJldHVybiBbbmFtZSwgdmFsdWVzLmZpbHRlcihmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgcmV0dXJuICF2YWx1ZS50ZXh0LmluY2x1ZGVzKE1BUktFUik7CiAgICB9KV07CiAgfSk7CiAgdmFyIHVudXNlZEFyZ0RlZnMgPSBPYmplY3QuZW50cmllcyhmbkRlZi5hcmdzKS5maWx0ZXIoZnVuY3Rpb24gKF9yZWY0KSB7CiAgICB2YXIgX3JlZjUgPSBfc2xpY2VkVG9BcnJheShfcmVmNCwgMiksCiAgICAgICAgbWF0Y2hpbmdBcmdOYW1lID0gX3JlZjVbMF0sCiAgICAgICAgbWF0Y2hpbmdBcmdEZWYgPSBfcmVmNVsxXTsKCiAgICBpZiAobWF0Y2hpbmdBcmdEZWYubXVsdGkpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuICFhcmdFbnRyaWVzLnNvbWUoZnVuY3Rpb24gKF9yZWY2KSB7CiAgICAgIHZhciBfcmVmNyA9IF9zbGljZWRUb0FycmF5KF9yZWY2LCAyKSwKICAgICAgICAgIG5hbWUgPSBfcmVmN1swXSwKICAgICAgICAgIHZhbHVlcyA9IF9yZWY3WzFdOwoKICAgICAgcmV0dXJuIHZhbHVlcy5sZW5ndGggPiAwICYmIChuYW1lID09PSBtYXRjaGluZ0FyZ05hbWUgfHwgKG1hdGNoaW5nQXJnRGVmLmFsaWFzZXMgfHwgW10pLmluY2x1ZGVzKG5hbWUpKTsKICAgIH0pOwogIH0pOwogIHZhciBhcmdEZWZzID0gdW51c2VkQXJnRGVmcy5tYXAoZnVuY3Rpb24gKF9yZWY4KSB7CiAgICB2YXIgX3JlZjkgPSBfc2xpY2VkVG9BcnJheShfcmVmOCwgMiksCiAgICAgICAgbmFtZSA9IF9yZWY5WzBdLAogICAgICAgIGFyZyA9IF9yZWY5WzFdOwoKICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKHsKICAgICAgbmFtZTogbmFtZQogICAgfSwgYXJnKTsKICB9KS5zb3J0KHVubmFtZWRBcmdDb21wYXJhdG9yKTsKICByZXR1cm4gYXJnRGVmcy5tYXAoZnVuY3Rpb24gKGFyZ0RlZikgewogICAgcmV0dXJuIHsKICAgICAgdHlwZTogJ2FyZ3VtZW50JywKICAgICAgdGV4dDogYXJnRGVmLm5hbWUgKyAnPScsCiAgICAgIHN0YXJ0OiBzdGFydCwKICAgICAgZW5kOiBlbmQgLSBNQVJLRVIubGVuZ3RoLAogICAgICBhcmdEZWY6IGFyZ0RlZgogICAgfTsKICB9KTsKfQoKZnVuY3Rpb24gZ2V0QXJnVmFsdWVTdWdnZXN0aW9ucyhzcGVjcywgYXN0LCBmbkluZGV4LCBhcmdOYW1lLCBhcmdJbmRleCkgewogIC8vIEdldCB0aGUgbGlzdCBvZiB2YWx1ZXMgZnJvbSB0aGUgYXJndW1lbnQgZGVmaW5pdGlvbgogIHZhciBmbiA9IGFzdC5ub2RlLmNoYWluW2ZuSW5kZXhdLm5vZGU7CiAgdmFyIGZuRGVmID0gKDAsIF9leHByZXNzaW9ucy5nZXRCeUFsaWFzKShzcGVjcywgZm4uZnVuY3Rpb24pOwoKICBpZiAoIWZuRGVmKSB7CiAgICByZXR1cm4gW107CiAgfQoKICB2YXIgYXJnRGVmID0gKDAsIF9leHByZXNzaW9ucy5nZXRCeUFsaWFzKShmbkRlZi5hcmdzLCBhcmdOYW1lKTsKCiAgaWYgKCFhcmdEZWYpIHsKICAgIHJldHVybiBbXTsKICB9IC8vIEdldCBzdWdnZXN0aW9ucyBmcm9tIHRoZSBhcmd1bWVudCBkZWZpbml0aW9uLCBpbmNsdWRpbmcgdGhlIGRlZmF1bHQKCgogIHZhciBfZm4kYXJndW1lbnRzJGFyZ05hbWUyID0gZm4uYXJndW1lbnRzW2FyZ05hbWVdW2FyZ0luZGV4XSwKICAgICAgc3RhcnQgPSBfZm4kYXJndW1lbnRzJGFyZ05hbWUyLnN0YXJ0LAogICAgICBlbmQgPSBfZm4kYXJndW1lbnRzJGFyZ05hbWUyLmVuZCwKICAgICAgbm9kZSA9IF9mbiRhcmd1bWVudHMkYXJnTmFtZTIubm9kZTsKCiAgaWYgKHR5cGVvZiBub2RlICE9PSAnc3RyaW5nJykgewogICAgcmV0dXJuIFtdOwogIH0KCiAgdmFyIGFyZ09wdGlvbnMgPSBhcmdEZWYub3B0aW9ucyA/IGFyZ0RlZi5vcHRpb25zIDogW107CgogIHZhciBzdWdnZXN0aW9ucyA9IF90b0NvbnN1bWFibGVBcnJheShhcmdPcHRpb25zKTsKCiAgaWYgKGFyZ0RlZi5kZWZhdWx0ICE9PSB1bmRlZmluZWQpIHsKICAgIHN1Z2dlc3Rpb25zLnB1c2goYXJnRGVmLmRlZmF1bHQpOwogIH0KCiAgcmV0dXJuICgwLCBfbG9kYXNoLnVuaXEpKHN1Z2dlc3Rpb25zKS5tYXAoZnVuY3Rpb24gKHZhbHVlKSB7CiAgICB2YXIgdGV4dCA9IG1heWJlUXVvdGUodmFsdWUpICsgJyAnOwogICAgcmV0dXJuIHsKICAgICAgc3RhcnQ6IHN0YXJ0LAogICAgICBlbmQ6IGVuZCAtIE1BUktFUi5sZW5ndGgsCiAgICAgIHR5cGU6ICd2YWx1ZScsCiAgICAgIHRleHQ6IHRleHQKICAgIH07CiAgfSk7Cn0KCmZ1bmN0aW9uIHRleHRNYXRjaGVzKHRleHQsIHF1ZXJ5KSB7CiAgcmV0dXJuIHRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpLnRyaW0oKSk7Cn0KCmZ1bmN0aW9uIG1heWJlUXVvdGUodmFsdWUpIHsKICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgewogICAgaWYgKHZhbHVlLm1hdGNoKC9eXHsuKlx9JC8pKSB7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KCiAgICByZXR1cm4gIlwiIi5jb25jYXQodmFsdWUucmVwbGFjZSgvIi9nLCAnXFwiJyksICJcIiIpOwogIH0KCiAgcmV0dXJuIHZhbHVlOwp9CgpmdW5jdGlvbiB1bm5hbWVkQXJnQ29tcGFyYXRvcihhLCBiKSB7CiAgcmV0dXJuIChiLmFsaWFzZXMgJiYgYi5hbGlhc2VzLmluY2x1ZGVzKCdfJykgPyAxIDogMCkgLSAoYS5hbGlhc2VzICYmIGEuYWxpYXNlcy5pbmNsdWRlcygnXycpID8gMSA6IDApOwp9"},null]}