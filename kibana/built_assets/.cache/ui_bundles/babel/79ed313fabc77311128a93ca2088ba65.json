{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/lens/public/editor_frame_service/editor_frame/suggestion_panel.js","dependencies":[{"path":"x-pack/legacy/plugins/lens/public/editor_frame_service/editor_frame/suggestion_panel.js","mtime":1589249552304},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlN1Z2dlc3Rpb25QYW5lbCA9IFN1Z2dlc3Rpb25QYW5lbDsKCnZhciBfbG9kYXNoID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJsb2Rhc2giKSk7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3JlYWN0MiA9IHJlcXVpcmUoIkBrYm4vaTE4bi9yZWFjdCIpOwoKdmFyIF9ldWkgPSByZXF1aXJlKCJAZWxhc3RpYy9ldWkiKTsKCnZhciBfY29tbW9uID0gcmVxdWlyZSgiQGtibi9pbnRlcnByZXRlci9jb21tb24iKTsKCnZhciBfaTE4biA9IHJlcXVpcmUoIkBrYm4vaTE4biIpOwoKdmFyIF9jbGFzc25hbWVzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJjbGFzc25hbWVzIikpOwoKdmFyIF9zdWdnZXN0aW9uX2hlbHBlcnMgPSByZXF1aXJlKCIuL3N1Z2dlc3Rpb25faGVscGVycyIpOwoKdmFyIF9leHByZXNzaW9uX2hlbHBlcnMgPSByZXF1aXJlKCIuL2V4cHJlc3Npb25faGVscGVycyIpOwoKdmFyIF9kZWJvdW5jZWRfY29tcG9uZW50ID0gcmVxdWlyZSgiLi4vLi4vZGVib3VuY2VkX2NvbXBvbmVudCIpOwoKdmFyIF9sZW5zX3VpX3RlbGVtZXRyeSA9IHJlcXVpcmUoIi4uLy4uL2xlbnNfdWlfdGVsZW1ldHJ5Iik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9Cgp2YXIgTUFYX1NVR0dFU1RJT05TX0RJU1BMQVlFRCA9IDU7IC8vIFRPRE86IFJlbW92ZSB0aGlzIDxhbnk+IHdoZW4gdXBzdHJlYW0gZml4IGlzIG1lcmdlZCBodHRwczovL2dpdGh1Yi5jb20vZWxhc3RpYy9ldWkvaXNzdWVzLzIzMjkKLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCgp2YXIgRXVpUGFuZWxGaXhlZCA9IF9ldWkuRXVpUGFuZWw7Cgp2YXIgUHJldmlld1JlbmRlcmVyID0gZnVuY3Rpb24gUHJldmlld1JlbmRlcmVyKF9yZWYpIHsKICB2YXIgd2l0aExhYmVsID0gX3JlZi53aXRoTGFiZWwsCiAgICAgIEV4cHJlc3Npb25SZW5kZXJlckNvbXBvbmVudCA9IF9yZWYuRXhwcmVzc2lvblJlbmRlcmVyQ29tcG9uZW50LAogICAgICBleHByZXNzaW9uID0gX3JlZi5leHByZXNzaW9uOwogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICBjbGFzc05hbWU6ICgwLCBfY2xhc3NuYW1lcy5kZWZhdWx0KSgnbG5zU3VnZ2VzdGlvblBhbmVsX19jaGFydFdyYXBwZXInLCB7CiAgICAgICdsbnNTdWdnZXN0aW9uUGFuZWxfX2NoYXJ0V3JhcHBlci0td2l0aExhYmVsJzogd2l0aExhYmVsCiAgICB9KQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRXhwcmVzc2lvblJlbmRlcmVyQ29tcG9uZW50LCB7CiAgICBjbGFzc05hbWU6ICJsbnNTdWdnZXN0aW9uUGFuZWxfX2V4cHJlc3Npb25SZW5kZXJlciIsCiAgICBwYWRkaW5nOiAicyIsCiAgICBleHByZXNzaW9uOiBleHByZXNzaW9uLAogICAgcmVuZGVyRXJyb3I6IGZ1bmN0aW9uIHJlbmRlckVycm9yKCkgewogICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIGNsYXNzTmFtZTogImxuc1N1Z2dlc3Rpb25QYW5lbF9fc3VnZ2VzdGlvbkljb24iCiAgICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uVGlwLCB7CiAgICAgICAgc2l6ZTogInhsIiwKICAgICAgICBjb2xvcjogImRhbmdlciIsCiAgICAgICAgdHlwZTogImFsZXJ0IiwKICAgICAgICAiYXJpYS1sYWJlbCI6IF9pMThuLmkxOG4udHJhbnNsYXRlKCd4cGFjay5sZW5zLmVkaXRvckZyYW1lLnByZXZpZXdFcnJvckxhYmVsJywgewogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdQcmV2aWV3IHJlbmRlcmluZyBmYWlsZWQnCiAgICAgICAgfSksCiAgICAgICAgY29udGVudDogX2kxOG4uaTE4bi50cmFuc2xhdGUoJ3hwYWNrLmxlbnMuZWRpdG9yRnJhbWUucHJldmlld0Vycm9yTGFiZWwnLCB7CiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1ByZXZpZXcgcmVuZGVyaW5nIGZhaWxlZCcKICAgICAgICB9KQogICAgICB9KSk7CiAgICB9CiAgfSkpOwp9OwoKdmFyIERlYm91bmNlZFByZXZpZXdSZW5kZXJlciA9ICgwLCBfZGVib3VuY2VkX2NvbXBvbmVudC5kZWJvdW5jZWRDb21wb25lbnQpKFByZXZpZXdSZW5kZXJlciwgMjAwMCk7Cgp2YXIgU3VnZ2VzdGlvblByZXZpZXcgPSBmdW5jdGlvbiBTdWdnZXN0aW9uUHJldmlldyhfcmVmMikgewogIHZhciBwcmV2aWV3ID0gX3JlZjIucHJldmlldywKICAgICAgRXhwcmVzc2lvblJlbmRlcmVyQ29tcG9uZW50ID0gX3JlZjIuRXhwcmVzc2lvblJlbmRlcmVyLAogICAgICBzZWxlY3RlZCA9IF9yZWYyLnNlbGVjdGVkLAogICAgICBvblNlbGVjdCA9IF9yZWYyLm9uU2VsZWN0LAogICAgICBzaG93VGl0bGVBc0xhYmVsID0gX3JlZjIuc2hvd1RpdGxlQXNMYWJlbDsKICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRvb2xUaXAsIHsKICAgIGNvbnRlbnQ6IHByZXZpZXcudGl0bGUKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KEV1aVBhbmVsRml4ZWQsIHsKICAgIGNsYXNzTmFtZTogKDAsIF9jbGFzc25hbWVzLmRlZmF1bHQpKCdsbnNTdWdnZXN0aW9uUGFuZWxfX2J1dHRvbicsIHsKICAgICAgJ2xuc1N1Z2dlc3Rpb25QYW5lbF9fYnV0dG9uLWlzU2VsZWN0ZWQnOiBzZWxlY3RlZAogICAgfSksCiAgICBwYWRkaW5nU2l6ZTogIm5vbmUiLAogICAgImRhdGEtdGVzdC1zdWJqIjogImxuc1N1Z2dlc3Rpb24iLAogICAgb25DbGljazogb25TZWxlY3QKICB9LCBwcmV2aWV3LmV4cHJlc3Npb24gPyBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KERlYm91bmNlZFByZXZpZXdSZW5kZXJlciwgewogICAgRXhwcmVzc2lvblJlbmRlcmVyQ29tcG9uZW50OiBFeHByZXNzaW9uUmVuZGVyZXJDb21wb25lbnQsCiAgICBleHByZXNzaW9uOiAoMCwgX2NvbW1vbi50b0V4cHJlc3Npb24pKHByZXZpZXcuZXhwcmVzc2lvbiksCiAgICB3aXRoTGFiZWw6IEJvb2xlYW4oc2hvd1RpdGxlQXNMYWJlbCkKICB9KSA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICBjbGFzc05hbWU6ICJsbnNTdWdnZXN0aW9uUGFuZWxfX3N1Z2dlc3Rpb25JY29uIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICBzaXplOiAieHhsIiwKICAgIHR5cGU6IHByZXZpZXcuaWNvbgogIH0pKSwgc2hvd1RpdGxlQXNMYWJlbCAmJiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgewogICAgY2xhc3NOYW1lOiAibG5zU3VnZ2VzdGlvblBhbmVsX19idXR0b25MYWJlbCIKICB9LCBwcmV2aWV3LnRpdGxlKSkpOwp9OwoKZnVuY3Rpb24gU3VnZ2VzdGlvblBhbmVsKF9yZWYzKSB7CiAgdmFyIGFjdGl2ZURhdGFzb3VyY2VJZCA9IF9yZWYzLmFjdGl2ZURhdGFzb3VyY2VJZCwKICAgICAgZGF0YXNvdXJjZU1hcCA9IF9yZWYzLmRhdGFzb3VyY2VNYXAsCiAgICAgIGRhdGFzb3VyY2VTdGF0ZXMgPSBfcmVmMy5kYXRhc291cmNlU3RhdGVzLAogICAgICBhY3RpdmVWaXN1YWxpemF0aW9uSWQgPSBfcmVmMy5hY3RpdmVWaXN1YWxpemF0aW9uSWQsCiAgICAgIHZpc3VhbGl6YXRpb25NYXAgPSBfcmVmMy52aXN1YWxpemF0aW9uTWFwLAogICAgICB2aXN1YWxpemF0aW9uU3RhdGUgPSBfcmVmMy52aXN1YWxpemF0aW9uU3RhdGUsCiAgICAgIGRpc3BhdGNoID0gX3JlZjMuZGlzcGF0Y2gsCiAgICAgIGZyYW1lID0gX3JlZjMuZnJhbWUsCiAgICAgIEV4cHJlc3Npb25SZW5kZXJlckNvbXBvbmVudCA9IF9yZWYzLkV4cHJlc3Npb25SZW5kZXJlciwKICAgICAgc3RhZ2VkUHJldmlldyA9IF9yZWYzLnN0YWdlZFByZXZpZXc7CiAgdmFyIGN1cnJlbnREYXRhc291cmNlU3RhdGVzID0gc3RhZ2VkUHJldmlldyA/IHN0YWdlZFByZXZpZXcuZGF0YXNvdXJjZVN0YXRlcyA6IGRhdGFzb3VyY2VTdGF0ZXM7CiAgdmFyIGN1cnJlbnRWaXN1YWxpemF0aW9uU3RhdGUgPSBzdGFnZWRQcmV2aWV3ID8gc3RhZ2VkUHJldmlldy52aXN1YWxpemF0aW9uLnN0YXRlIDogdmlzdWFsaXphdGlvblN0YXRlOwogIHZhciBjdXJyZW50VmlzdWFsaXphdGlvbklkID0gc3RhZ2VkUHJldmlldyA/IHN0YWdlZFByZXZpZXcudmlzdWFsaXphdGlvbi5hY3RpdmVJZCA6IGFjdGl2ZVZpc3VhbGl6YXRpb25JZDsKCiAgdmFyIF91c2VNZW1vID0gKDAsIF9yZWFjdC51c2VNZW1vKShmdW5jdGlvbiAoKSB7CiAgICB2YXIgbmV3U3VnZ2VzdGlvbnMgPSAoMCwgX3N1Z2dlc3Rpb25faGVscGVycy5nZXRTdWdnZXN0aW9ucykoewogICAgICBkYXRhc291cmNlTWFwOiBkYXRhc291cmNlTWFwLAogICAgICBkYXRhc291cmNlU3RhdGVzOiBjdXJyZW50RGF0YXNvdXJjZVN0YXRlcywKICAgICAgdmlzdWFsaXphdGlvbk1hcDogdmlzdWFsaXphdGlvbk1hcCwKICAgICAgYWN0aXZlVmlzdWFsaXphdGlvbklkOiBjdXJyZW50VmlzdWFsaXphdGlvbklkLAogICAgICB2aXN1YWxpemF0aW9uU3RhdGU6IGN1cnJlbnRWaXN1YWxpemF0aW9uU3RhdGUKICAgIH0pLm1hcChmdW5jdGlvbiAoc3VnZ2VzdGlvbikgewogICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgc3VnZ2VzdGlvbiwgewogICAgICAgIHByZXZpZXdFeHByZXNzaW9uOiBwcmVwYXJlUHJldmlld0V4cHJlc3Npb24oc3VnZ2VzdGlvbiwgdmlzdWFsaXphdGlvbk1hcFtzdWdnZXN0aW9uLnZpc3VhbGl6YXRpb25JZF0sIGRhdGFzb3VyY2VNYXAsIGN1cnJlbnREYXRhc291cmNlU3RhdGVzLCBmcmFtZSkKICAgICAgfSk7CiAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKHN1Z2dlc3Rpb24pIHsKICAgICAgcmV0dXJuICFzdWdnZXN0aW9uLmhpZGU7CiAgICB9KS5zbGljZSgwLCBNQVhfU1VHR0VTVElPTlNfRElTUExBWUVEKTsKICAgIHZhciBuZXdTdGF0ZUV4cHJlc3Npb24gPSBjdXJyZW50VmlzdWFsaXphdGlvblN0YXRlICYmIGN1cnJlbnRWaXN1YWxpemF0aW9uSWQgPyBwcmVwYXJlUHJldmlld0V4cHJlc3Npb24oewogICAgICB2aXN1YWxpemF0aW9uU3RhdGU6IGN1cnJlbnRWaXN1YWxpemF0aW9uU3RhdGUKICAgIH0sIHZpc3VhbGl6YXRpb25NYXBbY3VycmVudFZpc3VhbGl6YXRpb25JZF0sIGRhdGFzb3VyY2VNYXAsIGN1cnJlbnREYXRhc291cmNlU3RhdGVzLCBmcmFtZSkgOiB1bmRlZmluZWQ7CiAgICByZXR1cm4gewogICAgICBzdWdnZXN0aW9uczogbmV3U3VnZ2VzdGlvbnMsCiAgICAgIGN1cnJlbnRTdGF0ZUV4cHJlc3Npb246IG5ld1N0YXRlRXhwcmVzc2lvbgogICAgfTsKICB9LCBbY3VycmVudERhdGFzb3VyY2VTdGF0ZXMsIGN1cnJlbnRWaXN1YWxpemF0aW9uU3RhdGUsIGN1cnJlbnRWaXN1YWxpemF0aW9uSWQsIGRhdGFzb3VyY2VNYXAsIHZpc3VhbGl6YXRpb25NYXBdKSwKICAgICAgc3VnZ2VzdGlvbnMgPSBfdXNlTWVtby5zdWdnZXN0aW9ucywKICAgICAgY3VycmVudFN0YXRlRXhwcmVzc2lvbiA9IF91c2VNZW1vLmN1cnJlbnRTdGF0ZUV4cHJlc3Npb247CgogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSgtMSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBsYXN0U2VsZWN0ZWRTdWdnZXN0aW9uID0gX3VzZVN0YXRlMlswXSwKICAgICAgc2V0TGFzdFNlbGVjdGVkU3VnZ2VzdGlvbiA9IF91c2VTdGF0ZTJbMV07CgogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICAvLyBpZiB0aGUgc3RhZ2VkIHByZXZpZXcgaXMgb3ZlcndyaXR0ZW4gYnkgYSBzdWdnZXN0aW9uLAogICAgLy8gcmVzZXQgdGhlIHNlbGVjdGVkIGluZGV4IHRvICJjdXJyZW50IHZpc3VhbGl6YXRpb24iIGJlY2F1c2UKICAgIC8vIHdlIGFyZSBub3QgaW4gdHJhbnNpZW50IHN1Z2dlc3Rpb24gc3RhdGUgYW55bW9yZQogICAgaWYgKCFzdGFnZWRQcmV2aWV3ICYmIGxhc3RTZWxlY3RlZFN1Z2dlc3Rpb24gIT09IC0xKSB7CiAgICAgIHNldExhc3RTZWxlY3RlZFN1Z2dlc3Rpb24oLTEpOwogICAgfQogIH0sIFtzdGFnZWRQcmV2aWV3XSk7CgogIGlmICghYWN0aXZlRGF0YXNvdXJjZUlkKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGlmIChzdWdnZXN0aW9ucy5sZW5ndGggPT09IDApIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgZnVuY3Rpb24gcm9sbGJhY2tUb0N1cnJlbnRWaXN1YWxpemF0aW9uKCkgewogICAgaWYgKGxhc3RTZWxlY3RlZFN1Z2dlc3Rpb24gIT09IC0xKSB7CiAgICAgICgwLCBfbGVuc191aV90ZWxlbWV0cnkudHJhY2tTdWdnZXN0aW9uRXZlbnQpKCdiYWNrX3RvX2N1cnJlbnQnKTsKICAgICAgc2V0TGFzdFNlbGVjdGVkU3VnZ2VzdGlvbigtMSk7CiAgICAgIGRpc3BhdGNoKHsKICAgICAgICB0eXBlOiAnUk9MTEJBQ0tfU1VHR0VTVElPTicKICAgICAgfSk7CiAgICB9CiAgfQoKICB2YXIgZXhwcmVzc2lvbkNvbnRleHQgPSB7CiAgICBxdWVyeTogZnJhbWUucXVlcnksCiAgICB0aW1lUmFuZ2U6IHsKICAgICAgZnJvbTogZnJhbWUuZGF0ZVJhbmdlLmZyb21EYXRlLAogICAgICB0bzogZnJhbWUuZGF0ZVJhbmdlLnRvRGF0ZQogICAgfQogIH07CiAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgIGNsYXNzTmFtZTogImxuc1N1Z2dlc3Rpb25QYW5lbCIKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpRmxleEdyb3VwLCB7CiAgICBhbGlnbkl0ZW1zOiAiY2VudGVyIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlGbGV4SXRlbSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aVRpdGxlLCB7CiAgICBjbGFzc05hbWU6ICJsbnNTdWdnZXN0aW9uUGFuZWxfX3RpdGxlIiwKICAgIHNpemU6ICJ4eHMiCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgiaDMiLCBudWxsLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9yZWFjdDIuRm9ybWF0dGVkTWVzc2FnZSwgewogICAgaWQ6ICJ4cGFjay5sZW5zLmVkaXRvckZyYW1lLnN1Z2dlc3Rpb25QYW5lbFRpdGxlIiwKICAgIGRlZmF1bHRNZXNzYWdlOiAiU3VnZ2VzdGlvbnMiCiAgfSkpKSksIHN0YWdlZFByZXZpZXcgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZXVpLkV1aUZsZXhJdGVtLCB7CiAgICBncm93OiBmYWxzZQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUb29sVGlwLCB7CiAgICBjb250ZW50OiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subGVucy5zdWdnZXN0aW9uLnJlZnJlc2hTdWdnZXN0aW9uVG9vbHRpcCcsIHsKICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdSZWZyZXNoIHRoZSBzdWdnZXN0aW9ucyBiYXNlZCBvbiB0aGUgc2VsZWN0ZWQgdmlzdWFsaXphdGlvbi4nCiAgICB9KQogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlCdXR0b25FbXB0eSwgewogICAgImRhdGEtdGVzdC1zdWJqIjogImxlbnNTdWJtaXRTdWdnZXN0aW9uIiwKICAgIHNpemU6ICJ4cyIsCiAgICBpY29uVHlwZTogInJlZnJlc2giLAogICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgKDAsIF9sZW5zX3VpX3RlbGVtZXRyeS50cmFja1VpRXZlbnQpKCdzdWdnZXN0aW9uX2NvbmZpcm1lZCcpOwogICAgICBkaXNwYXRjaCh7CiAgICAgICAgdHlwZTogJ1NVQk1JVF9TVUdHRVNUSU9OJwogICAgICB9KTsKICAgIH0KICB9LCBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subGVucy5zdWdlZ3N0aW9uLnJlZnJlc2hTdWdnZXN0aW9uTGFiZWwnLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ1JlZnJlc2gnCiAgfSkpKSkpLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICBjbGFzc05hbWU6ICJsbnNTdWdnZXN0aW9uUGFuZWxfX3N1Z2dlc3Rpb25zIgogIH0sIGN1cnJlbnRWaXN1YWxpemF0aW9uSWQgJiYgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChTdWdnZXN0aW9uUHJldmlldywgewogICAgcHJldmlldzogewogICAgICBleHByZXNzaW9uOiBjdXJyZW50U3RhdGVFeHByZXNzaW9uID8gKDAsIF9leHByZXNzaW9uX2hlbHBlcnMucHJlcGVuZEtpYmFuYUNvbnRleHQpKGN1cnJlbnRTdGF0ZUV4cHJlc3Npb24sIGV4cHJlc3Npb25Db250ZXh0KSA6IHVuZGVmaW5lZCwKICAgICAgaWNvbjogdmlzdWFsaXphdGlvbk1hcFtjdXJyZW50VmlzdWFsaXphdGlvbklkXS5nZXREZXNjcmlwdGlvbihjdXJyZW50VmlzdWFsaXphdGlvblN0YXRlKS5pY29uIHx8ICdlbXB0eScsCiAgICAgIHRpdGxlOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subGVucy5zdWdnZXN0aW9ucy5jdXJyZW50VmlzTGFiZWwnLCB7CiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdDdXJyZW50JwogICAgICB9KQogICAgfSwKICAgIEV4cHJlc3Npb25SZW5kZXJlcjogRXhwcmVzc2lvblJlbmRlcmVyQ29tcG9uZW50LAogICAgb25TZWxlY3Q6IHJvbGxiYWNrVG9DdXJyZW50VmlzdWFsaXphdGlvbiwKICAgIHNlbGVjdGVkOiBsYXN0U2VsZWN0ZWRTdWdnZXN0aW9uID09PSAtMSwKICAgIHNob3dUaXRsZUFzTGFiZWw6IHRydWUKICB9KSwgc3VnZ2VzdGlvbnMubWFwKGZ1bmN0aW9uIChzdWdnZXN0aW9uLCBpbmRleCkgewogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoU3VnZ2VzdGlvblByZXZpZXcsIHsKICAgICAgcHJldmlldzogewogICAgICAgIGV4cHJlc3Npb246IHN1Z2dlc3Rpb24ucHJldmlld0V4cHJlc3Npb24gPyAoMCwgX2V4cHJlc3Npb25faGVscGVycy5wcmVwZW5kS2liYW5hQ29udGV4dCkoc3VnZ2VzdGlvbi5wcmV2aWV3RXhwcmVzc2lvbiwgZXhwcmVzc2lvbkNvbnRleHQpIDogdW5kZWZpbmVkLAogICAgICAgIGljb246IHN1Z2dlc3Rpb24ucHJldmlld0ljb24sCiAgICAgICAgdGl0bGU6IHN1Z2dlc3Rpb24udGl0bGUKICAgICAgfSwKICAgICAgRXhwcmVzc2lvblJlbmRlcmVyOiBFeHByZXNzaW9uUmVuZGVyZXJDb21wb25lbnQsCiAgICAgIGtleTogaW5kZXgsCiAgICAgIG9uU2VsZWN0OiBmdW5jdGlvbiBvblNlbGVjdCgpIHsKICAgICAgICAoMCwgX2xlbnNfdWlfdGVsZW1ldHJ5LnRyYWNrVWlFdmVudCkoJ3N1Z2dlc3Rpb25fY2xpY2tlZCcpOwoKICAgICAgICBpZiAobGFzdFNlbGVjdGVkU3VnZ2VzdGlvbiA9PT0gaW5kZXgpIHsKICAgICAgICAgIHJvbGxiYWNrVG9DdXJyZW50VmlzdWFsaXphdGlvbigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAoMCwgX2xlbnNfdWlfdGVsZW1ldHJ5LnRyYWNrU3VnZ2VzdGlvbkV2ZW50KSgicG9zaXRpb25fIi5jb25jYXQoaW5kZXgsICJfb2ZfIikuY29uY2F0KHN1Z2dlc3Rpb25zLmxlbmd0aCkpOwogICAgICAgICAgc2V0TGFzdFNlbGVjdGVkU3VnZ2VzdGlvbihpbmRleCk7CiAgICAgICAgICAoMCwgX3N1Z2dlc3Rpb25faGVscGVycy5zd2l0Y2hUb1N1Z2dlc3Rpb24pKGRpc3BhdGNoLCBzdWdnZXN0aW9uKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNlbGVjdGVkOiBpbmRleCA9PT0gbGFzdFNlbGVjdGVkU3VnZ2VzdGlvbgogICAgfSk7CiAgfSkpKTsKfQoKZnVuY3Rpb24gZ2V0UHJldmlld0V4cHJlc3Npb24odmlzdWFsaXphYmxlU3RhdGUsIHZpc3VhbGl6YXRpb24sIGRhdGFzb3VyY2VzLCBmcmFtZSkgewogIGlmICghdmlzdWFsaXphdGlvbi50b1ByZXZpZXdFeHByZXNzaW9uKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIHZhciBzdWdnZXN0aW9uRnJhbWVBcGkgPSBfb2JqZWN0U3ByZWFkKHt9LCBmcmFtZSwgewogICAgZGF0YXNvdXJjZUxheWVyczogX29iamVjdFNwcmVhZCh7fSwgZnJhbWUuZGF0YXNvdXJjZUxheWVycykKICB9KTsgLy8gdXNlIGN1cnJlbnQgZnJhbWUgYXBpIGFuZCBwYXRjaCBhcGlzIGZvciBjaGFuZ2VkIGRhdGFzb3VyY2UgbGF5ZXJzCgoKICBpZiAodmlzdWFsaXphYmxlU3RhdGUua2VwdExheWVySWRzICYmIHZpc3VhbGl6YWJsZVN0YXRlLmRhdGFzb3VyY2VJZCAmJiB2aXN1YWxpemFibGVTdGF0ZS5kYXRhc291cmNlU3RhdGUpIHsKICAgIHZhciBkYXRhc291cmNlID0gZGF0YXNvdXJjZXNbdmlzdWFsaXphYmxlU3RhdGUuZGF0YXNvdXJjZUlkXTsKICAgIHZhciBkYXRhc291cmNlU3RhdGUgPSB2aXN1YWxpemFibGVTdGF0ZS5kYXRhc291cmNlU3RhdGU7CgogICAgdmFyIHVwZGF0ZWRMYXllckFwaXMgPSBfbG9kYXNoLmRlZmF1bHQucGljayhmcmFtZS5kYXRhc291cmNlTGF5ZXJzLCB2aXN1YWxpemFibGVTdGF0ZS5rZXB0TGF5ZXJJZHMpOwoKICAgIHZhciBjaGFuZ2VkTGF5ZXJzID0gZGF0YXNvdXJjZS5nZXRMYXllcnModmlzdWFsaXphYmxlU3RhdGUuZGF0YXNvdXJjZVN0YXRlKTsKICAgIGNoYW5nZWRMYXllcnMuZm9yRWFjaChmdW5jdGlvbiAobGF5ZXJJZCkgewogICAgICBpZiAodXBkYXRlZExheWVyQXBpc1tsYXllcklkXSkgewogICAgICAgIHVwZGF0ZWRMYXllckFwaXNbbGF5ZXJJZF0gPSBkYXRhc291cmNlLmdldFB1YmxpY0FQSSh7CiAgICAgICAgICBsYXllcklkOiBsYXllcklkLAogICAgICAgICAgZGF0ZVJhbmdlOiBmcmFtZS5kYXRlUmFuZ2UsCiAgICAgICAgICBzdGF0ZTogZGF0YXNvdXJjZVN0YXRlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgcmV0dXJuIHZpc3VhbGl6YXRpb24udG9QcmV2aWV3RXhwcmVzc2lvbih2aXN1YWxpemFibGVTdGF0ZS52aXN1YWxpemF0aW9uU3RhdGUsIHN1Z2dlc3Rpb25GcmFtZUFwaSk7Cn0KCmZ1bmN0aW9uIHByZXBhcmVQcmV2aWV3RXhwcmVzc2lvbih2aXN1YWxpemFibGVTdGF0ZSwgdmlzdWFsaXphdGlvbiwgZGF0YXNvdXJjZU1hcCwgZGF0YXNvdXJjZVN0YXRlcywgZnJhbWVQdWJsaWNBUEkpIHsKICB2YXIgc3VnZ2VzdGlvbkRhdGFzb3VyY2VJZCA9IHZpc3VhbGl6YWJsZVN0YXRlLmRhdGFzb3VyY2VJZDsKICB2YXIgc3VnZ2VzdGlvbkRhdGFzb3VyY2VTdGF0ZSA9IHZpc3VhbGl6YWJsZVN0YXRlLmRhdGFzb3VyY2VTdGF0ZTsKICB2YXIgZXhwcmVzc2lvbiA9IGdldFByZXZpZXdFeHByZXNzaW9uKHZpc3VhbGl6YWJsZVN0YXRlLCB2aXN1YWxpemF0aW9uLCBkYXRhc291cmNlTWFwLCBmcmFtZVB1YmxpY0FQSSk7CgogIGlmICghZXhwcmVzc2lvbikgewogICAgcmV0dXJuOwogIH0KCiAgdmFyIGV4cHJlc3Npb25XaXRoRGF0YXNvdXJjZSA9ICgwLCBfZXhwcmVzc2lvbl9oZWxwZXJzLnByZXBlbmREYXRhc291cmNlRXhwcmVzc2lvbikoZXhwcmVzc2lvbiwgZGF0YXNvdXJjZU1hcCwgc3VnZ2VzdGlvbkRhdGFzb3VyY2VJZCA/IF9vYmplY3RTcHJlYWQoe30sIGRhdGFzb3VyY2VTdGF0ZXMsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgc3VnZ2VzdGlvbkRhdGFzb3VyY2VJZCwgewogICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgIHN0YXRlOiBzdWdnZXN0aW9uRGF0YXNvdXJjZVN0YXRlCiAgfSkpIDogZGF0YXNvdXJjZVN0YXRlcyk7CiAgcmV0dXJuIGV4cHJlc3Npb25XaXRoRGF0YXNvdXJjZTsKfQ=="},null]}