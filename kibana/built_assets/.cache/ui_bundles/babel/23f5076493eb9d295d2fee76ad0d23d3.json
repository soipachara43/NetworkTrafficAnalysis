{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/lens/public/xy_visualization/xy_expression.js","dependencies":[{"path":"x-pack/legacy/plugins/lens/public/xy_visualization/xy_expression.js","mtime":1589249552324},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlhZQ2hhcnRSZXBvcnRhYmxlID0gWFlDaGFydFJlcG9ydGFibGU7CmV4cG9ydHMuWFlDaGFydCA9IFhZQ2hhcnQ7CmV4cG9ydHMuZ2V0WHlDaGFydFJlbmRlcmVyID0gZXhwb3J0cy54eUNoYXJ0ID0gdm9pZCAwOwoKdmFyIF9yZWFjdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoInJlYWN0IikpOwoKdmFyIF9yZWFjdERvbSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgicmVhY3QtZG9tIikpOwoKdmFyIF9jaGFydHMgPSByZXF1aXJlKCJAZWxhc3RpYy9jaGFydHMiKTsKCnZhciBfcmVhY3QyID0gcmVxdWlyZSgiQGtibi9pMThuL3JlYWN0Iik7Cgp2YXIgX2V1aSA9IHJlcXVpcmUoIkBlbGFzdGljL2V1aSIpOwoKdmFyIF9pMThuID0gcmVxdWlyZSgiQGtibi9pMThuIik7Cgp2YXIgX2V2ZW50cyA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9sZWdhY3kvY29yZV9wbHVnaW5zL3Zpc3VhbGl6YXRpb25zL3B1YmxpYy9ucF9yZWFkeS9wdWJsaWMvZW1iZWRkYWJsZS9ldmVudHMiKTsKCnZhciBfdHlwZXMgPSByZXF1aXJlKCIuL3R5cGVzIik7Cgp2YXIgX3Zpc3VhbGl6YXRpb25fY29udGFpbmVyID0gcmVxdWlyZSgiLi4vdmlzdWFsaXphdGlvbl9jb250YWluZXIiKTsKCnZhciBfc3RhdGVfaGVscGVycyA9IHJlcXVpcmUoIi4vc3RhdGVfaGVscGVycyIpOwoKdmFyIF9jb21tb24gPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9kYXRhL2NvbW1vbiIpOwoKdmFyIF9zZXJ2aWNlcyA9IHJlcXVpcmUoIi4vc2VydmljZXMiKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsKICAgIGRlZmF1bHQ6IG9iagogIH07Cn0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgewogIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKICAgIHJldHVybiBvYmo7CiAgfSBlbHNlIHsKICAgIHZhciBuZXdPYmogPSB7fTsKCiAgICBpZiAob2JqICE9IG51bGwpIHsKICAgICAgZm9yICh2YXIga2V5IGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7CiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTsKCiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7CiAgICByZXR1cm4gbmV3T2JqOwogIH0KfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7CiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsKfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7Cn0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsKICB2YXIgX2FyciA9IFtdOwogIHZhciBfbiA9IHRydWU7CiAgdmFyIF9kID0gZmFsc2U7CiAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgewogICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2QgPSB0cnVlOwogICAgX2UgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgIH0KICB9CgogIHJldHVybiBfYXJyOwp9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gX2V4dGVuZHMoKSB7CiAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsKICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07CgogICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsKICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRhcmdldDsKICB9OwoKICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKdmFyIHh5Q2hhcnQgPSB7CiAgbmFtZTogJ2xlbnNfeHlfY2hhcnQnLAogIHR5cGU6ICdyZW5kZXInLAogIGlucHV0VHlwZXM6IFsnbGVuc19tdWx0aXRhYmxlJywgJ2tpYmFuYV9jb250ZXh0JywgJ251bGwnXSwKICBoZWxwOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subGVucy54eUNoYXJ0LmhlbHAnLCB7CiAgICBkZWZhdWx0TWVzc2FnZTogJ0FuIFgvWSBjaGFydCcKICB9KSwKICBhcmdzOiB7CiAgICB4VGl0bGU6IHsKICAgICAgdHlwZXM6IFsnc3RyaW5nJ10sCiAgICAgIGhlbHA6ICdYIGF4aXMgdGl0bGUnCiAgICB9LAogICAgeVRpdGxlOiB7CiAgICAgIHR5cGVzOiBbJ3N0cmluZyddLAogICAgICBoZWxwOiAnWSBheGlzIHRpdGxlJwogICAgfSwKICAgIGxlZ2VuZDogewogICAgICB0eXBlczogWydsZW5zX3h5X2xlZ2VuZENvbmZpZyddLAogICAgICBoZWxwOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subGVucy54eUNoYXJ0LmxlZ2VuZC5oZWxwJywgewogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnQ29uZmlndXJlIHRoZSBjaGFydCBsZWdlbmQuJwogICAgICB9KQogICAgfSwKICAgIGxheWVyczogewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQogICAgICB0eXBlczogWydsZW5zX3h5X2xheWVyJ10sCiAgICAgIGhlbHA6ICdMYXllcnMgb2YgdmlzdWFsIHNlcmllcycsCiAgICAgIG11bHRpOiB0cnVlCiAgICB9CiAgfSwKICBmbjogZnVuY3Rpb24gZm4oZGF0YSwgYXJncykgewogICAgcmV0dXJuIHsKICAgICAgdHlwZTogJ3JlbmRlcicsCiAgICAgIGFzOiAnbGVuc194eV9jaGFydF9yZW5kZXJlcicsCiAgICAgIHZhbHVlOiB7CiAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICBhcmdzOiBhcmdzCiAgICAgIH0KICAgIH07CiAgfQp9OwpleHBvcnRzLnh5Q2hhcnQgPSB4eUNoYXJ0OwoKdmFyIGdldFh5Q2hhcnRSZW5kZXJlciA9IGZ1bmN0aW9uIGdldFh5Q2hhcnRSZW5kZXJlcihkZXBlbmRlbmNpZXMpIHsKICByZXR1cm4gewogICAgbmFtZTogJ2xlbnNfeHlfY2hhcnRfcmVuZGVyZXInLAogICAgZGlzcGxheU5hbWU6ICdYWSBjaGFydCcsCiAgICBoZWxwOiBfaTE4bi5pMThuLnRyYW5zbGF0ZSgneHBhY2subGVucy54eUNoYXJ0LnJlbmRlcmVyLmhlbHAnLCB7CiAgICAgIGRlZmF1bHRNZXNzYWdlOiAnWC9ZIGNoYXJ0IHJlbmRlcmVyJwogICAgfSksCiAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUoKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9LAogICAgcmV1c2VEb21Ob2RlOiB0cnVlLAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoZG9tTm9kZSwgY29uZmlnLCBoYW5kbGVycykgewogICAgICB2YXIgZXhlY3V0ZVRyaWdnZXJBY3Rpb25zID0gKDAsIF9zZXJ2aWNlcy5nZXRFeGVjdXRlVHJpZ2dlckFjdGlvbnMpKCk7CiAgICAgIGhhbmRsZXJzLm9uRGVzdHJveShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF9yZWFjdERvbS5kZWZhdWx0LnVubW91bnRDb21wb25lbnRBdE5vZGUoZG9tTm9kZSk7CiAgICAgIH0pOwoKICAgICAgX3JlYWN0RG9tLmRlZmF1bHQucmVuZGVyKF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5JMThuUHJvdmlkZXIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoWFlDaGFydFJlcG9ydGFibGUsIF9leHRlbmRzKHt9LCBjb25maWcsIGRlcGVuZGVuY2llcywgewogICAgICAgIGV4ZWN1dGVUcmlnZ2VyQWN0aW9uczogZXhlY3V0ZVRyaWdnZXJBY3Rpb25zCiAgICAgIH0pKSksIGRvbU5vZGUsIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gaGFuZGxlcnMuZG9uZSgpOwogICAgICB9KTsKICAgIH0KICB9Owp9OwoKZXhwb3J0cy5nZXRYeUNoYXJ0UmVuZGVyZXIgPSBnZXRYeUNoYXJ0UmVuZGVyZXI7CgpmdW5jdGlvbiBnZXRJY29uRm9yU2VyaWVzVHlwZShzZXJpZXNUeXBlKSB7CiAgcmV0dXJuIF90eXBlcy52aXN1YWxpemF0aW9uVHlwZXMuZmluZChmdW5jdGlvbiAoYykgewogICAgcmV0dXJuIGMuaWQgPT09IHNlcmllc1R5cGU7CiAgfSkuaWNvbiB8fCAnZW1wdHknOwp9Cgp2YXIgTWVtb2l6ZWRDaGFydCA9IF9yZWFjdC5kZWZhdWx0Lm1lbW8oWFlDaGFydCk7CgpmdW5jdGlvbiBYWUNoYXJ0UmVwb3J0YWJsZShwcm9wcykgewogIHZhciBfdXNlU3RhdGUgPSAoMCwgX3JlYWN0LnVzZVN0YXRlKSh7CiAgICBpc1JlYWR5OiBmYWxzZQogIH0pLAogICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSwKICAgICAgc3RhdGUgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRTdGF0ZSA9IF91c2VTdGF0ZTJbMV07IC8vIEl0IHRha2VzIGEgY3ljbGUgZm9yIHRoZSBYWSBjaGFydCB0byByZW5kZXIuIFRoaXMgcHJldmVudHMKICAvLyByZXBvcnRpbmcgZnJvbSBwcmludGluZyBhIGJsYW5rIGNoYXJ0IHBsYWNlaG9sZGVyLgoKCiAgKDAsIF9yZWFjdC51c2VFZmZlY3QpKGZ1bmN0aW9uICgpIHsKICAgIHNldFN0YXRlKHsKICAgICAgaXNSZWFkeTogdHJ1ZQogICAgfSk7CiAgfSwgW10pOwogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF92aXN1YWxpemF0aW9uX2NvbnRhaW5lci5WaXN1YWxpemF0aW9uQ29udGFpbmVyLCB7CiAgICBjbGFzc05hbWU6ICJsbnNYeUV4cHJlc3Npb25fX2NvbnRhaW5lciIsCiAgICBpc1JlYWR5OiBzdGF0ZS5pc1JlYWR5CiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChNZW1vaXplZENoYXJ0LCBwcm9wcykpOwp9CgpmdW5jdGlvbiBYWUNoYXJ0KF9yZWYpIHsKICB2YXIgX3BhcnNlSW50ZXJ2YWwsIF94QXhpc0NvbHVtbiRtZXRhLCBfeEF4aXNDb2x1bW4kbWV0YSRhZ2c7CgogIHZhciBkYXRhID0gX3JlZi5kYXRhLAogICAgICBhcmdzID0gX3JlZi5hcmdzLAogICAgICBmb3JtYXRGYWN0b3J5ID0gX3JlZi5mb3JtYXRGYWN0b3J5LAogICAgICB0aW1lWm9uZSA9IF9yZWYudGltZVpvbmUsCiAgICAgIGNoYXJ0VGhlbWUgPSBfcmVmLmNoYXJ0VGhlbWUsCiAgICAgIGV4ZWN1dGVUcmlnZ2VyQWN0aW9ucyA9IF9yZWYuZXhlY3V0ZVRyaWdnZXJBY3Rpb25zOwogIHZhciBsZWdlbmQgPSBhcmdzLmxlZ2VuZCwKICAgICAgbGF5ZXJzID0gYXJncy5sYXllcnM7CgogIGlmIChPYmplY3QudmFsdWVzKGRhdGEudGFibGVzKS5ldmVyeShmdW5jdGlvbiAodGFibGUpIHsKICAgIHJldHVybiB0YWJsZS5yb3dzLmxlbmd0aCA9PT0gMDsKICB9KSkgewogICAgdmFyIGljb24gPSBsYXllcnMubGVuZ3RoID4gMCA/IGdldEljb25Gb3JTZXJpZXNUeXBlKGxheWVyc1swXS5zZXJpZXNUeXBlKSA6ICdiYXInOwogICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlUZXh0LCB7CiAgICAgIGNsYXNzTmFtZTogImxuc0NoYXJ0X19lbXB0eSIsCiAgICAgIHRleHRBbGlnbjogImNlbnRlciIsCiAgICAgIGNvbG9yOiAic3ViZHVlZCIsCiAgICAgIHNpemU6ICJ4cyIKICAgIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlJY29uLCB7CiAgICAgIHR5cGU6IGljb24sCiAgICAgIGNvbG9yOiAic3ViZHVlZCIsCiAgICAgIHNpemU6ICJsIgogICAgfSksIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlTcGFjZXIsIHsKICAgICAgc2l6ZTogInMiCiAgICB9KSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0Mi5Gb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgIGlkOiAieHBhY2subGVucy54eVZpc3VhbGl6YXRpb24ubm9EYXRhTGFiZWwiLAogICAgICBkZWZhdWx0TWVzc2FnZTogIk5vIHJlc3VsdHMgZm91bmQiCiAgICB9KSkpOwogIH0gLy8gdXNlIGZvcm1hdHRpbmcgaGludCBvZiBmaXJzdCB4IGF4aXMgY29sdW1uIHRvIGZvcm1hdCB0aWNrcwoKCiAgdmFyIHhBeGlzQ29sdW1uID0gT2JqZWN0LnZhbHVlcyhkYXRhLnRhYmxlcylbMF0uY29sdW1ucy5maW5kKGZ1bmN0aW9uIChfcmVmMikgewogICAgdmFyIGlkID0gX3JlZjIuaWQ7CiAgICByZXR1cm4gaWQgPT09IGxheWVyc1swXS54QWNjZXNzb3I7CiAgfSk7CiAgdmFyIHhBeGlzRm9ybWF0dGVyID0gZm9ybWF0RmFjdG9yeSh4QXhpc0NvbHVtbiAmJiB4QXhpc0NvbHVtbi5mb3JtYXRIaW50KTsgLy8gdXNlIGRlZmF1bHQgbnVtYmVyIGZvcm1hdHRlciBmb3IgeSBheGlzIGFuZCB1c2UgZm9ybWF0dGluZyBoaW50IGlmIHRoZXJlIGlzIGp1c3QgYSBzaW5nbGUgeSBjb2x1bW4KCiAgdmFyIHlBeGlzRm9ybWF0dGVyID0gZm9ybWF0RmFjdG9yeSh7CiAgICBpZDogJ251bWJlcicKICB9KTsKCiAgaWYgKGxheWVycy5sZW5ndGggPT09IDEgJiYgbGF5ZXJzWzBdLmFjY2Vzc29ycy5sZW5ndGggPT09IDEpIHsKICAgIHZhciBmaXJzdFlBeGlzQ29sdW1uID0gT2JqZWN0LnZhbHVlcyhkYXRhLnRhYmxlcylbMF0uY29sdW1ucy5maW5kKGZ1bmN0aW9uIChfcmVmMykgewogICAgICB2YXIgaWQgPSBfcmVmMy5pZDsKICAgICAgcmV0dXJuIGlkID09PSBsYXllcnNbMF0uYWNjZXNzb3JzWzBdOwogICAgfSk7CgogICAgaWYgKGZpcnN0WUF4aXNDb2x1bW4gJiYgZmlyc3RZQXhpc0NvbHVtbi5mb3JtYXRIaW50KSB7CiAgICAgIHlBeGlzRm9ybWF0dGVyID0gZm9ybWF0RmFjdG9yeShmaXJzdFlBeGlzQ29sdW1uLmZvcm1hdEhpbnQpOwogICAgfQogIH0KCiAgdmFyIGNoYXJ0SGFzTW9yZVRoYW5PbmVTZXJpZXMgPSBsYXllcnMubGVuZ3RoID4gMSB8fCBkYXRhLnRhYmxlc1tsYXllcnNbMF0ubGF5ZXJJZF0uY29sdW1ucy5sZW5ndGggPiAyOwogIHZhciBzaG91bGRSb3RhdGUgPSAoMCwgX3N0YXRlX2hlbHBlcnMuaXNIb3Jpem9udGFsQ2hhcnQpKGxheWVycyk7CiAgdmFyIHhUaXRsZSA9IHhBeGlzQ29sdW1uICYmIHhBeGlzQ29sdW1uLm5hbWUgfHwgYXJncy54VGl0bGU7IC8vIGFkZCBtaW5JbnRlcnZhbCBvbmx5IGZvciBzaW5nbGUgcm93IHZhbHVlIGFzIGl0IGNhbm5vdCBiZSBkZXRlcm1pbmVkIGZyb20gZGF0YXNldAoKICB2YXIgbWluSW50ZXJ2YWwgPSBsYXllcnMuZXZlcnkoZnVuY3Rpb24gKGxheWVyKSB7CiAgICByZXR1cm4gZGF0YS50YWJsZXNbbGF5ZXIubGF5ZXJJZF0ucm93cy5sZW5ndGggPD0gMTsKICB9KSA/IChfcGFyc2VJbnRlcnZhbCA9ICgwLCBfY29tbW9uLnBhcnNlSW50ZXJ2YWwpKHhBeGlzQ29sdW1uID09PSBudWxsIHx8IHhBeGlzQ29sdW1uID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3hBeGlzQ29sdW1uJG1ldGEgPSB4QXhpc0NvbHVtbi5tZXRhKSA9PT0gbnVsbCB8fCBfeEF4aXNDb2x1bW4kbWV0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF94QXhpc0NvbHVtbiRtZXRhJGFnZyA9IF94QXhpc0NvbHVtbiRtZXRhLmFnZ0NvbmZpZ1BhcmFtcykgPT09IG51bGwgfHwgX3hBeGlzQ29sdW1uJG1ldGEkYWdnID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfeEF4aXNDb2x1bW4kbWV0YSRhZ2cuaW50ZXJ2YWwpKSA9PT0gbnVsbCB8fCBfcGFyc2VJbnRlcnZhbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3BhcnNlSW50ZXJ2YWwuYXNNaWxsaXNlY29uZHMoKSA6IHVuZGVmaW5lZDsKICB2YXIgeERvbWFpbiA9IGRhdGEuZGF0ZVJhbmdlICYmIGxheWVycy5ldmVyeShmdW5jdGlvbiAobCkgewogICAgcmV0dXJuIGwueFNjYWxlVHlwZSA9PT0gJ3RpbWUnOwogIH0pID8gewogICAgbWluOiBkYXRhLmRhdGVSYW5nZS5mcm9tRGF0ZS5nZXRUaW1lKCksCiAgICBtYXg6IGRhdGEuZGF0ZVJhbmdlLnRvRGF0ZS5nZXRUaW1lKCksCiAgICBtaW5JbnRlcnZhbDogbWluSW50ZXJ2YWwKICB9IDogdW5kZWZpbmVkOwogIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jaGFydHMuQ2hhcnQsIG51bGwsIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NoYXJ0cy5TZXR0aW5ncywgewogICAgc2hvd0xlZ2VuZDogbGVnZW5kLmlzVmlzaWJsZSA/IGNoYXJ0SGFzTW9yZVRoYW5PbmVTZXJpZXMgOiBsZWdlbmQuaXNWaXNpYmxlLAogICAgbGVnZW5kUG9zaXRpb246IGxlZ2VuZC5wb3NpdGlvbiwKICAgIHNob3dMZWdlbmRFeHRyYTogZmFsc2UsCiAgICB0aGVtZTogY2hhcnRUaGVtZSwKICAgIHJvdGF0aW9uOiBzaG91bGRSb3RhdGUgPyA5MCA6IDAsCiAgICB4RG9tYWluOiB4RG9tYWluLAogICAgb25FbGVtZW50Q2xpY2s6IGZ1bmN0aW9uIG9uRWxlbWVudENsaWNrKF9yZWY0KSB7CiAgICAgIHZhciBfdGFibGUkY29sdW1ucyRmaW5kLCBfdGFibGUkY29sdW1ucyRmaW5kJG0sIF90YWJsZSRjb2x1bW5zJGZpbmQkbTI7CgogICAgICB2YXIgX3JlZjUgPSBfc2xpY2VkVG9BcnJheShfcmVmNCwgMSksCiAgICAgICAgICBfcmVmNSQgPSBfc2xpY2VkVG9BcnJheShfcmVmNVswXSwgMiksCiAgICAgICAgICBnZW9tZXRyeSA9IF9yZWY1JFswXSwKICAgICAgICAgIHNlcmllcyA9IF9yZWY1JFsxXTsgLy8gZm9yIHh5Q2hhcnQgc2VyaWVzIGlzIGFsd2F5cyBYWUNoYXJ0U2VyaWVzSWRlbnRpZmllciBhbmQgZ2VvbWV0cnkgaXMgYWx3YXlzIHR5cGUgb2YgR2VvbWV0cnlWYWx1ZQoKCiAgICAgIHZhciB4eVNlcmllcyA9IHNlcmllczsKICAgICAgdmFyIHh5R2VvbWV0cnkgPSBnZW9tZXRyeTsKICAgICAgdmFyIGxheWVyID0gbGF5ZXJzLmZpbmQoZnVuY3Rpb24gKGwpIHsKICAgICAgICByZXR1cm4geHlTZXJpZXMuc2VyaWVzS2V5cy5zb21lKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIHJldHVybiBsLmFjY2Vzc29ycy5pbmNsdWRlcyhrZXkudG9TdHJpbmcoKSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgaWYgKCFsYXllcikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHRhYmxlID0gZGF0YS50YWJsZXNbbGF5ZXIubGF5ZXJJZF07CiAgICAgIHZhciBwb2ludHMgPSBbewogICAgICAgIHJvdzogdGFibGUucm93cy5maW5kSW5kZXgoZnVuY3Rpb24gKHJvdykgewogICAgICAgICAgcmV0dXJuIGxheWVyLnhBY2Nlc3NvciAmJiByb3dbbGF5ZXIueEFjY2Vzc29yXSA9PT0geHlHZW9tZXRyeS54OwogICAgICAgIH0pLAogICAgICAgIGNvbHVtbjogdGFibGUuY29sdW1ucy5maW5kSW5kZXgoZnVuY3Rpb24gKGNvbCkgewogICAgICAgICAgcmV0dXJuIGNvbC5pZCA9PT0gbGF5ZXIueEFjY2Vzc29yOwogICAgICAgIH0pLAogICAgICAgIHZhbHVlOiB4eUdlb21ldHJ5LngKICAgICAgfV07CgogICAgICBpZiAoeHlTZXJpZXMuc2VyaWVzS2V5cy5sZW5ndGggPiAxKSB7CiAgICAgICAgdmFyIHBvaW50VmFsdWUgPSB4eVNlcmllcy5zZXJpZXNLZXlzWzBdOwogICAgICAgIHBvaW50cy5wdXNoKHsKICAgICAgICAgIHJvdzogdGFibGUucm93cy5maW5kSW5kZXgoZnVuY3Rpb24gKHJvdykgewogICAgICAgICAgICByZXR1cm4gbGF5ZXIuc3BsaXRBY2Nlc3NvciAmJiByb3dbbGF5ZXIuc3BsaXRBY2Nlc3Nvcl0gPT09IHBvaW50VmFsdWU7CiAgICAgICAgICB9KSwKICAgICAgICAgIGNvbHVtbjogdGFibGUuY29sdW1ucy5maW5kSW5kZXgoZnVuY3Rpb24gKGNvbCkgewogICAgICAgICAgICByZXR1cm4gY29sLmlkID09PSBsYXllci5zcGxpdEFjY2Vzc29yOwogICAgICAgICAgfSksCiAgICAgICAgICB2YWx1ZTogcG9pbnRWYWx1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICB2YXIgeEF4aXNGaWVsZE5hbWUgPSAoX3RhYmxlJGNvbHVtbnMkZmluZCA9IHRhYmxlLmNvbHVtbnMuZmluZChmdW5jdGlvbiAoY29sKSB7CiAgICAgICAgcmV0dXJuIGNvbC5pZCA9PT0gbGF5ZXIueEFjY2Vzc29yOwogICAgICB9KSkgPT09IG51bGwgfHwgX3RhYmxlJGNvbHVtbnMkZmluZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF90YWJsZSRjb2x1bW5zJGZpbmQkbSA9IF90YWJsZSRjb2x1bW5zJGZpbmQubWV0YSkgPT09IG51bGwgfHwgX3RhYmxlJGNvbHVtbnMkZmluZCRtID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RhYmxlJGNvbHVtbnMkZmluZCRtMiA9IF90YWJsZSRjb2x1bW5zJGZpbmQkbS5hZ2dDb25maWdQYXJhbXMpID09PSBudWxsIHx8IF90YWJsZSRjb2x1bW5zJGZpbmQkbTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90YWJsZSRjb2x1bW5zJGZpbmQkbTIuZmllbGQ7CiAgICAgIHZhciB0aW1lRmllbGROYW1lID0geERvbWFpbiAmJiB4QXhpc0ZpZWxkTmFtZTsKICAgICAgdmFyIGNvbnRleHQgPSB7CiAgICAgICAgZGF0YTogewogICAgICAgICAgZGF0YTogcG9pbnRzLm1hcChmdW5jdGlvbiAocG9pbnQpIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICByb3c6IHBvaW50LnJvdywKICAgICAgICAgICAgICBjb2x1bW46IHBvaW50LmNvbHVtbiwKICAgICAgICAgICAgICB2YWx1ZTogcG9pbnQudmFsdWUsCiAgICAgICAgICAgICAgdGFibGU6IHRhYmxlCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgdGltZUZpZWxkTmFtZTogdGltZUZpZWxkTmFtZQogICAgICB9OwogICAgICBleGVjdXRlVHJpZ2dlckFjdGlvbnMoX2V2ZW50cy5WSVNfRVZFTlRfVE9fVFJJR0dFUi5maWx0ZXIsIGNvbnRleHQpOwogICAgfQogIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jaGFydHMuQXhpcywgewogICAgaWQ6ICJ4IiwKICAgIHBvc2l0aW9uOiBzaG91bGRSb3RhdGUgPyBfY2hhcnRzLlBvc2l0aW9uLkxlZnQgOiBfY2hhcnRzLlBvc2l0aW9uLkJvdHRvbSwKICAgIHRpdGxlOiB4VGl0bGUsCiAgICBzaG93R3JpZExpbmVzOiBmYWxzZSwKICAgIGhpZGU6IGxheWVyc1swXS5oaWRlLAogICAgdGlja0Zvcm1hdDogZnVuY3Rpb24gdGlja0Zvcm1hdChkKSB7CiAgICAgIHJldHVybiB4QXhpc0Zvcm1hdHRlci5jb252ZXJ0KGQpOwogICAgfQogIH0pLCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jaGFydHMuQXhpcywgewogICAgaWQ6ICJ5IiwKICAgIHBvc2l0aW9uOiBzaG91bGRSb3RhdGUgPyBfY2hhcnRzLlBvc2l0aW9uLkJvdHRvbSA6IF9jaGFydHMuUG9zaXRpb24uTGVmdCwKICAgIHRpdGxlOiBhcmdzLnlUaXRsZSwKICAgIHNob3dHcmlkTGluZXM6IGZhbHNlLAogICAgaGlkZTogbGF5ZXJzWzBdLmhpZGUsCiAgICB0aWNrRm9ybWF0OiBmdW5jdGlvbiB0aWNrRm9ybWF0KGQpIHsKICAgICAgcmV0dXJuIHlBeGlzRm9ybWF0dGVyLmNvbnZlcnQoZCk7CiAgICB9CiAgfSksIGxheWVycy5tYXAoZnVuY3Rpb24gKF9yZWY2LCBpbmRleCkgewogICAgdmFyIHNwbGl0QWNjZXNzb3IgPSBfcmVmNi5zcGxpdEFjY2Vzc29yLAogICAgICAgIHNlcmllc1R5cGUgPSBfcmVmNi5zZXJpZXNUeXBlLAogICAgICAgIGFjY2Vzc29ycyA9IF9yZWY2LmFjY2Vzc29ycywKICAgICAgICB4QWNjZXNzb3IgPSBfcmVmNi54QWNjZXNzb3IsCiAgICAgICAgbGF5ZXJJZCA9IF9yZWY2LmxheWVySWQsCiAgICAgICAgY29sdW1uVG9MYWJlbCA9IF9yZWY2LmNvbHVtblRvTGFiZWwsCiAgICAgICAgeVNjYWxlVHlwZSA9IF9yZWY2LnlTY2FsZVR5cGUsCiAgICAgICAgeFNjYWxlVHlwZSA9IF9yZWY2LnhTY2FsZVR5cGUsCiAgICAgICAgaXNIaXN0b2dyYW0gPSBfcmVmNi5pc0hpc3RvZ3JhbTsKCiAgICBpZiAoIXhBY2Nlc3NvciB8fCAhYWNjZXNzb3JzLmxlbmd0aCB8fCAhZGF0YS50YWJsZXNbbGF5ZXJJZF0gfHwgZGF0YS50YWJsZXNbbGF5ZXJJZF0ucm93cy5sZW5ndGggPT09IDAgfHwgZGF0YS50YWJsZXNbbGF5ZXJJZF0ucm93cy5ldmVyeShmdW5jdGlvbiAocm93KSB7CiAgICAgIHJldHVybiB0eXBlb2Ygcm93W3hBY2Nlc3Nvcl0gPT09ICd1bmRlZmluZWQnOwogICAgfSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBjb2x1bW5Ub0xhYmVsTWFwID0gY29sdW1uVG9MYWJlbCA/IEpTT04ucGFyc2UoY29sdW1uVG9MYWJlbCkgOiB7fTsKICAgIHZhciB0YWJsZSA9IGRhdGEudGFibGVzW2xheWVySWRdOyAvLyBGb3IgZGF0ZSBoaXN0b2dyYW0gY2hhcnQgdHlwZSwgd2UncmUgZ2V0dGluZyB0aGUgcm93cyB0aGF0IHJlcHJlc2VudCBpbnRlcnZhbHMgd2l0aG91dCBkYXRhLgogICAgLy8gVG8gbm90IGRpc3BsYXkgdGhlbSBpbiB0aGUgbGVnZW5kLCB0aGV5IG5lZWQgdG8gYmUgZmlsdGVyZWQgb3V0LgoKICAgIHZhciByb3dzID0gdGFibGUucm93cy5maWx0ZXIoZnVuY3Rpb24gKHJvdykgewogICAgICByZXR1cm4gIShzcGxpdEFjY2Vzc29yICYmICFyb3dbc3BsaXRBY2Nlc3Nvcl0gJiYgYWNjZXNzb3JzLmV2ZXJ5KGZ1bmN0aW9uIChhY2Nlc3NvcikgewogICAgICAgIHJldHVybiAhcm93W2FjY2Vzc29yXTsKICAgICAgfSkpOwogICAgfSk7CiAgICB2YXIgc2VyaWVzUHJvcHMgPSB7CiAgICAgIHNwbGl0U2VyaWVzQWNjZXNzb3JzOiBzcGxpdEFjY2Vzc29yID8gW3NwbGl0QWNjZXNzb3JdIDogW10sCiAgICAgIHN0YWNrQWNjZXNzb3JzOiBzZXJpZXNUeXBlLmluY2x1ZGVzKCdzdGFja2VkJykgPyBbeEFjY2Vzc29yXSA6IFtdLAogICAgICBpZDogc3BsaXRBY2Nlc3NvciB8fCBhY2Nlc3NvcnMuam9pbignLCcpLAogICAgICB4QWNjZXNzb3I6IHhBY2Nlc3NvciwKICAgICAgeUFjY2Vzc29yczogYWNjZXNzb3JzLAogICAgICBkYXRhOiByb3dzLAogICAgICB4U2NhbGVUeXBlOiB4U2NhbGVUeXBlLAogICAgICB5U2NhbGVUeXBlOiB5U2NhbGVUeXBlLAogICAgICBlbmFibGVIaXN0b2dyYW1Nb2RlOiBpc0hpc3RvZ3JhbSAmJiAoc2VyaWVzVHlwZS5pbmNsdWRlcygnc3RhY2tlZCcpIHx8ICFzcGxpdEFjY2Vzc29yKSwKICAgICAgdGltZVpvbmU6IHRpbWVab25lLAogICAgICBuYW1lOiBmdW5jdGlvbiBuYW1lKGQpIHsKICAgICAgICB2YXIgX2NvbHVtblRvTGFiZWxNYXAkZCRzOwoKICAgICAgICBpZiAoYWNjZXNzb3JzLmxlbmd0aCA+IDEpIHsKICAgICAgICAgIHJldHVybiBkLnNlcmllc0tleXMubWFwKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgICAgcmV0dXJuIGNvbHVtblRvTGFiZWxNYXBba2V5XSB8fCBrZXk7CiAgICAgICAgICB9KS5qb2luKCcgLSAnKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAoX2NvbHVtblRvTGFiZWxNYXAkZCRzID0gY29sdW1uVG9MYWJlbE1hcFtkLnNlcmllc0tleXNbMF1dKSAhPT0gbnVsbCAmJiBfY29sdW1uVG9MYWJlbE1hcCRkJHMgIT09IHZvaWQgMCA/IF9jb2x1bW5Ub0xhYmVsTWFwJGQkcyA6IGQuc2VyaWVzS2V5c1swXTsKICAgICAgfQogICAgfTsKCiAgICBzd2l0Y2ggKHNlcmllc1R5cGUpIHsKICAgICAgY2FzZSAnbGluZSc6CiAgICAgICAgcmV0dXJuIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NoYXJ0cy5MaW5lU2VyaWVzLCBfZXh0ZW5kcyh7CiAgICAgICAgICBrZXk6IGluZGV4CiAgICAgICAgfSwgc2VyaWVzUHJvcHMpKTsKCiAgICAgIGNhc2UgJ2Jhcic6CiAgICAgIGNhc2UgJ2Jhcl9zdGFja2VkJzoKICAgICAgY2FzZSAnYmFyX2hvcml6b250YWwnOgogICAgICBjYXNlICdiYXJfaG9yaXpvbnRhbF9zdGFja2VkJzoKICAgICAgICByZXR1cm4gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY2hhcnRzLkJhclNlcmllcywgX2V4dGVuZHMoewogICAgICAgICAga2V5OiBpbmRleAogICAgICAgIH0sIHNlcmllc1Byb3BzKSk7CgogICAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jaGFydHMuQXJlYVNlcmllcywgX2V4dGVuZHMoewogICAgICAgICAga2V5OiBpbmRleAogICAgICAgIH0sIHNlcmllc1Byb3BzKSk7CiAgICB9CiAgfSkpOwp9"},null]}