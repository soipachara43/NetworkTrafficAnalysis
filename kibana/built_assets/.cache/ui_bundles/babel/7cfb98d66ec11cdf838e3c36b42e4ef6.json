{"remainingRequest":"node_modules/thread-loader/dist/cjs.js??ref--8-1!node_modules/babel-loader/lib/index.js??ref--8-2!x-pack/legacy/plugins/siem/public/components/embeddables/embedded_map.js","dependencies":[{"path":"x-pack/legacy/plugins/siem/public/components/embeddables/embedded_map.js","mtime":1589249552912},{"path":"node_modules/cache-loader/dist/cjs.js","mtime":1589249605183},{"path":"node_modules/thread-loader/dist/cjs.js","mtime":1589249608558},{"path":"node_modules/babel-loader/lib/index.js","mtime":1589249591025}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkVtYmVkZGVkTWFwID0gZXhwb3J0cy5FbWJlZGRlZE1hcENvbXBvbmVudCA9IHZvaWQgMDsKCnZhciBfZXVpID0gcmVxdWlyZSgiQGVsYXN0aWMvZXVpIik7Cgp2YXIgX3JlYWN0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgicmVhY3QiKSk7Cgp2YXIgX3JlYWN0UmV2ZXJzZVBvcnRhbCA9IHJlcXVpcmUoInJlYWN0LXJldmVyc2UtcG9ydGFsIik7Cgp2YXIgX3N0eWxlZENvbXBvbmVudHMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJzdHlsZWQtY29tcG9uZW50cyIpKTsKCnZhciBfcHVibGljID0gcmVxdWlyZSgiLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2xlZ2FjeS9jb3JlX3BsdWdpbnMvZW1iZWRkYWJsZV9hcGkvcHVibGljL25wX3JlYWR5L3B1YmxpYyIpOwoKdmFyIF9sZWdhY3kgPSByZXF1aXJlKCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvbGVnYWN5L2NvcmVfcGx1Z2lucy9lbWJlZGRhYmxlX2FwaS9wdWJsaWMvbnBfcmVhZHkvcHVibGljL2xlZ2FjeSIpOwoKdmFyIF9jb25zdGFudHMgPSByZXF1aXJlKCIuLi8uLi8uLi9jb21tb24vY29uc3RhbnRzIik7Cgp2YXIgX2hlbHBlcnMgPSByZXF1aXJlKCIuLi8uLi9ob29rcy9hcGkvaGVscGVycyIpOwoKdmFyIF91c2VfaW5kZXhfcGF0dGVybnMgPSByZXF1aXJlKCIuLi8uLi9ob29rcy91c2VfaW5kZXhfcGF0dGVybnMiKTsKCnZhciBfbG9hZGVyID0gcmVxdWlyZSgiLi4vbG9hZGVyIik7Cgp2YXIgX3RvYXN0ZXJzID0gcmVxdWlyZSgiLi4vdG9hc3RlcnMiKTsKCnZhciBfZW1iZWRkYWJsZSA9IHJlcXVpcmUoIi4vZW1iZWRkYWJsZSIpOwoKdmFyIF9lbWJlZGRhYmxlX2hlYWRlciA9IHJlcXVpcmUoIi4vZW1iZWRkYWJsZV9oZWFkZXIiKTsKCnZhciBfZW1iZWRkZWRfbWFwX2hlbHBlcnMgPSByZXF1aXJlKCIuL2VtYmVkZGVkX21hcF9oZWxwZXJzIik7Cgp2YXIgX2luZGV4X3BhdHRlcm5zX21pc3NpbmdfcHJvbXB0ID0gcmVxdWlyZSgiLi9pbmRleF9wYXR0ZXJuc19taXNzaW5nX3Byb21wdCIpOwoKdmFyIF9tYXBfdG9vbF90aXAgPSByZXF1aXJlKCIuL21hcF90b29sX3RpcC9tYXBfdG9vbF90aXAiKTsKCnZhciBpMThuID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiLi90cmFuc2xhdGlvbnMiKSk7Cgp2YXIgX2tpYmFuYSA9IHJlcXVpcmUoIi4uLy4uL2xpYi9raWJhbmEiKTsKCnZhciBfcHVibGljMiA9IHJlcXVpcmUoIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3NyYy9wbHVnaW5zL3NhdmVkX29iamVjdHMvcHVibGljIik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsKICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7CiAgICByZXR1cm4gb2JqOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3T2JqID0ge307CgogICAgaWYgKG9iaiAhPSBudWxsKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgewogICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpIDoge307CgogICAgICAgICAgaWYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdPYmpba2V5XSA9IG9ialtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIG5ld09iai5kZWZhdWx0ID0gb2JqOwogICAgcmV0dXJuIG5ld09iajsKICB9Cn0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsKICB0cnkgewogICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOwogICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVqZWN0KGVycm9yKTsKICAgIHJldHVybjsKICB9CgogIGlmIChpbmZvLmRvbmUpIHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0gZWxzZSB7CiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7CiAgfQp9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgYXJncyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsKCiAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7CiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gX3Rocm93KGVycikgewogICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsKICAgICAgfQoKICAgICAgX25leHQodW5kZWZpbmVkKTsKICAgIH0pOwogIH07Cn0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgewogIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7Cn0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7CiAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOwp9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgdmFyIF9hcnIgPSBbXTsKICB2YXIgX24gPSB0cnVlOwogIHZhciBfZCA9IGZhbHNlOwogIHZhciBfZSA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTsKCiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kID0gdHJ1ZTsKICAgIF9lID0gZXJyOwogIH0gZmluYWxseSB7CiAgICB0cnkgewogICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZCkgdGhyb3cgX2U7CiAgICB9CiAgfQoKICByZXR1cm4gX2FycjsKfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgewogIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7Cn0KCnZhciBFbWJlZGRhYmxlTWFwID0gX3N0eWxlZENvbXBvbmVudHMuZGVmYXVsdC5kaXYuYXR0cnMoZnVuY3Rpb24gKCkgewogIHJldHVybiB7CiAgICBjbGFzc05hbWU6ICdzaWVtRW1iZWRkYWJsZV9fbWFwJwogIH07Cn0pLndpdGhDb25maWcoewogIGRpc3BsYXlOYW1lOiAiRW1iZWRkYWJsZU1hcCIsCiAgY29tcG9uZW50SWQ6ICJuNHk2Y3otMCIKfSkoWyIuZW1iUGFuZWx7Ym9yZGVyOm5vbmU7Ym94LXNoYWRvdzpub25lO30ubWFwVG9vbGJhck92ZXJsYXlfX2J1dHRvbntkaXNwbGF5Om5vbmU7fSIsICIiXSwgZnVuY3Rpb24gKF9yZWYpIHsKICB2YXIgbWFpbnRhaW5SYXRpbyA9IF9yZWYubWFpbnRhaW5SYXRpbzsKICByZXR1cm4gbWFpbnRhaW5SYXRpbyAmJiAoMCwgX3N0eWxlZENvbXBvbmVudHMuY3NzKShbInBhZGRpbmctdG9wOmNhbGMoMyAvIDQgKiAxMDAlKTtwb3NpdGlvbjpyZWxhdGl2ZTtAbWVkaWEgb25seSBzY3JlZW4gYW5kIChtaW4td2lkdGg6IiwgIil7cGFkZGluZy10b3A6Y2FsYyg5IC8gMzIgKiAxMDAlKTt9QG1lZGlhIG9ubHkgc2NyZWVuIGFuZCAobWluLXdpZHRoOjE0NDFweCkgYW5kIChtaW4taGVpZ2h0OjkwMXB4KXtwYWRkaW5nLXRvcDpjYWxjKDkgLyAyMSAqIDEwMCUpO30uZW1iUGFuZWx7Ym90dG9tOjA7bGVmdDowO3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjA7dG9wOjA7fSJdLCBmdW5jdGlvbiAoX3JlZjIpIHsKICAgIHZhciB0aGVtZSA9IF9yZWYyLnRoZW1lOwogICAgcmV0dXJuIHRoZW1lLmV1aS5ldWlCcmVha3BvaW50cy5tOwogIH0pOwp9KTsKCkVtYmVkZGFibGVNYXAuZGlzcGxheU5hbWUgPSAnRW1iZWRkYWJsZU1hcCc7Cgp2YXIgRW1iZWRkZWRNYXBDb21wb25lbnQgPSBmdW5jdGlvbiBFbWJlZGRlZE1hcENvbXBvbmVudChfcmVmMykgewogIHZhciBlbmREYXRlID0gX3JlZjMuZW5kRGF0ZSwKICAgICAgZmlsdGVycyA9IF9yZWYzLmZpbHRlcnMsCiAgICAgIHF1ZXJ5ID0gX3JlZjMucXVlcnksCiAgICAgIHNldFF1ZXJ5ID0gX3JlZjMuc2V0UXVlcnksCiAgICAgIHN0YXJ0RGF0ZSA9IF9yZWYzLnN0YXJ0RGF0ZTsKCiAgdmFyIF9SZWFjdCR1c2VTdGF0ZSA9IF9yZWFjdC5kZWZhdWx0LnVzZVN0YXRlKG51bGwpLAogICAgICBfUmVhY3QkdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX1JlYWN0JHVzZVN0YXRlLCAyKSwKICAgICAgZW1iZWRkYWJsZSA9IF9SZWFjdCR1c2VTdGF0ZTJbMF0sCiAgICAgIHNldEVtYmVkZGFibGUgPSBfUmVhY3QkdXNlU3RhdGUyWzFdOwoKICB2YXIgX3VzZVN0YXRlID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkodHJ1ZSksCiAgICAgIF91c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfdXNlU3RhdGUsIDIpLAogICAgICBpc0xvYWRpbmcgPSBfdXNlU3RhdGUyWzBdLAogICAgICBzZXRJc0xvYWRpbmcgPSBfdXNlU3RhdGUyWzFdOwoKICB2YXIgX3VzZVN0YXRlMyA9ICgwLCBfcmVhY3QudXNlU3RhdGUpKGZhbHNlKSwKICAgICAgX3VzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTMsIDIpLAogICAgICBpc0Vycm9yID0gX3VzZVN0YXRlNFswXSwKICAgICAgc2V0SXNFcnJvciA9IF91c2VTdGF0ZTRbMV07CgogIHZhciBfdXNlU3RhdGU1ID0gKDAsIF9yZWFjdC51c2VTdGF0ZSkoZmFsc2UpLAogICAgICBfdXNlU3RhdGU2ID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlNSwgMiksCiAgICAgIGlzSW5kZXhFcnJvciA9IF91c2VTdGF0ZTZbMF0sCiAgICAgIHNldElzSW5kZXhFcnJvciA9IF91c2VTdGF0ZTZbMV07CgogIHZhciBfdXNlU3RhdGVUb2FzdGVyID0gKDAsIF90b2FzdGVycy51c2VTdGF0ZVRvYXN0ZXIpKCksCiAgICAgIF91c2VTdGF0ZVRvYXN0ZXIyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlVG9hc3RlciwgMiksCiAgICAgIGRpc3BhdGNoVG9hc3RlciA9IF91c2VTdGF0ZVRvYXN0ZXIyWzFdOwoKICB2YXIgX3VzZUluZGV4UGF0dGVybnMgPSAoMCwgX3VzZV9pbmRleF9wYXR0ZXJucy51c2VJbmRleFBhdHRlcm5zKSgpLAogICAgICBfdXNlSW5kZXhQYXR0ZXJuczIgPSBfc2xpY2VkVG9BcnJheShfdXNlSW5kZXhQYXR0ZXJucywgMiksCiAgICAgIGxvYWRpbmdLaWJhbmFJbmRleFBhdHRlcm5zID0gX3VzZUluZGV4UGF0dGVybnMyWzBdLAogICAgICBraWJhbmFJbmRleFBhdHRlcm5zID0gX3VzZUluZGV4UGF0dGVybnMyWzFdOwoKICB2YXIgX3VzZVVpU2V0dGluZyQgPSAoMCwgX2tpYmFuYS51c2VVaVNldHRpbmckKShfY29uc3RhbnRzLkRFRkFVTFRfSU5ERVhfS0VZKSwKICAgICAgX3VzZVVpU2V0dGluZyQyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVVpU2V0dGluZyQsIDEpLAogICAgICBzaWVtRGVmYXVsdEluZGljZXMgPSBfdXNlVWlTZXR0aW5nJDJbMF07IC8vIFRoaXMgcG9ydGFsTm9kZSBwcm92aWRlZCBieSByZWFjdC1yZXZlcnNlLXBvcnRhbCBhbGxvd3MgdXMgcmUtcGFyZW50IHRoZSBNYXBUb29sVGlwIHdpdGhpbiBvdXIKICAvLyBvd24gY29tcG9uZW50IHRyZWUgaW5zdGVhZCBvZiB0aGUgZW1iZWRkYWJsZXMgKGRlZmF1bHQpLiBUaGlzIGlzIG5lY2Vzc2FyeSB0byBoYXZlIGFjY2VzcyB0bwogIC8vIHRoZSBSZWR1eCBzdG9yZSwgdGhlbWUgcHJvdmlkZXIsIGV0Yywgd2hpY2ggaXMgcmVxdWlyZWQgdG8gcmVnaXN0ZXIgYW5kIHVuLXJlZ2lzdGVyIHRoZSBkcmFnZ2FibGUKICAvLyBTZWFyY2ggSW5Qb3J0YWwvT3V0UG9ydGFsIGZvciBpbXBsZW1lbnRhdGlvbiB0b3VjaCBwb2ludHMKCgogIHZhciBwb3J0YWxOb2RlID0gX3JlYWN0LmRlZmF1bHQudXNlTWVtbyhmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gKDAsIF9yZWFjdFJldmVyc2VQb3J0YWwuY3JlYXRlUG9ydGFsTm9kZSkoKTsKICB9LCBbXSk7CgogIHZhciBfdXNlS2liYW5hID0gKDAsIF9raWJhbmEudXNlS2liYW5hKSgpLAogICAgICBzZXJ2aWNlcyA9IF91c2VLaWJhbmEuc2VydmljZXM7IC8vIEluaXRpYWwgTG9hZCB1c2VFZmZlY3QKCgogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICB2YXIgaXNTdWJzY3JpYmVkID0gdHJ1ZTsKCiAgICBmdW5jdGlvbiBzZXR1cEVtYmVkZGFibGUoKSB7CiAgICAgIHJldHVybiBfc2V0dXBFbWJlZGRhYmxlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gX3NldHVwRW1iZWRkYWJsZSgpIHsKICAgICAgX3NldHVwRW1iZWRkYWJsZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIG1hdGNoaW5nSW5kZXhQYXR0ZXJucywgZW1iZWRkYWJsZU9iamVjdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAvLyBFbnN1cmUgYXQgbGVhc3Qgb25lIGBzaWVtOmRlZmF1bHRJbmRleGAga2liYW5hIGluZGV4IHBhdHRlcm4gZXhpc3RzIGJlZm9yZSBjcmVhdGluZyBlbWJlZGRhYmxlCiAgICAgICAgICAgICAgICBtYXRjaGluZ0luZGV4UGF0dGVybnMgPSAoMCwgX2VtYmVkZGVkX21hcF9oZWxwZXJzLmZpbmRNYXRjaGluZ0luZGV4UGF0dGVybnMpKHsKICAgICAgICAgICAgICAgICAga2liYW5hSW5kZXhQYXR0ZXJuczoga2liYW5hSW5kZXhQYXR0ZXJucywKICAgICAgICAgICAgICAgICAgc2llbURlZmF1bHRJbmRpY2VzOiBzaWVtRGVmYXVsdEluZGljZXMKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmICghKG1hdGNoaW5nSW5kZXhQYXR0ZXJucy5sZW5ndGggPT09IDAgJiYgaXNTdWJzY3JpYmVkKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTsKICAgICAgICAgICAgICAgIHNldElzSW5kZXhFcnJvcih0cnVlKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gNTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuICgwLCBfZW1iZWRkZWRfbWFwX2hlbHBlcnMuY3JlYXRlRW1iZWRkYWJsZSkoZmlsdGVycywgKDAsIF9oZWxwZXJzLmdldEluZGV4UGF0dGVyblRpdGxlSWRNYXBwaW5nKShtYXRjaGluZ0luZGV4UGF0dGVybnMpLCBxdWVyeSwgc3RhcnREYXRlLCBlbmREYXRlLCBzZXRRdWVyeSwgcG9ydGFsTm9kZSwgc2VydmljZXMuZW1iZWRkYWJsZSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIGVtYmVkZGFibGVPYmplY3QgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChpc1N1YnNjcmliZWQpIHsKICAgICAgICAgICAgICAgICAgc2V0RW1iZWRkYWJsZShlbWJlZGRhYmxlT2JqZWN0KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMjsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oNSk7CgogICAgICAgICAgICAgICAgaWYgKGlzU3Vic2NyaWJlZCkgewogICAgICAgICAgICAgICAgICAoMCwgX3RvYXN0ZXJzLmRpc3BsYXlFcnJvclRvYXN0KShpMThuLkVSUk9SX0NSRUFUSU5HX0VNQkVEREFCTEUsIFtfY29udGV4dC50MC5tZXNzYWdlXSwgZGlzcGF0Y2hUb2FzdGVyKTsKICAgICAgICAgICAgICAgICAgc2V0SXNFcnJvcih0cnVlKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIGlmIChpc1N1YnNjcmliZWQpIHsKICAgICAgICAgICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbNSwgMTJdXSk7CiAgICAgIH0pKTsKICAgICAgcmV0dXJuIF9zZXR1cEVtYmVkZGFibGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBpZiAoIWxvYWRpbmdLaWJhbmFJbmRleFBhdHRlcm5zKSB7CiAgICAgIHNldHVwRW1iZWRkYWJsZSgpOwogICAgfQoKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGlzU3Vic2NyaWJlZCA9IGZhbHNlOwogICAgfTsKICB9LCBbbG9hZGluZ0tpYmFuYUluZGV4UGF0dGVybnMsIGtpYmFuYUluZGV4UGF0dGVybnNdKTsgLy8gcXVlcnlFeHByZXNzaW9uIHVwZGF0ZWQgdXNlRWZmZWN0CgogICgwLCBfcmVhY3QudXNlRWZmZWN0KShmdW5jdGlvbiAoKSB7CiAgICBpZiAoZW1iZWRkYWJsZSAhPSBudWxsKSB7CiAgICAgIGVtYmVkZGFibGUudXBkYXRlSW5wdXQoewogICAgICAgIHF1ZXJ5OiBxdWVyeQogICAgICB9KTsKICAgIH0KICB9LCBbcXVlcnldKTsKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgaWYgKGVtYmVkZGFibGUgIT0gbnVsbCkgewogICAgICBlbWJlZGRhYmxlLnVwZGF0ZUlucHV0KHsKICAgICAgICBmaWx0ZXJzOiBmaWx0ZXJzCiAgICAgIH0pOwogICAgfQogIH0sIFtmaWx0ZXJzXSk7IC8vIERhdGVSYW5nZSB1cGRhdGVkIHVzZUVmZmVjdAoKICAoMCwgX3JlYWN0LnVzZUVmZmVjdCkoZnVuY3Rpb24gKCkgewogICAgaWYgKGVtYmVkZGFibGUgIT0gbnVsbCAmJiBzdGFydERhdGUgIT0gbnVsbCAmJiBlbmREYXRlICE9IG51bGwpIHsKICAgICAgdmFyIHRpbWVSYW5nZSA9IHsKICAgICAgICBmcm9tOiBuZXcgRGF0ZShzdGFydERhdGUpLnRvSVNPU3RyaW5nKCksCiAgICAgICAgdG86IG5ldyBEYXRlKGVuZERhdGUpLnRvSVNPU3RyaW5nKCkKICAgICAgfTsKICAgICAgZW1iZWRkYWJsZS51cGRhdGVJbnB1dCh7CiAgICAgICAgdGltZVJhbmdlOiB0aW1lUmFuZ2UKICAgICAgfSk7CiAgICB9CiAgfSwgW3N0YXJ0RGF0ZSwgZW5kRGF0ZV0pOwogIHJldHVybiBpc0Vycm9yID8gbnVsbCA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2VtYmVkZGFibGUuRW1iZWRkYWJsZSwgbnVsbCwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfZW1iZWRkYWJsZV9oZWFkZXIuRW1iZWRkYWJsZUhlYWRlciwgewogICAgdGl0bGU6IGkxOG4uRU1CRUREQUJMRV9IRUFERVJfVElUTEUKICB9LCBfcmVhY3QuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9ldWkuRXVpVGV4dCwgewogICAgc2l6ZTogInhzIgogIH0sIF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2V1aS5FdWlMaW5rLCB7CiAgICBocmVmOiAiIi5jb25jYXQoc2VydmljZXMuZG9jTGlua3MuRUxBU1RJQ19XRUJTSVRFX1VSTCwgImd1aWRlL2VuL3NpZW0vZ3VpZGUvIikuY29uY2F0KHNlcnZpY2VzLmRvY0xpbmtzLkRPQ19MSU5LX1ZFUlNJT04sICIvY29uZi1tYXAtdWkuaHRtbCIpLAogICAgdGFyZ2V0OiAiX2JsYW5rIgogIH0sIGkxOG4uRU1CRUREQUJMRV9IRUFERVJfSEVMUCkpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcmVhY3RSZXZlcnNlUG9ydGFsLkluUG9ydGFsLCB7CiAgICBub2RlOiBwb3J0YWxOb2RlCiAgfSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfbWFwX3Rvb2xfdGlwLk1hcFRvb2xUaXAsIG51bGwpKSwgX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChFbWJlZGRhYmxlTWFwLCB7CiAgICBtYWludGFpblJhdGlvOiAhaXNJbmRleEVycm9yCiAgfSwgZW1iZWRkYWJsZSAhPSBudWxsID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfcHVibGljLkVtYmVkZGFibGVQYW5lbCwgewogICAgImRhdGEtdGVzdC1zdWJqIjogImVtYmVkZGFibGUtcGFuZWwiLAogICAgZW1iZWRkYWJsZTogZW1iZWRkYWJsZSwKICAgIGdldEFjdGlvbnM6IHNlcnZpY2VzLnVpQWN0aW9ucy5nZXRUcmlnZ2VyQ29tcGF0aWJsZUFjdGlvbnMsCiAgICBnZXRFbWJlZGRhYmxlRmFjdG9yeTogX2xlZ2FjeS5zdGFydC5nZXRFbWJlZGRhYmxlRmFjdG9yeSwKICAgIGdldEFsbEVtYmVkZGFibGVGYWN0b3JpZXM6IF9sZWdhY3kuc3RhcnQuZ2V0RW1iZWRkYWJsZUZhY3RvcmllcywKICAgIG5vdGlmaWNhdGlvbnM6IHNlcnZpY2VzLm5vdGlmaWNhdGlvbnMsCiAgICBvdmVybGF5czogc2VydmljZXMub3ZlcmxheXMsCiAgICBpbnNwZWN0b3I6IHNlcnZpY2VzLmluc3BlY3RvciwKICAgIFNhdmVkT2JqZWN0RmluZGVyOiAoMCwgX3B1YmxpYzIuZ2V0U2F2ZWRPYmplY3RGaW5kZXIpKHNlcnZpY2VzLnNhdmVkT2JqZWN0cywgc2VydmljZXMudWlTZXR0aW5ncykKICB9KSA6ICFpc0xvYWRpbmcgJiYgaXNJbmRleEVycm9yID8gX3JlYWN0LmRlZmF1bHQuY3JlYXRlRWxlbWVudChfaW5kZXhfcGF0dGVybnNfbWlzc2luZ19wcm9tcHQuSW5kZXhQYXR0ZXJuc01pc3NpbmdQcm9tcHQsIHsKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJtaXNzaW5nLXByb21wdCIKICB9KSA6IF9yZWFjdC5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2xvYWRlci5Mb2FkZXIsIHsKICAgICJkYXRhLXRlc3Qtc3ViaiI6ICJsb2FkaW5nLXBhbmVsIiwKICAgIG92ZXJsYXk6IHRydWUsCiAgICBzaXplOiAieGwiCiAgfSkpKTsKfTsKCmV4cG9ydHMuRW1iZWRkZWRNYXBDb21wb25lbnQgPSBFbWJlZGRlZE1hcENvbXBvbmVudDsKRW1iZWRkZWRNYXBDb21wb25lbnQuZGlzcGxheU5hbWUgPSAnRW1iZWRkZWRNYXBDb21wb25lbnQnOwoKdmFyIEVtYmVkZGVkTWFwID0gX3JlYWN0LmRlZmF1bHQubWVtbyhFbWJlZGRlZE1hcENvbXBvbmVudCk7CgpleHBvcnRzLkVtYmVkZGVkTWFwID0gRW1iZWRkZWRNYXA7CkVtYmVkZGVkTWFwLmRpc3BsYXlOYW1lID0gJ0VtYmVkZGVkTWFwJzs="},null]}