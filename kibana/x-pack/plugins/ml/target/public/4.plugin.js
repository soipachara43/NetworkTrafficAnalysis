(window["ml_bundle_jsonpfunction"]=window["ml_bundle_jsonpfunction"]||[]).push([[4],Array(45).concat([function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderApp=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _reactDom=_interopRequireDefault(__webpack_require__(35));var _public=__webpack_require__(34);var _public2=__webpack_require__(31);var _dependency_cache=__webpack_require__(5);var _license=__webpack_require__(73);var _routing=__webpack_require__(539);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var localStorage=new _public.Storage(window.localStorage);var App=function App(_ref){var coreStart=_ref.coreStart,deps=_ref.deps;var pageDeps={indexPatterns:deps.data.indexPatterns,config:coreStart.uiSettings,setBreadcrumbs:coreStart.chrome.setBreadcrumbs};var services=_objectSpread({appName:"ML",data:deps.data,security:deps.security,licenseManagement:deps.licenseManagement,storage:localStorage},coreStart);var I18nContext=coreStart.i18n.Context;return _react.default.createElement(I18nContext,null,_react.default.createElement(_public2.KibanaContextProvider,{services:services},_react.default.createElement(_routing.MlRouter,{pageDeps:pageDeps})))};var renderApp=function renderApp(coreStart,deps,appMountParams){(0,_dependency_cache.setDependencyCache)({indexPatterns:deps.data.indexPatterns,timefilter:deps.data.query.timefilter,fieldFormats:deps.data.fieldFormats,autocomplete:deps.data.autocomplete,config:coreStart.uiSettings,chrome:coreStart.chrome,docLinks:coreStart.docLinks,toastNotifications:coreStart.notifications.toasts,overlays:coreStart.overlays,recentlyAccessed:coreStart.chrome.recentlyAccessed,basePath:coreStart.http.basePath,savedObjectsClient:coreStart.savedObjects.client,application:coreStart.application,http:coreStart.http,security:deps.security,urlGenerators:deps.share.urlGenerators});var mlLicense=(0,_license.setLicenseCache)(deps.licensing);appMountParams.onAppLeave((function(actions){return actions.default()}));_reactDom.default.render(_react.default.createElement(App,{coreStart:coreStart,deps:deps}),appMountParams.element);return function(){mlLicense.unsubscribe();(0,_dependency_cache.clearCache)();_reactDom.default.unmountComponentAtNode(appMountParams.element)}};exports.renderApp=renderApp},,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobCreatorContext=void 0;var _react=__webpack_require__(28);var JobCreatorContext=(0,_react.createContext)({jobCreatorUpdated:0,jobCreatorUpdate:function jobCreatorUpdate(){},jobCreator:{},chartLoader:{},resultsLoader:{},chartInterval:{},jobValidator:{},jobValidatorUpdated:0,fields:[],aggs:[],existingJobsAndGroups:{}});exports.JobCreatorContext=JobCreatorContext},,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MlRouter=exports.PageLoader=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _reactRouterDom=__webpack_require__(41);var _ml=__webpack_require__(77);var routes=_interopRequireWildcard(__webpack_require__(541));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var PageLoader=function PageLoader(_ref){var context=_ref.context,children=_ref.children;return context===null?null:_react.default.createElement(_ml.MlContext.Provider,{value:context},children)};exports.PageLoader=PageLoader;var MlRouter=function MlRouter(_ref2){var pageDeps=_ref2.pageDeps;var setBreadcrumbs=pageDeps.setBreadcrumbs;return _react.default.createElement(_reactRouterDom.HashRouter,null,_react.default.createElement("div",{className:"ml-app"},Object.entries(routes).map((function(_ref3){var _ref4=_slicedToArray(_ref3,2),name=_ref4[0],route=_ref4[1];return _react.default.createElement(_reactRouterDom.Route,{key:name,path:route.path,exact:true,render:function render(props){window.setTimeout((function(){setBreadcrumbs(route.breadcrumbs)}));return route.render(props,pageDeps)}})}))))};exports.MlRouter=MlRouter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useResolver=void 0;var _react=__webpack_require__(28);var _index_utils=__webpack_require__(70);var _new_job_utils=__webpack_require__(543);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var useResolver=function useResolver(indexPatternId,savedSearchId,config,resolvers){var funcNames=Object.keys(resolvers);var funcs=Object.values(resolvers);var tempResults=funcNames.reduce((function(p,c){p[c]={};return p}),{});var _useState=(0,_react.useState)(null),_useState2=_slicedToArray(_useState,2),context=_useState2[0],setContext=_useState2[1];var _useState3=(0,_react.useState)(tempResults),_useState4=_slicedToArray(_useState3,2),results=_useState4[0],setResults=_useState4[1];(0,_react.useEffect)((function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var res,_ref2,indexPattern,savedSearch,_createSearchItems,combinedQuery;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all(funcs.map((function(r){return r()})));case 3:res=_context.sent;res.forEach((function(r,i){return tempResults[funcNames[i]]=r}));setResults(tempResults);if(!(indexPatternId!==undefined||savedSearchId!==undefined)){_context.next=24;break}if(!(savedSearchId!==undefined)){_context.next=13;break}_context.next=10;return(0,_index_utils.getIndexPatternAndSavedSearch)(savedSearchId);case 10:_context.t0=_context.sent;_context.next=17;break;case 13:_context.next=15;return(0,_index_utils.getIndexPatternById)(indexPatternId);case 15:_context.t1=_context.sent;_context.t0={savedSearch:null,indexPattern:_context.t1};case 17:_ref2=_context.t0;indexPattern=_ref2.indexPattern;savedSearch=_ref2.savedSearch;_createSearchItems=(0,_new_job_utils.createSearchItems)(config,indexPattern,savedSearch),combinedQuery=_createSearchItems.combinedQuery;setContext({combinedQuery:combinedQuery,currentIndexPattern:indexPattern,currentSavedSearch:savedSearch,indexPatterns:(0,_index_utils.getIndexPatternsContract)(),kibanaConfig:config});_context.next=25;break;case 24:setContext({});case 25:_context.next=29;break;case 27:_context.prev=27;_context.t2=_context["catch"](0);case 29:case"end":return _context.stop()}}}),_callee,null,[[0,27]])})))()}),[]);return{context:context,results:results}};exports.useResolver=useResolver},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DATA_VISUALIZER_BREADCRUMB=exports.ANOMALY_DETECTION_BREADCRUMB=exports.SETTINGS=exports.ML_BREADCRUMB=void 0;var _i18n=__webpack_require__(1);var ML_BREADCRUMB=Object.freeze({text:_i18n.i18n.translate("xpack.ml.machineLearningBreadcrumbLabel",{defaultMessage:"Machine Learning"}),href:"#/"});exports.ML_BREADCRUMB=ML_BREADCRUMB;var SETTINGS=Object.freeze({text:_i18n.i18n.translate("xpack.ml.settingsBreadcrumbLabel",{defaultMessage:"Settings"}),href:"#/settings"});exports.SETTINGS=SETTINGS;var ANOMALY_DETECTION_BREADCRUMB=Object.freeze({text:_i18n.i18n.translate("xpack.ml.anomalyDetectionBreadcrumbLabel",{defaultMessage:"Anomaly Detection"}),href:"#/jobs"});exports.ANOMALY_DETECTION_BREADCRUMB=ANOMALY_DETECTION_BREADCRUMB;var DATA_VISUALIZER_BREADCRUMB=Object.freeze({text:_i18n.i18n.translate("xpack.ml.datavisualizerBreadcrumbLabel",{defaultMessage:"Data Visualizer"}),href:"#/datavisualizer"});exports.DATA_VISUALIZER_BREADCRUMB=DATA_VISUALIZER_BREADCRUMB},,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NavigationMenu",{enumerable:true,get:function get(){return _navigation_menu.NavigationMenu}});var _navigation_menu=__webpack_require__(890)},,,function(module,exports,__webpack_require__){"use strict";function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.getRichDetectors=getRichDetectors;exports.createFieldOptions=createFieldOptions;exports.createMlcategoryFieldOption=createMlcategoryFieldOption;exports.createDocCountFieldOption=createDocCountFieldOption;exports.isSparseDataJob=isSparseDataJob;exports.convertToMultiMetricJob=convertToMultiMetricJob;exports.convertToAdvancedJob=convertToAdvancedJob;exports.resetJob=resetJob;exports.advancedStartDatafeed=advancedStartDatafeed;exports.aggFieldPairsCanBeCharted=aggFieldPairsCanBeCharted;exports.getJobCreatorTitle=getJobCreatorTitle;exports.collectAggs=collectAggs;var _i18n=__webpack_require__(1);var _new_job_capabilities_service=__webpack_require__(66);var _aggregation_types=__webpack_require__(121);var _field_types=__webpack_require__(109);var _public=__webpack_require__(63);var _fields=__webpack_require__(118);var _job_service=__webpack_require__(58);var _index=__webpack_require__(89);var _new_job=__webpack_require__(60);function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var getFieldByIdFactory=function getFieldByIdFactory(additionalFields){return function(id){var field=_new_job_capabilities_service.newJobCapsService.getFieldById(id);if(field===null){if(id===_field_types.MLCATEGORY){field=_fields.mlCategory}else if(additionalFields.length){field=additionalFields.find((function(f){return f.id===id}))||null}}return field}};function getRichDetectors(job,datafeed,additionalFields){var advanced=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var detectors=advanced?getDetectorsAdvanced(job,datafeed):getDetectors(job,datafeed);var getFieldById=getFieldByIdFactory(additionalFields);return detectors.map((function(d){var field=null;var byField=null;var overField=null;var partitionField=null;if(d.field_name!==undefined){field=getFieldById(d.field_name)}if(d.by_field_name!==undefined){byField=getFieldById(d.by_field_name)}if(d.over_field_name!==undefined){overField=getFieldById(d.over_field_name)}if(d.partition_field_name!==undefined){partitionField=getFieldById(d.partition_field_name)}return{agg:_new_job_capabilities_service.newJobCapsService.getAggById(d.function),field:field,byField:byField,overField:overField,partitionField:partitionField,excludeFrequent:d.exclude_frequent||null,description:d.detector_description||null}}))}function createFieldOptions(fields,additionalFields){return[].concat(_toConsumableArray(fields.filter((function(f){return f.id!==_fields.EVENT_RATE_FIELD_ID})).map((function(f){return{label:f.name}}))),_toConsumableArray(additionalFields.filter((function(f){return fields.some((function(f2){return f2.id===f.id}))===false})).map((function(f){return{label:f.id}})))).sort((function(a,b){return a.label.localeCompare(b.label)}))}function createMlcategoryFieldOption(categorizationFieldName){if(categorizationFieldName===null){return[]}return[{label:_field_types.MLCATEGORY}]}function createDocCountFieldOption(usingAggregations){return usingAggregations?[{label:_field_types.DOC_COUNT}]:[]}function getDetectorsAdvanced(job,datafeed){return processFieldlessAggs(job.analysis_config.detectors)}function getDetectors(job,datafeed){var detectors=job.analysis_config.detectors;var sparseData=isSparseDataJob(job,datafeed);if(datafeed.aggregations!==undefined&&job.analysis_config.detectors[0].function===_aggregation_types.ML_JOB_AGGREGATION.NON_ZERO_COUNT&&sparseData===false){var _datafeed$aggregation,_datafeed$aggregation2,_datafeed$aggregation3,_datafeed$aggregation4,_datafeed$aggregation5;var field=datafeed===null||datafeed===void 0?void 0:(_datafeed$aggregation=datafeed.aggregations)===null||_datafeed$aggregation===void 0?void 0:(_datafeed$aggregation2=_datafeed$aggregation.buckets)===null||_datafeed$aggregation2===void 0?void 0:(_datafeed$aggregation3=_datafeed$aggregation2.aggregations)===null||_datafeed$aggregation3===void 0?void 0:(_datafeed$aggregation4=_datafeed$aggregation3.dc_region)===null||_datafeed$aggregation4===void 0?void 0:(_datafeed$aggregation5=_datafeed$aggregation4.cardinality)===null||_datafeed$aggregation5===void 0?void 0:_datafeed$aggregation5.field;if(field!==undefined){detectors=[{function:_aggregation_types.ML_JOB_AGGREGATION.DISTINCT_COUNT,field_name:field}]}}else{detectors=processFieldlessAggs(detectors);detectors=detectors.map((function(d){switch(d.function){case _aggregation_types.ML_JOB_AGGREGATION.NON_ZERO_COUNT:return _objectSpread({},d,{field_name:_fields.EVENT_RATE_FIELD_ID,function:_aggregation_types.ML_JOB_AGGREGATION.COUNT});case _aggregation_types.ML_JOB_AGGREGATION.HIGH_NON_ZERO_COUNT:return _objectSpread({},d,{field_name:_fields.EVENT_RATE_FIELD_ID,function:_aggregation_types.ML_JOB_AGGREGATION.HIGH_COUNT});case _aggregation_types.ML_JOB_AGGREGATION.LOW_NON_ZERO_COUNT:return _objectSpread({},d,{field_name:_fields.EVENT_RATE_FIELD_ID,function:_aggregation_types.ML_JOB_AGGREGATION.LOW_COUNT});case _aggregation_types.ML_JOB_AGGREGATION.NON_NULL_SUM:return _objectSpread({},d,{function:_aggregation_types.ML_JOB_AGGREGATION.SUM});case _aggregation_types.ML_JOB_AGGREGATION.HIGH_NON_NULL_SUM:return _objectSpread({},d,{function:_aggregation_types.ML_JOB_AGGREGATION.HIGH_SUM});case _aggregation_types.ML_JOB_AGGREGATION.LOW_NON_NULL_SUM:return _objectSpread({},d,{function:_aggregation_types.ML_JOB_AGGREGATION.LOW_SUM});default:return d}}))}return detectors}function processFieldlessAggs(detectors){return detectors.map((function(d){switch(d.function){case _aggregation_types.ML_JOB_AGGREGATION.COUNT:case _aggregation_types.ML_JOB_AGGREGATION.HIGH_COUNT:case _aggregation_types.ML_JOB_AGGREGATION.LOW_COUNT:case _aggregation_types.ML_JOB_AGGREGATION.NON_ZERO_COUNT:case _aggregation_types.ML_JOB_AGGREGATION.HIGH_NON_ZERO_COUNT:case _aggregation_types.ML_JOB_AGGREGATION.LOW_NON_ZERO_COUNT:case _aggregation_types.ML_JOB_AGGREGATION.RARE:case _aggregation_types.ML_JOB_AGGREGATION.FREQ_RARE:case _aggregation_types.ML_JOB_AGGREGATION.TIME_OF_DAY:case _aggregation_types.ML_JOB_AGGREGATION.TIME_OF_WEEK:return _objectSpread({},d,{field_name:_fields.EVENT_RATE_FIELD_ID});default:return d}}))}function isSparseDataJob(job,datafeed){var _datafeed$aggregation6,_datafeed$aggregation7,_datafeed$aggregation8,_datafeed$aggregation9,_datafeed$aggregation10;var detectors=job.analysis_config.detectors;var distinctCountField=datafeed===null||datafeed===void 0?void 0:(_datafeed$aggregation6=datafeed.aggregations)===null||_datafeed$aggregation6===void 0?void 0:(_datafeed$aggregation7=_datafeed$aggregation6.buckets)===null||_datafeed$aggregation7===void 0?void 0:(_datafeed$aggregation8=_datafeed$aggregation7.aggregations)===null||_datafeed$aggregation8===void 0?void 0:(_datafeed$aggregation9=_datafeed$aggregation8.dc_region)===null||_datafeed$aggregation9===void 0?void 0:(_datafeed$aggregation10=_datafeed$aggregation9.cardinality)===null||_datafeed$aggregation10===void 0?void 0:_datafeed$aggregation10.field;if(distinctCountField===undefined){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=detectors[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var detector=_step.value;if(_aggregation_types.SPARSE_DATA_AGGREGATIONS.includes(detector.function)){return true}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}return false}function stashCombinedJob(jobCreator){var skipTimeRangeStep=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var includeTimeRange=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var combinedJob=_objectSpread({},jobCreator.jobConfig,{datafeed_config:jobCreator.datafeedConfig});_job_service.mlJobService.tempJobCloningObjects.job=combinedJob;_job_service.mlJobService.tempJobCloningObjects.skipTimeRangeStep=skipTimeRangeStep;if(includeTimeRange===true){_job_service.mlJobService.tempJobCloningObjects.start=jobCreator.start;_job_service.mlJobService.tempJobCloningObjects.end=jobCreator.end}_job_service.mlJobService.tempJobCloningObjects.calendars=jobCreator.calendars}function convertToMultiMetricJob(jobCreator){jobCreator.createdBy=_new_job.CREATED_BY_LABEL.MULTI_METRIC;jobCreator.modelPlot=false;stashCombinedJob(jobCreator,true,true);window.location.href=window.location.href.replace(_new_job.JOB_TYPE.SINGLE_METRIC,_new_job.JOB_TYPE.MULTI_METRIC)}function convertToAdvancedJob(jobCreator){jobCreator.createdBy=null;stashCombinedJob(jobCreator,true,true);var jobType=_new_job.JOB_TYPE.SINGLE_METRIC;if((0,_index.isMultiMetricJobCreator)(jobCreator)){jobType=_new_job.JOB_TYPE.MULTI_METRIC}else if((0,_index.isPopulationJobCreator)(jobCreator)){jobType=_new_job.JOB_TYPE.POPULATION}else if((0,_index.isCategorizationJobCreator)(jobCreator)){jobType=_new_job.JOB_TYPE.CATEGORIZATION}window.location.href=window.location.href.replace(jobType,_new_job.JOB_TYPE.ADVANCED)}function resetJob(jobCreator){jobCreator.jobId="";stashCombinedJob(jobCreator,true,true);window.location.href="#/jobs/new_job"}function advancedStartDatafeed(jobCreator){stashCombinedJob(jobCreator,false,false);window.location.href="#/jobs"}function aggFieldPairsCanBeCharted(afs){return afs.some((function(a){return a.agg.dslName===null}))===false}function getJobCreatorTitle(jobCreator){switch(jobCreator.type){case _new_job.JOB_TYPE.SINGLE_METRIC:return _i18n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.singleMetric",{defaultMessage:"Single metric"});case _new_job.JOB_TYPE.MULTI_METRIC:return _i18n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.multiMetric",{defaultMessage:"Multi metric"});case _new_job.JOB_TYPE.POPULATION:return _i18n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.population",{defaultMessage:"Population"});case _new_job.JOB_TYPE.ADVANCED:return _i18n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.advanced",{defaultMessage:"Advanced"});case _new_job.JOB_TYPE.CATEGORIZATION:return _i18n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.categorization",{defaultMessage:"Categorization"});default:return""}}function collectAggs(o,aggFields){for(var i in o){if(o[i]!==null&&_typeof(o[i])==="object"){if(i==="aggregations"||i==="aggs"){Object.keys(o[i]).forEach((function(k){if(k!=="aggregations"&&k!=="aggs"){aggFields.push({id:k,name:k,type:_public.ES_FIELD_TYPES.KEYWORD,aggregatable:true})}}))}collectAggs(o[i],aggFields)}}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.VIEW_BY_JOB_LABEL=exports.MAX_INFLUENCER_FIELD_NAMES=exports.MAX_INFLUENCER_FIELD_VALUES=exports.MAX_CATEGORY_EXAMPLES=exports.CHART_TYPE=exports.SWIMLANE_TYPE=exports.FILTER_ACTION=exports.EXPLORER_ACTION=exports.DRAG_SELECT_ACTION=void 0;var _i18n=__webpack_require__(1);var DRAG_SELECT_ACTION={NEW_SELECTION:"newSelection",ELEMENT_SELECT:"elementSelect",DRAG_START:"dragStart"};exports.DRAG_SELECT_ACTION=DRAG_SELECT_ACTION;var EXPLORER_ACTION={CLEAR_INFLUENCER_FILTER_SETTINGS:"clearInfluencerFilterSettings",CLEAR_JOBS:"clearJobs",JOB_SELECTION_CHANGE:"jobSelectionChange",SET_BOUNDS:"setBounds",SET_CHARTS:"setCharts",SET_EXPLORER_DATA:"setExplorerData",SET_FILTER_DATA:"setFilterData",SET_INFLUENCER_FILTER_SETTINGS:"setInfluencerFilterSettings",SET_SELECTED_CELLS:"setSelectedCells",SET_SWIMLANE_CONTAINER_WIDTH:"setSwimlaneContainerWidth",SET_SWIMLANE_LIMIT:"setSwimlaneLimit",SET_VIEW_BY_SWIMLANE_FIELD_NAME:"setViewBySwimlaneFieldName",SET_VIEW_BY_SWIMLANE_LOADING:"setViewBySwimlaneLoading"};exports.EXPLORER_ACTION=EXPLORER_ACTION;var FILTER_ACTION={ADD:"+",REMOVE:"-"};exports.FILTER_ACTION=FILTER_ACTION;var SWIMLANE_TYPE={OVERALL:"overall",VIEW_BY:"viewBy"};exports.SWIMLANE_TYPE=SWIMLANE_TYPE;var CHART_TYPE={EVENT_DISTRIBUTION:"event_distribution",POPULATION_DISTRIBUTION:"population_distribution",SINGLE_METRIC:"single_metric"};exports.CHART_TYPE=CHART_TYPE;var MAX_CATEGORY_EXAMPLES=10;exports.MAX_CATEGORY_EXAMPLES=MAX_CATEGORY_EXAMPLES;var MAX_INFLUENCER_FIELD_VALUES=10;exports.MAX_INFLUENCER_FIELD_VALUES=MAX_INFLUENCER_FIELD_VALUES;var MAX_INFLUENCER_FIELD_NAMES=50;exports.MAX_INFLUENCER_FIELD_NAMES=MAX_INFLUENCER_FIELD_NAMES;var VIEW_BY_JOB_LABEL=_i18n.i18n.translate("xpack.ml.explorer.jobIdLabel",{defaultMessage:"job ID"});exports.VIEW_BY_JOB_LABEL=VIEW_BY_JOB_LABEL},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getUrlState=getUrlState;exports.useUrlState=void 0;var _queryString=__webpack_require__(126);var _react=__webpack_require__(28);var _lodash=__webpack_require__(49);var _risonNode=__webpack_require__(100);var _reactRouterDom=__webpack_require__(41);var _object_utils=__webpack_require__(149);var risonSerializedParams=new Set(["_a","_g"]);function isRisonSerializationRequired(queryParam){return risonSerializedParams.has(queryParam)}function getUrlState(search){var urlState={};var parsedQueryString=(0,_queryString.parse)(search,{sort:false});try{Object.keys(parsedQueryString).forEach((function(a){if(isRisonSerializationRequired(a)){urlState[a]=(0,_risonNode.decode)(parsedQueryString[a])}else{urlState[a]=parsedQueryString[a]}}))}catch(error){console.error("Could not read url state",error)}return urlState}var useUrlState=function useUrlState(accessor){var history=(0,_reactRouterDom.useHistory)();var _useLocation=(0,_reactRouterDom.useLocation)(),search=_useLocation.search;var setUrlState=(0,_react.useCallback)((function(attribute,value){var urlState=getUrlState(search);var parsedQueryString=(0,_queryString.parse)(search,{sort:false});if(!Object.prototype.hasOwnProperty.call(urlState,accessor)){urlState[accessor]={}}if(typeof attribute==="string"){if((0,_lodash.isEqual)((0,_object_utils.getNestedProperty)(urlState,"".concat(accessor,".").concat(attribute)),value)){return}urlState[accessor][attribute]=value}else{var attributes=attribute;Object.keys(attributes).forEach((function(a){urlState[accessor][a]=attributes[a]}))}try{var oldLocationSearch=(0,_queryString.stringify)(parsedQueryString,{sort:false,encode:false});Object.keys(urlState).forEach((function(a){if(isRisonSerializationRequired(a)){parsedQueryString[a]=(0,_risonNode.encode)(urlState[a])}else{parsedQueryString[a]=urlState[a]}}));var newLocationSearch=(0,_queryString.stringify)(parsedQueryString,{sort:false,encode:false});if(oldLocationSearch!==newLocationSearch){history.push({search:(0,_queryString.stringify)(parsedQueryString,{sort:false})})}}catch(error){console.error("Could not save url state",error)}}),[search]);return[getUrlState(search)[accessor],setUrlState]};exports.useUrlState=useUrlState},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobCreator",{enumerable:true,get:function get(){return _job_creator.JobCreator}});Object.defineProperty(exports,"SingleMetricJobCreator",{enumerable:true,get:function get(){return _single_metric_job_creator.SingleMetricJobCreator}});Object.defineProperty(exports,"MultiMetricJobCreator",{enumerable:true,get:function get(){return _multi_metric_job_creator.MultiMetricJobCreator}});Object.defineProperty(exports,"PopulationJobCreator",{enumerable:true,get:function get(){return _population_job_creator.PopulationJobCreator}});Object.defineProperty(exports,"AdvancedJobCreator",{enumerable:true,get:function get(){return _advanced_job_creator.AdvancedJobCreator}});Object.defineProperty(exports,"CategorizationJobCreator",{enumerable:true,get:function get(){return _categorization_job_creator.CategorizationJobCreator}});Object.defineProperty(exports,"JobCreatorType",{enumerable:true,get:function get(){return _type_guards.JobCreatorType}});Object.defineProperty(exports,"isSingleMetricJobCreator",{enumerable:true,get:function get(){return _type_guards.isSingleMetricJobCreator}});Object.defineProperty(exports,"isMultiMetricJobCreator",{enumerable:true,get:function get(){return _type_guards.isMultiMetricJobCreator}});Object.defineProperty(exports,"isPopulationJobCreator",{enumerable:true,get:function get(){return _type_guards.isPopulationJobCreator}});Object.defineProperty(exports,"isAdvancedJobCreator",{enumerable:true,get:function get(){return _type_guards.isAdvancedJobCreator}});Object.defineProperty(exports,"isCategorizationJobCreator",{enumerable:true,get:function get(){return _type_guards.isCategorizationJobCreator}});Object.defineProperty(exports,"jobCreatorFactory",{enumerable:true,get:function get(){return _job_creator_factory.jobCreatorFactory}});var _job_creator=__webpack_require__(141);var _single_metric_job_creator=__webpack_require__(469);var _multi_metric_job_creator=__webpack_require__(470);var _population_job_creator=__webpack_require__(471);var _advanced_job_creator=__webpack_require__(472);var _categorization_job_creator=__webpack_require__(473);var _type_guards=__webpack_require__(1282);var _job_creator_factory=__webpack_require__(1283)},,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createJobs=createJobs;exports.getClearedSelectedAnomaliesState=getClearedSelectedAnomaliesState;exports.getDefaultSwimlaneData=getDefaultSwimlaneData;exports.loadFilteredTopInfluencers=loadFilteredTopInfluencers;exports.getInfluencers=getInfluencers;exports.getDateFormatTz=getDateFormatTz;exports.getFieldsByJob=getFieldsByJob;exports.getSelectionTimeRange=getSelectionTimeRange;exports.getSelectionInfluencers=getSelectionInfluencers;exports.getSelectionJobIds=getSelectionJobIds;exports.getSwimlaneBucketInterval=getSwimlaneBucketInterval;exports.loadViewByTopFieldValuesForSelectedTime=loadViewByTopFieldValuesForSelectedTime;exports.getViewBySwimlaneOptions=getViewBySwimlaneOptions;exports.processOverallResults=processOverallResults;exports.processViewByResults=processViewByResults;exports.loadAnnotationsTableData=loadAnnotationsTableData;exports.loadAnomaliesTableData=loadAnomaliesTableData;exports.loadDataForCharts=loadDataForCharts;exports.loadOverallData=loadOverallData;exports.loadViewBySwimlane=loadViewBySwimlane;exports.loadTopInfluencers=loadTopInfluencers;exports.escapeRegExp=escapeRegExp;exports.escapeParens=escapeParens;exports.escapeDoubleQuotes=escapeDoubleQuotes;exports.getQueryPattern=getQueryPattern;exports.removeFilterFromQueryString=removeFilterFromQueryString;var _lodash=__webpack_require__(49);var _momentTimezone=_interopRequireDefault(__webpack_require__(36));var _i18n=__webpack_require__(1);var _search=__webpack_require__(99);var _anomaly_utils=__webpack_require__(75);var _job_utils=__webpack_require__(59);var _parse_interval=__webpack_require__(74);var _ml_api_service=__webpack_require__(51);var _job_service=__webpack_require__(58);var _results_service=__webpack_require__(132);var _time_buckets=__webpack_require__(106);var _dependency_cache=__webpack_require__(5);var _explorer_constants=__webpack_require__(86);var _legacy_utils=__webpack_require__(269);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function createJobs(jobs){return jobs.map((function(job){var bucketSpan=(0,_parse_interval.parseInterval)(job.analysis_config.bucket_span);return{id:job.job_id,selected:false,bucketSpanSeconds:bucketSpan.asSeconds()}}))}function getClearedSelectedAnomaliesState(){return{selectedCells:undefined,viewByLoadedForTimeFormatted:null}}function getDefaultSwimlaneData(){return{fieldName:"",laneLabels:[],points:[],interval:3600}}function loadFilteredTopInfluencers(_x,_x2,_x3,_x4,_x5,_x6,_x7){return _loadFilteredTopInfluencers.apply(this,arguments)}function _loadFilteredTopInfluencers(){_loadFilteredTopInfluencers=_asyncToGenerator(regeneratorRuntime.mark((function _callee(jobIds,earliestMs,latestMs,records,influencers,noInfluencersConfigured,influencersFilterQuery){var recordInfluencersByName,uniqValuesByName,filterInfluencers;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:recordInfluencersByName={};influencers.forEach((function(influencer){var fieldName=influencer.fieldName;if(recordInfluencersByName[influencer.fieldName]===undefined){recordInfluencersByName[influencer.fieldName]=[]}recordInfluencersByName[fieldName].push(influencer.fieldValue)}));records.forEach((function(record){var influencersByName=record.influencers||[];influencersByName.forEach((function(influencer){var _recordInfluencersByN;var fieldName=influencer.influencer_field_name;var fieldValues=influencer.influencer_field_values;if(recordInfluencersByName[fieldName]===undefined){recordInfluencersByName[fieldName]=[]}(_recordInfluencersByN=recordInfluencersByName[fieldName]).push.apply(_recordInfluencersByN,_toConsumableArray(fieldValues))}))}));uniqValuesByName={};Object.keys(recordInfluencersByName).forEach((function(fieldName){var fieldValues=recordInfluencersByName[fieldName];uniqValuesByName[fieldName]=(0,_lodash.uniq)(fieldValues)}));filterInfluencers=[];Object.keys(uniqValuesByName).forEach((function(fieldName){var matchingFieldName=influencers.find((function(influencer){return influencer.fieldName===fieldName}));if(matchingFieldName!==undefined){filterInfluencers.push.apply(filterInfluencers,_toConsumableArray(influencers))}else{uniqValuesByName[fieldName].forEach((function(fieldValue){filterInfluencers.push({fieldName:fieldName,fieldValue:fieldValue})}))}}));_context.next=9;return loadTopInfluencers(jobIds,earliestMs,latestMs,filterInfluencers,noInfluencersConfigured,influencersFilterQuery);case 9:return _context.abrupt("return",_context.sent);case 10:case"end":return _context.stop()}}}),_callee)})));return _loadFilteredTopInfluencers.apply(this,arguments)}function getInfluencers(){var selectedJobs=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var influencers=[];selectedJobs.forEach((function(selectedJob){var job=_job_service.mlJobService.getJob(selectedJob.id);if(job!==undefined&&job.analysis_config&&job.analysis_config.influencers){influencers.push.apply(influencers,_toConsumableArray(job.analysis_config.influencers))}}));return influencers}function getDateFormatTz(){var uiSettings=(0,_dependency_cache.getUiSettings)();var tzConfig=uiSettings.get("dateFormat:tz");var dateFormatTz=tzConfig!=="Browser"?tzConfig:_momentTimezone.default.tz.guess();return dateFormatTz}function getFieldsByJob(){return _job_service.mlJobService.jobs.reduce((function(reducedFieldsByJob,job){var analysisConfig=job.analysis_config;var influencers=analysisConfig.influencers||[];var fieldsForJob=(analysisConfig.detectors||[]).reduce((function(reducedfieldsForJob,detector){if(detector.partition_field_name!==undefined){reducedfieldsForJob.push(detector.partition_field_name)}if(detector.over_field_name!==undefined){reducedfieldsForJob.push(detector.over_field_name)}if(detector.by_field_name!==undefined&&detector.over_field_name===undefined){reducedfieldsForJob.push(detector.by_field_name)}return reducedfieldsForJob}),[]).concat(influencers);reducedFieldsByJob[job.job_id]=(0,_lodash.uniq)(fieldsForJob);reducedFieldsByJob["*"]=(0,_lodash.union)(reducedFieldsByJob["*"],reducedFieldsByJob[job.job_id]);return reducedFieldsByJob}),{"*":[]})}function getSelectionTimeRange(selectedCells,interval,bounds){var earliestMs=bounds.min.valueOf();var latestMs=bounds.max.valueOf();if(selectedCells!==undefined&&selectedCells.times!==undefined){earliestMs=selectedCells.times[0]!==undefined?selectedCells.times[0]*1e3:bounds.min.valueOf();latestMs=bounds.max.valueOf();if(selectedCells.times[1]!==undefined){latestMs=(selectedCells.times[1]+interval)*1e3-1}}return{earliestMs:earliestMs,latestMs:latestMs}}function getSelectionInfluencers(selectedCells,fieldName){if(selectedCells!==undefined&&selectedCells.type!==_explorer_constants.SWIMLANE_TYPE.OVERALL&&selectedCells.viewByFieldName!==undefined&&selectedCells.viewByFieldName!==_explorer_constants.VIEW_BY_JOB_LABEL){return selectedCells.lanes.map((function(laneLabel){return{fieldName:fieldName,fieldValue:laneLabel}}))}return[]}function getSelectionJobIds(selectedCells,selectedJobs){if(selectedCells!==undefined&&selectedCells.type!==_explorer_constants.SWIMLANE_TYPE.OVERALL&&selectedCells.viewByFieldName!==undefined&&selectedCells.viewByFieldName===_explorer_constants.VIEW_BY_JOB_LABEL){return selectedCells.lanes}return selectedJobs.map((function(d){return d.id}))}function getSwimlaneBucketInterval(selectedJobs,swimlaneContainerWidth){var timefilter=(0,_dependency_cache.getTimefilter)();var bounds=timefilter.getActiveBounds();var buckets=new _time_buckets.TimeBuckets;buckets.setInterval("auto");buckets.setBounds(bounds);var intervalSeconds=buckets.getInterval().asSeconds();var timerangeSeconds=(bounds.max.valueOf()-bounds.min.valueOf())/1e3;var numBuckets=parseInt(timerangeSeconds/intervalSeconds);var cellWidth=Math.floor(swimlaneContainerWidth/numBuckets*100)/100;if(cellWidth<8){buckets.setInterval(intervalSeconds*2+"s")}var maxBucketSpanSeconds=selectedJobs.reduce((function(memo,job){return Math.max(memo,job.bucketSpanSeconds)}),0);if(maxBucketSpanSeconds>intervalSeconds){buckets.setInterval(maxBucketSpanSeconds+"s");buckets.setBounds(bounds)}return buckets.getInterval()}function loadViewByTopFieldValuesForSelectedTime(earliestMs,latestMs,selectedJobs,viewBySwimlaneFieldName,swimlaneLimit,noInfluencersConfigured){var selectedJobIds=selectedJobs.map((function(d){return d.id}));return new Promise((function(resolve){if(viewBySwimlaneFieldName!==_explorer_constants.VIEW_BY_JOB_LABEL){_results_service.mlResultsService.getTopInfluencers(selectedJobIds,earliestMs,latestMs,swimlaneLimit).then((function(resp){if(resp.influencers[viewBySwimlaneFieldName]===undefined){resolve([])}var topFieldValues=[];var topInfluencers=resp.influencers[viewBySwimlaneFieldName];if(Array.isArray(topInfluencers)){topInfluencers.forEach((function(influencerData){if(influencerData.maxAnomalyScore>0){topFieldValues.push(influencerData.influencerFieldValue)}}))}resolve(topFieldValues)}))}else{_results_service.mlResultsService.getScoresByBucket(selectedJobIds,earliestMs,latestMs,getSwimlaneBucketInterval(selectedJobs,(0,_legacy_utils.getSwimlaneContainerWidth)(noInfluencersConfigured)).asSeconds()+"s",swimlaneLimit).then((function(resp){var topFieldValues=Object.keys(resp.results);resolve(topFieldValues)}))}}))}function getViewBySwimlaneOptions(_ref){var currentViewBySwimlaneFieldName=_ref.currentViewBySwimlaneFieldName,filterActive=_ref.filterActive,filteredFields=_ref.filteredFields,isAndOperator=_ref.isAndOperator,selectedCells=_ref.selectedCells,selectedJobs=_ref.selectedJobs;var selectedJobIds=selectedJobs.map((function(d){return d.id}));var viewByOptions=(0,_lodash.chain)(_job_service.mlJobService.jobs.reduce((function(reducedViewByOptions,job){if(selectedJobIds.some((function(jobId){return jobId===job.job_id}))){return reducedViewByOptions.concat(job.analysis_config.influencers||[])}return reducedViewByOptions}),[])).uniq().sortBy((function(fieldName){return fieldName.toLowerCase()})).value();viewByOptions.push(_explorer_constants.VIEW_BY_JOB_LABEL);var viewBySwimlaneOptions=viewByOptions;var viewBySwimlaneFieldName=undefined;if(viewBySwimlaneOptions.indexOf(currentViewBySwimlaneFieldName)!==-1){viewBySwimlaneFieldName=currentViewBySwimlaneFieldName}else{if(selectedJobIds.length>1){viewBySwimlaneFieldName=_explorer_constants.VIEW_BY_JOB_LABEL}else if(_job_service.mlJobService.jobs.length>0&&selectedJobIds.length>0){var firstSelectedJob=_job_service.mlJobService.jobs.find((function(job){return job.job_id===selectedJobIds[0]}));var firstJobInfluencers=firstSelectedJob.analysis_config.influencers||[];firstSelectedJob.analysis_config.detectors.forEach((function(detector){if(detector.partition_field_name!==undefined&&firstJobInfluencers.indexOf(detector.partition_field_name)!==-1){viewBySwimlaneFieldName=detector.partition_field_name;return false}if(detector.over_field_name!==undefined&&firstJobInfluencers.indexOf(detector.over_field_name)!==-1){viewBySwimlaneFieldName=detector.over_field_name;return false}if(detector.by_field_name!==undefined&&detector.over_field_name===undefined&&firstJobInfluencers.indexOf(detector.by_field_name)!==-1){viewBySwimlaneFieldName=detector.by_field_name;return false}}));if(viewBySwimlaneFieldName===undefined){if(firstJobInfluencers.length>0){viewBySwimlaneFieldName=firstJobInfluencers[0]}else{viewBySwimlaneFieldName=viewBySwimlaneOptions.length>0?viewBySwimlaneOptions[0]:undefined}}}}if(filterActive===true&&isAndOperator===true&&selectedCells===null){viewBySwimlaneOptions=[_explorer_constants.VIEW_BY_JOB_LABEL]}else if(filterActive===true&&Array.isArray(viewBySwimlaneOptions)&&Array.isArray(filteredFields)){var filteredOptions=viewBySwimlaneOptions.filter((function(option){return filteredFields.includes(option)||option===_explorer_constants.VIEW_BY_JOB_LABEL||selectedCells&&selectedCells.viewByFieldName===option}));if(filteredOptions.length>1){viewBySwimlaneOptions=filteredOptions}}return{viewBySwimlaneFieldName:viewBySwimlaneFieldName,viewBySwimlaneOptions:viewBySwimlaneOptions}}function processOverallResults(scoresByTime,searchBounds,interval){var overallLabel=_i18n.i18n.translate("xpack.ml.explorer.overallLabel",{defaultMessage:"Overall"});var dataset={laneLabels:[overallLabel],points:[],interval:interval,earliest:searchBounds.min.valueOf()/1e3,latest:searchBounds.max.valueOf()/1e3};if(Object.keys(scoresByTime).length>0){(0,_lodash.each)(scoresByTime,(function(score,timeMs){var time=timeMs/1e3;dataset.points.push({laneLabel:overallLabel,time:time,value:score});dataset.earliest=Math.min(time,dataset.earliest);dataset.latest=Math.max(time+dataset.interval,dataset.latest)}))}return dataset}function processViewByResults(scoresByInfluencerAndTime,sortedLaneValues,bounds,viewBySwimlaneFieldName,interval){var dataset={fieldName:viewBySwimlaneFieldName,points:[],interval:interval};dataset.earliest=bounds.earliest;dataset.latest=bounds.latest;var laneLabels=[];var maxScoreByLaneLabel={};(0,_lodash.each)(scoresByInfluencerAndTime,(function(influencerData,influencerFieldValue){laneLabels.push(influencerFieldValue);maxScoreByLaneLabel[influencerFieldValue]=0;(0,_lodash.each)(influencerData,(function(anomalyScore,timeMs){var time=timeMs/1e3;dataset.points.push({laneLabel:influencerFieldValue,time:time,value:anomalyScore});maxScoreByLaneLabel[influencerFieldValue]=Math.max(maxScoreByLaneLabel[influencerFieldValue],anomalyScore)}))}));var sortValuesLength=sortedLaneValues.length;if(sortValuesLength===0){dataset.laneLabels=laneLabels.sort((function(a,b){return maxScoreByLaneLabel[b]-maxScoreByLaneLabel[a]}))}else{dataset.laneLabels=laneLabels.sort((function(a,b){var aIndex=sortedLaneValues.indexOf(a);var bIndex=sortedLaneValues.indexOf(b);aIndex=aIndex>-1?aIndex:sortValuesLength;bIndex=bIndex>-1?bIndex:sortValuesLength;return aIndex-bIndex}))}return dataset}function loadAnnotationsTableData(selectedCells,selectedJobs,interval,bounds){var jobIds=selectedCells!==undefined&&selectedCells.viewByFieldName===_explorer_constants.VIEW_BY_JOB_LABEL?selectedCells.lanes:selectedJobs.map((function(d){return d.id}));var timeRange=getSelectionTimeRange(selectedCells,interval,bounds);return new Promise((function(resolve){_ml_api_service.ml.annotations.getAnnotations({jobIds:jobIds,earliestMs:timeRange.earliestMs,latestMs:timeRange.latestMs,maxAnnotations:_search.ANNOTATIONS_TABLE_DEFAULT_QUERY_SIZE}).toPromise().then((function(resp){if(resp.error!==undefined||resp.annotations===undefined){return resolve([])}var annotationsData=[];jobIds.forEach((function(jobId){var jobAnnotations=resp.annotations[jobId];if(jobAnnotations!==undefined){annotationsData.push.apply(annotationsData,_toConsumableArray(jobAnnotations))}}));return resolve(annotationsData.sort((function(a,b){return a.timestamp-b.timestamp})).map((function(d,i){d.key=String.fromCharCode(65+i);return d})))})).catch((function(resp){console.log("Error loading list of annotations for jobs list:",resp);return resolve([])}))}))}function loadAnomaliesTableData(_x8,_x9,_x10,_x11,_x12,_x13,_x14,_x15,_x16){return _loadAnomaliesTableData.apply(this,arguments)}function _loadAnomaliesTableData(){_loadAnomaliesTableData=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(selectedCells,selectedJobs,dateFormatTz,interval,bounds,fieldName,tableInterval,tableSeverity,influencersFilterQuery){var jobIds,influencers,timeRange;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:jobIds=getSelectionJobIds(selectedCells,selectedJobs);influencers=getSelectionInfluencers(selectedCells,fieldName);timeRange=getSelectionTimeRange(selectedCells,interval,bounds);return _context2.abrupt("return",new Promise((function(resolve,reject){_ml_api_service.ml.results.getAnomaliesTableData(jobIds,[],influencers,tableInterval,tableSeverity,timeRange.earliestMs,timeRange.latestMs,dateFormatTz,_search.ANOMALIES_TABLE_DEFAULT_QUERY_SIZE,_explorer_constants.MAX_CATEGORY_EXAMPLES,influencersFilterQuery).toPromise().then((function(resp){var anomalies=resp.anomalies;var detectorsByJob=_job_service.mlJobService.detectorsByJob;anomalies.forEach((function(anomaly){var jobId=anomaly.jobId;var detector=(0,_lodash.get)(detectorsByJob,[jobId,anomaly.detectorIndex]);anomaly.detector=(0,_lodash.get)(detector,["detector_description"],anomaly.source.function_description);if(detector!==undefined&&detector.custom_rules!==undefined){anomaly.rulesLength=detector.custom_rules.length}var job=_job_service.mlJobService.getJob(jobId);var isChartable=(0,_job_utils.isSourceDataChartableForDetector)(job,anomaly.detectorIndex);if(isChartable===false){var entityFields=(0,_anomaly_utils.getEntityFieldList)(anomaly.source);isChartable=(0,_job_utils.isModelPlotEnabled)(job,anomaly.detectorIndex,entityFields)}anomaly.isTimeSeriesViewRecord=isChartable;if(_job_service.mlJobService.customUrlsByJob[jobId]!==undefined){anomaly.customUrls=_job_service.mlJobService.customUrlsByJob[jobId]}}));resolve({anomalies:anomalies,interval:resp.interval,examplesByJobId:resp.examplesByJobId,showViewSeriesLink:true,jobIds:jobIds})})).catch((function(resp){console.log("Explorer - error loading data for anomalies table:",resp);reject()}))})));case 4:case"end":return _context2.stop()}}}),_callee2)})));return _loadAnomaliesTableData.apply(this,arguments)}var requestCount=0;function loadDataForCharts(_x17,_x18,_x19){return _loadDataForCharts.apply(this,arguments)}function _loadDataForCharts(){_loadDataForCharts=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(jobIds,earliestMs,latestMs){var influencers,selectedCells,influencersFilterQuery,_args3=arguments;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:influencers=_args3.length>3&&_args3[3]!==undefined?_args3[3]:[];selectedCells=_args3.length>4?_args3[4]:undefined;influencersFilterQuery=_args3.length>5?_args3[5]:undefined;return _context3.abrupt("return",new Promise((function(resolve){if(selectedCells===undefined&&influencers.length===0&&influencersFilterQuery===undefined){resolve([])}var newRequestCount=++requestCount;requestCount=newRequestCount;_results_service.mlResultsService.getRecordsForInfluencer(jobIds,influencers,0,earliestMs,latestMs,500,influencersFilterQuery).then((function(resp){if(newRequestCount<requestCount){resolve([])}if(selectedCells!==undefined&&Object.keys(selectedCells).length>0||influencersFilterQuery!==undefined){console.log("Explorer anomaly charts data set:",resp.records);resolve(resp.records)}resolve([])}))})));case 4:case"end":return _context3.stop()}}}),_callee3)})));return _loadDataForCharts.apply(this,arguments)}function loadOverallData(selectedJobs,interval,bounds){return new Promise((function(resolve){if(selectedJobs===null){resolve({loading:false,hasResuts:false});return}var searchBounds=(0,_time_buckets.getBoundsRoundedToInterval)(bounds,interval,false);var selectedJobIds=selectedJobs.map((function(d){return d.id}));var overallBucketsBounds=(0,_time_buckets.getBoundsRoundedToInterval)(bounds,interval,true);_results_service.mlResultsService.getOverallBucketScores(selectedJobIds,1,overallBucketsBounds.min.valueOf(),overallBucketsBounds.max.valueOf(),interval.asSeconds()+"s").then((function(resp){var overallSwimlaneData=processOverallResults(resp.results,searchBounds,interval.asSeconds());console.log("Explorer overall swimlane data set:",overallSwimlaneData);resolve({loading:false,overallSwimlaneData:overallSwimlaneData})}))}))}function loadViewBySwimlane(fieldValues,bounds,selectedJobs,viewBySwimlaneFieldName,swimlaneLimit,influencersFilterQuery,noInfluencersConfigured){return new Promise((function(resolve){var finish=function finish(resp){if(resp!==undefined){var viewBySwimlaneData=processViewByResults(resp.results,fieldValues,bounds,viewBySwimlaneFieldName,getSwimlaneBucketInterval(selectedJobs,(0,_legacy_utils.getSwimlaneContainerWidth)(noInfluencersConfigured)).asSeconds());console.log("Explorer view by swimlane data set:",viewBySwimlaneData);resolve({viewBySwimlaneData:viewBySwimlaneData,viewBySwimlaneDataLoading:false})}else{resolve({viewBySwimlaneDataLoading:false})}};if(selectedJobs===undefined||viewBySwimlaneFieldName===undefined){finish();return}else{var timefilter=(0,_dependency_cache.getTimefilter)();var timefilterBounds=timefilter.getActiveBounds();var searchBounds=(0,_time_buckets.getBoundsRoundedToInterval)(timefilterBounds,getSwimlaneBucketInterval(selectedJobs,(0,_legacy_utils.getSwimlaneContainerWidth)(noInfluencersConfigured)),false);var selectedJobIds=selectedJobs.map((function(d){return d.id}));var interval="".concat(getSwimlaneBucketInterval(selectedJobs,(0,_legacy_utils.getSwimlaneContainerWidth)(noInfluencersConfigured)).asSeconds(),"s");if(viewBySwimlaneFieldName!==_explorer_constants.VIEW_BY_JOB_LABEL){_results_service.mlResultsService.getInfluencerValueMaxScoreByTime(selectedJobIds,viewBySwimlaneFieldName,fieldValues,searchBounds.min.valueOf(),searchBounds.max.valueOf(),interval,swimlaneLimit,influencersFilterQuery).then(finish)}else{var jobIds=fieldValues!==undefined&&fieldValues.length>0?fieldValues:selectedJobIds;_results_service.mlResultsService.getScoresByBucket(jobIds,searchBounds.min.valueOf(),searchBounds.max.valueOf(),interval,swimlaneLimit).then(finish)}}}))}function loadTopInfluencers(_x20,_x21,_x22){return _loadTopInfluencers.apply(this,arguments)}function _loadTopInfluencers(){_loadTopInfluencers=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(selectedJobIds,earliestMs,latestMs){var influencers,noInfluencersConfigured,influencersFilterQuery,_args4=arguments;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:influencers=_args4.length>3&&_args4[3]!==undefined?_args4[3]:[];noInfluencersConfigured=_args4.length>4?_args4[4]:undefined;influencersFilterQuery=_args4.length>5?_args4[5]:undefined;return _context4.abrupt("return",new Promise((function(resolve){if(noInfluencersConfigured!==true){_results_service.mlResultsService.getTopInfluencers(selectedJobIds,earliestMs,latestMs,_explorer_constants.MAX_INFLUENCER_FIELD_VALUES,influencers,influencersFilterQuery).then((function(resp){console.log("Explorer top influencers data set:",resp.influencers);resolve(resp.influencers)}))}else{resolve({})}})));case 4:case"end":return _context4.stop()}}}),_callee4)})));return _loadTopInfluencers.apply(this,arguments)}function escapeRegExp(string){return string.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function escapeParens(string){return string.replace(/[()]/g,"\\$&")}function escapeDoubleQuotes(string){return string.replace(/\"/g,"\\$&")}function getQueryPattern(fieldName,fieldValue){var sanitizedFieldName=escapeRegExp(fieldName);var sanitizedFieldValue=escapeRegExp(fieldValue);return new RegExp("(".concat(sanitizedFieldName,')\\s?:\\s?(")?(').concat(sanitizedFieldValue,')(")?'),"i")}function removeFilterFromQueryString(currentQueryString,fieldName,fieldValue){var newQueryString="";var queryPattern=getQueryPattern(fieldName,fieldValue);newQueryString=currentQueryString.replace(queryPattern,"");var endPattern=/\s(and|or)\s*$/gi;var startPattern=/^\s*(and|or)\s/gi;var invalidOperatorPattern=/\s+(and|or)\s+(and|or)\s+/gi;newQueryString=newQueryString.replace(invalidOperatorPattern," $1 ");newQueryString=newQueryString.replace(endPattern,"");newQueryString=newQueryString.replace(startPattern,"");return newQueryString}},,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WIZARD_STEPS=void 0;var WIZARD_STEPS;exports.WIZARD_STEPS=WIZARD_STEPS;(function(WIZARD_STEPS){WIZARD_STEPS[WIZARD_STEPS["TIME_RANGE"]=0]="TIME_RANGE";WIZARD_STEPS[WIZARD_STEPS["ADVANCED_CONFIGURE_DATAFEED"]=1]="ADVANCED_CONFIGURE_DATAFEED";WIZARD_STEPS[WIZARD_STEPS["PICK_FIELDS"]=2]="PICK_FIELDS";WIZARD_STEPS[WIZARD_STEPS["JOB_DETAILS"]=3]="JOB_DETAILS";WIZARD_STEPS[WIZARD_STEPS["VALIDATION"]=4]="VALIDATION";WIZARD_STEPS[WIZARD_STEPS["SUMMARY"]=5]="SUMMARY"})(WIZARD_STEPS||(exports.WIZARD_STEPS=WIZARD_STEPS={}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useChartColors=useChartColors;exports.getChartSettings=getChartSettings;exports.seriesStyle=exports.defaultChartSettings=void 0;var _eui_theme_dark=_interopRequireDefault(__webpack_require__(42));var _eui_theme_light=_interopRequireDefault(__webpack_require__(40));var _job_creator=__webpack_require__(89);var _time_buckets=__webpack_require__(106);var _use_ui_settings_context=__webpack_require__(150);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function useChartColors(){var IS_DARK_THEME=(0,_use_ui_settings_context.useUiSettings)().get("theme:darkMode");var themeName=IS_DARK_THEME?_eui_theme_dark.default:_eui_theme_light.default;return{LINE_COLOR:themeName.euiColorPrimary,MODEL_COLOR:themeName.euiColorPrimary,EVENT_RATE_COLOR:themeName.euiColorPrimary,EVENT_RATE_COLOR_WITH_ANOMALIES:themeName.euiColorLightShade}}var defaultChartSettings={width:"100%",height:"300px",cols:1,intervalMs:0};exports.defaultChartSettings=defaultChartSettings;var seriesStyle={line:{strokeWidth:2,visible:true,opacity:1},border:{visible:false,strokeWidth:0},point:{visible:false,radius:2,strokeWidth:4,opacity:.5},area:{opacity:.25,visible:false}};exports.seriesStyle=seriesStyle;function getChartSettings(jobCreator,chartInterval){var cs=_objectSpread({},defaultChartSettings,{intervalMs:chartInterval.getInterval().asMilliseconds()});if((0,_job_creator.isPopulationJobCreator)(jobCreator)){var interval=new _time_buckets.TimeBuckets;interval.setInterval("auto");interval.setBounds(chartInterval.getBounds());cs.intervalMs=interval.getInterval().asMilliseconds()}if(cs.intervalMs<jobCreator.bucketSpanMs){cs.intervalMs=jobCreator.bucketSpanMs}if((0,_job_creator.isMultiMetricJobCreator)(jobCreator)||(0,_job_creator.isPopulationJobCreator)(jobCreator)){if(jobCreator.aggFieldPairs.length>2&&(0,_job_creator.isMultiMetricJobCreator)(jobCreator)){cs.cols=3;cs.height="150px";cs.intervalMs=cs.intervalMs*3}else if(jobCreator.aggFieldPairs.length>1){cs.cols=2;cs.height="200px";cs.intervalMs=cs.intervalMs*2}}return cs}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeBuckets=TimeBuckets;exports.getBoundsRoundedToInterval=getBoundsRoundedToInterval;exports.calcEsInterval=calcEsInterval;var _lodash=_interopRequireDefault(__webpack_require__(49));var _moment=_interopRequireDefault(__webpack_require__(32));var _datemath=_interopRequireDefault(__webpack_require__(95));var _calc_auto_interval=__webpack_require__(1284);var _parse_interval=__webpack_require__(74);var _dependency_cache=__webpack_require__(5);var _public=__webpack_require__(63);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var unitsDesc=_datemath.default.unitsDesc;var largeMax=unitsDesc.indexOf("w");var calcAuto=(0,_calc_auto_interval.timeBucketsCalcAutoIntervalProvider)();function TimeBuckets(){var uiSettings=(0,_dependency_cache.getUiSettings)();this.barTarget=uiSettings.get("histogram:barTarget");this.maxBars=uiSettings.get("histogram:maxBars")}TimeBuckets.prototype.setBarTarget=function(bt){this.barTarget=bt};TimeBuckets.prototype.setMaxBars=function(mb){this.maxBars=mb};TimeBuckets.prototype.setBounds=function(input){if(!input)return this.clearBounds();var bounds;if(_lodash.default.isPlainObject(input)){bounds=[input.min,input.max]}else{bounds=Array.isArray(input)?input:[]}var moments=(0,_lodash.default)(bounds).map(_lodash.default.ary(_moment.default,1)).sortBy(Number);var valid=moments.size()===2&&moments.every(isValidMoment);if(!valid){this.clearBounds();throw new Error("invalid bounds set: "+input)}this._lb=moments.shift();this._ub=moments.pop();if(this.getDuration().asSeconds()<0){throw new TypeError("Intervals must be positive")}};TimeBuckets.prototype.clearBounds=function(){this._lb=this._ub=null};TimeBuckets.prototype.hasBounds=function(){return isValidMoment(this._ub)&&isValidMoment(this._lb)};TimeBuckets.prototype.getBounds=function(){if(!this.hasBounds())return;return{min:this._lb,max:this._ub}};TimeBuckets.prototype.getDuration=function(){if(!this.hasBounds())return;return _moment.default.duration(this._ub-this._lb,"ms")};TimeBuckets.prototype.setInterval=function(input){this.originalInterval=input;var interval=input;if(!interval||interval==="auto"){this._i="auto";return}if(_lodash.default.isString(interval)){input=interval;interval=(0,_parse_interval.parseInterval)(interval);if(+interval===0){interval=null}}if(!_moment.default.isDuration(interval)){throw new TypeError('"'+input+'" is not a valid interval.')}this._i=interval};TimeBuckets.prototype.getInterval=function(){var self=this;var duration=self.getDuration();return decorateInterval(maybeScaleInterval(readInterval()),duration);function readInterval(){var interval=self._i;if(_moment.default.isDuration(interval))return interval;return calcAuto.near(self.barTarget,duration)}function maybeScaleInterval(interval){if(!self.hasBounds())return interval;var maxLength=self.maxBars;var approxLen=duration/interval;var scaled;if(approxLen>maxLength){scaled=calcAuto.lessThan(maxLength,duration)}else{return interval}if(+scaled===+interval)return interval;decorateInterval(interval,duration);return _lodash.default.assign(scaled,{preScaled:interval,scale:interval/scaled,scaled:true})}};TimeBuckets.prototype.getIntervalToNearestMultiple=function(divisorSecs){var interval=this.getInterval();var intervalSecs=interval.asSeconds();var remainder=intervalSecs%divisorSecs;if(remainder===0){return interval}var nearestMultiple=remainder>divisorSecs/2?intervalSecs+divisorSecs-remainder:intervalSecs-remainder;nearestMultiple=nearestMultiple===0?divisorSecs:nearestMultiple;var nearestMultipleInt=_moment.default.duration(nearestMultiple,"seconds");decorateInterval(nearestMultipleInt,this.getDuration());var preScaled=_lodash.default.get(interval,"preScaled");if(preScaled!==undefined&&preScaled<nearestMultipleInt){nearestMultipleInt.preScaled=preScaled;nearestMultipleInt.scale=preScaled/nearestMultipleInt;nearestMultipleInt.scaled=true}return nearestMultipleInt};TimeBuckets.prototype.getScaledDateFormat=function(){var uiSettings=(0,_dependency_cache.getUiSettings)();var interval=this.getInterval();var rules=uiSettings.get("dateFormat:scaled");for(var i=rules.length-1;i>=0;i--){var rule=rules[i];if(!rule[0]||interval>=_moment.default.duration(rule[0])){return rule[1]}}return uiSettings.get("dateFormat")};TimeBuckets.prototype.getScaledDateFormatter=function(){var fieldFormats=(0,_dependency_cache.getFieldFormats)();var uiSettings=(0,_dependency_cache.getUiSettings)();var DateFieldFormat=fieldFormats.getType(_public.FIELD_FORMAT_IDS.DATE);return new DateFieldFormat({pattern:this.getScaledDateFormat()},uiSettings.get)};function decorateInterval(interval,originalDuration){var esInterval=calcEsInterval(interval);interval.esValue=esInterval.value;interval.esUnit=esInterval.unit;interval.expression=esInterval.expression;interval.overflow=originalDuration>interval?_moment.default.duration(interval-originalDuration):false;var prettyUnits=_moment.default.normalizeUnits(esInterval.unit);if(esInterval.value===1){interval.description=prettyUnits}else{interval.description="".concat(esInterval.value," ").concat(prettyUnits,"s")}return interval}function isValidMoment(m){return m&&"isValid"in m&&m.isValid()}function getBoundsRoundedToInterval(bounds,interval){var inclusiveEnd=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var intervalMs=interval.asMilliseconds();var adjustedMinMs=Math.floor(bounds.min.valueOf()/intervalMs)*intervalMs;var adjustedMaxMs=Math.ceil(bounds.max.valueOf()/intervalMs)*intervalMs;if(inclusiveEnd===false){adjustedMaxMs=adjustedMaxMs-1}return{min:(0,_moment.default)(adjustedMinMs),max:(0,_moment.default)(adjustedMaxMs)}}function calcEsInterval(duration){for(var i=0;i<unitsDesc.length;i++){var unit=unitsDesc[i];var val=duration.as(unit);if(val>=1&&Math.floor(val)===val){if(i<=largeMax&&val!==1){continue}return{value:val,unit:unit,expression:val+unit}}}var ms=duration.as("ms");return{value:ms,unit:"ms",expression:ms+"ms"}}},,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.basicResolvers=void 0;var _index_utils=__webpack_require__(70);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _check_ml_nodes=__webpack_require__(81);var _ml_server_info=__webpack_require__(84);var basicResolvers=function basicResolvers(_ref){var indexPatterns=_ref.indexPatterns;return{checkFullLicense:_license.checkFullLicense,getMlNodeCount:_check_ml_nodes.getMlNodeCount,loadMlServerInfo:_ml_server_info.loadMlServerInfo,loadIndexPatterns:function loadIndexPatterns(){return(0,_index_utils.loadIndexPatterns)(indexPatterns)},checkGetJobsPrivilege:_check_privilege.checkGetJobsPrivilege,loadSavedSearches:_index_utils.loadSavedSearches}};exports.basicResolvers=basicResolvers},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlFieldFormatService=void 0;var _job_utils=__webpack_require__(59);var _index_utils=__webpack_require__(70);var _job_service=__webpack_require__(58);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var FieldFormatService=function(){function FieldFormatService(){_classCallCheck(this,FieldFormatService);_defineProperty(this,"indexPatternIdsByJob",{});_defineProperty(this,"formatsByJob",{})}_createClass(FieldFormatService,[{key:"populateFormats",value:function populateFormats(jobIds){var _this=this;return new Promise((function(resolve,reject){jobIds.forEach((function(jobId){var jobObj=_job_service.mlJobService.getJob(jobId);var datafeedIndices=jobObj.datafeed_config.indices;var id=(0,_index_utils.getIndexPatternIdFromName)(datafeedIndices.length?datafeedIndices[0]:"");if(id!==null){_this.indexPatternIdsByJob[jobId]=id}}));var promises=jobIds.map((function(jobId){return Promise.all([_this.getFormatsForJob(jobId)])}));Promise.all(promises).then((function(fmtsByJobByDetector){fmtsByJobByDetector.forEach((function(formatsByDetector,i){_this.formatsByJob[jobIds[i]]=formatsByDetector[0]}));resolve(_this.formatsByJob)})).catch((function(err){reject({formats:{},err:err})}))}))}},{key:"getFieldFormat",value:function getFieldFormat(jobId,detectorIndex){if(this.formatsByJob.hasOwnProperty(jobId)){return this.formatsByJob[jobId][detectorIndex]}}},{key:"getFieldFormatFromIndexPattern",value:function getFieldFormatFromIndexPattern(fullIndexPattern,fieldName,esAggName){var fieldFormat;if(esAggName!=="cardinality"){var fieldList=fullIndexPattern.fields;var field=fieldList.getByName(fieldName);if(field!==undefined){fieldFormat=field.format}}return fieldFormat}},{key:"getFormatsForJob",value:function getFormatsForJob(jobId){var _this2=this;return new Promise((function(resolve,reject){var jobObj=_job_service.mlJobService.getJob(jobId);var detectors=jobObj.analysis_config.detectors||[];var formatsByDetector=[];var indexPatternId=_this2.indexPatternIdsByJob[jobId];if(indexPatternId!==undefined){(0,_index_utils.getIndexPatternById)(indexPatternId).then((function(indexPatternData){var fieldList=indexPatternData.fields;detectors.forEach((function(dtr){var esAgg=(0,_job_utils.mlFunctionToESAggregation)(dtr.function);if(dtr.field_name!==undefined&&esAgg!=="cardinality"){var field=fieldList.getByName(dtr.field_name);if(field!==undefined){formatsByDetector[dtr.detector_index]=field.format}}}));resolve(formatsByDetector)})).catch((function(err){reject(err)}))}else{resolve(formatsByDetector)}}))}}]);return FieldFormatService}();var mlFieldFormatService=new FieldFormatService;exports.mlFieldFormatService=mlFieldFormatService},,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ES_AGGREGATION=exports.KIBANA_AGGREGATION=exports.SPARSE_DATA_AGGREGATIONS=exports.ML_JOB_AGGREGATION=void 0;var ML_JOB_AGGREGATION;exports.ML_JOB_AGGREGATION=ML_JOB_AGGREGATION;(function(ML_JOB_AGGREGATION){ML_JOB_AGGREGATION["COUNT"]="count";ML_JOB_AGGREGATION["HIGH_COUNT"]="high_count";ML_JOB_AGGREGATION["LOW_COUNT"]="low_count";ML_JOB_AGGREGATION["NON_ZERO_COUNT"]="non_zero_count";ML_JOB_AGGREGATION["HIGH_NON_ZERO_COUNT"]="high_non_zero_count";ML_JOB_AGGREGATION["LOW_NON_ZERO_COUNT"]="low_non_zero_count";ML_JOB_AGGREGATION["DISTINCT_COUNT"]="distinct_count";ML_JOB_AGGREGATION["HIGH_DISTINCT_COUNT"]="high_distinct_count";ML_JOB_AGGREGATION["LOW_DISTINCT_COUNT"]="low_distinct_count";ML_JOB_AGGREGATION["MIN"]="min";ML_JOB_AGGREGATION["MAX"]="max";ML_JOB_AGGREGATION["MEDIAN"]="median";ML_JOB_AGGREGATION["LOW_MEDIAN"]="low_median";ML_JOB_AGGREGATION["HIGH_MEAN"]="high_mean";ML_JOB_AGGREGATION["MEAN"]="mean";ML_JOB_AGGREGATION["LOW_MEAN"]="low_mean";ML_JOB_AGGREGATION["HIGH_MEDIAN"]="high_median";ML_JOB_AGGREGATION["METRIC"]="metric";ML_JOB_AGGREGATION["VARP"]="varp";ML_JOB_AGGREGATION["HIGH_VARP"]="high_varp";ML_JOB_AGGREGATION["LOW_VARP"]="low_varp";ML_JOB_AGGREGATION["SUM"]="sum";ML_JOB_AGGREGATION["HIGH_SUM"]="high_sum";ML_JOB_AGGREGATION["LOW_SUM"]="low_sum";ML_JOB_AGGREGATION["NON_NULL_SUM"]="non_null_sum";ML_JOB_AGGREGATION["HIGH_NON_NULL_SUM"]="high_non_null_sum";ML_JOB_AGGREGATION["LOW_NON_NULL_SUM"]="low_non_null_sum";ML_JOB_AGGREGATION["RARE"]="rare";ML_JOB_AGGREGATION["FREQ_RARE"]="freq_rare";ML_JOB_AGGREGATION["INFO_CONTENT"]="info_content";ML_JOB_AGGREGATION["HIGH_INFO_CONTENT"]="high_info_content";ML_JOB_AGGREGATION["LOW_INFO_CONTENT"]="low_info_content";ML_JOB_AGGREGATION["TIME_OF_DAY"]="time_of_day";ML_JOB_AGGREGATION["TIME_OF_WEEK"]="time_of_week";ML_JOB_AGGREGATION["LAT_LONG"]="lat_long"})(ML_JOB_AGGREGATION||(exports.ML_JOB_AGGREGATION=ML_JOB_AGGREGATION={}));var SPARSE_DATA_AGGREGATIONS=[ML_JOB_AGGREGATION.NON_ZERO_COUNT,ML_JOB_AGGREGATION.HIGH_NON_ZERO_COUNT,ML_JOB_AGGREGATION.LOW_NON_ZERO_COUNT,ML_JOB_AGGREGATION.NON_NULL_SUM,ML_JOB_AGGREGATION.HIGH_NON_NULL_SUM,ML_JOB_AGGREGATION.LOW_NON_NULL_SUM];exports.SPARSE_DATA_AGGREGATIONS=SPARSE_DATA_AGGREGATIONS;var KIBANA_AGGREGATION;exports.KIBANA_AGGREGATION=KIBANA_AGGREGATION;(function(KIBANA_AGGREGATION){KIBANA_AGGREGATION["COUNT"]="count";KIBANA_AGGREGATION["AVG"]="avg";KIBANA_AGGREGATION["MAX"]="max";KIBANA_AGGREGATION["MIN"]="min";KIBANA_AGGREGATION["SUM"]="sum";KIBANA_AGGREGATION["MEDIAN"]="median";KIBANA_AGGREGATION["CARDINALITY"]="cardinality"})(KIBANA_AGGREGATION||(exports.KIBANA_AGGREGATION=KIBANA_AGGREGATION={}));var ES_AGGREGATION;exports.ES_AGGREGATION=ES_AGGREGATION;(function(ES_AGGREGATION){ES_AGGREGATION["COUNT"]="count";ES_AGGREGATION["AVG"]="avg";ES_AGGREGATION["MAX"]="max";ES_AGGREGATION["MIN"]="min";ES_AGGREGATION["SUM"]="sum";ES_AGGREGATION["PERCENTILES"]="percentiles";ES_AGGREGATION["CARDINALITY"]="cardinality"})(ES_AGGREGATION||(exports.ES_AGGREGATION=ES_AGGREGATION={}))},,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createEmptyJob=createEmptyJob;exports.createEmptyDatafeed=createEmptyDatafeed;exports.createBasicDetector=createBasicDetector;var _fields=__webpack_require__(118);function createEmptyJob(){return{job_id:"",description:"",groups:[],analysis_config:{bucket_span:"",detectors:[],influencers:[]},data_description:{time_field:""}}}function createEmptyDatafeed(indexPatternTitle){return{datafeed_id:"",job_id:"",indices:[indexPatternTitle],query:{}}}function createBasicDetector(agg,field){var dtr={function:agg.id};if(field.id!==_fields.EVENT_RATE_FIELD_ID){dtr.field_name=field.id}return dtr}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlResultsService=void 0;var _result_service_rx=__webpack_require__(1278);var _results_service=__webpack_require__(1279);var mlResultsService={getScoresByBucket:_results_service.getScoresByBucket,getScheduledEventsByBucket:_result_service_rx.getScheduledEventsByBucket,getTopInfluencers:_results_service.getTopInfluencers,getTopInfluencerValues:_results_service.getTopInfluencerValues,getOverallBucketScores:_results_service.getOverallBucketScores,getInfluencerValueMaxScoreByTime:_results_service.getInfluencerValueMaxScoreByTime,getRecordInfluencers:_results_service.getRecordInfluencers,getRecordsForInfluencer:_results_service.getRecordsForInfluencer,getRecordsForDetector:_results_service.getRecordsForDetector,getRecords:_results_service.getRecords,getRecordsForCriteria:_result_service_rx.getRecordsForCriteria,getMetricData:_result_service_rx.getMetricData,getEventRateData:_results_service.getEventRateData,getEventDistributionData:_results_service.getEventDistributionData,getModelPlotOutput:_result_service_rx.getModelPlotOutput,getRecordMaxScoreByTime:_results_service.getRecordMaxScoreByTime,fetchPartitionFieldsValues:_result_service_rx.fetchPartitionFieldsValues};exports.mlResultsService=mlResultsService},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.formatValue=formatValue;var _moment=_interopRequireDefault(__webpack_require__(32));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SIGFIGS_IF_ROUNDING=3;function formatValue(value,mlFunction,fieldFormat,record){if(Array.isArray(value)){if(value.length===1){return formatSingleValue(value[0],mlFunction,fieldFormat,record)}else{var values=value.map((function(val){return formatSingleValue(val,mlFunction,undefined,record)}));return"[".concat(values,"]")}}else{return formatSingleValue(value,mlFunction,fieldFormat,record)}}function formatSingleValue(value,mlFunction,fieldFormat,record){if(value===undefined||value===null){return""}if(mlFunction==="time_of_week"){var d=record!==undefined&&record.timestamp!==undefined?new Date(record.timestamp):new Date;var utcMoment=_moment.default.utc(d).startOf("week").add(value,"s");return(0,_moment.default)(utcMoment.valueOf()).format("ddd HH:mm")}else if(mlFunction==="time_of_day"){var _d=record!==undefined&&record.timestamp!==undefined?new Date(record.timestamp):new Date;var _utcMoment=_moment.default.utc(_d).startOf("day").add(value,"s");return(0,_moment.default)(_utcMoment.valueOf()).format("HH:mm")}else{if(fieldFormat!==undefined){return fieldFormat.convert(value,"text")}else{var absValue=Math.abs(value);if(absValue>=1e4||absValue===Math.floor(absValue)){if(fieldFormat!==undefined){return fieldFormat.convert(value,"text")}else{return Number(value.toFixed(0))}}else if(absValue>=10){return Number(value.toFixed(1))}else{var multiple;if(value>0){multiple=Math.pow(10,SIGFIGS_IF_ROUNDING-Math.floor(Math.log(value)/Math.LN10)-1)}else{multiple=Math.pow(10,SIGFIGS_IF_ROUNDING-Math.floor(Math.log(-1*value)/Math.LN10)-1)}return Math.round(value*multiple)/multiple}}}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlChartTooltipService=exports.chartTooltip$=exports.getChartTooltipDefaultState=void 0;var _rxjs=__webpack_require__(33);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var getChartTooltipDefaultState=function getChartTooltipDefaultState(){return{isTooltipVisible:false,tooltipData:[],offset:{x:0,y:0},targetPosition:{left:0,top:0},tooltipPosition:{left:0,top:0}}};exports.getChartTooltipDefaultState=getChartTooltipDefaultState;var chartTooltip$=new _rxjs.BehaviorSubject(getChartTooltipDefaultState());exports.chartTooltip$=chartTooltip$;var mlChartTooltipService={show:function show(tooltipData,target){var offset=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{x:0,y:0};if(typeof target!=="undefined"&&target!==null){chartTooltip$.next(_objectSpread({},chartTooltip$.getValue(),{isTooltipVisible:true,offset:offset,targetPosition:target.getBoundingClientRect(),tooltipData:tooltipData}))}},hide:function hide(){chartTooltip$.next(_objectSpread({},getChartTooltipDefaultState(),{isTooltipVisible:false}))}};exports.mlChartTooltipService=mlChartTooltipService},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.chartLimits=chartLimits;exports.drawLineChartDots=drawLineChartDots;exports.filterAxisLabels=filterAxisLabels;exports.getChartType=getChartType;exports.getExploreSeriesLink=getExploreSeriesLink;exports.showMultiBucketAnomalyMarker=showMultiBucketAnomalyMarker;exports.showMultiBucketAnomalyTooltip=showMultiBucketAnomalyTooltip;exports.numTicks=numTicks;exports.numTicksForDateFormat=numTicksForDateFormat;exports.getTickValues=getTickValues;exports.isLabelLengthAboveThreshold=isLabelLengthAboveThreshold;exports.getXTransform=getXTransform;exports.removeLabelOverlap=removeLabelOverlap;exports.SCHEDULED_EVENT_SYMBOL_HEIGHT=exports.MULTI_BUCKET_SYMBOL_SIZE=exports.LINE_CHART_ANOMALY_RADIUS=void 0;var _d=_interopRequireDefault(__webpack_require__(97));var _string_utils=__webpack_require__(80);var _multi_bucket_impact=__webpack_require__(188);var _moment=_interopRequireDefault(__webpack_require__(32));var _risonNode=_interopRequireDefault(__webpack_require__(100));var _dependency_cache=__webpack_require__(5);var _explorer_constants=__webpack_require__(86);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LINE_CHART_ANOMALY_RADIUS=7;exports.LINE_CHART_ANOMALY_RADIUS=LINE_CHART_ANOMALY_RADIUS;var MULTI_BUCKET_SYMBOL_SIZE=100;exports.MULTI_BUCKET_SYMBOL_SIZE=MULTI_BUCKET_SYMBOL_SIZE;var SCHEDULED_EVENT_SYMBOL_HEIGHT=5;exports.SCHEDULED_EVENT_SYMBOL_HEIGHT=SCHEDULED_EVENT_SYMBOL_HEIGHT;var MAX_LABEL_WIDTH=100;function chartLimits(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var domain=_d.default.extent(data,(function(d){var metricValue=d.value;if(metricValue===null&&d.anomalyScore!==undefined&&d.actual!==undefined){metricValue=Array.isArray(d.actual)?d.actual[0]:d.actual}return metricValue}));var limits={max:domain[1],min:domain[0]};if(limits.max===limits.min){limits.max=_d.default.max(data,(function(d){if(d.typical){return Math.max(d.value,d.typical)}else{return d.value}}));limits.min=_d.default.min(data,(function(d){if(d.typical){return Math.min(d.value,d.typical)}else{return d.value}}))}if(limits.max===limits.min){var padding=limits.max*.05;limits.max+=padding;limits.min-=padding}return limits}function drawLineChartDots(data,lineChartGroup,lineChartValuesLine){var radius=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1.5;var dotsData=data.reduce((function(p,c,i){var previous=data[i-1];var next=data[i+1];if((typeof previous==="undefined"||previous&&previous.value===null)&&c.value!==null&&(typeof next==="undefined"||next&&next.value===null)){p.push(c)}return p}),[]);var dotGroup=lineChartGroup.select(".values-dots").empty()?lineChartGroup.append("g").classed("values-dots",true):lineChartGroup.select(".values-dots");var dots=dotGroup.selectAll("circle").data(dotsData);dots.enter().append("circle").attr("r",radius);dots.attr("cx",lineChartValuesLine.x()).attr("cy",lineChartValuesLine.y());dots.exit().remove()}function filterAxisLabels(selection,chartWidth){if(selection===undefined||selection.selectAll===undefined){throw new Error("Missing selection parameter")}selection.selectAll(".tick text").text((function(){var parent=_d.default.select(this.parentNode);var labelWidth=parent.node().getBBox().width;var labelXPos=_d.default.transform(parent.attr("transform")).translate[0];var minThreshold=labelXPos-labelWidth/2;var maxThreshold=labelXPos+labelWidth/2;if(minThreshold>=0&&maxThreshold<=chartWidth){return this.textContent}else{parent.remove()}}))}var EVENT_DISTRIBUTION_ENABLED=true;var POPULATION_DISTRIBUTION_ENABLED=true;function getChartType(config){var chartType=_explorer_constants.CHART_TYPE.SINGLE_METRIC;if(EVENT_DISTRIBUTION_ENABLED&&config.functionDescription==="rare"&&config.entityFields.some((function(f){return f.fieldType==="over"}))===false){chartType=_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION}else if(POPULATION_DISTRIBUTION_ENABLED&&config.functionDescription!=="rare"&&config.entityFields.some((function(f){return f.fieldType==="over"}))&&config.metricFunction!==null){chartType=_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION}if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION||chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){if(config.datafeedConfig!==undefined&&config.datafeedConfig.script_fields!==undefined){var scriptFields=Object.keys(config.datafeedConfig.script_fields);var checkFields=config.entityFields.map((function(entity){return entity.fieldName}));if(config.metricFieldName){checkFields.push(config.metricFieldName)}var usesScriptFields=checkFields.find((function(fieldName){return scriptFields.includes(fieldName)}))!==undefined;if(usesScriptFields===true){chartType=_explorer_constants.CHART_TYPE.SINGLE_METRIC}}}return chartType}function getExploreSeriesLink(series){var timefilter=(0,_dependency_cache.getTimefilter)();var bounds=timefilter.getActiveBounds();var from=bounds.min.toISOString();var to=bounds.max.toISOString();var zoomFrom=(0,_moment.default)(series.plotEarliest).toISOString();var zoomTo=(0,_moment.default)(series.plotLatest).toISOString();var entityCondition={};series.entityFields.forEach((function(entity){entityCondition[entity.fieldName]=entity.fieldValue}));var _g=_risonNode.default.encode({ml:{jobIds:[series.jobId]},refreshInterval:{display:"Off",pause:false,value:0},time:{from:from,to:to,mode:"absolute"}});var _a=_risonNode.default.encode({mlTimeSeriesExplorer:{zoom:{from:zoomFrom,to:zoomTo},detectorIndex:series.detectorIndex,entities:entityCondition},query:{query_string:{analyze_wildcard:true,query:"*"}}});return"#/timeseriesexplorer?_g=".concat(_g,"&_a=").concat(encodeURIComponent(_a))}function showMultiBucketAnomalyMarker(point){return point.multiBucketImpact!==undefined&&point.multiBucketImpact>=_multi_bucket_impact.MULTI_BUCKET_IMPACT.MEDIUM}function showMultiBucketAnomalyTooltip(point){return point.multiBucketImpact!==undefined&&point.multiBucketImpact>=_multi_bucket_impact.MULTI_BUCKET_IMPACT.LOW}function numTicks(axisWidth){return axisWidth/MAX_LABEL_WIDTH}function numTicksForDateFormat(axisWidth,dateFormat){var tickWidth=(0,_string_utils.calculateTextWidth)((0,_moment.default)().format(dateFormat),false);return axisWidth/(1.75*tickWidth)}var TICK_DIRECTION={NEXT:"next",PREVIOUS:"previous"};function getTickValues(startTimeMs,tickInterval,earliest,latest){if(tickInterval<=0){throw Error("tickInterval must be larger than 0.")}var tickValues=[startTimeMs];function addTicks(ts,operator){var newTick;var addAnotherTick;switch(operator){case TICK_DIRECTION.PREVIOUS:newTick=ts-tickInterval;addAnotherTick=newTick>=earliest;break;case TICK_DIRECTION.NEXT:newTick=ts+tickInterval;addAnotherTick=newTick<=latest;break}if(addAnotherTick){tickValues.push(newTick);addTicks(newTick,operator)}}addTicks(startTimeMs,TICK_DIRECTION.PREVIOUS);addTicks(startTimeMs,TICK_DIRECTION.NEXT);tickValues.sort();return tickValues}var LABEL_WRAP_THRESHOLD=60;function isLabelLengthAboveThreshold(_ref){var detectorLabel=_ref.detectorLabel,entityFields=_ref.entityFields;var labelLength=detectorLabel.length+entityFields.map((function(d){return"".concat(d.fieldName," ").concat(d.fieldValue)})).join(" ").length;return labelLength>LABEL_WRAP_THRESHOLD}function getXTransform(t){var regexResult=/translate\(\s*([^\s,)]+)([ ,]([^\s,)]+))?\)/.exec(t);if(Array.isArray(regexResult)&&regexResult.length>=2){return Number(regexResult[1])}return NaN}function removeLabelOverlap(axis,startTimeMs,tickInterval,width){axis.selectAll("g.tick").select("line").classed("ml-tick-emphasis",true);function getNeighborTickFactory(operator){return function(ts){switch(operator){case TICK_DIRECTION.PREVIOUS:return ts-tickInterval;case TICK_DIRECTION.NEXT:return ts+tickInterval}}}function getTickDataFactory(operator){var getNeighborTick=getNeighborTickFactory(operator);var fn=function fn(ts){var filteredTicks=axis.selectAll(".tick").filter((function(d){return d===ts}));if(filteredTicks.length===0||filteredTicks[0].length===0){return false}var tick=_d.default.selectAll(filteredTicks[0]);var textNode=tick.select("text").node();if(textNode===null){return fn(getNeighborTick(ts))}var tickWidth=textNode.getBBox().width;var padding=15;var xTransform=getXTransform(tick.attr("transform"));var xMinOffset=xTransform-(tickWidth/2+padding);var xMaxOffset=xTransform+(tickWidth/2+padding);return{tick:tick,ts:ts,xMinOffset:xMinOffset,xMaxOffset:xMaxOffset}};return fn}function checkTicks(ts,operator){var getTickData=getTickDataFactory(operator);var currentTickData=getTickData(ts);if(currentTickData===false){return}var getNeighborTick=getNeighborTickFactory(operator);var newTickData=getTickData(getNeighborTick(ts));if(newTickData!==false){if(newTickData.xMinOffset<0||newTickData.xMaxOffset>width||newTickData.xMaxOffset>currentTickData.xMinOffset&&operator===TICK_DIRECTION.PREVIOUS||newTickData.xMinOffset<currentTickData.xMaxOffset&&operator===TICK_DIRECTION.NEXT){newTickData.tick.select("text").remove();newTickData.tick.select("line").classed("ml-tick-emphasis",false);checkTicks(currentTickData.ts,operator)}else{checkTicks(newTickData.ts,operator)}}}checkTicks(startTimeMs,TICK_DIRECTION.PREVIOUS);checkTicks(startTimeMs,TICK_DIRECTION.NEXT)}},,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"WizardNav",{enumerable:true,get:function get(){return _wizard_nav.WizardNav}});Object.defineProperty(exports,"PreviousButton",{enumerable:true,get:function get(){return _wizard_nav.PreviousButton}});Object.defineProperty(exports,"NextButton",{enumerable:true,get:function get(){return _wizard_nav.NextButton}});var _wizard_nav=__webpack_require__(1271)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobCreator=void 0;var _aggregation_types=__webpack_require__(121);var _public=__webpack_require__(63);var _default_configs=__webpack_require__(131);var _job_service=__webpack_require__(58);var _job_runner=__webpack_require__(1274);var _new_job=__webpack_require__(60);var _general=__webpack_require__(85);var _parse_interval=__webpack_require__(74);var _calendar_service=__webpack_require__(407);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var JobCreator=function(){function JobCreator(indexPattern,savedSearch,query){_classCallCheck(this,JobCreator);_defineProperty(this,"_type",_new_job.JOB_TYPE.SINGLE_METRIC);_defineProperty(this,"_indexPattern",void 0);_defineProperty(this,"_savedSearch",void 0);_defineProperty(this,"_indexPatternTitle","");_defineProperty(this,"_job_config",void 0);_defineProperty(this,"_calendars",void 0);_defineProperty(this,"_datafeed_config",void 0);_defineProperty(this,"_detectors",void 0);_defineProperty(this,"_influencers",void 0);_defineProperty(this,"_bucketSpanMs",0);_defineProperty(this,"_useDedicatedIndex",false);_defineProperty(this,"_start",0);_defineProperty(this,"_end",0);_defineProperty(this,"_subscribers",[]);_defineProperty(this,"_aggs",[]);_defineProperty(this,"_fields",[]);_defineProperty(this,"_scriptFields",[]);_defineProperty(this,"_aggregationFields",[]);_defineProperty(this,"_sparseData",false);_defineProperty(this,"_stopAllRefreshPolls",{stop:false});this._indexPattern=indexPattern;this._savedSearch=savedSearch;this._indexPatternTitle=indexPattern.title;this._job_config=(0,_default_configs.createEmptyJob)();this._calendars=[];this._datafeed_config=(0,_default_configs.createEmptyDatafeed)(this._indexPatternTitle);this._detectors=this._job_config.analysis_config.detectors;this._influencers=this._job_config.analysis_config.influencers;if(typeof indexPattern.timeFieldName==="string"){this._job_config.data_description.time_field=indexPattern.timeFieldName}this._datafeed_config.query=query}_createClass(JobCreator,[{key:"_addDetector",value:function _addDetector(detector,agg,field){this._detectors.push(detector);this._aggs.push(agg);this._fields.push(field);this._updateSparseDataDetectors()}},{key:"_editDetector",value:function _editDetector(detector,agg,field,index){if(this._detectors[index]!==undefined){this._detectors[index]=detector;this._aggs[index]=agg;this._fields[index]=field;this._updateSparseDataDetectors()}}},{key:"_removeDetector",value:function _removeDetector(index){this._detectors.splice(index,1);this._aggs.splice(index,1);this._fields.splice(index,1)}},{key:"removeAllDetectors",value:function removeAllDetectors(){this._detectors.length=0;this._aggs.length=0;this._fields.length=0}},{key:"getAggregation",value:function getAggregation(index){var agg=this._aggs[index];return agg!==undefined?agg:null}},{key:"getField",value:function getField(index){var field=this._fields[index];return field!==undefined?field:null}},{key:"_setBucketSpanMs",value:function _setBucketSpanMs(bucketSpan){var bs=(0,_parse_interval.parseInterval)(bucketSpan);this._bucketSpanMs=bs===null?0:bs.asMilliseconds()}},{key:"addInfluencer",value:function addInfluencer(influencer){if(this._influencers.includes(influencer)===false){this._influencers.push(influencer)}}},{key:"removeInfluencer",value:function removeInfluencer(influencer){var idx=this._influencers.indexOf(influencer);if(idx!==-1){this._influencers.splice(idx,1)}}},{key:"removeAllInfluencers",value:function removeAllInfluencers(){this._influencers.length=0}},{key:"addCategorizationFilter",value:function addCategorizationFilter(filter){if(this._job_config.analysis_config.categorization_filters===undefined){this._job_config.analysis_config.categorization_filters=[]}var filters=this._job_config.analysis_config.categorization_filters;if(filters.includes(filter)===false){filters.push(filter)}}},{key:"removeCategorizationFilter",value:function removeCategorizationFilter(filter){var filters=this._job_config.analysis_config.categorization_filters;if(filters!==undefined){var idx=filters.indexOf(filter);if(idx!==-1){filters.splice(idx,1)}if(filters.length===0){this.removeCategorizationFilters()}}}},{key:"removeCategorizationFilters",value:function removeCategorizationFilters(){delete this._job_config.analysis_config.categorization_filters}},{key:"_updateSparseDataDetectors",value:function _updateSparseDataDetectors(){var _this=this;this._detectors.forEach((function(d,i){switch(_this._aggs[i].id){case _aggregation_types.ML_JOB_AGGREGATION.COUNT:d.function=_this._sparseData?_aggregation_types.ML_JOB_AGGREGATION.NON_ZERO_COUNT:_aggregation_types.ML_JOB_AGGREGATION.COUNT;break;case _aggregation_types.ML_JOB_AGGREGATION.HIGH_COUNT:d.function=_this._sparseData?_aggregation_types.ML_JOB_AGGREGATION.HIGH_NON_ZERO_COUNT:_aggregation_types.ML_JOB_AGGREGATION.HIGH_COUNT;break;case _aggregation_types.ML_JOB_AGGREGATION.LOW_COUNT:d.function=_this._sparseData?_aggregation_types.ML_JOB_AGGREGATION.LOW_NON_ZERO_COUNT:_aggregation_types.ML_JOB_AGGREGATION.LOW_COUNT;break;case _aggregation_types.ML_JOB_AGGREGATION.SUM:d.function=_this._sparseData?_aggregation_types.ML_JOB_AGGREGATION.NON_NULL_SUM:_aggregation_types.ML_JOB_AGGREGATION.SUM;break;case _aggregation_types.ML_JOB_AGGREGATION.HIGH_SUM:d.function=_this._sparseData?_aggregation_types.ML_JOB_AGGREGATION.HIGH_NON_NULL_SUM:_aggregation_types.ML_JOB_AGGREGATION.HIGH_SUM;break;case _aggregation_types.ML_JOB_AGGREGATION.LOW_SUM:d.function=_this._sparseData?_aggregation_types.ML_JOB_AGGREGATION.LOW_NON_NULL_SUM:_aggregation_types.ML_JOB_AGGREGATION.LOW_SUM;break}}))}},{key:"_updateCalendars",value:function(){var _updateCalendars2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,calendar;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(this._calendars.length===0)){_context.next=2;break}return _context.abrupt("return");case 2:_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context.prev=5;_iterator=this._calendars[Symbol.iterator]();case 7:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context.next=14;break}calendar=_step.value;_context.next=11;return _calendar_service.mlCalendarService.assignNewJobId(calendar,this.jobId);case 11:_iteratorNormalCompletion=true;_context.next=7;break;case 14:_context.next=20;break;case 16:_context.prev=16;_context.t0=_context["catch"](5);_didIteratorError=true;_iteratorError=_context.t0;case 20:_context.prev=20;_context.prev=21;if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}case 23:_context.prev=23;if(!_didIteratorError){_context.next=26;break}throw _iteratorError;case 26:return _context.finish(23);case 27:return _context.finish(20);case 28:case"end":return _context.stop()}}}),_callee,this,[[5,16,20,28],[21,,23,27]])})));function _updateCalendars(){return _updateCalendars2.apply(this,arguments)}return _updateCalendars}()},{key:"setTimeRange",value:function setTimeRange(start,end){this._start=start;this._end=end}},{key:"createAndStartJob",value:function(){var _createAndStartJob=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var jobRunner;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return this.createJob();case 3:_context2.next=5;return this.createDatafeed();case 5:_context2.next=7;return this.startDatafeed();case 7:jobRunner=_context2.sent;return _context2.abrupt("return",jobRunner);case 11:_context2.prev=11;_context2.t0=_context2["catch"](0);throw _context2.t0;case 14:case"end":return _context2.stop()}}}),_callee2,this,[[0,11]])})));function createAndStartJob(){return _createAndStartJob.apply(this,arguments)}return createAndStartJob}()},{key:"createJob",value:function(){var _createJob=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _ref,success,resp;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return _job_service.mlJobService.saveNewJob(this._job_config);case 3:_ref=_context3.sent;success=_ref.success;resp=_ref.resp;_context3.next=8;return this._updateCalendars();case 8:if(!(success===true)){_context3.next=12;break}return _context3.abrupt("return",resp);case 12:throw resp;case 13:_context3.next=18;break;case 15:_context3.prev=15;_context3.t0=_context3["catch"](0);throw _context3.t0;case 18:case"end":return _context3.stop()}}}),_callee3,this,[[0,15]])})));function createJob(){return _createJob.apply(this,arguments)}return createJob}()},{key:"createDatafeed",value:function(){var _createDatafeed=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return _job_service.mlJobService.saveNewDatafeed(this._datafeed_config,this._job_config.job_id);case 3:return _context4.abrupt("return",_context4.sent);case 6:_context4.prev=6;_context4.t0=_context4["catch"](0);throw _context4.t0;case 9:case"end":return _context4.stop()}}}),_callee4,this,[[0,6]])})));function createDatafeed(){return _createDatafeed.apply(this,arguments)}return createDatafeed}()},{key:"startDatafeed",value:function(){var _startDatafeed=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var jobRunner;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:jobRunner=new _job_runner.JobRunner(this);_context5.next=3;return jobRunner.startDatafeed();case 3:return _context5.abrupt("return",jobRunner);case 4:case"end":return _context5.stop()}}}),_callee5,this)})));function startDatafeed(){return _startDatafeed.apply(this,arguments)}return startDatafeed}()},{key:"subscribeToProgress",value:function subscribeToProgress(func){this._subscribers.push(func)}},{key:"forceStopRefreshPolls",value:function forceStopRefreshPolls(){this._stopAllRefreshPolls.stop=true}},{key:"_setCustomSetting",value:function _setCustomSetting(setting,value){if(value===null){if(this._job_config.custom_settings!==undefined&&this._job_config.custom_settings[setting]!==undefined){delete this._job_config.custom_settings[setting];if(Object.keys(this._job_config.custom_settings).length===0){delete this._job_config.custom_settings}}}else{if(this._job_config.custom_settings===undefined){this._job_config.custom_settings=_defineProperty({},setting,value)}else{this._job_config.custom_settings[setting]=value}}}},{key:"_getCustomSetting",value:function _getCustomSetting(setting){if(this._job_config.custom_settings!==undefined&&this._job_config.custom_settings[setting]!==undefined){return this._job_config.custom_settings[setting]}return null}},{key:"_overrideConfigs",value:function _overrideConfigs(job,datafeed){var _this2=this,_this$_datafeed_confi,_this$_datafeed_confi2;this._job_config=job;this._datafeed_config=datafeed;this._detectors=this._job_config.analysis_config.detectors;this._influencers=this._job_config.analysis_config.influencers;if(this._job_config.groups===undefined){this._job_config.groups=[]}if(this._job_config.analysis_config.influencers!==undefined){this._job_config.analysis_config.influencers.forEach((function(i){return _this2.addInfluencer(i)}))}if(this._job_config.results_index_name!==undefined&&this._job_config.results_index_name!==_new_job.SHARED_RESULTS_INDEX_NAME){this.useDedicatedIndex=true}this._sparseData=(0,_general.isSparseDataJob)(job,datafeed);this._scriptFields=[];if(this._datafeed_config.script_fields!==undefined){this._scriptFields=Object.keys(this._datafeed_config.script_fields).map((function(f){return{id:f,name:f,type:_public.ES_FIELD_TYPES.KEYWORD,aggregatable:true}}))}this._aggregationFields=[];var buckets=((_this$_datafeed_confi=this._datafeed_config.aggregations)===null||_this$_datafeed_confi===void 0?void 0:_this$_datafeed_confi.buckets)||((_this$_datafeed_confi2=this._datafeed_config.aggs)===null||_this$_datafeed_confi2===void 0?void 0:_this$_datafeed_confi2.buckets);if(buckets!==undefined){(0,_general.collectAggs)(buckets,this._aggregationFields)}}},{key:"type",get:function get(){return this._type}},{key:"detectors",get:function get(){return this._detectors}},{key:"aggregationsInDetectors",get:function get(){return this._aggs}},{key:"aggregations",get:function get(){return this._aggs}},{key:"fields",get:function get(){return this._fields}},{key:"bucketSpan",set:function set(bucketSpan){this._job_config.analysis_config.bucket_span=bucketSpan;this._setBucketSpanMs(bucketSpan)},get:function get(){return this._job_config.analysis_config.bucket_span}},{key:"bucketSpanMs",get:function get(){return this._bucketSpanMs}},{key:"influencers",get:function get(){return this._influencers}},{key:"jobId",set:function set(jobId){this._job_config.job_id=jobId;this._datafeed_config.job_id=jobId;this._datafeed_config.datafeed_id="datafeed-".concat(jobId);if(this._useDedicatedIndex){this._job_config.results_index_name=jobId}},get:function get(){return this._job_config.job_id}},{key:"datafeedId",get:function get(){return this._datafeed_config.datafeed_id}},{key:"description",set:function set(description){this._job_config.description=description},get:function get(){return this._job_config.description}},{key:"groups",get:function get(){return this._job_config.groups},set:function set(groups){this._job_config.groups=groups}},{key:"calendars",get:function get(){return this._calendars},set:function set(calendars){this._calendars=calendars}},{key:"modelPlot",set:function set(enable){if(enable){this._job_config.model_plot_config={enabled:true}}else{delete this._job_config.model_plot_config}},get:function get(){return this._job_config.model_plot_config!==undefined&&this._job_config.model_plot_config.enabled===true}},{key:"useDedicatedIndex",set:function set(enable){this._useDedicatedIndex=enable;if(enable){this._job_config.results_index_name=this._job_config.job_id}else{delete this._job_config.results_index_name}},get:function get(){return this._useDedicatedIndex}},{key:"modelMemoryLimit",set:function set(mml){if(mml!==null){this._job_config.analysis_limits={model_memory_limit:mml}}else{delete this._job_config.analysis_limits}},get:function get(){if(this._job_config.analysis_limits&&this._job_config.analysis_limits.model_memory_limit!==undefined){return this._job_config.analysis_limits.model_memory_limit}else{return null}}},{key:"summaryCountFieldName",set:function set(fieldName){if(fieldName!==null){this._job_config.analysis_config.summary_count_field_name=fieldName}else{delete this._job_config.analysis_config.summary_count_field_name}},get:function get(){return this._job_config.analysis_config.summary_count_field_name||null}},{key:"categorizationFieldName",set:function set(fieldName){if(fieldName!==null){this._job_config.analysis_config.categorization_field_name=fieldName}else{delete this._job_config.analysis_config.categorization_field_name}},get:function get(){return this._job_config.analysis_config.categorization_field_name||null}},{key:"categorizationFilters",get:function get(){return this._job_config.analysis_config.categorization_filters||null}},{key:"timeFieldName",get:function get(){return this._job_config.data_description.time_field},set:function set(fieldName){this._job_config.data_description.time_field=fieldName}},{key:"sparseData",get:function get(){return this._sparseData},set:function set(sparseData){this._sparseData=sparseData;this._updateSparseDataDetectors()}},{key:"start",get:function get(){return this._start}},{key:"end",get:function get(){return this._end}},{key:"query",get:function get(){return this._datafeed_config.query},set:function set(query){this._datafeed_config.query=query}},{key:"queryDelay",get:function get(){return this._datafeed_config.query_delay||null},set:function set(queryDelay){if(queryDelay!==null){this._datafeed_config.query_delay=queryDelay}else{delete this._datafeed_config.query_delay}}},{key:"frequency",get:function get(){return this._datafeed_config.frequency||null},set:function set(frequency){if(frequency!==null){this._datafeed_config.frequency=frequency}else{delete this._datafeed_config.frequency}}},{key:"scrollSize",get:function get(){return this._datafeed_config.scroll_size||null},set:function set(scrollSize){if(scrollSize!==null){this._datafeed_config.scroll_size=scrollSize}else{delete this._datafeed_config.scroll_size}}},{key:"indices",get:function get(){return this._datafeed_config.indices}},{key:"scriptFields",get:function get(){return this._scriptFields}},{key:"aggregationFields",get:function get(){return this._aggregationFields}},{key:"additionalFields",get:function get(){return[].concat(_toConsumableArray(this._scriptFields),_toConsumableArray(this._aggregationFields))}},{key:"subscribers",get:function get(){return this._subscribers}},{key:"jobConfig",get:function get(){return this._job_config}},{key:"datafeedConfig",get:function get(){return this._datafeed_config}},{key:"stopAllRefreshPolls",get:function get(){return this._stopAllRefreshPolls}},{key:"createdBy",set:function set(createdBy){this._setCustomSetting("created_by",createdBy)},get:function get(){return this._getCustomSetting("created_by")}},{key:"customUrls",set:function set(customUrls){this._setCustomSetting("custom_urls",customUrls)},get:function get(){return this._getCustomSetting("custom_urls")}},{key:"formattedJobJson",get:function get(){return JSON.stringify(this._job_config,null,2)}},{key:"formattedDatafeedJson",get:function get(){return JSON.stringify(this._datafeed_config,null,2)}}]);return JobCreator}();exports.JobCreator=JobCreator},function(module,exports,__webpack_require__){"use strict";var _VALIDATION_CHECK_DES;function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}Object.defineProperty(exports,"__esModule",{value:true});exports.VALIDATION_CHECK_DESCRIPTION=exports.CATEGORY_EXAMPLES_VALIDATION_STATUS=exports.NULL_COUNT_PERCENT_LIMIT=exports.MEDIAN_LINE_LENGTH_LIMIT=exports.VALID_TOKEN_COUNT=exports.CATEGORY_EXAMPLES_ERROR_LIMIT=exports.CATEGORY_EXAMPLES_WARNING_LIMIT=exports.CATEGORY_EXAMPLES_SAMPLE_SIZE=exports.NUMBER_OF_CATEGORY_EXAMPLES=void 0;var _i18n=__webpack_require__(1);var _categories=__webpack_require__(1276);var NUMBER_OF_CATEGORY_EXAMPLES=5;exports.NUMBER_OF_CATEGORY_EXAMPLES=NUMBER_OF_CATEGORY_EXAMPLES;var CATEGORY_EXAMPLES_SAMPLE_SIZE=1e3;exports.CATEGORY_EXAMPLES_SAMPLE_SIZE=CATEGORY_EXAMPLES_SAMPLE_SIZE;var CATEGORY_EXAMPLES_WARNING_LIMIT=.75;exports.CATEGORY_EXAMPLES_WARNING_LIMIT=CATEGORY_EXAMPLES_WARNING_LIMIT;var CATEGORY_EXAMPLES_ERROR_LIMIT=.02;exports.CATEGORY_EXAMPLES_ERROR_LIMIT=CATEGORY_EXAMPLES_ERROR_LIMIT;var VALID_TOKEN_COUNT=3;exports.VALID_TOKEN_COUNT=VALID_TOKEN_COUNT;var MEDIAN_LINE_LENGTH_LIMIT=400;exports.MEDIAN_LINE_LENGTH_LIMIT=MEDIAN_LINE_LENGTH_LIMIT;var NULL_COUNT_PERCENT_LIMIT=.75;exports.NULL_COUNT_PERCENT_LIMIT=NULL_COUNT_PERCENT_LIMIT;var CATEGORY_EXAMPLES_VALIDATION_STATUS;exports.CATEGORY_EXAMPLES_VALIDATION_STATUS=CATEGORY_EXAMPLES_VALIDATION_STATUS;(function(CATEGORY_EXAMPLES_VALIDATION_STATUS){CATEGORY_EXAMPLES_VALIDATION_STATUS["VALID"]="valid";CATEGORY_EXAMPLES_VALIDATION_STATUS["PARTIALLY_VALID"]="partially_valid";CATEGORY_EXAMPLES_VALIDATION_STATUS["INVALID"]="invalid"})(CATEGORY_EXAMPLES_VALIDATION_STATUS||(exports.CATEGORY_EXAMPLES_VALIDATION_STATUS=CATEGORY_EXAMPLES_VALIDATION_STATUS={}));var VALIDATION_CHECK_DESCRIPTION=(_VALIDATION_CHECK_DES={},_defineProperty(_VALIDATION_CHECK_DES,_categories.VALIDATION_RESULT.NO_EXAMPLES,_i18n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validNoDataFound",{defaultMessage:"Examples  were successfully loaded."})),_defineProperty(_VALIDATION_CHECK_DES,_categories.VALIDATION_RESULT.FAILED_TO_TOKENIZE,_i18n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validFailureToGetTokens",{defaultMessage:"The examples loaded were tokenized successfully."})),_defineProperty(_VALIDATION_CHECK_DES,_categories.VALIDATION_RESULT.TOKEN_COUNT,_i18n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validTokenLength",{defaultMessage:"More than {tokenCount} tokens per example were found in over {percentage}% of the examples loaded.",values:{percentage:Math.floor(CATEGORY_EXAMPLES_WARNING_LIMIT*100),tokenCount:VALID_TOKEN_COUNT}})),_defineProperty(_VALIDATION_CHECK_DES,_categories.VALIDATION_RESULT.MEDIAN_LINE_LENGTH,_i18n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validMedianLineLength",{defaultMessage:"The median line length of the examples loaded was less than {medianCharCount} characters.",values:{medianCharCount:MEDIAN_LINE_LENGTH_LIMIT}})),_defineProperty(_VALIDATION_CHECK_DES,_categories.VALIDATION_RESULT.NULL_VALUES,_i18n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validNullValues",{defaultMessage:"Less than {percentage}% of the examples loaded were null.",values:{percentage:Math.floor(100-NULL_COUNT_PERCENT_LIMIT*100)}})),_defineProperty(_VALIDATION_CHECK_DES,_categories.VALIDATION_RESULT.TOO_MANY_TOKENS,_i18n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validTooManyTokens",{defaultMessage:"Less than 10000 tokens were found in total in the examples loaded."})),_defineProperty(_VALIDATION_CHECK_DES,_categories.VALIDATION_RESULT.INSUFFICIENT_PRIVILEGES,_i18n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validUserPrivileges",{defaultMessage:"The user has sufficient privileges to perform the checks."})),_VALIDATION_CHECK_DES);exports.VALIDATION_CHECK_DESCRIPTION=VALIDATION_CHECK_DESCRIPTION},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getNewConditionDefaults=getNewConditionDefaults;exports.getNewRuleDefaults=getNewRuleDefaults;exports.getScopeFieldDefaults=getScopeFieldDefaults;exports.isValidRule=isValidRule;exports.saveJobRule=saveJobRule;exports.deleteJobRule=deleteJobRule;exports.updateJobRules=updateJobRules;exports.addItemToFilter=addItemToFilter;exports.buildRuleDescription=buildRuleDescription;exports.filterTypeToText=filterTypeToText;exports.appliesToText=appliesToText;exports.operatorToText=operatorToText;exports.getAppliesToValueFromAnomaly=getAppliesToValueFromAnomaly;var _detector_rule=__webpack_require__(128);var _lodash=__webpack_require__(49);var _ml_api_service=__webpack_require__(51);var _job_service=__webpack_require__(58);var _i18n=__webpack_require__(1);var _job_utils=__webpack_require__(59);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getNewConditionDefaults(){return{applies_to:_detector_rule.APPLIES_TO.ACTUAL,operator:_detector_rule.OPERATOR.LESS_THAN,value:1}}function getNewRuleDefaults(){return{actions:[_detector_rule.ACTION.SKIP_RESULT],conditions:[]}}function getScopeFieldDefaults(filterListIds){var defaults={filter_type:_detector_rule.FILTER_TYPE.INCLUDE,enabled:false};if(filterListIds!==undefined&&filterListIds.length>0){defaults.filter_id=filterListIds[0]}return defaults}function isValidRule(rule){var isValid=false;var actions=rule.actions;if(actions.length>0){var conditions=rule.conditions;if(conditions!==undefined&&conditions.length>0){isValid=true}else{var scope=rule.scope;if(scope!==undefined){isValid=Object.keys(scope).some((function(field){return scope[field].enabled===true}))}}}return isValid}function saveJobRule(job,detectorIndex,ruleIndex,editedRule){var detector=job.analysis_config.detectors[detectorIndex];var clonedRule=(0,_lodash.cloneDeep)(editedRule);var scope=clonedRule.scope;if(scope!==undefined){Object.keys(scope).forEach((function(field){if(scope[field].enabled===false){delete scope[field]}else{delete scope[field].enabled}}))}var rules=[];if(detector.custom_rules===undefined){rules=[clonedRule]}else{rules=(0,_lodash.cloneDeep)(detector.custom_rules);if(ruleIndex<rules.length){rules[ruleIndex]=clonedRule}else{rules.push(clonedRule)}}return updateJobRules(job,detectorIndex,rules)}function deleteJobRule(job,detectorIndex,ruleIndex){var detector=job.analysis_config.detectors[detectorIndex];var customRules=[];if(detector.custom_rules!==undefined&&ruleIndex<detector.custom_rules.length){customRules=(0,_lodash.cloneDeep)(detector.custom_rules);customRules.splice(ruleIndex,1);return updateJobRules(job,detectorIndex,customRules)}else{return Promise.reject(new Error(_i18n.i18n.translate("xpack.ml.ruleEditor.deleteJobRule.ruleNoLongerExistsErrorMessage",{defaultMessage:"Rule no longer exists for detector index {detectorIndex} in job {jobId}",values:{detectorIndex:detectorIndex,jobId:job.job_id}})))}}function updateJobRules(job,detectorIndex,rules){var jobId=job.job_id;var jobData={detectors:[{detector_index:detectorIndex,custom_rules:rules}]};var customSettings={};if(job.custom_settings!==undefined){customSettings=_objectSpread({},job.custom_settings);(0,_job_utils.processCreatedBy)(customSettings);jobData.custom_settings=customSettings}return new Promise((function(resolve,reject){_job_service.mlJobService.updateJob(jobId,jobData).then((function(resp){if(resp.success){_job_service.mlJobService.refreshJob(jobId).then((function(){resolve({success:true})})).catch((function(refreshResp){reject(refreshResp)}))}else{reject(resp)}})).catch((function(resp){reject(resp)}))}))}function addItemToFilter(item,filterId){return new Promise((function(resolve,reject){_ml_api_service.ml.filters.updateFilter(filterId,undefined,[item],undefined).then((function(updatedFilter){resolve(updatedFilter)})).catch((function(error){reject(error)}))}))}function buildRuleDescription(rule){var actions=rule.actions,conditions=rule.conditions,scope=rule.scope;var actionsText="";var conditionsText="";var filtersText="";actions.forEach((function(action,i){if(i>0){actionsText+=" AND "}switch(action){case _detector_rule.ACTION.SKIP_RESULT:actionsText+=_i18n.i18n.translate("xpack.ml.ruleEditor.ruleDescription.resultActionTypeText",{defaultMessage:"result",description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText +"+"xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"});break;case _detector_rule.ACTION.SKIP_MODEL_UPDATE:actionsText+=_i18n.i18n.translate("xpack.ml.ruleEditor.ruleDescription.modelUpdateActionTypeText",{defaultMessage:"model update",description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + "+"xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"});break}}));if(conditions!==undefined){conditions.forEach((function(condition,i){if(i>0){conditionsText+=" AND "}conditionsText+=_i18n.i18n.translate("xpack.ml.ruleEditor.ruleDescription.conditionsText",{defaultMessage:"{appliesTo} is {operator} {value}",values:{appliesTo:appliesToText(condition.applies_to),operator:operatorToText(condition.operator),value:condition.value},description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + "+"xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})}))}if(scope!==undefined){if(conditions!==undefined&&conditions.length>0){filtersText+=" AND "}var fieldNames=Object.keys(scope);fieldNames.forEach((function(fieldName,i){if(i>0){filtersText+=" AND "}var filter=scope[fieldName];filtersText+=_i18n.i18n.translate("xpack.ml.ruleEditor.ruleDescription.filtersText",{defaultMessage:"{fieldName} is {filterType} {filterId}",values:{fieldName:fieldName,filterType:filterTypeToText(filter.filter_type),filterId:filter.filter_id},description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + "+"xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})}))}return _i18n.i18n.translate("xpack.ml.ruleEditor.ruleDescription",{defaultMessage:"skip {actions} when {conditions}{filters}",values:{actions:actionsText,conditions:conditionsText,filters:filtersText},description:"Composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + "+"xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText."+" (Example: skip model update when actual is less than 1 AND ip is in xxx)"})}function filterTypeToText(filterType){switch(filterType){case _detector_rule.FILTER_TYPE.INCLUDE:return _i18n.i18n.translate("xpack.ml.ruleEditor.includeFilterTypeText",{defaultMessage:"in"});case _detector_rule.FILTER_TYPE.EXCLUDE:return _i18n.i18n.translate("xpack.ml.ruleEditor.excludeFilterTypeText",{defaultMessage:"not in"});default:return filterType!==undefined?filterType:""}}function appliesToText(appliesTo){switch(appliesTo){case _detector_rule.APPLIES_TO.ACTUAL:return _i18n.i18n.translate("xpack.ml.ruleEditor.actualAppliesTypeText",{defaultMessage:"actual"});case _detector_rule.APPLIES_TO.TYPICAL:return _i18n.i18n.translate("xpack.ml.ruleEditor.typicalAppliesTypeText",{defaultMessage:"typical"});case _detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL:return _i18n.i18n.translate("xpack.ml.ruleEditor.diffFromTypicalAppliesTypeText",{defaultMessage:"diff from typical"});default:return appliesTo!==undefined?appliesTo:""}}function operatorToText(operator){switch(operator){case _detector_rule.OPERATOR.LESS_THAN:return _i18n.i18n.translate("xpack.ml.ruleEditor.lessThanOperatorTypeText",{defaultMessage:"less than"});case _detector_rule.OPERATOR.LESS_THAN_OR_EQUAL:return _i18n.i18n.translate("xpack.ml.ruleEditor.lessThanOrEqualToOperatorTypeText",{defaultMessage:"less than or equal to"});case _detector_rule.OPERATOR.GREATER_THAN:return _i18n.i18n.translate("xpack.ml.ruleEditor.greaterThanOperatorTypeText",{defaultMessage:"greater than"});case _detector_rule.OPERATOR.GREATER_THAN_OR_EQUAL:return _i18n.i18n.translate("xpack.ml.ruleEditor.greaterThanOrEqualToOperatorTypeText",{defaultMessage:"greater than or equal to"});default:return operator!==undefined?operator:""}}function getAppliesToValueFromAnomaly(anomaly,appliesTo){var actualValue;var typicalValue;var actual=anomaly.actual;if(actual!==undefined){actualValue=Array.isArray(actual)?actual[0]:actual}var typical=anomaly.typical;if(typical!==undefined){typicalValue=Array.isArray(typical)?typical[0]:typical}switch(appliesTo){case _detector_rule.APPLIES_TO.ACTUAL:return actualValue;case _detector_rule.APPLIES_TO.TYPICAL:return typicalValue;case _detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL:if(actual!==undefined&&typical!==undefined){return Math.abs(actualValue-typicalValue)}}return undefined}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.explorerService=exports.explorerAction$=exports.dragSelect$=exports.ALLOW_CELL_RANGE_SELECTION=void 0;var _lodash=__webpack_require__(49);var _rxjs=__webpack_require__(33);var _operators=__webpack_require__(6);var _actions=__webpack_require__(527);var _explorer_constants=__webpack_require__(86);var _reducers=__webpack_require__(1716);var ALLOW_CELL_RANGE_SELECTION=true;exports.ALLOW_CELL_RANGE_SELECTION=ALLOW_CELL_RANGE_SELECTION;var dragSelect$=new _rxjs.Subject;exports.dragSelect$=dragSelect$;var explorerAction$=new _rxjs.Subject;exports.explorerAction$=explorerAction$;var explorerFilteredAction$=explorerAction$.pipe((0,_operators.flatMap)((function(action){return(0,_rxjs.isObservable)(action)?action:(0,_rxjs.from)([action])})),(0,_operators.distinctUntilChanged)(_lodash.isEqual));var explorerState$=explorerFilteredAction$.pipe((0,_operators.scan)(_reducers.explorerReducer,(0,_reducers.getExplorerDefaultState)()));var explorerAppState$=explorerState$.pipe((0,_operators.map)((function(state){var appState={mlExplorerFilter:{},mlExplorerSwimlane:{}};if(state.selectedCells!==undefined){var swimlaneSelectedCells=state.selectedCells;appState.mlExplorerSwimlane.selectedType=swimlaneSelectedCells.type;appState.mlExplorerSwimlane.selectedLanes=swimlaneSelectedCells.lanes;appState.mlExplorerSwimlane.selectedTimes=swimlaneSelectedCells.times;appState.mlExplorerSwimlane.showTopFieldValues=swimlaneSelectedCells.showTopFieldValues}if(state.viewBySwimlaneFieldName!==undefined){appState.mlExplorerSwimlane.viewByFieldName=state.viewBySwimlaneFieldName}if(state.filterActive){appState.mlExplorerFilter.influencersFilterQuery=state.influencersFilterQuery;appState.mlExplorerFilter.filterActive=state.filterActive;appState.mlExplorerFilter.filteredFields=state.filteredFields;appState.mlExplorerFilter.queryString=state.queryString}return appState})),(0,_operators.distinctUntilChanged)(_lodash.isEqual));var setExplorerDataActionCreator=function setExplorerDataActionCreator(payload){return{type:_explorer_constants.EXPLORER_ACTION.SET_EXPLORER_DATA,payload:payload}};var setFilterDataActionCreator=function setFilterDataActionCreator(payload){return{type:_explorer_constants.EXPLORER_ACTION.SET_FILTER_DATA,payload:payload}};var explorerService={appState$:explorerAppState$,state$:explorerState$,clearInfluencerFilterSettings:function clearInfluencerFilterSettings(){explorerAction$.next({type:_explorer_constants.EXPLORER_ACTION.CLEAR_INFLUENCER_FILTER_SETTINGS})},clearJobs:function clearJobs(){explorerAction$.next({type:_explorer_constants.EXPLORER_ACTION.CLEAR_JOBS})},updateJobSelection:function updateJobSelection(selectedJobIds){explorerAction$.next((0,_actions.jobSelectionActionCreator)(selectedJobIds))},setBounds:function setBounds(payload){explorerAction$.next({type:_explorer_constants.EXPLORER_ACTION.SET_BOUNDS,payload:payload})},setCharts:function setCharts(payload){explorerAction$.next({type:_explorer_constants.EXPLORER_ACTION.SET_CHARTS,payload:payload})},setInfluencerFilterSettings:function setInfluencerFilterSettings(payload){explorerAction$.next({type:_explorer_constants.EXPLORER_ACTION.SET_INFLUENCER_FILTER_SETTINGS,payload:payload})},setSelectedCells:function setSelectedCells(payload){explorerAction$.next({type:_explorer_constants.EXPLORER_ACTION.SET_SELECTED_CELLS,payload:payload})},setExplorerData:function setExplorerData(payload){explorerAction$.next(setExplorerDataActionCreator(payload))},setFilterData:function setFilterData(payload){explorerAction$.next(setFilterDataActionCreator(payload))},setSwimlaneContainerWidth:function setSwimlaneContainerWidth(payload){explorerAction$.next({type:_explorer_constants.EXPLORER_ACTION.SET_SWIMLANE_CONTAINER_WIDTH,payload:payload})},setSwimlaneLimit:function setSwimlaneLimit(payload){explorerAction$.next({type:_explorer_constants.EXPLORER_ACTION.SET_SWIMLANE_LIMIT,payload:payload})},setViewBySwimlaneFieldName:function setViewBySwimlaneFieldName(payload){explorerAction$.next({type:_explorer_constants.EXPLORER_ACTION.SET_VIEW_BY_SWIMLANE_FIELD_NAME,payload:payload})},setViewBySwimlaneLoading:function setViewBySwimlaneLoading(payload){explorerAction$.next({type:_explorer_constants.EXPLORER_ACTION.SET_VIEW_BY_SWIMLANE_LOADING,payload:payload})}};exports.explorerService=explorerService},,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getMostSevereMessageStatus=getMostSevereMessageStatus;exports.isValidJson=isValidJson;var _validation=__webpack_require__(107);var contains=function contains(arr,str){return arr.indexOf(str)>=0};function getMostSevereMessageStatus(messages){var statuses=messages.map((function(m){return m.status}));return[_validation.VALIDATION_STATUS.INFO,_validation.VALIDATION_STATUS.WARNING,_validation.VALIDATION_STATUS.ERROR].reduce((function(previous,current){return contains(statuses,current)?current:previous}),_validation.VALIDATION_STATUS.SUCCESS)}function isValidJson(json){if(json===null){return false}try{JSON.parse(json);return true}catch(error){return false}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"BucketSpan",{enumerable:true,get:function get(){return _bucket_span.BucketSpan}});var _bucket_span=__webpack_require__(1299)},,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlTimefilterTimeChange$=exports.mlTimefilterRefresh$=void 0;var _rxjs=__webpack_require__(33);var mlTimefilterRefresh$=new _rxjs.Subject;exports.mlTimefilterRefresh$=mlTimefilterRefresh$;var mlTimefilterTimeChange$=new _rxjs.Subject;exports.mlTimefilterTimeChange$=mlTimefilterTimeChange$},,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobSelectorBadge",{enumerable:true,get:function get(){return _job_selector_badge.JobSelectorBadge}});var _job_selector_badge=__webpack_require__(911)},,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FullTimeRangeSelector",{enumerable:true,get:function get(){return _full_time_range_selector.FullTimeRangeSelector}});Object.defineProperty(exports,"getTimeFilterRange",{enumerable:true,get:function get(){return _full_time_range_selector_service.getTimeFilterRange}});Object.defineProperty(exports,"TimeRange",{enumerable:true,get:function get(){return _full_time_range_selector_service.TimeRange}});var _full_time_range_selector=__webpack_require__(1272);var _full_time_range_selector_service=__webpack_require__(465)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AnomalyChart",{enumerable:true,get:function get(){return _anomaly_chart.AnomalyChart}});Object.defineProperty(exports,"CHART_TYPE",{enumerable:true,get:function get(){return _anomaly_chart.CHART_TYPE}});var _anomaly_chart=__webpack_require__(1293)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Page=exports.SAVE_STATE=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _lodash=__webpack_require__(49);var _kibana=__webpack_require__(57);var _ml_api_service=__webpack_require__(51);var _ml=__webpack_require__(77);var _job_service=__webpack_require__(58);var _create_result_callout=__webpack_require__(1434);var _kibana_objects=__webpack_require__(1435);var _module_jobs=__webpack_require__(495);var _resolvers=__webpack_require__(496);var _job_settings_form=__webpack_require__(1438);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var SAVE_STATE;exports.SAVE_STATE=SAVE_STATE;(function(SAVE_STATE){SAVE_STATE[SAVE_STATE["NOT_SAVED"]=0]="NOT_SAVED";SAVE_STATE[SAVE_STATE["SAVING"]=1]="SAVING";SAVE_STATE[SAVE_STATE["SAVED"]=2]="SAVED";SAVE_STATE[SAVE_STATE["FAILED"]=3]="FAILED";SAVE_STATE[SAVE_STATE["PARTIAL_FAILURE"]=4]="PARTIAL_FAILURE"})(SAVE_STATE||(exports.SAVE_STATE=SAVE_STATE={}));var Page=function Page(_ref){var moduleId=_ref.moduleId,existingGroupIds=_ref.existingGroupIds;var _useMlKibana=(0,_kibana.useMlKibana)(),notifications=_useMlKibana.services.notifications;var _useState=(0,_react.useState)(""),_useState2=_slicedToArray(_useState,2),jobPrefix=_useState2[0],setJobPrefix=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=_slicedToArray(_useState3,2),jobs=_useState4[0],setJobs=_useState4[1];var _useState5=(0,_react.useState)({}),_useState6=_slicedToArray(_useState5,2),jobOverrides=_useState6[0],setJobOverrides=_useState6[1];var _useState7=(0,_react.useState)({}),_useState8=_slicedToArray(_useState7,2),kibanaObjects=_useState8[0],setKibanaObjects=_useState8[1];var _useState9=(0,_react.useState)(SAVE_STATE.NOT_SAVED),_useState10=_slicedToArray(_useState9,2),saveState=_useState10[0],setSaveState=_useState10[1];var _useState11=(0,_react.useState)(""),_useState12=_slicedToArray(_useState11,2),resultsUrl=_useState12[0],setResultsUrl=_useState12[1];var _useState13=(0,_react.useState)(existingGroupIds),_useState14=_slicedToArray(_useState13,2),existingGroups=_useState14[0],setExistingGroups=_useState14[1];var _useMlContext=(0,_ml.useMlContext)(),savedSearch=_useMlContext.currentSavedSearch,indexPattern=_useMlContext.currentIndexPattern,combinedQuery=_useMlContext.combinedQuery;var pageTitle=savedSearch!==null?_i18n.i18n.translate("xpack.ml.newJob.recognize.savedSearchPageTitle",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:savedSearch.attributes.title}}):_i18n.i18n.translate("xpack.ml.newJob.recognize.indexPatternPageTitle",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:indexPattern.title}});var displayQueryWarning=savedSearch!==null;var tempQuery=savedSearch===null?undefined:combinedQuery;var loadModule=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var response,kibanaObjectsResult,moduleGroups;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _ml_api_service.ml.getDataRecognizerModule({moduleId:moduleId});case 3:response=_context.sent;setJobs(response.jobs);_context.next=7;return(0,_resolvers.checkForSavedObjects)(response.kibana);case 7:kibanaObjectsResult=_context.sent;setKibanaObjects(kibanaObjectsResult);setSaveState(SAVE_STATE.NOT_SAVED);moduleGroups=_toConsumableArray(response.jobs.map((function(j){return j.config.groups||[]}))).flat();setExistingGroups(_toConsumableArray(new Set([].concat(_toConsumableArray(existingGroups),_toConsumableArray(moduleGroups)))));_context.next=17;break;case 14:_context.prev=14;_context.t0=_context["catch"](0);console.error(_context.t0);case 17:case"end":return _context.stop()}}}),_callee,null,[[0,14]])})));return function loadModule(){return _ref2.apply(this,arguments)}}();var getTimeRange=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(useFullIndexData,timeRange){var _ref4,start,end;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!useFullIndexData){_context2.next=9;break}_context2.next=3;return _ml_api_service.ml.getTimeFieldRange({index:indexPattern.title,timeFieldName:indexPattern.timeFieldName,query:combinedQuery});case 3:_ref4=_context2.sent;start=_ref4.start;end=_ref4.end;return _context2.abrupt("return",{start:start.epoch,end:end.epoch});case 9:return _context2.abrupt("return",Promise.resolve(timeRange));case 10:case"end":return _context2.stop()}}}),_callee2)})));return function getTimeRange(_x,_x2){return _ref3.apply(this,arguments)}}();(0,_react.useEffect)((function(){loadModule()}),[]);var save=function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(formValues){var resultJobPrefix,startDatafeedAfterSave,useDedicatedIndex,useFullIndexData,timeRange,resultTimeRange,jobOverridesPayload,response,datafeedsResponse,jobsResponse,kibanaResponse,failedJobsCount,toasts;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setSaveState(SAVE_STATE.SAVING);resultJobPrefix=formValues.jobPrefix,startDatafeedAfterSave=formValues.startDatafeedAfterSave,useDedicatedIndex=formValues.useDedicatedIndex,useFullIndexData=formValues.useFullIndexData,timeRange=formValues.timeRange;_context3.next=4;return getTimeRange(useFullIndexData,timeRange);case 4:resultTimeRange=_context3.sent;_context3.prev=5;jobOverridesPayload=Object.values(jobOverrides);jobOverridesPayload=jobOverridesPayload.length>0?jobOverridesPayload:null;_context3.next=10;return _ml_api_service.ml.setupDataRecognizerConfig(_objectSpread({moduleId:moduleId,prefix:resultJobPrefix,query:tempQuery,indexPatternName:indexPattern.title,useDedicatedIndex:useDedicatedIndex,startDatafeed:startDatafeedAfterSave},jobOverridesPayload!==null?{jobOverrides:jobOverridesPayload}:{},{},resultTimeRange,{estimateModelMemory:false}));case 10:response=_context3.sent;datafeedsResponse=response.datafeeds,jobsResponse=response.jobs,kibanaResponse=response.kibana;setJobs(jobs.map((function(job){return _objectSpread({},job,{datafeedResult:datafeedsResponse.find((function(_ref6){var id=_ref6.id;return id.endsWith(job.id)})),setupResult:jobsResponse.find((function(_ref7){var id=_ref7.id;return id===resultJobPrefix+job.id}))})})));setKibanaObjects((0,_lodash.merge)(kibanaObjects,kibanaResponse));setResultsUrl(_job_service.mlJobService.createResultsUrl(jobsResponse.filter((function(_ref8){var success=_ref8.success;return success})).map((function(_ref9){var id=_ref9.id;return id})),resultTimeRange.start,resultTimeRange.end,"explorer"));failedJobsCount=jobsResponse.reduce((function(count,_ref10){var success=_ref10.success;return success?count:count+1}),0);setSaveState(failedJobsCount===0?SAVE_STATE.SAVED:failedJobsCount===jobs.length?SAVE_STATE.FAILED:SAVE_STATE.PARTIAL_FAILURE);_context3.next=25;break;case 19:_context3.prev=19;_context3.t0=_context3["catch"](5);setSaveState(SAVE_STATE.FAILED);console.error("Error setting up module",_context3.t0);toasts=notifications.toasts;toasts.addDanger({title:_i18n.i18n.translate("xpack.ml.newJob.recognize.moduleSetupFailedWarningTitle",{defaultMessage:"Error setting up module {moduleId}",values:{moduleId:moduleId}}),text:_i18n.i18n.translate("xpack.ml.newJob.recognize.moduleSetupFailedWarningDescription",{defaultMessage:"An error occurred trying to create the {count, plural, one {job} other {jobs}} in the module.",values:{count:jobs.length}})});case 25:case"end":return _context3.stop()}}}),_callee3,null,[[5,19]])})));return function save(_x3){return _ref5.apply(this,arguments)}}();var onJobOverridesChange=function onJobOverridesChange(job){setJobOverrides(_objectSpread({},jobOverrides,_defineProperty({},job.job_id,job)));if(job.groups!==undefined){var groups=_toConsumableArray(new Set([].concat(_toConsumableArray(existingGroups),_toConsumableArray(job.groups))));setExistingGroups(groups)}};var isFormVisible=[SAVE_STATE.NOT_SAVED,SAVE_STATE.SAVING].includes(saveState);return _react.default.createElement(_eui.EuiPage,null,_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiPageHeader,null,_react.default.createElement(_eui.EuiPageHeaderSection,null,_react.default.createElement(_eui.EuiTitle,{size:"l"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.newJobFromTitle",defaultMessage:"New job from {pageTitle}",values:{pageTitle:pageTitle}}))))),displayQueryWarning&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.searchWillBeOverwrittenLabel",defaultMessage:"Search will be overwritten"}),color:"warning",iconType:"alert"},_react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.usingSavedSearchDescription",defaultMessage:"Using a saved search will mean the query used in the datafeeds will be different from the default ones we supply in the {moduleId} module.",values:{moduleId:moduleId}}))),_react.default.createElement(_eui.EuiSpacer,{size:"l"})),_react.default.createElement(_eui.EuiFlexGroup,{wrap:true,gutterSize:"m"},_react.default.createElement(_eui.EuiFlexItem,{grow:1},_react.default.createElement(_eui.EuiPanel,{grow:false},_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobSettingsTitle",defaultMessage:"Job settings"}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),isFormVisible&&_react.default.createElement(_job_settings_form.JobSettingsForm,{onSubmit:save,onChange:function onChange(formValues){setJobPrefix(formValues.jobPrefix)},saveState:saveState,jobs:jobs}),_react.default.createElement(_create_result_callout.CreateResultCallout,{saveState:saveState,resultsUrl:resultsUrl,onReset:loadModule}))),_react.default.createElement(_eui.EuiFlexItem,{grow:2},_react.default.createElement(_eui.EuiPanel,{grow:false},_react.default.createElement(_module_jobs.ModuleJobs,{jobs:jobs,jobPrefix:jobPrefix,saveState:saveState,existingGroupIds:existingGroups,jobOverrides:jobOverrides,onJobOverridesChange:onJobOverridesChange})),Object.keys(kibanaObjects).length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiPanel,{grow:false},Object.keys(kibanaObjects).map((function(objectType,i){return _react.default.createElement(_react.Fragment,{key:objectType},_react.default.createElement(_kibana_objects.KibanaObjects,{objectType:objectType,kibanaObjects:kibanaObjects[objectType],isSaving:saveState===SAVE_STATE.SAVING}),i<Object.keys(kibanaObjects).length-1&&_react.default.createElement(_eui.EuiSpacer,{size:"s"}))})))))),_react.default.createElement(_eui.EuiSpacer,{size:"l"})))};exports.Page=Page},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.kbnTypeToMLJobType=kbnTypeToMLJobType;exports.getMLJobTypeAriaLabel=exports.mlJobTypeAriaLabels=void 0;var _i18n=__webpack_require__(1);var _field_types=__webpack_require__(109);var _public=__webpack_require__(63);function kbnTypeToMLJobType(field){var type;switch(field.type){case _public.KBN_FIELD_TYPES.STRING:type=field.aggregatable?_field_types.ML_JOB_FIELD_TYPES.KEYWORD:_field_types.ML_JOB_FIELD_TYPES.TEXT;break;case _public.KBN_FIELD_TYPES.NUMBER:type=_field_types.ML_JOB_FIELD_TYPES.NUMBER;break;case _public.KBN_FIELD_TYPES.DATE:type=_field_types.ML_JOB_FIELD_TYPES.DATE;break;case _public.KBN_FIELD_TYPES.IP:type=_field_types.ML_JOB_FIELD_TYPES.IP;break;case _public.KBN_FIELD_TYPES.BOOLEAN:type=_field_types.ML_JOB_FIELD_TYPES.BOOLEAN;break;case _public.KBN_FIELD_TYPES.GEO_POINT:type=_field_types.ML_JOB_FIELD_TYPES.GEO_POINT;break;default:break}return type}var mlJobTypeAriaLabels={BOOLEAN:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.booleanTypeAriaLabel",{defaultMessage:"boolean type"}),DATE:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.dateTypeAriaLabel",{defaultMessage:"date type"}),GEO_POINT:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.geoPointTypeAriaLabel",{defaultMessage:"{geoPointParam} type",values:{geoPointParam:"geo point"}}),IP:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.ipTypeAriaLabel",{defaultMessage:"ip type"}),KEYWORD:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.keywordTypeAriaLabel",{defaultMessage:"keyword type"}),NUMBER:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.numberTypeAriaLabel",{defaultMessage:"number type"}),TEXT:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.textTypeAriaLabel",{defaultMessage:"text type"}),UNKNOWN:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.unknownTypeAriaLabel",{defaultMessage:"unknown type"})};exports.mlJobTypeAriaLabels=mlJobTypeAriaLabels;var getMLJobTypeAriaLabel=function getMLJobTypeAriaLabel(type){var requestedFieldType=Object.keys(_field_types.ML_JOB_FIELD_TYPES).find((function(k){return _field_types.ML_JOB_FIELD_TYPES[k]===type}));if(requestedFieldType===undefined){return null}return mlJobTypeAriaLabels[requestedFieldType]};exports.getMLJobTypeAriaLabel=getMLJobTypeAriaLabel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.kibanaFieldFormat=kibanaFieldFormat;function kibanaFieldFormat(value,fieldFormat){if(fieldFormat!==undefined&&fieldFormat!==null){return fieldFormat.convert(value,"text")}else{return value}}},,,function(module,exports,__webpack_require__){"use strict";function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.EntityControl=exports.EMPTY_FIELD_VALUE_LABEL=void 0;var _lodash=__webpack_require__(49);var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var EMPTY_FIELD_VALUE_LABEL=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.emptyPartitionFieldLabel.",{defaultMessage:'"" (empty string)'});exports.EMPTY_FIELD_VALUE_LABEL=EMPTY_FIELD_VALUE_LABEL;var EntityControl=function(_Component){_inherits(EntityControl,_Component);function EntityControl(){var _getPrototypeOf2;var _this;_classCallCheck(this,EntityControl);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(EntityControl)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"inputRef",void 0);_defineProperty(_assertThisInitialized(_this),"state",{selectedOptions:undefined,options:undefined,isLoading:false});_defineProperty(_assertThisInitialized(_this),"onChange",(function(selectedOptions){var options=selectedOptions.length>0?selectedOptions:undefined;_this.setState({selectedOptions:options});var fieldValue=Array.isArray(options)&&options[0].value!==null?options[0].value:null;_this.props.entityFieldValueChanged(_this.props.entity,fieldValue)}));_defineProperty(_assertThisInitialized(_this),"onSearchChange",(function(searchValue){_this.setState({isLoading:true,options:[]});_this.props.onSearchChange(_this.props.entity,searchValue)}));_defineProperty(_assertThisInitialized(_this),"renderOption",(function(option){var label=option.label;return label===EMPTY_FIELD_VALUE_LABEL?_react.default.createElement("i",null,label):label}));return _this}_createClass(EntityControl,[{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var _this$props=this.props,entity=_this$props.entity,forceSelection=_this$props.forceSelection,isLoading=_this$props.isLoading,propOptions=_this$props.options;var _this$state=this.state,stateOptions=_this$state.options,selectedOptions=_this$state.selectedOptions;var fieldValue=entity.fieldValue;var selectedOptionsUpdate=selectedOptions;if(selectedOptions===undefined&&fieldValue!==null||Array.isArray(selectedOptions)&&selectedOptions[0].value!==fieldValue&&fieldValue!==null){selectedOptionsUpdate=[{label:fieldValue===""?EMPTY_FIELD_VALUE_LABEL:fieldValue,value:fieldValue}]}else if(Array.isArray(selectedOptions)&&fieldValue===null){selectedOptionsUpdate=undefined}if(prevProps.isLoading===true&&isLoading===false){this.setState({isLoading:false,selectedOptions:selectedOptionsUpdate})}if(!(0,_lodash.isEqual)(propOptions,stateOptions)){this.setState({options:propOptions})}if(forceSelection&&this.inputRef){this.inputRef.focus()}}},{key:"render",value:function render(){var _this2=this;var _this$props2=this.props,entity=_this$props2.entity,forceSelection=_this$props2.forceSelection;var _this$state2=this.state,isLoading=_this$state2.isLoading,options=_this$state2.options,selectedOptions=_this$state2.selectedOptions;var control=_react.default.createElement(_eui.EuiComboBox,{async:true,isLoading:isLoading,inputRef:function inputRef(input){if(input){_this2.inputRef=input}},style:{minWidth:"300px"},placeholder:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.enterValuePlaceholder",{defaultMessage:"Enter value"}),singleSelection:{asPlainText:true},options:options,selectedOptions:selectedOptions,onChange:this.onChange,onSearchChange:this.onSearchChange,isClearable:false,renderOption:this.renderOption});var selectMessage=_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.selectFieldMessage",defaultMessage:"Select {fieldName}",values:{fieldName:entity.fieldName}});return _react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{label:entity.fieldName,helpText:forceSelection?selectMessage:null},_react.default.createElement(_eui.EuiToolTip,{position:"right",content:forceSelection?selectMessage:null},control)))}}]);return EntityControl}(_react.Component);exports.EntityControl=EntityControl},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LoadingIndicator=LoadingIndicator;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function LoadingIndicator(_ref){var height=_ref.height,label=_ref.label;height=height?+height:100;return _react.default.createElement("div",{className:"ml-loading-indicator",style:{height:"".concat(height,"px")},"data-test-subj":"mlLoadingIndicator"},_react.default.createElement(_eui.EuiLoadingChart,{size:"xl",mono:true}),label&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("div",{"ml-loading-indicator-label":"true"},label)))}LoadingIndicator.propTypes={height:_propTypes.default.number,label:_propTypes.default.string}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TIME_FIELD_NAME=exports.MAX_SCHEDULED_EVENTS=exports.CHARTS_POINT_TARGET=exports.APP_STATE_ACTION=void 0;var APP_STATE_ACTION={CLEAR:"CLEAR",SET_DETECTOR_INDEX:"SET_DETECTOR_INDEX",SET_ENTITIES:"SET_ENTITIES",SET_FORECAST_ID:"SET_FORECAST_ID",SET_ZOOM:"SET_ZOOM",UNSET_ZOOM:"UNSET_ZOOM"};exports.APP_STATE_ACTION=APP_STATE_ACTION;var CHARTS_POINT_TARGET=500;exports.CHARTS_POINT_TARGET=CHARTS_POINT_TARGET;var MAX_SCHEDULED_EVENTS=10;exports.MAX_SCHEDULED_EVENTS=MAX_SCHEDULED_EVENTS;var TIME_FIELD_NAME="timestamp";exports.TIME_FIELD_NAME=TIME_FIELD_NAME},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CreateJobLinkCard",{enumerable:true,get:function get(){return _create_job_link_card.CreateJobLinkCard}});var _create_job_link_card=__webpack_require__(1261)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"LoadingWrapper",{enumerable:true,get:function get(){return _loading_wrapper.LoadingWrapper}});var _loading_wrapper=__webpack_require__(1285)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobGroupsInput",{enumerable:true,get:function get(){return _job_groups_input.JobGroupsInput}});Object.defineProperty(exports,"TimeRangePicker",{enumerable:true,get:function get(){return _time_range_picker.TimeRangePicker}});Object.defineProperty(exports,"TimeRange",{enumerable:true,get:function get(){return _time_range_picker.TimeRange}});var _job_groups_input=__webpack_require__(1286);var _time_range_picker=__webpack_require__(1287)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AggSelect",{enumerable:true,get:function get(){return _agg_select.AggSelect}});Object.defineProperty(exports,"DropDownLabel",{enumerable:true,get:function get(){return _agg_select.DropDownLabel}});Object.defineProperty(exports,"DropDownOption",{enumerable:true,get:function get(){return _agg_select.DropDownOption}});Object.defineProperty(exports,"DropDownProps",{enumerable:true,get:function get(){return _agg_select.DropDownProps}});Object.defineProperty(exports,"createLabel",{enumerable:true,get:function get(){return _agg_select.createLabel}});var _agg_select=__webpack_require__(1292)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ByFieldSelector",{enumerable:true,get:function get(){return _by_field.ByFieldSelector}});Object.defineProperty(exports,"SplitFieldSelector",{enumerable:true,get:function get(){return _split_field.SplitFieldSelector}});var _by_field=__webpack_require__(1315);var _split_field=__webpack_require__(1316)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Influencers",{enumerable:true,get:function get(){return _influencers.Influencers}});var _influencers=__webpack_require__(1318)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JsonEditorFlyout",{enumerable:true,get:function get(){return _json_editor_flyout.JsonEditorFlyout}});Object.defineProperty(exports,"EDITOR_MODE",{enumerable:true,get:function get(){return _json_editor_flyout.EDITOR_MODE}});var _json_editor_flyout=__webpack_require__(1357)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DatafeedPreviewFlyout",{enumerable:true,get:function get(){return _datafeed_preview_flyout.DatafeedPreviewFlyout}});var _datafeed_preview_flyout=__webpack_require__(1358)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GLOBAL_CALENDAR=void 0;var GLOBAL_CALENDAR="_all";exports.GLOBAL_CALENDAR=GLOBAL_CALENDAR},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Italic=exports.DatafeedSectionTitle=exports.JobSectionTitle=exports.defaultLabel=exports.falseLabel=exports.trueLabel=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var trueLabel=_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.trueLabel",{defaultMessage:"True"});exports.trueLabel=trueLabel;var falseLabel=_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.falseLabel",{defaultMessage:"False"});exports.falseLabel=falseLabel;var defaultLabel=_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.defaultString",{defaultMessage:"default"});exports.defaultLabel=defaultLabel;var JobSectionTitle=function JobSectionTitle(){return _react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobConfig.title",defaultMessage:"Job configuration"})))};exports.JobSectionTitle=JobSectionTitle;var DatafeedSectionTitle=function DatafeedSectionTitle(){return _react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.datafeedConfig.title",defaultMessage:"Datafeed configuration"})))};exports.DatafeedSectionTitle=DatafeedSectionTitle;var Italic=function Italic(_ref){var children=_ref.children;return _react.default.createElement("span",{style:{fontStyle:"italic"}},children)};exports.Italic=Italic},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ExamplesList",{enumerable:true,get:function get(){return _examples_list.ExamplesList}});var _examples_list=__webpack_require__(1462)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"TopValues",{enumerable:true,get:function get(){return _top_values.TopValues}});var _top_values=__webpack_require__(1464)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getCalendarSettingsData=getCalendarSettingsData;exports.validateCalendarId=validateCalendarId;exports.generateTempId=generateTempId;var _ml_api_service=__webpack_require__(51);var _job_utils=__webpack_require__(59);var _i18n=__webpack_require__(1);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function getJobIds(){return new Promise((function(resolve,reject){_ml_api_service.ml.jobs.jobsSummary().then((function(resp){resolve(resp.map((function(job){return job.id})))})).catch((function(err){var errorMessage=_i18n.i18n.translate("xpack.ml.calendarsEdit.errorWithFetchingJobSummariesErrorMessage",{defaultMessage:"Error fetching job summaries: {err}",values:{err:err}});console.log(errorMessage);reject(errorMessage)}))}))}function getGroupIds(){return new Promise((function(resolve,reject){_ml_api_service.ml.jobs.groups().then((function(resp){resolve(resp.map((function(group){return group.id})))})).catch((function(err){var errorMessage=_i18n.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingGroupsErrorMessage",{defaultMessage:"Error loading groups: {err}",values:{err:err}});console.log(errorMessage);reject(errorMessage)}))}))}function getCalendars(){return new Promise((function(resolve,reject){_ml_api_service.ml.calendars().then((function(resp){resolve(resp)})).catch((function(err){var errorMessage=_i18n.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingCalendarsErrorMessage",{defaultMessage:"Error loading calendars: {err}",values:{err:err}});console.log(errorMessage);reject(errorMessage)}))}))}function getCalendarSettingsData(){return new Promise(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(resolve,reject){var _ref2,_ref3,jobIds,groupIds,calendars;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all([getJobIds(),getGroupIds(),getCalendars()]);case 3:_ref2=_context.sent;_ref3=_slicedToArray(_ref2,3);jobIds=_ref3[0];groupIds=_ref3[1];calendars=_ref3[2];resolve({jobIds:jobIds,groupIds:groupIds,calendars:calendars});_context.next=15;break;case 11:_context.prev=11;_context.t0=_context["catch"](0);console.log(_context.t0);reject(_context.t0);case 15:case"end":return _context.stop()}}}),_callee,null,[[0,11]])})));return function(_x,_x2){return _ref.apply(this,arguments)}}())}function validateCalendarId(calendarId){var valid=true;if(calendarId===""||calendarId===undefined){valid=false}else if((0,_job_utils.isJobIdValid)(calendarId)===false){valid=false}return valid}function generateTempId(){return Math.random().toString(36).substr(2,9)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EventsTable",{enumerable:true,get:function get(){return _events_table.EventsTable}});Object.defineProperty(exports,"TIME_FORMAT",{enumerable:true,get:function get(){return _events_table.TIME_FORMAT}});var _events_table=__webpack_require__(1544)},,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"LoadingPanel",{enumerable:true,get:function get(){return _loading_panel.LoadingPanel}});var _loading_panel=__webpack_require__(1637)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EntityCell",{enumerable:true,get:function get(){return _entity_cell.EntityCell}});var _entity_cell=__webpack_require__(1650)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getChartContainerWidth=getChartContainerWidth;exports.getSwimlaneContainerWidth=getSwimlaneContainerWidth;function getChartContainerWidth(){var chartContainer=document.querySelector(".explorer-charts");return Math.floor(chartContainer&&chartContainer.clientWidth||0)}function getSwimlaneContainerWidth(){var explorerContainer=document.querySelector(".ml-explorer");return explorerContainer&&explorerContainer.clientWidth||0}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MAX_CHARS=exports.ANOMALIES_TABLE_TABS=exports.INFLUENCERS_LIMIT=void 0;var INFLUENCERS_LIMIT=5;exports.INFLUENCERS_LIMIT=INFLUENCERS_LIMIT;var ANOMALIES_TABLE_TABS={DETAILS:0,CATEGORY_EXAMPLES:1};exports.ANOMALIES_TABLE_TABS=ANOMALIES_TABLE_TABS;var MAX_CHARS=500;exports.MAX_CHARS=MAX_CHARS},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PROGRESS_STATES=void 0;var PROGRESS_STATES={UNSET:-1,WAITING:0,DONE:1,ERROR:-10};exports.PROGRESS_STATES=PROGRESS_STATES},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SelectInterval=exports.useTableInterval=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _url_state=__webpack_require__(88);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var OPTIONS=[{value:"auto",text:_i18n.i18n.translate("xpack.ml.controls.selectInterval.autoLabel",{defaultMessage:"Auto"})},{value:"hour",text:_i18n.i18n.translate("xpack.ml.controls.selectInterval.hourLabel",{defaultMessage:"1 hour"})},{value:"day",text:_i18n.i18n.translate("xpack.ml.controls.selectInterval.dayLabel",{defaultMessage:"1 day"})},{value:"second",text:_i18n.i18n.translate("xpack.ml.controls.selectInterval.showAllLabel",{defaultMessage:"Show all"})}];function optionValueToInterval(value){var option=OPTIONS.find((function(opt){return opt.value===value}));var interval={display:OPTIONS[0].text,val:OPTIONS[0].value};if(option!==undefined){interval={display:option.text,val:option.value}}return interval}var TABLE_INTERVAL_DEFAULT=optionValueToInterval("auto");var TABLE_INTERVAL_APP_STATE_NAME="mlSelectInterval";var useTableInterval=function useTableInterval(){var _useUrlState=(0,_url_state.useUrlState)("_a"),_useUrlState2=_slicedToArray(_useUrlState,2),appState=_useUrlState2[0],setAppState=_useUrlState2[1];return[appState&&appState[TABLE_INTERVAL_APP_STATE_NAME]||TABLE_INTERVAL_DEFAULT,function(d){return setAppState(TABLE_INTERVAL_APP_STATE_NAME,d)}]};exports.useTableInterval=useTableInterval;var SelectInterval=function SelectInterval(){var _useTableInterval=useTableInterval(),_useTableInterval2=_slicedToArray(_useTableInterval,2),interval=_useTableInterval2[0],setInterval=_useTableInterval2[1];var onChange=function onChange(e){setInterval(optionValueToInterval(e.target.value))};return _react.default.createElement(_eui.EuiSelect,{options:OPTIONS,className:"ml-select-interval",value:interval.val,onChange:onChange})};exports.SelectInterval=SelectInterval},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SelectSeverity=exports.useTableSeverity=exports.SEVERITY_OPTIONS=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _anomaly_utils=__webpack_require__(75);var _url_state=__webpack_require__(88);var _optionsMap;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var warningLabel=_i18n.i18n.translate("xpack.ml.controls.selectSeverity.warningLabel",{defaultMessage:"warning"});var minorLabel=_i18n.i18n.translate("xpack.ml.controls.selectSeverity.minorLabel",{defaultMessage:"minor"});var majorLabel=_i18n.i18n.translate("xpack.ml.controls.selectSeverity.majorLabel",{defaultMessage:"major"});var criticalLabel=_i18n.i18n.translate("xpack.ml.controls.selectSeverity.criticalLabel",{defaultMessage:"critical"});var optionsMap=(_optionsMap={},_defineProperty(_optionsMap,warningLabel,0),_defineProperty(_optionsMap,minorLabel,25),_defineProperty(_optionsMap,majorLabel,50),_defineProperty(_optionsMap,criticalLabel,75),_optionsMap);var SEVERITY_OPTIONS=[{val:0,display:warningLabel,color:(0,_anomaly_utils.getSeverityColor)(0)},{val:25,display:minorLabel,color:(0,_anomaly_utils.getSeverityColor)(25)},{val:50,display:majorLabel,color:(0,_anomaly_utils.getSeverityColor)(50)},{val:75,display:criticalLabel,color:(0,_anomaly_utils.getSeverityColor)(75)}];exports.SEVERITY_OPTIONS=SEVERITY_OPTIONS;function optionValueToThreshold(value){var threshold=SEVERITY_OPTIONS.find((function(opt){return opt.val===value}));if(threshold===undefined){threshold=SEVERITY_OPTIONS[0]}return threshold}var TABLE_SEVERITY_DEFAULT=SEVERITY_OPTIONS[0];var TABLE_SEVERITY_APP_STATE_NAME="mlSelectSeverity";var useTableSeverity=function useTableSeverity(){var _useUrlState=(0,_url_state.useUrlState)("_a"),_useUrlState2=_slicedToArray(_useUrlState,2),appState=_useUrlState2[0],setAppState=_useUrlState2[1];return[appState&&appState[TABLE_SEVERITY_APP_STATE_NAME]||TABLE_SEVERITY_DEFAULT,function(d){return setAppState(TABLE_SEVERITY_APP_STATE_NAME,d)}]};exports.useTableSeverity=useTableSeverity;var getSeverityOptions=function getSeverityOptions(){return SEVERITY_OPTIONS.map((function(_ref){var color=_ref.color,display=_ref.display,val=_ref.val;return{value:display,inputDisplay:_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHealth,{color:color,style:{lineHeight:"inherit"}},display)),dropdownDisplay:_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHealth,{color:color,style:{lineHeight:"inherit"}},display),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement("p",{className:"euiTextColor--subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.controls.selectSeverity.scoreDetailsDescription",defaultMessage:"score {value} and above",values:{value:val}}))))}}))};var SelectSeverity=function SelectSeverity(){var _ref2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{classNames:""},classNames=_ref2.classNames;var _useTableSeverity=useTableSeverity(),_useTableSeverity2=_slicedToArray(_useTableSeverity,2),severity=_useTableSeverity2[0],setSeverity=_useTableSeverity2[1];var onChange=function onChange(valueDisplay){setSeverity(optionValueToThreshold(optionsMap[valueDisplay]))};return _react.default.createElement(_eui.EuiSuperSelect,{className:classNames,hasDividers:true,options:getSeverityOptions(),valueOfSelected:severity.display,onChange:onChange})};exports.SelectSeverity=SelectSeverity},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _exportNames={getFocusData:true,validateJobSelection:true};Object.defineProperty(exports,"getFocusData",{enumerable:true,get:function get(){return _get_focus_data.getFocusData}});Object.defineProperty(exports,"validateJobSelection",{enumerable:true,get:function get(){return _validate_job_selection.validateJobSelection}});var _get_focus_data=__webpack_require__(1683);var _timeseriesexplorer_utils=__webpack_require__(275);Object.keys(_timeseriesexplorer_utils).forEach((function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _timeseriesexplorer_utils[key]}})}));var _validate_job_selection=__webpack_require__(1684)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createTimeSeriesJobData=createTimeSeriesJobData;exports.processMetricPlotResults=processMetricPlotResults;exports.processForecastResults=processForecastResults;exports.processRecordScoreResults=processRecordScoreResults;exports.processDataForFocusAnomalies=processDataForFocusAnomalies;exports.processScheduledEventsForChart=processScheduledEventsForChart;exports.findNearestChartPointToTime=findNearestChartPointToTime;exports.findChartPointForAnomalyTime=findChartPointForAnomalyTime;exports.calculateAggregationInterval=calculateAggregationInterval;exports.calculateDefaultFocusRange=calculateDefaultFocusRange;exports.calculateInitialFocusRange=calculateInitialFocusRange;exports.getAutoZoomDuration=getAutoZoomDuration;var _lodash=_interopRequireDefault(__webpack_require__(49));var _momentTimezone=_interopRequireDefault(__webpack_require__(36));var _job_utils=__webpack_require__(59);var _parse_interval=__webpack_require__(74);var _time_buckets=__webpack_require__(106);var _timeseriesexplorer_constants=__webpack_require__(210);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function createTimeSeriesJobData(jobs){var singleTimeSeriesJobs=jobs.filter(_job_utils.isTimeSeriesViewJob);return singleTimeSeriesJobs.map((function(job){var bucketSpan=(0,_parse_interval.parseInterval)(job.analysis_config.bucket_span);return{id:job.job_id,selected:false,bucketSpanSeconds:bucketSpan.asSeconds()}}))}function processMetricPlotResults(metricPlotData,modelPlotEnabled){var metricPlotChartData=[];if(modelPlotEnabled===true){_lodash.default.each(metricPlotData,(function(dataForTime,time){metricPlotChartData.push({date:new Date(+time),lower:dataForTime.modelLower,value:dataForTime.actual,upper:dataForTime.modelUpper})}))}else{_lodash.default.each(metricPlotData,(function(dataForTime,time){metricPlotChartData.push({date:new Date(+time),value:dataForTime.actual})}))}return metricPlotChartData}function processForecastResults(forecastData){var forecastPlotChartData=[];_lodash.default.each(forecastData,(function(dataForTime,time){forecastPlotChartData.push({date:new Date(+time),isForecast:true,lower:dataForTime.forecastLower,value:dataForTime.prediction,upper:dataForTime.forecastUpper})}));return forecastPlotChartData}function processRecordScoreResults(scoreData){var bucketScoreData=[];_lodash.default.each(scoreData,(function(dataForTime,time){bucketScoreData.push({date:new Date(+time),score:dataForTime.score})}));return bucketScoreData}function processDataForFocusAnomalies(chartData,anomalyRecords,aggregationInterval,modelPlotEnabled){var timesToAddPointsFor=[];var intervalMs=aggregationInterval.asMilliseconds();var lastChartDataPointTime=undefined;if(chartData!==undefined&&chartData.length>0){lastChartDataPointTime=chartData[chartData.length-1].date.getTime()}anomalyRecords.forEach((function(record){var recordTime=record[_timeseriesexplorer_constants.TIME_FIELD_NAME];var chartPoint=findChartPointForAnomalyTime(chartData,recordTime,aggregationInterval);if(chartPoint===undefined){var timeToAdd=Math.floor(recordTime/intervalMs)*intervalMs;if(timesToAddPointsFor.indexOf(timeToAdd)===-1&&timeToAdd!==lastChartDataPointTime){timesToAddPointsFor.push(timeToAdd)}}}));timesToAddPointsFor.sort((function(a,b){return a-b}));timesToAddPointsFor.forEach((function(time){var pointToAdd={date:new Date(time),value:null};if(modelPlotEnabled===true){pointToAdd.upper=null;pointToAdd.lower=null}chartData.push(pointToAdd)}));anomalyRecords.forEach((function(record){var recordTime=record[_timeseriesexplorer_constants.TIME_FIELD_NAME];var chartPoint=findChartPointForAnomalyTime(chartData,recordTime,aggregationInterval);if(chartPoint!==undefined){var recordScore=record.record_score;var pointScore=chartPoint.anomalyScore;if(pointScore===undefined||pointScore<recordScore){chartPoint.anomalyScore=recordScore;chartPoint.function=record.function;if(_lodash.default.has(record,"actual")){chartPoint.actual=record.actual;chartPoint.typical=record.typical}else{var causes=_lodash.default.get(record,"causes",[]);if(causes.length>0){chartPoint.byFieldName=record.by_field_name;chartPoint.numberOfCauses=causes.length;if(causes.length===1){var cause=_lodash.default.first(record.causes);chartPoint.actual=cause.actual;chartPoint.typical=cause.typical}}}if(_lodash.default.has(record,"multi_bucket_impact")){chartPoint.multiBucketImpact=record.multi_bucket_impact}}}}));return chartData}function processScheduledEventsForChart(chartData,scheduledEvents){if(scheduledEvents!==undefined){_lodash.default.each(scheduledEvents,(function(events,time){var chartPoint=findNearestChartPointToTime(chartData,time);if(chartPoint!==undefined){chartPoint.scheduledEvents=events}}))}return chartData}function findNearestChartPointToTime(chartData,time){var chartPoint;if(chartData===undefined){return chartPoint}for(var i=0;i<chartData.length;i++){if(chartData[i].date.getTime()===time){chartPoint=chartData[i];break}}if(chartPoint===undefined){var foundItem;for(var _i=0;_i<chartData.length;_i++){var itemTime=chartData[_i].date.getTime();if(itemTime>time){var item=chartData[_i];var previousItem=chartData[_i-1];var diff1=Math.abs(time-previousItem.date.getTime());var diff2=Math.abs(time-itemTime);if(previousItem===undefined||diff1>diff2){foundItem=item}else{foundItem=previousItem}break}}chartPoint=foundItem}return chartPoint}function findChartPointForAnomalyTime(chartData,anomalyTime,aggregationInterval){var chartPoint;if(chartData===undefined){return chartPoint}for(var i=0;i<chartData.length;i++){if(chartData[i].date.getTime()===anomalyTime){chartPoint=chartData[i];break}}if(chartPoint===undefined){var foundItem;var intervalMs=aggregationInterval.asMilliseconds();for(var _i2=0;_i2<chartData.length;_i2++){var itemTime=chartData[_i2].date.getTime();if(anomalyTime-itemTime<intervalMs){foundItem=chartData[_i2];break}}chartPoint=foundItem}return chartPoint}function calculateAggregationInterval(bounds,bucketsTarget,jobs,selectedJob){var barTarget=bucketsTarget!==undefined?bucketsTarget:100;var maxBars=Math.floor(1.1*barTarget);var buckets=new _time_buckets.TimeBuckets;buckets.setInterval("auto");buckets.setBounds(bounds);buckets.setBarTarget(Math.floor(barTarget));buckets.setMaxBars(maxBars);var bucketSpanSeconds=_lodash.default.find(jobs,{id:selectedJob.job_id}).bucketSpanSeconds;var aggInterval=buckets.getIntervalToNearestMultiple(bucketSpanSeconds);var secs=aggInterval.asSeconds();if(secs<bucketSpanSeconds){buckets.setInterval(bucketSpanSeconds+"s");aggInterval=buckets.getInterval()}return aggInterval}function calculateDefaultFocusRange(autoZoomDuration,contextAggregationInterval,contextChartData,contextForecastData){var isForecastData=contextForecastData!==undefined&&contextForecastData.length>0;var combinedData=isForecastData===false?contextChartData:contextChartData.concat(contextForecastData);var earliestDataDate=_lodash.default.first(combinedData).date;var latestDataDate=_lodash.default.last(combinedData).date;var rangeEarliestMs;var rangeLatestMs;if(isForecastData===true){var earliestForecastDataDate=_lodash.default.first(contextForecastData).date;var latestForecastDataDate=_lodash.default.last(contextForecastData).date;rangeLatestMs=Math.min(earliestForecastDataDate.getTime()+autoZoomDuration/2,latestForecastDataDate.getTime());rangeEarliestMs=Math.max(rangeLatestMs-autoZoomDuration,earliestDataDate.getTime())}else{rangeLatestMs=latestDataDate.getTime()+contextAggregationInterval.asMilliseconds();rangeEarliestMs=Math.max(earliestDataDate.getTime(),rangeLatestMs-autoZoomDuration)}return[new Date(rangeEarliestMs),new Date(rangeLatestMs)]}function calculateInitialFocusRange(zoomState,contextAggregationInterval,bounds){if(zoomState!==undefined){var zoomFrom=(0,_momentTimezone.default)(zoomState.from,"YYYY-MM-DDTHH:mm:ss.SSSZ",true);var zoomTo=(0,_momentTimezone.default)(zoomState.to,"YYYY-MM-DDTHH:mm:ss.SSSZ",true);var searchBounds=(0,_time_buckets.getBoundsRoundedToInterval)(bounds,contextAggregationInterval,true);var earliest=searchBounds.min;var latest=searchBounds.max;if(zoomFrom.isValid()&&zoomTo.isValid&&zoomTo.isAfter(zoomFrom)&&zoomFrom.isBetween(earliest,latest,null,"[]")&&zoomTo.isBetween(earliest,latest,null,"[]")){return[zoomFrom.toDate(),zoomTo.toDate()]}}return undefined}function getAutoZoomDuration(jobs,selectedJob){var bucketSpanSeconds=_lodash.default.find(jobs,{id:selectedJob.job_id}).bucketSpanSeconds;var autoZoomDuration=bucketSpanSeconds*1e3*(_timeseriesexplorer_constants.CHARTS_POINT_TARGET-1);var maxBars=Math.floor(1.1*_timeseriesexplorer_constants.CHARTS_POINT_TARGET);var buckets=new _time_buckets.TimeBuckets;buckets.setInterval("auto");buckets.setBarTarget(Math.floor(_timeseriesexplorer_constants.CHARTS_POINT_TARGET));buckets.setMaxBars(maxBars);var nowMs=(new Date).getTime();var max=(0,_momentTimezone.default)(nowMs);var min=(0,_momentTimezone.default)(nowMs-autoZoomDuration);buckets.setBounds({min:min,max:max});var calculatedInterval=buckets.getIntervalToNearestMultiple(bucketSpanSeconds);var calculatedIntervalSecs=calculatedInterval.asSeconds();if(calculatedIntervalSecs!==bucketSpanSeconds){autoZoomDuration=autoZoomDuration*(bucketSpanSeconds/calculatedIntervalSecs)}return autoZoomDuration}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getGroupsFromJobs=getGroupsFromJobs;exports.getTimeRangeFromSelection=getTimeRangeFromSelection;exports.normalizeTimes=normalizeTimes;var _i18n=__webpack_require__(1);var _moment=_interopRequireDefault(__webpack_require__(32));var _d=_interopRequireDefault(__webpack_require__(97));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function getGroupsFromJobs(jobs){var groups={};var groupsMap={};jobs.forEach((function(job){if(job.groups!==undefined){job.groups.forEach((function(g){if(groups[g]===undefined){groups[g]={id:g,jobIds:[job.job_id],timeRange:{to:job.timeRange.to,toMoment:null,from:job.timeRange.from,fromMoment:null,fromPx:job.timeRange.fromPx,toPx:job.timeRange.toPx,widthPx:null}};groupsMap[g]=[job.job_id]}else{groups[g].jobIds.push(job.job_id);groupsMap[g].push(job.job_id);if(groups[g].timeRange.to===null||job.timeRange.to>groups[g].timeRange.to){groups[g].timeRange.to=job.timeRange.to;groups[g].timeRange.toMoment=job.timeRange.toMoment}if(groups[g].timeRange.from===null||job.timeRange.from<groups[g].timeRange.from){groups[g].timeRange.from=job.timeRange.from;groups[g].timeRange.fromMoment=job.timeRange.fromMoment}if(groups[g].timeRange.toPx===null||job.timeRange.toPx>groups[g].timeRange.toPx){groups[g].timeRange.toPx=job.timeRange.toPx}if(groups[g].timeRange.fromPx===null||job.timeRange.fromPx<groups[g].timeRange.fromPx){groups[g].timeRange.fromPx=job.timeRange.fromPx}}}))}}));Object.keys(groups).forEach((function(groupId){var group=groups[groupId];group.timeRange.widthPx=group.timeRange.toPx-group.timeRange.fromPx;group.timeRange.toMoment=(0,_moment.default)(group.timeRange.to);group.timeRange.fromMoment=(0,_moment.default)(group.timeRange.from);var fromString=group.timeRange.fromMoment.format("MMM Do YYYY, HH:mm");var toString=group.timeRange.toMoment.format("MMM Do YYYY, HH:mm");group.timeRange.label=_i18n.i18n.translate("xpack.ml.jobSelectList.groupTimeRangeLabel",{defaultMessage:"{fromString} to {toString}",values:{fromString:fromString,toString:toString}})}));return{groups:Object.keys(groups).map((function(g){return groups[g]})),groupsMap:groupsMap}}function getTimeRangeFromSelection(jobs,selection){if(jobs.length>0){var times=[];jobs.forEach((function(job){if(selection.includes(job.job_id)){if(job.timeRange.from!==undefined){times.push(job.timeRange.from)}if(job.timeRange.to!==undefined){times.push(job.timeRange.to)}}}));if(times.length){var extent=_d.default.extent(times);var selectedTime={from:(0,_moment.default)(extent[0]).toISOString(),to:(0,_moment.default)(extent[1]).toISOString()};return selectedTime}}}function normalizeTimes(jobs,dateFormatTz,ganttBarWidth){var jobsWithTimeRange=jobs.filter((function(job){return job.timeRange.to!==undefined&&job.timeRange.from!==undefined}));var min=Math.min.apply(Math,_toConsumableArray(jobsWithTimeRange.map((function(job){return+job.timeRange.from}))));var max=Math.max.apply(Math,_toConsumableArray(jobsWithTimeRange.map((function(job){return+job.timeRange.to}))));var ganttScale=_d.default.scale.linear().domain([min,max]).range([1,ganttBarWidth]);jobs.forEach((function(job){if(job.timeRange.to!==undefined&&job.timeRange.from!==undefined){job.timeRange.fromPx=ganttScale(job.timeRange.from);job.timeRange.toPx=ganttScale(job.timeRange.to);job.timeRange.widthPx=job.timeRange.toPx-job.timeRange.fromPx;if(job.timeRange.widthPx<1){job.timeRange.widthPx=1}job.timeRange.toMoment=(0,_moment.default)(job.timeRange.to).tz(dateFormatTz);job.timeRange.fromMoment=(0,_moment.default)(job.timeRange.from).tz(dateFormatTz);var fromString=job.timeRange.fromMoment.format("MMM Do YYYY, HH:mm");var _toString=job.timeRange.toMoment.format("MMM Do YYYY, HH:mm");job.timeRange.label=_i18n.i18n.translate("xpack.ml.jobSelector.jobTimeRangeLabel",{defaultMessage:"{fromString} to {toString}",values:{fromString:fromString,toString:_toString}})}else{job.timeRange.widthPx=0;job.timeRange.fromPx=0;job.timeRange.toPx=0;job.timeRange.label=_i18n.i18n.translate("xpack.ml.jobSelector.noResultsForJobLabel",{defaultMessage:"No results"})}}));return jobs}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getDefaultChartsData=getDefaultChartsData;exports.anomalyDataChange=void 0;var _lodash=_interopRequireDefault(__webpack_require__(49));var _explorer_chart_config_builder=__webpack_require__(1715);var _chart_utils=__webpack_require__(135);var _anomaly_utils=__webpack_require__(75);var _job_utils=__webpack_require__(59);var _results_service=__webpack_require__(132);var _job_service=__webpack_require__(58);var _legacy_utils=__webpack_require__(269);var _explorer_dashboard_service=__webpack_require__(144);var _explorer_constants=__webpack_require__(86);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getDefaultChartsData(){return{chartsPerRow:1,seriesToPlot:[],tooManyBuckets:false,timeFieldName:"timestamp"}}var CHART_MAX_POINTS=500;var ANOMALIES_MAX_RESULTS=500;var MAX_SCHEDULED_EVENTS=10;var ML_TIME_FIELD_NAME="timestamp";var USE_OVERALL_CHART_LIMITS=false;var MAX_CHARTS_PER_ROW=4;var anomalyDataChange=function anomalyDataChange(anomalyRecords,earliestMs,latestMs){var severity=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var data=getDefaultChartsData();var filteredRecords=anomalyRecords.filter((function(record){return Number(record.record_score)>=severity}));var allSeriesRecords=processRecordsForDisplay(filteredRecords);var chartsContainerWidth=(0,_legacy_utils.getChartContainerWidth)();var chartsPerRow=Math.min(Math.max(Math.floor(chartsContainerWidth/550),1),MAX_CHARTS_PER_ROW);if(allSeriesRecords.length===1){chartsPerRow=1}data.chartsPerRow=chartsPerRow;var maxSeriesToPlot=Math.max(chartsPerRow*2,6);var recordsToPlot=allSeriesRecords.slice(0,maxSeriesToPlot);var seriesConfigs=recordsToPlot.map(_explorer_chart_config_builder.buildConfig);data.tooManyBuckets=false;var chartWidth=Math.floor(chartsContainerWidth/chartsPerRow);var _calculateChartRange=calculateChartRange(seriesConfigs,earliestMs,latestMs,chartWidth,recordsToPlot,data.timeFieldName),chartRange=_calculateChartRange.chartRange,tooManyBuckets=_calculateChartRange.tooManyBuckets;data.tooManyBuckets=tooManyBuckets;data.seriesToPlot=seriesConfigs.map((function(config){return _objectSpread({},config,{loading:true,chartData:null})}));_explorer_dashboard_service.explorerService.setCharts(_objectSpread({},data));if(seriesConfigs.length===0){return}function getMetricData(config,range){var jobId=config.jobId,detectorIndex=config.detectorIndex,entityFields=config.entityFields,interval=config.interval;var job=_job_service.mlJobService.getJob(jobId);var useSourceData=(0,_job_utils.isSourceDataChartableForDetector)(job,detectorIndex);if(useSourceData===true){var datafeedQuery=_lodash.default.get(config,"datafeedConfig.query",null);return _results_service.mlResultsService.getMetricData(config.datafeedConfig.indices,config.entityFields,datafeedQuery,config.metricFunction,config.metricFieldName,config.timeField,range.min,range.max,config.interval).toPromise()}else{var criteriaFields=[];var detector=job.analysis_config.detectors[detectorIndex];if(_lodash.default.has(detector,"partition_field_name")){var partitionEntity=_lodash.default.find(entityFields,{fieldName:detector.partition_field_name});if(partitionEntity!==undefined){criteriaFields.push({fieldName:"partition_field_name",fieldValue:partitionEntity.fieldName},{fieldName:"partition_field_value",fieldValue:partitionEntity.fieldValue})}}if(_lodash.default.has(detector,"over_field_name")){var overEntity=_lodash.default.find(entityFields,{fieldName:detector.over_field_name});if(overEntity!==undefined){criteriaFields.push({fieldName:"over_field_name",fieldValue:overEntity.fieldName},{fieldName:"over_field_value",fieldValue:overEntity.fieldValue})}}if(_lodash.default.has(detector,"by_field_name")){var byEntity=_lodash.default.find(entityFields,{fieldName:detector.by_field_name});if(byEntity!==undefined){criteriaFields.push({fieldName:"by_field_name",fieldValue:byEntity.fieldName},{fieldName:"by_field_value",fieldValue:byEntity.fieldValue})}}return new Promise((function(resolve,reject){var obj={success:true,results:{}};return _results_service.mlResultsService.getModelPlotOutput(jobId,detectorIndex,criteriaFields,range.min,range.max,interval).toPromise().then((function(resp){var results=resp.results;Object.keys(results).forEach((function(time){obj.results[time]=results[time].actual}));resolve(obj)})).catch((function(resp){reject(resp)}))}))}}function getRecordsForCriteria(config,range){var criteria=[];criteria.push({fieldName:"detector_index",fieldValue:config.detectorIndex});criteria=criteria.concat(config.entityFields);return _results_service.mlResultsService.getRecordsForCriteria([config.jobId],criteria,0,range.min,range.max,ANOMALIES_MAX_RESULTS).toPromise()}function getScheduledEvents(config,range){return _results_service.mlResultsService.getScheduledEventsByBucket([config.jobId],range.min,range.max,config.interval,1,MAX_SCHEDULED_EVENTS).toPromise()}function getEventDistribution(config,range){var chartType=(0,_chart_utils.getChartType)(config);var splitField;var filterField=null;if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){splitField=config.entityFields.find((function(f){return f.fieldType==="by"}));filterField=config.entityFields.find((function(f){return f.fieldType==="partition"}))}else if(chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){splitField=config.entityFields.find((function(f){return f.fieldType==="over"}));filterField=config.entityFields.find((function(f){return f.fieldType==="partition"}))}var datafeedQuery=_lodash.default.get(config,"datafeedConfig.query",null);return _results_service.mlResultsService.getEventDistributionData(config.datafeedConfig.indices,splitField,filterField,datafeedQuery,config.metricFunction,config.metricFieldName,config.timeField,range.min,range.max,config.interval)}var seriesPromises=seriesConfigs.map((function(seriesConfig){return Promise.all([getMetricData(seriesConfig,chartRange),getRecordsForCriteria(seriesConfig,chartRange),getScheduledEvents(seriesConfig,chartRange),getEventDistribution(seriesConfig,chartRange)])}));function processChartData(response,seriesIndex){var metricData=response[0].results;var records=response[1].records;var jobId=seriesConfigs[seriesIndex].jobId;var scheduledEvents=response[2].events[jobId];var eventDistribution=response[3];var chartType=(0,_chart_utils.getChartType)(seriesConfigs[seriesIndex]);records.sort((function(recordA,recordB){return recordA[ML_TIME_FIELD_NAME]-recordB[ML_TIME_FIELD_NAME]}));var chartData=[];if(metricData!==undefined){if(eventDistribution.length>0&&records.length>0){var filterField=records[0].by_field_value||records[0].over_field_value;chartData=eventDistribution.filter((function(d){return d.entity!==filterField}));_lodash.default.map(metricData,(function(value,time){if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION&&value>0||chartType!==_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION&&value!==null){chartData.push({date:+time,value:value,entity:filterField})}}))}else{chartData=_lodash.default.map(metricData,(function(value,time){return{date:+time,value:value}}))}}var chartDataForPointSearch=getChartDataForPointSearch(chartData,records[0],chartType);_lodash.default.each(records,(function(record){var recordTime=record[ML_TIME_FIELD_NAME];var chartPoint=findChartPointForTime(chartDataForPointSearch,recordTime);if(chartPoint===undefined){chartPoint={date:new Date(recordTime),value:null};chartData.push(chartPoint)}chartPoint.anomalyScore=record.record_score;if(record.actual!==undefined){chartPoint.actual=record.actual;chartPoint.typical=record.typical}else{var causes=_lodash.default.get(record,"causes",[]);if(causes.length>0){chartPoint.byFieldName=record.by_field_name;chartPoint.numberOfCauses=causes.length;if(causes.length===1){var cause=_lodash.default.first(record.causes);chartPoint.actual=cause.actual;chartPoint.typical=cause.typical}}}if(record.multi_bucket_impact!==undefined){chartPoint.multiBucketImpact=record.multi_bucket_impact}}));if(scheduledEvents!==undefined){_lodash.default.each(scheduledEvents,(function(events,time){var chartPoint=findChartPointForTime(chartDataForPointSearch,Number(time));if(chartPoint!==undefined){chartPoint.scheduledEvents=events}}))}return chartData}function getChartDataForPointSearch(chartData,record,chartType){if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION||chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){return chartData.filter((function(d){return d.entity===(record&&(record.by_field_value||record.over_field_value))}))}return chartData}function findChartPointForTime(chartData,time){return chartData.find((function(point){return point.date===time}))}Promise.all(seriesPromises).then((function(response){var processedData=response.map(processChartData);var allDataPoints=_lodash.default.reduce(processedData,(function(datapoints,series){_lodash.default.each(series,(function(d){return datapoints.push(d)}));return datapoints}),[]);var overallChartLimits=(0,_chart_utils.chartLimits)(allDataPoints);data.seriesToPlot=response.map((function(d,i){return _objectSpread({},seriesConfigs[i],{loading:false,chartData:processedData[i],plotEarliest:chartRange.min,plotLatest:chartRange.max,selectedEarliest:earliestMs,selectedLatest:latestMs,chartLimits:USE_OVERALL_CHART_LIMITS?overallChartLimits:(0,_chart_utils.chartLimits)(processedData[i])})}));_explorer_dashboard_service.explorerService.setCharts(_objectSpread({},data))})).catch((function(error){console.error(error)}))};exports.anomalyDataChange=anomalyDataChange;function processRecordsForDisplay(anomalyRecords){if(anomalyRecords.length===0){return[]}var aggregatedData={};_lodash.default.each(anomalyRecords,(function(record){var job=_job_service.mlJobService.getJob(record.job_id);var isChartable=(0,_job_utils.isSourceDataChartableForDetector)(job,record.detector_index);if(isChartable===false){var entityFields=(0,_anomaly_utils.getEntityFieldList)(record);isChartable=(0,_job_utils.isModelPlotEnabled)(job,record.detector_index,entityFields)}if(isChartable===false){return}var jobId=record.job_id;if(aggregatedData[jobId]===undefined){aggregatedData[jobId]={}}var detectorsForJob=aggregatedData[jobId];var detectorIndex=record.detector_index;if(detectorsForJob[detectorIndex]===undefined){detectorsForJob[detectorIndex]={}}var firstFieldName=record.partition_field_name||record.by_field_name||record.over_field_name;var firstFieldValue=record.partition_field_value||record.by_field_value||record.over_field_value;if(firstFieldName!==undefined){var groupsForDetector=detectorsForJob[detectorIndex];if(groupsForDetector[firstFieldName]===undefined){groupsForDetector[firstFieldName]={}}var valuesForGroup=groupsForDetector[firstFieldName];if(valuesForGroup[firstFieldValue]===undefined){valuesForGroup[firstFieldValue]={}}var dataForGroupValue=valuesForGroup[firstFieldValue];var isSecondSplit=false;if(record.partition_field_name!==undefined){var splitFieldName=record.over_field_name||record.by_field_name;if(splitFieldName!==undefined){isSecondSplit=true}}if(isSecondSplit===false){if(dataForGroupValue.maxScoreRecord===undefined){dataForGroupValue.maxScore=record.record_score;dataForGroupValue.maxScoreRecord=record}else{if(record.record_score>dataForGroupValue.maxScore){dataForGroupValue.maxScore=record.record_score;dataForGroupValue.maxScoreRecord=record}}}else{var secondFieldName=record.over_field_name||record.by_field_name;var secondFieldValue=record.over_field_value||record.by_field_value;if(dataForGroupValue[secondFieldName]===undefined){dataForGroupValue[secondFieldName]={}}var splitsForGroup=dataForGroupValue[secondFieldName];if(splitsForGroup[secondFieldValue]===undefined){splitsForGroup[secondFieldValue]={}}var dataForSplitValue=splitsForGroup[secondFieldValue];if(dataForSplitValue.maxScoreRecord===undefined){dataForSplitValue.maxScore=record.record_score;dataForSplitValue.maxScoreRecord=record}else{if(record.record_score>dataForSplitValue.maxScore){dataForSplitValue.maxScore=record.record_score;dataForSplitValue.maxScoreRecord=record}}}}else{var dataForDetector=detectorsForJob[detectorIndex];if(dataForDetector.maxScoreRecord===undefined){dataForDetector.maxScore=record.record_score;dataForDetector.maxScoreRecord=record}else{if(record.record_score>dataForDetector.maxScore){dataForDetector.maxScore=record.record_score;dataForDetector.maxScoreRecord=record}}}}));console.log("explorer charts aggregatedData is:",aggregatedData);var recordsForSeries=[];_lodash.default.each(aggregatedData,(function(detectorsForJob){_lodash.default.each(detectorsForJob,(function(groupsForDetector){if(groupsForDetector.maxScoreRecord!==undefined){recordsForSeries.push(groupsForDetector.maxScoreRecord)}else{_lodash.default.each(groupsForDetector,(function(valuesForGroup){_lodash.default.each(valuesForGroup,(function(dataForGroupValue){if(dataForGroupValue.maxScoreRecord!==undefined){recordsForSeries.push(dataForGroupValue.maxScoreRecord)}else{_lodash.default.each(dataForGroupValue,(function(splitsForGroup){_lodash.default.each(splitsForGroup,(function(dataForSplitValue){recordsForSeries.push(dataForSplitValue.maxScoreRecord)}))}))}}))}))}}))}));recordsForSeries=_lodash.default.sortBy(recordsForSeries,"record_score").reverse();return recordsForSeries}function calculateChartRange(seriesConfigs,earliestMs,latestMs,chartWidth,recordsToPlot,timeFieldName){var tooManyBuckets=false;var midpointMs=Math.ceil((earliestMs+latestMs)/2);var maxBucketSpanMs=Math.max.apply(null,_lodash.default.pluck(seriesConfigs,"bucketSpanSeconds"))*1e3;var pointsToPlotFullSelection=Math.ceil((latestMs-earliestMs)/maxBucketSpanMs);var optimumPointSpacing=5;var optimumNumPoints=chartWidth/optimumPointSpacing;var plotPoints=Math.max(optimumNumPoints,pointsToPlotFullSelection);var halfPoints=Math.ceil(plotPoints/2);var chartRange={min:midpointMs-halfPoints*maxBucketSpanMs,max:midpointMs+halfPoints*maxBucketSpanMs};if(plotPoints>CHART_MAX_POINTS){tooManyBuckets=true;var maxTimeSpan=maxBucketSpanMs*CHART_MAX_POINTS;var minMs=recordsToPlot[0][timeFieldName];var maxMs=recordsToPlot[0][timeFieldName];_lodash.default.each(recordsToPlot,(function(record){var diffMs=maxMs-minMs;if(diffMs<maxTimeSpan){var recordTime=record[timeFieldName];if(recordTime<minMs){if(maxMs-recordTime<=maxTimeSpan){minMs=recordTime}}if(recordTime>maxMs){if(recordTime-minMs<=maxTimeSpan){maxMs=recordTime}}}}));if(maxMs-minMs<maxTimeSpan){minMs=Math.max(earliestMs,minMs-maxTimeSpan);maxMs=Math.min(latestMs,maxMs+maxTimeSpan)}chartRange={min:minMs,max:maxMs}}return{chartRange:chartRange,tooManyBuckets:tooManyBuckets}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getGroupsFromJobs=getGroupsFromJobs;exports.getStatsBarData=getStatsBarData;exports.getJobsFromGroup=getJobsFromGroup;exports.getJobsWithTimerange=getJobsWithTimerange;var _i18n=__webpack_require__(1);var _states=__webpack_require__(108);function getGroupsFromJobs(jobs){var groups={ungrouped:{id:"ungrouped",jobIds:[],docs_processed:0,latest_timestamp:0,max_anomaly_score:null,jobs_in_group:0}};jobs.forEach((function(job){if(job.groups.length>0){job.groups.forEach((function(g){if(groups[g]===undefined){groups[g]={id:g,jobIds:[job.id],docs_processed:job.processed_record_count,latest_timestamp:job.latestTimestampMs,max_anomaly_score:null,jobs_in_group:1}}else{groups[g].jobIds.push(job.id);groups[g].docs_processed+=job.processed_record_count;groups[g].jobs_in_group++;if(groups[g].latest_timestamp===undefined){groups[g].latest_timestamp=job.latestTimestampMs}else if(job.latestTimestampMs&&job.latestTimestampMs>groups[g].latest_timestamp){groups[g].latest_timestamp=job.latestTimestampMs}}}))}else{groups.ungrouped.jobIds.push(job.id);groups.ungrouped.docs_processed+=job.processed_record_count;groups.ungrouped.jobs_in_group++;if(job.latestTimestampMs&&job.latestTimestampMs>groups.ungrouped.latest_timestamp){groups.ungrouped.latest_timestamp=job.latestTimestampMs}}}));if(groups.ungrouped.jobIds.length===0){delete groups.ungrouped}var count=Object.values(groups).length;return{groups:groups,count:count}}function getStatsBarData(jobsList){var jobStats={activeNodes:{label:_i18n.i18n.translate("xpack.ml.overviewJobsList.statsBar.activeMLNodesLabel",{defaultMessage:"Active ML nodes"}),value:0,show:true},total:{label:_i18n.i18n.translate("xpack.ml.overviewJobsList.statsBar.totalJobsLabel",{defaultMessage:"Total jobs"}),value:0,show:true},open:{label:_i18n.i18n.translate("xpack.ml.overviewJobsList.statsBar.openJobsLabel",{defaultMessage:"Open jobs"}),value:0,show:true},closed:{label:_i18n.i18n.translate("xpack.ml.overviewJobsList.statsBar.closedJobsLabel",{defaultMessage:"Closed jobs"}),value:0,show:true},failed:{label:_i18n.i18n.translate("xpack.ml.overviewJobsList.statsBar.failedJobsLabel",{defaultMessage:"Failed jobs"}),value:0,show:false},activeDatafeeds:{label:_i18n.i18n.translate("xpack.ml.jobsList.statsBar.activeDatafeedsLabel",{defaultMessage:"Active datafeeds"}),value:0,show:true}};if(jobsList===undefined){return jobStats}var mlNodes={};var failedJobs=0;jobsList.forEach((function(job){if(job.jobState===_states.JOB_STATE.OPENED){jobStats.open.value++}else if(job.jobState===_states.JOB_STATE.CLOSED){jobStats.closed.value++}else if(job.jobState===_states.JOB_STATE.FAILED){failedJobs++}if(job.hasDatafeed&&job.datafeedState===_states.DATAFEED_STATE.STARTED){jobStats.activeDatafeeds.value++}if(job.nodeName!==undefined){mlNodes[job.nodeName]={}}}));jobStats.total.value=jobsList.length;if(failedJobs){jobStats.failed.value=failedJobs;jobStats.failed.show=true}else{jobStats.failed.show=false}jobStats.activeNodes.value=Object.keys(mlNodes).length;return jobStats}function getJobsFromGroup(group,jobs){return group.jobIds.map((function(jobId){return jobs[jobId]})).filter((function(id){return id!==undefined}))}function getJobsWithTimerange(jobsList){var jobs={};jobsList.forEach((function(job){if(jobs[job.id]===undefined){if(job.earliestTimestampMs!==undefined){var earliestTimestampMs=job.earliestTimestampMs,latestResultsTimestampMs=job.latestResultsTimestampMs;jobs[job.id]={id:job.id,earliestTimestampMs:earliestTimestampMs,latestResultsTimestampMs:latestResultsTimestampMs}}}}));return jobs}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DataRecognizer",{enumerable:true,get:function get(){return _data_recognizer.DataRecognizer}});var _data_recognizer=__webpack_require__(1259)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setFullTimeRange=setFullTimeRange;exports.getTimeFilterRange=getTimeFilterRange;var _moment=_interopRequireDefault(__webpack_require__(32));var _i18n=__webpack_require__(1);var _datemath=_interopRequireDefault(__webpack_require__(95));var _dependency_cache=__webpack_require__(5);var _ml_api_service=__webpack_require__(51);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function setFullTimeRange(_x,_x2){return _setFullTimeRange.apply(this,arguments)}function _setFullTimeRange(){_setFullTimeRange=_asyncToGenerator(regeneratorRuntime.mark((function _callee(indexPattern,query){var timefilter,resp,toastNotifications;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;timefilter=(0,_dependency_cache.getTimefilter)();_context.next=4;return _ml_api_service.ml.getTimeFieldRange({index:indexPattern.title,timeFieldName:indexPattern.timeFieldName,query:query});case 4:resp=_context.sent;timefilter.setTime({from:(0,_moment.default)(resp.start.epoch).toISOString(),to:(0,_moment.default)(resp.end.epoch).toISOString()});return _context.abrupt("return",resp);case 9:_context.prev=9;_context.t0=_context["catch"](0);toastNotifications=(0,_dependency_cache.getToastNotifications)();toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.fullTimeRangeSelector.errorSettingTimeRangeNotification",{defaultMessage:"An error occurred setting the time range."}));return _context.abrupt("return",_context.t0);case 14:case"end":return _context.stop()}}}),_callee,null,[[0,9]])})));return _setFullTimeRange.apply(this,arguments)}function getTimeFilterRange(){var timefilter=(0,_dependency_cache.getTimefilter)();var fromMoment=_datemath.default.parse(timefilter.getTime().from);var toMoment=_datemath.default.parse(timefilter.getTime().to);var from=fromMoment!==undefined?fromMoment.valueOf():0;var to=toMoment!==undefined?toMoment.valueOf():0;return{to:to,from:from}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EventRateChart",{enumerable:true,get:function get(){return _event_rate_chart.EventRateChart}});var _event_rate_chart=__webpack_require__(1273)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Axes=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _charts=__webpack_require__(37);var _utils=__webpack_require__(468);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var dateFormatter=(0,_charts.timeFormatter)((0,_charts.niceTimeFormatByDay)(3));function tickFormatter(d){return(Math.round(d*100)/100).toString()}var Axes=function Axes(_ref){var chartData=_ref.chartData;var yDomain=chartData!==undefined?(0,_utils.getYRange)(chartData):undefined;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_charts.Axis,{id:"bottom",position:_charts.Position.Bottom,showOverlappingTicks:true,tickFormat:dateFormatter}),_react.default.createElement(_charts.Axis,{id:"left",position:_charts.Position.Left,tickFormat:tickFormatter,domain:yDomain}))};exports.Axes=Axes},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getYRange=getYRange;exports.getXRange=getXRange;function getYRange(chartData){if(chartData.length===0){return{min:0,max:0}}var max=Number.MIN_VALUE;var min=Number.MAX_VALUE;chartData.forEach((function(r){max=Math.max(r.value,max);min=Math.min(r.value,min)}));var padding=(max-min)*.1;max+=padding;min-=padding;return{min:min,max:max}}function getXRange(lineChartData){if(lineChartData.length===0){return{min:0,max:0}}return{min:lineChartData[0].time,max:lineChartData[lineChartData.length-1].time}}},function(module,exports,__webpack_require__){"use strict";function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.SingleMetricJobCreator=void 0;var _parse_interval=__webpack_require__(74);var _job_creator=__webpack_require__(141);var _default_configs=__webpack_require__(131);var _aggregation_types=__webpack_require__(121);var _new_job=__webpack_require__(60);var _general=__webpack_require__(85);function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var SingleMetricJobCreator=function(_JobCreator){_inherits(SingleMetricJobCreator,_JobCreator);function SingleMetricJobCreator(indexPattern,savedSearch,query){var _this;_classCallCheck(this,SingleMetricJobCreator);_this=_possibleConstructorReturn(this,_getPrototypeOf(SingleMetricJobCreator).call(this,indexPattern,savedSearch,query));_defineProperty(_assertThisInitialized(_this),"_type",_new_job.JOB_TYPE.SINGLE_METRIC);_this.createdBy=_new_job.CREATED_BY_LABEL.SINGLE_METRIC;return _this}_createClass(SingleMetricJobCreator,[{key:"setDetector",value:function setDetector(agg,field){var dtr=(0,_default_configs.createBasicDetector)(agg,field);if(this._detectors.length===0){this._addDetector(dtr,agg,field)}else{this._editDetector(dtr,agg,field,0)}this._createDatafeedAggregations()}},{key:"_createDatafeedAggregations",value:function _createDatafeedAggregations(){if(this._detectors.length&&typeof this._job_config.analysis_config.bucket_span==="string"&&this._aggs.length>0){delete this._job_config.analysis_config.summary_count_field_name;delete this._datafeed_config.aggregations;var functionName=this._aggs[0].dslName;var timeField=this._job_config.data_description.time_field;var duration=(0,_parse_interval.parseInterval)(this._job_config.analysis_config.bucket_span);if(duration===null){return}var bucketSpanSeconds=duration.asSeconds();var interval=bucketSpanSeconds*1e3;var field=null;switch(functionName){case _aggregation_types.ES_AGGREGATION.COUNT:this._job_config.analysis_config.summary_count_field_name="doc_count";this._datafeed_config.aggregations={buckets:{date_histogram:{field:timeField,fixed_interval:"".concat(interval,"ms")},aggregations:_defineProperty({},timeField,{max:{field:timeField}})}};break;case _aggregation_types.ES_AGGREGATION.AVG:case _aggregation_types.ES_AGGREGATION.SUM:case _aggregation_types.ES_AGGREGATION.MIN:case _aggregation_types.ES_AGGREGATION.MAX:field=this._fields[0];if(field!==null){var _aggregations2;var fieldName=field.name;this._job_config.analysis_config.summary_count_field_name="doc_count";this._datafeed_config.aggregations={buckets:{date_histogram:{field:timeField,fixed_interval:"".concat(interval*.1,"ms")},aggregations:(_aggregations2={},_defineProperty(_aggregations2,fieldName,_defineProperty({},functionName,{field:fieldName})),_defineProperty(_aggregations2,timeField,{max:{field:timeField}}),_aggregations2)}}}break;case _aggregation_types.ES_AGGREGATION.CARDINALITY:field=this._fields[0];if(field!==null){var _aggregations3;var _fieldName2=field.name;this._job_config.analysis_config.summary_count_field_name="dc_".concat(_fieldName2);this._datafeed_config.aggregations={buckets:{date_histogram:{field:timeField,fixed_interval:"".concat(interval,"ms")},aggregations:(_aggregations3={},_defineProperty(_aggregations3,timeField,{max:{field:timeField}}),_defineProperty(_aggregations3,this._job_config.analysis_config.summary_count_field_name,_defineProperty({},functionName,{field:_fieldName2})),_aggregations3)}};var dtr=this._detectors[0];dtr.function=_aggregation_types.ML_JOB_AGGREGATION.NON_ZERO_COUNT;dtr.detector_description="".concat(functionName," (").concat(_fieldName2,")");delete dtr.field_name}break;default:break}}}},{key:"cloneFromExistingJob",value:function cloneFromExistingJob(job,datafeed){this._overrideConfigs(job,datafeed);this.createdBy=_new_job.CREATED_BY_LABEL.SINGLE_METRIC;var detectors=(0,_general.getRichDetectors)(job,datafeed,this.additionalFields,false);this.removeAllDetectors();var dtr=detectors[0];if(detectors.length&&dtr.agg!==null&&dtr.field!==null){this.setDetector(dtr.agg,dtr.field)}}},{key:"bucketSpan",set:function set(bucketSpan){this._job_config.analysis_config.bucket_span=bucketSpan;this._setBucketSpanMs(bucketSpan);this._createDatafeedAggregations()},get:function get(){return this._job_config.analysis_config.bucket_span}},{key:"aggFieldPair",get:function get(){if(this._aggs.length===0){return null}else{return{agg:this._aggs[0],field:this._fields[0]}}}}]);return SingleMetricJobCreator}(_job_creator.JobCreator);exports.SingleMetricJobCreator=SingleMetricJobCreator},function(module,exports,__webpack_require__){"use strict";function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.MultiMetricJobCreator=void 0;var _job_creator=__webpack_require__(141);var _default_configs=__webpack_require__(131);var _new_job=__webpack_require__(60);var _ml_api_service=__webpack_require__(51);var _general=__webpack_require__(85);function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var MultiMetricJobCreator=function(_JobCreator){_inherits(MultiMetricJobCreator,_JobCreator);function MultiMetricJobCreator(indexPattern,savedSearch,query){var _this;_classCallCheck(this,MultiMetricJobCreator);_this=_possibleConstructorReturn(this,_getPrototypeOf(MultiMetricJobCreator).call(this,indexPattern,savedSearch,query));_defineProperty(_assertThisInitialized(_this),"_splitField",null);_defineProperty(_assertThisInitialized(_this),"_lastEstimatedModelMemoryLimit",_new_job.DEFAULT_MODEL_MEMORY_LIMIT);_defineProperty(_assertThisInitialized(_this),"_type",_new_job.JOB_TYPE.MULTI_METRIC);_this.createdBy=_new_job.CREATED_BY_LABEL.MULTI_METRIC;return _this}_createClass(MultiMetricJobCreator,[{key:"setSplitField",value:function setSplitField(field){this._splitField=field;if(this._splitField===null){this.removeSplitField()}else{for(var i=0;i<this._detectors.length;i++){this._detectors[i].partition_field_name=this._splitField.id}}}},{key:"removeSplitField",value:function removeSplitField(){this._detectors.forEach((function(d){delete d.partition_field_name}))}},{key:"addDetector",value:function addDetector(agg,field){var dtr=this._createDetector(agg,field);this._addDetector(dtr,agg,field)}},{key:"editDetector",value:function editDetector(agg,field,index){var dtr=this._createDetector(agg,field);this._editDetector(dtr,agg,field,index)}},{key:"_createDetector",value:function _createDetector(agg,field){var dtr=(0,_default_configs.createBasicDetector)(agg,field);if(this._splitField!==null){dtr.partition_field_name=this._splitField.id}return dtr}},{key:"removeDetector",value:function removeDetector(index){this._removeDetector(index)}},{key:"calculateModelMemoryLimit",value:function(){var _calculateModelMemoryLimit=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _ref,modelMemoryLimit,currentModelMemoryLimit,defaultModelMemoryLimit,_currentModelMemoryLimit;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(this.jobConfig.analysis_config.detectors.length===0)){_context.next=4;break}this.modelMemoryLimit=_new_job.DEFAULT_MODEL_MEMORY_LIMIT;_context.next=9;break;case 4:_context.next=6;return _ml_api_service.ml.calculateModelMemoryLimit({analysisConfig:this.jobConfig.analysis_config,indexPattern:this._indexPatternTitle,query:this._datafeed_config.query,timeFieldName:this._job_config.data_description.time_field,earliestMs:this._start,latestMs:this._end});case 6:_ref=_context.sent;modelMemoryLimit=_ref.modelMemoryLimit;try{if(this.modelMemoryLimit===null){this.modelMemoryLimit=modelMemoryLimit}else{currentModelMemoryLimit=this.modelMemoryLimit.toLowerCase();defaultModelMemoryLimit=_new_job.DEFAULT_MODEL_MEMORY_LIMIT.toLowerCase();if(currentModelMemoryLimit===defaultModelMemoryLimit||currentModelMemoryLimit===this._lastEstimatedModelMemoryLimit){this.modelMemoryLimit=modelMemoryLimit}}this._lastEstimatedModelMemoryLimit=modelMemoryLimit.toLowerCase()}catch(error){if(this.modelMemoryLimit===null){this.modelMemoryLimit=_new_job.DEFAULT_MODEL_MEMORY_LIMIT}else{_currentModelMemoryLimit=this.modelMemoryLimit.toLowerCase();if(_currentModelMemoryLimit===this._lastEstimatedModelMemoryLimit){this.modelMemoryLimit=_new_job.DEFAULT_MODEL_MEMORY_LIMIT}console.error("Model memory limit could not be calculated",error)}}case 9:case"end":return _context.stop()}}}),_callee,this)})));function calculateModelMemoryLimit(){return _calculateModelMemoryLimit.apply(this,arguments)}return calculateModelMemoryLimit}()},{key:"cloneFromExistingJob",value:function cloneFromExistingJob(job,datafeed){var _this2=this;this._overrideConfigs(job,datafeed);this.createdBy=_new_job.CREATED_BY_LABEL.MULTI_METRIC;var detectors=(0,_general.getRichDetectors)(job,datafeed,this.additionalFields,false);if(datafeed.aggregations!==undefined){delete datafeed.aggregations;delete job.analysis_config.summary_count_field_name}this.removeAllDetectors();detectors.forEach((function(d,i){var dtr=detectors[i];if(dtr.agg!==null&&dtr.field!==null){_this2.addDetector(dtr.agg,dtr.field)}}));if(detectors.length){if(detectors[0].partitionField!==null){this.setSplitField(detectors[0].partitionField)}}}},{key:"splitField",get:function get(){return this._splitField}},{key:"aggFieldPairs",get:function get(){var _this3=this;return this.detectors.map((function(d,i){return{field:_this3._fields[i],agg:_this3._aggs[i]}}))}}]);return MultiMetricJobCreator}(_job_creator.JobCreator);exports.MultiMetricJobCreator=MultiMetricJobCreator},function(module,exports,__webpack_require__){"use strict";function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.PopulationJobCreator=void 0;var _job_creator=__webpack_require__(141);var _default_configs=__webpack_require__(131);var _new_job=__webpack_require__(60);var _general=__webpack_require__(85);function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var PopulationJobCreator=function(_JobCreator){_inherits(PopulationJobCreator,_JobCreator);function PopulationJobCreator(indexPattern,savedSearch,query){var _this;_classCallCheck(this,PopulationJobCreator);_this=_possibleConstructorReturn(this,_getPrototypeOf(PopulationJobCreator).call(this,indexPattern,savedSearch,query));_defineProperty(_assertThisInitialized(_this),"_splitField",null);_defineProperty(_assertThisInitialized(_this),"_byFields",[]);_defineProperty(_assertThisInitialized(_this),"_type",_new_job.JOB_TYPE.POPULATION);_this.createdBy=_new_job.CREATED_BY_LABEL.POPULATION;return _this}_createClass(PopulationJobCreator,[{key:"setByField",value:function setByField(field,index){if(field===null){this.removeByField(index)}else{if(this._detectors[index]!==undefined){this._byFields[index]=field;this._detectors[index].by_field_name=field.id}}}},{key:"removeByField",value:function removeByField(index){if(this._detectors[index]!==undefined){this._byFields[index]=null;delete this._detectors[index].by_field_name}}},{key:"getByField",value:function getByField(index){if(this._byFields[index]===undefined){return null}return this._byFields[index]}},{key:"setSplitField",value:function setSplitField(field){this._splitField=field;if(this._splitField===null){this.removeSplitField()}else{for(var i=0;i<this._detectors.length;i++){this._detectors[i].over_field_name=this._splitField.id}}}},{key:"removeSplitField",value:function removeSplitField(){this._detectors.forEach((function(d){delete d.over_field_name}))}},{key:"addDetector",value:function addDetector(agg,field){var dtr=this._createDetector(agg,field);this._addDetector(dtr,agg,field);this._byFields.push(null)}},{key:"editDetector",value:function editDetector(agg,field,index){var dtr=this._createDetector(agg,field);var sp=this._byFields[index];if(sp!==undefined&&sp!==null){dtr.by_field_name=sp.id}this._editDetector(dtr,agg,field,index)}},{key:"_createDetector",value:function _createDetector(agg,field){var dtr=(0,_default_configs.createBasicDetector)(agg,field);if(this._splitField!==null){dtr.over_field_name=this._splitField.id}return dtr}},{key:"removeDetector",value:function removeDetector(index){this._removeDetector(index);this._byFields.splice(index,1)}},{key:"cloneFromExistingJob",value:function cloneFromExistingJob(job,datafeed){var _this2=this;this._overrideConfigs(job,datafeed);this.createdBy=_new_job.CREATED_BY_LABEL.POPULATION;var detectors=(0,_general.getRichDetectors)(job,datafeed,this.additionalFields,false);this.removeAllDetectors();if(detectors.length){if(detectors[0].overField!==null){this.setSplitField(detectors[0].overField)}}detectors.forEach((function(d,i){var dtr=detectors[i];if(dtr.agg!==null&&dtr.field!==null){_this2.addDetector(dtr.agg,dtr.field);if(dtr.byField!==null){_this2.setByField(dtr.byField,i)}}}))}},{key:"splitField",get:function get(){return this._splitField}},{key:"aggFieldPairs",get:function get(){var _this3=this;return this.detectors.map((function(d,i){return{field:_this3._fields[i],agg:_this3._aggs[i],by:{field:_this3._byFields[i],value:null}}}))}}]);return PopulationJobCreator}(_job_creator.JobCreator);exports.PopulationJobCreator=PopulationJobCreator},function(module,exports,__webpack_require__){"use strict";function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedJobCreator=void 0;var _job_creator=__webpack_require__(141);var _default_configs=__webpack_require__(131);var _new_job=__webpack_require__(60);var _general=__webpack_require__(85);var _validation_utils=__webpack_require__(164);var _ml_api_service=__webpack_require__(51);function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var AdvancedJobCreator=function(_JobCreator){_inherits(AdvancedJobCreator,_JobCreator);function AdvancedJobCreator(indexPattern,savedSearch,query){var _this;_classCallCheck(this,AdvancedJobCreator);_this=_possibleConstructorReturn(this,_getPrototypeOf(AdvancedJobCreator).call(this,indexPattern,savedSearch,query));_defineProperty(_assertThisInitialized(_this),"_type",_new_job.JOB_TYPE.ADVANCED);_defineProperty(_assertThisInitialized(_this),"_richDetectors",[]);_defineProperty(_assertThisInitialized(_this),"_queryString",void 0);_this._queryString=JSON.stringify(_this._datafeed_config.query);return _this}_createClass(AdvancedJobCreator,[{key:"addDetector",value:function addDetector(agg,field,byField,overField,partitionField,excludeFrequent,description){var customRules=null;var _this$_createDetector=this._createDetector(agg,field,byField,overField,partitionField,excludeFrequent,description,customRules),detector=_this$_createDetector.detector,richDetector=_this$_createDetector.richDetector;this._addDetector(detector,agg,field);this._richDetectors.push(richDetector)}},{key:"editDetector",value:function editDetector(agg,field,byField,overField,partitionField,excludeFrequent,description,index){var customRules=this._detectors[index]!==undefined?this._detectors[index].custom_rules||null:null;var _this$_createDetector2=this._createDetector(agg,field,byField,overField,partitionField,excludeFrequent,description,customRules),detector=_this$_createDetector2.detector,richDetector=_this$_createDetector2.richDetector;this._editDetector(detector,agg,field,index);if(this._richDetectors[index]!==undefined){this._richDetectors[index]=richDetector}}},{key:"_createDetector",value:function _createDetector(agg,field,byField,overField,partitionField,excludeFrequent,description,customRules){var detector=(0,_default_configs.createBasicDetector)(agg,field);if(byField!==null){detector.by_field_name=byField.id}if(overField!==null){detector.over_field_name=overField.id}if(partitionField!==null){detector.partition_field_name=partitionField.id}if(excludeFrequent!==null){detector.exclude_frequent=excludeFrequent}if(description!==null){detector.detector_description=description}if(customRules!==null){detector.custom_rules=customRules}var richDetector={agg:agg,field:field,byField:byField,overField:overField,partitionField:partitionField,excludeFrequent:excludeFrequent,description:description,customRules:customRules};return{detector:detector,richDetector:richDetector}}},{key:"removeDetector",value:function removeDetector(index){this._removeDetector(index);this._richDetectors.splice(index,1)}},{key:"autoSetTimeRange",value:function(){var _autoSetTimeRange=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _ref,start,end;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _ml_api_service.ml.getTimeFieldRange({index:this._indexPatternTitle,timeFieldName:this.timeFieldName,query:this.query});case 3:_ref=_context.sent;start=_ref.start;end=_ref.end;this.setTimeRange(start.epoch,end.epoch);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context["catch"](0);throw Error(_context.t0);case 12:case"end":return _context.stop()}}}),_callee,this,[[0,9]])})));function autoSetTimeRange(){return _autoSetTimeRange.apply(this,arguments)}return autoSetTimeRange}()},{key:"cloneFromExistingJob",value:function cloneFromExistingJob(job,datafeed){var _this2=this;this._overrideConfigs(job,datafeed);var detectors=(0,_general.getRichDetectors)(job,datafeed,this.additionalFields,true);var customRules=this._detectors.map((function(d){return d.custom_rules}));this.removeAllDetectors();this._richDetectors.length=0;detectors.forEach((function(d,i){var dtr=detectors[i];if(dtr.agg!==null&&dtr.field!==null){_this2.addDetector(dtr.agg,dtr.field,dtr.byField,dtr.overField,dtr.partitionField,dtr.excludeFrequent,dtr.description)}}));customRules.forEach((function(cr,i){if(cr!==undefined){_this2._detectors[i].custom_rules=cr}}))}},{key:"richDetectors",get:function get(){return this._richDetectors}},{key:"queryString",get:function get(){return this._queryString},set:function set(qs){this._queryString=qs}},{key:"isValidQueryString",get:function get(){return(0,_validation_utils.isValidJson)(this._queryString)}}]);return AdvancedJobCreator}(_job_creator.JobCreator);exports.AdvancedJobCreator=AdvancedJobCreator},function(module,exports,__webpack_require__){"use strict";function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.CategorizationJobCreator=void 0;var _lodash=__webpack_require__(49);var _job_creator=__webpack_require__(141);var _fields=__webpack_require__(118);var _default_configs=__webpack_require__(131);var _new_job=__webpack_require__(60);var _categorization_job=__webpack_require__(142);var _aggregation_types=__webpack_require__(121);var _general=__webpack_require__(85);var _results_loader=__webpack_require__(474);var _ml_server_info=__webpack_require__(84);function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CategorizationJobCreator=function(_JobCreator){_inherits(CategorizationJobCreator,_JobCreator);function CategorizationJobCreator(indexPattern,savedSearch,query){var _this;_classCallCheck(this,CategorizationJobCreator);_this=_possibleConstructorReturn(this,_getPrototypeOf(CategorizationJobCreator).call(this,indexPattern,savedSearch,query));_defineProperty(_assertThisInitialized(_this),"_type",_new_job.JOB_TYPE.CATEGORIZATION);_defineProperty(_assertThisInitialized(_this),"_createCountDetector",(function(){}));_defineProperty(_assertThisInitialized(_this),"_createRareDetector",(function(){}));_defineProperty(_assertThisInitialized(_this),"_examplesLoader",void 0);_defineProperty(_assertThisInitialized(_this),"_categoryFieldExamples",[]);_defineProperty(_assertThisInitialized(_this),"_validationChecks",[]);_defineProperty(_assertThisInitialized(_this),"_overallValidStatus",_categorization_job.CATEGORY_EXAMPLES_VALIDATION_STATUS.INVALID);_defineProperty(_assertThisInitialized(_this),"_detectorType",_aggregation_types.ML_JOB_AGGREGATION.COUNT);_defineProperty(_assertThisInitialized(_this),"_categorizationAnalyzer",{});_defineProperty(_assertThisInitialized(_this),"_defaultCategorizationAnalyzer",void 0);_this.createdBy=_new_job.CREATED_BY_LABEL.CATEGORIZATION;_this._examplesLoader=new _results_loader.CategorizationExamplesLoader(_assertThisInitialized(_this),indexPattern,query);var _getNewJobDefaults=(0,_ml_server_info.getNewJobDefaults)(),anomalyDetectors=_getNewJobDefaults.anomaly_detectors;_this._defaultCategorizationAnalyzer=anomalyDetectors.categorization_analyzer||{};return _this}_createClass(CategorizationJobCreator,[{key:"setDefaultDetectorProperties",value:function setDefaultDetectorProperties(count,rare,eventRate){var _this2=this;if(count===null||rare===null||eventRate===null){return}this._createCountDetector=function(){_this2._createDetector(count,eventRate)};this._createRareDetector=function(){_this2._createDetector(rare,eventRate)}}},{key:"_createDetector",value:function _createDetector(agg,field){var dtr=(0,_default_configs.createBasicDetector)(agg,field);dtr.by_field_name=_fields.mlCategory.id;this._addDetector(dtr,agg,_fields.mlCategory)}},{key:"setDetectorType",value:function setDetectorType(type){this._detectorType=type;this.removeAllDetectors();if(type===_aggregation_types.ML_JOB_AGGREGATION.COUNT){this._createCountDetector();this.bucketSpan=_new_job.DEFAULT_BUCKET_SPAN}else{this._createRareDetector();this.bucketSpan=_new_job.DEFAULT_RARE_BUCKET_SPAN;this.modelPlot=false}}},{key:"loadCategorizationFieldExamples",value:function(){var _loadCategorizationFieldExamples=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _ref,examples,sampleSize,overallValidStatus,validationChecks;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this._examplesLoader.loadExamples();case 2:_ref=_context.sent;examples=_ref.examples;sampleSize=_ref.sampleSize;overallValidStatus=_ref.overallValidStatus;validationChecks=_ref.validationChecks;this._categoryFieldExamples=examples;this._validationChecks=validationChecks;this._overallValidStatus=overallValidStatus;return _context.abrupt("return",{examples:examples,sampleSize:sampleSize,overallValidStatus:overallValidStatus,validationChecks:validationChecks});case 11:case"end":return _context.stop()}}}),_callee,this)})));function loadCategorizationFieldExamples(){return _loadCategorizationFieldExamples.apply(this,arguments)}return loadCategorizationFieldExamples}()},{key:"cloneFromExistingJob",value:function cloneFromExistingJob(job,datafeed){this._overrideConfigs(job,datafeed);this.createdBy=_new_job.CREATED_BY_LABEL.CATEGORIZATION;var detectors=(0,_general.getRichDetectors)(job,datafeed,this.additionalFields,false);var dtr=detectors[0];if(detectors.length&&dtr.agg!==null&&dtr.field!==null){this._detectorType=dtr.agg.id===_aggregation_types.ML_JOB_AGGREGATION.COUNT?_aggregation_types.ML_JOB_AGGREGATION.COUNT:_aggregation_types.ML_JOB_AGGREGATION.RARE;var bs=job.analysis_config.bucket_span;this.setDetectorType(this._detectorType);this.bucketSpan=bs}}},{key:"categorizationFieldName",set:function set(fieldName){if(fieldName!==null){this._job_config.analysis_config.categorization_field_name=fieldName;this.setDetectorType(this._detectorType);this.addInfluencer(_fields.mlCategory.id)}else{delete this._job_config.analysis_config.categorization_field_name;this._categoryFieldExamples=[];this._validationChecks=[];this._overallValidStatus=_categorization_job.CATEGORY_EXAMPLES_VALIDATION_STATUS.INVALID}},get:function get(){return this._job_config.analysis_config.categorization_field_name||null}},{key:"categoryFieldExamples",get:function get(){return this._categoryFieldExamples}},{key:"validationChecks",get:function get(){return this._validationChecks}},{key:"overallValidStatus",get:function get(){return this._overallValidStatus}},{key:"selectedDetectorType",get:function get(){return this._detectorType}},{key:"categorizationAnalyzer",set:function set(analyzer){this._categorizationAnalyzer=analyzer;if((0,_lodash.isEqual)(this._categorizationAnalyzer,this._defaultCategorizationAnalyzer)){delete this._job_config.analysis_config.categorization_analyzer}else{this._job_config.analysis_config.categorization_analyzer=analyzer}},get:function get(){return this._categorizationAnalyzer}}]);return CategorizationJobCreator}(_job_creator.JobCreator);exports.CategorizationJobCreator=CategorizationJobCreator},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ResultsLoader",{enumerable:true,get:function get(){return _results_loader.ResultsLoader}});Object.defineProperty(exports,"Results",{enumerable:true,get:function get(){return _results_loader.Results}});Object.defineProperty(exports,"ModelItem",{enumerable:true,get:function get(){return _results_loader.ModelItem}});Object.defineProperty(exports,"Anomaly",{enumerable:true,get:function get(){return _results_loader.Anomaly}});Object.defineProperty(exports,"CategorizationExamplesLoader",{enumerable:true,get:function get(){return _categorization_examples_loader.CategorizationExamplesLoader}});var _results_loader=__webpack_require__(1277);var _categorization_examples_loader=__webpack_require__(1281)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Anomalies=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _charts=__webpack_require__(37);var _anomaly_utils=__webpack_require__(75);var _anomalies=__webpack_require__(387);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function getAnomalyStyle(threshold){return{line:{stroke:(0,_anomaly_utils.getSeverityColor)(threshold),strokeWidth:3,opacity:1}}}function splitAnomalySeverities(anomalies){var severities={critical:[],major:[],minor:[],warning:[],unknown:[],low:[]};anomalies.forEach((function(a){if(a.value!==0){severities[a.severity].push({dataValue:a.time})}}));return severities}var Anomalies=function Anomalies(_ref){var anomalyData=_ref.anomalyData;var anomalies=anomalyData===undefined?[]:anomalyData;var severities=splitAnomalySeverities(anomalies);return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_charts.LineAnnotation,{id:"low",domainType:_charts.AnnotationDomainTypes.XDomain,dataValues:severities.low,style:getAnomalyStyle(_anomalies.ANOMALY_THRESHOLD.LOW),hideTooltips:true}),_react.default.createElement(_charts.LineAnnotation,{id:"warning",domainType:_charts.AnnotationDomainTypes.XDomain,dataValues:severities.warning,style:getAnomalyStyle(_anomalies.ANOMALY_THRESHOLD.WARNING),hideTooltips:true}),_react.default.createElement(_charts.LineAnnotation,{id:"minor",domainType:_charts.AnnotationDomainTypes.XDomain,dataValues:severities.minor,style:getAnomalyStyle(_anomalies.ANOMALY_THRESHOLD.MINOR),hideTooltips:true}),_react.default.createElement(_charts.LineAnnotation,{id:"major",domainType:_charts.AnnotationDomainTypes.XDomain,dataValues:severities.major,style:getAnomalyStyle(_anomalies.ANOMALY_THRESHOLD.MAJOR),hideTooltips:true}),_react.default.createElement(_charts.LineAnnotation,{id:"critical",domainType:_charts.AnnotationDomainTypes.XDomain,dataValues:severities.critical,style:getAnomalyStyle(_anomalies.ANOMALY_THRESHOLD.CRITICAL),hideTooltips:true}))};exports.Anomalies=Anomalies},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children,validation=_ref.validation;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.title",{defaultMessage:"Groups"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.description",defaultMessage:" Optional grouping for jobs. New groups can be created or picked from the list of existing groups."})},_react.default.createElement(_eui.EuiFormRow,{label:title,error:validation.message,isInvalid:validation.valid===false},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"SingleMetricView",{enumerable:true,get:function get(){return _single_metric_view.SingleMetricView}});var _single_metric_view=__webpack_require__(1290)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"SparseDataSwitch",{enumerable:true,get:function get(){return _sparse_data_switch.SparseDataSwitch}});var _sparse_data_switch=__webpack_require__(1305)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"MultiMetricView",{enumerable:true,get:function get(){return _multi_metric_view.MultiMetricView}});var _multi_metric_view=__webpack_require__(1307)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ChartGrid=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _split_cards=__webpack_require__(481);var _detector_title=__webpack_require__(482);var _anomaly_chart=__webpack_require__(202);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var ChartGrid=function ChartGrid(_ref){var aggFieldPairList=_ref.aggFieldPairList,chartSettings=_ref.chartSettings,splitField=_ref.splitField,fieldValues=_ref.fieldValues,lineChartsData=_ref.lineChartsData,modelData=_ref.modelData,anomalyData=_ref.anomalyData,deleteDetector=_ref.deleteDetector,jobType=_ref.jobType,_ref$loading=_ref.loading,loading=_ref$loading===void 0?false:_ref$loading;var animateSplit=(0,_split_cards.useAnimateSplit)();return _react.default.createElement(_split_cards.SplitCards,{fieldValues:fieldValues,splitField:splitField,numberOfDetectors:aggFieldPairList.length,jobType:jobType,animate:animateSplit},_react.default.createElement(_eui.EuiFlexGrid,{columns:chartSettings.cols},aggFieldPairList.map((function(af,i){return _react.default.createElement(_eui.EuiFlexItem,{key:i,"data-test-subj":"mlDetector ".concat(i)},_react.default.createElement(_react.Fragment,null,_react.default.createElement(_detector_title.DetectorTitle,{index:i,agg:aggFieldPairList[i].agg,field:aggFieldPairList[i].field,deleteDetector:deleteDetector}),_react.default.createElement(_anomaly_chart.AnomalyChart,{chartType:_anomaly_chart.CHART_TYPE.LINE,chartData:lineChartsData[i],modelData:modelData[i],anomalyData:anomalyData[i],height:chartSettings.height,width:chartSettings.width,loading:loading})))}))))};exports.ChartGrid=ChartGrid},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"SplitCards",{enumerable:true,get:function get(){return _split_cards.SplitCards}});Object.defineProperty(exports,"useAnimateSplit",{enumerable:true,get:function get(){return _animate_split_hook.useAnimateSplit}});var _split_cards=__webpack_require__(1310);var _animate_split_hook=__webpack_require__(1311)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DetectorTitle",{enumerable:true,get:function get(){return _detector_title.DetectorTitle}});var _detector_title=__webpack_require__(1312)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SplitFieldSelect=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SplitFieldSelect=function SplitFieldSelect(_ref){var fields=_ref.fields,changeHandler=_ref.changeHandler,selectedField=_ref.selectedField,isClearable=_ref.isClearable,testSubject=_ref.testSubject,placeholder=_ref.placeholder;var options=fields.map((function(f){return{label:f.name,field:f}}));var selection=[];if(selectedField!==null){selection.push({label:selectedField.name,field:selectedField})}function onChange(selectedOptions){var option=selectedOptions[0];if(typeof option!=="undefined"){changeHandler(option.field)}else{changeHandler(null)}}return _react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:options,selectedOptions:selection,onChange:onChange,isClearable:isClearable,placeholder:placeholder,"data-test-subj":testSubject})};exports.SplitFieldSelect=SplitFieldSelect},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"PopulationView",{enumerable:true,get:function get(){return _population_view.PopulationView}});var _population_view=__webpack_require__(1321)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ChartGrid=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _new_job=__webpack_require__(60);var _split_cards=__webpack_require__(481);var _detector_title=__webpack_require__(482);var _split_field=__webpack_require__(255);var _anomaly_chart=__webpack_require__(202);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var ChartGrid=function ChartGrid(_ref){var aggFieldPairList=_ref.aggFieldPairList,chartSettings=_ref.chartSettings,splitField=_ref.splitField,lineChartsData=_ref.lineChartsData,modelData=_ref.modelData,anomalyData=_ref.anomalyData,deleteDetector=_ref.deleteDetector,jobType=_ref.jobType,fieldValuesPerDetector=_ref.fieldValuesPerDetector,_ref$loading=_ref.loading,loading=_ref$loading===void 0?false:_ref$loading;var animateSplit=(0,_split_cards.useAnimateSplit)();return _react.default.createElement(_eui.EuiFlexGrid,{columns:chartSettings.cols},aggFieldPairList.map((function(af,i){return _react.default.createElement(_eui.EuiFlexItem,{key:i,"data-test-subj":"mlDetector ".concat(i)},_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_detector_title.DetectorTitle,{index:i,agg:aggFieldPairList[i].agg,field:aggFieldPairList[i].field,byField:aggFieldPairList[i].by,deleteDetector:deleteDetector},deleteDetector!==undefined&&_react.default.createElement(_split_field.ByFieldSelector,{detectorIndex:i})),jobType===_new_job.JOB_TYPE.POPULATION&&_react.default.createElement(_eui.EuiSpacer,{size:"s"}))),_react.default.createElement(_split_cards.SplitCards,{fieldValues:fieldValuesPerDetector[i]||[],splitField:splitField,numberOfDetectors:aggFieldPairList.length,jobType:jobType,animate:animateSplit},_react.default.createElement(_anomaly_chart.AnomalyChart,{chartType:_anomaly_chart.CHART_TYPE.SCATTER,chartData:lineChartsData[i],modelData:modelData[i],anomalyData:anomalyData[i],height:chartSettings.height,width:chartSettings.width,loading:loading}))))})))};exports.ChartGrid=ChartGrid},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AdvancedView",{enumerable:true,get:function get(){return _advanced_view.AdvancedView}});var _advanced_view=__webpack_require__(1326)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DetectorList=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _string_utils=__webpack_require__(80);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var DetectorList=function DetectorList(_ref){var isActive=_ref.isActive,onEditJob=_ref.onEditJob,onDeleteJob=_ref.onDeleteJob;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdated=_useContext.jobCreatorUpdated,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var jobCreator=jc;var _useState=(0,_react.useState)(jobCreator.detectors),_useState2=_slicedToArray(_useState,2),detectors=_useState2[0],setDetectors=_useState2[1];var _useState3=(0,_react.useState)(jobValidator.duplicateDetectors),_useState4=_slicedToArray(_useState3,2),validation=_useState4[0],setValidation=_useState4[1];(0,_react.useEffect)((function(){setDetectors(jobCreator.detectors)}),[jobCreatorUpdated]);(0,_react.useEffect)((function(){setValidation(jobValidator.duplicateDetectors)}),[jobValidatorUpdated]);var Buttons=function Buttons(_ref2){var index=_ref2.index;return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiButtonIcon,{color:"primary",onClick:function onClick(){return onEditJob(index)},iconType:"pencil","aria-label":_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.editButton",{defaultMessage:"Edit"}),"data-test-subj":"mlAdvancedDetectorEditButton"})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiButtonIcon,{color:"danger",onClick:function onClick(){return onDeleteJob(index)},iconType:"trash","aria-label":_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.deleteButton",{defaultMessage:"Delete"}),"data-test-subj":"mlAdvancedDetectorDeleteButton"})))};return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiTitle,{size:"xs"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.title",defaultMessage:"Detectors"}))),_react.default.createElement(NoDetectorsWarning,{show:detectors.length===0}),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexGrid,{columns:3},detectors.map((function(d,i){return _react.default.createElement(_eui.EuiFlexItem,{key:i,"data-test-subj":"mlAdvancedDetector ".concat(i)},_react.default.createElement(_eui.EuiPanel,{paddingSize:"m"},_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,d.detector_description!==undefined?_react.default.createElement("div",{style:{fontWeight:"bold"},"data-test-subj":"mlDetectorDescription"},d.detector_description):_react.default.createElement(StringifiedDetector,{detector:d})),isActive&&_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{margin:"8px"}},_react.default.createElement(Buttons,{index:i}))),d.detector_description!==undefined&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHorizontalRule,{margin:"s"}),_react.default.createElement(StringifiedDetector,{detector:d}))))}))),_react.default.createElement(DuplicateDetectorsWarning,{validation:validation}))};exports.DetectorList=DetectorList;var NoDetectorsWarning=function NoDetectorsWarning(_ref3){var show=_ref3.show;if(show===false){return null}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.noDetectorsCallout.title",{defaultMessage:"No detectors"}),iconType:"alert","data-test-subj":"mlAdvancedNoDetectorsMessage"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.noDetectorsCallout.message",defaultMessage:"At least one detector is needed to create a job."})),_react.default.createElement(_eui.EuiSpacer,{size:"s"}))};var DuplicateDetectorsWarning=function DuplicateDetectorsWarning(_ref4){var validation=_ref4.validation;if(validation.valid===true){return null}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFormRow,{error:validation.message,isInvalid:validation.valid===false},_react.default.createElement(_react.Fragment,null)),_react.default.createElement(_eui.EuiSpacer,{size:"s"}))};var StringifiedDetector=function StringifiedDetector(_ref5){var detector=_ref5.detector;return _react.default.createElement("div",{"data-test-subj":"mlDetectorIdentifier"},(0,_string_utils.detectorToString)(detector))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ModelMemoryLimitInput",{enumerable:true,get:function get(){return _model_memory_limit_input.ModelMemoryLimitInput}});var _model_memory_limit_input=__webpack_require__(1335)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CategorizationField",{enumerable:true,get:function get(){return _categorization_field.CategorizationField}});var _categorization_field=__webpack_require__(1342)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CategorizationView",{enumerable:true,get:function get(){return _categorization_view.CategorizationView}});var _categorization_view=__webpack_require__(1345)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useStringifiedValue=useStringifiedValue;var _react=__webpack_require__(28);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function useStringifiedValue(initialValue){var _useState=(0,_react.useState)(stringify(initialValue)),_useState2=_slicedToArray(_useState,2),value=_useState2[0],setValueInner=_useState2[1];function stringify(f){return f===null?"":f}function setValue(f){setValueInner(stringify(f))}return{value:value,setValue:setValue}}},,function(module,exports,__webpack_require__){"use strict"},function(module,exports,__webpack_require__){"use strict"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ModuleJobs=exports.SETUP_RESULTS_WIDTH=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _page=__webpack_require__(203);var _job_item=__webpack_require__(1436);var _edit_job=__webpack_require__(1437);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var SETUP_RESULTS_WIDTH="200px";exports.SETUP_RESULTS_WIDTH=SETUP_RESULTS_WIDTH;var ModuleJobs=function ModuleJobs(_ref){var jobs=_ref.jobs,jobPrefix=_ref.jobPrefix,jobOverrides=_ref.jobOverrides,saveState=_ref.saveState,existingGroupIds=_ref.existingGroupIds,onJobOverridesChange=_ref.onJobOverridesChange;var isSaving=saveState===_page.SAVE_STATE.SAVING;var _useState=(0,_react.useState)(null),_useState2=_slicedToArray(_useState,2),jobToEdit=_useState2[0],setJobToEdit=_useState2[1];var onFlyoutClose=function onFlyoutClose(result){setJobToEdit(null);if(result===null){return}onJobOverridesChange(result)};var getJobOverride=function getJobOverride(job){return jobOverrides[job.id]};var editJobFlyout=jobToEdit!==null?_react.default.createElement(_edit_job.EditJob,{job:jobToEdit,jobOverride:getJobOverride(jobToEdit),onClose:onFlyoutClose,existingGroupIds:existingGroupIds}):null;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobsTitle",defaultMessage:"Jobs"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),saveState!==_page.SAVE_STATE.SAVING&&saveState!==_page.SAVE_STATE.NOT_SAVED&&_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd",responsive:false,gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{style:{width:SETUP_RESULTS_WIDTH},grow:false},_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",responsive:false,gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:1},_react.default.createElement(_eui.EuiText,{size:"s",textAlign:"center"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobLabel",defaultMessage:"Job"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:1},_react.default.createElement(_eui.EuiText,{size:"s",textAlign:"center"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.datafeedLabel",defaultMessage:"Datafeed"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:1},_react.default.createElement(_eui.EuiText,{size:"s",textAlign:"center"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.runningLabel",defaultMessage:"Running"})))))),_react.default.createElement("ul",null,jobs.map((function(job,i){return _react.default.createElement("li",{key:job.id},_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_job_item.JobItem,{jobPrefix:jobPrefix,job:job,jobOverride:getJobOverride(job),isSaving:isSaving,onEditRequest:function onEditRequest(){return setJobToEdit(job)}}))),i<jobs.length-1&&_react.default.createElement(_eui.EuiHorizontalRule,{margin:"s"}))}))),editJobFlyout)};exports.ModuleJobs=ModuleJobs},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.checkViewOrCreateJobs=checkViewOrCreateJobs;exports.checkForSavedObjects=void 0;var _i18n=__webpack_require__(1);var _dependency_cache=__webpack_require__(5);var _job_service=__webpack_require__(58);var _ml_api_service=__webpack_require__(51);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function checkViewOrCreateJobs(moduleId,indexPatternId){return new Promise((function(resolve,reject){_ml_api_service.ml.dataRecognizerModuleJobsExist({moduleId:moduleId}).then((function(resp){if(resp.jobsExist===true){var resultsPageUrl=_job_service.mlJobService.createResultsUrlForJobs(resp.jobs,"explorer");window.location.href=resultsPageUrl;reject()}else{window.location.href="#/jobs/new_job/recognize?id=".concat(moduleId,"&index=").concat(indexPatternId);reject()}})).catch((function(err){console.error("Error checking whether jobs in module ".concat(moduleId," exists"),err);var toastNotifications=(0,_dependency_cache.getToastNotifications)();toastNotifications.addWarning({title:_i18n.i18n.translate("xpack.ml.newJob.recognize.moduleCheckJobsExistWarningTitle",{defaultMessage:"Error checking module {moduleId}",values:{moduleId:moduleId}}),text:_i18n.i18n.translate("xpack.ml.newJob.recognize.moduleCheckJobsExistWarningDescription",{defaultMessage:"An error occurred trying to check whether the jobs in the module have been created."})});window.location.href="#/jobs";reject()}))}))}var checkForSavedObjects=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(objects){var savedObjectsClient;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:savedObjectsClient=(0,_dependency_cache.getSavedObjectsClient)();_context2.prev=1;_context2.next=4;return Object.keys(objects).reduce(function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(prevPromise,type){var acc,_ref3,savedObjects;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return prevPromise;case 2:acc=_context.sent;_context.next=5;return savedObjectsClient.find({type:type,perPage:1e3});case 5:_ref3=_context.sent;savedObjects=_ref3.savedObjects;acc[type]=objects[type].map((function(obj){var find=savedObjects.find((function(savedObject){return savedObject.attributes.title===obj.title}));return _objectSpread({},obj,{exists:!!find,id:!!find&&find.id||obj.id})}));return _context.abrupt("return",Promise.resolve(acc));case 9:case"end":return _context.stop()}}}),_callee)})));return function(_x2,_x3){return _ref2.apply(this,arguments)}}(),Promise.resolve({}));case 4:return _context2.abrupt("return",_context2.sent);case 7:_context2.prev=7;_context2.t0=_context2["catch"](1);console.error("Could not load saved objects",_context2.t0);case 10:return _context2.abrupt("return",Promise.resolve(objects));case 11:case"end":return _context2.stop()}}}),_callee2,null,[[1,7]])})));return function checkForSavedObjects(_x){return _ref.apply(this,arguments)}}();exports.checkForSavedObjects=checkForSavedObjects},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FieldTypeIcon",{enumerable:true,get:function get(){return _field_type_icon.FieldTypeIcon}});var _field_type_icon=__webpack_require__(1454)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DisplayValue",{enumerable:true,get:function get(){return _display_value.DisplayValue}});var _display_value=__webpack_require__(1468)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ExperimentalBadge",{enumerable:true,get:function get(){return _experimental_badge.ExperimentalBadge}});var _experimental_badge=__webpack_require__(1492)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MODE=void 0;var MODE;exports.MODE=MODE;(function(MODE){MODE[MODE["READ"]=0]="READ";MODE[MODE["IMPORT"]=1]="IMPORT"})(MODE||(exports.MODE=MODE={}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CHARSET_OPTIONS=exports.QUOTE_OPTIONS=exports.DELIMITER_OPTIONS=exports.TIMESTAMP_OPTIONS=exports.CUSTOM_DROPDOWN_OPTION=exports.FORMAT_OPTIONS=void 0;var FORMAT_OPTIONS=["delimited","ndjson","semi_structured_text"];exports.FORMAT_OPTIONS=FORMAT_OPTIONS;var CUSTOM_DROPDOWN_OPTION="custom";exports.CUSTOM_DROPDOWN_OPTION=CUSTOM_DROPDOWN_OPTION;var TIMESTAMP_OPTIONS=[CUSTOM_DROPDOWN_OPTION,"dd/MMM/yyyy:HH:mm:ss XX","EEE MMM dd HH:mm zzz yyyy","EEE MMM dd HH:mm:ss yyyy","EEE MMM dd HH:mm:ss zzz yyyy","EEE MMM dd yyyy HH:mm zzz","EEE MMM dd yyyy HH:mm:ss zzz","EEE, dd MMM yyyy HH:mm XX","EEE, dd MMM yyyy HH:mm XXX","EEE, dd MMM yyyy HH:mm:ss XX","EEE, dd MMM yyyy HH:mm:ss XXX","ISO8601","MMM dd HH:mm:ss","MMM dd HH:mm:ss,SSS","MMM dd HH:mm:ss,SSSSSS","MMM dd HH:mm:ss,SSSSSSSSS","MMM dd HH:mm:ss.SSS","MMM dd HH:mm:ss.SSSSSS","MMM dd HH:mm:ss.SSSSSSSSS","MMM dd HH:mm:ss:SSS","MMM dd HH:mm:ss:SSSSSS","MMM dd HH:mm:ss:SSSSSSSSS","MMM dd yyyy HH:mm:ss","MMM dd, yyyy h:mm:ss a","TAI64N","UNIX","UNIX_MS","yyyy-MM-dd HH:mm:ss","yyyy-MM-dd HH:mm:ss,SSS","yyyy-MM-dd HH:mm:ss,SSSSSS","yyyy-MM-dd HH:mm:ss,SSSSSSSSS","yyyy-MM-dd HH:mm:ss.SSS","yyyy-MM-dd HH:mm:ss.SSSSSS","yyyy-MM-dd HH:mm:ss.SSSSSSSSS","yyyy-MM-dd HH:mm:ss:SSS","yyyy-MM-dd HH:mm:ss:SSSSSS","yyyy-MM-dd HH:mm:ss:SSSSSSSSS","yyyy-MM-dd HH:mm:ss,SSS XX","yyyy-MM-dd HH:mm:ss,SSSSSS XX","yyyy-MM-dd HH:mm:ss,SSSSSSSSS XX","yyyy-MM-dd HH:mm:ss.SSS XX","yyyy-MM-dd HH:mm:ss.SSSSSS XX","yyyy-MM-dd HH:mm:ss.SSSSSSSSS XX","yyyy-MM-dd HH:mm:ss:SSS XX","yyyy-MM-dd HH:mm:ss:SSSSSS XX","yyyy-MM-dd HH:mm:ss:SSSSSSSSS XX","yyyy-MM-dd HH:mm:ss,SSSXX","yyyy-MM-dd HH:mm:ss,SSSSSSXX","yyyy-MM-dd HH:mm:ss,SSSSSSSSSXX","yyyy-MM-dd HH:mm:ss.SSSXX","yyyy-MM-dd HH:mm:ss.SSSSSSXX","yyyy-MM-dd HH:mm:ss.SSSSSSSSSXX","yyyy-MM-dd HH:mm:ss:SSSXX","yyyy-MM-dd HH:mm:ss:SSSSSSXX","yyyy-MM-dd HH:mm:ss:SSSSSSSSSXX","yyyy-MM-dd HH:mm:ss,SSSXXX","yyyy-MM-dd HH:mm:ss,SSSSSSXXX","yyyy-MM-dd HH:mm:ss,SSSSSSSSSXXX","yyyy-MM-dd HH:mm:ss.SSSXXX","yyyy-MM-dd HH:mm:ss.SSSSSSXXX","yyyy-MM-dd HH:mm:ss.SSSSSSSSSXXX","yyyy-MM-dd HH:mm:ss:SSSXXX","yyyy-MM-dd HH:mm:ss:SSSSSSXXX","yyyy-MM-dd HH:mm:ss:SSSSSSSSSXXX","yyyy-MM-dd HH:mm:ssXX","yyyy-MM-dd HH:mm:ssXXX","yyyyMMddHHmmss"];exports.TIMESTAMP_OPTIONS=TIMESTAMP_OPTIONS;var DELIMITER_OPTIONS=["comma","tab","semicolon","pipe","space",CUSTOM_DROPDOWN_OPTION];exports.DELIMITER_OPTIONS=DELIMITER_OPTIONS;var QUOTE_OPTIONS=["'",'"',"`"];exports.QUOTE_OPTIONS=QUOTE_OPTIONS;var CHARSET_OPTIONS=["IBM00858","IBM437","IBM775","IBM850","IBM852","IBM855","IBM857","IBM862","IBM866","ISO-8859-1","ISO-8859-2","ISO-8859-4","ISO-8859-5","ISO-8859-7","ISO-8859-9","ISO-8859-13","ISO-8859-15","KOI8-R","KOI8-U","US-ASCII","UTF-8","UTF-16","UTF-16BE","UTF-16LE","UTF-32","UTF-32BE","UTF-32LE","x-UTF-32BE-BOM","x-UTF-32LE-BOM","windows-1250","windows-1251","windows-1252","windows-1253","windows-1254","windows-1257","Not available","x-IBM737","x-IBM874","x-UTF-16LE-BOM","Big5","Big5-HKSCS","EUC-JP","EUC-KR","GB18030","GB2312","GBK","IBM-Thai","IBM01140","IBM01141","IBM01142","IBM01143","IBM01144","IBM01145","IBM01146","IBM01147","IBM01148","IBM01149","IBM037","IBM1026","IBM1047","IBM273","IBM277","IBM278","IBM280","IBM284","IBM285","IBM297","IBM420","IBM424","IBM500","IBM860","IBM861","IBM863","IBM864","IBM865","IBM868","IBM869","IBM870","IBM871","IBM918","ISO-2022-CN","ISO-2022-JP","ISO-2022-KR","ISO-8859-3","ISO-8859-6","ISO-8859-8","JIS_X0201","JIS_X0212-1990","Shift_JIS","TIS-620","windows-1255","windows-1256","windows-1258","windows-31j","x-Big5-Solaris","x-euc-jp-linux","x-EUC-TW","x-eucJP-Open","x-IBM1006","x-IBM1025","x-IBM1046","x-IBM1097","x-IBM1098","x-IBM1112","x-IBM1122","x-IBM1123","x-IBM1124","x-IBM1381","x-IBM1383","x-IBM33722","x-IBM834","x-IBM856","x-IBM875","x-IBM921","x-IBM922","x-IBM930","x-IBM933","x-IBM935","x-IBM937","x-IBM939","x-IBM942","x-IBM942C","x-IBM943","x-IBM943C","x-IBM948","x-IBM949","x-IBM949C","x-IBM950","x-IBM964","x-IBM970","x-ISCII91","x-ISO2022-CN-CNS","x-ISO2022-CN-GB","x-iso-8859-11","x-JIS0208","x-JISAutoDetect","x-Johab","x-MacArabic","x-MacCentralEurope","x-MacCroatian","x-MacCyrillic","x-MacDingbat","x-MacGreek","x-MacHebrew","x-MacIceland","x-MacRoman","x-MacRomania","x-MacSymbol","x-MacThai","x-MacTurkish","x-MacUkraine","x-MS950-HKSCS","x-mswin-936","x-PCK","x-SJIS_0213","x-windows-50220","x-windows-50221","x-windows-874","x-windows-949","x-windows-950","x-windows-iso2022jp"];exports.CHARSET_OPTIONS=CHARSET_OPTIONS},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Importer=void 0;var _ml_api_service=__webpack_require__(51);var _lodash=__webpack_require__(49);var _moment=_interopRequireDefault(__webpack_require__(32));var _i18n=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var CHUNK_SIZE=5e3;var MAX_CHUNK_CHAR_COUNT=1e6;var IMPORT_RETRIES=5;var Importer=function(){function Importer(_ref){var settings=_ref.settings,mappings=_ref.mappings,pipeline=_ref.pipeline;_classCallCheck(this,Importer);this.settings=settings;this.mappings=mappings;this.pipeline=pipeline;this.data=[];this.docArray=[];this.docSizeArray=[]}_createClass(Importer,[{key:"initializeImport",value:function(){var _initializeImport=_asyncToGenerator(regeneratorRuntime.mark((function _callee(index){var settings,mappings,pipeline,ingestPipeline,createIndexResp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:settings=this.settings;mappings=this.mappings;pipeline=this.pipeline;updatePipelineTimezone(pipeline);ingestPipeline=pipeline!==undefined?{id:"".concat(index,"-pipeline"),pipeline:pipeline}:{};_context.next=7;return _ml_api_service.ml.fileDatavisualizer.import({id:undefined,index:index,data:[],settings:settings,mappings:mappings,ingestPipeline:ingestPipeline});case 7:createIndexResp=_context.sent;return _context.abrupt("return",createIndexResp);case 9:case"end":return _context.stop()}}}),_callee,this)})));function initializeImport(_x){return _initializeImport.apply(this,arguments)}return initializeImport}()},{key:"import",value:function(){var _import2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(id,index,pipelineId,setImportProgress){var chunks,ingestPipeline,success,failures,error,i,aggs,retries,resp,result;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(!id||!index)){_context2.next=2;break}return _context2.abrupt("return",{success:false,error:_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importView.noIdOrIndexSuppliedErrorMessage",{defaultMessage:"no ID or index supplied"})});case 2:chunks=createDocumentChunks(this.docArray);ingestPipeline={id:pipelineId};success=true;failures=[];i=0;case 7:if(!(i<chunks.length)){_context2.next=39;break}aggs={id:id,index:index,data:chunks[i],settings:{},mappings:{},ingestPipeline:ingestPipeline};retries=IMPORT_RETRIES;resp={success:false,failures:[],docCount:0};case 11:if(!(resp.success===false&&retries>0)){_context2.next=26;break}_context2.prev=12;_context2.next=15;return _ml_api_service.ml.fileDatavisualizer.import(aggs);case 15:resp=_context2.sent;if(retries<IMPORT_RETRIES){console.log("Retrying import ".concat(IMPORT_RETRIES-retries))}retries--;_context2.next=24;break;case 20:_context2.prev=20;_context2.t0=_context2["catch"](12);resp={success:false,error:_context2.t0};retries=0;case 24:_context2.next=11;break;case 26:if(!resp.success){_context2.next=30;break}setImportProgress((i+1)/chunks.length*100);_context2.next=35;break;case 30:console.error(resp);success=false;error=resp.error;populateFailures(resp,failures,i);return _context2.abrupt("break",39);case 35:populateFailures(resp,failures,i);case 36:i++;_context2.next=7;break;case 39:result={success:success,failures:failures,docCount:this.docArray.length};if(success){setImportProgress(100)}else{result.error=error}return _context2.abrupt("return",result);case 42:case"end":return _context2.stop()}}}),_callee2,this,[[12,20]])})));function _import(_x2,_x3,_x4,_x5){return _import2.apply(this,arguments)}return _import}()}]);return Importer}();exports.Importer=Importer;function populateFailures(error,failures,chunkCount){if(error.failures&&error.failures.length){for(var f=0;f<error.failures.length;f++){var failure=error.failures[f];failure.item=failure.item+CHUNK_SIZE*chunkCount}failures.push.apply(failures,_toConsumableArray(error.failures))}}function updatePipelineTimezone(ingestPipeline){if(ingestPipeline!==undefined&&ingestPipeline.processors&&ingestPipeline.processors){var dateProcessor=ingestPipeline.processors.find((function(p){return p.date!==undefined&&p.date.timezone==="{{ event.timezone }}"}));if(dateProcessor){dateProcessor.date.timezone=_moment.default.tz.guess()}}}function createDocumentChunks(docArray){var chunks=[];var tempChunks=(0,_lodash.chunk)(docArray,CHUNK_SIZE);for(var i=0;i<tempChunks.length;i++){var docs=tempChunks[i];var numberOfDocs=docs.length;var charCountOfDocs=JSON.stringify(docs).length;if(charCountOfDocs>MAX_CHUNK_CHAR_COUNT){var adjustedChunkSize=Math.floor(MAX_CHUNK_CHAR_COUNT/charCountOfDocs*numberOfDocs);var smallerChunks=(0,_lodash.chunk)(docs,adjustedChunkSize);chunks.push.apply(chunks,_toConsumableArray(smallerChunks))}else{chunks.push(docs)}}return chunks}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportProgress",{enumerable:true,get:function get(){return _import_progress.ImportProgress}});Object.defineProperty(exports,"IMPORT_STATUS",{enumerable:true,get:function get(){return _import_progress.IMPORT_STATUS}});var _import_progress=__webpack_require__(1523)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"createUrlOverrides",{enumerable:true,get:function get(){return _utils.createUrlOverrides}});Object.defineProperty(exports,"hasImportPermission",{enumerable:true,get:function get(){return _utils.hasImportPermission}});Object.defineProperty(exports,"processResults",{enumerable:true,get:function get(){return _utils.processResults}});Object.defineProperty(exports,"readFile",{enumerable:true,get:function get(){return _utils.readFile}});Object.defineProperty(exports,"reduceData",{enumerable:true,get:function get(){return _utils.reduceData}});var _utils=__webpack_require__(1532)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NewCalendar",{enumerable:true,get:function get(){return _edit.NewCalendar}});Object.defineProperty(exports,"CalendarsList",{enumerable:true,get:function get(){return _list.CalendarsList}});var _edit=__webpack_require__(1540);var _list=__webpack_require__(1556)},,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EditFilterList",{enumerable:true,get:function get(){return _edit.EditFilterList}});Object.defineProperty(exports,"FilterLists",{enumerable:true,get:function get(){return _list.FilterLists}});var _edit=__webpack_require__(1564);var _list=__webpack_require__(1578)},,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RegressionExploration=exports.ExplorationTitle=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _ml_api_service=__webpack_require__(51);var _evaluate_panel=__webpack_require__(1632);var _results_table=__webpack_require__(1635);var _analytics=__webpack_require__(76);var _loading_panel=__webpack_require__(267);var _index_utils=__webpack_require__(70);var _new_job_capabilities_service=__webpack_require__(66);var _ml=__webpack_require__(77);var _get_analytics=__webpack_require__(189);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ExplorationTitle=function ExplorationTitle(_ref){var jobId=_ref.jobId;return _react.default.createElement(_eui.EuiTitle,{size:"xs"},_react.default.createElement("span",null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.tableJobIdTitle",{defaultMessage:"Destination index for regression job ID {jobId}",values:{jobId:jobId}})))};exports.ExplorationTitle=ExplorationTitle;var jobConfigErrorTitle=_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.jobConfigurationFetchError",{defaultMessage:"Unable to fetch results. An error occurred loading the job configuration data."});var jobCapsErrorTitle=_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.jobCapsFetchError",{defaultMessage:"Unable to fetch results. An error occurred loading the index's field data."});var RegressionExploration=function RegressionExploration(_ref2){var jobId=_ref2.jobId;var _useState=(0,_react.useState)(undefined),_useState2=_slicedToArray(_useState,2),jobConfig=_useState2[0],setJobConfig=_useState2[1];var _useState3=(0,_react.useState)(undefined),_useState4=_slicedToArray(_useState3,2),jobStatus=_useState4[0],setJobStatus=_useState4[1];var _useState5=(0,_react.useState)(undefined),_useState6=_slicedToArray(_useState5,2),indexPattern=_useState6[0],setIndexPattern=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),isLoadingJobConfig=_useState8[0],setIsLoadingJobConfig=_useState8[1];var _useState9=(0,_react.useState)(false),_useState10=_slicedToArray(_useState9,2),isInitialized=_useState10[0],setIsInitialized=_useState10[1];var _useState11=(0,_react.useState)(undefined),_useState12=_slicedToArray(_useState11,2),jobConfigErrorMessage=_useState12[0],setJobConfigErrorMessage=_useState12[1];var _useState13=(0,_react.useState)(undefined),_useState14=_slicedToArray(_useState13,2),jobCapsServiceErrorMessage=_useState14[0],setJobCapsServiceErrorMessage=_useState14[1];var _useState15=(0,_react.useState)(_analytics.defaultSearchQuery),_useState16=_slicedToArray(_useState15,2),searchQuery=_useState16[0],setSearchQuery=_useState16[1];var mlContext=(0,_ml.useMlContext)();var loadJobConfig=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var analyticsConfigs,analyticsStats,stats;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoadingJobConfig(true);_context.prev=1;_context.next=4;return _ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalytics(jobId);case 4:analyticsConfigs=_context.sent;_context.next=7;return _ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(jobId);case 7:analyticsStats=_context.sent;stats=(0,_get_analytics.isGetDataFrameAnalyticsStatsResponseOk)(analyticsStats)?analyticsStats.data_frame_analytics[0]:undefined;if(stats!==undefined&&stats.state){setJobStatus(stats.state)}if(Array.isArray(analyticsConfigs.data_frame_analytics)&&analyticsConfigs.data_frame_analytics.length>0){setJobConfig(analyticsConfigs.data_frame_analytics[0]);setIsLoadingJobConfig(false)}_context.next=17;break;case 13:_context.prev=13;_context.t0=_context["catch"](1);if(_context.t0.message!==undefined){setJobConfigErrorMessage(_context.t0.message)}else{setJobConfigErrorMessage(JSON.stringify(_context.t0))}setIsLoadingJobConfig(false);case 17:case"end":return _context.stop()}}}),_callee,null,[[1,13]])})));return function loadJobConfig(){return _ref3.apply(this,arguments)}}();(0,_react.useEffect)((function(){loadJobConfig()}),[]);var initializeJobCapsService=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var destIndex,destIndexPatternId,indexP,sourceIndex,sourceIndexPatternId;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(jobConfig!==undefined)){_context2.next=29;break}_context2.prev=1;destIndex=Array.isArray(jobConfig.dest.index)?jobConfig.dest.index[0]:jobConfig.dest.index;destIndexPatternId=(0,_index_utils.getIndexPatternIdFromName)(destIndex)||destIndex;_context2.prev=4;_context2.next=7;return mlContext.indexPatterns.get(destIndexPatternId);case 7:indexP=_context2.sent;_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2["catch"](4);indexP=undefined;case 13:if(!(indexP===undefined)){_context2.next=19;break}sourceIndex=jobConfig.source.index[0];sourceIndexPatternId=(0,_index_utils.getIndexPatternIdFromName)(sourceIndex)||sourceIndex;_context2.next=18;return mlContext.indexPatterns.get(sourceIndexPatternId);case 18:indexP=_context2.sent;case 19:if(!(indexP!==undefined)){_context2.next=23;break}setIndexPattern(indexP);_context2.next=23;return _new_job_capabilities_service.newJobCapsService.initializeFromIndexPattern(indexP,false,false);case 23:setIsInitialized(true);_context2.next=29;break;case 26:_context2.prev=26;_context2.t1=_context2["catch"](1);if(_context2.t1.message!==undefined){setJobCapsServiceErrorMessage(_context2.t1.message)}else{setJobCapsServiceErrorMessage(JSON.stringify(_context2.t1))}case 29:case"end":return _context2.stop()}}}),_callee2,null,[[1,26],[4,10]])})));return function initializeJobCapsService(){return _ref4.apply(this,arguments)}}();(0,_react.useEffect)((function(){initializeJobCapsService()}),[jobConfig&&jobConfig.id]);if(jobConfigErrorMessage!==undefined||jobCapsServiceErrorMessage!==undefined){return _react.default.createElement(_eui.EuiPanel,{grow:false},_react.default.createElement(ExplorationTitle,{jobId:jobId}),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiCallOut,{title:jobConfigErrorMessage?jobConfigErrorTitle:jobCapsErrorTitle,color:"danger",iconType:"cross"},_react.default.createElement("p",null,jobConfigErrorMessage?jobConfigErrorMessage:jobCapsServiceErrorMessage)))}return _react.default.createElement(_react.Fragment,null,isLoadingJobConfig===true&&jobConfig===undefined&&_react.default.createElement(_loading_panel.LoadingPanel,null),isLoadingJobConfig===false&&jobConfig!==undefined&&isInitialized===true&&_react.default.createElement(_evaluate_panel.EvaluatePanel,{jobConfig:jobConfig,jobStatus:jobStatus,searchQuery:searchQuery}),_react.default.createElement(_eui.EuiSpacer,null),isLoadingJobConfig===true&&jobConfig===undefined&&_react.default.createElement(_loading_panel.LoadingPanel,null),isLoadingJobConfig===false&&jobConfig!==undefined&&indexPattern!==undefined&&isInitialized===true&&_react.default.createElement(_results_table.ResultsTable,{jobConfig:jobConfig,indexPattern:indexPattern,jobStatus:jobStatus,setEvaluateSearchQuery:setSearchQuery}))};exports.RegressionExploration=RegressionExploration},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ErrorCallout",{enumerable:true,get:function get(){return _error_callout.ErrorCallout}});var _error_callout=__webpack_require__(1633)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ClassificationExploration=exports.ExplorationTitle=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _ml_api_service=__webpack_require__(51);var _evaluate_panel=__webpack_require__(1639);var _results_table=__webpack_require__(1641);var _analytics=__webpack_require__(76);var _loading_panel=__webpack_require__(267);var _index_utils=__webpack_require__(70);var _new_job_capabilities_service=__webpack_require__(66);var _ml=__webpack_require__(77);var _get_analytics=__webpack_require__(189);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ExplorationTitle=function ExplorationTitle(_ref){var jobId=_ref.jobId;return _react.default.createElement(_eui.EuiTitle,{size:"xs"},_react.default.createElement("span",null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.tableJobIdTitle",{defaultMessage:"Destination index for classification job ID {jobId}",values:{jobId:jobId}})))};exports.ExplorationTitle=ExplorationTitle;var jobConfigErrorTitle=_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.jobConfigurationFetchError",{defaultMessage:"Unable to fetch results. An error occurred loading the job configuration data."});var jobCapsErrorTitle=_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.jobCapsFetchError",{defaultMessage:"Unable to fetch results. An error occurred loading the index's field data."});var ClassificationExploration=function ClassificationExploration(_ref2){var jobId=_ref2.jobId;var _useState=(0,_react.useState)(undefined),_useState2=_slicedToArray(_useState,2),jobConfig=_useState2[0],setJobConfig=_useState2[1];var _useState3=(0,_react.useState)(undefined),_useState4=_slicedToArray(_useState3,2),jobStatus=_useState4[0],setJobStatus=_useState4[1];var _useState5=(0,_react.useState)(undefined),_useState6=_slicedToArray(_useState5,2),indexPattern=_useState6[0],setIndexPattern=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),isLoadingJobConfig=_useState8[0],setIsLoadingJobConfig=_useState8[1];var _useState9=(0,_react.useState)(false),_useState10=_slicedToArray(_useState9,2),isInitialized=_useState10[0],setIsInitialized=_useState10[1];var _useState11=(0,_react.useState)(undefined),_useState12=_slicedToArray(_useState11,2),jobConfigErrorMessage=_useState12[0],setJobConfigErrorMessage=_useState12[1];var _useState13=(0,_react.useState)(undefined),_useState14=_slicedToArray(_useState13,2),jobCapsServiceErrorMessage=_useState14[0],setJobCapsServiceErrorMessage=_useState14[1];var _useState15=(0,_react.useState)(_analytics.defaultSearchQuery),_useState16=_slicedToArray(_useState15,2),searchQuery=_useState16[0],setSearchQuery=_useState16[1];var mlContext=(0,_ml.useMlContext)();var loadJobConfig=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var analyticsConfigs,analyticsStats,stats;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoadingJobConfig(true);_context.prev=1;_context.next=4;return _ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalytics(jobId);case 4:analyticsConfigs=_context.sent;_context.next=7;return _ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(jobId);case 7:analyticsStats=_context.sent;stats=(0,_get_analytics.isGetDataFrameAnalyticsStatsResponseOk)(analyticsStats)?analyticsStats.data_frame_analytics[0]:undefined;if(stats!==undefined&&stats.state){setJobStatus(stats.state)}if(Array.isArray(analyticsConfigs.data_frame_analytics)&&analyticsConfigs.data_frame_analytics.length>0){setJobConfig(analyticsConfigs.data_frame_analytics[0]);setIsLoadingJobConfig(false)}else{setJobConfigErrorMessage(_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.jobConfigurationNoResultsMessage",{defaultMessage:"No results found."}))}_context.next=17;break;case 13:_context.prev=13;_context.t0=_context["catch"](1);if(_context.t0.message!==undefined){setJobConfigErrorMessage(_context.t0.message)}else{setJobConfigErrorMessage(JSON.stringify(_context.t0))}setIsLoadingJobConfig(false);case 17:case"end":return _context.stop()}}}),_callee,null,[[1,13]])})));return function loadJobConfig(){return _ref3.apply(this,arguments)}}();(0,_react.useEffect)((function(){loadJobConfig()}),[]);var initializeJobCapsService=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var destIndex,destIndexPatternId,indexP,sourceIndex,sourceIndexPatternId;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(jobConfig!==undefined)){_context2.next=29;break}_context2.prev=1;destIndex=Array.isArray(jobConfig.dest.index)?jobConfig.dest.index[0]:jobConfig.dest.index;destIndexPatternId=(0,_index_utils.getIndexPatternIdFromName)(destIndex)||destIndex;_context2.prev=4;_context2.next=7;return mlContext.indexPatterns.get(destIndexPatternId);case 7:indexP=_context2.sent;_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2["catch"](4);indexP=undefined;case 13:if(!(indexP===undefined)){_context2.next=19;break}sourceIndex=jobConfig.source.index[0];sourceIndexPatternId=(0,_index_utils.getIndexPatternIdFromName)(sourceIndex)||sourceIndex;_context2.next=18;return mlContext.indexPatterns.get(sourceIndexPatternId);case 18:indexP=_context2.sent;case 19:if(!(indexP!==undefined)){_context2.next=23;break}setIndexPattern(indexP);_context2.next=23;return _new_job_capabilities_service.newJobCapsService.initializeFromIndexPattern(indexP,false,false);case 23:setIsInitialized(true);_context2.next=29;break;case 26:_context2.prev=26;_context2.t1=_context2["catch"](1);if(_context2.t1.message!==undefined){setJobCapsServiceErrorMessage(_context2.t1.message)}else{setJobCapsServiceErrorMessage(JSON.stringify(_context2.t1))}case 29:case"end":return _context2.stop()}}}),_callee2,null,[[1,26],[4,10]])})));return function initializeJobCapsService(){return _ref4.apply(this,arguments)}}();(0,_react.useEffect)((function(){initializeJobCapsService()}),[jobConfig&&jobConfig.id]);if(jobConfigErrorMessage!==undefined||jobCapsServiceErrorMessage!==undefined){return _react.default.createElement(_eui.EuiPanel,{grow:false},_react.default.createElement(ExplorationTitle,{jobId:jobId}),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiCallOut,{title:jobConfigErrorMessage?jobConfigErrorTitle:jobCapsErrorTitle,color:"danger",iconType:"cross"},_react.default.createElement("p",null,jobConfigErrorMessage?jobConfigErrorMessage:jobCapsServiceErrorMessage)))}return _react.default.createElement(_react.Fragment,null,isLoadingJobConfig===true&&jobConfig===undefined&&_react.default.createElement(_loading_panel.LoadingPanel,null),isLoadingJobConfig===false&&jobConfig!==undefined&&isInitialized===true&&_react.default.createElement(_evaluate_panel.EvaluatePanel,{jobConfig:jobConfig,jobStatus:jobStatus,searchQuery:searchQuery}),_react.default.createElement(_eui.EuiSpacer,null),isLoadingJobConfig===true&&jobConfig===undefined&&_react.default.createElement(_loading_panel.LoadingPanel,null),isLoadingJobConfig===false&&jobConfig!==undefined&&indexPattern!==undefined&&isInitialized===true&&_react.default.createElement(_results_table.ResultsTable,{jobConfig:jobConfig,indexPattern:indexPattern,jobStatus:jobStatus,setEvaluateSearchQuery:setSearchQuery}))};exports.ClassificationExploration=ClassificationExploration},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnomaliesTable=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _lodash=_interopRequireDefault(__webpack_require__(49));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _anomalies_table_columns=__webpack_require__(1646);var _anomaly_details=__webpack_require__(1656);var _table_service=__webpack_require__(242);var _rule_editor=__webpack_require__(1657);var _ml_api_service=__webpack_require__(51);var _anomalies_table_constants=__webpack_require__(270);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var AnomaliesTable=function(_Component){_inherits(AnomaliesTable,_Component);function AnomaliesTable(props){var _this;_classCallCheck(this,AnomaliesTable);_this=_possibleConstructorReturn(this,_getPrototypeOf(AnomaliesTable).call(this,props));_defineProperty(_assertThisInitialized(_this),"isShowingAggregatedData",(function(){return _this.props.tableData.interval!=="second"}));_defineProperty(_assertThisInitialized(_this),"toggleRow",function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(item){var tab,itemIdToExpandedRowMap,examples,definition,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:tab=_args.length>1&&_args[1]!==undefined?_args[1]:_anomalies_table_constants.ANOMALIES_TABLE_TABS.DETAILS;itemIdToExpandedRowMap=_objectSpread({},_this.state.itemIdToExpandedRowMap);if(!itemIdToExpandedRowMap[item.rowId]){_context.next=6;break}delete itemIdToExpandedRowMap[item.rowId];_context.next=21;break;case 6:examples=item.entityName==="mlcategory"?_lodash.default.get(_this.props.tableData,["examplesByJobId",item.jobId,item.entityValue]):undefined;definition=undefined;if(!(examples!==undefined)){_context.next=20;break}_context.prev=9;_context.next=12;return _ml_api_service.ml.results.getCategoryDefinition(item.jobId,item.source.mlcategory[0]);case 12:definition=_context.sent;if(definition.terms&&definition.terms.length>_anomalies_table_constants.MAX_CHARS){definition.terms="".concat(definition.terms.substring(0,_anomalies_table_constants.MAX_CHARS),"...")}if(definition.regex&&definition.regex.length>_anomalies_table_constants.MAX_CHARS){definition.terms="".concat(definition.regex.substring(0,_anomalies_table_constants.MAX_CHARS),"...")}_context.next=20;break;case 17:_context.prev=17;_context.t0=_context["catch"](9);console.log("Error fetching category definition for row item.",_context.t0);case 20:itemIdToExpandedRowMap[item.rowId]=_react.default.createElement(_anomaly_details.AnomalyDetails,{tabIndex:tab,anomaly:item,examples:examples,definition:definition,isAggregatedData:_this.isShowingAggregatedData(),filter:_this.props.filter,influencerFilter:_this.props.influencerFilter,influencersLimit:_anomalies_table_constants.INFLUENCERS_LIMIT});case 21:_this.setState({itemIdToExpandedRowMap:itemIdToExpandedRowMap});case 22:case"end":return _context.stop()}}}),_callee,null,[[9,17]])})));return function(_x){return _ref.apply(this,arguments)}}());_defineProperty(_assertThisInitialized(_this),"onMouseOverRow",(function(record){if(_this.mouseOverRecord!==undefined){if(_this.mouseOverRecord.rowId!==record.rowId){_table_service.mlTableService.rowMouseleave$.next({record:_this.mouseOverRecord});_table_service.mlTableService.rowMouseenter$.next({record:record})}}else{_table_service.mlTableService.rowMouseenter$.next({record:record})}_this.mouseOverRecord=record}));_defineProperty(_assertThisInitialized(_this),"onMouseLeaveRow",(function(){if(_this.mouseOverRecord!==undefined){_table_service.mlTableService.rowMouseleave$.next({record:_this.mouseOverRecord});_this.mouseOverRecord=undefined}}));_defineProperty(_assertThisInitialized(_this),"setShowRuleEditorFlyoutFunction",(function(func){_this.setState({showRuleEditorFlyout:func})}));_defineProperty(_assertThisInitialized(_this),"unsetShowRuleEditorFlyoutFunction",(function(){var showRuleEditorFlyout=function showRuleEditorFlyout(){};_this.setState({showRuleEditorFlyout:showRuleEditorFlyout})}));_this.state={itemIdToExpandedRowMap:{},showRuleEditorFlyout:function showRuleEditorFlyout(){}};return _this}_createClass(AnomaliesTable,[{key:"render",value:function render(){var _this2=this;var _this$props=this.props,bounds=_this$props.bounds,tableData=_this$props.tableData,filter=_this$props.filter,influencerFilter=_this$props.influencerFilter;if(tableData===undefined||tableData.anomalies===undefined||tableData.anomalies.length===0){return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.noMatchingAnomaliesFoundTitle",defaultMessage:"No matching anomalies found"})))))}var columns=(0,_anomalies_table_columns.getColumns)(tableData.anomalies,tableData.jobIds,tableData.examplesByJobId,this.isShowingAggregatedData(),tableData.interval,bounds,tableData.showViewSeriesLink,this.state.showRuleEditorFlyout,this.state.itemIdToExpandedRowMap,this.toggleRow,filter,influencerFilter);var sorting={sort:{field:"severity",direction:"desc"}};var getRowProps=function getRowProps(item){return{onMouseOver:function onMouseOver(){return _this2.onMouseOverRow(item)},onMouseLeave:function onMouseLeave(){return _this2.onMouseLeaveRow()},"data-test-subj":"mlAnomaliesListRow row-".concat(item.rowId)}};return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_rule_editor.RuleEditorFlyout,{setShowFunction:this.setShowRuleEditorFlyoutFunction,unsetShowFunction:this.unsetShowRuleEditorFlyoutFunction}),_react.default.createElement(_eui.EuiInMemoryTable,{className:"ml-anomalies-table eui-textOverflowWrap",items:tableData.anomalies,columns:columns,pagination:{pageSizeOptions:[10,25,100],initialPageSize:25},sorting:sorting,itemId:"rowId",itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,compressed:true,rowProps:getRowProps,"data-test-subj":"mlAnomaliesTable"}))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(nextProps,prevState){var itemIdToExpandedRowMap=prevState.itemIdToExpandedRowMap;var prevExpandedNotInData=Object.keys(itemIdToExpandedRowMap).find((function(rowId){var matching=nextProps.tableData.anomalies.find((function(anomaly){return anomaly.rowId===rowId}));return matching===undefined}));if(prevExpandedNotInData!==undefined){return{itemIdToExpandedRowMap:{}}}return null}}]);return AnomaliesTable}(_react.Component);exports.AnomaliesTable=AnomaliesTable;AnomaliesTable.propTypes={bounds:_propTypes.default.object.isRequired,tableData:_propTypes.default.object,filter:_propTypes.default.func,influencerFilter:_propTypes.default.func}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DetectorDescriptionList",{enumerable:true,get:function get(){return _detector_description_list.DetectorDescriptionList}});var _detector_description_list=__webpack_require__(1659)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"mlChartTooltipService",{enumerable:true,get:function get(){return _chart_tooltip_service.mlChartTooltipService}});Object.defineProperty(exports,"ChartTooltip",{enumerable:true,get:function get(){return _chart_tooltip.ChartTooltip}});var _chart_tooltip_service=__webpack_require__(134);var _chart_tooltip=__webpack_require__(1671)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ForecastingModal=exports.ForecastingModalUI=exports.FORECAST_DURATION_MAX_DAYS=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _lodash=_interopRequireDefault(__webpack_require__(49));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _states=__webpack_require__(108);var _message_levels=__webpack_require__(519);var _job_utils=__webpack_require__(59);var _parse_interval=__webpack_require__(74);var _modal=__webpack_require__(1673);var _progress_states=__webpack_require__(271);var _ml_api_service=__webpack_require__(51);var _job_service=__webpack_require__(58);var _forecast_service=__webpack_require__(160);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _public=__webpack_require__(31);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var FORECAST_DURATION_MAX_DAYS=3650;exports.FORECAST_DURATION_MAX_DAYS=FORECAST_DURATION_MAX_DAYS;var FORECAST_JOB_MIN_VERSION="6.1.0";var FORECASTS_VIEW_MAX=5;var FORECAST_DURATION_MAX_MS=FORECAST_DURATION_MAX_DAYS*864e5;var WARN_NUM_PARTITIONS=100;var FORECAST_STATS_POLL_FREQUENCY=250;var WARN_NO_PROGRESS_MS=12e4;function getDefaultState(){return{isModalVisible:false,previousForecasts:[],isForecastRequested:false,forecastProgress:_progress_states.PROGRESS_STATES.UNSET,jobOpeningState:_progress_states.PROGRESS_STATES.UNSET,jobClosingState:_progress_states.PROGRESS_STATES.UNSET,newForecastDuration:"1d",isNewForecastDurationValid:true,newForecastDurationErrors:[],messages:[]}}var ForecastingModalUI=function(_Component){_inherits(ForecastingModalUI,_Component);function ForecastingModalUI(props){var _this;_classCallCheck(this,ForecastingModalUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(ForecastingModalUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"addMessage",(function(message,status){var clearFirst=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var msg={message:message,status:status};_this.setState((function(prevState){return{messages:clearFirst?[msg]:[].concat(_toConsumableArray(prevState.messages),[msg])}}))}));_defineProperty(_assertThisInitialized(_this),"viewForecast",(function(forecastId){_this.props.setForecastId(forecastId);_this.closeModal()}));_defineProperty(_assertThisInitialized(_this),"onNewForecastDurationChange",(function(event){var newForecastDurationErrors=[];var isNewForecastDurationValid=true;var duration=(0,_parse_interval.parseInterval)(event.target.value);if(duration===null){isNewForecastDurationValid=false;newForecastDurationErrors.push(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.invalidDurationFormatErrorMessage",{defaultMessage:"Invalid duration format"}))}else if(duration.asMilliseconds()>FORECAST_DURATION_MAX_MS){isNewForecastDurationValid=false;newForecastDurationErrors.push(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastDurationMustNotBeGreaterThanMaximumErrorMessage",{defaultMessage:"Forecast duration must not be greater than {maximumForecastDurationDays} days",values:{maximumForecastDurationDays:FORECAST_DURATION_MAX_DAYS}}))}else if(duration.asMilliseconds()===0){isNewForecastDurationValid=false;newForecastDurationErrors.push(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastDurationMustNotBeZeroErrorMessage",{defaultMessage:"Forecast duration must not be zero"}))}_this.setState({newForecastDuration:event.target.value,isNewForecastDurationValid:isNewForecastDurationValid,newForecastDurationErrors:newForecastDurationErrors})}));_defineProperty(_assertThisInitialized(_this),"checkJobStateAndRunForecast",(function(){_this.setState({isForecastRequested:true,messages:[]});if(_this.props.job.state===_states.JOB_STATE.CLOSED){_this.openJobAndRunForecast()}else{_this.runForecast(false)}}));_defineProperty(_assertThisInitialized(_this),"openJobAndRunForecast",(function(){_this.setState({jobOpeningState:_progress_states.PROGRESS_STATES.WAITING});_job_service.mlJobService.openJob(_this.props.job.job_id).then((function(){_this.setState({jobOpeningState:_progress_states.PROGRESS_STATES.DONE});_this.runForecast(true)})).catch((function(resp){console.log("Time series forecast modal - could not open job:",resp);_this.addMessage(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithOpeningJobBeforeRunningForecastErrorMessage",{defaultMessage:"Error opening job before running forecast"}),_message_levels.MESSAGE_LEVEL.ERROR);_this.setState({jobOpeningState:_progress_states.PROGRESS_STATES.ERROR})}))}));_defineProperty(_assertThisInitialized(_this),"runForecastErrorHandler",(function(resp,closeJob){_this.setState({forecastProgress:_progress_states.PROGRESS_STATES.ERROR});console.log("Time series forecast modal - error running forecast:",resp);if(resp&&resp.message){_this.addMessage(resp.message,_message_levels.MESSAGE_LEVEL.ERROR,true)}else{_this.addMessage(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.unexpectedResponseFromRunningForecastErrorMessage",{defaultMessage:"Unexpected response from running forecast. The request may have failed."}),_message_levels.MESSAGE_LEVEL.ERROR,true)}if(closeJob===true){_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.WAITING});_job_service.mlJobService.closeJob(_this.props.job.job_id).then((function(){_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.DONE})})).catch((function(response){console.log("Time series forecast modal - could not close job:",response);_this.addMessage(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithClosingJobErrorMessage",{defaultMessage:"Error closing job"}),_message_levels.MESSAGE_LEVEL.ERROR);_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.ERROR})}))}}));_defineProperty(_assertThisInitialized(_this),"runForecast",(function(closeJobAfterRunning){_this.setState({forecastProgress:0});var durationInSeconds=(0,_parse_interval.parseInterval)(_this.state.newForecastDuration).asSeconds();_forecast_service.mlForecastService.runForecast(_this.props.job.job_id,"".concat(durationInSeconds,"s")).then((function(resp){if(resp.forecast_id!==undefined){_this.waitForForecastResults(resp.forecast_id,closeJobAfterRunning)}else{_this.runForecastErrorHandler(resp,closeJobAfterRunning)}})).catch((function(resp){return _this.runForecastErrorHandler(resp,closeJobAfterRunning)}))}));_defineProperty(_assertThisInitialized(_this),"waitForForecastResults",(function(forecastId,closeJobAfterRunning){var previousProgress=0;var noProgressMs=0;_this.forecastChecker=setInterval((function(){_forecast_service.mlForecastService.getForecastRequestStats(_this.props.job,forecastId).then((function(resp){var progress=_lodash.default.get(resp,["stats","forecast_progress"],previousProgress);var status=_lodash.default.get(resp,["stats","forecast_status"]);if(progress>previousProgress){_this.setState({forecastProgress:Math.round(100*progress)})}var messages=_lodash.default.get(resp,["stats","forecast_messages"],[]);messages=messages.map((function(message){return{message:message,status:_message_levels.MESSAGE_LEVEL.WARNING}}));_this.setState({messages:messages});if(status===_states.FORECAST_REQUEST_STATE.FINISHED){clearInterval(_this.forecastChecker);if(closeJobAfterRunning===true){_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.WAITING});_job_service.mlJobService.closeJob(_this.props.job.job_id).then((function(){_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.DONE});_this.props.setForecastId(forecastId);_this.closeAfterRunningForecast()})).catch((function(response){console.log("Time series forecast modal - could not close job:",response);_this.addMessage(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithClosingJobAfterRunningForecastErrorMessage",{defaultMessage:"Error closing job after running forecast"}),_message_levels.MESSAGE_LEVEL.ERROR);_this.setState({jobClosingState:_progress_states.PROGRESS_STATES.ERROR});_this.props.setForecastId(forecastId)}))}else{_this.props.setForecastId(forecastId);_this.closeAfterRunningForecast()}}else{if(progress===previousProgress){noProgressMs+=FORECAST_STATS_POLL_FREQUENCY;if(noProgressMs>WARN_NO_PROGRESS_MS){console.log("Forecast request has not progressed for ".concat(WARN_NO_PROGRESS_MS,"ms. Cancelling check."));_this.addMessage(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.noProgressReportedForNewForecastErrorMessage",{defaultMessage:"No progress reported for the new forecast for {WarnNoProgressMs}ms."+"An error may have occurred whilst running the forecast.",values:{WarnNoProgressMs:WARN_NO_PROGRESS_MS}}),_message_levels.MESSAGE_LEVEL.ERROR);_this.props.setForecastId(forecastId);_this.setState({forecastProgress:_progress_states.PROGRESS_STATES.ERROR});clearInterval(_this.forecastChecker)}}else{if(progress>previousProgress){previousProgress=progress}noProgressMs=0}}})).catch((function(resp){console.log("Time series forecast modal - error loading stats of forecast from elasticsearch:",resp);_this.addMessage(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithLoadingStatsOfRunningForecastErrorMessage",{defaultMessage:"Error loading stats of running forecast."}),_message_levels.MESSAGE_LEVEL.ERROR);_this.setState({forecastProgress:_progress_states.PROGRESS_STATES.ERROR});clearInterval(_this.forecastChecker)}))}),FORECAST_STATS_POLL_FREQUENCY)}));_defineProperty(_assertThisInitialized(_this),"openModal",(function(){var job=_this.props.job;if(_typeof(job)==="object"){var timefilter=_this.props.kibana.services.data.query.timefilter.timefilter;var bounds=timefilter.getActiveBounds();var statusFinishedQuery={term:{forecast_status:_states.FORECAST_REQUEST_STATE.FINISHED}};_forecast_service.mlForecastService.getForecastsSummary(job,statusFinishedQuery,bounds.min.valueOf(),FORECASTS_VIEW_MAX).then((function(resp){_this.setState({previousForecasts:resp.forecasts})})).catch((function(resp){console.log("Time series forecast modal - error obtaining forecasts summary:",resp);_this.addMessage(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithObtainingListOfPreviousForecastsErrorMessage",{defaultMessage:"Error obtaining list of previous forecasts"}),_message_levels.MESSAGE_LEVEL.ERROR)}));var entityFieldNames=_this.props.entities.map((function(entity){return entity.fieldName}));if(entityFieldNames.length>0){_ml_api_service.ml.getCardinalityOfFields({index:job.datafeed_config.indices,fieldNames:entityFieldNames,query:job.datafeed_config.query,timeFieldName:job.data_description.time_field,earliestMs:job.data_counts.earliest_record_timestamp,latestMs:job.data_counts.latest_record_timestamp}).then((function(results){var numPartitions=1;Object.values(results).forEach((function(cardinality){numPartitions=numPartitions*cardinality}));if(numPartitions>WARN_NUM_PARTITIONS){_this.addMessage(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.dataContainsMorePartitionsMessage",{defaultMessage:"Note that this data contains more than {warnNumPartitions} "+"partitions so running a forecast may take a long time and consume a high amount of resource",values:{warnNumPartitions:WARN_NUM_PARTITIONS}}),_message_levels.MESSAGE_LEVEL.WARNING)}})).catch((function(resp){console.log("Time series forecast modal - error obtaining cardinality of fields:",resp)}))}_this.setState({isModalVisible:true})}}));_defineProperty(_assertThisInitialized(_this),"closeAfterRunningForecast",(function(){if(_this.state.messages.length===0){setTimeout((function(){_this.closeModal()}),1e3)}}));_defineProperty(_assertThisInitialized(_this),"closeModal",(function(){if(_this.forecastChecker!==null){clearInterval(_this.forecastChecker)}_this.setState(getDefaultState())}));_this.state=getDefaultState();_this.forecastChecker=null;return _this}_createClass(ForecastingModalUI,[{key:"render",value:function render(){var isForecastingDisabled=false;var forecastingDisabledMessage=null;var job=this.props.job;if(job!==undefined){var detector=job.analysis_config.detectors[this.props.detectorIndex];var overFieldName=detector.over_field_name;if(overFieldName!==undefined){isForecastingDisabled=true;forecastingDisabledMessage=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastingNotAvailableForPopulationDetectorsMessage",{defaultMessage:"Forecasting is not available for population detectors with an over field"})}else if((0,_job_utils.isJobVersionGte)(job,FORECAST_JOB_MIN_VERSION)===false){isForecastingDisabled=true;forecastingDisabledMessage=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastingOnlyAvailableForJobsCreatedInSpecifiedVersionMessage",{defaultMessage:"Forecasting is only available for jobs created in version {minVersion} or later",values:{minVersion:FORECAST_JOB_MIN_VERSION}})}}var forecastButton=_react.default.createElement(_eui.EuiButton,{onClick:this.openModal,isDisabled:isForecastingDisabled,fill:true,"data-test-subj":"mlSingleMetricViewerButtonForecast"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastButtonLabel",defaultMessage:"Forecast"}));return _react.default.createElement("div",null,isForecastingDisabled?_react.default.createElement(_eui.EuiToolTip,{position:"left",content:forecastingDisabledMessage},forecastButton):forecastButton,this.state.isModalVisible&&_react.default.createElement(_modal.Modal,{job:this.props.job,forecasts:this.state.previousForecasts,close:this.closeModal,viewForecast:this.viewForecast,runForecast:this.checkJobStateAndRunForecast,newForecastDuration:this.state.newForecastDuration,onNewForecastDurationChange:this.onNewForecastDurationChange,isNewForecastDurationValid:this.state.isNewForecastDurationValid,newForecastDurationErrors:this.state.newForecastDurationErrors,isForecastRequested:this.state.isForecastRequested,forecastProgress:this.state.forecastProgress,jobOpeningState:this.state.jobOpeningState,jobClosingState:this.state.jobClosingState,messages:this.state.messages}))}}]);return ForecastingModalUI}(_react.Component);exports.ForecastingModalUI=ForecastingModalUI;_defineProperty(ForecastingModalUI,"propTypes",{isDisabled:_propTypes.default.bool,job:_propTypes.default.object,detectorIndex:_propTypes.default.number,entities:_propTypes.default.array,setForecastId:_propTypes.default.func});var ForecastingModal=(0,_public.withKibana)(ForecastingModalUI);exports.ForecastingModal=ForecastingModal},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MESSAGE_LEVEL=void 0;var MESSAGE_LEVEL={ERROR:"error",INFO:"info",SUCCESS:"success",WARNING:"warning"};exports.MESSAGE_LEVEL=MESSAGE_LEVEL},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mlTimeSeriesSearchService=void 0;var _lodash=_interopRequireDefault(__webpack_require__(49));var _operators=__webpack_require__(6);var _ml_api_service=__webpack_require__(51);var _job_utils=__webpack_require__(59);var _chart_config_builder=__webpack_require__(521);var _results_service=__webpack_require__(132);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getMetricData(job,detectorIndex,entityFields,earliestMs,latestMs,interval){if((0,_job_utils.isModelPlotEnabled)(job,detectorIndex,entityFields)){var criteriaFields=[];var detector=job.analysis_config.detectors[detectorIndex];if(_lodash.default.has(detector,"partition_field_name")){var partitionEntity=_lodash.default.find(entityFields,{fieldName:detector.partition_field_name});if(partitionEntity!==undefined){criteriaFields.push({fieldName:"partition_field_name",fieldValue:partitionEntity.fieldName},{fieldName:"partition_field_value",fieldValue:partitionEntity.fieldValue})}}if(_lodash.default.has(detector,"over_field_name")){var overEntity=_lodash.default.find(entityFields,{fieldName:detector.over_field_name});if(overEntity!==undefined){criteriaFields.push({fieldName:"over_field_name",fieldValue:overEntity.fieldName},{fieldName:"over_field_value",fieldValue:overEntity.fieldValue})}}if(_lodash.default.has(detector,"by_field_name")){var byEntity=_lodash.default.find(entityFields,{fieldName:detector.by_field_name});if(byEntity!==undefined){criteriaFields.push({fieldName:"by_field_name",fieldValue:byEntity.fieldName},{fieldName:"by_field_value",fieldValue:byEntity.fieldValue})}}return _results_service.mlResultsService.getModelPlotOutput(job.job_id,detectorIndex,criteriaFields,earliestMs,latestMs,interval)}else{var obj={success:true,results:{}};var chartConfig=(0,_chart_config_builder.buildConfigFromDetector)(job,detectorIndex);return _results_service.mlResultsService.getMetricData(chartConfig.datafeedConfig.indices,entityFields,chartConfig.datafeedConfig.query,chartConfig.metricFunction,chartConfig.metricFieldName,chartConfig.timeField,earliestMs,latestMs,interval).pipe((0,_operators.map)((function(resp){_lodash.default.each(resp.results,(function(value,time){obj.results[time]={actual:value}}));return obj})))}}function getChartDetails(job,detectorIndex,entityFields,earliestMs,latestMs){return new Promise((function(resolve,reject){var obj={success:true,results:{functionLabel:"",entityData:{entities:[]}}};var chartConfig=(0,_chart_config_builder.buildConfigFromDetector)(job,detectorIndex);var functionLabel=chartConfig.metricFunction;if(chartConfig.metricFieldName!==undefined){functionLabel+=" ";functionLabel+=chartConfig.metricFieldName}obj.results.functionLabel=functionLabel;var blankEntityFields=_lodash.default.filter(entityFields,(function(entity){return entity.fieldValue===null}));if(blankEntityFields.length===0){obj.results.entityData.count=1;obj.results.entityData.entities=entityFields;resolve(obj)}else{var entityFieldNames=_lodash.default.map(blankEntityFields,"fieldName");_ml_api_service.ml.getCardinalityOfFields({index:chartConfig.datafeedConfig.indices,fieldNames:entityFieldNames,query:chartConfig.datafeedConfig.query,timeFieldName:chartConfig.timeField,earliestMs:earliestMs,latestMs:latestMs}).then((function(results){_lodash.default.each(blankEntityFields,(function(field){obj.results.entityData.entities.push({fieldName:field.fieldName,cardinality:_lodash.default.get(results,field.fieldName,0)})}));resolve(obj)})).catch((function(resp){reject(resp)}))}}))}var mlTimeSeriesSearchService={getMetricData:getMetricData,getChartDetails:getChartDetails};exports.mlTimeSeriesSearchService=mlTimeSeriesSearchService},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buildConfigFromDetector=buildConfigFromDetector;var _lodash=_interopRequireDefault(__webpack_require__(49));var _job_utils=__webpack_require__(59);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buildConfigFromDetector(job,detectorIndex){var analysisConfig=job.analysis_config;var detector=analysisConfig.detectors[detectorIndex];var config={jobId:job.job_id,detectorIndex:detectorIndex,metricFunction:(0,_job_utils.mlFunctionToESAggregation)(detector.function),timeField:job.data_description.time_field,interval:job.analysis_config.bucket_span,datafeedConfig:job.datafeed_config};if(detector.field_name!==undefined){config.metricFieldName=detector.field_name}var summaryCountFieldName=analysisConfig.summary_count_field_name;if(config.metricFunction==="count"&&summaryCountFieldName!==undefined&&summaryCountFieldName!=="doc_count"){var cardinalityField=undefined;var topAgg=_lodash.default.get(job.datafeed_config,"aggregations")||_lodash.default.get(job.datafeed_config,"aggs");if(topAgg!==undefined&&_lodash.default.values(topAgg).length>0){cardinalityField=_lodash.default.get(_lodash.default.values(topAgg)[0],["aggregations",summaryCountFieldName,"cardinality","field"])||_lodash.default.get(_lodash.default.values(topAgg)[0],["aggs",summaryCountFieldName,"cardinality","field"])}if(detector.function==="non_zero_count"&&cardinalityField!==undefined){config.metricFunction="cardinality";config.metricFieldName=cardinalityField}else{config.metricFunction="sum";config.metricFieldName=summaryCountFieldName}}return config}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeSeriesExplorerPage=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _job_selector=__webpack_require__(523);var _navigation_menu=__webpack_require__(82);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TimeSeriesExplorerPage=function TimeSeriesExplorerPage(_ref){var children=_ref.children,dateFormatTz=_ref.dateFormatTz,loading=_ref.loading,resizeRef=_ref.resizeRef;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"timeseriesexplorer"}),loading===true&&_react.default.createElement(_eui.EuiProgress,{className:"mlTimeSeriesExplorerProgress",color:"primary",size:"xs"}),loading===false&&_react.default.createElement(_eui.EuiProgress,{className:"mlTimeSeriesExplorerProgress",value:0,max:100,color:"primary",size:"xs"}),_react.default.createElement(_job_selector.JobSelector,{dateFormatTz:dateFormatTz,singleSelection:true,timeseriesOnly:true}),_react.default.createElement("div",{className:"ml-time-series-explorer",ref:resizeRef,"data-test-subj":"mlPageSingleMetricViewer"},_react.default.createElement(_eui.EuiPage,{style:{padding:"0px",background:"none"}},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiScreenReaderOnly,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.pageTitle",defaultMessage:"Single Metric Viewer"}))),children))))};exports.TimeSeriesExplorerPage=TimeSeriesExplorerPage},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobSelector",{enumerable:true,get:function get(){return _job_selector.JobSelector}});var _job_selector=__webpack_require__(1688)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"useTableInterval",{enumerable:true,get:function get(){return _select_interval.useTableInterval}});Object.defineProperty(exports,"SelectInterval",{enumerable:true,get:function get(){return _select_interval.SelectInterval}});var _select_interval=__webpack_require__(272)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"useTableSeverity",{enumerable:true,get:function get(){return _select_severity.useTableSeverity}});Object.defineProperty(exports,"SelectSeverity",{enumerable:true,get:function get(){return _select_severity.SelectSeverity}});Object.defineProperty(exports,"SEVERITY_OPTIONS",{enumerable:true,get:function get(){return _select_severity.SEVERITY_OPTIONS}});var _select_severity=__webpack_require__(273)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useRefresh=void 0;var _reactUse=__webpack_require__(236);var _rxjs=__webpack_require__(33);var _operators=__webpack_require__(6);var _annotations_service=__webpack_require__(159);var _timefilter_refresh_service=__webpack_require__(184);var refresh$=(0,_rxjs.merge)(_timefilter_refresh_service.mlTimefilterRefresh$,_timefilter_refresh_service.mlTimefilterTimeChange$,_annotations_service.annotationsRefresh$.pipe((0,_operators.map)((function(d){return{lastRefresh:d}}))));var useRefresh=function useRefresh(){return(0,_reactUse.useObservable)(refresh$)};exports.useRefresh=useRefresh},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"jobSelectionActionCreator",{enumerable:true,get:function get(){return _job_selection.jobSelectionActionCreator}});Object.defineProperty(exports,"useExplorerData",{enumerable:true,get:function get(){return _load_explorer_data.useExplorerData}});var _job_selection=__webpack_require__(1713);var _load_explorer_data=__webpack_require__(1714)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getIndexPattern=getIndexPattern;var _index_patterns=__webpack_require__(120);var _explorer_utils=__webpack_require__(93);function getIndexPattern(selectedJobs){return{title:_index_patterns.ML_RESULTS_INDEX_PATTERN,fields:(0,_explorer_utils.getInfluencers)(selectedJobs).map((function(influencer){return{name:influencer,type:"string",aggregatable:true,searchable:true}}))}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"useShowCharts",{enumerable:true,get:function get(){return _checkbox_showcharts.useShowCharts}});Object.defineProperty(exports,"CheckboxShowCharts",{enumerable:true,get:function get(){return _checkbox_showcharts.CheckboxShowCharts}});var _checkbox_showcharts=__webpack_require__(1728)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SelectLimit=exports.useSwimlaneLimit=exports.defaultLimit=exports.limit$=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _useObservable=_interopRequireDefault(__webpack_require__(129));var _rxjs=__webpack_require__(33);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var limitOptions=[5,10,25,50];var euiOptions=limitOptions.map((function(limit){return{value:limit,text:"".concat(limit)}}));var limit$=new _rxjs.Subject;exports.limit$=limit$;var defaultLimit=limitOptions[1];exports.defaultLimit=defaultLimit;var useSwimlaneLimit=function useSwimlaneLimit(){var limit=(0,_useObservable.default)(limit$,defaultLimit);return[limit,function(newLimit){return limit$.next(newLimit)}]};exports.useSwimlaneLimit=useSwimlaneLimit;var SelectLimit=function SelectLimit(){var _useSwimlaneLimit=useSwimlaneLimit(),_useSwimlaneLimit2=_slicedToArray(_useSwimlaneLimit,2),limit=_useSwimlaneLimit2[0],setLimit=_useSwimlaneLimit2[1];function onChange(e){setLimit(parseInt(e.target.value,10))}return _react.default.createElement(_eui.EuiSelect,{options:euiOptions,onChange:onChange,value:limit})};exports.SelectLimit=SelectLimit},,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"MlRouter",{enumerable:true,get:function get(){return _router.MlRouter}});Object.defineProperty(exports,"MlRoute",{enumerable:true,get:function get(){return _router.MlRoute}});var _router=__webpack_require__(67)},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _exportNames={timeSeriesExplorerRoute:true};Object.defineProperty(exports,"timeSeriesExplorerRoute",{enumerable:true,get:function get(){return _timeseriesexplorer.timeSeriesExplorerRoute}});var _overview=__webpack_require__(542);Object.keys(_overview).forEach((function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _overview[key]}})}));var _jobs_list=__webpack_require__(924);Object.keys(_jobs_list).forEach((function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _jobs_list[key]}})}));var _new_job=__webpack_require__(1250);Object.keys(_new_job).forEach((function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _new_job[key]}})}));var _datavisualizer=__webpack_require__(1439);Object.keys(_datavisualizer).forEach((function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _datavisualizer[key]}})}));var _settings=__webpack_require__(1535);Object.keys(_settings).forEach((function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _settings[key]}})}));var _data_frame_analytics=__webpack_require__(1586);Object.keys(_data_frame_analytics).forEach((function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _data_frame_analytics[key]}})}));var _timeseriesexplorer=__webpack_require__(1643);var _explorer=__webpack_require__(1701);Object.keys(_explorer).forEach((function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _explorer[key]}})}));var _access_denied=__webpack_require__(1751);Object.keys(_access_denied).forEach((function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _access_denied[key]}})}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.appRootRoute=exports.overviewRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _reactRouterDom=__webpack_require__(41);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _overview=__webpack_require__(880);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _ml_nodes_check=__webpack_require__(154);var _ml_server_info=__webpack_require__(84);var _kibana=__webpack_require__(57);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.overview.overviewLabel",{defaultMessage:"Overview"}),href:"#/overview"}];var overviewRoute={path:"/overview",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.overviewRoute=overviewRoute;var PageWrapper=function PageWrapper(_ref){var deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,{checkFullLicense:_license.checkFullLicense,checkGetJobsPrivilege:_check_privilege.checkGetJobsPrivilege,getMlNodeCount:_ml_nodes_check.getMlNodeCount,loadMlServerInfo:_ml_server_info.loadMlServerInfo}),context=_useResolver.context;(0,_kibana.useTimefilter)({timeRangeSelector:false,autoRefreshSelector:false});return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_overview.OverviewPage,null))};var appRootRoute={path:"/",render:function render(){return _react.default.createElement(Page,null)},breadcrumbs:[]};exports.appRootRoute=appRootRoute;var Page=function Page(){return _react.default.createElement(_reactRouterDom.Redirect,{to:"/overview"})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createSearchItems=createSearchItems;exports.checkCardinalitySuccess=checkCardinalitySuccess;var _public=__webpack_require__(63);var _search=__webpack_require__(99);var _index_utils=__webpack_require__(70);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function createSearchItems(kibanaConfig,indexPattern,savedSearch){var query={query:"",language:"lucene"};var combinedQuery={bool:{must:[{match_all:{}}]}};if(savedSearch!==null){var data=(0,_index_utils.getQueryFromSavedSearch)(savedSearch);query=data.query;var filter=data.filter;var filters=Array.isArray(filter)?filter:[];if(query.language===_search.SEARCH_QUERY_LANGUAGE.KUERY){var ast=_public.esKuery.fromKueryExpression(query.query);if(query.query!==""){combinedQuery=_public.esKuery.toElasticsearchQuery(ast,indexPattern)}var filterQuery=_public.esQuery.buildQueryFromFilters(filters,indexPattern);if(combinedQuery.bool.filter===undefined){combinedQuery.bool.filter=[]}if(combinedQuery.bool.must_not===undefined){combinedQuery.bool.must_not=[]}combinedQuery.bool.filter=[].concat(_toConsumableArray(combinedQuery.bool.filter),_toConsumableArray(filterQuery.filter));combinedQuery.bool.must_not=[].concat(_toConsumableArray(combinedQuery.bool.must_not),_toConsumableArray(filterQuery.must_not))}else{var esQueryConfigs=_public.esQuery.getEsQueryConfig(kibanaConfig);combinedQuery=_public.esQuery.buildEsQuery(indexPattern,[query],filters,esQueryConfigs)}}return{query:query,combinedQuery:combinedQuery}}function checkCardinalitySuccess(data){var response={success:true};if(Array.isArray(data)&&data.length===0){return response}for(var i=0;i<data.length;i++){if(data[i].id==="success_cardinality"){break}if(data[i].id==="cardinality_model_plot_high"){response.success=false;response.highCardinality=data[i].modelPlotCardinality;break}}return response}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"OverviewPage",{enumerable:true,get:function get(){return _overview_page.OverviewPage}});var _overview_page=__webpack_require__(881)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.OverviewPage=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _check_privilege=__webpack_require__(56);var _check_ml_nodes=__webpack_require__(81);var _navigation_menu=__webpack_require__(82);var _sidebar=__webpack_require__(896);var _content=__webpack_require__(897);var _node_available_warning=__webpack_require__(234);var _upgrade=__webpack_require__(235);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var OverviewPage=function OverviewPage(){var disableCreateAnomalyDetectionJob=!(0,_check_privilege.checkPermission)("canCreateJob")||!(0,_check_ml_nodes.mlNodesAvailable)();var disableCreateAnalyticsButton=!(0,_check_ml_nodes.mlNodesAvailable)()||!(0,_check_privilege.checkPermission)("canCreateDataFrameAnalytics")||!(0,_check_privilege.checkPermission)("canStartStopDataFrameAnalytics");return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"overview"}),_react.default.createElement(_eui.EuiPage,{"data-test-subj":"mlPageOverview"},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_node_available_warning.NodeAvailableWarning,null),_react.default.createElement(_upgrade.UpgradeWarning,null),_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_sidebar.OverviewSideBar,{createAnomalyDetectionJobDisabled:disableCreateAnomalyDetectionJob}),_react.default.createElement(_content.OverviewContent,{createAnomalyDetectionJobDisabled:disableCreateAnomalyDetectionJob,createAnalyticsJobDisabled:disableCreateAnalyticsButton})))))};exports.OverviewPage=OverviewPage},,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NavigationMenu=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _license=__webpack_require__(73);var _top_nav=__webpack_require__(891);var _main_tabs=__webpack_require__(894);var _tabs=__webpack_require__(895);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var tabSupport={overview:null,jobs:"anomaly_detection",settings:"anomaly_detection",data_frame_analytics:null,datavisualizer:null,filedatavisualizer:null,timeseriesexplorer:"anomaly_detection","access-denied":null,explorer:"anomaly_detection"};var NavigationMenu=function NavigationMenu(_ref){var tabId=_ref.tabId;var disableLinks=(0,_license.isFullLicense)()===false;var showTabs=typeof tabSupport[tabId]!=="undefined";var mainTabId=tabSupport[tabId]||tabId;var showHorizontalRule=tabSupport[tabId]===null;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},showTabs&&_react.default.createElement(_main_tabs.MainTabs,{tabId:mainTabId,disableLinks:disableLinks})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_top_nav.TopNav,null))),showHorizontalRule&&_react.default.createElement(_eui.EuiHorizontalRule,{className:"mlNavHorizontalRule"}),showTabs&&_react.default.createElement(_tabs.Tabs,{tabId:tabId,mainTabId:mainTabId,disableLinks:disableLinks}))};exports.NavigationMenu=NavigationMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"TopNav",{enumerable:true,get:function get(){return _top_nav.TopNav}});var _top_nav=__webpack_require__(892)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TopNav=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _rxjs=__webpack_require__(33);var _eui=__webpack_require__(29);var _timefilter_refresh_service=__webpack_require__(184);var _url_state=__webpack_require__(88);var _kibana=__webpack_require__(57);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function getRecentlyUsedRangesFactory(timeHistory){return function(){var _ref,_timeHistory$get;return(_ref=(_timeHistory$get=timeHistory.get())===null||_timeHistory$get===void 0?void 0:_timeHistory$get.map((function(_ref2){var from=_ref2.from,to=_ref2.to;return{start:from,end:to}})))!==null&&_ref!==void 0?_ref:[]}}function updateLastRefresh(timeRange){_timefilter_refresh_service.mlTimefilterRefresh$.next({lastRefresh:Date.now(),timeRange:timeRange})}var TopNav=function TopNav(){var _ref3;var _useMlKibana=(0,_kibana.useMlKibana)(),services=_useMlKibana.services;var config=services.uiSettings;var _services$data$query$=services.data.query.timefilter,timefilter=_services$data$query$.timefilter,history=_services$data$query$.history;var _useUrlState=(0,_url_state.useUrlState)("_g"),_useUrlState2=_slicedToArray(_useUrlState,2),globalState=_useUrlState2[0],setGlobalState=_useUrlState2[1];var getRecentlyUsedRanges=getRecentlyUsedRangesFactory(history);var _useState=(0,_react.useState)((_ref3=globalState===null||globalState===void 0?void 0:globalState.refreshInterval)!==null&&_ref3!==void 0?_ref3:timefilter.getRefreshInterval()),_useState2=_slicedToArray(_useState,2),refreshInterval=_useState2[0],setRefreshInterval=_useState2[1];(0,_react.useEffect)((function(){setGlobalState({refreshInterval:refreshInterval});timefilter.setRefreshInterval(refreshInterval)}),[refreshInterval===null||refreshInterval===void 0?void 0:refreshInterval.pause,refreshInterval===null||refreshInterval===void 0?void 0:refreshInterval.value]);var _useState3=(0,_react.useState)(timefilter.getTime()),_useState4=_slicedToArray(_useState3,2),time=_useState4[0],setTime=_useState4[1];var _useState5=(0,_react.useState)(getRecentlyUsedRanges()),_useState6=_slicedToArray(_useState5,2),recentlyUsedRanges=_useState6[0],setRecentlyUsedRanges=_useState6[1];var _useState7=(0,_react.useState)(timefilter.isAutoRefreshSelectorEnabled()),_useState8=_slicedToArray(_useState7,2),isAutoRefreshSelectorEnabled=_useState8[0],setIsAutoRefreshSelectorEnabled=_useState8[1];var _useState9=(0,_react.useState)(timefilter.isTimeRangeSelectorEnabled()),_useState10=_slicedToArray(_useState9,2),isTimeRangeSelectorEnabled=_useState10[0],setIsTimeRangeSelectorEnabled=_useState10[1];var dateFormat=config.get("dateFormat");(0,_react.useEffect)((function(){var subscriptions=new _rxjs.Subscription;var refreshIntervalUpdate$=timefilter.getRefreshIntervalUpdate$();if(refreshIntervalUpdate$!==undefined){subscriptions.add(refreshIntervalUpdate$.subscribe(timefilterUpdateListener))}var timeUpdate$=timefilter.getTimeUpdate$();if(timeUpdate$!==undefined){subscriptions.add(timeUpdate$.subscribe(timefilterUpdateListener))}var enabledUpdated$=timefilter.getEnabledUpdated$();if(enabledUpdated$!==undefined){subscriptions.add(enabledUpdated$.subscribe(timefilterUpdateListener))}return function cleanup(){subscriptions.unsubscribe()}}),[]);(0,_react.useEffect)((function(){timefilterUpdateListener()}),[isTimeRangeSelectorEnabled,isAutoRefreshSelectorEnabled]);function timefilterUpdateListener(){setTime(timefilter.getTime());setRefreshInterval(timefilter.getRefreshInterval());setIsAutoRefreshSelectorEnabled(timefilter.isAutoRefreshSelectorEnabled());setIsTimeRangeSelectorEnabled(timefilter.isTimeRangeSelectorEnabled())}function updateFilter(_ref4){var start=_ref4.start,end=_ref4.end;var newTime={from:start,to:end};timefilter.setTime(newTime);setTime(newTime);setRecentlyUsedRanges(getRecentlyUsedRanges());_timefilter_refresh_service.mlTimefilterTimeChange$.next({lastRefresh:Date.now(),timeRange:{start:start,end:end}})}function updateInterval(_ref5){var pause=_ref5.isPaused,value=_ref5.refreshInterval;setRefreshInterval({pause:pause,value:value})}return _react.default.createElement(_react.Fragment,null,(isAutoRefreshSelectorEnabled||isTimeRangeSelectorEnabled)&&_react.default.createElement("div",{className:"mlNavigationMenu__topNav"},_react.default.createElement(_eui.EuiSuperDatePicker,{start:time.from,end:time.to,isPaused:refreshInterval.pause,isAutoRefreshOnly:!isTimeRangeSelectorEnabled,refreshInterval:refreshInterval.value,onTimeChange:updateFilter,onRefresh:updateLastRefresh,onRefreshChange:updateInterval,recentlyUsedRanges:recentlyUsedRanges,dateFormat:dateFormat})))};exports.TopNav=TopNav},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MainTabs=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _risonNode=__webpack_require__(100);var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _url_state=__webpack_require__(88);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function getTabs(disableLinks){return[{id:"overview",name:_i18n.i18n.translate("xpack.ml.navMenu.overviewTabLinkText",{defaultMessage:"Overview"}),disabled:disableLinks},{id:"anomaly_detection",name:_i18n.i18n.translate("xpack.ml.navMenu.anomalyDetectionTabLinkText",{defaultMessage:"Anomaly Detection"}),disabled:disableLinks},{id:"data_frame_analytics",name:_i18n.i18n.translate("xpack.ml.navMenu.dataFrameAnalyticsTabLinkText",{defaultMessage:"Data Frame Analytics"}),disabled:disableLinks},{id:"datavisualizer",name:_i18n.i18n.translate("xpack.ml.navMenu.dataVisualizerTabLinkText",{defaultMessage:"Data Visualizer"}),disabled:false}]}var TAB_DATA={overview:{testSubject:"mlMainTab overview",pathId:"overview"},anomaly_detection:{testSubject:"mlMainTab anomalyDetection",pathId:"jobs"},data_frame_analytics:{testSubject:"mlMainTab dataFrameAnalytics"},datavisualizer:{testSubject:"mlMainTab dataVisualizer"}};var MainTabs=function MainTabs(_ref){var tabId=_ref.tabId,disableLinks=_ref.disableLinks;var _useUrlState=(0,_url_state.useUrlState)("_g"),_useUrlState2=_slicedToArray(_useUrlState,1),globalState=_useUrlState2[0];var _useState=(0,_react.useState)(tabId),_useState2=_slicedToArray(_useState,2),selectedTabId=_useState2[0],setSelectedTabId=_useState2[1];function onSelectedTabChanged(id){setSelectedTabId(id)}var tabs=getTabs(disableLinks);return _react.default.createElement(_eui.EuiTabs,{display:"condensed"},tabs.map((function(tab){var id=tab.id,disabled=tab.disabled;var testSubject=TAB_DATA[id].testSubject;var defaultPathId=TAB_DATA[id].pathId||id;var fullGlobalStateString=globalState!==undefined?"?_g=".concat((0,_risonNode.encode)(globalState)):"";return disabled?_react.default.createElement(_eui.EuiTab,{key:"".concat(id,"-key"),className:"mlNavigationMenu__mainTab",disabled:true},tab.name):_react.default.createElement(_eui.EuiLink,{"data-test-subj":testSubject+(id===selectedTabId?" selected":""),href:"#/".concat(defaultPathId).concat(fullGlobalStateString),key:"".concat(id,"-key"),color:"text"},_react.default.createElement(_eui.EuiTab,{className:"mlNavigationMenu__mainTab",onClick:function onClick(){return onSelectedTabChanged(id)},isSelected:id===selectedTabId},tab.name))})))};exports.MainTabs=MainTabs},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getTabs=getTabs;exports.Tabs=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _risonNode=__webpack_require__(100);var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _url_state=__webpack_require__(88);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function getTabs(tabId,disableLinks){var TAB_MAP={overview:[],datavisualizer:[],data_frame_analytics:[],anomaly_detection:[{id:"jobs",name:_i18n.i18n.translate("xpack.ml.navMenu.jobManagementTabLinkText",{defaultMessage:"Job Management"}),disabled:disableLinks},{id:"explorer",name:_i18n.i18n.translate("xpack.ml.navMenu.anomalyExplorerTabLinkText",{defaultMessage:"Anomaly Explorer"}),disabled:disableLinks},{id:"timeseriesexplorer",name:_i18n.i18n.translate("xpack.ml.navMenu.singleMetricViewerTabLinkText",{defaultMessage:"Single Metric Viewer"}),disabled:disableLinks},{id:"settings",name:_i18n.i18n.translate("xpack.ml.navMenu.settingsTabLinkText",{defaultMessage:"Settings"}),disabled:disableLinks}]};return TAB_MAP[tabId]||[]}var TAB_TEST_SUBJECT;(function(TAB_TEST_SUBJECT){TAB_TEST_SUBJECT["overview"]="mlOverview";TAB_TEST_SUBJECT["jobs"]="mlSubTab jobManagement";TAB_TEST_SUBJECT["explorer"]="mlSubTab anomalyExplorer";TAB_TEST_SUBJECT["timeseriesexplorer"]="mlSubTab singleMetricViewer";TAB_TEST_SUBJECT["settings"]="mlSubTab settings"})(TAB_TEST_SUBJECT||(TAB_TEST_SUBJECT={}));var Tabs=function Tabs(_ref){var tabId=_ref.tabId,mainTabId=_ref.mainTabId,disableLinks=_ref.disableLinks;var _useUrlState=(0,_url_state.useUrlState)("_g"),_useUrlState2=_slicedToArray(_useUrlState,1),globalState=_useUrlState2[0];var _useState=(0,_react.useState)(tabId),_useState2=_slicedToArray(_useState,2),selectedTabId=_useState2[0],setSelectedTabId=_useState2[1];function onSelectedTabChanged(id){setSelectedTabId(id)}var tabs=getTabs(mainTabId,disableLinks);if(tabs.length===0)return null;return _react.default.createElement(_eui.EuiTabs,{size:"s",className:tabId==="settings"?"mlSubTabs":""},tabs.map((function(tab){var id=tab.id;var fullGlobalStateString=globalState!==undefined?"?_g=".concat((0,_risonNode.encode)(globalState)):"";return _react.default.createElement(_eui.EuiLink,{"data-test-subj":TAB_TEST_SUBJECT[id]+(id===selectedTabId?" selected":""),href:"#/".concat(id).concat(fullGlobalStateString),key:"".concat(id,"-key"),color:"text"},_react.default.createElement(_eui.EuiTab,{className:"mlNavigationMenu__tab",onClick:function onClick(){return onSelectedTabChanged(id)},isSelected:id===selectedTabId,disabled:tab.disabled},tab.name))})))};exports.Tabs=Tabs},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.OverviewSideBar=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _kibana=__webpack_require__(57);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var createJobLink="#/jobs/new_job/step/index_or_search";var feedbackLink="https://www.elastic.co/community/";var whatIsMachineLearningLink="https://www.elastic.co/what-is/elasticsearch-machine-learning";function getCreateJobLink(createAnomalyDetectionJobDisabled){return createAnomalyDetectionJobDisabled===true?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionCreateJob",defaultMessage:"creating a new job"}):_react.default.createElement(_eui.EuiLink,{href:createJobLink,target:"blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionCreateJob",defaultMessage:"creating a new job"}))}var OverviewSideBar=function OverviewSideBar(_ref){var createAnomalyDetectionJobDisabled=_ref.createAnomalyDetectionJobDisabled;var _useMlKibana=(0,_kibana.useMlKibana)(),_useMlKibana$services=_useMlKibana.services,docLinks=_useMlKibana$services.docLinks,basePath=_useMlKibana$services.http.basePath;var ELASTIC_WEBSITE_URL=docLinks.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=docLinks.DOC_LINK_VERSION;var docsLink="".concat(ELASTIC_WEBSITE_URL,"guide/en/kibana/").concat(DOC_LINK_VERSION,"/xpack-ml.html");var transformsLink="".concat(basePath.get(),"/app/kibana#/management/elasticsearch/transform");return _react.default.createElement(_eui.EuiFlexItem,{grow:1},_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionTitle",defaultMessage:"Getting started"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiText,{className:"mlOverview__sidebar"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionText",defaultMessage:"Welcome to Machine Learning. Get started by reviewing our {docs} or {createJob}. For more information about machine learning in the Elastic stack please see {whatIsMachineLearning}. We recommend using {transforms} to create feature indices for analytics jobs.",values:{docs:_react.default.createElement(_eui.EuiLink,{href:docsLink,target:"blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionDocs",defaultMessage:"documentation"})),createJob:getCreateJobLink(createAnomalyDetectionJobDisabled),transforms:_react.default.createElement(_eui.EuiLink,{href:transformsLink,target:"blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionTransforms",defaultMessage:"Elasticsearch's transforms"})),whatIsMachineLearning:_react.default.createElement(_eui.EuiLink,{href:whatIsMachineLearningLink,target:"blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionWhatIsMachineLearning",defaultMessage:"here"}))}})),_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.overview.feedbackSectionTitle",defaultMessage:"Feedback"})),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.overview.feedbackSectionText",defaultMessage:"If you have input or suggestions regarding your experience with Machine Learning please feel free to submit {feedbackLink}.",values:{feedbackLink:_react.default.createElement(_eui.EuiLink,{href:feedbackLink,target:"blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.overview.feedbackSectionLink",defaultMessage:"feedback online"}))}}))))};exports.OverviewSideBar=OverviewSideBar},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.OverviewContent=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _anomaly_detection_panel=__webpack_require__(898);var _analytics_panel=__webpack_require__(912);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var OverviewContent=function OverviewContent(_ref){var createAnomalyDetectionJobDisabled=_ref.createAnomalyDetectionJobDisabled,createAnalyticsJobDisabled=_ref.createAnalyticsJobDisabled;return _react.default.createElement(_eui.EuiFlexItem,{grow:3},_react.default.createElement(_eui.EuiFlexGroup,{direction:"column"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_anomaly_detection_panel.AnomalyDetectionPanel,{jobCreationDisabled:createAnomalyDetectionJobDisabled})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_analytics_panel.AnalyticsPanel,{jobCreationDisabled:createAnalyticsJobDisabled}))))};exports.OverviewContent=OverviewContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AnomalyDetectionPanel",{enumerable:true,get:function get(){return _anomaly_detection_panel.AnomalyDetectionPanel}});var _anomaly_detection_panel=__webpack_require__(899)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnomalyDetectionPanel=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _moment=_interopRequireDefault(__webpack_require__(32));var _kibana=__webpack_require__(57);var _table=__webpack_require__(900);var _ml_api_service=__webpack_require__(51);var _utils=__webpack_require__(386);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var createJobLink="#/jobs/new_job/step/index_or_search";function getDefaultAnomalyScores(groups){var anomalyScores={};groups.forEach((function(group){anomalyScores[group.id]={maxScore:0}}));return anomalyScores}var AnomalyDetectionPanel=function AnomalyDetectionPanel(_ref){var jobCreationDisabled=_ref.jobCreationDisabled;var _useMlKibana=(0,_kibana.useMlKibana)(),notifications=_useMlKibana.services.notifications;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=(0,_react.useState)({}),_useState4=_slicedToArray(_useState3,2),groups=_useState4[0],setGroups=_useState4[1];var _useState5=(0,_react.useState)(0),_useState6=_slicedToArray(_useState5,2),groupsCount=_useState6[0],setGroupsCount=_useState6[1];var _useState7=(0,_react.useState)([]),_useState8=_slicedToArray(_useState7,2),jobsList=_useState8[0],setJobsList=_useState8[1];var _useState9=(0,_react.useState)(undefined),_useState10=_slicedToArray(_useState9,2),statsBarData=_useState10[0],setStatsBarData=_useState10[1];var _useState11=(0,_react.useState)(undefined),_useState12=_slicedToArray(_useState11,2),errorMessage=_useState12[0],setErrorMessage=_useState12[1];var loadJobs=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var jobsResult,jobsSummaryList,_getGroupsFromJobs,jobsGroups,count,jobsWithTimerange,stats;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.prev=1;_context.next=4;return _ml_api_service.ml.jobs.jobsSummary([]);case 4:jobsResult=_context.sent;jobsSummaryList=jobsResult.map((function(job){job.latestTimestampSortValue=job.latestTimestampMs||0;return job}));_getGroupsFromJobs=(0,_utils.getGroupsFromJobs)(jobsSummaryList),jobsGroups=_getGroupsFromJobs.groups,count=_getGroupsFromJobs.count;jobsWithTimerange=(0,_utils.getJobsWithTimerange)(jobsSummaryList);stats=(0,_utils.getStatsBarData)(jobsSummaryList);setIsLoading(false);setErrorMessage(undefined);setStatsBarData(stats);setGroupsCount(count);setGroups(jobsGroups);setJobsList(jobsWithTimerange);loadMaxAnomalyScores(jobsGroups);_context.next=22;break;case 18:_context.prev=18;_context.t0=_context["catch"](1);setErrorMessage(_context.t0.message!==undefined?_context.t0.message:JSON.stringify(_context.t0));setIsLoading(false);case 22:case"end":return _context.stop()}}}),_callee,null,[[1,18]])})));return function loadJobs(){return _ref2.apply(this,arguments)}}();var loadMaxAnomalyScores=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(groupsObject){var groupsList,scores,promises,results,tempGroups,toasts;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:groupsList=Object.values(groupsObject);scores=getDefaultAnomalyScores(groupsList);_context2.prev=2;promises=groupsList.filter((function(group){return group.jobIds.length>0})).map((function(group,i){scores[group.id].index=i;var latestTimestamp=group.latest_timestamp;var startMoment=(0,_moment.default)(latestTimestamp);var twentyFourHoursAgo=startMoment.subtract(24,"hours").valueOf();return _ml_api_service.ml.results.getMaxAnomalyScore(group.jobIds,twentyFourHoursAgo,latestTimestamp)}));_context2.next=6;return Promise.all(promises);case 6:results=_context2.sent;tempGroups=_objectSpread({},groupsObject);Object.keys(scores).forEach((function(groupId){var resultsIndex=scores[groupId]&&scores[groupId].index;var _ref4=resultsIndex!==undefined&&results[resultsIndex],maxScore=_ref4.maxScore;tempGroups[groupId].max_anomaly_score=maxScore}));setGroups(tempGroups);_context2.next=16;break;case 12:_context2.prev=12;_context2.t0=_context2["catch"](2);toasts=notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.errorWithFetchingAnomalyScoreNotificationErrorMessage",{defaultMessage:"An error occurred fetching anomaly scores: {error}",values:{error:_context2.t0.message!==undefined?_context2.t0.message:JSON.stringify(_context2.t0)}}));case 16:case"end":return _context2.stop()}}}),_callee2,null,[[2,12]])})));return function loadMaxAnomalyScores(_x){return _ref3.apply(this,arguments)}}();(0,_react.useEffect)((function(){loadJobs()}),[]);var onRefresh=function onRefresh(){loadJobs()};var errorDisplay=_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.errorPromptTitle",{defaultMessage:"An error occurred getting the anomaly detection jobs list."}),color:"danger",iconType:"alert"},_react.default.createElement("pre",null,errorMessage)));var panelClass=isLoading?"mlOverviewPanel__isLoading":"mlOverviewPanel";return _react.default.createElement(_eui.EuiPanel,{className:panelClass},typeof errorMessage!=="undefined"&&errorDisplay,isLoading&&_react.default.createElement(_eui.EuiLoadingSpinner,{className:"mlOverviewPanel__spinner",size:"xl"}),"   ",isLoading===false&&typeof errorMessage==="undefined"&&groupsCount===0&&_react.default.createElement(_eui.EuiEmptyPrompt,{iconType:"createSingleMetricJob",title:_react.default.createElement("h2",null,_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.createFirstJobMessage",{defaultMessage:"Create your first anomaly detection job"})),body:_react.default.createElement(_react.Fragment,null,_react.default.createElement("p",null,_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.emptyPromptText",{defaultMessage:"Machine learning makes it easy to detect anomalies in time series data stored in Elasticsearch. Track one metric from a single machine or hundreds of metrics across thousands of machines. Start automatically spotting the anomalies hiding in your data and resolve issues faster."}))),actions:_react.default.createElement(_eui.EuiButton,{color:"primary",href:createJobLink,fill:true,iconType:"plusInCircle",isDisabled:jobCreationDisabled},_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.createJobButtonText",{defaultMessage:"Create job"}))}),isLoading===false&&typeof errorMessage==="undefined"&&groupsCount>0&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_table.AnomalyDetectionTable,{items:groups,jobsList:jobsList,statsBarData:statsBarData}),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement("div",{className:"mlOverviewPanel__buttons"},_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",onClick:onRefresh,className:"mlOverviewPanel__refreshButton"},_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.refreshJobsButtonText",{defaultMessage:"Refresh"})),_react.default.createElement(_eui.EuiButton,{size:"s",fill:true,href:"#/jobs?"},_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.manageJobsButtonText",{defaultMessage:"Manage jobs"})))))};exports.AnomalyDetectionPanel=AnomalyDetectionPanel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnomalyDetectionTable=exports.AnomalyDetectionListColumns=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _ml_in_memory_table=__webpack_require__(127);var _date_utils=__webpack_require__(83);var _actions=__webpack_require__(902);var _utils=__webpack_require__(386);var _stats_bar=__webpack_require__(186);var _index=__webpack_require__(187);var _string_utils=__webpack_require__(80);var _anomaly_utils=__webpack_require__(75);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var MlInMemoryTable=(0,_ml_in_memory_table.mlInMemoryTableFactory)();var AnomalyDetectionListColumns;exports.AnomalyDetectionListColumns=AnomalyDetectionListColumns;(function(AnomalyDetectionListColumns){AnomalyDetectionListColumns["id"]="id";AnomalyDetectionListColumns["maxAnomalyScore"]="max_anomaly_score";AnomalyDetectionListColumns["jobIds"]="jobIds";AnomalyDetectionListColumns["latestTimestamp"]="latest_timestamp";AnomalyDetectionListColumns["docsProcessed"]="docs_processed";AnomalyDetectionListColumns["jobsInGroup"]="jobs_in_group"})(AnomalyDetectionListColumns||(exports.AnomalyDetectionListColumns=AnomalyDetectionListColumns={}));var AnomalyDetectionTable=function AnomalyDetectionTable(_ref){var items=_ref.items,jobsList=_ref.jobsList,statsBarData=_ref.statsBarData;var groupsList=Object.values(items);var _useState=(0,_react.useState)(0),_useState2=_slicedToArray(_useState,2),pageIndex=_useState2[0],setPageIndex=_useState2[1];var _useState3=(0,_react.useState)(10),_useState4=_slicedToArray(_useState3,2),pageSize=_useState4[0],setPageSize=_useState4[1];var _useState5=(0,_react.useState)(AnomalyDetectionListColumns.id),_useState6=_slicedToArray(_useState5,2),sortField=_useState6[0],setSortField=_useState6[1];var _useState7=(0,_react.useState)(_ml_in_memory_table.SORT_DIRECTION.ASC),_useState8=_slicedToArray(_useState7,2),sortDirection=_useState8[0],setSortDirection=_useState8[1];var columns=[{field:AnomalyDetectionListColumns.id,name:_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.tableId",{defaultMessage:"Group ID"}),render:function render(id){return _react.default.createElement(_index.JobSelectorBadge,{id:id,isGroup:id!=="ungrouped"})},sortable:true,truncateText:true,width:"20%"},{field:AnomalyDetectionListColumns.maxAnomalyScore,name:_react.default.createElement(_eui.EuiToolTip,{content:_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.tableMaxScoreTooltip",{defaultMessage:"Maximum score across all jobs in the group over its most recent 24 hour period"})},_react.default.createElement("span",null,_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.tableMaxScore",{defaultMessage:"Max anomaly score"})," ",_react.default.createElement(_eui.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:true,render:function render(score){if(score===undefined){return _react.default.createElement(_eui.EuiLoadingSpinner,null)}else if(score===null){return _react.default.createElement(_eui.EuiToolTip,{content:_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.tableMaxScoreErrorTooltip",{defaultMessage:"There was a problem loading the maximum anomaly score"})},_react.default.createElement(_eui.EuiIcon,{type:"alert"}))}else if(score===0){return _react.default.createElement(_eui.EuiHealth,{color:"transparent",compressed:"true"},score)}else{var color=(0,_anomaly_utils.getSeverityColor)(score);return(_react.default.createElement(_eui.EuiHealth,{color:color,compressed:"true"},score>=1?Math.floor(score):"< 1"))}},truncateText:true,width:"150px"},{field:AnomalyDetectionListColumns.jobsInGroup,name:_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.tableNumJobs",{defaultMessage:"Jobs in group"}),sortable:true,truncateText:true,width:"100px"},{field:AnomalyDetectionListColumns.latestTimestamp,name:_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.tableLatestTimestamp",{defaultMessage:"Latest timestamp"}),dataType:"date",render:function render(time){return(0,_date_utils.formatHumanReadableDateTimeSeconds)(time)},textOnly:true,truncateText:true,sortable:true,width:"20%"},{field:AnomalyDetectionListColumns.docsProcessed,name:_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.tableDocsProcessed",{defaultMessage:"Docs processed"}),render:function render(docs){return(0,_string_utils.toLocaleString)(docs)},textOnly:true,sortable:true,width:"20%"},{name:_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.tableActionLabel",{defaultMessage:"Actions"}),render:function render(group){return _react.default.createElement(_actions.ExplorerLink,{jobsList:(0,_utils.getJobsFromGroup)(group,jobsList)})},width:"100px",align:"right"}];var onTableChange=function onTableChange(_ref2){var _ref2$page=_ref2.page,page=_ref2$page===void 0?{index:0,size:10}:_ref2$page,_ref2$sort=_ref2.sort,sort=_ref2$sort===void 0?{field:AnomalyDetectionListColumns.id,direction:_ml_in_memory_table.SORT_DIRECTION.ASC}:_ref2$sort;var index=page.index,size=page.size;setPageIndex(index);setPageSize(size);var field=sort.field,direction=sort.direction;setSortField(field);setSortDirection(direction)};var pagination={initialPageIndex:pageIndex,initialPageSize:pageSize,totalItemCount:groupsList.length,pageSizeOptions:[10,20,50],hidePerPageOptions:false};var sorting={sort:{field:sortField,direction:sortDirection}};return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"m"},_react.default.createElement("h3",null,_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.panelTitle",{defaultMessage:"Anomaly Detection"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false,className:"mlOverviewPanel__statsBar"},_react.default.createElement(_stats_bar.StatsBar,{stats:statsBarData,dataTestSub:"mlOverviewJobStatsBar"}))),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(MlInMemoryTable,{allowNeutralSort:false,className:"mlAnomalyDetectionTable",columns:columns,hasActions:false,isExpandable:false,isSelectable:false,items:groupsList,itemId:AnomalyDetectionListColumns.id,onTableChange:onTableChange,pagination:pagination,sorting:sorting,"data-test-subj":"mlOverviewTableAnomalyDetection"}))};exports.AnomalyDetectionTable=AnomalyDetectionTable},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerLink=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _results=__webpack_require__(384);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ExplorerLink=function ExplorerLink(_ref){var jobsList=_ref.jobsList;var openJobsInAnomalyExplorerText=_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.resultActions.openJobsInAnomalyExplorerText",{defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Anomaly Explorer",values:{jobsCount:jobsList.length,jobId:jobsList[0]&&jobsList[0].id}});return _react.default.createElement(_eui.EuiToolTip,{position:"bottom",content:openJobsInAnomalyExplorerText},_react.default.createElement(_eui.EuiButtonEmpty,{color:"text",size:"xs",href:(0,_results.getLink)("explorer",jobsList),iconType:"tableOfContents","aria-label":openJobsInAnomalyExplorerText,className:"results-button","data-test-subj":"openOverviewJobsInAnomalyExplorer"},_i18n.i18n.translate("xpack.ml.overview.anomalyDetection.exploreActionName",{defaultMessage:"Explore"})))};exports.ExplorerLink=ExplorerLink},,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobSelectorBadge=JobSelectorBadge;var _react=_interopRequireDefault(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);var _group_color_utils=__webpack_require__(151);var _i18n=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function JobSelectorBadge(_ref){var icon=_ref.icon,id=_ref.id,_ref$isGroup=_ref.isGroup,isGroup=_ref$isGroup===void 0?false:_ref$isGroup,numJobs=_ref.numJobs,removeId=_ref.removeId;var color=isGroup?(0,_group_color_utils.tabColor)(id):"hollow";var props={color:color};var jobCount;if(icon===true){props=_objectSpread({},props,{iconType:"cross",iconSide:"right",onClick:function onClick(){return removeId(id)},onClickAriaLabel:"Remove id"})}if(numJobs!==undefined){jobCount=_i18n.i18n.translate("xpack.ml.jobSelector.selectedGroupJobs",{defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:numJobs}})}return _react.default.createElement(_eui.EuiBadge,_extends({key:"".concat(id,"-id"),"data-test-subj":"mlJobSelectionBadge ".concat(id)},props),"".concat(id).concat(jobCount?jobCount:""))}JobSelectorBadge.propTypes={icon:_propTypes.PropTypes.bool,id:_propTypes.PropTypes.string.isRequired,isGroup:_propTypes.PropTypes.bool,numJobs:_propTypes.PropTypes.number,removeId:_propTypes.PropTypes.func}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AnalyticsPanel",{enumerable:true,get:function get(){return _analytics_panel.AnalyticsPanel}});var _analytics_panel=__webpack_require__(913)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnalyticsPanel=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _table=__webpack_require__(914);var _analytics_service=__webpack_require__(153);var _stats_bar=__webpack_require__(186);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var AnalyticsPanel=function AnalyticsPanel(_ref){var jobCreationDisabled=_ref.jobCreationDisabled;var _useState=(0,_react.useState)([]),_useState2=_slicedToArray(_useState,2),analytics=_useState2[0],setAnalytics=_useState2[1];var _useState3=(0,_react.useState)(undefined),_useState4=_slicedToArray(_useState3,2),analyticsStats=_useState4[0],setAnalyticsStats=_useState4[1];var _useState5=(0,_react.useState)(undefined),_useState6=_slicedToArray(_useState5,2),errorMessage=_useState6[0],setErrorMessage=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),isInitialized=_useState8[0],setIsInitialized=_useState8[1];var getAnalytics=(0,_analytics_service.getAnalyticsFactory)(setAnalytics,setAnalyticsStats,setErrorMessage,setIsInitialized,false);(0,_react.useEffect)((function(){getAnalytics(true)}),[]);var onRefresh=function onRefresh(){getAnalytics(true)};var errorDisplay=_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.overview.analyticsList.errorPromptTitle",{defaultMessage:"An error occurred getting the data frame analytics list."}),color:"danger",iconType:"alert"},_react.default.createElement("pre",null,errorMessage&&errorMessage.message!==undefined?errorMessage.message:JSON.stringify(errorMessage)));var panelClass=isInitialized===false?"mlOverviewPanel__isLoading":"mlOverviewPanel";return _react.default.createElement(_eui.EuiPanel,{className:panelClass},typeof errorMessage!=="undefined"&&errorDisplay,isInitialized===false&&_react.default.createElement(_eui.EuiLoadingSpinner,{className:"mlOverviewPanel__spinner",size:"xl"}),"    ",errorMessage===undefined&&isInitialized===true&&analytics.length===0&&_react.default.createElement(_eui.EuiEmptyPrompt,{iconType:"createAdvancedJob",title:_react.default.createElement("h2",null,_i18n.i18n.translate("xpack.ml.overview.analyticsList.createFirstJobMessage",{defaultMessage:"Create your first analytics job"})),body:_react.default.createElement("p",null,_i18n.i18n.translate("xpack.ml.overview.analyticsList.emptyPromptText",{defaultMessage:"Data frame analytics enable you to perform different analyses of your data and annotate it with the results. The analytics job stores the annotated data, as well as a copy of the source data, in a new index."})),actions:_react.default.createElement(_eui.EuiButton,{href:"#/data_frame_analytics?",color:"primary",fill:true,iconType:"plusInCircle",isDisabled:jobCreationDisabled},_i18n.i18n.translate("xpack.ml.overview.analyticsList.createJobButtonText",{defaultMessage:"Create job"}))}),isInitialized===true&&analytics.length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"m"},_react.default.createElement("h3",null,_i18n.i18n.translate("xpack.ml.overview.analyticsList.PanelTitle",{defaultMessage:"Analytics"})))),analyticsStats!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false,className:"mlOverviewPanel__statsBar"},_react.default.createElement(_stats_bar.StatsBar,{stats:analyticsStats,dataTestSub:"mlOverviewAnalyticsStatsBar"}))),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_table.AnalyticsTable,{items:analytics}),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement("div",{className:"mlOverviewPanel__buttons"},_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",onClick:onRefresh,className:"mlOverviewPanel__refreshButton"},_i18n.i18n.translate("xpack.ml.overview.analyticsList.refreshJobsButtonText",{defaultMessage:"Refresh"})),_react.default.createElement(_eui.EuiButton,{size:"s",fill:true,href:"#/data_frame_analytics?"},_i18n.i18n.translate("xpack.ml.overview.analyticsList.manageJobsButtonText",{defaultMessage:"Manage jobs"})))))};exports.AnalyticsPanel=AnalyticsPanel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnalyticsTable=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _ml_in_memory_table=__webpack_require__(127);var _analytics=__webpack_require__(76);var _common=__webpack_require__(101);var _columns=__webpack_require__(117);var _actions=__webpack_require__(389);var _date_utils=__webpack_require__(83);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var MlInMemoryTable=(0,_ml_in_memory_table.mlInMemoryTableFactory)();var AnalyticsTable=function AnalyticsTable(_ref){var items=_ref.items;var _useState=(0,_react.useState)(0),_useState2=_slicedToArray(_useState,2),pageIndex=_useState2[0],setPageIndex=_useState2[1];var _useState3=(0,_react.useState)(10),_useState4=_slicedToArray(_useState3,2),pageSize=_useState4[0],setPageSize=_useState4[1];var _useState5=(0,_react.useState)(_common.DataFrameAnalyticsListColumn.id),_useState6=_slicedToArray(_useState5,2),sortField=_useState6[0],setSortField=_useState6[1];var _useState7=(0,_react.useState)(_ml_in_memory_table.SORT_DIRECTION.ASC),_useState8=_slicedToArray(_useState7,2),sortDirection=_useState8[0],setSortDirection=_useState8[1];var columns=[{field:_common.DataFrameAnalyticsListColumn.id,name:_i18n.i18n.translate("xpack.ml.overview.analyticsList.id",{defaultMessage:"ID"}),sortable:true,truncateText:true,width:"20%"},{name:_i18n.i18n.translate("xpack.ml.overview.analyticsList.type",{defaultMessage:"Type"}),sortable:function sortable(item){return(0,_analytics.getAnalysisType)(item.config.analysis)},truncateText:true,render:function render(item){return _react.default.createElement(_eui.EuiBadge,{color:"hollow"},(0,_analytics.getAnalysisType)(item.config.analysis))},width:"150px"},{name:_i18n.i18n.translate("xpack.ml.overview.analyticsList.status",{defaultMessage:"Status"}),sortable:function sortable(item){return item.stats.state},truncateText:true,render:function render(item){return(0,_columns.getTaskStateBadge)(item.stats.state,item.stats.failure_reason)},width:"100px"},_columns.progressColumn,{field:_common.DataFrameAnalyticsListColumn.configCreateTime,name:_i18n.i18n.translate("xpack.ml.overview.analyticsList.reatedTimeColumnName",{defaultMessage:"Creation time"}),dataType:"date",render:function render(time){return(0,_date_utils.formatHumanReadableDateTimeSeconds)(time)},textOnly:true,truncateText:true,sortable:true,width:"20%"},{name:_i18n.i18n.translate("xpack.ml.overview.analyticsList.tableActionLabel",{defaultMessage:"Actions"}),actions:[_actions.AnalyticsViewAction],width:"100px"}];var onTableChange=function onTableChange(_ref2){var _ref2$page=_ref2.page,page=_ref2$page===void 0?{index:0,size:10}:_ref2$page,_ref2$sort=_ref2.sort,sort=_ref2$sort===void 0?{field:_common.DataFrameAnalyticsListColumn.id,direction:_ml_in_memory_table.SORT_DIRECTION.ASC}:_ref2$sort;var index=page.index,size=page.size;setPageIndex(index);setPageSize(size);var field=sort.field,direction=sort.direction;setSortField(field);setSortDirection(direction)};var pagination={initialPageIndex:pageIndex,initialPageSize:pageSize,totalItemCount:items.length,pageSizeOptions:[10,20,50],hidePerPageOptions:false};var sorting={sort:{field:sortField,direction:sortDirection}};return _react.default.createElement(MlInMemoryTable,{allowNeutralSort:false,className:"mlAnalyticsTable",columns:columns,hasActions:false,isExpandable:false,isSelectable:false,items:items,itemId:_common.DataFrameAnalyticsListColumn.id,onTableChange:onTableChange,pagination:pagination,sorting:sorting,"data-test-subj":"mlOverviewTableAnalytics"})};exports.AnalyticsTable=AnalyticsTable},,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.jobListRoute=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _reactUse=__webpack_require__(236);var _i18n=__webpack_require__(1);var _jobs_list=__webpack_require__(193);var _timefilter_refresh_service=__webpack_require__(184);var _url_state=__webpack_require__(88);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _resolvers=__webpack_require__(110);var _jobs_list2=__webpack_require__(1025);var _kibana=__webpack_require__(57);var _breadcrumbs=__webpack_require__(69);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.ANOMALY_DETECTION_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.anomalyDetection.jobManagementLabel",{defaultMessage:"Job Management"}),href:""}];var jobListRoute={path:"/jobs",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.jobListRoute=jobListRoute;var PageWrapper=function PageWrapper(_ref){var _ref2,_ref3,_globalState$refreshI,_ref4,_globalState$refreshI2;var deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,(0,_resolvers.basicResolvers)(deps)),context=_useResolver.context;var timefilter=(0,_kibana.useTimefilter)({timeRangeSelector:false,autoRefreshSelector:true});var _useUrlState=(0,_url_state.useUrlState)("_g"),_useUrlState2=_slicedToArray(_useUrlState,2),globalState=_useUrlState2[0],setGlobalState=_useUrlState2[1];var mlTimefilterRefresh=(0,_reactUse.useObservable)(_timefilter_refresh_service.mlTimefilterRefresh$);var lastRefresh=(_ref2=mlTimefilterRefresh===null||mlTimefilterRefresh===void 0?void 0:mlTimefilterRefresh.lastRefresh)!==null&&_ref2!==void 0?_ref2:0;var refreshValue=(_ref3=globalState===null||globalState===void 0?void 0:(_globalState$refreshI=globalState.refreshInterval)===null||_globalState$refreshI===void 0?void 0:_globalState$refreshI.value)!==null&&_ref3!==void 0?_ref3:0;var refreshPause=(_ref4=globalState===null||globalState===void 0?void 0:(_globalState$refreshI2=globalState.refreshInterval)===null||_globalState$refreshI2===void 0?void 0:_globalState$refreshI2.pause)!==null&&_ref4!==void 0?_ref4:true;var blockRefresh=refreshValue===0||refreshPause===true;(0,_react.useEffect)((function(){var refreshInterval=refreshValue===0&&refreshPause===true?{pause:false,value:_jobs_list.DEFAULT_REFRESH_INTERVAL_MS}:{pause:refreshPause,value:refreshValue};setGlobalState({refreshInterval:refreshInterval});timefilter.setRefreshInterval(refreshInterval)}),[]);return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_jobs_list2.JobsPage,{blockRefresh:blockRefresh,lastRefresh:lastRefresh}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobsPage",{enumerable:true,get:function get(){return _jobs.JobsPage}});var _jobs=__webpack_require__(1026)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobsPage=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _navigation_menu=__webpack_require__(82);var _index=__webpack_require__(406);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var JobsPage=function JobsPage(props){return _react.default.createElement("div",{"data-test-subj":"mlPageJobManagement"},_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"jobs"}),_react.default.createElement(_index.JobsListView,props))};exports.JobsPage=JobsPage},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _index_or_search=__webpack_require__(1251);Object.keys(_index_or_search).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _index_or_search[key]}})}));var _job_type=__webpack_require__(1255);Object.keys(_job_type).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _job_type[key]}})}));var _new_job=__webpack_require__(1263);Object.keys(_new_job).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _new_job[key]}})}));var _wizard=__webpack_require__(1264);Object.keys(_wizard).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _wizard[key]}})}));var _recognize=__webpack_require__(1432);Object.keys(_recognize).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _recognize[key]}})}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.dataVizIndexOrSearchRoute=exports.indexOrSearchRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _resolvers=__webpack_require__(110);var _index_or_search=__webpack_require__(1252);var _breadcrumbs=__webpack_require__(69);var _license=__webpack_require__(73);var _index_utils=__webpack_require__(70);var _check_privilege=__webpack_require__(56);var _ml_nodes_check=__webpack_require__(154);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var MODE;(function(MODE){MODE[MODE["NEW_JOB"]=0]="NEW_JOB";MODE[MODE["DATAVISUALIZER"]=1]="DATAVISUALIZER"})(MODE||(MODE={}));var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.ANOMALY_DETECTION_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.selectIndexOrSearchLabel",{defaultMessage:"Create job"}),href:""}];var indexOrSearchRoute={path:"/jobs/new_job/step/index_or_search",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{nextStepPath:"#/jobs/new_job/step/job_type",deps:deps,mode:MODE.NEW_JOB}))},breadcrumbs:breadcrumbs};exports.indexOrSearchRoute=indexOrSearchRoute;var dataVizIndexOrSearchRoute={path:"/datavisualizer_index_select",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{nextStepPath:"#jobs/new_job/datavisualizer",deps:deps,mode:MODE.DATAVISUALIZER}))},breadcrumbs:breadcrumbs};exports.dataVizIndexOrSearchRoute=dataVizIndexOrSearchRoute;var PageWrapper=function PageWrapper(_ref){var nextStepPath=_ref.nextStepPath,deps=_ref.deps,mode=_ref.mode;var newJobResolvers=_objectSpread({},(0,_resolvers.basicResolvers)(deps),{preConfiguredJobRedirect:function preConfiguredJobRedirect(){return(0,_index_or_search.preConfiguredJobRedirect)(deps.indexPatterns)}});var dataVizResolvers={checkBasicLicense:_license.checkBasicLicense,loadIndexPatterns:function loadIndexPatterns(){return(0,_index_utils.loadIndexPatterns)(deps.indexPatterns)},checkGetJobsPrivilege:_check_privilege.checkGetJobsPrivilege,checkMlNodesAvailable:_ml_nodes_check.checkMlNodesAvailable};var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,mode===MODE.NEW_JOB?newJobResolvers:dataVizResolvers),context=_useResolver.context;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_index_or_search.Page,{nextStepPath:nextStepPath}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Page",{enumerable:true,get:function get(){return _page.Page}});Object.defineProperty(exports,"preConfiguredJobRedirect",{enumerable:true,get:function get(){return _preconfigured_job_redirect.preConfiguredJobRedirect}});var _page=__webpack_require__(1253);var _preconfigured_job_redirect=__webpack_require__(1254)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Page=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _public=__webpack_require__(200);var _kibana=__webpack_require__(57);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Page=function Page(_ref){var nextStepPath=_ref.nextStepPath;var RESULTS_PER_PAGE=20;var _useMlKibana$services=(0,_kibana.useMlKibana)().services,uiSettings=_useMlKibana$services.uiSettings,savedObjects=_useMlKibana$services.savedObjects;var onObjectSelection=function onObjectSelection(id,type){window.location.href="".concat(nextStepPath,"?").concat(type==="index-pattern"?"index":"savedSearchId","=").concat(encodeURIComponent(id))};return _react.default.createElement(_eui.EuiPage,{"data-test-subj":"mlPageSourceSelection"},_react.default.createElement(_eui.EuiPageBody,{restrictWidth:1200},_react.default.createElement(_eui.EuiPageHeader,null,_react.default.createElement(_eui.EuiPageHeaderSection,null,_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.selectIndexPatternOrSavedSearch",defaultMessage:"Select index pattern or saved search"}))))),_react.default.createElement(_eui.EuiPageContent,null,_react.default.createElement(_public.SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:onObjectSelection,showFilter:true,noItemsMessage:_i18n.i18n.translate("xpack.ml.newJob.wizard.searchSelection.notFoundLabel",{defaultMessage:"No matching indices or saved searches found."}),savedObjectMetaData:[{type:"search",getIconForSavedObject:function getIconForSavedObject(){return"search"},name:_i18n.i18n.translate("xpack.ml.newJob.wizard.searchSelection.savedObjectType.search",{defaultMessage:"Saved search"})},{type:"index-pattern",getIconForSavedObject:function getIconForSavedObject(){return"indexPatternApp"},name:_i18n.i18n.translate("xpack.ml.newJob.wizard.searchSelection.savedObjectType.indexPattern",{defaultMessage:"Index pattern"})}],fixedPageSize:RESULTS_PER_PAGE,uiSettings:uiSettings,savedObjects:savedObjects}))))};exports.Page=Page},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.preConfiguredJobRedirect=preConfiguredJobRedirect;var _job_service=__webpack_require__(58);var _index_utils=__webpack_require__(70);var _new_job=__webpack_require__(60);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function preConfiguredJobRedirect(_x){return _preConfiguredJobRedirect.apply(this,arguments)}function _preConfiguredJobRedirect(){_preConfiguredJobRedirect=_asyncToGenerator(regeneratorRuntime.mark((function _callee(indexPatterns){var job,redirectUrl;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:job=_job_service.mlJobService.tempJobCloningObjects.job;if(!job){_context.next=15;break}_context.prev=2;_context.next=5;return(0,_index_utils.loadIndexPatterns)(indexPatterns);case 5:redirectUrl=getWizardUrlFromCloningJob(job);window.location.href="#/".concat(redirectUrl);return _context.abrupt("return",Promise.reject());case 10:_context.prev=10;_context.t0=_context["catch"](2);return _context.abrupt("return",Promise.resolve());case 13:_context.next=16;break;case 15:return _context.abrupt("return",Promise.resolve());case 16:case"end":return _context.stop()}}}),_callee,null,[[2,10]])})));return _preConfiguredJobRedirect.apply(this,arguments)}function getWizardUrlFromCloningJob(job){var _job$custom_settings;var created=job===null||job===void 0?void 0:(_job$custom_settings=job.custom_settings)===null||_job$custom_settings===void 0?void 0:_job$custom_settings.created_by;var page="";switch(created){case _new_job.CREATED_BY_LABEL.SINGLE_METRIC:page=_new_job.JOB_TYPE.SINGLE_METRIC;break;case _new_job.CREATED_BY_LABEL.MULTI_METRIC:page=_new_job.JOB_TYPE.MULTI_METRIC;break;case _new_job.CREATED_BY_LABEL.POPULATION:page=_new_job.JOB_TYPE.POPULATION;break;case _new_job.CREATED_BY_LABEL.CATEGORIZATION:page=_new_job.JOB_TYPE.CATEGORIZATION;break;default:page=_new_job.JOB_TYPE.ADVANCED;break}var indexPatternId=(0,_index_utils.getIndexPatternIdFromName)(job.datafeed_config.indices[0]);return"jobs/new_job/".concat(page,"?index=").concat(indexPatternId,"&_g=()")}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.jobTypeRoute=void 0;var _queryString=__webpack_require__(126);var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _resolvers=__webpack_require__(110);var _job_type=__webpack_require__(1256);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.ANOMALY_DETECTION_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.selectJobType",{defaultMessage:"Create job"}),href:""}];var jobTypeRoute={path:"/jobs/new_job/step/job_type",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.jobTypeRoute=jobTypeRoute;var PageWrapper=function PageWrapper(_ref){var location=_ref.location,deps=_ref.deps;var _parse=(0,_queryString.parse)(location.search,{sort:false}),index=_parse.index,savedSearchId=_parse.savedSearchId;var _useResolver=(0,_use_resolver.useResolver)(index,savedSearchId,deps.config,(0,_resolvers.basicResolvers)(deps)),context=_useResolver.context;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_job_type.Page,null))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Page",{enumerable:true,get:function get(){return _page.Page}});var _page=__webpack_require__(1257)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Page=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _ml=__webpack_require__(77);var _kibana=__webpack_require__(1258);var _data_recognizer=__webpack_require__(464);var _recently_accessed=__webpack_require__(241);var _index_utils=__webpack_require__(70);var _create_job_link_card=__webpack_require__(251);var _categorization_job_icon=__webpack_require__(1262);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var Page=function Page(){var mlContext=(0,_ml.useMlContext)();var _useState=(0,_react.useState)(0),_useState2=_slicedToArray(_useState,2),recognizerResultsCount=_useState2[0],setRecognizerResultsCount=_useState2[1];var currentSavedSearch=mlContext.currentSavedSearch,currentIndexPattern=mlContext.currentIndexPattern;var isTimeBasedIndex=(0,_index_utils.timeBasedIndexCheck)(currentIndexPattern);var indexWarningTitle=!isTimeBasedIndex&&(0,_kibana.isSavedSearchSavedObject)(currentSavedSearch)?_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternFromSavedSearchNotTimeBasedMessage",{defaultMessage:"{savedSearchTitle} uses index pattern {indexPatternTitle} which is not time based",values:{savedSearchTitle:currentSavedSearch.attributes.title,indexPatternTitle:currentIndexPattern.title}}):_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternNotTimeBasedMessage",{defaultMessage:"Index pattern {indexPatternTitle} is not time based",values:{indexPatternTitle:currentIndexPattern.title}});var pageTitleLabel=(0,_kibana.isSavedSearchSavedObject)(currentSavedSearch)?_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.savedSearchPageTitleLabel",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:currentSavedSearch.attributes.title}}):_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternPageTitleLabel",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:currentIndexPattern.title}});var recognizerResults={count:0,onChange:function onChange(){setRecognizerResultsCount(recognizerResults.count)}};var getUrl=function getUrl(basePath){return!(0,_kibana.isSavedSearchSavedObject)(currentSavedSearch)?"".concat(basePath,"?index=").concat(currentIndexPattern.id):"".concat(basePath,"?savedSearchId=").concat(currentSavedSearch.id)};var addSelectionToRecentlyAccessed=function addSelectionToRecentlyAccessed(){var title=!(0,_kibana.isSavedSearchSavedObject)(currentSavedSearch)?currentIndexPattern.title:currentSavedSearch.attributes.title;var url=getUrl("");(0,_recently_accessed.addItemToRecentlyAccessed)("jobs/new_job/datavisualizer",title,url);window.location.href=getUrl("#jobs/new_job/datavisualizer")};var jobTypes=[{href:getUrl("#jobs/new_job/single_metric"),icon:{type:"createSingleMetricJob",ariaLabel:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricAriaLabel",{defaultMessage:"Single metric job"})},title:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricTitle",{defaultMessage:"Single metric"}),description:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricDescription",{defaultMessage:"Detect anomalies in a single time series."}),id:"mlJobTypeLinkSingleMetricJob"},{href:getUrl("#jobs/new_job/multi_metric"),icon:{type:"createMultiMetricJob",ariaLabel:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricAriaLabel",{defaultMessage:"Multi metric job"})},title:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricTitle",{defaultMessage:"Multi metric"}),description:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricDescription",{defaultMessage:"Detect anomalies in multiple metrics by splitting a time series by a categorical field."}),id:"mlJobTypeLinkMultiMetricJob"},{href:getUrl("#jobs/new_job/population"),icon:{type:"createPopulationJob",ariaLabel:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.populationAriaLabel",{defaultMessage:"Population job"})},title:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.populationTitle",{defaultMessage:"Population"}),description:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.populationDescription",{defaultMessage:"Detect activity that is unusual compared to the behavior of the population."}),id:"mlJobTypeLinkPopulationJob"},{href:getUrl("#jobs/new_job/advanced"),icon:{type:"createAdvancedJob",ariaLabel:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedAriaLabel",{defaultMessage:"Advanced job"})},title:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedTitle",{defaultMessage:"Advanced"}),description:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedDescription",{defaultMessage:"Use the full range of options to create a job for more advanced use cases."}),id:"mlJobTypeLinkAdvancedJob"},{href:getUrl("#jobs/new_job/categorization"),icon:{type:_categorization_job_icon.CategorizationIcon,ariaLabel:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationAriaLabel",{defaultMessage:"Categorization job"})},title:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationTitle",{defaultMessage:"Categorization"}),description:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationDescription",{defaultMessage:"Group log messages into categories and detect anomalies within them."}),id:"mlJobTypeLinkCategorizationJob"}];return _react.default.createElement(_eui.EuiPage,{"data-test-subj":"mlPageJobTypeSelection"},_react.default.createElement(_eui.EuiPageBody,{restrictWidth:1200},_react.default.createElement(_eui.EuiTitle,{size:"l"},_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.createJobFromTitle",defaultMessage:"Create a job from the {pageTitleLabel}",values:{pageTitleLabel:pageTitleLabel}}))),_react.default.createElement(_eui.EuiSpacer,null),isTimeBasedIndex===false&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiCallOut,{title:indexWarningTitle,color:"warning",iconType:"alert"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.howToRunAnomalyDetectionDescription",defaultMessage:"Anomaly detection can only be run over indices which are time based."}),_react.default.createElement("br",null),_react.default.createElement(_eui.EuiLink,{href:"#jobs/new_job"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.selectDifferentIndexLinkText",defaultMessage:"Select a different index"}))),_react.default.createElement(_eui.EuiSpacer,{size:"xxl"})),_react.default.createElement("div",{hidden:recognizerResultsCount===0},_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useSuppliedConfigurationTitle",defaultMessage:"Use a supplied configuration"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useSuppliedConfigurationDescription",defaultMessage:"The fields in your data have been recognized as matching known configurations. Select to create a set of machine learning jobs and associated dashboards."}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexGrid,{gutterSize:"l",columns:4},_react.default.createElement(_data_recognizer.DataRecognizer,{indexPattern:currentIndexPattern,savedSearch:currentSavedSearch,results:recognizerResults})),_react.default.createElement(_eui.EuiSpacer,{size:"xxl"})),_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useWizardTitle",defaultMessage:"Use a wizard"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useWizardDescription",defaultMessage:"Use one of the wizards to create a machine learning job to find anomalies in your data."}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexGrid,{gutterSize:"l",columns:4},jobTypes.map((function(_ref){var href=_ref.href,icon=_ref.icon,title=_ref.title,description=_ref.description,id=_ref.id;return _react.default.createElement(_eui.EuiFlexItem,{key:id},_react.default.createElement(_create_job_link_card.CreateJobLinkCard,{"data-test-subj":id,href:href,icon:icon.type,iconAreaLabel:icon.ariaLabel,title:title,description:description,isDisabled:!isTimeBasedIndex}))}))),_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.learnMoreAboutDataTitle",defaultMessage:"Learn more about your data"}))),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.learnMoreAboutDataDescription",defaultMessage:"If you're not sure what type of job to create, first explore the fields and metrics in your data."}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexGrid,{gutterSize:"l",columns:4},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_create_job_link_card.CreateJobLinkCard,{icon:"dataVisualizer",iconAreaLabel:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobType.dataVisualizerAriaLabel",{defaultMessage:"Data Visualizer"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.dataVisualizerTitle",defaultMessage:"Data Visualizer"}),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.dataVisualizerDescription",defaultMessage:"Learn more about the characteristics of your data and identify the fields for analysis with machine learning."}),onClick:addSelectionToRecentlyAccessed,href:getUrl("#jobs/new_job/datavisualizer")})))))};exports.Page=Page},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isSavedSearchSavedObject=isSavedSearchSavedObject;function isSavedSearchSavedObject(ss){return ss!==null}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DataRecognizer=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _recognized_result=__webpack_require__(1260);var _ml_api_service=__webpack_require__(51);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var DataRecognizer=function(_Component){_inherits(DataRecognizer,_Component);function DataRecognizer(props){var _this;_classCallCheck(this,DataRecognizer);_this=_possibleConstructorReturn(this,_getPrototypeOf(DataRecognizer).call(this,props));_this.state={results:[]};_this.indexPattern=props.indexPattern;_this.savedSearch=props.savedSearch;_this.className=props.className;_this.results=props.results;return _this}_createClass(DataRecognizer,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;_ml_api_service.ml.recognizeIndex({indexPatternTitle:this.indexPattern.title}).then((function(resp){var results=resp.map((function(r){return _react.default.createElement(_recognized_result.RecognizedResult,{key:r.id,config:r,indexPattern:_this2.indexPattern,savedSearch:_this2.savedSearch})}));if(_typeof(_this2.results)==="object"){_this2.results.count=results.length;if(typeof _this2.results.onChange==="function"){_this2.results.onChange()}}_this2.setState({results:results})})).catch((function(e){console.error("Error attempting to recognize index",e)}))}},{key:"render",value:function render(){return _react.default.createElement(_react.default.Fragment,null,this.state.results)}}]);return DataRecognizer}(_react.Component);exports.DataRecognizer=DataRecognizer;DataRecognizer.propTypes={indexPattern:_propTypes.default.object,savedSearch:_propTypes.default.object,className:_propTypes.default.string,results:_propTypes.default.object}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RecognizedResult=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _propTypes=_interopRequireDefault(__webpack_require__(50));var _eui=__webpack_require__(29);var _create_job_link_card=__webpack_require__(251);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RecognizedResult=function RecognizedResult(_ref){var config=_ref.config,indexPattern=_ref.indexPattern,savedSearch=_ref.savedSearch;var id=savedSearch===null?"index=".concat(indexPattern.id):"savedSearchId=".concat(savedSearch.id);var href="#/jobs/new_job/recognize?id=".concat(config.id,"&").concat(id);var logo=null;if(config.logo&&config.logo.icon){logo=_react.default.createElement(_eui.EuiIcon,{type:config.logo.icon,size:"xl"})}else if(config.logo&&config.logo.src){logo=_react.default.createElement("img",{alt:"",src:config.logo.src})}else{logo=_react.default.createElement("h3",{className:"euiTitle euiTitle--small"},config.id)}return _react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_create_job_link_card.CreateJobLinkCard,{"data-test-subj":id,href:href,title:config.title,description:config.description,icon:logo}))};exports.RecognizedResult=RecognizedResult;RecognizedResult.propTypes={config:_propTypes.default.object,indexPattern:_propTypes.default.object,savedSearch:_propTypes.default.object}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CreateJobLinkCard=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CreateJobLinkCard=function CreateJobLinkCard(_ref){var icon=_ref.icon,iconAreaLabel=_ref.iconAreaLabel,title=_ref.title,description=_ref.description,onClick=_ref.onClick,href=_ref.href,isDisabled=_ref.isDisabled,dateTestSubj=_ref["data-test-subj"];var linkHrefAndOnClickProps=_objectSpread({},href?{href:href}:{},{},onClick?{onClick:onClick}:{});return _react.default.createElement(_eui.EuiPanel,{style:{cursor:isDisabled?"not-allowed":undefined}},_react.default.createElement(_eui.EuiLink,_extends({style:{display:"block",pointerEvents:isDisabled?"none":undefined,background:"transparent",outline:"none"},"data-test-subj":dateTestSubj,color:"subdued"},linkHrefAndOnClickProps),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l",responsive:true},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{paddingTop:"8px"}},typeof icon==="string"?_react.default.createElement(_eui.EuiIcon,{size:"xl",type:icon,"aria-label":iconAreaLabel}):icon),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h3",null,title)),_react.default.createElement(_eui.EuiText,{color:"subdued"},_react.default.createElement("p",null,description))))))};exports.CreateJobLinkCard=CreateJobLinkCard},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CategorizationIcon=void 0;var _react=_interopRequireDefault(__webpack_require__(28));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CategorizationIcon=_react.default.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_react.default.createElement("path",{d:"M16 32C7.16344 32 0 24.8366 0 16C0 7.16344 7.16344 0 16 0C24.8366 0 32 7.16344 32 16H30C30 8.26801 23.732 2 16 2C8.26801 2 2 8.26801 2 16C2 23.732 8.26801 30 16 30V32Z",fill:"#343741"}),_react.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 15H23V17H17V23H15V17H9V15H15V9H17V15ZM32 30V32H20V30H32ZM32 22L20 22V24L32 24V22ZM32 26V28H20V26H32Z",fill:"#017D73"}));exports.CategorizationIcon=CategorizationIcon},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.newJobRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _reactRouterDom=__webpack_require__(41);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.ANOMALY_DETECTION_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.jobWizardLabel",{defaultMessage:"Create job"}),href:"#/jobs/new_job"}];var newJobRoute={path:"/jobs/new_job",render:function render(){return _react.default.createElement(Page,null)},breadcrumbs:breadcrumbs};exports.newJobRoute=newJobRoute;var Page=function Page(){return _react.default.createElement(_reactRouterDom.Redirect,{to:"/jobs/new_job/step/index_or_search"})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.categorizationRoute=exports.advancedRoute=exports.populationRoute=exports.multiMetricRoute=exports.singleMetricRoute=void 0;var _queryString=__webpack_require__(126);var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _resolvers=__webpack_require__(110);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _new_job=__webpack_require__(1265);var _new_job2=__webpack_require__(60);var _job_service=__webpack_require__(58);var _new_job_capabilities_service=__webpack_require__(66);var _check_privilege=__webpack_require__(56);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var createJobBreadcrumbs={text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.createJobLabel",{defaultMessage:"Create job"}),href:"#/jobs/new_job"};var baseBreadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.ANOMALY_DETECTION_BREADCRUMB,createJobBreadcrumbs];var singleMetricBreadcrumbs=[].concat(baseBreadcrumbs,[{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.singleMetricLabel",{defaultMessage:"Single metric"}),href:""}]);var multiMetricBreadcrumbs=[].concat(baseBreadcrumbs,[{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.multiMetricLabel",{defaultMessage:"Multi metric"}),href:""}]);var populationBreadcrumbs=[].concat(baseBreadcrumbs,[{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.populationLabel",{defaultMessage:"Population"}),href:""}]);var advancedBreadcrumbs=[].concat(baseBreadcrumbs,[{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.advancedConfigurationLabel",{defaultMessage:"Advanced configuration"}),href:""}]);var categorizationBreadcrumbs=[].concat(baseBreadcrumbs,[{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.categorizationLabel",{defaultMessage:"Categorization"}),href:""}]);var singleMetricRoute={path:"/jobs/new_job/single_metric",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{jobType:_new_job2.JOB_TYPE.SINGLE_METRIC,deps:deps}))},breadcrumbs:singleMetricBreadcrumbs};exports.singleMetricRoute=singleMetricRoute;var multiMetricRoute={path:"/jobs/new_job/multi_metric",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{jobType:_new_job2.JOB_TYPE.MULTI_METRIC,deps:deps}))},breadcrumbs:multiMetricBreadcrumbs};exports.multiMetricRoute=multiMetricRoute;var populationRoute={path:"/jobs/new_job/population",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{jobType:_new_job2.JOB_TYPE.POPULATION,deps:deps}))},breadcrumbs:populationBreadcrumbs};exports.populationRoute=populationRoute;var advancedRoute={path:"/jobs/new_job/advanced",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{jobType:_new_job2.JOB_TYPE.ADVANCED,deps:deps}))},breadcrumbs:advancedBreadcrumbs};exports.advancedRoute=advancedRoute;var categorizationRoute={path:"/jobs/new_job/categorization",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{jobType:_new_job2.JOB_TYPE.CATEGORIZATION,deps:deps}))},breadcrumbs:categorizationBreadcrumbs};exports.categorizationRoute=categorizationRoute;var PageWrapper=function PageWrapper(_ref){var location=_ref.location,jobType=_ref.jobType,deps=_ref.deps;var _parse=(0,_queryString.parse)(location.search,{sort:false}),index=_parse.index,savedSearchId=_parse.savedSearchId;var _useResolver=(0,_use_resolver.useResolver)(index,savedSearchId,deps.config,_objectSpread({},(0,_resolvers.basicResolvers)(deps),{privileges:_check_privilege.checkCreateJobsPrivilege,jobCaps:function jobCaps(){return(0,_new_job_capabilities_service.loadNewJobCapabilities)(index,savedSearchId,deps.indexPatterns)},existingJobsAndGroups:_job_service.mlJobService.getJobAndGroupIds})),context=_useResolver.context,results=_useResolver.results;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_new_job.Page,{jobType:jobType,existingJobsAndGroups:results.existingJobsAndGroups}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Page",{enumerable:true,get:function get(){return _page.Page}});var _page=__webpack_require__(1266)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Page=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _wizard=__webpack_require__(1267);var _step_types=__webpack_require__(104);var _general=__webpack_require__(85);var _kibana=__webpack_require__(57);var _job_creator=__webpack_require__(89);var _new_job=__webpack_require__(60);var _chart_loader=__webpack_require__(1421);var _results_loader=__webpack_require__(474);var _job_validator=__webpack_require__(1424);var _ml=__webpack_require__(77);var _full_time_range_selector=__webpack_require__(201);var _time_buckets=__webpack_require__(106);var _job_service=__webpack_require__(58);var _anomaly_detection_jobs=__webpack_require__(1427);var _new_job_capabilities_service=__webpack_require__(66);var _fields=__webpack_require__(118);var _ml_server_info=__webpack_require__(84);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var PAGE_WIDTH=1200;var BAR_TARGET=PAGE_WIDTH>2e3?1e3:PAGE_WIDTH/2;var MAX_BARS=BAR_TARGET+BAR_TARGET/100*100;var Page=function Page(_ref){var existingJobsAndGroups=_ref.existingJobsAndGroups,jobType=_ref.jobType;var _useMlKibana=(0,_kibana.useMlKibana)(),notifications=_useMlKibana.services.notifications;var mlContext=(0,_ml.useMlContext)();var jobCreator=(0,_job_creator.jobCreatorFactory)(jobType)(mlContext.currentIndexPattern,mlContext.currentSavedSearch,mlContext.combinedQuery);var _getTimeFilterRange=(0,_full_time_range_selector.getTimeFilterRange)(),from=_getTimeFilterRange.from,to=_getTimeFilterRange.to;jobCreator.setTimeRange(from,to);var firstWizardStep=jobType===_new_job.JOB_TYPE.ADVANCED?_step_types.WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED:_step_types.WIZARD_STEPS.TIME_RANGE;var autoSetTimeRange=false;if(_job_service.mlJobService.tempJobCloningObjects.job!==undefined){var clonedJob=_job_service.mlJobService.cloneJob(_job_service.mlJobService.tempJobCloningObjects.job);var _expandCombinedJobCon=(0,_anomaly_detection_jobs.expandCombinedJobConfig)(clonedJob),job=_expandCombinedJobCon.job,datafeed=_expandCombinedJobCon.datafeed;initCategorizationSettings();jobCreator.cloneFromExistingJob(job,datafeed);if(_job_service.mlJobService.tempJobCloningObjects.skipTimeRangeStep===false){jobCreator.jobId=""}else if(jobType!==_new_job.JOB_TYPE.ADVANCED){firstWizardStep=_step_types.WIZARD_STEPS.PICK_FIELDS}_job_service.mlJobService.tempJobCloningObjects.skipTimeRangeStep=false;_job_service.mlJobService.tempJobCloningObjects.job=undefined;if(_job_service.mlJobService.tempJobCloningObjects.start!==undefined&&_job_service.mlJobService.tempJobCloningObjects.end!==undefined){jobCreator.setTimeRange(_job_service.mlJobService.tempJobCloningObjects.start,_job_service.mlJobService.tempJobCloningObjects.end);_job_service.mlJobService.tempJobCloningObjects.start=undefined;_job_service.mlJobService.tempJobCloningObjects.end=undefined}else{autoSetTimeRange=(0,_job_creator.isAdvancedJobCreator)(jobCreator)}if(_job_service.mlJobService.tempJobCloningObjects.calendars){jobCreator.calendars=_job_service.mlJobService.tempJobCloningObjects.calendars;_job_service.mlJobService.tempJobCloningObjects.calendars=undefined}}else{jobCreator.bucketSpan=_new_job.DEFAULT_BUCKET_SPAN;if(jobCreator.type!==_new_job.JOB_TYPE.POPULATION&&jobCreator.type!==_new_job.JOB_TYPE.ADVANCED&&jobCreator.type!==_new_job.JOB_TYPE.CATEGORIZATION){jobCreator.modelMemoryLimit=_new_job.DEFAULT_MODEL_MEMORY_LIMIT}if(jobCreator.type===_new_job.JOB_TYPE.SINGLE_METRIC){jobCreator.modelPlot=true}if(mlContext.currentSavedSearch!==null){jobCreator.createdBy=null}autoSetTimeRange=(0,_job_creator.isAdvancedJobCreator)(jobCreator);initCategorizationSettings();if((0,_job_creator.isCategorizationJobCreator)(jobCreator)){var catFields=_new_job_capabilities_service.newJobCapsService.catFields;if(catFields.length===1){jobCreator.categorizationFieldName=catFields[0].name}}}if(autoSetTimeRange&&(0,_job_creator.isAdvancedJobCreator)(jobCreator)){try{jobCreator.autoSetTimeRange()}catch(error){var toasts=notifications.toasts;toasts.addDanger({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.autoSetJobCreatorTimeRange.error",{defaultMessage:"Error retrieving beginning and end times of index"}),text:error})}}function initCategorizationSettings(){if((0,_job_creator.isCategorizationJobCreator)(jobCreator)){var count=_new_job_capabilities_service.newJobCapsService.getAggById("count");var rare=_new_job_capabilities_service.newJobCapsService.getAggById("rare");var eventRate=_new_job_capabilities_service.newJobCapsService.getFieldById(_fields.EVENT_RATE_FIELD_ID);jobCreator.setDefaultDetectorProperties(count,rare,eventRate);var _getNewJobDefaults=(0,_ml_server_info.getNewJobDefaults)(),anomalyDetectors=_getNewJobDefaults.anomaly_detectors;jobCreator.categorizationAnalyzer=anomalyDetectors.categorization_analyzer}}var chartInterval=new _time_buckets.TimeBuckets;chartInterval.setBarTarget(BAR_TARGET);chartInterval.setMaxBars(MAX_BARS);chartInterval.setInterval("auto");var chartLoader=new _chart_loader.ChartLoader(mlContext.currentIndexPattern,mlContext.combinedQuery);var jobValidator=new _job_validator.JobValidator(jobCreator,existingJobsAndGroups);var resultsLoader=new _results_loader.ResultsLoader(jobCreator,chartInterval,chartLoader);(0,_react.useEffect)((function(){return function(){jobCreator.forceStopRefreshPolls()}}));var jobCreatorTitle=(0,_general.getJobCreatorTitle)(jobCreator);return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiPage,{style:{backgroundColor:"inherit"},"data-test-subj":"mlPageJobWizard ".concat(jobType)},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiPageContent,null,_react.default.createElement(_eui.EuiPageContentHeader,null,_react.default.createElement(_eui.EuiPageContentHeaderSection,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.page.createJob",defaultMessage:"Create job"}),": ",jobCreatorTitle)))),_react.default.createElement(_eui.EuiPageContentBody,null,_react.default.createElement(_wizard.Wizard,{jobCreator:jobCreator,chartLoader:chartLoader,resultsLoader:resultsLoader,chartInterval:chartInterval,jobValidator:jobValidator,existingJobsAndGroups:existingJobsAndGroups,firstWizardStep:firstWizardStep}))))))};exports.Page=Page},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Wizard=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _step_types=__webpack_require__(104);var _job_creator_context=__webpack_require__(53);var _new_job_capabilities_service=__webpack_require__(66);var _wizard_steps=__webpack_require__(1268);var _wizard_horizontal_steps=__webpack_require__(1420);var _new_job=__webpack_require__(60);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var Wizard=function Wizard(_ref){var jobCreator=_ref.jobCreator,chartLoader=_ref.chartLoader,resultsLoader=_ref.resultsLoader,chartInterval=_ref.chartInterval,jobValidator=_ref.jobValidator,existingJobsAndGroups=_ref.existingJobsAndGroups,_ref$firstWizardStep=_ref.firstWizardStep,firstWizardStep=_ref$firstWizardStep===void 0?_step_types.WIZARD_STEPS.TIME_RANGE:_ref$firstWizardStep;var _useReducer=(0,_react.useReducer)((function(s){return s+1}),0),_useReducer2=_slicedToArray(_useReducer,2),jobCreatorUpdated=_useReducer2[0],setJobCreatorUpdate=_useReducer2[1];var jobCreatorUpdate=function jobCreatorUpdate(){return setJobCreatorUpdate(jobCreatorUpdated)};var _useReducer3=(0,_react.useReducer)((function(s){return s+1}),0),_useReducer4=_slicedToArray(_useReducer3,2),jobValidatorUpdated=_useReducer4[0],setJobValidatorUpdate=_useReducer4[1];var jobCreatorContext={jobCreatorUpdated:jobCreatorUpdated,jobCreatorUpdate:jobCreatorUpdate,jobCreator:jobCreator,chartLoader:chartLoader,resultsLoader:resultsLoader,chartInterval:chartInterval,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated,fields:_new_job_capabilities_service.newJobCapsService.fields,aggs:_new_job_capabilities_service.newJobCapsService.aggs,existingJobsAndGroups:existingJobsAndGroups};var firstStep=jobCreator.type===_new_job.JOB_TYPE.ADVANCED?_step_types.WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED:_step_types.WIZARD_STEPS.TIME_RANGE;var _useState=(0,_react.useState)(firstStep),_useState2=_slicedToArray(_useState,2),currentStep=_useState2[0],setCurrentStep=_useState2[1];var _useState3=(0,_react.useState)(firstStep),_useState4=_slicedToArray(_useState3,2),highestStep=_useState4[0],setHighestStep=_useState4[1];var _useState5=(0,_react.useState)(false),_useState6=_slicedToArray(_useState5,2),disableSteps=_useState6[0],setDisableSteps=_useState6[1];var _useState7=(0,_react.useState)(resultsLoader.progress),_useState8=_slicedToArray(_useState7,2),progress=_useState8[0],setProgress=_useState8[1];var _useState9=(0,_react.useState)(stringifyConfigs(jobCreator.jobConfig,jobCreator.datafeedConfig)),_useState10=_slicedToArray(_useState9,2),stringifiedConfigs=_useState10[0],setStringifiedConfigs=_useState10[1];(0,_react.useEffect)((function(){var subscription=jobValidator.validationResult$.subscribe((function(){setJobValidatorUpdate(jobValidatorUpdated)}));return function(){return subscription.unsubscribe()}}),[]);(0,_react.useEffect)((function(){jobValidator.validate((function(){setJobValidatorUpdate(jobValidatorUpdated)}));var tempConfigs=stringifyConfigs(jobCreator.jobConfig,jobCreator.datafeedConfig);if(tempConfigs!==stringifiedConfigs){setHighestStep(currentStep);setStringifiedConfigs(tempConfigs)}}),[jobCreatorUpdated]);(0,_react.useEffect)((function(){jobCreator.subscribeToProgress(setProgress);setCurrentStep(firstWizardStep)}),[]);(0,_react.useEffect)((function(){setDisableSteps(progress>0)}),[progress]);(0,_react.useEffect)((function(){if(currentStep>=highestStep){setHighestStep(currentStep)}}),[currentStep]);return _react.default.createElement(_job_creator_context.JobCreatorContext.Provider,{value:jobCreatorContext},_react.default.createElement(_wizard_horizontal_steps.WizardHorizontalSteps,{currentStep:currentStep,highestStep:highestStep,setCurrentStep:setCurrentStep,disableSteps:disableSteps,jobType:jobCreator.type}),_react.default.createElement(_wizard_steps.WizardSteps,{currentStep:currentStep,setCurrentStep:setCurrentStep}))};exports.Wizard=Wizard;function stringifyConfigs(jobConfig,datafeedConfig){return JSON.stringify(jobConfig)+JSON.stringify(datafeedConfig)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WizardSteps=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _step_types=__webpack_require__(104);var _time_range_step=__webpack_require__(1269);var _pick_fields_step=__webpack_require__(1288);var _job_details_step=__webpack_require__(1359);var _validation_step=__webpack_require__(1386);var _summary_step=__webpack_require__(1390);var _datafeed_step=__webpack_require__(1402);var _ml=__webpack_require__(77);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var WizardSteps=function WizardSteps(_ref){var currentStep=_ref.currentStep,setCurrentStep=_ref.setCurrentStep;var mlContext=(0,_ml.useMlContext)();var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),advancedExpanded=_useState2[0],setAdvancedExpanded=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),additionalExpanded=_useState4[0],setAdditionalExpanded=_useState4[1];function getSummaryStepTitle(){if(mlContext.currentSavedSearch!==null){return _i18n.i18n.translate("xpack.ml.newJob.wizard.stepComponentWrapper.summaryTitleSavedSearch",{defaultMessage:"New job from saved search {title}",values:{title:mlContext.currentSavedSearch.attributes.title}})}else if(mlContext.currentIndexPattern.id!==undefined){return _i18n.i18n.translate("xpack.ml.newJob.wizard.stepComponentWrapper.summaryTitleIndexPattern",{defaultMessage:"New job from index pattern {title}",values:{title:mlContext.currentIndexPattern.title}})}return""}return _react.default.createElement(_react.Fragment,null,currentStep===_step_types.WIZARD_STEPS.TIME_RANGE&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(Title,{"data-test-subj":"mlJobWizardStepTitleTimeRange"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.timeRangeTitle",defaultMessage:"Time range"})),_react.default.createElement(_time_range_step.TimeRangeStep,{isCurrentStep:currentStep===_step_types.WIZARD_STEPS.TIME_RANGE,setCurrentStep:setCurrentStep})),currentStep===_step_types.WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(Title,{"data-test-subj":"mlJobWizardStepTitleConfigureDatafeed"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.configureDatafeedTitle",defaultMessage:"Configure datafeed"})),_react.default.createElement(_datafeed_step.DatafeedStep,{isCurrentStep:currentStep===_step_types.WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED,setCurrentStep:setCurrentStep})),currentStep===_step_types.WIZARD_STEPS.PICK_FIELDS&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(Title,{"data-test-subj":"mlJobWizardStepTitlePickFields"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.pickFieldsTitle",defaultMessage:"Pick fields"})),_react.default.createElement(_pick_fields_step.PickFieldsStep,{isCurrentStep:currentStep===_step_types.WIZARD_STEPS.PICK_FIELDS,setCurrentStep:setCurrentStep})),currentStep===_step_types.WIZARD_STEPS.JOB_DETAILS&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(Title,{"data-test-subj":"mlJobWizardStepTitleJobDetails"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.jobDetailsTitle",defaultMessage:"Job details"})),_react.default.createElement(_job_details_step.JobDetailsStep,{isCurrentStep:currentStep===_step_types.WIZARD_STEPS.JOB_DETAILS,setCurrentStep:setCurrentStep,advancedExpanded:advancedExpanded,setAdvancedExpanded:setAdvancedExpanded,additionalExpanded:additionalExpanded,setAdditionalExpanded:setAdditionalExpanded})),currentStep===_step_types.WIZARD_STEPS.VALIDATION&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(Title,{"data-test-subj":"mlJobWizardStepTitleValidation"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.validationTitle",defaultMessage:"Validation"})),_react.default.createElement(_validation_step.ValidationStep,{isCurrentStep:currentStep===_step_types.WIZARD_STEPS.VALIDATION,setCurrentStep:setCurrentStep})),currentStep===_step_types.WIZARD_STEPS.SUMMARY&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(Title,{"data-test-subj":"mlJobWizardStepTitleSummary"},getSummaryStepTitle()),_react.default.createElement(_summary_step.SummaryStep,{isCurrentStep:currentStep===_step_types.WIZARD_STEPS.SUMMARY,setCurrentStep:setCurrentStep})))};exports.WizardSteps=WizardSteps;var Title=function Title(_ref2){var dataTestSubj=_ref2["data-test-subj"],children=_ref2.children;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h2",{"data-test-subj":dataTestSubj},children)),_react.default.createElement(_eui.EuiSpacer,null))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"TimeRangeStep",{enumerable:true,get:function get(){return _time_range.TimeRangeStep}});var _time_range=__webpack_require__(1270)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeRangeStep=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _moment=_interopRequireDefault(__webpack_require__(32));var _wizard_nav=__webpack_require__(140);var _step_types=__webpack_require__(104);var _job_creator_context=__webpack_require__(53);var _ml=__webpack_require__(77);var _full_time_range_selector=__webpack_require__(201);var _event_rate_chart=__webpack_require__(466);var _new_job=__webpack_require__(60);var _components=__webpack_require__(253);var _kibana=__webpack_require__(57);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var TimeRangeStep=function TimeRangeStep(_ref){var setCurrentStep=_ref.setCurrentStep,isCurrentStep=_ref.isCurrentStep;var _useMlKibana=(0,_kibana.useMlKibana)(),services=_useMlKibana.services;var mlContext=(0,_ml.useMlContext)();var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated,chartLoader=_useContext.chartLoader,chartInterval=_useContext.chartInterval;var _useState=(0,_react.useState)({start:jobCreator.start,end:jobCreator.end}),_useState2=_slicedToArray(_useState,2),timeRange=_useState2[0],setTimeRange=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=_slicedToArray(_useState3,2),eventRateChartData=_useState4[0],setEventRateChartData=_useState4[1];var _useState5=(0,_react.useState)(false),_useState6=_slicedToArray(_useState5,2),loadingData=_useState6[0],setLoadingData=_useState6[1];function loadChart(){return _loadChart.apply(this,arguments)}function _loadChart(){_loadChart=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoadingData(true);_context.prev=1;_context.next=4;return chartLoader.loadEventRateChart(jobCreator.start,jobCreator.end,chartInterval.getInterval().asMilliseconds());case 4:resp=_context.sent;setEventRateChartData(resp);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);setEventRateChartData([]);case 11:setLoadingData(false);case 12:case"end":return _context.stop()}}}),_callee,null,[[1,8]])})));return _loadChart.apply(this,arguments)}(0,_react.useEffect)((function(){var start=timeRange.start,end=timeRange.end;jobCreator.setTimeRange(start,end);chartInterval.setBounds({min:(0,_moment.default)(start),max:(0,_moment.default)(end)});var timefilter=services.data.query.timefilter.timefilter;timefilter.setTime({from:(0,_moment.default)(start).toISOString(),to:(0,_moment.default)(end).toISOString()});jobCreatorUpdate();loadChart()}),[JSON.stringify(timeRange)]);(0,_react.useEffect)((function(){setTimeRange({start:jobCreator.start,end:jobCreator.end})}),[jobCreatorUpdated]);function fullTimeRangeCallback(range){if(range.start.epoch!==null&&range.end.epoch!==null){setTimeRange({start:range.start.epoch,end:range.end.epoch})}else{var toasts=services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.fullTimeRangeError",{defaultMessage:"An error occurred obtaining the time range for the index"}))}}return _react.default.createElement(_react.Fragment,null,isCurrentStep&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_components.TimeRangePicker,{setTimeRange:setTimeRange,timeRange:timeRange})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_full_time_range_selector.FullTimeRangeSelector,{indexPattern:mlContext.currentIndexPattern,query:mlContext.combinedQuery,disabled:false,callback:fullTimeRangeCallback})),_react.default.createElement(_eui.EuiFlexItem,null)),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_event_rate_chart.EventRateChart,{eventRateChartData:eventRateChartData,height:"300px",width:"100%",showAxis:true,loading:loadingData}),_react.default.createElement(_wizard_nav.WizardNav,{next:function next(){return setCurrentStep(jobCreator.type===_new_job.JOB_TYPE.ADVANCED?_step_types.WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED:_step_types.WIZARD_STEPS.PICK_FIELDS)},nextActive:true})))};exports.TimeRangeStep=TimeRangeStep},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NextButton=exports.PreviousButton=exports.WizardNav=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var WizardNav=function WizardNav(_ref){var previous=_ref.previous,_ref$previousActive=_ref.previousActive,previousActive=_ref$previousActive===void 0?true:_ref$previousActive,next=_ref.next,_ref$nextActive=_ref.nextActive,nextActive=_ref$nextActive===void 0?true:_ref$nextActive,children=_ref.children;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHorizontalRule,null),_react.default.createElement(_eui.EuiFlexGroup,null,previous&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(PreviousButton,{previous:previous,previousActive:previousActive})),next&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(NextButton,{next:next,nextActive:nextActive})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},children),_react.default.createElement(_eui.EuiFlexItem,null)))};exports.WizardNav=WizardNav;var PreviousButton=function PreviousButton(_ref2){var previous=_ref2.previous,_ref2$previousActive=_ref2.previousActive,previousActive=_ref2$previousActive===void 0?true:_ref2$previousActive;return _react.default.createElement(_eui.EuiButtonEmpty,{disabled:!previousActive,onClick:previous,iconType:"arrowLeft",iconSide:"left","data-test-subj":"mlJobWizardNavButtonPrevious"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.previousStepButton",defaultMessage:"Previous"}))};exports.PreviousButton=PreviousButton;var NextButton=function NextButton(_ref3){var next=_ref3.next,_ref3$nextActive=_ref3.nextActive,nextActive=_ref3$nextActive===void 0?true:_ref3$nextActive;return _react.default.createElement(_eui.EuiButton,{fill:true,disabled:!nextActive,onClick:next,iconSide:"right",iconType:"arrowRight","data-test-subj":"mlJobWizardNavButtonNext"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.nextStepButton",defaultMessage:"Next"}))};exports.NextButton=NextButton},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FullTimeRangeSelector=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _full_time_range_selector_service=__webpack_require__(465);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}var FullTimeRangeSelector=function FullTimeRangeSelector(_ref){var indexPattern=_ref.indexPattern,query=_ref.query,disabled=_ref.disabled,callback=_ref.callback;function setRange(_x,_x2){return _setRange.apply(this,arguments)}function _setRange(){_setRange=_asyncToGenerator(regeneratorRuntime.mark((function _callee(i,q){var fullTimeRange;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return(0,_full_time_range_selector_service.setFullTimeRange)(i,q);case 2:fullTimeRange=_context.sent;if(typeof callback==="function"){callback(fullTimeRange)}case 4:case"end":return _context.stop()}}}),_callee)})));return _setRange.apply(this,arguments)}return _react.default.createElement(_eui.EuiButton,{isDisabled:disabled,onClick:function onClick(){return setRange(indexPattern,query)},"data-test-subj":"mlButtonUseFullData"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fullTimeRangeSelector.useFullDataButtonLabel",defaultMessage:"Use full {indexPatternTitle} data",values:{indexPatternTitle:indexPattern.title}}))};exports.FullTimeRangeSelector=FullTimeRangeSelector},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EventRateChart=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _charts=__webpack_require__(37);var _axes=__webpack_require__(467);var _settings=__webpack_require__(105);var _loading_wrapper=__webpack_require__(252);var _anomalies=__webpack_require__(475);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var EventRateChart=function EventRateChart(_ref){var eventRateChartData=_ref.eventRateChartData,anomalyData=_ref.anomalyData,height=_ref.height,width=_ref.width,showAxis=_ref.showAxis,_ref$loading=_ref.loading,loading=_ref$loading===void 0?false:_ref$loading,fadeChart=_ref.fadeChart;var _useChartColors=(0,_settings.useChartColors)(),EVENT_RATE_COLOR_WITH_ANOMALIES=_useChartColors.EVENT_RATE_COLOR_WITH_ANOMALIES,EVENT_RATE_COLOR=_useChartColors.EVENT_RATE_COLOR;var barColor=fadeChart?EVENT_RATE_COLOR_WITH_ANOMALIES:EVENT_RATE_COLOR;return _react.default.createElement("div",{style:{width:width,height:height},"data-test-subj":"mlEventRateChart ".concat(eventRateChartData.length?"withData":"empty")},_react.default.createElement(_loading_wrapper.LoadingWrapper,{height:height,hasData:eventRateChartData.length>0,loading:loading},_react.default.createElement(_charts.Chart,null,showAxis===true&&_react.default.createElement(_axes.Axes,null),_react.default.createElement(_charts.Settings,{tooltip:_charts.TooltipType.None}),_react.default.createElement(_anomalies.Anomalies,{anomalyData:anomalyData}),_react.default.createElement(_charts.BarSeries,{id:"event_rate",xScaleType:_charts.ScaleType.Time,yScaleType:_charts.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:eventRateChartData,color:barColor}))))};exports.EventRateChart=EventRateChart},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobRunner",{enumerable:true,get:function get(){return _job_runner.JobRunner}});Object.defineProperty(exports,"ProgressSubscriber",{enumerable:true,get:function get(){return _job_runner.ProgressSubscriber}});var _job_runner=__webpack_require__(1275)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobRunner=void 0;var _rxjs=__webpack_require__(33);var _ml_api_service=__webpack_require__(51);var _job_service=__webpack_require__(58);var _states=__webpack_require__(108);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var REFRESH_INTERVAL_MS=100;var TARGET_PROGRESS_DELTA=2;var REFRESH_RATE_ADJUSTMENT_DELAY_MS=2e3;var JobRunner=function(){function JobRunner(jobCreator){_classCallCheck(this,JobRunner);_defineProperty(this,"_jobId",void 0);_defineProperty(this,"_datafeedId",void 0);_defineProperty(this,"_start",0);_defineProperty(this,"_end",0);_defineProperty(this,"_datafeedState",_states.DATAFEED_STATE.STOPPED);_defineProperty(this,"_refreshInterval",REFRESH_INTERVAL_MS);_defineProperty(this,"_progress$",void 0);_defineProperty(this,"_percentageComplete",0);_defineProperty(this,"_stopRefreshPoll",void 0);_defineProperty(this,"_subscribers",void 0);_defineProperty(this,"_datafeedStartTime",0);_defineProperty(this,"_performRefreshRateAdjustment",false);this._jobId=jobCreator.jobId;this._datafeedId=jobCreator.datafeedId;this._start=jobCreator.start;this._end=jobCreator.end;this._percentageComplete=0;this._stopRefreshPoll=jobCreator.stopAllRefreshPolls;this._progress$=new _rxjs.BehaviorSubject(this._percentageComplete);this._subscribers=jobCreator.subscribers}_createClass(JobRunner,[{key:"resetInterval",value:function resetInterval(){this._refreshInterval=REFRESH_INTERVAL_MS}},{key:"openJob",value:function(){var _openJob=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _job_service.mlJobService.openJob(this._jobId);case 3:_context.next=8;break;case 5:_context.prev=5;_context.t0=_context["catch"](0);throw _context.t0;case 8:case"end":return _context.stop()}}}),_callee,this,[[0,5]])})));function openJob(){return _openJob.apply(this,arguments)}return openJob}()},{key:"_startDatafeed",value:function(){var _startDatafeed2=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(start,end,pollProgress){var _this=this;var subscriptions,_ref,started,check;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;this._datafeedStartTime=Date.now();subscriptions=pollProgress===true?this._subscribers.map((function(s){return _this._progress$.subscribe(s)})):[];_context4.next=5;return this.openJob();case 5:_context4.next=7;return _job_service.mlJobService.startDatafeed(this._datafeedId,this._jobId,start,end);case 7:_ref=_context4.sent;started=_ref.started;this._datafeedState=_states.DATAFEED_STATE.STARTED;this._percentageComplete=0;check=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _ref3,isRunning,prog,isJobClosed,progress;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _this.getProgress();case 2:_ref3=_context3.sent;isRunning=_ref3.isRunning;prog=_ref3.progress;isJobClosed=_ref3.isJobClosed;progress=prog===100&&(isRunning===true||isJobClosed===false)?prog-1:prog;_this._adjustRefreshInterval(progress);_this._percentageComplete=progress;_this._progress$.next(_this._percentageComplete);if((isRunning===true||isJobClosed===false)&&_this._stopRefreshPoll.stop===false){setTimeout(_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return check();case 2:case"end":return _context2.stop()}}}),_callee2)}))),_this._refreshInterval)}else{_this._progress$.next(100);subscriptions.forEach((function(s){return s.unsubscribe()}))}case 11:case"end":return _context3.stop()}}}),_callee3)})));return function check(){return _ref2.apply(this,arguments)}}();if(!(pollProgress===true)){_context4.next=15;break}_context4.next=15;return check();case 15:return _context4.abrupt("return",started);case 18:_context4.prev=18;_context4.t0=_context4["catch"](0);throw _context4.t0;case 21:case"end":return _context4.stop()}}}),_callee4,this,[[0,18]])})));function _startDatafeed(_x,_x2,_x3){return _startDatafeed2.apply(this,arguments)}return _startDatafeed}()},{key:"_adjustRefreshInterval",value:function _adjustRefreshInterval(progress){if(this._performRefreshRateAdjustment===false){var timeDeltaMs=Date.now()-this._datafeedStartTime;if(timeDeltaMs>REFRESH_RATE_ADJUSTMENT_DELAY_MS){this._performRefreshRateAdjustment=true}else{return}}var progressDelta=progress-this._percentageComplete;if(progressDelta!==0){this._refreshInterval=Math.floor(this._refreshInterval*(TARGET_PROGRESS_DELTA/progressDelta));if(this._refreshInterval<REFRESH_INTERVAL_MS){this._refreshInterval=REFRESH_INTERVAL_MS}}}},{key:"startDatafeed",value:function(){var _startDatafeed3=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){return regeneratorRuntime.wrap((function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return this._startDatafeed(this._start,this._end,true);case 2:return _context5.abrupt("return",_context5.sent);case 3:case"end":return _context5.stop()}}}),_callee5,this)})));function startDatafeed(){return _startDatafeed3.apply(this,arguments)}return startDatafeed}()},{key:"startDatafeedInRealTime",value:function(){var _startDatafeedInRealTime=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(continueJob){var start;return regeneratorRuntime.wrap((function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:start=continueJob?this._end:this._start;_context6.next=3;return this._startDatafeed(start,undefined,false);case 3:return _context6.abrupt("return",_context6.sent);case 4:case"end":return _context6.stop()}}}),_callee6,this)})));function startDatafeedInRealTime(_x4){return _startDatafeedInRealTime.apply(this,arguments)}return startDatafeedInRealTime}()},{key:"getProgress",value:function(){var _getProgress=_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){return regeneratorRuntime.wrap((function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return _ml_api_service.ml.jobs.getLookBackProgress(this._jobId,this._start,this._end);case 2:return _context7.abrupt("return",_context7.sent);case 3:case"end":return _context7.stop()}}}),_callee7,this)})));function getProgress(){return _getProgress.apply(this,arguments)}return getProgress}()},{key:"subscribeToProgress",value:function subscribeToProgress(func){this._progress$.subscribe(func)}},{key:"isRunning",value:function(){var _isRunning=_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){var _ref5,isRunning;return regeneratorRuntime.wrap((function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return this.getProgress();case 2:_ref5=_context8.sent;isRunning=_ref5.isRunning;return _context8.abrupt("return",isRunning);case 5:case"end":return _context8.stop()}}}),_callee8,this)})));function isRunning(){return _isRunning.apply(this,arguments)}return isRunning}()},{key:"datafeedState",get:function get(){return this._datafeedState}},{key:"refreshInterval",set:function set(v){this._refreshInterval=v}}]);return JobRunner}();exports.JobRunner=JobRunner},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.VALIDATION_RESULT=void 0;var VALIDATION_RESULT;exports.VALIDATION_RESULT=VALIDATION_RESULT;(function(VALIDATION_RESULT){VALIDATION_RESULT[VALIDATION_RESULT["NO_EXAMPLES"]=0]="NO_EXAMPLES";VALIDATION_RESULT[VALIDATION_RESULT["FAILED_TO_TOKENIZE"]=1]="FAILED_TO_TOKENIZE";VALIDATION_RESULT[VALIDATION_RESULT["TOO_MANY_TOKENS"]=2]="TOO_MANY_TOKENS";VALIDATION_RESULT[VALIDATION_RESULT["TOKEN_COUNT"]=3]="TOKEN_COUNT";VALIDATION_RESULT[VALIDATION_RESULT["MEDIAN_LINE_LENGTH"]=4]="MEDIAN_LINE_LENGTH";VALIDATION_RESULT[VALIDATION_RESULT["NULL_VALUES"]=5]="NULL_VALUES";VALIDATION_RESULT[VALIDATION_RESULT["INSUFFICIENT_PRIVILEGES"]=6]="INSUFFICIENT_PRIVILEGES"})(VALIDATION_RESULT||(exports.VALIDATION_RESULT=VALIDATION_RESULT={}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ResultsLoader=void 0;var _rxjs=__webpack_require__(33);var _job_creator=__webpack_require__(89);var _results_service=__webpack_require__(132);var _anomaly_utils=__webpack_require__(75);var _parse_interval=__webpack_require__(74);var _searches=__webpack_require__(1280);var _new_job=__webpack_require__(60);var _aggregation_types=__webpack_require__(121);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var emptyModelItem={time:0,actual:0,modelUpper:0,modelLower:0};var LAST_UPDATE_DELAY_MS=500;var ResultsLoader=function(){function ResultsLoader(jobCreator,chartInterval,chartLoader){var _this=this;_classCallCheck(this,ResultsLoader);_defineProperty(this,"_results$",void 0);_defineProperty(this,"_resultsSearchRunning",false);_defineProperty(this,"_jobCreator",void 0);_defineProperty(this,"_chartInterval",void 0);_defineProperty(this,"_lastModelTimeStamp",0);_defineProperty(this,"_lastResultsTimeout",null);_defineProperty(this,"_chartLoader",void 0);_defineProperty(this,"_results",{progress:0,model:[],anomalies:[]});_defineProperty(this,"_detectorSplitFieldFilters",null);_defineProperty(this,"_splitFieldFiltersLoaded",false);_defineProperty(this,"progressSubscriber",function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(progress){return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(_this._resultsSearchRunning===false&&(progress-_this._results.progress>5||progress===100))){_context.next=7;break}if(!(_this._splitFieldFiltersLoaded===false)){_context.next=5;break}_this._splitFieldFiltersLoaded=true;_context.next=5;return _this._populateDetectorSplitFieldFilters();case 5:_this._updateData(progress,false);if(progress===100){clearTimeout(_this._lastResultsTimeout);_this._lastResultsTimeout=setTimeout((function(){_this._updateData(progress,true)}),LAST_UPDATE_DELAY_MS)}case 7:case"end":return _context.stop()}}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}());this._jobCreator=jobCreator;this._chartInterval=chartInterval;this._results$=new _rxjs.BehaviorSubject(this._results);this._chartLoader=chartLoader;jobCreator.subscribeToProgress(this.progressSubscriber)}_createClass(ResultsLoader,[{key:"_updateData",value:function(){var _updateData2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(progress,fullRefresh){var _this2=this;var getAnomalyData,_ref2,_ref3,model,anomalies;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this._resultsSearchRunning=true;if(fullRefresh===true){this._clearResults()}this._results.progress=progress;getAnomalyData=this._jobCreator.type===_new_job.JOB_TYPE.SINGLE_METRIC?function(){return _this2._loadJobAnomalyData(0)}:function(){return _this2._loadDetectorsAnomalyData()};_context2.next=6;return Promise.all([this._loadModelData(0),getAnomalyData()]);case 6:_ref2=_context2.sent;_ref3=_slicedToArray(_ref2,2);model=_ref3[0];anomalies=_ref3[1];this._results.model=model;this._results.anomalies=anomalies;this._resultsSearchRunning=false;this._results$.next(this._results);case 14:case"end":return _context2.stop()}}}),_callee2,this)})));function _updateData(_x2,_x3){return _updateData2.apply(this,arguments)}return _updateData}()},{key:"subscribeToResults",value:function subscribeToResults(func){return this._results$.subscribe(func)}},{key:"_clearResults",value:function _clearResults(){this._results.model={};this._results.anomalies={};this._results.progress=0;this._lastModelTimeStamp=0}},{key:"_loadModelData",value:function(){var _loadModelData2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(dtrIndex){var agg,resp;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(this._jobCreator.modelPlot===false)){_context3.next=2;break}return _context3.abrupt("return",[]);case 2:agg=this._jobCreator.getAggregation(dtrIndex);if(!(agg===null)){_context3.next=5;break}return _context3.abrupt("return",_defineProperty({},dtrIndex,[emptyModelItem]));case 5:_context3.next=7;return _results_service.mlResultsService.getModelPlotOutput(this._jobCreator.jobId,dtrIndex,[],this._lastModelTimeStamp,this._jobCreator.end,"".concat(this._chartInterval.getInterval().asMilliseconds(),"ms"),agg.mlModelPlotAgg).toPromise();case 7:resp=_context3.sent;return _context3.abrupt("return",this._createModel(resp,dtrIndex));case 9:case"end":return _context3.stop()}}}),_callee3,this)})));function _loadModelData(_x4){return _loadModelData2.apply(this,arguments)}return _loadModelData}()},{key:"_createModel",value:function _createModel(_ref5,dtrIndex){var results=_ref5.results;if(this._results.model[dtrIndex]===undefined){this._results.model[dtrIndex]=[]}var dslName=this._jobCreator.aggregations[dtrIndex].dslName;var isCountAgg=dslName===_aggregation_types.ES_AGGREGATION.COUNT||dslName===_aggregation_types.ES_AGGREGATION.CARDINALITY;var modelScale=isCountAgg?this._calculateModelScale():1;var model=Object.entries(results).map((function(_ref6){var _ref7=_slicedToArray(_ref6,2),time=_ref7[0],_ref7$=_ref7[1],actual=_ref7$.actual,modelLower=_ref7$.modelLower,modelUpper=_ref7$.modelUpper;return{time:+time,actual:actual,modelUpper:(modelUpper===null?0:modelUpper)*modelScale,modelLower:(modelLower===null?0:modelLower)*modelScale}}));if(model.length>10){this._lastModelTimeStamp=model[model.length-5].time;for(var i=0;i<5;i++){this._results.model[dtrIndex].pop()}}return _defineProperty({},dtrIndex,this._results.model[dtrIndex].concat(model))}},{key:"_loadJobAnomalyData",value:function(){var _loadJobAnomalyData2=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(dtrIndex){var resp,results,anomalies;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _results_service.mlResultsService.getScoresByBucket([this._jobCreator.jobId],this._jobCreator.start,this._jobCreator.end,"".concat(this._chartInterval.getInterval().asMilliseconds(),"ms"),1);case 2:resp=_context4.sent;results=resp.results[this._jobCreator.jobId];if(!(results===undefined)){_context4.next=6;break}return _context4.abrupt("return",[]);case 6:anomalies={};anomalies[0]=Object.entries(results).map((function(_ref9){var _ref10=_slicedToArray(_ref9,2),time=_ref10[0],value=_ref10[1];return{time:+time,value:value,severity:(0,_anomaly_utils.getSeverityType)(value)}}));return _context4.abrupt("return",anomalies);case 9:case"end":return _context4.stop()}}}),_callee4,this)})));function _loadJobAnomalyData(_x5){return _loadJobAnomalyData2.apply(this,arguments)}return _loadJobAnomalyData}()},{key:"_loadDetectorsAnomalyData",value:function(){var _loadDetectorsAnomalyData2=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var resp,anomalies;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return(0,_searches.getScoresByRecord)(this._jobCreator.jobId,this._jobCreator.start,this._jobCreator.end,"".concat(this._chartInterval.getInterval().asMilliseconds(),"ms"),this._detectorSplitFieldFilters);case 2:resp=_context5.sent;anomalies={};Object.entries(resp.results).forEach((function(_ref11){var _ref12=_slicedToArray(_ref11,2),dtrIdx=_ref12[0],results=_ref12[1];anomalies[+dtrIdx]=results.map((function(r){return _objectSpread({},r,{severity:(0,_anomaly_utils.getSeverityType)(r.value)})}))}));return _context5.abrupt("return",anomalies);case 6:case"end":return _context5.stop()}}}),_callee5,this)})));function _loadDetectorsAnomalyData(){return _loadDetectorsAnomalyData2.apply(this,arguments)}return _loadDetectorsAnomalyData}()},{key:"_populateDetectorSplitFieldFilters",value:function(){var _populateDetectorSplitFieldFilters2=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){var fieldValues;return regeneratorRuntime.wrap((function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!(0,_job_creator.isMultiMetricJobCreator)(this._jobCreator)){_context6.next=7;break}if(!(this._jobCreator.splitField!==null)){_context6.next=7;break}_context6.next=4;return this._chartLoader.loadFieldExampleValues(this._jobCreator.splitField);case 4:fieldValues=_context6.sent;if(fieldValues.length>0){this._detectorSplitFieldFilters={name:this._jobCreator.splitField.name,value:fieldValues[0]}}return _context6.abrupt("return");case 7:this._detectorSplitFieldFilters=null;case 8:case"end":return _context6.stop()}}}),_callee6,this)})));function _populateDetectorSplitFieldFilters(){return _populateDetectorSplitFieldFilters2.apply(this,arguments)}return _populateDetectorSplitFieldFilters}()},{key:"_calculateModelScale",value:function _calculateModelScale(){var duration=(0,_parse_interval.parseInterval)(this._jobCreator.bucketSpan);var bucketSpanMs=duration!==null?duration.asMilliseconds():0;var chartIntervalMs=this._chartInterval.getInterval().asMilliseconds();return chartIntervalMs/bucketSpanMs}},{key:"progress",get:function get(){return this._results.progress}}]);return ResultsLoader}();exports.ResultsLoader=ResultsLoader},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getMetricData=getMetricData;exports.getModelPlotOutput=getModelPlotOutput;exports.getRecordsForCriteria=getRecordsForCriteria;exports.getScheduledEventsByBucket=getScheduledEventsByBucket;exports.fetchPartitionFieldsValues=fetchPartitionFieldsValues;var _operators=__webpack_require__(6);var _lodash=_interopRequireDefault(__webpack_require__(49));var _job_utils=__webpack_require__(59);var _ml_api_service=__webpack_require__(51);var _index_patterns=__webpack_require__(120);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function getMetricData(index,entityFields,query,metricFunction,metricFieldName,timeFieldName,earliestMs,latestMs,interval){var shouldCriteria=[];var mustCriteria=[{range:_defineProperty({},timeFieldName,{gte:earliestMs,lte:latestMs,format:"epoch_millis"})}].concat(_toConsumableArray(query?[query]:[]));entityFields.forEach((function(entity){if(entity.fieldValue.length!==0){mustCriteria.push({term:_defineProperty({},entity.fieldName,entity.fieldValue)})}else{shouldCriteria.push({bool:{must:[{term:_defineProperty({},entity.fieldName,"")}]}});shouldCriteria.push({bool:{must_not:[{exists:{field:entity.fieldName}}]}})}}));var body={query:{bool:{must:mustCriteria}},size:0,_source:{excludes:[]},aggs:{byTime:{date_histogram:{field:timeFieldName,interval:interval,min_doc_count:0}}}};if(shouldCriteria.length>0){body.query.bool.should=shouldCriteria;body.query.bool.minimum_should_match=shouldCriteria.length/2}if(metricFieldName!==undefined&&metricFieldName!==""){body.aggs.byTime.aggs={};var metricAgg=_defineProperty({},metricFunction,{field:metricFieldName});if(metricFunction==="percentiles"){metricAgg[metricFunction].percents=[_job_utils.ML_MEDIAN_PERCENTS]}body.aggs.byTime.aggs.metric=metricAgg}return _ml_api_service.ml.esSearch$({index:index,body:body}).pipe((0,_operators.map)((function(resp){var _ref,_resp$aggregations,_resp$aggregations$by;var obj={success:true,results:{}};var dataByTime=(_ref=resp===null||resp===void 0?void 0:(_resp$aggregations=resp.aggregations)===null||_resp$aggregations===void 0?void 0:(_resp$aggregations$by=_resp$aggregations.byTime)===null||_resp$aggregations$by===void 0?void 0:_resp$aggregations$by.buckets)!==null&&_ref!==void 0?_ref:[];dataByTime.forEach((function(dataForTime){if(metricFunction==="count"){obj.results[dataForTime.key]=dataForTime.doc_count}else{var _dataForTime$metric,_dataForTime$metric2;var value=dataForTime===null||dataForTime===void 0?void 0:(_dataForTime$metric=dataForTime.metric)===null||_dataForTime$metric===void 0?void 0:_dataForTime$metric.value;var values=dataForTime===null||dataForTime===void 0?void 0:(_dataForTime$metric2=dataForTime.metric)===null||_dataForTime$metric2===void 0?void 0:_dataForTime$metric2.values;if(dataForTime.doc_count===0){obj.results[dataForTime.key]=null}else if(value!==undefined){obj.results[dataForTime.key]=value}else if(values!==undefined){var medianValues=values[_job_utils.ML_MEDIAN_PERCENTS];obj.results[dataForTime.key]=!isNaN(medianValues)?medianValues:null}else{obj.results[dataForTime.key]=null}}}));return obj})))}function getModelPlotOutput(jobId,detectorIndex,criteriaFields,earliestMs,latestMs,interval,aggType){var obj={success:true,results:{}};var modelAggs=aggType===undefined?{max:"max",min:"min"}:{max:aggType.max,min:aggType.min};var mustCriteria=[{term:{job_id:jobId}},{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}}];_lodash.default.each(criteriaFields,(function(criteria){mustCriteria.push({term:_defineProperty({},criteria.fieldName,criteria.fieldValue)})}));var shouldCriteria=[{term:{detector_index:detectorIndex}},{bool:{must_not:[{exists:{field:"detector_index"}}]}}];return _ml_api_service.ml.esSearch$({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:model_plot",analyze_wildcard:true}},{bool:{must:mustCriteria,should:shouldCriteria,minimum_should_match:1}}]}},aggs:{times:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:0},aggs:{actual:{avg:{field:"actual"}},modelUpper:_defineProperty({},modelAggs.max,{field:"model_upper"}),modelLower:_defineProperty({},modelAggs.min,{field:"model_lower"})}}}}}).pipe((0,_operators.map)((function(resp){var aggregationsByTime=_lodash.default.get(resp,["aggregations","times","buckets"],[]);_lodash.default.each(aggregationsByTime,(function(dataForTime){var time=dataForTime.key;var modelUpper=_lodash.default.get(dataForTime,["modelUpper","value"]);var modelLower=_lodash.default.get(dataForTime,["modelLower","value"]);var actual=_lodash.default.get(dataForTime,["actual","value"]);obj.results[time]={actual:actual,modelUpper:modelUpper===undefined||isFinite(modelUpper)===false?null:modelUpper,modelLower:modelLower===undefined||isFinite(modelLower)===false?null:modelLower}}));return obj})))}function getRecordsForCriteria(jobIds,criteriaFields,threshold,earliestMs,latestMs,maxResults){var obj={success:true,records:[]};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{range:{record_score:{gte:threshold}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,(function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId}));boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}_lodash.default.each(criteriaFields,(function(criteria){boolCriteria.push({term:_defineProperty({},criteria.fieldName,criteria.fieldValue)})}));return _ml_api_service.ml.esSearch$({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,rest_total_hits_as_int:true,size:maxResults!==undefined?maxResults:100,body:{query:{bool:{filter:[{query_string:{query:"result_type:record",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},sort:[{record_score:{order:"desc"}}]}}).pipe((0,_operators.map)((function(resp){if(resp.hits.total!==0){_lodash.default.each(resp.hits.hits,(function(hit){obj.records.push(hit._source)}))}return obj})))}function getScheduledEventsByBucket(jobIds,earliestMs,latestMs,interval,maxJobs,maxEvents){var obj={success:true,events:{}};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{exists:{field:"scheduled_events"}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,(function(jobId,i){jobIdFilterStr+="".concat(i>0?" OR ":"","job_id:").concat(jobId)}));boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}return _ml_api_service.ml.esSearch$({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:bucket",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},aggs:{jobs:{terms:{field:"job_id",min_doc_count:1,size:maxJobs},aggs:{times:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1},aggs:{events:{terms:{field:"scheduled_events",size:maxEvents}}}}}}}}}).pipe((0,_operators.map)((function(resp){var dataByJobId=_lodash.default.get(resp,["aggregations","jobs","buckets"],[]);_lodash.default.each(dataByJobId,(function(dataForJob){var jobId=dataForJob.key;var resultsForTime={};var dataByTime=_lodash.default.get(dataForJob,["times","buckets"],[]);_lodash.default.each(dataByTime,(function(dataForTime){var time=dataForTime.key;var events=_lodash.default.get(dataForTime,["events","buckets"]);resultsForTime[time]=_lodash.default.map(events,"key")}));obj.events[jobId]=resultsForTime}));return obj})))}function fetchPartitionFieldsValues(jobId,searchTerm,criteriaFields,earliestMs,latestMs){return _ml_api_service.ml.results.fetchPartitionFieldsValues(jobId,searchTerm,criteriaFields,earliestMs,latestMs)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getScoresByBucket=getScoresByBucket;exports.getTopInfluencers=getTopInfluencers;exports.getTopInfluencerValues=getTopInfluencerValues;exports.getOverallBucketScores=getOverallBucketScores;exports.getInfluencerValueMaxScoreByTime=getInfluencerValueMaxScoreByTime;exports.getRecordInfluencers=getRecordInfluencers;exports.getRecordsForInfluencer=getRecordsForInfluencer;exports.getRecordsForDetector=getRecordsForDetector;exports.getRecords=getRecords;exports.getEventRateData=getEventRateData;exports.getEventDistributionData=getEventDistributionData;exports.getRecordMaxScoreByTime=getRecordMaxScoreByTime;var _lodash=_interopRequireDefault(__webpack_require__(49));var _job_utils=__webpack_require__(59);var _string_utils=__webpack_require__(80);var _index_patterns=__webpack_require__(120);var _ml_api_service=__webpack_require__(51);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getScoresByBucket(jobIds,earliestMs,latestMs,interval,maxResults){return new Promise((function(resolve,reject){var obj={success:true,results:{}};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,(function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId}));boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:bucket",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},aggs:{jobId:{terms:{field:"job_id",size:maxResults!==undefined?maxResults:5,order:{anomalyScore:"desc"}},aggs:{anomalyScore:{max:{field:"anomaly_score"}},byTime:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1,extended_bounds:{min:earliestMs,max:latestMs}},aggs:{anomalyScore:{max:{field:"anomaly_score"}}}}}}}}}).then((function(resp){var dataByJobId=_lodash.default.get(resp,["aggregations","jobId","buckets"],[]);_lodash.default.each(dataByJobId,(function(dataForJob){var jobId=dataForJob.key;var resultsForTime={};var dataByTime=_lodash.default.get(dataForJob,["byTime","buckets"],[]);_lodash.default.each(dataByTime,(function(dataForTime){var value=_lodash.default.get(dataForTime,["anomalyScore","value"]);if(value!==undefined){var time=dataForTime.key;resultsForTime[time]=_lodash.default.get(dataForTime,["anomalyScore","value"])}}));obj.results[jobId]=resultsForTime}));resolve(obj)})).catch((function(resp){reject(resp)}))}))}function getTopInfluencers(jobIds,earliestMs,latestMs){var maxFieldValues=arguments.length>3&&arguments[3]!==undefined?arguments[3]:10;var influencers=arguments.length>4&&arguments[4]!==undefined?arguments[4]:[];var influencersFilterQuery=arguments.length>5?arguments[5]:undefined;return new Promise((function(resolve,reject){var obj={success:true,influencers:{}};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{range:{influencer_score:{gt:0}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,(function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId}));boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}if(influencersFilterQuery!==undefined){boolCriteria.push(influencersFilterQuery)}if(influencers.length>0){boolCriteria.push({bool:{should:influencers.map((function(influencer){return{bool:{must:[{term:{influencer_field_name:influencer.fieldName}},{term:{influencer_field_value:influencer.fieldValue}}]}}})),minimum_should_match:1}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:influencer",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},aggs:{influencerFieldNames:{terms:{field:"influencer_field_name",size:5,order:{maxAnomalyScore:"desc"}},aggs:{maxAnomalyScore:{max:{field:"influencer_score"}},influencerFieldValues:{terms:{field:"influencer_field_value",size:maxFieldValues,order:{maxAnomalyScore:"desc"}},aggs:{maxAnomalyScore:{max:{field:"influencer_score"}},sumAnomalyScore:{sum:{field:"influencer_score"}}}}}}}}}).then((function(resp){var fieldNameBuckets=_lodash.default.get(resp,["aggregations","influencerFieldNames","buckets"],[]);_lodash.default.each(fieldNameBuckets,(function(nameBucket){var fieldName=nameBucket.key;var fieldValues=[];var fieldValueBuckets=_lodash.default.get(nameBucket,["influencerFieldValues","buckets"],[]);_lodash.default.each(fieldValueBuckets,(function(valueBucket){var fieldValueResult={influencerFieldValue:valueBucket.key,maxAnomalyScore:valueBucket.maxAnomalyScore.value,sumAnomalyScore:valueBucket.sumAnomalyScore.value};fieldValues.push(fieldValueResult)}));obj.influencers[fieldName]=fieldValues}));resolve(obj)})).catch((function(resp){reject(resp)}))}))}function getTopInfluencerValues(jobIds,influencerFieldName,earliestMs,latestMs,maxResults){return new Promise((function(resolve,reject){var obj={success:true,results:[]};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,(function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId}));boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:influencer AND influencer_field_name: ".concat((0,_string_utils.escapeForElasticsearchQuery)(influencerFieldName)),analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},aggs:{influencerFieldValues:{terms:{field:"influencer_field_value",size:maxResults!==undefined?maxResults:2,order:{maxAnomalyScore:"desc"}},aggs:{maxAnomalyScore:{max:{field:"influencer_score"}},sumAnomalyScore:{sum:{field:"influencer_score"}}}}}}}).then((function(resp){var buckets=_lodash.default.get(resp,["aggregations","influencerFieldValues","buckets"],[]);_lodash.default.each(buckets,(function(bucket){var result={influencerFieldValue:bucket.key,maxAnomalyScore:bucket.maxAnomalyScore.value,sumAnomalyScore:bucket.sumAnomalyScore.value};obj.results.push(result)}));resolve(obj)})).catch((function(resp){reject(resp)}))}))}function getOverallBucketScores(jobIds,topN,earliestMs,latestMs,interval){return new Promise((function(resolve,reject){var obj={success:true,results:{}};_ml_api_service.ml.overallBuckets({jobId:jobIds,topN:topN,bucketSpan:interval,start:earliestMs,end:latestMs}).then((function(resp){var dataByTime=_lodash.default.get(resp,["overall_buckets"],[]);_lodash.default.each(dataByTime,(function(dataForTime){var value=_lodash.default.get(dataForTime,["overall_score"]);if(value!==undefined){obj.results[dataForTime.timestamp]=value}}));resolve(obj)})).catch((function(resp){reject(resp)}))}))}function getInfluencerValueMaxScoreByTime(jobIds,influencerFieldName,influencerFieldValues,earliestMs,latestMs,interval,maxResults,influencersFilterQuery){return new Promise((function(resolve,reject){var obj={success:true,results:{}};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{range:{influencer_score:{gt:0}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,(function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:".concat(jobId)}));boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}if(influencersFilterQuery!==undefined){boolCriteria.push(influencersFilterQuery)}if(influencerFieldValues&&influencerFieldValues.length>0){var influencerFilterStr="";_lodash.default.each(influencerFieldValues,(function(value,i){if(i>0){influencerFilterStr+=" OR "}if(value.trim().length>0){influencerFilterStr+="influencer_field_value:".concat((0,_string_utils.escapeForElasticsearchQuery)(value))}else{influencerFilterStr+='influencer_field_value:"'.concat(value,'"')}}));boolCriteria.push({query_string:{analyze_wildcard:false,query:influencerFilterStr}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:influencer AND influencer_field_name: ".concat((0,_string_utils.escapeForElasticsearchQuery)(influencerFieldName)),analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},aggs:{influencerFieldValues:{terms:{field:"influencer_field_value",size:maxResults!==undefined?maxResults:10,order:{maxAnomalyScore:"desc"}},aggs:{maxAnomalyScore:{max:{field:"influencer_score"}},byTime:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1},aggs:{maxAnomalyScore:{max:{field:"influencer_score"}}}}}}}}}).then((function(resp){var fieldValueBuckets=_lodash.default.get(resp,["aggregations","influencerFieldValues","buckets"],[]);_lodash.default.each(fieldValueBuckets,(function(valueBucket){var fieldValue=valueBucket.key;var fieldValues={};var timeBuckets=_lodash.default.get(valueBucket,["byTime","buckets"],[]);_lodash.default.each(timeBuckets,(function(timeBucket){var time=timeBucket.key;var score=timeBucket.maxAnomalyScore.value;fieldValues[time]=score}));obj.results[fieldValue]=fieldValues}));resolve(obj)})).catch((function(resp){reject(resp)}))}))}function getRecordInfluencers(jobIds,threshold,earliestMs,latestMs,maxResults){return new Promise((function(resolve,reject){var obj={success:true,records:[]};var boolCriteria=[{nested:{path:"influencers",query:{bool:{must:[{exists:{field:"influencers"}}]}}}},{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{range:{record_score:{gte:threshold}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,(function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId}));boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:maxResults!==undefined?maxResults:100,rest_total_hits_as_int:true,body:{_source:["job_id","detector_index","influencers","record_score"],query:{bool:{filter:[{query_string:{query:"result_type:record",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},sort:[{record_score:{order:"desc"}}]}}).then((function(resp){if(resp.hits.total!==0){_lodash.default.each(resp.hits.hits,(function(hit){obj.records.push(hit._source)}))}resolve(obj)})).catch((function(resp){reject(resp)}))}))}function getRecordsForInfluencer(jobIds,influencers,threshold,earliestMs,latestMs,maxResults,influencersFilterQuery){return new Promise((function(resolve,reject){var obj={success:true,records:[]};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{range:{record_score:{gte:threshold}}}];if(jobIds&&jobIds.length>0&&!(jobIds.length===1&&jobIds[0]==="*")){var jobIdFilterStr="";_lodash.default.each(jobIds,(function(jobId,i){if(i>0){jobIdFilterStr+=" OR "}jobIdFilterStr+="job_id:";jobIdFilterStr+=jobId}));boolCriteria.push({query_string:{analyze_wildcard:false,query:jobIdFilterStr}})}if(influencersFilterQuery!==undefined){boolCriteria.push(influencersFilterQuery)}if(influencers.length>0){boolCriteria.push({bool:{should:influencers.map((function(influencer){return{nested:{path:"influencers",query:{bool:{must:[{match:{"influencers.influencer_field_name":influencer.fieldName}},{match:{"influencers.influencer_field_values":influencer.fieldValue}}]}}}}})),minimum_should_match:1}})}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:maxResults!==undefined?maxResults:100,rest_total_hits_as_int:true,body:{query:{bool:{filter:[{query_string:{query:"result_type:record",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},sort:[{record_score:{order:"desc"}}]}}).then((function(resp){if(resp.hits.total!==0){_lodash.default.each(resp.hits.hits,(function(hit){obj.records.push(hit._source)}))}resolve(obj)})).catch((function(resp){reject(resp)}))}))}function getRecordsForDetector(jobId,detectorIndex,checkForInfluencers,influencerFieldName,influencerFieldValue,threshold,earliestMs,latestMs,maxResults){return new Promise((function(resolve,reject){var obj={success:true,records:[]};var boolCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{term:{job_id:jobId}},{term:{detector_index:detectorIndex}},{range:{record_score:{gte:threshold}}}];if(influencerFieldName&&influencerFieldValue){boolCriteria.push({nested:{path:"influencers",query:{bool:{must:[{match:{"influencers.influencer_field_name":influencerFieldName}},{match:{"influencers.influencer_field_values":influencerFieldValue}}]}}}})}else{if(checkForInfluencers===true){boolCriteria.push({nested:{path:"influencers",query:{bool:{must:[{exists:{field:"influencers"}}]}}}})}}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:maxResults!==undefined?maxResults:100,rest_total_hits_as_int:true,body:{query:{bool:{filter:[{query_string:{query:"result_type:record",analyze_wildcard:false}},{bool:{must:boolCriteria}}]}},sort:[{record_score:{order:"desc"}}]}}).then((function(resp){if(resp.hits.total!==0){_lodash.default.each(resp.hits.hits,(function(hit){obj.records.push(hit._source)}))}resolve(obj)})).catch((function(resp){reject(resp)}))}))}function getRecords(jobIds,threshold,earliestMs,latestMs,maxResults){return this.getRecordsForInfluencer(jobIds,[],threshold,earliestMs,latestMs,maxResults)}function getEventRateData(index,query,timeFieldName,earliestMs,latestMs,interval){return new Promise((function(resolve,reject){var obj={success:true,results:{}};var mustCriteria=[{range:_defineProperty({},timeFieldName,{gte:earliestMs,lte:latestMs,format:"epoch_millis"})}];if(query){mustCriteria.push(query)}_ml_api_service.ml.esSearch({index:index,rest_total_hits_as_int:true,size:0,body:{query:{bool:{must:mustCriteria}},_source:{excludes:[]},aggs:{eventRate:{date_histogram:{field:timeFieldName,interval:interval,min_doc_count:0,extended_bounds:{min:earliestMs,max:latestMs}}}}}}).then((function(resp){var dataByTimeBucket=_lodash.default.get(resp,["aggregations","eventRate","buckets"],[]);_lodash.default.each(dataByTimeBucket,(function(dataForTime){var time=dataForTime.key;obj.results[time]=dataForTime.doc_count}));obj.total=resp.hits.total;resolve(obj)})).catch((function(resp){reject(resp)}))}))}var SAMPLER_TOP_TERMS_SHARD_SIZE=2e4;var ENTITY_AGGREGATION_SIZE=10;var AGGREGATION_MIN_DOC_COUNT=1;var CARDINALITY_PRECISION_THRESHOLD=100;function getEventDistributionData(index,splitField){var filterField=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var query=arguments.length>3?arguments[3]:undefined;var metricFunction=arguments.length>4?arguments[4]:undefined;var metricFieldName=arguments.length>5?arguments[5]:undefined;var timeFieldName=arguments.length>6?arguments[6]:undefined;var earliestMs=arguments.length>7?arguments[7]:undefined;var latestMs=arguments.length>8?arguments[8]:undefined;var interval=arguments.length>9?arguments[9]:undefined;return new Promise((function(resolve,reject){if(splitField===undefined){return resolve([])}var mustCriteria=[];mustCriteria.push({range:_defineProperty({},timeFieldName,{gte:earliestMs,lte:latestMs,format:"epoch_millis"})});if(query){mustCriteria.push(query)}if(filterField!==null){mustCriteria.push({term:_defineProperty({},filterField.fieldName,filterField.fieldValue)})}var body={query:{function_score:{query:{bool:{must:mustCriteria}},functions:[{random_score:{seed:10,field:"_seq_no"}}]}},size:0,_source:{excludes:[]},aggs:{sample:{sampler:{shard_size:SAMPLER_TOP_TERMS_SHARD_SIZE},aggs:{byTime:{date_histogram:{field:timeFieldName,interval:interval,min_doc_count:AGGREGATION_MIN_DOC_COUNT},aggs:{entities:{terms:{field:splitField.fieldName,size:ENTITY_AGGREGATION_SIZE,min_doc_count:AGGREGATION_MIN_DOC_COUNT}}}}}}}};if(metricFieldName!==undefined&&metricFieldName!==""){body.aggs.sample.aggs.byTime.aggs.entities.aggs={};var metricAgg=_defineProperty({},metricFunction,{field:metricFieldName});if(metricFunction==="percentiles"){metricAgg[metricFunction].percents=[_job_utils.ML_MEDIAN_PERCENTS]}if(metricFunction==="cardinality"){metricAgg[metricFunction].precision_threshold=CARDINALITY_PRECISION_THRESHOLD}body.aggs.sample.aggs.byTime.aggs.entities.aggs.metric=metricAgg}_ml_api_service.ml.esSearch({index:index,body:body,rest_total_hits_as_int:true}).then((function(resp){var totalHits=_lodash.default.get(resp,["hits","total"],0);var successfulShards=_lodash.default.get(resp,["_shards","successful"],0);var normalizeFactor=1;if(totalHits>successfulShards*SAMPLER_TOP_TERMS_SHARD_SIZE){normalizeFactor=totalHits/(successfulShards*SAMPLER_TOP_TERMS_SHARD_SIZE)}var dataByTime=_lodash.default.get(resp,["aggregations","sample","byTime","buckets"],[]);var data=dataByTime.reduce((function(d,dataForTime){var date=+dataForTime.key;var entities=_lodash.default.get(dataForTime,["entities","buckets"],[]);entities.forEach((function(entity){var value=metricFunction==="count"?entity.doc_count:entity.metric.value;if(metricFunction==="count"||metricFunction==="cardinality"||metricFunction==="sum"){value=value*normalizeFactor}d.push({date:date,entity:entity.key,value:value})}));return d}),[]);resolve(data)})).catch((function(resp){reject(resp)}))}))}function getRecordMaxScoreByTime(jobId,criteriaFields,earliestMs,latestMs,interval){return new Promise((function(resolve,reject){var obj={success:true,results:{}};var mustCriteria=[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{term:{job_id:jobId}}];_lodash.default.each(criteriaFields,(function(criteria){mustCriteria.push({term:_defineProperty({},criteria.fieldName,criteria.fieldValue)})}));_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:record",analyze_wildcard:true}},{bool:{must:mustCriteria}}]}},aggs:{times:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1},aggs:{recordScore:{max:{field:"record_score"}}}}}}}).then((function(resp){var aggregationsByTime=_lodash.default.get(resp,["aggregations","times","buckets"],[]);_lodash.default.each(aggregationsByTime,(function(dataForTime){var time=dataForTime.key;obj.results[time]={score:_lodash.default.get(dataForTime,["recordScore","value"])}}));resolve(obj)})).catch((function(resp){reject(resp)}))}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getScoresByRecord=getScoresByRecord;var _lodash=__webpack_require__(49);var _index_patterns=__webpack_require__(120);var _string_utils=__webpack_require__(80);var _ml_api_service=__webpack_require__(51);function getScoresByRecord(jobId,earliestMs,latestMs,interval,firstSplitField){return new Promise((function(resolve,reject){var obj={success:true,results:{},totalResults:0};var jobIdFilterStr="job_id: "+jobId;if(firstSplitField&&firstSplitField.value!==undefined){jobIdFilterStr+=" AND ".concat((0,_string_utils.escapeForElasticsearchQuery)(firstSplitField.name),":");jobIdFilterStr+='"'.concat(String(firstSplitField.value).replace(/\\/g,"\\\\"),'"')}_ml_api_service.ml.esSearch({index:_index_patterns.ML_RESULTS_INDEX_PATTERN,size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:record"}},{bool:{must:[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{query_string:{query:jobIdFilterStr}}]}}]}},aggs:{detector_index:{terms:{field:"detector_index",order:{recordScore:"desc"}},aggs:{recordScore:{max:{field:"record_score"}},byTime:{date_histogram:{field:"timestamp",interval:interval,min_doc_count:1,extended_bounds:{min:earliestMs,max:latestMs}},aggs:{recordScore:{max:{field:"record_score"}}}}}}}}}).then((function(resp){var detectorsByIndex=(0,_lodash.get)(resp,["aggregations","detector_index","buckets"],[]);detectorsByIndex.forEach((function(dtr){var dtrResults=[];var dtrIndex=+dtr.key;var buckets=(0,_lodash.get)(dtr,["byTime","buckets"],[]);for(var j=0;j<buckets.length;j++){var bkt=buckets[j];var time=bkt.key;dtrResults.push({time:time,value:(0,_lodash.get)(bkt,["recordScore","value"])})}obj.results[dtrIndex]=dtrResults}));resolve(obj)})).catch((function(resp){reject(resp)}))}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CategorizationExamplesLoader=void 0;var _ml_api_service=__webpack_require__(51);var _categorization_job=__webpack_require__(142);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CategorizationExamplesLoader=function(){function CategorizationExamplesLoader(jobCreator,indexPattern,query){_classCallCheck(this,CategorizationExamplesLoader);_defineProperty(this,"_jobCreator",void 0);_defineProperty(this,"_indexPatternTitle","");_defineProperty(this,"_timeFieldName","");_defineProperty(this,"_query",{});this._jobCreator=jobCreator;this._indexPatternTitle=indexPattern.title;this._query=query;if(typeof indexPattern.timeFieldName==="string"){this._timeFieldName=indexPattern.timeFieldName}}_createClass(CategorizationExamplesLoader,[{key:"loadExamples",value:function(){var _loadExamples=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var analyzer,categorizationFieldName,resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:analyzer=this._jobCreator.categorizationAnalyzer;categorizationFieldName=this._jobCreator.categorizationFieldName;if(!(categorizationFieldName===null)){_context.next=4;break}return _context.abrupt("return",{examples:[],sampleSize:0,overallValidStatus:_categorization_job.CATEGORY_EXAMPLES_VALIDATION_STATUS.INVALID,validationChecks:[]});case 4:_context.next=6;return _ml_api_service.ml.jobs.categorizationFieldExamples(this._indexPatternTitle,this._query,_categorization_job.NUMBER_OF_CATEGORY_EXAMPLES,categorizationFieldName,this._timeFieldName,this._jobCreator.start,this._jobCreator.end,analyzer);case 6:resp=_context.sent;return _context.abrupt("return",resp);case 8:case"end":return _context.stop()}}}),_callee,this)})));function loadExamples(){return _loadExamples.apply(this,arguments)}return loadExamples}()}]);return CategorizationExamplesLoader}();exports.CategorizationExamplesLoader=CategorizationExamplesLoader},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isSingleMetricJobCreator=isSingleMetricJobCreator;exports.isMultiMetricJobCreator=isMultiMetricJobCreator;exports.isPopulationJobCreator=isPopulationJobCreator;exports.isAdvancedJobCreator=isAdvancedJobCreator;exports.isCategorizationJobCreator=isCategorizationJobCreator;var _new_job=__webpack_require__(60);function isSingleMetricJobCreator(jobCreator){return jobCreator.type===_new_job.JOB_TYPE.SINGLE_METRIC}function isMultiMetricJobCreator(jobCreator){return jobCreator.type===_new_job.JOB_TYPE.MULTI_METRIC}function isPopulationJobCreator(jobCreator){return jobCreator.type===_new_job.JOB_TYPE.POPULATION}function isAdvancedJobCreator(jobCreator){return jobCreator.type===_new_job.JOB_TYPE.ADVANCED}function isCategorizationJobCreator(jobCreator){return jobCreator.type===_new_job.JOB_TYPE.CATEGORIZATION}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.jobCreatorFactory=void 0;var _single_metric_job_creator=__webpack_require__(469);var _multi_metric_job_creator=__webpack_require__(470);var _population_job_creator=__webpack_require__(471);var _advanced_job_creator=__webpack_require__(472);var _categorization_job_creator=__webpack_require__(473);var _new_job=__webpack_require__(60);var jobCreatorFactory=function jobCreatorFactory(jobType){return function(indexPattern,savedSearch,query){var jc;switch(jobType){case _new_job.JOB_TYPE.SINGLE_METRIC:jc=_single_metric_job_creator.SingleMetricJobCreator;break;case _new_job.JOB_TYPE.MULTI_METRIC:jc=_multi_metric_job_creator.MultiMetricJobCreator;break;case _new_job.JOB_TYPE.POPULATION:jc=_population_job_creator.PopulationJobCreator;break;case _new_job.JOB_TYPE.ADVANCED:jc=_advanced_job_creator.AdvancedJobCreator;break;case _new_job.JOB_TYPE.CATEGORIZATION:jc=_categorization_job_creator.CategorizationJobCreator;break;default:jc=_single_metric_job_creator.SingleMetricJobCreator;break}return new jc(indexPattern,savedSearch,query)}};exports.jobCreatorFactory=jobCreatorFactory},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.timeBucketsCalcAutoIntervalProvider=timeBucketsCalcAutoIntervalProvider;var _moment=_interopRequireDefault(__webpack_require__(32));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var d=_moment.default.duration;function timeBucketsCalcAutoIntervalProvider(){var roundingRules=[[d(500,"ms"),d(100,"ms")],[d(5,"second"),d(1,"second")],[d(10,"second"),d(5,"second")],[d(15,"second"),d(10,"second")],[d(30,"second"),d(15,"second")],[d(1,"minute"),d(30,"second")],[d(5,"minute"),d(1,"minute")],[d(10,"minute"),d(5,"minute")],[d(15,"minute"),d(10,"minute")],[d(30,"minute"),d(10,"minute")],[d(1,"hour"),d(30,"minute")],[d(2,"hour"),d(1,"hour")],[d(4,"hour"),d(2,"hour")],[d(6,"hour"),d(4,"hour")],[d(8,"hour"),d(6,"hour")],[d(12,"hour"),d(8,"hour")],[d(24,"hour"),d(12,"hour")],[d(2,"d"),d(1,"d")],[d(4,"d"),d(2,"d")],[d(1,"week"),d(4,"d")],[d(1,"month"),d(1,"week")],[d(1,"year"),d(1,"month")],[Infinity,d(1,"year")]];var revRoundingRules=roundingRules.slice(0).reverse();function find(rules,check,last){function pick(buckets,duration){var target=duration/buckets;var lastResp;for(var i=0;i<rules.length;i++){var rule=rules[i];var resp=check(rule[0],rule[1],target);if(resp==null){if(!last){continue}if(lastResp){return lastResp}break}if(!last){return resp}lastResp=resp}var ms=Math.max(Math.floor(target),1);return _moment.default.duration(ms,"ms")}return function(buckets,duration){var interval=pick(buckets,duration);if(interval){return _moment.default.duration(interval._data)}}}return{near:find(revRoundingRules,(function near(upperBound,lowerBound,target){if(upperBound>target){if(upperBound===Infinity){return lowerBound}var boundMs=upperBound.asMilliseconds();var intervalMs=lowerBound.asMilliseconds();var retInterval=Math.abs(boundMs-target)<=Math.abs(intervalMs)?upperBound:lowerBound;return retInterval}}),true),lessThan:find(revRoundingRules,(function(upperBound,lowerBound,target){if(lowerBound<target){return upperBound!==Infinity?upperBound:lowerBound}})),atLeast:find(revRoundingRules,(function atLeast(upperBound,lowerBound,target){if(lowerBound<=target){return lowerBound}}))}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LoadingWrapper=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var LoadingWrapper=function LoadingWrapper(_ref){var hasData=_ref.hasData,_ref$loading=_ref.loading,loading=_ref$loading===void 0?false:_ref$loading,height=_ref.height,children=_ref.children;var opacity=loading===true?hasData===true?.3:0:1;return _react.default.createElement(_react.Fragment,null,_react.default.createElement("div",{style:{height:"100%",opacity:opacity,transition:"opacity 0.2s"}},children),loading===true&&_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center",style:height!==undefined?{height:height,marginTop:"-".concat(height)}:{}},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiLoadingSpinner,{size:"xl"}))))};exports.LoadingWrapper=LoadingWrapper},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobGroupsInput=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _group_color_utils=__webpack_require__(151);var _description=__webpack_require__(476);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var JobGroupsInput=(0,_react.memo)((function(_ref){var existingGroups=_ref.existingGroups,selectedGroups=_ref.selectedGroups,onChange=_ref.onChange,validation=_ref.validation;var options=existingGroups.map((function(g){return{label:g,color:(0,_group_color_utils.tabColor)(g)}}));var selectedOptions=selectedGroups.map((function(g){return{label:g,color:(0,_group_color_utils.tabColor)(g)}}));function onChangeCallback(optionsIn){onChange(optionsIn.map((function(g){return g.label})))}function onCreateGroup(input,flattenedOptions){var normalizedSearchValue=input.trim().toLowerCase();if(!normalizedSearchValue){return}var newGroup={label:input,color:(0,_group_color_utils.tabColor)(input)};if(flattenedOptions.findIndex((function(option){return option.label.trim().toLowerCase()===normalizedSearchValue}))===-1){options.push(newGroup)}onChangeCallback([].concat(_toConsumableArray(selectedOptions),[newGroup]))}return _react.default.createElement(_description.Description,{validation:validation},_react.default.createElement(_eui.EuiComboBox,{placeholder:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.placeholder",{defaultMessage:"Select or create groups"}),options:options,selectedOptions:selectedOptions,onChange:onChangeCallback,onCreateOption:onCreateGroup,isClearable:true,isInvalid:!validation.valid,"data-test-subj":"mlJobWizardComboBoxJobGroups"}))}));exports.JobGroupsInput=JobGroupsInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeRangePicker=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _moment=_interopRequireDefault(__webpack_require__(32));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _ml=__webpack_require__(77);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var WIDTH="512px";var TimeRangePicker=function TimeRangePicker(_ref){var setTimeRange=_ref.setTimeRange,timeRange=_ref.timeRange;var mlContext=(0,_ml.useMlContext)();var dateFormat=mlContext.kibanaConfig.get("dateFormat");var _useState=(0,_react.useState)((0,_moment.default)(timeRange.start)),_useState2=_slicedToArray(_useState,2),startMoment=_useState2[0],setStartMoment=_useState2[1];var _useState3=(0,_react.useState)((0,_moment.default)(timeRange.end)),_useState4=_slicedToArray(_useState3,2),endMoment=_useState4[0],setEndMoment=_useState4[1];function handleChangeStart(date){setStartMoment(date||undefined)}function handleChangeEnd(date){setEndMoment(date||undefined)}(0,_react.useEffect)((function(){if(startMoment!==undefined&&endMoment!==undefined){setTimeRange({start:startMoment.valueOf(),end:endMoment.valueOf()})}}),[startMoment,endMoment]);(0,_react.useEffect)((function(){setStartMoment((0,_moment.default)(timeRange.start));setEndMoment((0,_moment.default)(timeRange.end))}),[JSON.stringify(timeRange)]);return _react.default.createElement(_react.Fragment,null,_react.default.createElement("div",{style:{minWidth:WIDTH},"data-test-subj":"mlJobWizardDateRange"},_react.default.createElement(_eui.EuiDatePickerRange,{fullWidth:true,startDateControl:_react.default.createElement(_eui.EuiDatePicker,{selected:startMoment,onChange:handleChangeStart,startDate:startMoment,endDate:endMoment,"aria-label":_i18n.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.timeRangePicker.startDateLabel",{defaultMessage:"Start date"}),showTimeSelect:true,dateFormat:dateFormat,maxDate:endMoment}),endDateControl:_react.default.createElement(_eui.EuiDatePicker,{selected:endMoment,onChange:handleChangeEnd,startDate:startMoment,endDate:endMoment,"aria-label":_i18n.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.timeRangePicker.endDateLabel",{defaultMessage:"End date"}),showTimeSelect:true,dateFormat:dateFormat,minDate:startMoment})})))};exports.TimeRangePicker=TimeRangePicker},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"PickFieldsStep",{enumerable:true,get:function get(){return _pick_fields.PickFieldsStep}});var _pick_fields=__webpack_require__(1289)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PickFieldsStep=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _wizard_nav=__webpack_require__(140);var _step_types=__webpack_require__(104);var _new_job=__webpack_require__(60);var _single_metric_view=__webpack_require__(477);var _multi_metric_view=__webpack_require__(479);var _population_view=__webpack_require__(484);var _advanced_view=__webpack_require__(486);var _categorization_view=__webpack_require__(490);var _json_editor_flyout=__webpack_require__(257);var _datafeed_preview_flyout=__webpack_require__(258);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var PickFieldsStep=function PickFieldsStep(_ref){var setCurrentStep=_ref.setCurrentStep,isCurrentStep=_ref.isCurrentStep;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),nextActive=_useState2[0],setNextActive=_useState2[1];var jobType=jobCreator.type;(0,_react.useEffect)((function(){var active=jobCreator.detectors.length>0&&(jobCreator.type!==_new_job.JOB_TYPE.ADVANCED||jobCreator.type===_new_job.JOB_TYPE.ADVANCED&&jobValidator.modelMemoryLimit.valid)&&jobValidator.bucketSpan.valid&&jobValidator.duplicateDetectors.valid&&jobValidator.validating===false&&(jobCreator.type!==_new_job.JOB_TYPE.CATEGORIZATION||jobCreator.type===_new_job.JOB_TYPE.CATEGORIZATION&&jobValidator.categorizationField);setNextActive(active)}),[jobValidatorUpdated]);return _react.default.createElement(_react.Fragment,null,isCurrentStep&&_react.default.createElement(_react.Fragment,null,jobType===_new_job.JOB_TYPE.SINGLE_METRIC&&_react.default.createElement(_single_metric_view.SingleMetricView,{isActive:isCurrentStep,setCanProceed:setNextActive}),jobType===_new_job.JOB_TYPE.MULTI_METRIC&&_react.default.createElement(_multi_metric_view.MultiMetricView,{isActive:isCurrentStep,setCanProceed:setNextActive}),jobType===_new_job.JOB_TYPE.POPULATION&&_react.default.createElement(_population_view.PopulationView,{isActive:isCurrentStep,setCanProceed:setNextActive}),jobType===_new_job.JOB_TYPE.ADVANCED&&_react.default.createElement(_advanced_view.AdvancedView,{isActive:isCurrentStep,setCanProceed:setNextActive}),jobType===_new_job.JOB_TYPE.CATEGORIZATION&&_react.default.createElement(_categorization_view.CategorizationView,{isActive:isCurrentStep,setCanProceed:setNextActive}),_react.default.createElement(_wizard_nav.WizardNav,{previous:function previous(){return setCurrentStep(jobCreator.type===_new_job.JOB_TYPE.ADVANCED?_step_types.WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED:_step_types.WIZARD_STEPS.TIME_RANGE)},next:function next(){return setCurrentStep(_step_types.WIZARD_STEPS.JOB_DETAILS)},nextActive:nextActive},jobType===_new_job.JOB_TYPE.ADVANCED&&_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_json_editor_flyout.JsonEditorFlyout,{isDisabled:false,jobEditorMode:_json_editor_flyout.EDITOR_MODE.EDITABLE,datafeedEditorMode:_json_editor_flyout.EDITOR_MODE.HIDDEN})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_datafeed_preview_flyout.DatafeedPreviewFlyout,{isDisabled:false}))))))};exports.PickFieldsStep=PickFieldsStep},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SingleMetricView=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _metric_selection=__webpack_require__(1291);var _metric_selection_summary=__webpack_require__(1297);var _settings=__webpack_require__(1298);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var SingleMetricView=function SingleMetricView(_ref){var isActive=_ref.isActive,setCanProceed=_ref.setCanProceed;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),metricsValid=_useState2[0],setMetricValid=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),settingsValid=_useState4[0],setSettingsValid=_useState4[1];(0,_react.useEffect)((function(){if(typeof setCanProceed==="function"){setCanProceed(metricsValid&&settingsValid)}}),[metricsValid,settingsValid]);return _react.default.createElement(_react.Fragment,null,isActive===false?_react.default.createElement(_metric_selection_summary.SingleMetricDetectorsSummary,null):_react.default.createElement(_react.Fragment,null,_react.default.createElement(_metric_selection.SingleMetricDetectors,{setIsValid:setMetricValid}),metricsValid&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),_react.default.createElement(_settings.SingleMetricSettings,{setIsValid:setSettingsValid}))))};exports.SingleMetricView=SingleMetricView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SingleMetricDetectors=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _job_creator_context=__webpack_require__(53);var _agg_select=__webpack_require__(254);var _new_job_capabilities_service=__webpack_require__(66);var _anomaly_chart=__webpack_require__(202);var _settings=__webpack_require__(105);var _messagebar=__webpack_require__(91);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var DTR_IDX=0;var SingleMetricDetectors=function SingleMetricDetectors(_ref){var setIsValid=_ref.setIsValid;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated,chartLoader=_useContext.chartLoader,chartInterval=_useContext.chartInterval;var jobCreator=jc;var fields=_new_job_capabilities_service.newJobCapsService.fields;var _useState=(0,_react.useState)(jobCreator.aggFieldPair!==null?[{label:(0,_agg_select.createLabel)(jobCreator.aggFieldPair)}]:[]),_useState2=_slicedToArray(_useState,2),selectedOptions=_useState2[0],setSelectedOptions=_useState2[1];var _useState3=(0,_react.useState)(jobCreator.aggFieldPair),_useState4=_slicedToArray(_useState3,2),aggFieldPair=_useState4[0],setAggFieldPair=_useState4[1];var _useState5=(0,_react.useState)({}),_useState6=_slicedToArray(_useState5,2),lineChartsData=_useState6[0],setLineChartData=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),loadingData=_useState8[0],setLoadingData=_useState8[1];var _useState9=(0,_react.useState)(jobCreator.start),_useState10=_slicedToArray(_useState9,2),start=_useState10[0],setStart=_useState10[1];var _useState11=(0,_react.useState)(jobCreator.end),_useState12=_slicedToArray(_useState11,2),end=_useState12[0],setEnd=_useState12[1];var _useState13=(0,_react.useState)(jobCreator.bucketSpanMs),_useState14=_slicedToArray(_useState13,2),bucketSpanMs=_useState14[0],setBucketSpanMs=_useState14[1];function detectorChangeHandler(selectedOptionsIn){setSelectedOptions(selectedOptionsIn);if(selectedOptionsIn.length){var option=selectedOptionsIn[0];if(typeof option!=="undefined"){setAggFieldPair({agg:option.agg,field:option.field})}else{setAggFieldPair(null)}}}(0,_react.useEffect)((function(){if(aggFieldPair!==null){jobCreator.setDetector(aggFieldPair.agg,aggFieldPair.field);jobCreatorUpdate();loadChart();setIsValid(aggFieldPair!==null)}}),[aggFieldPair]);(0,_react.useEffect)((function(){if(jobCreator.start!==start||jobCreator.end!==end){setStart(jobCreator.start);setEnd(jobCreator.end);loadChart()}if(jobCreator.bucketSpanMs!==bucketSpanMs){setBucketSpanMs(jobCreator.bucketSpanMs);loadChart()}}),[jobCreatorUpdated]);function loadChart(){return _loadChart.apply(this,arguments)}function _loadChart(){_loadChart=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var cs,resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(aggFieldPair!==null)){_context.next=15;break}setLoadingData(true);_context.prev=2;cs=(0,_settings.getChartSettings)(jobCreator,chartInterval);_context.next=6;return chartLoader.loadLineCharts(jobCreator.start,jobCreator.end,[aggFieldPair],null,null,cs.intervalMs);case 6:resp=_context.sent;if(resp[DTR_IDX]!==undefined){setLineChartData(resp)}_context.next=14;break;case 10:_context.prev=10;_context.t0=_context["catch"](2);_messagebar.mlMessageBarService.notify.error(_context.t0);setLineChartData({});case 14:setLoadingData(false);case 15:case"end":return _context.stop()}}}),_callee,null,[[2,10]])})));return _loadChart.apply(this,arguments)}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_agg_select.AggSelect,{fields:fields,changeHandler:detectorChangeHandler,selectedOptions:selectedOptions,removeOptions:[]}),(lineChartsData[DTR_IDX]!==undefined||loadingData===true)&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_anomaly_chart.AnomalyChart,{chartType:_anomaly_chart.CHART_TYPE.LINE,chartData:lineChartsData[DTR_IDX],modelData:[],anomalyData:[],height:"300px",width:"100%",loading:loadingData})))};exports.SingleMetricDetectors=SingleMetricDetectors},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createLabel=createLabel;exports.AggSelect=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var AggSelect=function AggSelect(_ref){var fields=_ref.fields,changeHandler=_ref.changeHandler,selectedOptions=_ref.selectedOptions,removeOptions=_ref.removeOptions;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(jobValidator.duplicateDetectors),_useState2=_slicedToArray(_useState,2),validation=_useState2[0],setValidation=_useState2[1];var removeLabels=removeOptions.map(createLabel);var options=fields.map((function(f){var aggOption={label:f.name,options:[]};if(typeof f.aggs!=="undefined"){aggOption.options=f.aggs.filter((function(a){return a.dslName!==null})).map((function(a){return{label:"".concat(a.title,"(").concat(f.name,")"),agg:a,field:f}})).filter((function(o){return removeLabels.includes(o.label)===false}))}return aggOption}));(0,_react.useEffect)((function(){setValidation(jobValidator.duplicateDetectors)}),[jobValidatorUpdated]);return _react.default.createElement(_eui.EuiFormRow,{error:validation.message,isInvalid:validation.valid===false,"data-test-subj":"mlJobWizardAggSelection"},_react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:options,selectedOptions:selectedOptions,onChange:changeHandler,isClearable:false,isInvalid:validation.valid===false}))};exports.AggSelect=AggSelect;function createLabel(pair){return"".concat(pair.agg.title,"(").concat(pair.field.name,")")}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnomalyChart=exports.CHART_TYPE=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _charts=__webpack_require__(37);var _anomalies=__webpack_require__(475);var _model_bounds=__webpack_require__(1294);var _line=__webpack_require__(1295);var _scatter=__webpack_require__(1296);var _axes=__webpack_require__(467);var _utils=__webpack_require__(468);var _loading_wrapper=__webpack_require__(252);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var CHART_TYPE;exports.CHART_TYPE=CHART_TYPE;(function(CHART_TYPE){CHART_TYPE[CHART_TYPE["LINE"]=0]="LINE";CHART_TYPE[CHART_TYPE["SCATTER"]=1]="SCATTER"})(CHART_TYPE||(exports.CHART_TYPE=CHART_TYPE={}));var AnomalyChart=function AnomalyChart(_ref){var chartType=_ref.chartType,_ref$chartData=_ref.chartData,chartData=_ref$chartData===void 0?[]:_ref$chartData,modelData=_ref.modelData,anomalyData=_ref.anomalyData,height=_ref.height,width=_ref.width,_ref$loading=_ref.loading,loading=_ref$loading===void 0?false:_ref$loading;var data=chartType===CHART_TYPE.SCATTER?flattenData(chartData):chartData;var xDomain=(0,_utils.getXRange)(data);return _react.default.createElement("div",{style:{width:width,height:height},"data-test-subj":"mlAnomalyChart ".concat(CHART_TYPE[chartType])},_react.default.createElement(_loading_wrapper.LoadingWrapper,{height:height,hasData:data.length>0,loading:loading},_react.default.createElement(_charts.Chart,null,_react.default.createElement(_charts.Settings,{xDomain:xDomain,tooltip:_charts.TooltipType.None}),_react.default.createElement(_axes.Axes,{chartData:data}),_react.default.createElement(_anomalies.Anomalies,{anomalyData:anomalyData}),_react.default.createElement(_model_bounds.ModelBounds,{modelData:modelData}),chartType===CHART_TYPE.LINE&&_react.default.createElement(_line.Line,{chartData:data}),chartType===CHART_TYPE.SCATTER&&_react.default.createElement(_scatter.Scatter,{chartData:data}))))};exports.AnomalyChart=AnomalyChart;function flattenData(data){var chartData=data.reduce((function(p,c){p.push.apply(p,_toConsumableArray(c.values.map((function(v){return{time:c.time,value:v.value}}))));return p}),[]);return chartData}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ModelBounds=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _charts=__webpack_require__(37);var _settings=__webpack_require__(105);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var SPEC_ID="model";var areaSeriesStyle=_objectSpread({},_settings.seriesStyle,{area:_objectSpread({},_settings.seriesStyle.area,{visible:true}),line:_objectSpread({},_settings.seriesStyle.line,{strokeWidth:1,opacity:.4})});var ModelBounds=function ModelBounds(_ref){var modelData=_ref.modelData;var _useChartColors=(0,_settings.useChartColors)(),MODEL_COLOR=_useChartColors.MODEL_COLOR;var model=modelData===undefined?[]:modelData;return _react.default.createElement(_charts.AreaSeries,{id:SPEC_ID,xScaleType:_charts.ScaleType.Time,yScaleType:_charts.ScaleType.Linear,xAccessor:"time",yAccessors:["modelUpper"],y0Accessors:["modelLower"],data:model,stackAccessors:["time"],yScaleToDataExtent:false,curve:_charts.CurveType.CURVE_MONOTONE_X,areaSeriesStyle:areaSeriesStyle,color:MODEL_COLOR})};exports.ModelBounds=ModelBounds},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Line=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _charts=__webpack_require__(37);var _settings=__webpack_require__(105);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var SPEC_ID="line";var lineSeriesStyle=_objectSpread({},_settings.seriesStyle);var Line=function Line(_ref){var chartData=_ref.chartData;var _useChartColors=(0,_settings.useChartColors)(),LINE_COLOR=_useChartColors.LINE_COLOR;return _react.default.createElement(_charts.LineSeries,{id:SPEC_ID,xScaleType:_charts.ScaleType.Time,yScaleType:_charts.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:chartData,yScaleToDataExtent:false,curve:_charts.CurveType.CURVE_MONOTONE_X,lineSeriesStyle:lineSeriesStyle,color:LINE_COLOR})};exports.Line=Line},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Scatter=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _charts=__webpack_require__(37);var _settings=__webpack_require__(105);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var SPEC_ID="scatter";var scatterSeriesStyle=_objectSpread({},_settings.seriesStyle,{line:_objectSpread({},_settings.seriesStyle.line,{visible:false}),point:_objectSpread({},_settings.seriesStyle.point,{visible:true})});var Scatter=function Scatter(_ref){var chartData=_ref.chartData;var _useChartColors=(0,_settings.useChartColors)(),LINE_COLOR=_useChartColors.LINE_COLOR;return _react.default.createElement(_charts.LineSeries,{id:SPEC_ID,xScaleType:_charts.ScaleType.Time,yScaleType:_charts.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:chartData,yScaleToDataExtent:false,curve:_charts.CurveType.CURVE_MONOTONE_X,lineSeriesStyle:scatterSeriesStyle,color:LINE_COLOR})};exports.Scatter=Scatter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SingleMetricDetectorsSummary=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _job_creator_context=__webpack_require__(53);var _anomaly_chart=__webpack_require__(202);var _settings=__webpack_require__(105);var _messagebar=__webpack_require__(91);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var DTR_IDX=0;var SingleMetricDetectorsSummary=function SingleMetricDetectorsSummary(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,chartLoader=_useContext.chartLoader,resultsLoader=_useContext.resultsLoader,chartInterval=_useContext.chartInterval;var jobCreator=jc;var _useState=(0,_react.useState)({}),_useState2=_slicedToArray(_useState,2),lineChartsData=_useState2[0],setLineChartData=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),loadingData=_useState4[0],setLoadingData=_useState4[1];var _useState5=(0,_react.useState)([]),_useState6=_slicedToArray(_useState5,2),modelData=_useState6[0],setModelData=_useState6[1];var _useState7=(0,_react.useState)([]),_useState8=_slicedToArray(_useState7,2),anomalyData=_useState8[0],setAnomalyData=_useState8[1];function setResultsWrapper(results){var model=results.model[DTR_IDX];if(model!==undefined){setModelData(model)}var anomalies=results.anomalies[DTR_IDX];if(anomalies!==undefined){setAnomalyData(anomalies)}}(0,_react.useEffect)((function(){var subscription=resultsLoader.subscribeToResults(setResultsWrapper);loadChart();return function(){subscription.unsubscribe()}}),[]);function loadChart(){return _loadChart.apply(this,arguments)}function _loadChart(){_loadChart=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var cs,resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(jobCreator.aggFieldPair!==null)){_context.next=15;break}setLoadingData(true);_context.prev=2;cs=(0,_settings.getChartSettings)(jobCreator,chartInterval);_context.next=6;return chartLoader.loadLineCharts(jobCreator.start,jobCreator.end,[jobCreator.aggFieldPair],null,null,cs.intervalMs);case 6:resp=_context.sent;if(resp[DTR_IDX]!==undefined){setLineChartData(resp)}_context.next=14;break;case 10:_context.prev=10;_context.t0=_context["catch"](2);_messagebar.mlMessageBarService.notify.error(_context.t0);setLineChartData({});case 14:setLoadingData(false);case 15:case"end":return _context.stop()}}}),_callee,null,[[2,10]])})));return _loadChart.apply(this,arguments)}return _react.default.createElement(_react.Fragment,null,(lineChartsData[DTR_IDX]!==undefined||loadingData===true)&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_anomaly_chart.AnomalyChart,{chartType:_anomaly_chart.CHART_TYPE.LINE,chartData:lineChartsData[DTR_IDX],modelData:modelData,anomalyData:anomalyData,height:"300px",width:"100%",loading:loadingData})))};exports.SingleMetricDetectorsSummary=SingleMetricDetectorsSummary},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SingleMetricSettings=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _bucket_span=__webpack_require__(165);var _sparse_data=__webpack_require__(478);var _general=__webpack_require__(85);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var SingleMetricSettings=function SingleMetricSettings(_ref){var setIsValid=_ref.setIsValid;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;var convertToMultiMetric=function convertToMultiMetric(){(0,_general.convertToMultiMetricJob)(jobCreator)};return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_bucket_span.BucketSpan,{setIsValid:setIsValid})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_sparse_data.SparseDataSwitch,null))),_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{onClick:convertToMultiMetric},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.singleMetricView.convertToMultiMetricButton",defaultMessage:"Convert to multi metric job"})))))};exports.SingleMetricSettings=SingleMetricSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BucketSpan=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _bucket_span_input=__webpack_require__(1300);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1301);var _bucket_span_estimator=__webpack_require__(1302);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var BucketSpan=function BucketSpan(_ref){var setIsValid=_ref.setIsValid,_ref$hideEstimateButt=_ref.hideEstimateButton,hideEstimateButton=_ref$hideEstimateButt===void 0?false:_ref$hideEstimateButt;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(jobCreator.bucketSpan),_useState2=_slicedToArray(_useState,2),bucketSpan=_useState2[0],setBucketSpan=_useState2[1];var _useState3=(0,_react.useState)(jobValidator.bucketSpan),_useState4=_slicedToArray(_useState3,2),validation=_useState4[0],setValidation=_useState4[1];var _useState5=(0,_react.useState)(false),_useState6=_slicedToArray(_useState5,2),estimating=_useState6[0],setEstimating=_useState6[1];(0,_react.useEffect)((function(){jobCreator.bucketSpan=bucketSpan;jobCreatorUpdate()}),[bucketSpan]);(0,_react.useEffect)((function(){setBucketSpan(jobCreator.bucketSpan)}),[jobCreatorUpdated]);(0,_react.useEffect)((function(){setValidation(jobValidator.bucketSpan)}),[jobValidatorUpdated]);(0,_react.useEffect)((function(){setIsValid(estimating===false)}),[estimating]);return _react.default.createElement(_description.Description,{validation:validation},_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_bucket_span_input.BucketSpanInput,{setBucketSpan:setBucketSpan,bucketSpan:bucketSpan,isInvalid:validation.valid===false,disabled:estimating})),hideEstimateButton===false&&_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_bucket_span_estimator.BucketSpanEstimator,{setEstimating:setEstimating}))))};exports.BucketSpan=BucketSpan},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BucketSpanInput=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var BucketSpanInput=function BucketSpanInput(_ref){var bucketSpan=_ref.bucketSpan,setBucketSpan=_ref.setBucketSpan,isInvalid=_ref.isInvalid,disabled=_ref.disabled;return _react.default.createElement(_eui.EuiFieldText,{disabled:disabled,placeholder:_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.placeholder",{defaultMessage:"Bucket span"}),value:bucketSpan,onChange:function onChange(e){return setBucketSpan(e.target.value)},isInvalid:isInvalid,"data-test-subj":"mlJobWizardInputBucketSpan"})};exports.BucketSpanInput=BucketSpanInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children,validation=_ref.validation;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.title",{defaultMessage:"Bucket span"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.description",defaultMessage:"Set the interval for time series analysis, typically between 15m to 1h."})},_react.default.createElement(_eui.EuiFormRow,{label:title,error:validation.message,isInvalid:validation.valid===false},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"BucketSpanEstimator",{enumerable:true,get:function get(){return _bucket_span_estimator.BucketSpanEstimator}});var _bucket_span_estimator=__webpack_require__(1303)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BucketSpanEstimator=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _job_creator=__webpack_require__(89);var _job_creator_context=__webpack_require__(53);var _field_types=__webpack_require__(109);var _estimate_bucket_span=__webpack_require__(1304);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var BucketSpanEstimator=function BucketSpanEstimator(_ref){var setEstimating=_ref.setEstimating;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate;var _useEstimateBucketSpa=(0,_estimate_bucket_span.useEstimateBucketSpan)(),status=_useEstimateBucketSpa.status,estimateBucketSpan=_useEstimateBucketSpa.estimateBucketSpan;var _useState=(0,_react.useState)(jobCreator.detectors.length===0),_useState2=_slicedToArray(_useState,2),noDetectors=_useState2[0],setNoDetectors=_useState2[1];var _useState3=(0,_react.useState)(checkIsUsingMlCategory()),_useState4=_slicedToArray(_useState3,2),isUsingMlCategory=_useState4[0],setIsUsingMlCategory=_useState4[1];(0,_react.useEffect)((function(){setEstimating(status===_estimate_bucket_span.ESTIMATE_STATUS.RUNNING)}),[status]);(0,_react.useEffect)((function(){setNoDetectors(jobCreator.detectors.length===0);setIsUsingMlCategory(checkIsUsingMlCategory())}),[jobCreatorUpdate]);function checkIsUsingMlCategory(){return(0,_job_creator.isAdvancedJobCreator)(jobCreator)&&jobCreator.detectors.some((function(d){if(d.partition_field_name===_field_types.MLCATEGORY||d.over_field_name===_field_types.MLCATEGORY||d.by_field_name===_field_types.MLCATEGORY){return true}}))}return _react.default.createElement(_eui.EuiButton,{disabled:status===_estimate_bucket_span.ESTIMATE_STATUS.RUNNING||noDetectors===true||isUsingMlCategory===true,onClick:estimateBucketSpan},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.bucketSpanEstimatorButton",defaultMessage:"Estimate bucket span"}))};exports.BucketSpanEstimator=BucketSpanEstimator},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useEstimateBucketSpan=useEstimateBucketSpan;exports.ESTIMATE_STATUS=void 0;var _react=__webpack_require__(28);var _job_creator_context=__webpack_require__(53);var _fields=__webpack_require__(118);var _job_creator=__webpack_require__(89);var _ml_api_service=__webpack_require__(51);var _ml=__webpack_require__(77);var _messagebar=__webpack_require__(91);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ESTIMATE_STATUS;exports.ESTIMATE_STATUS=ESTIMATE_STATUS;(function(ESTIMATE_STATUS){ESTIMATE_STATUS[ESTIMATE_STATUS["NOT_RUNNING"]=0]="NOT_RUNNING";ESTIMATE_STATUS[ESTIMATE_STATUS["RUNNING"]=1]="RUNNING"})(ESTIMATE_STATUS||(exports.ESTIMATE_STATUS=ESTIMATE_STATUS={}));function useEstimateBucketSpan(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate;var mlContext=(0,_ml.useMlContext)();var _useState=(0,_react.useState)(ESTIMATE_STATUS.NOT_RUNNING),_useState2=_slicedToArray(_useState,2),status=_useState2[0],setStatus=_useState2[1];var data={aggTypes:jobCreator.aggregations.map((function(a){return a.dslName})),duration:{start:jobCreator.start,end:jobCreator.end},fields:jobCreator.fields.map((function(f){return f.id===_fields.EVENT_RATE_FIELD_ID?null:f.id})),index:mlContext.currentIndexPattern.title,query:mlContext.combinedQuery,splitField:undefined,timeField:mlContext.currentIndexPattern.timeFieldName};if(((0,_job_creator.isMultiMetricJobCreator)(jobCreator)||(0,_job_creator.isPopulationJobCreator)(jobCreator))&&jobCreator.splitField!==null){data.splitField=jobCreator.splitField.id}else if((0,_job_creator.isAdvancedJobCreator)(jobCreator)){jobCreator.richDetectors.some((function(d){if(d.partitionField!==null){data.splitField=d.partitionField.id;return true}if(d.overField!==null){data.splitField=d.overField.id;return true}if(d.byField!==null){data.splitField=d.byField.id;return true}}))}function estimateBucketSpan(){return _estimateBucketSpan.apply(this,arguments)}function _estimateBucketSpan(){_estimateBucketSpan=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _ref,name,error,message;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setStatus(ESTIMATE_STATUS.RUNNING);_context.next=3;return _ml_api_service.ml.estimateBucketSpan(data);case 3:_ref=_context.sent;name=_ref.name;error=_ref.error;message=_ref.message;setStatus(ESTIMATE_STATUS.NOT_RUNNING);if(error===true){_messagebar.mlMessageBarService.notify.error(message)}else{jobCreator.bucketSpan=name;jobCreatorUpdate()}case 9:case"end":return _context.stop()}}}),_callee)})));return _estimateBucketSpan.apply(this,arguments)}return{status:status,estimateBucketSpan:estimateBucketSpan}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SparseDataSwitch=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1306);var _aggregation_types=__webpack_require__(121);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var SparseDataSwitch=function SparseDataSwitch(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdated=_useContext.jobCreatorUpdated,jobCreatorUpdate=_useContext.jobCreatorUpdate;var _useState=(0,_react.useState)(jobCreator.sparseData),_useState2=_slicedToArray(_useState,2),sparseData=_useState2[0],setSparseData=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),enabled=_useState4[0],setEnabled=_useState4[1];(0,_react.useEffect)((function(){jobCreator.sparseData=sparseData;jobCreatorUpdate()}),[sparseData]);(0,_react.useEffect)((function(){var aggs=[_aggregation_types.ES_AGGREGATION.COUNT,_aggregation_types.ES_AGGREGATION.SUM];var isCountOrSum=jobCreator.aggregations.some((function(agg){return agg.dslName!==null&&aggs.includes(agg.dslName)}));setEnabled(isCountOrSum);if(isCountOrSum===false&&sparseData===true){setSparseData(false)}}),[jobCreatorUpdated]);function toggleSparseData(){setSparseData(!sparseData)}return _react.default.createElement(_description.Description,null,_react.default.createElement(_eui.EuiSwitch,{name:"switch",disabled:enabled===false,checked:sparseData,onChange:toggleSparseData,"data-test-subj":"mlJobWizardSwitchSparseData",label:_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.sparseData.title",{defaultMessage:"Sparse data"})}))};exports.SparseDataSwitch=SparseDataSwitch},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.sparseData.title",{defaultMessage:"Sparse data"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.sparseData.description",defaultMessage:"Select if you wish to ignore empty buckets from being considered anomalous. Available for count and sum analysis."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MultiMetricView=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _metric_selection=__webpack_require__(1308);var _metric_selection_summary=__webpack_require__(1313);var _settings=__webpack_require__(1314);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var MultiMetricView=function MultiMetricView(_ref){var isActive=_ref.isActive,setCanProceed=_ref.setCanProceed;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),metricsValid=_useState2[0],setMetricValid=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),settingsValid=_useState4[0],setSettingsValid=_useState4[1];(0,_react.useEffect)((function(){if(typeof setCanProceed==="function"){setCanProceed(metricsValid&&settingsValid)}}),[metricsValid,settingsValid]);return _react.default.createElement(_react.Fragment,null,isActive===false?_react.default.createElement(_metric_selection_summary.MultiMetricDetectorsSummary,null):_react.default.createElement(_react.Fragment,null,_react.default.createElement(_metric_selection.MultiMetricDetectors,{setIsValid:setMetricValid}),metricsValid&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),_react.default.createElement(_settings.MultiMetricSettings,{setIsValid:setSettingsValid}))))};exports.MultiMetricView=MultiMetricView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MultiMetricDetectors=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _job_creator_context=__webpack_require__(53);var _new_job_capabilities_service=__webpack_require__(66);var _settings=__webpack_require__(105);var _metric_selector=__webpack_require__(1309);var _chart_grid=__webpack_require__(480);var _messagebar=__webpack_require__(91);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var MultiMetricDetectors=function MultiMetricDetectors(_ref){var setIsValid=_ref.setIsValid;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated,chartLoader=_useContext.chartLoader,chartInterval=_useContext.chartInterval;var jobCreator=jc;var fields=_new_job_capabilities_service.newJobCapsService.fields;var _useState=(0,_react.useState)([]),_useState2=_slicedToArray(_useState,2),selectedOptions=_useState2[0],setSelectedOptions=_useState2[1];var _useState3=(0,_react.useState)(jobCreator.aggFieldPairs),_useState4=_slicedToArray(_useState3,2),aggFieldPairList=_useState4[0],setAggFieldPairList=_useState4[1];var _useState5=(0,_react.useState)({}),_useState6=_slicedToArray(_useState5,2),lineChartsData=_useState6[0],setLineChartsData=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),loadingData=_useState8[0],setLoadingData=_useState8[1];var _useState9=(0,_react.useState)(jobCreator.start),_useState10=_slicedToArray(_useState9,2),start=_useState10[0],setStart=_useState10[1];var _useState11=(0,_react.useState)(jobCreator.end),_useState12=_slicedToArray(_useState11,2),end=_useState12[0],setEnd=_useState12[1];var _useState13=(0,_react.useState)(jobCreator.bucketSpanMs),_useState14=_slicedToArray(_useState13,2),bucketSpanMs=_useState14[0],setBucketSpanMs=_useState14[1];var _useState15=(0,_react.useState)(_settings.defaultChartSettings),_useState16=_slicedToArray(_useState15,2),chartSettings=_useState16[0],setChartSettings=_useState16[1];var _useState17=(0,_react.useState)(jobCreator.splitField),_useState18=_slicedToArray(_useState17,2),splitField=_useState18[0],setSplitField=_useState18[1];var _useState19=(0,_react.useState)([]),_useState20=_slicedToArray(_useState19,2),fieldValues=_useState20[0],setFieldValues=_useState20[1];var _useState21=(0,_react.useState)(false),_useState22=_slicedToArray(_useState21,2),pageReady=_useState22[0],setPageReady=_useState22[1];function detectorChangeHandler(selectedOptionsIn){addDetector(selectedOptionsIn)}function addDetector(selectedOptionsIn){if(selectedOptionsIn!==null&&selectedOptionsIn.length){var option=selectedOptionsIn[0];if(typeof option!=="undefined"){var newPair={agg:option.agg,field:option.field};setAggFieldPairList([].concat(_toConsumableArray(aggFieldPairList),[newPair]));setSelectedOptions([])}else{setAggFieldPairList([])}}}function deleteDetector(index){aggFieldPairList.splice(index,1);setAggFieldPairList(_toConsumableArray(aggFieldPairList))}(0,_react.useEffect)((function(){setPageReady(true)}),[]);(0,_react.useEffect)((function(){jobCreator.removeAllDetectors();aggFieldPairList.forEach((function(pair){jobCreator.addDetector(pair.agg,pair.field)}));jobCreator.calculateModelMemoryLimit();jobCreatorUpdate();loadCharts();setIsValid(aggFieldPairList.length>0)}),[aggFieldPairList.length]);(0,_react.useEffect)((function(){if(jobCreator.start!==start||jobCreator.end!==end){setStart(jobCreator.start);setEnd(jobCreator.end);loadCharts()}if(jobCreator.bucketSpanMs!==bucketSpanMs){setBucketSpanMs(jobCreator.bucketSpanMs);loadCharts()}setSplitField(jobCreator.splitField)}),[jobCreatorUpdated]);(0,_react.useEffect)((function(){if(splitField!==null){chartLoader.loadFieldExampleValues(splitField).then(setFieldValues).catch((function(error){_messagebar.mlMessageBarService.notify.error(error)}))}else{setFieldValues([])}jobCreator.calculateModelMemoryLimit()}),[splitField]);(0,_react.useEffect)((function(){loadCharts()}),[fieldValues]);function loadCharts(){return _loadCharts.apply(this,arguments)}function _loadCharts(){_loadCharts=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var cs,resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!allDataReady()){_context.next=16;break}setLoadingData(true);_context.prev=2;cs=(0,_settings.getChartSettings)(jobCreator,chartInterval);setChartSettings(cs);_context.next=7;return chartLoader.loadLineCharts(jobCreator.start,jobCreator.end,aggFieldPairList,jobCreator.splitField,fieldValues.length>0?fieldValues[0]:null,cs.intervalMs);case 7:resp=_context.sent;setLineChartsData(resp);_context.next=15;break;case 11:_context.prev=11;_context.t0=_context["catch"](2);_messagebar.mlMessageBarService.notify.error(_context.t0);setLineChartsData([]);case 15:setLoadingData(false);case 16:case"end":return _context.stop()}}}),_callee,null,[[2,11]])})));return _loadCharts.apply(this,arguments)}function allDataReady(){return pageReady&&aggFieldPairList.length>0&&(splitField===null||splitField!==null&&fieldValues.length>0)}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_chart_grid.ChartGrid,{aggFieldPairList:aggFieldPairList,chartSettings:chartSettings,splitField:splitField,fieldValues:fieldValues,lineChartsData:lineChartsData,modelData:[],anomalyData:[],deleteDetector:deleteDetector,jobType:jobCreator.type,loading:loadingData}),_react.default.createElement(_metric_selector.MetricSelector,{fields:fields,detectorChangeHandler:detectorChangeHandler,selectedOptions:selectedOptions,removeOptions:aggFieldPairList}))};exports.MultiMetricDetectors=MultiMetricDetectors},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MetricSelector=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _agg_select=__webpack_require__(254);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var MAX_WIDTH=560;var MetricSelector=function MetricSelector(_ref){var fields=_ref.fields,detectorChangeHandler=_ref.detectorChangeHandler,selectedOptions=_ref.selectedOptions,maxWidth=_ref.maxWidth,removeOptions=_ref.removeOptions;return _react.default.createElement(_eui.EuiFlexGroup,{style:{maxWidth:maxWidth!==undefined?maxWidth:MAX_WIDTH}},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.multiMetricView.addMetric",{defaultMessage:"Add metric"})},_react.default.createElement(_agg_select.AggSelect,{fields:fields,changeHandler:detectorChangeHandler,selectedOptions:selectedOptions,removeOptions:removeOptions}))))};exports.MetricSelector=MetricSelector},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SplitCards=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _new_job=__webpack_require__(60);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var SplitCards=(0,_react.memo)((function(_ref){var fieldValues=_ref.fieldValues,splitField=_ref.splitField,children=_ref.children,numberOfDetectors=_ref.numberOfDetectors,jobType=_ref.jobType,_ref$animate=_ref.animate,animate=_ref$animate===void 0?false:_ref$animate;var panels=[];function storePanels(panel,marginBottom){if(panel!==null){if(animate===false){panel.style.marginBottom="".concat(marginBottom,"px")}panels.push({panel:panel,marginBottom:marginBottom})}}function getBackPanels(){panels.length=0;var fieldValuesCopy=_toConsumableArray(fieldValues);fieldValuesCopy.shift();var margin=5;var sideMargins=fieldValuesCopy.map((function(f,i){return margin+=10-i})).reverse();if(animate===true){setTimeout((function(){panels.forEach((function(p){return p.panel.style.marginBottom="".concat(p.marginBottom,"px")}))}),100)}var SPACING=100;var SPLIT_HEIGHT_MULTIPLIER=1.6;return fieldValuesCopy.map((function(fieldName,i){var diff=(i+1)*(SPLIT_HEIGHT_MULTIPLIER*(10/fieldValuesCopy.length));var marginBottom=-SPACING+diff;var sideMargin=sideMargins[i];var style=_objectSpread({height:"".concat(SPACING,"px"),marginBottom:"-".concat(SPACING,"px"),marginLeft:"".concat(sideMargin,"px"),marginRight:"".concat(sideMargin,"px")},animate?{transition:"margin 0.5s"}:{});return _react.default.createElement("div",{key:fieldName,ref:function ref(_ref2){return storePanels(_ref2,marginBottom)},style:style},_react.default.createElement(_eui.EuiPanel,{paddingSize:"m",style:{paddingTop:"4px"},"data-test-subj":"mlSplitCard back"},_react.default.createElement("div",{style:{fontWeight:"bold",fontSize:"small"},"data-test-subj":"mlSplitCardTitle"},fieldName)))}))}return _react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{"data-test-subj":"mlDataSplit"},(fieldValues.length===0||numberOfDetectors===0)&&_react.default.createElement(_react.default.Fragment,null,children),fieldValues.length>0&&numberOfDetectors>0&&splitField!==null&&_react.default.createElement(_react.Fragment,null,jobType===_new_job.JOB_TYPE.MULTI_METRIC&&_react.default.createElement(_react.Fragment,null,_react.default.createElement("div",{style:{fontSize:"small"},"data-test-subj":"mlDataSplitTitle ".concat(splitField.name)},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.splitCards.dataSplitBy",defaultMessage:"Data split by {field}",values:{field:splitField.name}})),_react.default.createElement(_eui.EuiSpacer,{size:"m"})),getBackPanels(),_react.default.createElement(_eui.EuiPanel,{paddingSize:"m",style:{paddingTop:"4px"},"data-test-subj":"mlSplitCard front"},_react.default.createElement("div",{style:{fontWeight:"bold",fontSize:"small"},"data-test-subj":"mlSplitCardTitle"},fieldValues[0]),_react.default.createElement(_eui.EuiHorizontalRule,{margin:"s"}),_react.default.createElement(_react.default.Fragment,null,children)))))}));exports.SplitCards=SplitCards},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useAnimateSplit=useAnimateSplit;exports.ANIMATION_SWITCH_DELAY_MS=void 0;var _react=__webpack_require__(28);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ANIMATION_SWITCH_DELAY_MS=1e3;exports.ANIMATION_SWITCH_DELAY_MS=ANIMATION_SWITCH_DELAY_MS;function useAnimateSplit(){var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),animateSplit=_useState2[0],setAnimateSplit=_useState2[1];(0,_react.useEffect)((function(){setTimeout((function(){setAnimateSplit(true)}),ANIMATION_SWITCH_DELAY_MS)}),[]);return animateSplit}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DetectorTitle=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DetectorTitle=function DetectorTitle(_ref){var index=_ref.index,agg=_ref.agg,field=_ref.field,byField=_ref.byField,deleteDetector=_ref.deleteDetector,children=_ref.children;var splitField=children===false&&byField!==undefined?byField.field:null;return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement("span",{style:{fontSize:"small"},"data-test-subj":"mlDetectorTitle"},getTitle(agg,field,splitField))),children!==false&&_react.default.createElement(_eui.EuiFlexItem,{style:{width:"100%",maxWidth:"400px"}},children),_react.default.createElement(_eui.EuiFlexItem,{grow:false},deleteDetector!==undefined&&_react.default.createElement(_eui.EuiButtonIcon,{color:"danger",onClick:function onClick(){return deleteDetector(index)},iconType:"cross",size:"s","aria-label":"Next"})))};exports.DetectorTitle=DetectorTitle;function getTitle(agg,field,splitField){var title="".concat(agg.title,"(").concat(field.name,")");if(splitField===null){return title}else{return _i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.detectorTitle.placeholder",{defaultMessage:"{title} split by {field}",values:{title:title,field:splitField.name}})}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MultiMetricDetectorsSummary=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _job_creator_context=__webpack_require__(53);var _settings=__webpack_require__(105);var _chart_grid=__webpack_require__(480);var _messagebar=__webpack_require__(91);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var MultiMetricDetectorsSummary=function MultiMetricDetectorsSummary(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,chartLoader=_useContext.chartLoader,resultsLoader=_useContext.resultsLoader,chartInterval=_useContext.chartInterval;var jobCreator=jc;var _useState=(0,_react.useState)({}),_useState2=_slicedToArray(_useState,2),lineChartsData=_useState2[0],setLineChartsData=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),loadingData=_useState4[0],setLoadingData=_useState4[1];var _useState5=(0,_react.useState)([]),_useState6=_slicedToArray(_useState5,2),modelData=_useState6[0],setModelData=_useState6[1];var _useState7=(0,_react.useState)([]),_useState8=_slicedToArray(_useState7,2),anomalyData=_useState8[0],setAnomalyData=_useState8[1];var _useState9=(0,_react.useState)(_settings.defaultChartSettings),_useState10=_slicedToArray(_useState9,2),chartSettings=_useState10[0],setChartSettings=_useState10[1];var _useState11=(0,_react.useState)([]),_useState12=_slicedToArray(_useState11,2),fieldValues=_useState12[0],setFieldValues=_useState12[1];function setResultsWrapper(results){setModelData(results.model);setAnomalyData(results.anomalies)}(0,_react.useEffect)((function(){var subscription=resultsLoader.subscribeToResults(setResultsWrapper);_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var tempFieldValues;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(jobCreator.splitField!==null)){_context.next=11;break}_context.prev=1;_context.next=4;return chartLoader.loadFieldExampleValues(jobCreator.splitField);case 4:tempFieldValues=_context.sent;setFieldValues(tempFieldValues);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);_messagebar.mlMessageBarService.notify.error(_context.t0);case 11:case"end":return _context.stop()}}}),_callee,null,[[1,8]])})))();return function(){subscription.unsubscribe()}}),[]);(0,_react.useEffect)((function(){if(allDataReady()){loadCharts()}}),[fieldValues]);function loadCharts(){return _loadCharts.apply(this,arguments)}function _loadCharts(){_loadCharts=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var cs,resp;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!allDataReady()){_context2.next=16;break}setLoadingData(true);_context2.prev=2;cs=(0,_settings.getChartSettings)(jobCreator,chartInterval);setChartSettings(cs);_context2.next=7;return chartLoader.loadLineCharts(jobCreator.start,jobCreator.end,jobCreator.aggFieldPairs,jobCreator.splitField,fieldValues.length>0?fieldValues[0]:null,cs.intervalMs);case 7:resp=_context2.sent;setLineChartsData(resp);_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2["catch"](2);_messagebar.mlMessageBarService.notify.error(_context2.t0);setLineChartsData({});case 15:setLoadingData(false);case 16:case"end":return _context2.stop()}}}),_callee2,null,[[2,11]])})));return _loadCharts.apply(this,arguments)}function allDataReady(){return jobCreator.aggFieldPairs.length>0&&(jobCreator.splitField===null||jobCreator.splitField!==null&&fieldValues.length>0)}return _react.default.createElement(_react.Fragment,null,Object.keys(lineChartsData).length&&_react.default.createElement(_chart_grid.ChartGrid,{aggFieldPairList:jobCreator.aggFieldPairs,chartSettings:chartSettings,splitField:jobCreator.splitField,fieldValues:fieldValues,lineChartsData:lineChartsData,modelData:modelData,anomalyData:anomalyData,deleteDetector:undefined,jobType:jobCreator.type,loading:loadingData}))};exports.MultiMetricDetectorsSummary=MultiMetricDetectorsSummary},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MultiMetricSettings=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _bucket_span=__webpack_require__(165);var _split_field=__webpack_require__(255);var _influencers=__webpack_require__(256);var _sparse_data=__webpack_require__(478);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var MultiMetricSettings=function MultiMetricSettings(_ref){var setIsValid=_ref.setIsValid;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_split_field.SplitFieldSelector,null)),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_influencers.Influencers,null))),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_bucket_span.BucketSpan,{setIsValid:setIsValid})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_sparse_data.SparseDataSwitch,null))))};exports.MultiMetricSettings=MultiMetricSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ByFieldSelector=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _split_field_select=__webpack_require__(483);var _job_creator_context=__webpack_require__(53);var _new_job_capabilities_service=__webpack_require__(66);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ByFieldSelector=function ByFieldSelector(_ref){var detectorIndex=_ref.detectorIndex;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var jobCreator=jc;var allCategoryFields=_new_job_capabilities_service.newJobCapsService.categoryFields;var _useState=(0,_react.useState)(jobCreator.getByField(detectorIndex)),_useState2=_slicedToArray(_useState,2),byField=_useState2[0],setByField=_useState2[1];var categoryFields=useFilteredCategoryFields(allCategoryFields,jobCreator,jobCreatorUpdated);(0,_react.useEffect)((function(){jobCreator.setByField(byField,detectorIndex);if(byField!==null&&jobCreator.influencers.includes(byField.name)===false){jobCreator.addInfluencer(byField.name)}jobCreatorUpdate()}),[byField]);(0,_react.useEffect)((function(){var bf=jobCreator.getByField(detectorIndex);setByField(bf)}),[jobCreatorUpdated]);return _react.default.createElement(_split_field_select.SplitFieldSelect,{fields:categoryFields,changeHandler:setByField,selectedField:byField,isClearable:true,testSubject:"mlByFieldSelect",placeholder:_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationField.placeholder",{defaultMessage:"Split data"})})};exports.ByFieldSelector=ByFieldSelector;function useFilteredCategoryFields(allCategoryFields,jobCreator,jobCreatorUpdated){var _useState3=(0,_react.useState)(allCategoryFields),_useState4=_slicedToArray(_useState3,2),fields=_useState4[0],setFields=_useState4[1];(0,_react.useEffect)((function(){var sf=jobCreator.splitField;if(sf!==null){setFields(allCategoryFields.filter((function(f){return f.name!==sf.name})))}else{setFields(allCategoryFields)}}),[jobCreatorUpdated]);return fields}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SplitFieldSelector=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _split_field_select=__webpack_require__(483);var _job_creator_context=__webpack_require__(53);var _new_job_capabilities_service=__webpack_require__(66);var _description=__webpack_require__(1317);var _job_creator=__webpack_require__(89);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var SplitFieldSelector=function SplitFieldSelector(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var jobCreator=jc;var canClearSelection=(0,_job_creator.isMultiMetricJobCreator)(jc);var categoryFields=_new_job_capabilities_service.newJobCapsService.categoryFields;var _useState=(0,_react.useState)(jobCreator.splitField),_useState2=_slicedToArray(_useState,2),splitField=_useState2[0],setSplitField=_useState2[1];(0,_react.useEffect)((function(){jobCreator.setSplitField(splitField);if(splitField!==null&&jobCreator.influencers.includes(splitField.name)===false){jobCreator.addInfluencer(splitField.name)}jobCreatorUpdate()}),[splitField]);(0,_react.useEffect)((function(){setSplitField(jobCreator.splitField)}),[jobCreatorUpdated]);return _react.default.createElement(_description.Description,{jobType:jobCreator.type},_react.default.createElement(_split_field_select.SplitFieldSelect,{fields:categoryFields,changeHandler:setSplitField,selectedField:splitField,isClearable:canClearSelection,testSubject:(0,_job_creator.isMultiMetricJobCreator)(jc)?"mlMultiMetricSplitFieldSelect":(0,_job_creator.isPopulationJobCreator)(jc)?"mlPopulationSplitFieldSelect":undefined}))};exports.SplitFieldSelector=SplitFieldSelector},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _new_job=__webpack_require__(60);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children,jobType=_ref.jobType;if(jobType===_new_job.JOB_TYPE.MULTI_METRIC){var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.splitField.title",{defaultMessage:"Split field"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.splitField.description",defaultMessage:"Select a field to partition analysis by. Each value of this field will be modeled independently individually."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}else if(jobType===_new_job.JOB_TYPE.POPULATION){var _title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationField.title",{defaultMessage:"Population field"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,_title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.populationField.description",defaultMessage:"All values in the selected field will be modeled together as a population. This analysis type is recommended for high cardinality data."})},_react.default.createElement(_eui.EuiFormRow,{label:_title},_react.default.createElement(_react.default.Fragment,null,children)))}else{return null}}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Influencers=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _influencers_select=__webpack_require__(1319);var _job_creator_context=__webpack_require__(53);var _new_job_capabilities_service=__webpack_require__(66);var _job_creator=__webpack_require__(89);var _description=__webpack_require__(1320);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var Influencers=function Influencers(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var jobCreator=jc;var fields=_new_job_capabilities_service.newJobCapsService.fields;var _useState=(0,_react.useState)(_toConsumableArray(jobCreator.influencers)),_useState2=_slicedToArray(_useState,2),influencers=_useState2[0],setInfluencers=_useState2[1];(0,_react.useEffect)((function(){jobCreator.removeAllInfluencers();influencers.forEach((function(i){return jobCreator.addInfluencer(i)}));if(jobCreator instanceof _job_creator.MultiMetricJobCreator){jobCreator.calculateModelMemoryLimit()}jobCreatorUpdate()}),[influencers.join()]);(0,_react.useEffect)((function(){setInfluencers(_toConsumableArray(jobCreator.influencers))}),[jobCreatorUpdated]);return _react.default.createElement(_description.Description,null,_react.default.createElement(_influencers_select.InfluencersSelect,{fields:fields,changeHandler:setInfluencers,selectedInfluencers:influencers}))};exports.Influencers=Influencers},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.InfluencersSelect=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _general=__webpack_require__(85);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var InfluencersSelect=function InfluencersSelect(_ref){var fields=_ref.fields,changeHandler=_ref.changeHandler,selectedInfluencers=_ref.selectedInfluencers;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;var options=[].concat(_toConsumableArray((0,_general.createFieldOptions)(fields,jobCreator.additionalFields)),_toConsumableArray((0,_general.createMlcategoryFieldOption)(jobCreator.categorizationFieldName)));var selection=selectedInfluencers.map((function(i){return{label:i}}));function onChange(selectedOptions){changeHandler(selectedOptions.map((function(o){return o.label})))}return _react.default.createElement(_eui.EuiComboBox,{options:options,selectedOptions:selection,onChange:onChange,isClearable:false,"data-test-subj":"mlInfluencerSelect"})};exports.InfluencersSelect=InfluencersSelect},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.influencers.title",{defaultMessage:"Influencers"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.influencers.description",defaultMessage:"Select which categorical fields have influence on the results. Who/what might you 'blame' for an anomaly? Recommend 1-3 influencers."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PopulationView=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _metric_selection=__webpack_require__(1322);var _metric_selection_summary=__webpack_require__(1324);var _settings=__webpack_require__(1325);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var PopulationView=function PopulationView(_ref){var isActive=_ref.isActive,setCanProceed=_ref.setCanProceed;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),metricsValid=_useState2[0],setMetricValid=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),settingsValid=_useState4[0],setSettingsValid=_useState4[1];(0,_react.useEffect)((function(){if(typeof setCanProceed==="function"){setCanProceed(metricsValid&&settingsValid)}}),[metricsValid,settingsValid]);return _react.default.createElement(_react.Fragment,null,isActive===false?_react.default.createElement(_metric_selection_summary.PopulationDetectorsSummary,null):_react.default.createElement(_react.Fragment,null,_react.default.createElement(_metric_selection.PopulationDetectors,{setIsValid:setMetricValid}),metricsValid&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),_react.default.createElement(_settings.PopulationSettings,{setIsValid:setSettingsValid}))))};exports.PopulationView=PopulationView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PopulationDetectors=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _new_job_capabilities_service=__webpack_require__(66);var _settings=__webpack_require__(105);var _metric_selector=__webpack_require__(1323);var _split_field=__webpack_require__(255);var _chart_grid=__webpack_require__(485);var _messagebar=__webpack_require__(91);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var PopulationDetectors=function PopulationDetectors(_ref){var setIsValid=_ref.setIsValid;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated,chartLoader=_useContext.chartLoader,chartInterval=_useContext.chartInterval;var jobCreator=jc;var fields=_new_job_capabilities_service.newJobCapsService.fields;var _useState=(0,_react.useState)([]),_useState2=_slicedToArray(_useState,2),selectedOptions=_useState2[0],setSelectedOptions=_useState2[1];var _useState3=(0,_react.useState)(jobCreator.aggFieldPairs),_useState4=_slicedToArray(_useState3,2),aggFieldPairList=_useState4[0],setAggFieldPairList=_useState4[1];var _useState5=(0,_react.useState)({}),_useState6=_slicedToArray(_useState5,2),lineChartsData=_useState6[0],setLineChartsData=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),loadingData=_useState8[0],setLoadingData=_useState8[1];var _useState9=(0,_react.useState)(jobCreator.start),_useState10=_slicedToArray(_useState9,2),start=_useState10[0],setStart=_useState10[1];var _useState11=(0,_react.useState)(jobCreator.end),_useState12=_slicedToArray(_useState11,2),end=_useState12[0],setEnd=_useState12[1];var _useState13=(0,_react.useState)(jobCreator.bucketSpanMs),_useState14=_slicedToArray(_useState13,2),bucketSpanMs=_useState14[0],setBucketSpanMs=_useState14[1];var _useState15=(0,_react.useState)(_settings.defaultChartSettings),_useState16=_slicedToArray(_useState15,2),chartSettings=_useState16[0],setChartSettings=_useState16[1];var _useState17=(0,_react.useState)(jobCreator.splitField),_useState18=_slicedToArray(_useState17,2),splitField=_useState18[0],setSplitField=_useState18[1];var _useState19=(0,_react.useState)({}),_useState20=_slicedToArray(_useState19,2),fieldValuesPerDetector=_useState20[0],setFieldValuesPerDetector=_useState20[1];var _useReducer=(0,_react.useReducer)((function(s){return s+1}),0),_useReducer2=_slicedToArray(_useReducer,2),byFieldsUpdated=_useReducer2[0],setByFieldsUpdated=_useReducer2[1];var _useState21=(0,_react.useState)(false),_useState22=_slicedToArray(_useState21,2),pageReady=_useState22[0],setPageReady=_useState22[1];var updateByFields=function updateByFields(){return setByFieldsUpdated(0)};function detectorChangeHandler(selectedOptionsIn){addDetector(selectedOptionsIn)}function addDetector(selectedOptionsIn){if(selectedOptionsIn!==null&&selectedOptionsIn.length){var option=selectedOptionsIn[0];if(typeof option!=="undefined"){var newPair={agg:option.agg,field:option.field,by:{field:null,value:null}};setAggFieldPairList([].concat(_toConsumableArray(aggFieldPairList),[newPair]));setSelectedOptions([])}else{setAggFieldPairList([])}}}function deleteDetector(index){aggFieldPairList.splice(index,1);setAggFieldPairList(_toConsumableArray(aggFieldPairList));updateByFields()}(0,_react.useEffect)((function(){setPageReady(true)}),[]);(0,_react.useEffect)((function(){jobCreator.removeAllDetectors();aggFieldPairList.forEach((function(pair,i){jobCreator.addDetector(pair.agg,pair.field);if(pair.by!==undefined){jobCreator.setByField(pair.by.field,i)}}));jobCreatorUpdate();loadCharts();setIsValid(aggFieldPairList.length>0)}),[aggFieldPairList.length]);(0,_react.useEffect)((function(){loadCharts()}),[JSON.stringify(fieldValuesPerDetector),splitField,pageReady]);(0,_react.useEffect)((function(){if(jobCreator.start!==start||jobCreator.end!==end){setStart(jobCreator.start);setEnd(jobCreator.end);loadCharts()}if(jobCreator.bucketSpanMs!==bucketSpanMs){setBucketSpanMs(jobCreator.bucketSpanMs);loadCharts()}setSplitField(jobCreator.splitField);var update=false;var newList=_toConsumableArray(aggFieldPairList);newList.forEach((function(pair,i){var bf=jobCreator.getByField(i);if(pair.by!==undefined&&pair.by.field!==bf){pair.by.field=bf;update=true}}));if(update){setAggFieldPairList(newList);updateByFields()}}),[jobCreatorUpdated]);(0,_react.useEffect)((function(){loadFieldExamples()}),[splitField,byFieldsUpdated]);function loadCharts(){return _loadCharts.apply(this,arguments)}function _loadCharts(){_loadCharts=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var cs,resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!allDataReady()){_context.next=16;break}setLoadingData(true);_context.prev=2;cs=(0,_settings.getChartSettings)(jobCreator,chartInterval);setChartSettings(cs);_context.next=7;return chartLoader.loadPopulationCharts(jobCreator.start,jobCreator.end,aggFieldPairList,jobCreator.splitField,cs.intervalMs);case 7:resp=_context.sent;setLineChartsData(resp);_context.next=15;break;case 11:_context.prev=11;_context.t0=_context["catch"](2);_messagebar.mlMessageBarService.notify.error(_context.t0);setLineChartsData([]);case 15:setLoadingData(false);case 16:case"end":return _context.stop()}}}),_callee,null,[[2,11]])})));return _loadCharts.apply(this,arguments)}function loadFieldExamples(){return _loadFieldExamples.apply(this,arguments)}function _loadFieldExamples(){_loadFieldExamples=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var promises,results,fieldValues,newPairs;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:promises=[];aggFieldPairList.forEach((function(af,i){if(af.by!==undefined&&af.by.field!==null){promises.push(function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(index,field){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.t0=index;_context2.next=3;return chartLoader.loadFieldExampleValues(field);case 3:_context2.t1=_context2.sent;return _context2.abrupt("return",{index:_context2.t0,fields:_context2.t1});case 5:case"end":return _context2.stop()}}}),_callee2)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}()(i,af.by.field))}}));_context3.next=4;return Promise.all(promises);case 4:results=_context3.sent;fieldValues=results.reduce((function(p,c){p[c.index]=c.fields;return p}),{});newPairs=aggFieldPairList.map((function(pair,i){return _objectSpread({},pair,{},pair.by===undefined||pair.by.field===null?{}:{by:_objectSpread({},pair.by,{value:fieldValues[i][0]})})}));setAggFieldPairList(_toConsumableArray(newPairs));setFieldValuesPerDetector(fieldValues);case 9:case"end":return _context3.stop()}}}),_callee3)})));return _loadFieldExamples.apply(this,arguments)}function allDataReady(){var ready=aggFieldPairList.length>0;aggFieldPairList.forEach((function(af){if(af.by!==undefined&&af.by.field!==null){ready=ready&&af.by.value!==null}}));return ready}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_split_field.SplitFieldSelector,null),splitField!==null&&_react.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),splitField!==null&&_react.default.createElement(_chart_grid.ChartGrid,{aggFieldPairList:aggFieldPairList,chartSettings:chartSettings,splitField:splitField,lineChartsData:lineChartsData,modelData:[],anomalyData:[],deleteDetector:deleteDetector,jobType:jobCreator.type,fieldValuesPerDetector:fieldValuesPerDetector,loading:loadingData}),splitField!==null&&_react.default.createElement(_metric_selector.MetricSelector,{fields:fields,detectorChangeHandler:detectorChangeHandler,selectedOptions:selectedOptions,removeOptions:[]}))};exports.PopulationDetectors=PopulationDetectors},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MetricSelector=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _agg_select=__webpack_require__(254);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var MAX_WIDTH=560;var MetricSelector=function MetricSelector(_ref){var fields=_ref.fields,detectorChangeHandler=_ref.detectorChangeHandler,selectedOptions=_ref.selectedOptions,maxWidth=_ref.maxWidth,removeOptions=_ref.removeOptions;return _react.default.createElement(_eui.EuiFlexGroup,{style:{maxWidth:maxWidth!==undefined?maxWidth:MAX_WIDTH}},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationView.addMetric",{defaultMessage:"Add metric"})},_react.default.createElement(_agg_select.AggSelect,{fields:fields,changeHandler:detectorChangeHandler,selectedOptions:selectedOptions,removeOptions:removeOptions}))))};exports.MetricSelector=MetricSelector},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PopulationDetectorsSummary=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _job_creator_context=__webpack_require__(53);var _settings=__webpack_require__(105);var _chart_grid=__webpack_require__(485);var _messagebar=__webpack_require__(91);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var PopulationDetectorsSummary=function PopulationDetectorsSummary(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,chartLoader=_useContext.chartLoader,resultsLoader=_useContext.resultsLoader,chartInterval=_useContext.chartInterval;var jobCreator=jc;var _useState=(0,_react.useState)(jobCreator.aggFieldPairs),_useState2=_slicedToArray(_useState,2),aggFieldPairList=_useState2[0],setAggFieldPairList=_useState2[1];var _useState3=(0,_react.useState)({}),_useState4=_slicedToArray(_useState3,2),lineChartsData=_useState4[0],setLineChartsData=_useState4[1];var _useState5=(0,_react.useState)(false),_useState6=_slicedToArray(_useState5,2),loadingData=_useState6[0],setLoadingData=_useState6[1];var _useState7=(0,_react.useState)([]),_useState8=_slicedToArray(_useState7,2),modelData=_useState8[0],setModelData=_useState8[1];var _useState9=(0,_react.useState)([]),_useState10=_slicedToArray(_useState9,2),anomalyData=_useState10[0],setAnomalyData=_useState10[1];var _useState11=(0,_react.useState)(_settings.defaultChartSettings),_useState12=_slicedToArray(_useState11,2),chartSettings=_useState12[0],setChartSettings=_useState12[1];var _useState13=(0,_react.useState)({}),_useState14=_slicedToArray(_useState13,2),fieldValuesPerDetector=_useState14[0],setFieldValuesPerDetector=_useState14[1];function setResultsWrapper(results){setModelData(results.model);setAnomalyData(results.anomalies)}(0,_react.useEffect)((function(){var subscription=resultsLoader.subscribeToResults(setResultsWrapper);return function(){subscription.unsubscribe()}}),[]);(0,_react.useEffect)((function(){if(allDataReady()){loadCharts()}}),[JSON.stringify(fieldValuesPerDetector),jobCreator.splitField]);(0,_react.useEffect)((function(){loadFieldExamples()}),[jobCreator.splitField]);function loadCharts(){return _loadCharts.apply(this,arguments)}function _loadCharts(){_loadCharts=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var cs,resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!allDataReady()){_context.next=16;break}setLoadingData(true);_context.prev=2;cs=(0,_settings.getChartSettings)(jobCreator,chartInterval);setChartSettings(cs);_context.next=7;return chartLoader.loadPopulationCharts(jobCreator.start,jobCreator.end,aggFieldPairList,jobCreator.splitField,cs.intervalMs);case 7:resp=_context.sent;setLineChartsData(resp);_context.next=15;break;case 11:_context.prev=11;_context.t0=_context["catch"](2);_messagebar.mlMessageBarService.notify.error(_context.t0);setLineChartsData({});case 15:setLoadingData(false);case 16:case"end":return _context.stop()}}}),_callee,null,[[2,11]])})));return _loadCharts.apply(this,arguments)}function loadFieldExamples(){return _loadFieldExamples.apply(this,arguments)}function _loadFieldExamples(){_loadFieldExamples=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var promises,results,fieldValues,newPairs;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:promises=[];aggFieldPairList.forEach((function(af,i){if(af.by!==undefined&&af.by.field!==null){promises.push(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(index,field){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.t0=index;_context2.next=3;return chartLoader.loadFieldExampleValues(field);case 3:_context2.t1=_context2.sent;return _context2.abrupt("return",{index:_context2.t0,fields:_context2.t1});case 5:case"end":return _context2.stop()}}}),_callee2)})));return function(_x,_x2){return _ref.apply(this,arguments)}}()(i,af.by.field))}}));_context3.next=4;return Promise.all(promises);case 4:results=_context3.sent;fieldValues=results.reduce((function(p,c){p[c.index]=c.fields;return p}),{});newPairs=aggFieldPairList.map((function(pair,i){return _objectSpread({},pair,{},pair.by===undefined||pair.by.field===null?{}:{by:_objectSpread({},pair.by,{value:fieldValues[i][0]})})}));setAggFieldPairList(_toConsumableArray(newPairs));setFieldValuesPerDetector(fieldValues);case 9:case"end":return _context3.stop()}}}),_callee3)})));return _loadFieldExamples.apply(this,arguments)}function allDataReady(){var ready=aggFieldPairList.length>0;aggFieldPairList.forEach((function(af){if(af.by!==undefined&&af.by.field!==null){ready=ready&&af.by.value!==null}}));return ready}return _react.default.createElement(_react.Fragment,null,jobCreator.splitField!==null&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.populationView.splitFieldTitle",defaultMessage:"Population split by {field}",values:{field:jobCreator.splitField.name}}),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_chart_grid.ChartGrid,{aggFieldPairList:jobCreator.aggFieldPairs,chartSettings:chartSettings,splitField:jobCreator.splitField,lineChartsData:lineChartsData,modelData:modelData,anomalyData:anomalyData,jobType:jobCreator.type,fieldValuesPerDetector:fieldValuesPerDetector,loading:loadingData})))};exports.PopulationDetectorsSummary=PopulationDetectorsSummary},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PopulationSettings=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _bucket_span=__webpack_require__(165);var _influencers=__webpack_require__(256);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var PopulationSettings=function PopulationSettings(_ref){var setIsValid=_ref.setIsValid;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_bucket_span.BucketSpan,{setIsValid:setIsValid})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_influencers.Influencers,null))))};exports.PopulationSettings=PopulationSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedView=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _metric_selection=__webpack_require__(1327);var _metric_selection_summary=__webpack_require__(1333);var _settings=__webpack_require__(1334);var _extra=__webpack_require__(1337);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var AdvancedView=function AdvancedView(_ref){var isActive=_ref.isActive,setCanProceed=_ref.setCanProceed;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),metricsValid=_useState2[0],setMetricValid=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),settingsValid=_useState4[0],setSettingsValid=_useState4[1];(0,_react.useEffect)((function(){if(typeof setCanProceed==="function"){setCanProceed(metricsValid&&settingsValid)}}),[metricsValid,settingsValid]);return _react.default.createElement(_react.Fragment,null,isActive===false?_react.default.createElement(_metric_selection_summary.AdvancedDetectorsSummary,null):_react.default.createElement(_react.Fragment,null,_react.default.createElement(_extra.ExtraSettings,null),_react.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),_react.default.createElement(_metric_selection.AdvancedDetectors,{setIsValid:setMetricValid}),_react.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),_react.default.createElement(_settings.AdvancedSettings,{setIsValid:setSettingsValid})))};exports.AdvancedView=AdvancedView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedDetectors=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _job_creator_context=__webpack_require__(53);var _new_job_capabilities_service=__webpack_require__(66);var _metric_selector=__webpack_require__(1328);var _detector_list=__webpack_require__(487);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var emptyRichDetector={agg:null,field:null,byField:null,overField:null,partitionField:null,excludeFrequent:null,description:null,customRules:null};var AdvancedDetectors=function AdvancedDetectors(_ref){var setIsValid=_ref.setIsValid;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate;var jobCreator=jc;var fields=_new_job_capabilities_service.newJobCapsService.fields,aggs=_new_job_capabilities_service.newJobCapsService.aggs;var _useState=(0,_react.useState)(null),_useState2=_slicedToArray(_useState,2),modalPayload=_useState2[0],setModalPayload=_useState2[1];function closeModal(){setModalPayload(null)}function detectorChangeHandler(dtr,index){if(index===undefined){jobCreator.addDetector(dtr.agg,dtr.field,dtr.byField,dtr.overField,dtr.partitionField,dtr.excludeFrequent,dtr.description)}else{jobCreator.editDetector(dtr.agg,dtr.field,dtr.byField,dtr.overField,dtr.partitionField,dtr.excludeFrequent,dtr.description,index)}jobCreatorUpdate();setModalPayload(null)}function showModal(){setModalPayload({detector:emptyRichDetector})}function onDeleteJob(i){jobCreator.removeDetector(i);jobCreatorUpdate()}function onEditJob(i){var dtr=jobCreator.richDetectors[i];if(dtr!==undefined){setModalPayload({detector:dtr,index:i})}}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_detector_list.DetectorList,{isActive:true,onEditJob:onEditJob,onDeleteJob:onDeleteJob}),_react.default.createElement(_metric_selector.MetricSelector,{payload:modalPayload,fields:fields,aggs:aggs,detectorChangeHandler:detectorChangeHandler,showModal:showModal,closeModal:closeModal}))};exports.AdvancedDetectors=AdvancedDetectors},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MetricSelector=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _advanced_detector_modal=__webpack_require__(1329);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var MAX_WIDTH=560;var MetricSelector=function MetricSelector(_ref){var payload=_ref.payload,fields=_ref.fields,aggs=_ref.aggs,detectorChangeHandler=_ref.detectorChangeHandler,closeModal=_ref.closeModal,showModal=_ref.showModal;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{style:{maxWidth:MAX_WIDTH}},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,null,_react.default.createElement(_eui.EuiButton,{onClick:showModal,"data-test-subj":"mlAddDetectorButton"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.addDetectorButton",defaultMessage:"Add detector"}))))),payload!==null&&_react.default.createElement(_advanced_detector_modal.AdvancedDetectorModal,{payload:payload,fields:fields,aggs:aggs,detectorChangeHandler:detectorChangeHandler,closeModal:closeModal}))};exports.MetricSelector=MetricSelector},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AdvancedDetectorModal",{enumerable:true,get:function get(){return _advanced_detector_modal.AdvancedDetectorModal}});Object.defineProperty(exports,"ModalPayload",{enumerable:true,get:function get(){return _advanced_detector_modal.ModalPayload}});var _advanced_detector_modal=__webpack_require__(1330)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedDetectorModal=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _general=__webpack_require__(85);var _fields=__webpack_require__(118);var _modal_wrapper=__webpack_require__(1331);var _string_utils=__webpack_require__(80);var _default_configs=__webpack_require__(131);var _descriptions=__webpack_require__(1332);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var emptyOption={label:""};var excludeFrequentOptions=[{label:"all"},{label:"none"}];var AdvancedDetectorModal=function AdvancedDetectorModal(_ref){var payload=_ref.payload,fields=_ref.fields,aggs=_ref.aggs,detectorChangeHandler=_ref.detectorChangeHandler,closeModal=_ref.closeModal;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator;var jobCreator=jc;var _useState=(0,_react.useState)(payload.detector),_useState2=_slicedToArray(_useState,2),detector=_useState2[0],setDetector=_useState2[1];var _useState3=(0,_react.useState)(createAggOption(detector.agg)),_useState4=_slicedToArray(_useState3,2),aggOption=_useState4[0],setAggOption=_useState4[1];var _useState5=(0,_react.useState)(createFieldOption(detector.field)),_useState6=_slicedToArray(_useState5,2),fieldOption=_useState6[0],setFieldOption=_useState6[1];var _useState7=(0,_react.useState)(createFieldOption(detector.byField)),_useState8=_slicedToArray(_useState7,2),byFieldOption=_useState8[0],setByFieldOption=_useState8[1];var _useState9=(0,_react.useState)(createFieldOption(detector.overField)),_useState10=_slicedToArray(_useState9,2),overFieldOption=_useState10[0],setOverFieldOption=_useState10[1];var _useState11=(0,_react.useState)(createFieldOption(detector.partitionField)),_useState12=_slicedToArray(_useState11,2),partitionFieldOption=_useState12[0],setPartitionFieldOption=_useState12[1];var _useState13=(0,_react.useState)(createExcludeFrequentOption(detector.excludeFrequent)),_useState14=_slicedToArray(_useState13,2),excludeFrequentOption=_useState14[0],setExcludeFrequentOption=_useState14[1];var _useState15=(0,_react.useState)(detector.description||""),_useState16=_slicedToArray(_useState15,2),descriptionOption=_useState16[0],setDescriptionOption=_useState16[1];var _useState17=(0,_react.useState)(true),_useState18=_slicedToArray(_useState17,2),splitFieldsEnabled=_useState18[0],setSplitFieldsEnabled=_useState18[1];var _useState19=(0,_react.useState)(true),_useState20=_slicedToArray(_useState19,2),excludeFrequentEnabled=_useState20[0],setExcludeFrequentEnabled=_useState20[1];var _useState21=(0,_react.useState)(true),_useState22=_slicedToArray(_useState21,2),fieldOptionEnabled=_useState22[0],setFieldOptionEnabled=_useState22[1];var _useDetectorPlacehold=useDetectorPlaceholder(detector),descriptionPlaceholder=_useDetectorPlacehold.descriptionPlaceholder,setDescriptionPlaceholder=_useDetectorPlacehold.setDescriptionPlaceholder;var usingScriptFields=jobCreator.additionalFields.length>0;var aggOptions=aggs.filter((function(agg){return filterAggs(agg,usingScriptFields)})).map(createAggOption);var _useCurrentFieldOptio=useCurrentFieldOptions(detector.agg,jobCreator.additionalFields,fields),currentFieldOptions=_useCurrentFieldOptio.currentFieldOptions,setCurrentFieldOptions=_useCurrentFieldOptio.setCurrentFieldOptions;var allFieldOptions=_toConsumableArray((0,_general.createFieldOptions)(fields,jobCreator.additionalFields)).sort(comboBoxOptionsSort);var splitFieldOptions=[].concat(_toConsumableArray(allFieldOptions),_toConsumableArray((0,_general.createMlcategoryFieldOption)(jobCreator.categorizationFieldName))).sort(comboBoxOptionsSort);var eventRateField=fields.find((function(f){return f.id===_fields.EVENT_RATE_FIELD_ID}));var onOptionChange=function onOptionChange(func){return function(selectedOptions){func(selectedOptions[0]||emptyOption)}};function getAgg(title){return aggs.find((function(a){return a.id===title}))||null}function getField(title){if(title===_fields.mlCategory.id){return _fields.mlCategory}return fields.find((function(f){return f.id===title}))||jobCreator.additionalFields.find((function(f){return f.id===title}))||null}(0,_react.useEffect)((function(){var agg=getAgg(aggOption.label);var field=getField(fieldOption.label);var byField=getField(byFieldOption.label);var overField=getField(overFieldOption.label);var partitionField=getField(partitionFieldOption.label);if(agg!==null){setCurrentFieldOptions(agg);if(isFieldlessAgg(agg)&&eventRateField!==undefined){setSplitFieldsEnabled(true);setFieldOption(emptyOption);setFieldOptionEnabled(false);field=eventRateField}else{setSplitFieldsEnabled(field!==null);setFieldOptionEnabled(true)}setExcludeFrequentEnabled(byField!==null||overField!==null)}else{setSplitFieldsEnabled(false);setFieldOptionEnabled(false)}var dtr={agg:agg,field:field,byField:byField,overField:overField,partitionField:partitionField,excludeFrequent:excludeFrequentOption.label!==""?excludeFrequentOption.label:null,description:descriptionOption!==""?descriptionOption:null,customRules:null};setDetector(dtr);setDescriptionPlaceholder(dtr)}),[aggOption,fieldOption,byFieldOption,overFieldOption,partitionFieldOption,excludeFrequentOption,descriptionOption]);(0,_react.useEffect)((function(){var agg=getAgg(aggOption.label);setSplitFieldsEnabled(aggOption.label!=="");if(agg!==null){setFieldOptionEnabled(isFieldlessAgg(agg)===false);var byField=getField(byFieldOption.label);var overField=getField(overFieldOption.label);setExcludeFrequentEnabled(byField!==null||overField!==null)}}),[]);(0,_react.useEffect)((function(){if(excludeFrequentEnabled===false){setExcludeFrequentOption(emptyOption)}}),[excludeFrequentEnabled]);function onCreateClick(){detectorChangeHandler(detector,payload.index)}function saveEnabled(){return splitFieldsEnabled&&(fieldOptionEnabled===false||fieldOptionEnabled===true&&fieldOption.label!=="")}return _react.default.createElement(_modal_wrapper.ModalWrapper,{onCreateClick:onCreateClick,closeModal:closeModal,saveEnabled:saveEnabled()},_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{"data-test-subj":"mlAdvancedFunctionSelect"},_react.default.createElement(_descriptions.AggDescription,null,_react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:aggOptions,selectedOptions:createSelectedOptions(aggOption,aggOptions),onChange:onOptionChange(setAggOption),isClearable:true}))),_react.default.createElement(_eui.EuiFlexItem,{"data-test-subj":"mlAdvancedFieldSelect"},_react.default.createElement(_descriptions.FieldDescription,null,_react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:currentFieldOptions,selectedOptions:createSelectedOptions(fieldOption,currentFieldOptions),onChange:onOptionChange(setFieldOption),isClearable:true,isDisabled:fieldOptionEnabled===false})))),_react.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),_react.default.createElement(_eui.EuiFlexGrid,{columns:2},_react.default.createElement(_eui.EuiFlexItem,{"data-test-subj":"mlAdvancedByFieldSelect"},_react.default.createElement(_descriptions.ByFieldDescription,null,_react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:splitFieldOptions,selectedOptions:createSelectedOptions(byFieldOption,splitFieldOptions),onChange:onOptionChange(setByFieldOption),isClearable:true,isDisabled:splitFieldsEnabled===false}))),_react.default.createElement(_eui.EuiFlexItem,{"data-test-subj":"mlAdvancedOverFieldSelect"},_react.default.createElement(_descriptions.OverFieldDescription,null,_react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:splitFieldOptions,selectedOptions:createSelectedOptions(overFieldOption,splitFieldOptions),onChange:onOptionChange(setOverFieldOption),isClearable:true,isDisabled:splitFieldsEnabled===false}))),_react.default.createElement(_eui.EuiFlexItem,{"data-test-subj":"mlAdvancedPartitionFieldSelect"},_react.default.createElement(_descriptions.PartitionFieldDescription,null,_react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:splitFieldOptions,selectedOptions:createSelectedOptions(partitionFieldOption,splitFieldOptions),onChange:onOptionChange(setPartitionFieldOption),isClearable:true,isDisabled:splitFieldsEnabled===false}))),_react.default.createElement(_eui.EuiFlexItem,{"data-test-subj":"mlAdvancedExcludeFrequentSelect"},_react.default.createElement(_descriptions.ExcludeFrequentDescription,null,_react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:excludeFrequentOptions,selectedOptions:createSelectedOptions(excludeFrequentOption,excludeFrequentOptions),onChange:onOptionChange(setExcludeFrequentOption),isClearable:true,isDisabled:splitFieldsEnabled===false||excludeFrequentEnabled===false})))),_react.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_descriptions.DescriptionDescription,null,_react.default.createElement(_eui.EuiTextArea,{rows:2,fullWidth:true,placeholder:descriptionPlaceholder,value:descriptionOption,onChange:function onChange(e){return setDescriptionOption(e.target.value)},"data-test-subj":"mlAdvancedDetectorDescriptionInput"}))))))};exports.AdvancedDetectorModal=AdvancedDetectorModal;function createAggOption(agg){if(agg===null){return emptyOption}return{label:agg.id}}function filterAggs(agg,usingScriptFields){return agg.fields!==undefined&&(usingScriptFields||agg.fields.length)}function createFieldOption(field){if(field===null){return emptyOption}return{label:field.name}}function createExcludeFrequentOption(excludeFrequent){if(excludeFrequent===null){return emptyOption}return{label:excludeFrequent}}function isFieldlessAgg(agg){return agg.fields&&agg.fields.length===1&&agg.fields[0].id===_fields.EVENT_RATE_FIELD_ID}function useDetectorPlaceholder(detector){var _useState23=(0,_react.useState)(createDefaultDescription(detector)),_useState24=_slicedToArray(_useState23,2),descriptionPlaceholder=_useState24[0],setDescriptionPlaceholderString=_useState24[1];function setDescriptionPlaceholder(dtr){setDescriptionPlaceholderString(createDefaultDescription(dtr))}return{descriptionPlaceholder:descriptionPlaceholder,setDescriptionPlaceholder:setDescriptionPlaceholder}}function createFieldOptionsFromAgg(agg,additionalFields){return(0,_general.createFieldOptions)(agg!==null&&agg.fields!==undefined?agg.fields:[],additionalFields)}function useCurrentFieldOptions(aggregation,additionalFields,fields){var _useState25=(0,_react.useState)(createFieldOptionsFromAgg(aggregation,additionalFields)),_useState26=_slicedToArray(_useState25,2),currentFieldOptions=_useState26[0],_setCurrentFieldOptions=_useState26[1];return{currentFieldOptions:currentFieldOptions,setCurrentFieldOptions:function setCurrentFieldOptions(agg){return _setCurrentFieldOptions(createFieldOptionsFromAgg(agg,additionalFields))}}}function createDefaultDescription(dtr){if(dtr.agg===null||dtr.field===null){return""}var basicDetector=(0,_default_configs.createBasicDetector)(dtr.agg,dtr.field);basicDetector.by_field_name=dtr.byField?dtr.byField.id:undefined;basicDetector.over_field_name=dtr.overField?dtr.overField.id:undefined;basicDetector.partition_field_name=dtr.partitionField?dtr.partitionField.id:undefined;basicDetector.exclude_frequent=dtr.excludeFrequent?dtr.excludeFrequent:undefined;return(0,_string_utils.detectorToString)(basicDetector)}function createSelectedOptions(selectedOption,options){return options.length===1&&options[0].label!==selectedOption.label||selectedOption.label===""?[]:[selectedOption]}function comboBoxOptionsSort(a,b){return a.label.localeCompare(b.label)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ModalWrapper=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var MAX_MODAL_WIDTH=1200;var ModalWrapper=function ModalWrapper(_ref){var onCreateClick=_ref.onCreateClick,closeModal=_ref.closeModal,saveEnabled=_ref.saveEnabled,children=_ref.children;return _react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiModal,{onClose:closeModal,maxWidth:MAX_MODAL_WIDTH,"data-test-subj":"mlCreateDetectorModal"},_react.default.createElement(_eui.EuiModalHeader,null,_react.default.createElement(_eui.EuiModalHeaderTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.title",defaultMessage:"Create detector"}))),_react.default.createElement(_eui.EuiModalBody,null,children),_react.default.createElement(_eui.EuiModalFooter,null,_react.default.createElement(_eui.EuiButtonEmpty,{onClick:closeModal,"data-test-subj":"mlCreateDetectorModalCancelButton"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.cancelButton",defaultMessage:"Cancel"})),_react.default.createElement(_eui.EuiButton,{onClick:onCreateClick,isDisabled:saveEnabled===false,fill:true,"data-test-subj":"mlCreateDetectorModalSaveButton"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.saveButton",defaultMessage:"Save"})))))};exports.ModalWrapper=ModalWrapper},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DescriptionDescription=exports.ExcludeFrequentDescription=exports.PartitionFieldDescription=exports.OverFieldDescription=exports.ByFieldDescription=exports.FieldDescription=exports.AggDescription=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var AggDescription=(0,_react.memo)((function(_ref){var children=_ref.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.aggSelect.title",{defaultMessage:"Function"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.aggSelect.description",defaultMessage:"Analysis functions to be performed e.g. sum, count."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.AggDescription=AggDescription;var FieldDescription=(0,_react.memo)((function(_ref2){var children=_ref2.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.fieldSelect.title",{defaultMessage:"Field"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.fieldSelect.description",defaultMessage:"Required for functions: sum, mean, median, max, min, info_content, distinct_count."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.FieldDescription=FieldDescription;var ByFieldDescription=(0,_react.memo)((function(_ref3){var children=_ref3.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.byFieldSelect.title",{defaultMessage:"By field"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.byFieldSelect.description",defaultMessage:"Required for individual analysis where anomalies are detected compared to an entity's own past behavior."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.ByFieldDescription=ByFieldDescription;var OverFieldDescription=(0,_react.memo)((function(_ref4){var children=_ref4.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.overFieldSelect.title",{defaultMessage:"Over field"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.overFieldSelect.description",defaultMessage:"Required for population analysis where anomalies are detected compared to the behavior of the population."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.OverFieldDescription=OverFieldDescription;var PartitionFieldDescription=(0,_react.memo)((function(_ref5){var children=_ref5.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.partitionFieldSelect.title",{defaultMessage:"Partition field"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.partitionFieldSelect.description",defaultMessage:"Allows segmentation of modeling into logical groups."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.PartitionFieldDescription=PartitionFieldDescription;var ExcludeFrequentDescription=(0,_react.memo)((function(_ref6){var children=_ref6.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.excludeFrequent.title",{defaultMessage:"Exclude frequent"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.excludeFrequent.description",defaultMessage:"If true will automatically identify and exclude frequently occurring entities which may otherwise have dominated results."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.ExcludeFrequentDescription=ExcludeFrequentDescription;var DescriptionDescription=(0,_react.memo)((function(_ref7){var children=_ref7.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.description.title",{defaultMessage:"Description"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{fullWidth:true,title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.description.description",defaultMessage:"Override the default detector description with a meaningful description of what the detector is analyzing."})},_react.default.createElement(_eui.EuiFormRow,{label:title,fullWidth:true},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.DescriptionDescription=DescriptionDescription},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedDetectorsSummary=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _detector_list=__webpack_require__(487);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdvancedDetectorsSummary=function AdvancedDetectorsSummary(){return _react.default.createElement(_detector_list.DetectorList,{isActive:false,onEditJob:function onEditJob(){},onDeleteJob:function onDeleteJob(){}})};exports.AdvancedDetectorsSummary=AdvancedDetectorsSummary},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedSettings=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _bucket_span=__webpack_require__(165);var _influencers=__webpack_require__(256);var _model_memory_limit=__webpack_require__(488);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var AdvancedSettings=function AdvancedSettings(_ref){var setIsValid=_ref.setIsValid;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_bucket_span.BucketSpan,{setIsValid:setIsValid})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_influencers.Influencers,null))),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_model_memory_limit.ModelMemoryLimitInput,null)),_react.default.createElement(_eui.EuiFlexItem,null)))};exports.AdvancedSettings=AdvancedSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ModelMemoryLimitInput=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _ml_server_info=__webpack_require__(84);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1336);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ModelMemoryLimitInput=function ModelMemoryLimitInput(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(jobValidator.modelMemoryLimit),_useState2=_slicedToArray(_useState,2),validation=_useState2[0],setValidation=_useState2[1];var _useState3=(0,_react.useState)(jobCreator.modelMemoryLimit===null?"":jobCreator.modelMemoryLimit),_useState4=_slicedToArray(_useState3,2),modelMemoryLimit=_useState4[0],setModelMemoryLimit=_useState4[1];var _getNewJobDefaults=(0,_ml_server_info.getNewJobDefaults)(),anomalyDetectors=_getNewJobDefaults.anomaly_detectors;var modelMemoryLimitDefault=anomalyDetectors.model_memory_limit;(0,_react.useEffect)((function(){jobCreator.modelMemoryLimit=modelMemoryLimit===""?null:modelMemoryLimit;jobCreatorUpdate()}),[modelMemoryLimit]);(0,_react.useEffect)((function(){setModelMemoryLimit(jobCreator.modelMemoryLimit===null?"":jobCreator.modelMemoryLimit)}),[jobCreatorUpdated]);(0,_react.useEffect)((function(){setValidation(jobValidator.modelMemoryLimit)}),[jobValidatorUpdated]);return _react.default.createElement(_description.Description,{validation:validation},_react.default.createElement(_eui.EuiFieldText,{value:modelMemoryLimit,placeholder:modelMemoryLimitDefault,onChange:function onChange(e){return setModelMemoryLimit(e.target.value)},isInvalid:validation.valid===false,"data-test-subj":"mlJobWizardInputModelMemoryLimit"}))};exports.ModelMemoryLimitInput=ModelMemoryLimitInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children,validation=_ref.validation;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.modelMemoryLimit.title",{defaultMessage:"Model memory limit"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.modelMemoryLimit.description",defaultMessage:"Set an approximate upper limit for the amount of memory that can be used by the analytical models."})},_react.default.createElement(_eui.EuiFormRow,{label:title,error:validation.message,isInvalid:validation.valid===false},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExtraSettings=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _summary_count_field=__webpack_require__(1338);var _categorization_field=__webpack_require__(489);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var ExtraSettings=function ExtraSettings(){return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_categorization_field.CategorizationField,null)),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_summary_count_field.SummaryCountField,null))))};exports.ExtraSettings=ExtraSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"SummaryCountField",{enumerable:true,get:function get(){return _summary_count_field.SummaryCountField}});var _summary_count_field=__webpack_require__(1339)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SummaryCountField=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _summary_count_field_select=__webpack_require__(1340);var _job_creator_context=__webpack_require__(53);var _new_job_capabilities_service=__webpack_require__(66);var _description=__webpack_require__(1341);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var SummaryCountField=function SummaryCountField(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var jobCreator=jc;var fields=_new_job_capabilities_service.newJobCapsService.fields;var _useState=(0,_react.useState)(jobCreator.summaryCountFieldName),_useState2=_slicedToArray(_useState,2),summaryCountFieldName=_useState2[0],setSummaryCountFieldName=_useState2[1];(0,_react.useEffect)((function(){jobCreator.summaryCountFieldName=summaryCountFieldName;jobCreatorUpdate()}),[summaryCountFieldName]);(0,_react.useEffect)((function(){setSummaryCountFieldName(jobCreator.summaryCountFieldName)}),[jobCreatorUpdated]);return _react.default.createElement(_description.Description,null,_react.default.createElement(_summary_count_field_select.SummaryCountFieldSelect,{fields:fields,changeHandler:setSummaryCountFieldName,selectedField:summaryCountFieldName}))};exports.SummaryCountField=SummaryCountField},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SummaryCountFieldSelect=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _general=__webpack_require__(85);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var SummaryCountFieldSelect=function SummaryCountFieldSelect(_ref){var fields=_ref.fields,changeHandler=_ref.changeHandler,selectedField=_ref.selectedField;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;var options=[].concat(_toConsumableArray((0,_general.createFieldOptions)(fields,jobCreator.additionalFields)),_toConsumableArray((0,_general.createDocCountFieldOption)(jobCreator.aggregationFields.length>0)));var selection=[];if(selectedField!==null){selection.push({label:selectedField})}function onChange(selectedOptions){var option=selectedOptions[0];if(typeof option!=="undefined"){changeHandler(option.label)}else{changeHandler(null)}}return _react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:options,selectedOptions:selection,onChange:onChange,isClearable:true,"data-test-subj":"mlSummaryCountFieldNameSelect"})};exports.SummaryCountFieldSelect=SummaryCountFieldSelect},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.title",{defaultMessage:"Summary count field"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.description",defaultMessage:"Optional, for use if input data has been pre-summarized e.g. \\{docCountParam\\}."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CategorizationField=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _categorization_field_select=__webpack_require__(1343);var _job_creator_context=__webpack_require__(53);var _new_job_capabilities_service=__webpack_require__(66);var _job_creator=__webpack_require__(89);var _description=__webpack_require__(1344);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var CategorizationField=function CategorizationField(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var jobCreator=jc;var catFields=_new_job_capabilities_service.newJobCapsService.catFields;var _useState=(0,_react.useState)(jobCreator.categorizationFieldName),_useState2=_slicedToArray(_useState,2),categorizationFieldName=_useState2[0],setCategorizationFieldName=_useState2[1];var isCategorizationJob=(0,_job_creator.isCategorizationJobCreator)(jobCreator);(0,_react.useEffect)((function(){if(jobCreator.categorizationFieldName!==categorizationFieldName){jobCreator.categorizationFieldName=categorizationFieldName;jobCreatorUpdate()}}),[categorizationFieldName]);(0,_react.useEffect)((function(){setCategorizationFieldName(jobCreator.categorizationFieldName)}),[jobCreatorUpdated]);return _react.default.createElement(_description.Description,{isOptional:isCategorizationJob===false},_react.default.createElement(_categorization_field_select.CategorizationFieldSelect,{fields:catFields,changeHandler:setCategorizationFieldName,selectedField:categorizationFieldName}))};exports.CategorizationField=CategorizationField},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CategorizationFieldSelect=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _general=__webpack_require__(85);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var CategorizationFieldSelect=function CategorizationFieldSelect(_ref){var fields=_ref.fields,changeHandler=_ref.changeHandler,selectedField=_ref.selectedField;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;var options=_toConsumableArray((0,_general.createFieldOptions)(fields,jobCreator.additionalFields));var selection=[];if(selectedField!==null){selection.push({label:selectedField})}function onChange(selectedOptions){var option=selectedOptions[0];if(typeof option!=="undefined"){changeHandler(option.label)}else{changeHandler(null)}}return _react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:options,selectedOptions:selection,onChange:onChange,isClearable:true,"data-test-subj":"mlCategorizationFieldNameSelect"})};exports.CategorizationFieldSelect=CategorizationFieldSelect},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children,isOptional=_ref.isOptional;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationField.title",{defaultMessage:"Categorization field"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react.default.Fragment,null,isOptional?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldOptional.description",defaultMessage:"Optional, for use if analyzing unstructured log data. Using text data types is recommended."}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationField.description",defaultMessage:"Specifies which field will be categorized. Using text data types is recommended. Categorization works best on machine written log messages, typically logging written by a developer for the purpose of system troubleshooting."}))},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CategorizationView=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _metric_selection=__webpack_require__(1346);var _metric_selection_summary=__webpack_require__(1354);var _settings=__webpack_require__(1356);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var CategorizationView=function CategorizationView(_ref){var isActive=_ref.isActive,setCanProceed=_ref.setCanProceed;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),categoryFieldValid=_useState2[0],setCategoryFieldValid=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),settingsValid=_useState4[0],setSettingsValid=_useState4[1];(0,_react.useEffect)((function(){if(typeof setCanProceed==="function"){setCanProceed(categoryFieldValid&&settingsValid)}}),[categoryFieldValid,settingsValid]);return isActive===false?_react.default.createElement(_metric_selection_summary.CategorizationDetectorsSummary,null):_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_metric_selection.CategorizationDetectors,{setIsValid:setCategoryFieldValid}),categoryFieldValid&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),_react.default.createElement(_settings.CategorizationSettings,{setIsValid:setSettingsValid})))};exports.CategorizationView=CategorizationView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CategorizationDetectors=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _messagebar=__webpack_require__(91);var _job_creator_context=__webpack_require__(53);var _categorization_field=__webpack_require__(489);var _categorization_detector=__webpack_require__(1347);var _field_examples=__webpack_require__(1350);var _examples_valid_callout=__webpack_require__(1351);var _categorization_job=__webpack_require__(142);var _loading_wrapper=__webpack_require__(252);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var CategorizationDetectors=function CategorizationDetectors(_ref){var setIsValid=_ref.setIsValid;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var jobCreator=jc;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),loadingData=_useState2[0],setLoadingData=_useState2[1];var _useState3=(0,_react.useState)(jobCreator.start),_useState4=_slicedToArray(_useState3,2),start=_useState4[0],setStart=_useState4[1];var _useState5=(0,_react.useState)(jobCreator.end),_useState6=_slicedToArray(_useState5,2),end=_useState6[0],setEnd=_useState6[1];var _useState7=(0,_react.useState)(JSON.stringify(jobCreator.categorizationAnalyzer)),_useState8=_slicedToArray(_useState7,2),categorizationAnalyzerString=_useState8[0],setCategorizationAnalyzerString=_useState8[1];var _useState9=(0,_react.useState)(null),_useState10=_slicedToArray(_useState9,2),fieldExamples=_useState10[0],setFieldExamples=_useState10[1];var _useState11=(0,_react.useState)(_categorization_job.CATEGORY_EXAMPLES_VALIDATION_STATUS.INVALID),_useState12=_slicedToArray(_useState11,2),overallValidStatus=_useState12[0],setOverallValidStatus=_useState12[1];var _useState13=(0,_react.useState)([]),_useState14=_slicedToArray(_useState13,2),validationChecks=_useState14[0],setValidationChecks=_useState14[1];var _useState15=(0,_react.useState)(jobCreator.categorizationFieldName),_useState16=_slicedToArray(_useState15,2),categorizationFieldName=_useState16[0],setCategorizationFieldName=_useState16[1];(0,_react.useEffect)((function(){if(jobCreator.categorizationFieldName!==categorizationFieldName){jobCreator.categorizationFieldName=categorizationFieldName;jobCreatorUpdate()}loadFieldExamples()}),[categorizationFieldName]);(0,_react.useEffect)((function(){var updateExamples=false;if(jobCreator.start!==start||jobCreator.end!==end){setStart(jobCreator.start);setEnd(jobCreator.end);updateExamples=true}var tempCategorizationAnalyzerString=JSON.stringify(jobCreator.categorizationAnalyzer);if(tempCategorizationAnalyzerString!==categorizationAnalyzerString){setCategorizationAnalyzerString(tempCategorizationAnalyzerString);updateExamples=true}if(updateExamples){loadFieldExamples()}if(jobCreator.categorizationFieldName!==categorizationFieldName){setCategorizationFieldName(jobCreator.categorizationFieldName)}}),[jobCreatorUpdated]);function loadFieldExamples(){return _loadFieldExamples.apply(this,arguments)}function _loadFieldExamples(){_loadFieldExamples=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _ref2,examples,tempOverallValidStatus,tempValidationChecks;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(categorizationFieldName!==null)){_context.next=24;break}setLoadingData(true);_context.prev=2;_context.next=5;return jobCreator.loadCategorizationFieldExamples();case 5:_ref2=_context.sent;examples=_ref2.examples;tempOverallValidStatus=_ref2.overallValidStatus;tempValidationChecks=_ref2.validationChecks;setFieldExamples(examples);setOverallValidStatus(tempOverallValidStatus);setValidationChecks(tempValidationChecks);setLoadingData(false);_context.next=22;break;case 15:_context.prev=15;_context.t0=_context["catch"](2);setLoadingData(false);setFieldExamples(null);setValidationChecks([]);setOverallValidStatus(_categorization_job.CATEGORY_EXAMPLES_VALIDATION_STATUS.INVALID);_messagebar.mlMessageBarService.notify.error(_context.t0);case 22:_context.next=27;break;case 24:setFieldExamples(null);setValidationChecks([]);setOverallValidStatus(_categorization_job.CATEGORY_EXAMPLES_VALIDATION_STATUS.INVALID);case 27:setIsValid(categorizationFieldName!==null);case 28:case"end":return _context.stop()}}}),_callee,null,[[2,15]])})));return _loadFieldExamples.apply(this,arguments)}(0,_react.useEffect)((function(){jobCreatorUpdate()}),[overallValidStatus]);return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_categorization_detector.CategorizationDetector,null),_react.default.createElement(_eui.EuiHorizontalRule,null),_react.default.createElement(_categorization_field.CategorizationField,null),loadingData===true&&_react.default.createElement(_loading_wrapper.LoadingWrapper,{hasData:false,loading:true},_react.default.createElement("div",null)),fieldExamples!==null&&loadingData===false&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_examples_valid_callout.ExamplesValidCallout,{overallValidStatus:overallValidStatus,validationChecks:validationChecks,categorizationAnalyzer:jobCreator.categorizationAnalyzer}),_react.default.createElement(_field_examples.FieldExamples,{fieldExamples:fieldExamples})))};exports.CategorizationDetectors=CategorizationDetectors},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CategorizationDetector",{enumerable:true,get:function get(){return _categorization_detector.CategorizationDetector}});var _categorization_detector=__webpack_require__(1348)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CategorizationDetector=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _aggregation_types=__webpack_require__(121);var _job_creator_context=__webpack_require__(53);var _detector_cards=__webpack_require__(1349);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var CategorizationDetector=function CategorizationDetector(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var jobCreator=jc;var _useState=(0,_react.useState)(jobCreator.selectedDetectorType),_useState2=_slicedToArray(_useState,2),categorizationDetectorType=_useState2[0],setCategorizationDetectorType=_useState2[1];(0,_react.useEffect)((function(){if(categorizationDetectorType!==jobCreator.selectedDetectorType){jobCreator.setDetectorType(categorizationDetectorType);jobCreatorUpdate()}}),[categorizationDetectorType]);(0,_react.useEffect)((function(){setCategorizationDetectorType(jobCreator.selectedDetectorType)}),[jobCreatorUpdated]);function onCountSelection(){setCategorizationDetectorType(_aggregation_types.ML_JOB_AGGREGATION.COUNT)}function onRareSelection(){setCategorizationDetectorType(_aggregation_types.ML_JOB_AGGREGATION.RARE)}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiTitle,{size:"xs"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.title",defaultMessage:"Categorization detector"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l",style:{maxWidth:"824px"}},_react.default.createElement(_detector_cards.CountCard,{onClick:onCountSelection,isSelected:categorizationDetectorType===_aggregation_types.ML_JOB_AGGREGATION.COUNT}),_react.default.createElement(_detector_cards.RareCard,{onClick:onRareSelection,isSelected:categorizationDetectorType===_aggregation_types.ML_JOB_AGGREGATION.RARE})))};exports.CategorizationDetector=CategorizationDetector},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RareCard=exports.CountCard=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CountCard=function CountCard(_ref){var onClick=_ref.onClick,isSelected=_ref.isSelected;return _react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorCountCard".concat(isSelected?" selected":""),title:_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.countCard.title",{defaultMessage:"Count"}),description:_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.countCard.description",defaultMessage:"Look for anomalies in the event rate of a particular category."})),selectable:{onClick:onClick,isSelected:isSelected}}))};exports.CountCard=CountCard;var RareCard=function RareCard(_ref2){var onClick=_ref2.onClick,isSelected=_ref2.isSelected;return _react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorRareCard".concat(isSelected?" selected":""),title:_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.rareCard.title",{defaultMessage:"Rare"}),description:_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.rareCard.description",defaultMessage:"Look for categories that occur rarely in time."})),selectable:{onClick:onClick,isSelected:isSelected}}))};exports.RareCard=RareCard},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldExamples=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TOKEN_HIGHLIGHT_COLOR="#b0ccf7";var FieldExamples=function FieldExamples(_ref){var fieldExamples=_ref.fieldExamples;if(fieldExamples===null||fieldExamples.length===0){return null}var columns=[{field:"example",name:_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldExamples.title",{defaultMessage:"Examples"}),render:function render(example){return _react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement("code",null,example))}}];var items=fieldExamples.map((function(example,i){var txt=[];var tokenCounter=0;var buffer="";var charCount=0;while(charCount<example.text.length){var token=example.tokens[tokenCounter];if(token&&charCount===token.start_offset){txt.push(buffer);buffer="";txt.push(_react.default.createElement(Token,{key:"".concat(i).concat(charCount)},token.token));charCount+=token.end_offset-token.start_offset;tokenCounter++}else{buffer+=example.text[charCount];charCount++}}txt.push(buffer);return{example:txt}}));return _react.default.createElement(_eui.EuiBasicTable,{columns:columns,items:items,"data-test-subj":"mlJobWizardCategorizationExamplesTable"})};exports.FieldExamples=FieldExamples;var Token=function Token(_ref2){var children=_ref2.children;return _react.default.createElement("span",{style:{backgroundColor:TOKEN_HIGHLIGHT_COLOR}},children)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExamplesValidCallout=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _edit_categorization_analyzer_flyout=__webpack_require__(1352);var _categorization_job=__webpack_require__(142);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var allChecksButtonContent=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.allChecksButton",{defaultMessage:"View all checks performed"});var ExamplesValidCallout=function ExamplesValidCallout(_ref){var overallValidStatus=_ref.overallValidStatus,validationChecks=_ref.validationChecks,categorizationAnalyzer=_ref.categorizationAnalyzer;var analyzerUsed=_react.default.createElement(AnalyzerUsed,{categorizationAnalyzer:categorizationAnalyzer});var color="success";var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.valid",{defaultMessage:"Selected category field is valid"});if(overallValidStatus===_categorization_job.CATEGORY_EXAMPLES_VALIDATION_STATUS.INVALID){color="danger";title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.invalid",{defaultMessage:"Selected category field is invalid"})}else if(overallValidStatus===_categorization_job.CATEGORY_EXAMPLES_VALIDATION_STATUS.PARTIALLY_VALID){color="warning";title=_i18n.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.possiblyInvalid",{defaultMessage:"Selected category field is possibly invalid"})}return _react.default.createElement(_eui.EuiCallOut,{color:color,title:title,"data-test-subj":"mlJobWizardCategorizationExamplesCallout ".concat(overallValidStatus)},validationChecks.map((function(v,i){return _react.default.createElement("div",{key:i},v.message)})),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),analyzerUsed,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiAccordion,{id:"all-checks",buttonContent:allChecksButtonContent},_react.default.createElement(AllValidationChecks,{validationChecks:validationChecks})))};exports.ExamplesValidCallout=ExamplesValidCallout;var AnalyzerUsed=function AnalyzerUsed(_ref2){var categorizationAnalyzer=_ref2.categorizationAnalyzer;var analyzer="";if((categorizationAnalyzer===null||categorizationAnalyzer===void 0?void 0:categorizationAnalyzer.tokenizer)!==undefined){analyzer=categorizationAnalyzer.tokenizer}else if((categorizationAnalyzer===null||categorizationAnalyzer===void 0?void 0:categorizationAnalyzer.analyzer)!==undefined){analyzer=categorizationAnalyzer.analyzer}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldAnalyzer",defaultMessage:"Analyzer used: {analyzer}",values:{analyzer:analyzer}})),_react.default.createElement("div",null,_react.default.createElement(_edit_categorization_analyzer_flyout.EditCategorizationAnalyzerFlyout,null)))};var AllValidationChecks=function AllValidationChecks(_ref3){var validationChecks=_ref3.validationChecks;var list=Object.keys(_categorization_job.VALIDATION_CHECK_DESCRIPTION).map((function(k,i){var failedCheck=validationChecks.find((function(vc){return vc.id===i}));if(failedCheck!==undefined&&(failedCheck===null||failedCheck===void 0?void 0:failedCheck.valid)!==_categorization_job.CATEGORY_EXAMPLES_VALIDATION_STATUS.VALID){return{iconType:"cross",label:failedCheck.message,size:"s"}}return{iconType:"check",label:_categorization_job.VALIDATION_CHECK_DESCRIPTION[i],size:"s"}}));return _react.default.createElement(_eui.EuiListGroup,{listItems:list,maxWidth:false})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EditCategorizationAnalyzerFlyout",{enumerable:true,get:function get(){return _edit_categorization_analyzer_flyout.EditCategorizationAnalyzerFlyout}});var _edit_categorization_analyzer_flyout=__webpack_require__(1353)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditCategorizationAnalyzerFlyout=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _ml_job_editor=__webpack_require__(103);var _validation_utils=__webpack_require__(164);var _job_creator_context=__webpack_require__(53);var _ml_server_info=__webpack_require__(84);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var EDITOR_HEIGHT="800px";var EditCategorizationAnalyzerFlyout=function EditCategorizationAnalyzerFlyout(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate;var jobCreator=jc;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),showJsonFlyout=_useState2[0],setShowJsonFlyout=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),saveable=_useState4[0],setSaveable=_useState4[1];var _useState5=(0,_react.useState)(JSON.stringify(jobCreator.categorizationAnalyzer,null,2)),_useState6=_slicedToArray(_useState5,2),categorizationAnalyzerString=_useState6[0],setCategorizationAnalyzerString=_useState6[1];(0,_react.useEffect)((function(){if(showJsonFlyout===true){setCategorizationAnalyzerString(JSON.stringify(jobCreator.categorizationAnalyzer,null,2))}}),[showJsonFlyout]);function toggleJsonFlyout(){setSaveable(false);setShowJsonFlyout(!showJsonFlyout)}function onJSONChange(json){setCategorizationAnalyzerString(json);var valid=(0,_validation_utils.isValidJson)(json);setSaveable(valid)}function onSave(){jobCreator.categorizationAnalyzer=JSON.parse(categorizationAnalyzerString);jobCreatorUpdate();setShowJsonFlyout(false)}function onUseDefault(){var _getNewJobDefaults=(0,_ml_server_info.getNewJobDefaults)(),anomalyDetectors=_getNewJobDefaults.anomaly_detectors;var analyzerString=JSON.stringify(anomalyDetectors.categorization_analyzer,null,2);onJSONChange(analyzerString)}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(FlyoutButton,{onClick:toggleJsonFlyout}),showJsonFlyout===true&&_react.default.createElement(_eui.EuiFlyout,{onClose:function onClose(){return setShowJsonFlyout(false)},hideCloseButton:true,size:"m"},_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(Contents,{onChange:onJSONChange,title:_i18n.i18n.translate("xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.title",{defaultMessage:"Edit categorization analyzer JSON"}),value:categorizationAnalyzerString})),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:function onClick(){return setShowJsonFlyout(false)},flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.closeButton",defaultMessage:"Close"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:true}),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{onClick:onUseDefault},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.useDefaultButton",defaultMessage:"Use default ML analyzer"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:onSave,fill:true,isDisabled:saveable===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.saveButton",defaultMessage:"Save"})))))))};exports.EditCategorizationAnalyzerFlyout=EditCategorizationAnalyzerFlyout;var FlyoutButton=function FlyoutButton(_ref){var onClick=_ref.onClick;return _react.default.createElement(_eui.EuiButtonEmpty,{onClick:onClick,flush:"left","data-test-subj":"mlJobWizardButtonPreviewJobJson"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.editCategorizationAnalyzerFlyoutButton",defaultMessage:"Edit categorization analyzer"}))};var Contents=function Contents(_ref2){var title=_ref2.title,value=_ref2.value,onChange=_ref2.onChange;return _react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h5",null,title)),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_ml_job_editor.MLJobEditor,{value:value,height:EDITOR_HEIGHT,readOnly:false,onChange:onChange}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CategorizationDetectorsSummary=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _job_creator_context=__webpack_require__(53);var _event_rate_chart=__webpack_require__(466);var _top_categories=__webpack_require__(1355);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var DTR_IDX=0;var CategorizationDetectorsSummary=function CategorizationDetectorsSummary(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,chartLoader=_useContext.chartLoader,resultsLoader=_useContext.resultsLoader,chartInterval=_useContext.chartInterval;var jobCreator=jc;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),loadingData=_useState2[0],setLoadingData=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=_slicedToArray(_useState3,2),anomalyData=_useState4[0],setAnomalyData=_useState4[1];var _useState5=(0,_react.useState)([]),_useState6=_slicedToArray(_useState5,2),eventRateChartData=_useState6[0],setEventRateChartData=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),jobIsRunning=_useState8[0],setJobIsRunning=_useState8[1];function setResultsWrapper(results){var anomalies=results.anomalies[DTR_IDX];if(anomalies!==undefined){setAnomalyData(anomalies)}}function watchProgress(progress){setJobIsRunning(progress>0)}(0,_react.useEffect)((function(){var resultsSubscription=resultsLoader.subscribeToResults(setResultsWrapper);jobCreator.subscribeToProgress(watchProgress);loadChart();return function(){resultsSubscription.unsubscribe()}}),[]);function loadChart(){return _loadChart.apply(this,arguments)}function _loadChart(){_loadChart=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoadingData(true);_context.prev=1;_context.next=4;return chartLoader.loadEventRateChart(jobCreator.start,jobCreator.end,chartInterval.getInterval().asMilliseconds());case 4:resp=_context.sent;setEventRateChartData(resp);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);setEventRateChartData([]);case 11:setLoadingData(false);case 12:case"end":return _context.stop()}}}),_callee,null,[[1,8]])})));return _loadChart.apply(this,arguments)}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_event_rate_chart.EventRateChart,{eventRateChartData:eventRateChartData,anomalyData:anomalyData,height:"300px",width:"100%",showAxis:true,loading:loadingData,fadeChart:jobIsRunning}),_react.default.createElement(_top_categories.TopCategories,null))};exports.CategorizationDetectorsSummary=CategorizationDetectorsSummary},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TopCategories=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _job_creator_context=__webpack_require__(53);var _ml_api_service=__webpack_require__(51);var _categorization_job=__webpack_require__(142);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var TopCategories=function TopCategories(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,resultsLoader=_useContext.resultsLoader;var jobCreator=jc;var _useState=(0,_react.useState)([]),_useState2=_slicedToArray(_useState,2),tableRow=_useState2[0],setTableRow=_useState2[1];var _useState3=(0,_react.useState)(0),_useState4=_slicedToArray(_useState3,2),totalCategories=_useState4[0],setTotalCategories=_useState4[1];function setResultsWrapper(results){loadTopCats()}function loadTopCats(){return _loadTopCats.apply(this,arguments)}function _loadTopCats(){_loadTopCats=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var results;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _ml_api_service.ml.jobs.topCategories(jobCreator.jobId,_categorization_job.NUMBER_OF_CATEGORY_EXAMPLES);case 2:results=_context.sent;setTableRow(results.categories.map((function(c){var _c$category$examples;return{count:c.count,example:((_c$category$examples=c.category.examples)===null||_c$category$examples===void 0?void 0:_c$category$examples.length)?c.category.examples[0]:""}})));setTotalCategories(results.total);case 5:case"end":return _context.stop()}}}),_callee)})));return _loadTopCats.apply(this,arguments)}(0,_react.useEffect)((function(){var resultsSubscription=resultsLoader.subscribeToResults(setResultsWrapper);return function(){resultsSubscription.unsubscribe()}}),[]);var columns=[].concat(_toConsumableArray(jobCreator.modelPlot?[{field:"count",name:"count",width:"100px",render:function render(count){return _react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement("code",null,count))}}]:[]),[{field:"example",name:"Example",render:function render(example){return _react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement("code",null,example))}}]);return _react.default.createElement(_react.default.Fragment,null,totalCategories>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationTotalCategories",defaultMessage:"Total categories: {totalCategories}",values:{totalCategories:totalCategories}})),_react.default.createElement(_eui.EuiBasicTable,{columns:columns,items:tableRow})))};exports.TopCategories=TopCategories},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CategorizationSettings=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _bucket_span=__webpack_require__(165);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CategorizationSettings=function CategorizationSettings(_ref){var setIsValid=_ref.setIsValid;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_bucket_span.BucketSpan,{setIsValid:setIsValid,hideEstimateButton:true}))))};exports.CategorizationSettings=CategorizationSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JsonEditorFlyout=exports.EDITOR_MODE=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _shared_imports=__webpack_require__(194);var _ml_job_editor=__webpack_require__(103);var _validation_utils=__webpack_require__(164);var _job_creator_context=__webpack_require__(53);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var EDITOR_HEIGHT="800px";var EDITOR_MODE;exports.EDITOR_MODE=EDITOR_MODE;(function(EDITOR_MODE){EDITOR_MODE[EDITOR_MODE["HIDDEN"]=0]="HIDDEN";EDITOR_MODE[EDITOR_MODE["READONLY"]=1]="READONLY";EDITOR_MODE[EDITOR_MODE["EDITABLE"]=2]="EDITABLE"})(EDITOR_MODE||(exports.EDITOR_MODE=EDITOR_MODE={}));var JsonEditorFlyout=function JsonEditorFlyout(_ref){var isDisabled=_ref.isDisabled,jobEditorMode=_ref.jobEditorMode,datafeedEditorMode=_ref.datafeedEditorMode;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),showJsonFlyout=_useState2[0],setShowJsonFlyout=_useState2[1];var _useState3=(0,_react.useState)(jobCreator.formattedJobJson),_useState4=_slicedToArray(_useState3,2),jobConfigString=_useState4[0],setJobConfigString=_useState4[1];var _useState5=(0,_react.useState)(jobCreator.formattedDatafeedJson),_useState6=_slicedToArray(_useState5,2),datafeedConfigString=_useState6[0],setDatafeedConfigString=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),saveable=_useState8[0],setSaveable=_useState8[1];(0,_react.useEffect)((function(){setJobConfigString(jobCreator.formattedJobJson);setDatafeedConfigString(jobCreator.formattedDatafeedJson)}),[jobCreatorUpdated]);var editJsonMode=jobEditorMode===EDITOR_MODE.HIDDEN||datafeedEditorMode===EDITOR_MODE.HIDDEN;var flyOutSize=editJsonMode?"m":"l";var readOnlyMode=jobEditorMode===EDITOR_MODE.READONLY&&datafeedEditorMode===EDITOR_MODE.READONLY;function toggleJsonFlyout(){setSaveable(false);setShowJsonFlyout(!showJsonFlyout)}function onJobChange(json){setJobConfigString(json);var valid=(0,_validation_utils.isValidJson)(json);setSaveable(valid)}function onDatafeedChange(json){setDatafeedConfigString(json);var jsonValue=(0,_shared_imports.collapseLiteralStrings)(json);var valid=(0,_validation_utils.isValidJson)(jsonValue);if(valid){var _JSON$parse=JSON.parse(jsonValue),indices=_JSON$parse.indices;var originalIndices=jobCreator.indices.sort();valid=originalIndices.length===indices.length&&originalIndices.every((function(value,index){return value===indices[index]}))}setSaveable(valid)}function onSave(){var jobConfig=JSON.parse(jobConfigString);var datafeedConfig=JSON.parse((0,_shared_imports.collapseLiteralStrings)(datafeedConfigString));jobCreator.cloneFromExistingJob(jobConfig,datafeedConfig);jobCreatorUpdate();setShowJsonFlyout(false)}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(FlyoutButton,{onClick:toggleJsonFlyout,isDisabled:isDisabled,editJsonMode:editJsonMode}),showJsonFlyout===true&&isDisabled===false&&_react.default.createElement(_eui.EuiFlyout,{onClose:function onClose(){return setShowJsonFlyout(false)},hideCloseButton:true,size:flyOutSize},_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(_eui.EuiFlexGroup,null,jobEditorMode!==EDITOR_MODE.HIDDEN&&_react.default.createElement(Contents,{editJson:jobEditorMode===EDITOR_MODE.EDITABLE,onChange:onJobChange,title:_i18n.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.job.title",{defaultMessage:"Job configuration JSON"}),value:jobConfigString}),datafeedEditorMode!==EDITOR_MODE.HIDDEN&&_react.default.createElement(Contents,{editJson:datafeedEditorMode===EDITOR_MODE.EDITABLE,onChange:onDatafeedChange,title:_i18n.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.datafeed.title",{defaultMessage:"Datafeed configuration JSON"}),value:datafeedConfigString}))),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:function onClick(){return setShowJsonFlyout(false)},flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.closeButton",defaultMessage:"Close"}))),readOnlyMode===false&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:onSave,fill:true,isDisabled:saveable===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.saveButton",defaultMessage:"Save"})))))))};exports.JsonEditorFlyout=JsonEditorFlyout;var FlyoutButton=function FlyoutButton(_ref2){var isDisabled=_ref2.isDisabled,onClick=_ref2.onClick,editJsonMode=_ref2.editJsonMode;var previewJsonTitle=_i18n.i18n.translate("xpack.ml.newJob.wizard.previewJsonButton",{defaultMessage:"Preview JSON"});var editJsonTitle=_i18n.i18n.translate("xpack.ml.newJob.wizard.editJsonButton",{defaultMessage:"Edit JSON"});return _react.default.createElement(_eui.EuiButtonEmpty,{onClick:onClick,isDisabled:isDisabled,"data-test-subj":"mlJobWizardButtonPreviewJobJson"},editJsonMode?editJsonTitle:previewJsonTitle)};var Contents=function Contents(_ref3){var title=_ref3.title,value=_ref3.value,editJson=_ref3.editJson,onChange=_ref3.onChange;return _react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h5",null,title)),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_ml_job_editor.MLJobEditor,{value:value,height:EDITOR_HEIGHT,mode:_ml_job_editor.ML_EDITOR_MODE.XJSON,readOnly:editJson===false,onChange:onChange}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DatafeedPreviewFlyout=exports.EDITOR_MODE=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _ml_job_editor=__webpack_require__(103);var _job_creator_context=__webpack_require__(53);var _job_service=__webpack_require__(58);var _job_utils=__webpack_require__(59);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var EDITOR_HEIGHT="800px";var EDITOR_MODE;exports.EDITOR_MODE=EDITOR_MODE;(function(EDITOR_MODE){EDITOR_MODE[EDITOR_MODE["HIDDEN"]=0]="HIDDEN";EDITOR_MODE[EDITOR_MODE["READONLY"]=1]="READONLY";EDITOR_MODE[EDITOR_MODE["EDITABLE"]=2]="EDITABLE"})(EDITOR_MODE||(exports.EDITOR_MODE=EDITOR_MODE={}));var DatafeedPreviewFlyout=function DatafeedPreviewFlyout(_ref){var isDisabled=_ref.isDisabled;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),showFlyout=_useState2[0],setShowFlyout=_useState2[1];var _useState3=(0,_react.useState)(""),_useState4=_slicedToArray(_useState3,2),previewJsonString=_useState4[0],setPreviewJsonString=_useState4[1];var _useState5=(0,_react.useState)(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];function toggleFlyout(){setShowFlyout(!showFlyout)}(0,_react.useEffect)((function(){if(showFlyout===true){loadDataPreview()}}),[showFlyout]);function loadDataPreview(){return _loadDataPreview.apply(this,arguments)}function _loadDataPreview(){_loadDataPreview=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var combinedJob,resp,data,errorText;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);setPreviewJsonString("");combinedJob=_objectSpread({},jobCreator.jobConfig,{datafeed_config:jobCreator.datafeedConfig});if(!(combinedJob.datafeed_config&&combinedJob.datafeed_config.indices.length)){_context.next=18;break}_context.prev=4;_context.next=7;return _job_service.mlJobService.searchPreview(combinedJob);case 7:resp=_context.sent;data=resp.aggregations?resp.aggregations.buckets.buckets.slice(0,_job_utils.ML_DATA_PREVIEW_COUNT):resp.hits.hits;setPreviewJsonString(JSON.stringify(data,null,2));_context.next=15;break;case 12:_context.prev=12;_context.t0=_context["catch"](4);setPreviewJsonString(JSON.stringify(_context.t0,null,2));case 15:setLoading(false);_context.next=20;break;case 18:errorText=_i18n.i18n.translate("xpack.ml.newJob.wizard.datafeedPreviewFlyout.datafeedDoesNotExistLabel",{defaultMessage:"Datafeed does not exist"});setPreviewJsonString(errorText);case 20:case"end":return _context.stop()}}}),_callee,null,[[4,12]])})));return _loadDataPreview.apply(this,arguments)}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(FlyoutButton,{onClick:toggleFlyout,isDisabled:isDisabled}),showFlyout===true&&isDisabled===false&&_react.default.createElement(_eui.EuiFlyout,{onClose:function onClose(){return setShowFlyout(false)},hideCloseButton:true,size:"m"},_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(Contents,{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.datafeedPreviewFlyout.title",{defaultMessage:"Datafeed preview"}),value:previewJsonString,loading:loading})),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:function onClick(){return setShowFlyout(false)},flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedPreviewFlyout.closeButton",defaultMessage:"Close"})))))))};exports.DatafeedPreviewFlyout=DatafeedPreviewFlyout;var FlyoutButton=function FlyoutButton(_ref2){var isDisabled=_ref2.isDisabled,onClick=_ref2.onClick;return _react.default.createElement(_eui.EuiButtonEmpty,{onClick:onClick,isDisabled:isDisabled,"data-test-subj":"mlJobWizardButtonPreviewJobJson"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedPreviewFlyout.showButton",defaultMessage:"Datafeed preview"}))};var Contents=function Contents(_ref3){var title=_ref3.title,value=_ref3.value,loading=_ref3.loading;return _react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h5",null,title)),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),loading===true?_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}),_react.default.createElement(_eui.EuiLoadingSpinner,{size:"l"}))):_react.default.createElement(_ml_job_editor.MLJobEditor,{value:value,height:EDITOR_HEIGHT,readOnly:true}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobDetailsStep",{enumerable:true,get:function get(){return _job_details.JobDetailsStep}});var _job_details=__webpack_require__(1360)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobDetailsStep=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _wizard_nav=__webpack_require__(140);var _job_id=__webpack_require__(1361);var _job_description=__webpack_require__(1364);var _groups=__webpack_require__(1367);var _step_types=__webpack_require__(104);var _job_creator_context=__webpack_require__(53);var _advanced_section=__webpack_require__(1369);var _additional_section=__webpack_require__(1378);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var JobDetailsStep=function JobDetailsStep(_ref){var setCurrentStep=_ref.setCurrentStep,isCurrentStep=_ref.isCurrentStep,advancedExpanded=_ref.advancedExpanded,setAdvancedExpanded=_ref.setAdvancedExpanded,additionalExpanded=_ref.additionalExpanded,setAdditionalExpanded=_ref.setAdditionalExpanded;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),nextActive=_useState2[0],setNextActive=_useState2[1];(0,_react.useEffect)((function(){var active=jobValidator.jobId.valid&&jobValidator.modelMemoryLimit.valid&&jobValidator.groupIds.valid&&jobValidator.validating===false;setNextActive(active)}),[jobValidatorUpdated]);return _react.default.createElement(_react.Fragment,null,isCurrentStep&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_job_id.JobIdInput,null),_react.default.createElement(_groups.GroupsInput,null)),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_job_description.JobDescriptionInput,null))),_react.default.createElement(_additional_section.AdditionalSection,{additionalExpanded:additionalExpanded,setAdditionalExpanded:setAdditionalExpanded}),_react.default.createElement(_advanced_section.AdvancedSection,{advancedExpanded:advancedExpanded,setAdvancedExpanded:setAdvancedExpanded}),_react.default.createElement(_wizard_nav.WizardNav,{previous:function previous(){return setCurrentStep(_step_types.WIZARD_STEPS.PICK_FIELDS)},next:function next(){return setCurrentStep(_step_types.WIZARD_STEPS.VALIDATION)},nextActive:nextActive})))};exports.JobDetailsStep=JobDetailsStep},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobIdInput",{enumerable:true,get:function get(){return _job_id_input.JobIdInput}});var _job_id_input=__webpack_require__(1362)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobIdInput=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1363);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var JobIdInput=function JobIdInput(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(jobCreator.jobId),_useState2=_slicedToArray(_useState,2),jobId=_useState2[0],setJobId=_useState2[1];var _useState3=(0,_react.useState)(jobValidator.jobId),_useState4=_slicedToArray(_useState3,2),validation=_useState4[0],setValidation=_useState4[1];(0,_react.useEffect)((function(){jobCreator.jobId=jobId;jobCreatorUpdate()}),[jobId]);(0,_react.useEffect)((function(){var isEmptyId=jobId==="";setValidation({valid:isEmptyId===true||jobValidator.jobId.valid,message:isEmptyId===false?jobValidator.jobId.message:""})}),[jobValidatorUpdated]);return _react.default.createElement(_description.Description,{validation:validation},_react.default.createElement(_eui.EuiFieldText,{value:jobId,onChange:function onChange(e){return setJobId(e.target.value)},isInvalid:validation.valid===false,"data-test-subj":"mlJobWizardInputJobId"}))};exports.JobIdInput=JobIdInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children,validation=_ref.validation;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobId.title",{defaultMessage:"Job ID"});var description=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobId.description",{defaultMessage:'A unique identifier for the job. Spaces and the characters  / ? , " < > | * are not allowed'});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:description},_react.default.createElement(_eui.EuiFormRow,{label:title,error:validation.message,isInvalid:validation.valid===false},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobDescriptionInput",{enumerable:true,get:function get(){return _job_description_input.JobDescriptionInput}});var _job_description_input=__webpack_require__(1365)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobDescriptionInput=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1366);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var JobDescriptionInput=function JobDescriptionInput(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate;var _useState=(0,_react.useState)(jobCreator.description),_useState2=_slicedToArray(_useState,2),jobDescription=_useState2[0],setJobDescription=_useState2[1];(0,_react.useEffect)((function(){jobCreator.description=jobDescription;jobCreatorUpdate()}),[jobDescription]);return _react.default.createElement(_description.Description,null,_react.default.createElement(_eui.EuiTextArea,{value:jobDescription,onChange:function onChange(e){return setJobDescription(e.target.value)},"data-test-subj":"mlJobWizardInputJobDescription"}))};exports.JobDescriptionInput=JobDescriptionInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobDescription.title",{defaultMessage:"Job description"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.jobDescription.description",defaultMessage:"Optional descriptive text"})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"GroupsInput",{enumerable:true,get:function get(){return _groups_input.GroupsInput}});var _groups_input=__webpack_require__(1368)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GroupsInput=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _job_creator_context=__webpack_require__(53);var _group_color_utils=__webpack_require__(151);var _description=__webpack_require__(476);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var GroupsInput=function GroupsInput(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useContext2=(0,_react.useContext)(_job_creator_context.JobCreatorContext),existingJobsAndGroups=_useContext2.existingJobsAndGroups;var _useState=(0,_react.useState)(jobCreator.groups),_useState2=_slicedToArray(_useState,2),selectedGroups=_useState2[0],setSelectedGroups=_useState2[1];var _useState3=(0,_react.useState)(jobValidator.groupIds),_useState4=_slicedToArray(_useState3,2),validation=_useState4[0],setValidation=_useState4[1];(0,_react.useEffect)((function(){jobCreator.groups=selectedGroups;jobCreatorUpdate()}),[selectedGroups.join()]);var options=existingJobsAndGroups.groupIds.map((function(g){return{label:g,color:(0,_group_color_utils.tabColor)(g)}}));var selectedOptions=selectedGroups.map((function(g){return{label:g,color:(0,_group_color_utils.tabColor)(g)}}));function onChange(optionsIn){setSelectedGroups(optionsIn.map((function(g){return g.label})))}function onCreateGroup(input,flattenedOptions){var normalizedSearchValue=input.trim().toLowerCase();if(!normalizedSearchValue){return}var newGroup={label:input,color:(0,_group_color_utils.tabColor)(input)};if(flattenedOptions.findIndex((function(option){return option.label.trim().toLowerCase()===normalizedSearchValue}))===-1){options.push(newGroup)}setSelectedGroups([].concat(_toConsumableArray(selectedOptions),[newGroup]).map((function(g){return g.label})))}(0,_react.useEffect)((function(){setValidation(jobValidator.groupIds)}),[jobValidatorUpdated]);return _react.default.createElement(_description.Description,{validation:validation},_react.default.createElement(_eui.EuiComboBox,{placeholder:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.placeholder",{defaultMessage:"Select or create groups"}),options:options,selectedOptions:selectedOptions,onChange:onChange,onCreateOption:onCreateGroup,isClearable:true,isInvalid:validation.valid===false,"data-test-subj":"mlJobWizardComboBoxJobGroups"}))};exports.GroupsInput=GroupsInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AdvancedSection",{enumerable:true,get:function get(){return _advanced_section.AdvancedSection}});var _advanced_section=__webpack_require__(1370)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedSection=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _model_plot=__webpack_require__(1371);var _dedicated_index=__webpack_require__(1375);var _model_memory_limit=__webpack_require__(488);var _job_creator_context=__webpack_require__(53);var _new_job=__webpack_require__(60);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var buttonContent=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSectionButton",{defaultMessage:"Advanced"});var AdvancedSection=function AdvancedSection(_ref){var advancedExpanded=_ref.advancedExpanded,setAdvancedExpanded=_ref.setAdvancedExpanded;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;if(jobCreator.type===_new_job.JOB_TYPE.ADVANCED){return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHorizontalRule,{margin:"xl"}),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_model_plot.ModelPlotSwitch,null)),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_dedicated_index.DedicatedIndexSwitch,null))))}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiAccordion,{id:"advanced-section",buttonContent:buttonContent,onToggle:setAdvancedExpanded,initialIsOpen:advancedExpanded,"data-test-subj":"mlJobWizardToggleAdvancedSection"},_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"},"data-test-subj":"mlJobWizardAdvancedSection"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_model_plot.ModelPlotSwitch,null),_react.default.createElement(_model_memory_limit.ModelMemoryLimitInput,null)),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_dedicated_index.DedicatedIndexSwitch,null)))))};exports.AdvancedSection=AdvancedSection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ModelPlotSwitch",{enumerable:true,get:function get(){return _model_plot_switch.ModelPlotSwitch}});var _model_plot_switch=__webpack_require__(1372)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ModelPlotSwitch=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1373);var _mml_callout=__webpack_require__(1374);var _aggregation_types=__webpack_require__(121);var _job_creator=__webpack_require__(89);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ModelPlotSwitch=function ModelPlotSwitch(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var _useState=(0,_react.useState)(jobCreator.modelPlot),_useState2=_slicedToArray(_useState,2),modelPlotEnabled=_useState2[0],setModelPlotEnabled=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),enabled=_useState4[0],setEnabled=_useState4[1];(0,_react.useEffect)((function(){jobCreator.modelPlot=modelPlotEnabled;jobCreatorUpdate()}),[modelPlotEnabled]);(0,_react.useEffect)((function(){var aggs=[_aggregation_types.ML_JOB_AGGREGATION.RARE];var isRareCategoryJob=(0,_job_creator.isCategorizationJobCreator)(jobCreator)&&jobCreator.aggregations.some((function(agg){return aggs.includes(agg.id)}));setEnabled(isRareCategoryJob===false)}),[jobCreatorUpdated]);function toggleModelPlot(){setModelPlotEnabled(!modelPlotEnabled)}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_description.Description,null,_react.default.createElement(_eui.EuiSwitch,{name:"switch",disabled:enabled===false,checked:modelPlotEnabled,onChange:toggleModelPlot,"data-test-subj":"mlJobWizardSwitchModelPlot",label:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.title",{defaultMessage:"Enable model plot"})})),_react.default.createElement(_mml_callout.MMLCallout,null),_react.default.createElement(_eui.EuiSpacer,null))};exports.ModelPlotSwitch=ModelPlotSwitch},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.title",{defaultMessage:"Enable model plot"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.description",defaultMessage:"Select to store additional model information used for plotting model bounds. This will add overhead to the performance of the system and is not recommended for high cardinality data."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MMLCallout=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var MMLCallout=function MMLCallout(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(null),_useState2=_slicedToArray(_useState,2),highCardinality=_useState2[0],setHighCardinality=_useState2[1];(0,_react.useEffect)((function(){var _ref,_jobValidator$latestV,_jobValidator$latestV2;var value=(_ref=(_jobValidator$latestV=jobValidator.latestValidationResult)===null||_jobValidator$latestV===void 0?void 0:(_jobValidator$latestV2=_jobValidator$latestV.highCardinality)===null||_jobValidator$latestV2===void 0?void 0:_jobValidator$latestV2.value)!==null&&_ref!==void 0?_ref:null;setHighCardinality(value)}),[jobValidatorUpdated]);return jobCreator.modelPlot&&highCardinality!==null?_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.mmlWarning.title",defaultMessage:"Proceed with caution!"}),color:"warning",iconType:"help"},_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.mmlWarning.message",defaultMessage:"Creating model plots is resource intensive and not recommended where the cardinality of the selected fields is greater than 100. Estimated cardinality for this job is {highCardinality}. If you enable model plot with this configuration we recommend you use a dedicated results index.",values:{highCardinality:highCardinality}}))):null};exports.MMLCallout=MMLCallout},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DedicatedIndexSwitch",{enumerable:true,get:function get(){return _dedicated_index_switch.DedicatedIndexSwitch}});var _dedicated_index_switch=__webpack_require__(1376)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DedicatedIndexSwitch=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1377);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var DedicatedIndexSwitch=function DedicatedIndexSwitch(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate;var _useState=(0,_react.useState)(jobCreator.useDedicatedIndex),_useState2=_slicedToArray(_useState,2),useDedicatedIndex=_useState2[0],setUseDedicatedIndex=_useState2[1];(0,_react.useEffect)((function(){jobCreator.useDedicatedIndex=useDedicatedIndex;jobCreatorUpdate()}),[useDedicatedIndex]);function toggleModelPlot(){setUseDedicatedIndex(!useDedicatedIndex)}return _react.default.createElement(_description.Description,null,_react.default.createElement(_eui.EuiSwitch,{name:"switch",checked:useDedicatedIndex,onChange:toggleModelPlot,"data-test-subj":"mlJobWizardSwitchUseDedicatedIndex",label:_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"})}))};exports.DedicatedIndexSwitch=DedicatedIndexSwitch},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.description",defaultMessage:"Select to store results in a separate index for this job."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AdditionalSection",{enumerable:true,get:function get(){return _additional_section.AdditionalSection}});var _additional_section=__webpack_require__(1379)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdditionalSection=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _calendars=__webpack_require__(1380);var _custom_urls=__webpack_require__(1383);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var buttonContent=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSectionButton",{defaultMessage:"Additional settings"});var AdditionalSection=function AdditionalSection(_ref){var additionalExpanded=_ref.additionalExpanded,setAdditionalExpanded=_ref.setAdditionalExpanded;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiAccordion,{id:"advanced-section",buttonContent:buttonContent,onToggle:setAdditionalExpanded,initialIsOpen:additionalExpanded,"data-test-subj":"mlJobWizardToggleAdditionalSettingsSection"},_react.default.createElement("section",{"data-test-subj":"mlJobWizardAdditionalSettingsSection"},_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"}},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_custom_urls.CustomUrlsSelection,null))),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"}},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_calendars.CalendarsSelection,null)),_react.default.createElement(_eui.EuiFlexItem,null)))))};exports.AdditionalSection=AdditionalSection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CalendarsSelection",{enumerable:true,get:function get(){return _calendars_selection.CalendarsSelection}});var _calendars_selection=__webpack_require__(1381)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CalendarsSelection=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1382);var _ml_api_service=__webpack_require__(51);var _calendars=__webpack_require__(259);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var CalendarsSelection=function CalendarsSelection(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate;var _useState=(0,_react.useState)(jobCreator.calendars),_useState2=_slicedToArray(_useState,2),selectedCalendars=_useState2[0],setSelectedCalendars=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=_slicedToArray(_useState3,2),selectedOptions=_useState4[0],setSelectedOptions=_useState4[1];var _useState5=(0,_react.useState)([]),_useState6=_slicedToArray(_useState5,2),options=_useState6[0],setOptions=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];function loadCalendars(){return _loadCalendars.apply(this,arguments)}function _loadCalendars(){_loadCalendars=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var calendars;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.next=3;return _ml_api_service.ml.calendars();case 3:_context.t0=function(c){return c.job_ids.includes(_calendars.GLOBAL_CALENDAR)===false};calendars=_context.sent.filter(_context.t0);setOptions(calendars.map((function(c){return{label:c.calendar_id,value:c}})));setSelectedOptions(selectedCalendars.map((function(c){return{label:c.calendar_id,value:c}})));setIsLoading(false);case 8:case"end":return _context.stop()}}}),_callee)})));return _loadCalendars.apply(this,arguments)}(0,_react.useEffect)((function(){loadCalendars()}),[]);(0,_react.useEffect)((function(){jobCreator.calendars=selectedCalendars;jobCreatorUpdate()}),[selectedCalendars.join()]);var comboBoxProps={async:true,options:options,selectedOptions:selectedOptions,isLoading:isLoading,onChange:function onChange(optionsIn){setSelectedOptions(optionsIn);setSelectedCalendars(optionsIn.map((function(o){return o.value})))}};var manageCalendarsHref="#/settings/calendars_list";return _react.default.createElement(_description.Description,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiComboBox,_extends({},comboBoxProps,{"data-test-subj":"mlJobWizardComboBoxCalendars"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiToolTip,{position:"right",content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.refreshCalendarsButtonLabel",defaultMessage:"Refresh calendars"})},_react.default.createElement(_eui.EuiButtonIcon,{iconType:"refresh",color:"primary","aria-label":_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.refreshCalendarsButtonLabel",{defaultMessage:"Refresh calendars"}),onClick:loadCalendars})))),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement(_eui.EuiLink,{href:manageCalendarsHref,target:"_blank",external:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.manageCalendarsButtonLabel",defaultMessage:"Manage calendars"}))))};exports.CalendarsSelection=CalendarsSelection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _kibana=__webpack_require__(57);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children;var _useMlKibana=(0,_kibana.useMlKibana)(),docLinks=_useMlKibana.services.docLinks;var ELASTIC_WEBSITE_URL=docLinks.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=docLinks.DOC_LINK_VERSION;var docsUrl="".concat(ELASTIC_WEBSITE_URL,"guide/en/machine-learning/").concat(DOC_LINK_VERSION,"/ml-calendars.html");var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.title",{defaultMessage:"Calendars"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.description",defaultMessage:"Contains a list of scheduled events that you want to ignore, such as planned system outages or public holidays. {learnMoreLink}",values:{learnMoreLink:_react.default.createElement(_eui.EuiLink,{href:docsUrl,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.learnMoreLinkText",defaultMessage:"Learn more"}))}})},_react.default.createElement(_eui.EuiFormRow,null,_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CustomUrlsSelection",{enumerable:true,get:function get(){return _custom_urls_selection.CustomUrlsSelection}});var _custom_urls_selection=__webpack_require__(1384)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CustomUrlsSelection=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _custom_urls=__webpack_require__(416);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1385);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CustomUrlsSelection=function CustomUrlsSelection(){var _jobCreator$customUrl;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate;var setCustomUrls=function setCustomUrls(customUrls){jobCreator.customUrls=customUrls;jobCreatorUpdate()};var combinedJob=_objectSpread({},jobCreator.jobConfig,{datafeed_config:jobCreator.datafeedConfig});return _react.default.createElement(_description.Description,null,_react.default.createElement(_custom_urls.CustomUrls,{job:combinedJob,jobCustomUrls:(_jobCreator$customUrl=jobCreator.customUrls)!==null&&_jobCreator$customUrl!==void 0?_jobCreator$customUrl:[],setCustomUrls:setCustomUrls,editMode:"modal"}))};exports.CustomUrlsSelection=CustomUrlsSelection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _kibana=__webpack_require__(57);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children;var _useMlKibana=(0,_kibana.useMlKibana)(),docLinks=_useMlKibana.services.docLinks;var ELASTIC_WEBSITE_URL=docLinks.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=docLinks.DOC_LINK_VERSION;var docsUrl="".concat(ELASTIC_WEBSITE_URL,"guide/en/machine-learning/").concat(DOC_LINK_VERSION,"/ml-configuring-url.html");var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrls.title",{defaultMessage:"Custom URLs"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{fullWidth:true,className:"ml-custom-urls-selection",title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrlsSelection.description",defaultMessage:"Provide links from anomalies to Kibana dashboards, the Discovery page, or other web pages. {learnMoreLink}",values:{learnMoreLink:_react.default.createElement(_eui.EuiLink,{href:docsUrl,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrlsSelection.learnMoreLinkText",defaultMessage:"Learn more"}))}})},_react.default.createElement(_eui.EuiFormRow,{fullWidth:true},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ValidationStep",{enumerable:true,get:function get(){return _validation.ValidationStep}});var _validation=__webpack_require__(1387)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ValidationStep=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _wizard_nav=__webpack_require__(140);var _step_types=__webpack_require__(104);var _job_creator_context=__webpack_require__(53);var _job_service=__webpack_require__(58);var _validate_job=__webpack_require__(1388);var _new_job=__webpack_require__(60);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var idFilterList=["job_id_valid","job_group_id_valid","detectors_function_not_empty","success_bucket_span"];var ValidationStep=function ValidationStep(_ref){var setCurrentStep=_ref.setCurrentStep,isCurrentStep=_ref.isCurrentStep;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobValidator=_useContext.jobValidator;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),nextActive=_useState2[0],setNextActive=_useState2[1];if(jobCreator.type===_new_job.JOB_TYPE.ADVANCED){idFilterList.push.apply(idFilterList,["time_range_short","success_time_range"])}function getJobConfig(){return _objectSpread({},jobCreator.jobConfig,{datafeed_config:jobCreator.datafeedConfig})}function getDuration(){return{start:jobCreator.start,end:jobCreator.end}}(0,_react.useEffect)((function(){jobValidator.validate((function(){}),true);jobCreatorUpdate()}),[]);function setIsValid(valid){jobValidator.advancedValid=valid;setNextActive(valid)}return _react.default.createElement(_react.Fragment,null,isCurrentStep&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_validate_job.ValidateJob,{getJobConfig:getJobConfig,getDuration:getDuration,mlJobService:_job_service.mlJobService,embedded:true,setIsValid:setIsValid,idFilterList:idFilterList}),_react.default.createElement(_wizard_nav.WizardNav,{previous:function previous(){return setCurrentStep(_step_types.WIZARD_STEPS.JOB_DETAILS)},next:function next(){return setCurrentStep(_step_types.WIZARD_STEPS.SUMMARY)},nextActive:nextActive})),isCurrentStep===false&&_react.default.createElement(_react.Fragment,null))};exports.ValidationStep=ValidationStep},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ValidateJob",{enumerable:true,get:function get(){return _validate_job_view.ValidateJob}});var _validate_job_view=__webpack_require__(1389)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ValidateJob=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _i18n=__webpack_require__(1);var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _dependency_cache=__webpack_require__(5);var _validation=__webpack_require__(107);var _validation_utils=__webpack_require__(164);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var defaultIconType="questionInCircle";var getDefaultState=function getDefaultState(){return{ui:{iconType:defaultIconType,isLoading:true,isModalVisible:false},data:{messages:[],success:false},title:""}};var statusToEuiColor=function statusToEuiColor(status){switch(status){case _validation.VALIDATION_STATUS.INFO:return"primary";break;case _validation.VALIDATION_STATUS.ERROR:return"danger";break;default:return status}};var statusToEuiIconType=function statusToEuiIconType(status){switch(status){case _validation.VALIDATION_STATUS.INFO:return"iInCircle";break;case _validation.VALIDATION_STATUS.ERROR:return"cross";break;case _validation.VALIDATION_STATUS.SUCCESS:return"check";break;case _validation.VALIDATION_STATUS.WARNING:return"alert";break;default:return status}};var Link=function Link(_ref){var url=_ref.url;return _react.default.createElement(_eui.EuiLink,{href:url,target:"_BLANK"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.learnMoreLinkText",defaultMessage:"Learn more"}))};Link.propTypes={url:_propTypes.default.string.isRequired};var Message=function Message(_ref2){var message=_ref2.message;return _react.default.createElement(_react.default.Fragment,null,message.text," ",message.url&&_react.default.createElement(Link,{url:message.url}))};Message.propTypes={message:_propTypes.default.shape({text:_propTypes.default.string,url:_propTypes.default.string})};var MessageList=function MessageList(_ref3){var messages=_ref3.messages,idFilterList=_ref3.idFilterList;var callouts=messages.filter((function(m){return idFilterList.includes(m.id)===false})).map((function(m,i){return _react.default.createElement(Callout,{key:"".concat(m.id,"_").concat(i),message:m})}));var allPassedCallout=_react.default.createElement(Callout,{message:{text:_i18n.i18n.translate("xpack.ml.validateJob.allPassed",{defaultMessage:"All validation checks passed successfully"}),status:_validation.VALIDATION_STATUS.SUCCESS}});return _react.default.createElement(_react.default.Fragment,null,callouts.length?callouts:allPassedCallout)};MessageList.propTypes={messages:_propTypes.default.array,idFilterList:_propTypes.default.array};var Callout=function Callout(_ref4){var message=_ref4.message;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiCallOut,{color:statusToEuiColor(message.status),size:"s",title:message.heading||_react.default.createElement(Message,{message:message}),iconType:statusToEuiIconType(message.status)},message.heading&&_react.default.createElement(Message,{message:message})),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))};Callout.propTypes={message:_propTypes.default.shape({status:_propTypes.default.string,text:_propTypes.default.string,url:_propTypes.default.string})};var LoadingSpinner=function LoadingSpinner(){return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiLoadingSpinner,{size:"xl"})))};var Modal=function Modal(_ref5){var close=_ref5.close,title=_ref5.title,children=_ref5.children;return _react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiModal,{onClose:close,style:{width:"800px"}},_react.default.createElement(_eui.EuiModalHeader,null,_react.default.createElement(_eui.EuiModalHeaderTitle,null,title)),_react.default.createElement(_eui.EuiModalBody,null,children),_react.default.createElement(_eui.EuiModalFooter,null,_react.default.createElement(_eui.EuiButton,{onClick:close,size:"s",fill:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.modal.closeButtonLabel",defaultMessage:"Close"})))))};Modal.propType={close:_propTypes.default.func.isRequired,title:_propTypes.default.string};var ValidateJob=function(_Component){_inherits(ValidateJob,_Component);function ValidateJob(props){var _this;_classCallCheck(this,ValidateJob);_this=_possibleConstructorReturn(this,_getPrototypeOf(ValidateJob).call(this,props));_defineProperty(_assertThisInitialized(_this),"closeModal",(function(){var newState=getDefaultState();newState.ui.iconType=_this.state.ui.iconType;_this.setState(newState)}));_defineProperty(_assertThisInitialized(_this),"validate",(function(){var job=_this.props.getJobConfig();var getDuration=_this.props.getDuration;var duration=typeof getDuration==="function"?getDuration():undefined;var fields=_this.props.fields;if(_typeof(job)==="object"){var shouldShowLoadingIndicator=true;_this.props.mlJobService.validateJob({duration:duration,fields:fields,job:job}).then((function(data){shouldShowLoadingIndicator=false;_this.setState(_objectSpread({},_this.state,{ui:_objectSpread({},_this.state.ui,{iconType:statusToEuiIconType((0,_validation_utils.getMostSevereMessageStatus)(data.messages)),isLoading:false,isModalVisible:true}),data:data,title:job.job_id}));if(typeof _this.props.setIsValid==="function"){_this.props.setIsValid(data.messages.some((function(m){return m.status===_validation.VALIDATION_STATUS.ERROR}))===false)}}));var delay=250;setTimeout((function(){if(shouldShowLoadingIndicator){_this.setState(_objectSpread({},_this.state,{ui:_objectSpread({},_this.state.ui,{isLoading:true,isModalVisible:false})}))}}),delay)}}));_this.state=getDefaultState();return _this}_createClass(ValidateJob,[{key:"componentDidMount",value:function componentDidMount(){if(this.props.embedded===true){this.validate()}}},{key:"render",value:function render(){var _getDocLinks=(0,_dependency_cache.getDocLinks)(),ELASTIC_WEBSITE_URL=_getDocLinks.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=_getDocLinks.DOC_LINK_VERSION;var jobTipsUrl="".concat(ELASTIC_WEBSITE_URL,"guide/en/machine-learning/").concat(DOC_LINK_VERSION,"/create-jobs.html#job-tips");var fill=this.props.fill===false?false:true;var isCurrentJobConfig=this.props.isCurrentJobConfig!==true?false:true;var isDisabled=this.props.isDisabled!==true?false:true;var embedded=this.props.embedded===true;var idFilterList=this.props.idFilterList||[];var isLoading=this.state.ui.isLoading;return _react.default.createElement(_react.Fragment,null,embedded===false?_react.default.createElement("div",null,_react.default.createElement(_eui.EuiButton,{onClick:this.validate,size:"s",fill:fill,iconType:isCurrentJobConfig?this.state.ui.iconType:defaultIconType,iconSide:"right",isDisabled:isDisabled,isLoading:isLoading},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.validateJobButtonLabel",defaultMessage:"Validate Job"})),!isDisabled&&this.state.ui.isModalVisible&&_react.default.createElement(Modal,{close:this.closeModal,title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.modal.validateJobTitle",defaultMessage:"Validate job {title}",values:{title:this.state.title}})},isLoading?_react.default.createElement(LoadingSpinner,null):_react.default.createElement(MessageList,{messages:this.state.data.messages,idFilterList:idFilterList}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.modal.jobValidationDescriptionText",defaultMessage:"Job validation performs certain checks against job configurations and underlying source data and provides specific advice on how to adjust settings that are more likely to produce insightful results."})),_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.modal.linkToJobTipsText",defaultMessage:"For more information, see {mlJobTipsLink}.",values:{mlJobTipsLink:_react.default.createElement(_eui.EuiLink,{href:jobTipsUrl,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.validateJob.modal.linkToJobTipsText.mlJobTipsLinkText",defaultMessage:"Machine Learning Job Tips"}))}})))):_react.default.createElement(_react.Fragment,null,isLoading?_react.default.createElement(LoadingSpinner,null):_react.default.createElement(MessageList,{messages:this.state.data.messages,idFilterList:idFilterList})))}}]);return ValidateJob}(_react.Component);exports.ValidateJob=ValidateJob;ValidateJob.propTypes={fields:_propTypes.default.object,fill:_propTypes.default.bool,getDuration:_propTypes.default.func,getJobConfig:_propTypes.default.func.isRequired,isCurrentJobConfig:_propTypes.default.bool,isDisabled:_propTypes.default.bool,mlJobService:_propTypes.default.object.isRequired,embedded:_propTypes.default.bool,setIsValid:_propTypes.default.func,idFilterList:_propTypes.default.array}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"SummaryStep",{enumerable:true,get:function get(){return _summary.SummaryStep}});var _summary=__webpack_require__(1391)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SummaryStep=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _kibana=__webpack_require__(57);var _wizard_nav=__webpack_require__(140);var _step_types=__webpack_require__(104);var _job_creator_context=__webpack_require__(53);var _job_service=__webpack_require__(58);var _json_editor_flyout=__webpack_require__(257);var _datafeed_preview_flyout=__webpack_require__(258);var _new_job=__webpack_require__(60);var _errors=__webpack_require__(152);var _job_creator=__webpack_require__(89);var _job_details=__webpack_require__(1392);var _datafeed_details=__webpack_require__(1394);var _detector_chart=__webpack_require__(1396);var _job_progress=__webpack_require__(1398);var _post_save_options=__webpack_require__(1400);var _general=__webpack_require__(85);var _common=__webpack_require__(260);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var SummaryStep=function SummaryStep(_ref){var setCurrentStep=_ref.setCurrentStep,isCurrentStep=_ref.isCurrentStep;var _useMlKibana=(0,_kibana.useMlKibana)(),notifications=_useMlKibana.services.notifications;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated,resultsLoader=_useContext.resultsLoader;var _useState=(0,_react.useState)(resultsLoader.progress),_useState2=_slicedToArray(_useState,2),progress=_useState2[0],setProgress=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),creatingJob=_useState4[0],setCreatingJob=_useState4[1];var _useState5=(0,_react.useState)(jobValidator.validationSummary.basic),_useState6=_slicedToArray(_useState5,2),isValid=_useState6[0],setIsValid=_useState6[1];var _useState7=(0,_react.useState)(null),_useState8=_slicedToArray(_useState7,2),jobRunner=_useState8[0],setJobRunner=_useState8[1];var isAdvanced=(0,_job_creator.isAdvancedJobCreator)(jobCreator);(0,_react.useEffect)((function(){jobCreator.subscribeToProgress(setProgress)}),[]);function start(){return _start.apply(this,arguments)}function _start(){_start=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(jobCreator.type===_new_job.JOB_TYPE.ADVANCED)){_context.next=5;break}_context.next=3;return startAdvanced();case 3:_context.next=7;break;case 5:_context.next=7;return startInline();case 7:case"end":return _context.stop()}}}),_callee)})));return _start.apply(this,arguments)}function startInline(){return _startInline.apply(this,arguments)}function _startInline(){_startInline=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var jr,toasts;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setCreatingJob(true);_context2.prev=1;_context2.next=4;return jobCreator.createAndStartJob();case 4:jr=_context2.sent;setJobRunner(jr);_context2.next=13;break;case 8:_context2.prev=8;_context2.t0=_context2["catch"](1);toasts=notifications.toasts;toasts.addDanger({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.createJobError",{defaultMessage:"Job creation error"}),text:(0,_errors.getErrorMessage)(_context2.t0)});setCreatingJob(false);case 13:case"end":return _context2.stop()}}}),_callee2,null,[[1,8]])})));return _startInline.apply(this,arguments)}function startAdvanced(){return _startAdvanced.apply(this,arguments)}function _startAdvanced(){_startAdvanced=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var toasts;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setCreatingJob(true);_context3.prev=1;_context3.next=4;return jobCreator.createJob();case 4:_context3.next=6;return jobCreator.createDatafeed();case 6:(0,_general.advancedStartDatafeed)(jobCreator);_context3.next=14;break;case 9:_context3.prev=9;_context3.t0=_context3["catch"](1);toasts=notifications.toasts;toasts.addDanger({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.createJobError",{defaultMessage:"Job creation error"}),text:(0,_errors.getErrorMessage)(_context3.t0)});setCreatingJob(false);case 14:case"end":return _context3.stop()}}}),_callee3,null,[[1,9]])})));return _startAdvanced.apply(this,arguments)}function viewResults(){var url=_job_service.mlJobService.createResultsUrl([jobCreator.jobId],jobCreator.start,jobCreator.end,(0,_job_creator.isSingleMetricJobCreator)(jobCreator)===true?"timeseriesexplorer":"explorer");window.open(url,"_blank")}function clickResetJob(){(0,_general.resetJob)(jobCreator)}var convertToAdvanced=function convertToAdvanced(){(0,_general.convertToAdvancedJob)(jobCreator)};(0,_react.useEffect)((function(){setIsValid(jobValidator.validationSummary.basic)}),[jobValidatorUpdated]);return _react.default.createElement(_react.Fragment,null,isCurrentStep&&_react.default.createElement(_react.Fragment,null,isAdvanced&&_react.default.createElement(_common.JobSectionTitle,null),_react.default.createElement(_detector_chart.DetectorChart,null),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_job_progress.JobProgress,{progress:progress}),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_job_details.JobDetails,null),isAdvanced&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiHorizontalRule,null),_react.default.createElement(_common.DatafeedSectionTitle,null),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_datafeed_details.DatafeedDetails,null)),_react.default.createElement(_eui.EuiHorizontalRule,null),_react.default.createElement(_eui.EuiFlexGroup,null,progress<100&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_wizard_nav.PreviousButton,{previous:function previous(){return setCurrentStep(_step_types.WIZARD_STEPS.VALIDATION)},previousActive:creatingJob===false&&isValid===true})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:start,isDisabled:creatingJob===true||isValid===false,"data-test-subj":"mlJobWizardButtonCreateJob",fill:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.createJobButton",defaultMessage:"Create job"})))),creatingJob===false&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_json_editor_flyout.JsonEditorFlyout,{isDisabled:progress>0,jobEditorMode:_json_editor_flyout.EDITOR_MODE.READONLY,datafeedEditorMode:_json_editor_flyout.EDITOR_MODE.READONLY})),jobCreator.type===_new_job.JOB_TYPE.ADVANCED?_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_datafeed_preview_flyout.DatafeedPreviewFlyout,{isDisabled:false})):_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{onClick:convertToAdvanced},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.convertToAdvancedButton",defaultMessage:"Convert to advanced job"})))),progress>0&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:viewResults,"data-test-subj":"mlJobWizardButtonViewResults"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.viewResultsButton",defaultMessage:"View results"})))),progress===100&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:clickResetJob,"data-test-subj":"mlJobWizardButtonResetJob"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.resetJobButton",defaultMessage:"Reset job"}))),_react.default.createElement(_post_save_options.PostSaveOptions,{jobRunner:jobRunner})))))};exports.SummaryStep=SummaryStep},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobDetails",{enumerable:true,get:function get(){return _job_details.JobDetails}});var _job_details=__webpack_require__(1393)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobDetails=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _moment=_interopRequireDefault(__webpack_require__(32));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _job_creator=__webpack_require__(89);var _ml_server_info=__webpack_require__(84);var _common=__webpack_require__(260);var _ml=__webpack_require__(77);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var JobDetails=function JobDetails(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;var mlContext=(0,_ml.useMlContext)();var dateFormat=mlContext.kibanaConfig.get("dateFormat");var _getNewJobDefaults=(0,_ml_server_info.getNewJobDefaults)(),anomalyDetectors=_getNewJobDefaults.anomaly_detectors;var isAdvanced=(0,_job_creator.isAdvancedJobCreator)(jobCreator);var modelMemoryLimitDefault=anomalyDetectors.model_memory_limit||"";var modelMemoryLimit=jobCreator.modelMemoryLimit!==null?jobCreator.modelMemoryLimit:_react.default.createElement(_common.Italic,null,"".concat(modelMemoryLimitDefault," (").concat(_common.defaultLabel,")"));var jobDetails=[{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDetails.title",{defaultMessage:"Job ID"}),description:jobCreator.jobId},{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDescription.title",{defaultMessage:"Job description"}),description:jobCreator.description.length>0?jobCreator.description:_react.default.createElement(_common.Italic,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDescription.placeholder",defaultMessage:"No description provided"}))},{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.groups.title",{defaultMessage:"Groups"}),description:jobCreator.groups.length>0?jobCreator.groups.join(", "):_react.default.createElement(_common.Italic,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.groups.placeholder",defaultMessage:"No groups selected"}))}];var detectorDetails=[{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.bucketSpan.title",{defaultMessage:"Bucket span"}),description:jobCreator.bucketSpan}];if((0,_job_creator.isMultiMetricJobCreator)(jobCreator)){detectorDetails.push({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.splitField.title",{defaultMessage:"Split field"}),description:(0,_job_creator.isMultiMetricJobCreator)(jobCreator)&&jobCreator.splitField!==null?jobCreator.splitField.name:_react.default.createElement(_common.Italic,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.splitField.placeholder",defaultMessage:"No split field selected"}))})}if((0,_job_creator.isPopulationJobCreator)(jobCreator)){detectorDetails.push({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.populationField.title",{defaultMessage:"Population field"}),description:(0,_job_creator.isPopulationJobCreator)(jobCreator)&&jobCreator.splitField!==null?jobCreator.splitField.name:_react.default.createElement("span",{style:{fontStyle:jobCreator.splitField!==null?"inherit":"italic"}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.populationField.placeholder",defaultMessage:"No population field selected"}))})}if(isAdvanced&&jobCreator.categorizationFieldName!==null){detectorDetails.push({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.categorizationField.title",{defaultMessage:"Categorization field"}),description:jobCreator.categorizationFieldName})}if(isAdvanced&&jobCreator.summaryCountFieldName!==null){detectorDetails.push({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.summaryCountField.title",{defaultMessage:"Summary count field"}),description:jobCreator.summaryCountFieldName})}detectorDetails.push({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.influencers.title",{defaultMessage:"Influencers"}),description:jobCreator.influencers.length>0?jobCreator.influencers.join(", "):_react.default.createElement(_common.Italic,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.influencers.placeholder",defaultMessage:"No influencers selected"}))});var advancedDetails=[{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.enableModelPlot.title",{defaultMessage:"Enable model plot"}),description:jobCreator.modelPlot?_common.trueLabel:_common.falseLabel},{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"}),description:jobCreator.useDedicatedIndex?_common.trueLabel:_common.falseLabel},{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.modelMemoryLimit.title",{defaultMessage:"Model memory limit"}),description:modelMemoryLimit}];var timeRangeDetails=[{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.timeRange.start.title",{defaultMessage:"Start"}),description:(0,_moment.default)(jobCreator.start).format(dateFormat)},{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.timeRange.end.title",{defaultMessage:"End"}),description:(0,_moment.default)(jobCreator.end).format(dateFormat)}];return _react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiDescriptionList,{compressed:true,listItems:jobDetails})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiDescriptionList,{compressed:true,listItems:detectorDetails})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiDescriptionList,{compressed:true,listItems:advancedDetails})),isAdvanced===false&&_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiDescriptionList,{compressed:true,listItems:timeRangeDetails})))};exports.JobDetails=JobDetails},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DatafeedDetails",{enumerable:true,get:function get(){return _datafeed_details.DatafeedDetails}});var _datafeed_details=__webpack_require__(1395)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DatafeedDetails=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _ml_job_editor=__webpack_require__(103);var _job_utils=__webpack_require__(59);var _new_job=__webpack_require__(60);var _ml_server_info=__webpack_require__(84);var _common=__webpack_require__(260);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var EDITOR_HEIGHT="200px";var DatafeedDetails=function DatafeedDetails(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;var _getNewJobDefaults=(0,_ml_server_info.getNewJobDefaults)(),datafeeds=_getNewJobDefaults.datafeeds;var queryString=JSON.stringify(jobCreator.query,null,2);var defaultFrequency=(0,_job_utils.calculateDatafeedFrequencyDefaultSeconds)(jobCreator.bucketSpanMs/1e3);var scrollSizeDefault=datafeeds.scroll_size||"";var queryDelay=jobCreator.queryDelay||_react.default.createElement(_common.Italic,null,"".concat(_new_job.DEFAULT_QUERY_DELAY," (").concat(_common.defaultLabel,")"));var frequency=jobCreator.frequency||_react.default.createElement(_common.Italic,null,"".concat(defaultFrequency,"s (").concat(_common.defaultLabel,")"));var scrollSize=jobCreator.scrollSize!==null?"".concat(jobCreator.scrollSize):_react.default.createElement(_common.Italic,null,"".concat(scrollSizeDefault," (").concat(_common.defaultLabel,")"));var datafeedDetails=[{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.timeField.title",{defaultMessage:"Time field"}),description:jobCreator.timeFieldName},{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.queryDelay.title",{defaultMessage:"Query delay"}),description:queryDelay},{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.frequency.title",{defaultMessage:"Frequency"}),description:frequency},{title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.scrollSize.title",{defaultMessage:"Scroll size"}),description:scrollSize}];var queryTitle=_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.query.title",{defaultMessage:"Elasticsearch query"});return _react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:queryTitle,fullWidth:true},_react.default.createElement(_ml_job_editor.MLJobEditor,{value:queryString,height:EDITOR_HEIGHT,readOnly:true}))),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiDescriptionList,{compressed:true,listItems:datafeedDetails})))};exports.DatafeedDetails=DatafeedDetails},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DetectorChart",{enumerable:true,get:function get(){return _detector_chart.DetectorChart}});var _detector_chart=__webpack_require__(1397)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DetectorChart=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _job_creator_context=__webpack_require__(53);var _new_job=__webpack_require__(60);var _single_metric_view=__webpack_require__(477);var _multi_metric_view=__webpack_require__(479);var _population_view=__webpack_require__(484);var _advanced_view=__webpack_require__(486);var _categorization_view=__webpack_require__(490);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var DetectorChart=function DetectorChart(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;return _react.default.createElement(_react.Fragment,null,jobCreator.type===_new_job.JOB_TYPE.SINGLE_METRIC&&_react.default.createElement(_single_metric_view.SingleMetricView,{isActive:false}),jobCreator.type===_new_job.JOB_TYPE.MULTI_METRIC&&_react.default.createElement(_multi_metric_view.MultiMetricView,{isActive:false}),jobCreator.type===_new_job.JOB_TYPE.POPULATION&&_react.default.createElement(_population_view.PopulationView,{isActive:false}),jobCreator.type===_new_job.JOB_TYPE.ADVANCED&&_react.default.createElement(_advanced_view.AdvancedView,{isActive:false}),jobCreator.type===_new_job.JOB_TYPE.CATEGORIZATION&&_react.default.createElement(_categorization_view.CategorizationView,{isActive:false}))};exports.DetectorChart=DetectorChart},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobProgress",{enumerable:true,get:function get(){return _job_progress.JobProgress}});var _job_progress=__webpack_require__(1399)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobProgress=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var JobProgress=function JobProgress(_ref){var progress=_ref.progress;if(progress>0&&progress<100){return _react.default.createElement(_eui.EuiProgress,{value:progress,color:"primary",size:"xs",max:100})}else{return null}};exports.JobProgress=JobProgress},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"PostSaveOptions",{enumerable:true,get:function get(){return _post_save_options.PostSaveOptions}});var _post_save_options=__webpack_require__(1401)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PostSaveOptions=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _kibana=__webpack_require__(57);var _errors=__webpack_require__(152);var _index=__webpack_require__(461);var _job_creator_context=__webpack_require__(53);var _states=__webpack_require__(108);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var PostSaveOptions=function PostSaveOptions(_ref){var jobRunner=_ref.jobRunner;var _useMlKibana=(0,_kibana.useMlKibana)(),notifications=_useMlKibana.services.notifications;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;var _useState=(0,_react.useState)(_states.DATAFEED_STATE.STOPPED),_useState2=_slicedToArray(_useState,2),datafeedState=_useState2[0],setDatafeedState=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),watchFlyoutVisible=_useState4[0],setWatchFlyoutVisible=_useState4[1];var _useState5=(0,_react.useState)(false),_useState6=_slicedToArray(_useState5,2),watchCreated=_useState6[0],setWatchCreated=_useState6[1];function setShowCreateWatchFlyoutFunction(showFlyout){showFlyout(jobCreator.jobId)}function flyoutHidden(jobCreated){setWatchFlyoutVisible(false);setWatchCreated(jobCreated)}function unsetShowCreateWatchFlyoutFunction(){setWatchFlyoutVisible(false)}function startJobInRealTime(){return _startJobInRealTime.apply(this,arguments)}function _startJobInRealTime(){_startJobInRealTime=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var toasts,started;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:toasts=notifications.toasts;setDatafeedState(_states.DATAFEED_STATE.STARTING);if(!(jobRunner!==null)){_context.next=15;break}_context.prev=3;_context.next=6;return jobRunner.startDatafeedInRealTime(true);case 6:started=_context.sent;setDatafeedState(started===true?_states.DATAFEED_STATE.STARTED:_states.DATAFEED_STATE.STOPPED);toasts.addSuccess({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTimeSuccess",{defaultMessage:"Job {jobId} started",values:{jobId:jobCreator.jobId}})});_context.next=15;break;case 11:_context.prev=11;_context.t0=_context["catch"](3);setDatafeedState(_states.DATAFEED_STATE.STOPPED);toasts.addDanger({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTimeError",{defaultMessage:"Error starting job"}),text:(0,_errors.getErrorMessage)(_context.t0)});case 15:case"end":return _context.stop()}}}),_callee,null,[[3,11]])})));return _startJobInRealTime.apply(this,arguments)}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{isDisabled:datafeedState===_states.DATAFEED_STATE.STARTING||datafeedState===_states.DATAFEED_STATE.STARTED,onClick:startJobInRealTime,"data-test-subj":"mlJobWizardButtonRunInRealTime"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTime",defaultMessage:"Start job running in real time"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{isDisabled:datafeedState===_states.DATAFEED_STATE.STOPPED||datafeedState===_states.DATAFEED_STATE.STARTING||watchCreated===true,onClick:function onClick(){return setWatchFlyoutVisible(true)},"data-test-subj":"mlJobWizardButtonCreateWatch"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.postSaveOptions.createWatch",defaultMessage:"Create watch"}))),datafeedState===_states.DATAFEED_STATE.STARTED&&watchFlyoutVisible&&_react.default.createElement(_index.CreateWatchFlyout,{setShowFunction:setShowCreateWatchFlyoutFunction,unsetShowFunction:unsetShowCreateWatchFlyoutFunction,flyoutHidden:flyoutHidden}))};exports.PostSaveOptions=PostSaveOptions},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DatafeedStep",{enumerable:true,get:function get(){return _datafeed.DatafeedStep}});var _datafeed=__webpack_require__(1403)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DatafeedStep=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _wizard_nav=__webpack_require__(140);var _query=__webpack_require__(1404);var _query_delay=__webpack_require__(1407);var _frequency=__webpack_require__(1410);var _scroll_size=__webpack_require__(1413);var _time_field=__webpack_require__(1416);var _step_types=__webpack_require__(104);var _job_creator_context=__webpack_require__(53);var _json_editor_flyout=__webpack_require__(257);var _datafeed_preview_flyout=__webpack_require__(258);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var DatafeedStep=function DatafeedStep(_ref){var setCurrentStep=_ref.setCurrentStep,isCurrentStep=_ref.isCurrentStep;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),nextActive=_useState2[0],setNextActive=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),isValidQuery=_useState4[0],setIsValidQuery=_useState4[1];(0,_react.useEffect)((function(){var active=isValidQuery&&jobValidator.queryDelay.valid&&jobValidator.frequency.valid&&jobValidator.scrollSize.valid&&jobValidator.validating===false;setNextActive(active)}),[jobValidatorUpdated,isValidQuery]);return _react.default.createElement(_react.Fragment,null,isCurrentStep&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,{"data-test-subj":"mlAdvancedDatafeedQueryEditor"},_react.default.createElement(_query.QueryInput,{setIsValidQuery:setIsValidQuery})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_query_delay.QueryDelayInput,null),_react.default.createElement(_frequency.FrequencyInput,null),_react.default.createElement(_scroll_size.ScrollSizeInput,null),_react.default.createElement(_time_field.TimeField,null))),_react.default.createElement(_wizard_nav.WizardNav,{next:function next(){return setCurrentStep(_step_types.WIZARD_STEPS.PICK_FIELDS)},nextActive:nextActive},_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_json_editor_flyout.JsonEditorFlyout,{isDisabled:false,jobEditorMode:_json_editor_flyout.EDITOR_MODE.HIDDEN,datafeedEditorMode:_json_editor_flyout.EDITOR_MODE.EDITABLE})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_datafeed_preview_flyout.DatafeedPreviewFlyout,{isDisabled:false}))))))};exports.DatafeedStep=DatafeedStep},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"QueryInput",{enumerable:true,get:function get(){return _query_input.QueryInput}});var _query_input=__webpack_require__(1405)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.QueryInput=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _job_creator_context=__webpack_require__(53);var _ml_job_editor=__webpack_require__(103);var _description=__webpack_require__(1406);var _validation_utils=__webpack_require__(164);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var EDITOR_HEIGHT="400px";var QueryInput=function QueryInput(_ref){var setIsValidQuery=_ref.setIsValidQuery;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var jobCreator=jc;var _useState=(0,_react.useState)(JSON.stringify(jobCreator.query,null,2)),_useState2=_slicedToArray(_useState,2),queryString=_useState2[0],setQueryString=_useState2[1];(0,_react.useEffect)((function(){var validJson=(0,_validation_utils.isValidJson)(queryString);setIsValidQuery(validJson);if(validJson){jobCreator.query=JSON.parse(queryString);jobCreatorUpdate()}}),[queryString]);(0,_react.useEffect)((function(){if((0,_validation_utils.isValidJson)(queryString)){var query=JSON.parse(queryString);var newQueryString=JSON.stringify(query,null,2);var actualQuery=JSON.stringify(jobCreator.query,null,2);if(newQueryString!==actualQuery){setQueryString(actualQuery)}}}),[jobCreatorUpdated]);(0,_react.useEffect)((function(){var validJson=(0,_validation_utils.isValidJson)(queryString);setIsValidQuery(validJson)}),[]);function onChange(qs){setQueryString(qs)}return _react.default.createElement(_description.Description,null,_react.default.createElement(_ml_job_editor.MLJobEditor,{value:queryString,height:EDITOR_HEIGHT,readOnly:false,onChange:onChange}))};exports.QueryInput=QueryInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.query.title",{defaultMessage:"Elasticsearch query"});return _react.default.createElement(_eui.EuiFormRow,{label:title,describedByIds:["description"],fullWidth:true},_react.default.createElement(_react.default.Fragment,null,children))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"QueryDelayInput",{enumerable:true,get:function get(){return _query_delay_input.QueryDelayInput}});var _query_delay_input=__webpack_require__(1408)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.QueryDelayInput=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1409);var _hooks=__webpack_require__(491);var _new_job=__webpack_require__(60);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var QueryDelayInput=function QueryDelayInput(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(jobValidator.queryDelay),_useState2=_slicedToArray(_useState,2),validation=_useState2[0],setValidation=_useState2[1];var _useStringifiedValue=(0,_hooks.useStringifiedValue)(jobCreator.queryDelay),queryDelay=_useStringifiedValue.value,setQueryDelay=_useStringifiedValue.setValue;(0,_react.useEffect)((function(){jobCreator.queryDelay=queryDelay===""?null:queryDelay;jobCreatorUpdate()}),[queryDelay]);(0,_react.useEffect)((function(){setQueryDelay(jobCreator.queryDelay===null?"":jobCreator.queryDelay)}),[jobCreatorUpdate]);(0,_react.useEffect)((function(){setValidation(jobValidator.queryDelay)}),[jobValidatorUpdated]);return _react.default.createElement(_description.Description,{validation:validation},_react.default.createElement(_eui.EuiFieldText,{value:queryDelay,placeholder:_new_job.DEFAULT_QUERY_DELAY,onChange:function onChange(e){return setQueryDelay(e.target.value)},isInvalid:validation.valid===false,"data-test-subj":"mlJobWizardInputQueryDelay"}))};exports.QueryDelayInput=QueryDelayInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children,validation=_ref.validation;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.queryDelay.title",{defaultMessage:"Query delay"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.queryDelay.description",defaultMessage:"Time delay in seconds, between current time and latest input data time."})},_react.default.createElement(_eui.EuiFormRow,{label:title,error:validation.message,isInvalid:validation.valid===false},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FrequencyInput",{enumerable:true,get:function get(){return _frequency_input.FrequencyInput}});var _frequency_input=__webpack_require__(1411)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FrequencyInput=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1412);var _job_utils=__webpack_require__(59);var _hooks=__webpack_require__(491);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var FrequencyInput=function FrequencyInput(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(jobValidator.frequency),_useState2=_slicedToArray(_useState,2),validation=_useState2[0],setValidation=_useState2[1];var _useStringifiedValue=(0,_hooks.useStringifiedValue)(jobCreator.frequency),frequency=_useStringifiedValue.value,setFrequency=_useStringifiedValue.setValue;var _useState3=(0,_react.useState)(createDefaultFrequency()),_useState4=_slicedToArray(_useState3,2),defaultFrequency=_useState4[0],setDefaultFrequency=_useState4[1];(0,_react.useEffect)((function(){jobCreator.frequency=frequency===""?null:frequency;jobCreatorUpdate()}),[frequency]);(0,_react.useEffect)((function(){setFrequency(jobCreator.frequency);var df=createDefaultFrequency();setDefaultFrequency(df)}),[jobCreatorUpdated]);(0,_react.useEffect)((function(){setValidation(jobValidator.frequency)}),[jobValidatorUpdated]);function createDefaultFrequency(){var df=(0,_job_utils.calculateDatafeedFrequencyDefaultSeconds)(jobCreator.bucketSpanMs/1e3);return"".concat(df,"s")}return _react.default.createElement(_description.Description,{validation:validation},_react.default.createElement(_eui.EuiFieldText,{value:frequency,placeholder:defaultFrequency,onChange:function onChange(e){return setFrequency(e.target.value)},isInvalid:validation.valid===false,"data-test-subj":"mlJobWizardInputFrequency"}))};exports.FrequencyInput=FrequencyInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children,validation=_ref.validation;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.frequency.title",{defaultMessage:"Frequency"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.frequency.description",defaultMessage:"The interval between searches."})},_react.default.createElement(_eui.EuiFormRow,{label:title,error:validation.message,isInvalid:validation.valid===false},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ScrollSizeInput",{enumerable:true,get:function get(){return _scroll_size_input.ScrollSizeInput}});var _scroll_size_input=__webpack_require__(1414)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ScrollSizeInput=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _ml_server_info=__webpack_require__(84);var _job_creator_context=__webpack_require__(53);var _description=__webpack_require__(1415);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ScrollSizeInput=function ScrollSizeInput(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobValidator=_useContext.jobValidator,jobValidatorUpdated=_useContext.jobValidatorUpdated;var _useState=(0,_react.useState)(jobValidator.scrollSize),_useState2=_slicedToArray(_useState,2),validation=_useState2[0],setValidation=_useState2[1];var _useState3=(0,_react.useState)(jobCreator.scrollSize===null?"":"".concat(jobCreator.scrollSize)),_useState4=_slicedToArray(_useState3,2),scrollSizeString=_useState4[0],setScrollSize=_useState4[1];var _getNewJobDefaults=(0,_ml_server_info.getNewJobDefaults)(),datafeeds=_getNewJobDefaults.datafeeds;var scrollSizeDefault=datafeeds.scroll_size!==undefined?"".concat(datafeeds.scroll_size):"";(0,_react.useEffect)((function(){jobCreator.scrollSize=scrollSizeString===""?null:+scrollSizeString;jobCreatorUpdate()}),[scrollSizeString]);(0,_react.useEffect)((function(){setScrollSize(jobCreator.scrollSize===null?"":"".concat(jobCreator.scrollSize))}),[jobCreatorUpdate]);(0,_react.useEffect)((function(){setValidation(jobValidator.scrollSize)}),[jobValidatorUpdated]);return _react.default.createElement(_description.Description,{validation:validation},_react.default.createElement(_eui.EuiFieldNumber,{min:0,placeholder:scrollSizeDefault,value:scrollSizeString===""?scrollSizeString:+scrollSizeString,onChange:function onChange(e){return setScrollSize(e.target.value)},isInvalid:validation.valid===false,"data-test-subj":"mlJobWizardInputScrollSize"}))};exports.ScrollSizeInput=ScrollSizeInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children,validation=_ref.validation;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.scrollSize.title",{defaultMessage:"Scroll size"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.scrollSize.description",defaultMessage:"The maximum number of documents requested for a search."})},_react.default.createElement(_eui.EuiFormRow,{label:title,error:validation.message,isInvalid:validation.valid===false},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"TimeField",{enumerable:true,get:function get(){return _time_field.TimeField}});var _time_field=__webpack_require__(1417)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeField=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _time_field_select=__webpack_require__(1418);var _job_creator_context=__webpack_require__(53);var _new_job_capabilities_service=__webpack_require__(66);var _description=__webpack_require__(1419);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var TimeField=function TimeField(){var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jc=_useContext.jobCreator,jobCreatorUpdate=_useContext.jobCreatorUpdate,jobCreatorUpdated=_useContext.jobCreatorUpdated;var jobCreator=jc;var dateFields=_new_job_capabilities_service.newJobCapsService.dateFields;var _useState=(0,_react.useState)(jobCreator.timeFieldName),_useState2=_slicedToArray(_useState,2),timeFieldName=_useState2[0],setTimeFieldName=_useState2[1];(0,_react.useEffect)((function(){jobCreator.timeFieldName=timeFieldName;jobCreatorUpdate()}),[timeFieldName]);(0,_react.useEffect)((function(){setTimeFieldName(jobCreator.timeFieldName)}),[jobCreatorUpdated]);return _react.default.createElement(_description.Description,null,_react.default.createElement(_time_field_select.TimeFieldSelect,{fields:dateFields,changeHandler:setTimeFieldName,selectedField:timeFieldName}))};exports.TimeField=TimeField},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeFieldSelect=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _job_creator_context=__webpack_require__(53);var _general=__webpack_require__(85);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var TimeFieldSelect=function TimeFieldSelect(_ref){var fields=_ref.fields,changeHandler=_ref.changeHandler,selectedField=_ref.selectedField;var _useContext=(0,_react.useContext)(_job_creator_context.JobCreatorContext),jobCreator=_useContext.jobCreator;var options=(0,_general.createFieldOptions)(fields,jobCreator.additionalFields);var selection=[];if(selectedField!==null){selection.push({label:selectedField})}function onChange(selectedOptions){var option=selectedOptions[0];if(typeof option!=="undefined"){changeHandler(option.label)}}return _react.default.createElement(_eui.EuiComboBox,{singleSelection:{asPlainText:true},options:options,selectedOptions:selection,onChange:onChange,isClearable:false,"data-test-subj":"mlTimeFieldNameSelect"})};exports.TimeFieldSelect=TimeFieldSelect},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Description=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Description=(0,_react.memo)((function(_ref){var children=_ref.children;var title=_i18n.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.timeField.title",{defaultMessage:"Time field"});return _react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h3",null,title),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.timeField.description",defaultMessage:"The default time field for the index pattern is automatically selected, but can be overridden."})},_react.default.createElement(_eui.EuiFormRow,{label:title},_react.default.createElement(_react.default.Fragment,null,children)))}));exports.Description=Description},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WizardHorizontalSteps=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _step_types=__webpack_require__(104);var _new_job=__webpack_require__(60);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var WizardHorizontalSteps=function WizardHorizontalSteps(_ref){var currentStep=_ref.currentStep,highestStep=_ref.highestStep,setCurrentStep=_ref.setCurrentStep,disableSteps=_ref.disableSteps,jobType=_ref.jobType;function jumpToStep(step){if(step<=highestStep){setCurrentStep(step)}}var stepsConfig=[_objectSpread({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.step.timeRangeTitle",{defaultMessage:"Time range"})},createStepProps(_step_types.WIZARD_STEPS.TIME_RANGE)),_objectSpread({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.step.pickFieldsTitle",{defaultMessage:"Pick fields"})},createStepProps(_step_types.WIZARD_STEPS.PICK_FIELDS)),_objectSpread({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.step.jobDetailsTitle",{defaultMessage:"Job details"})},createStepProps(_step_types.WIZARD_STEPS.JOB_DETAILS)),_objectSpread({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.step.validationTitle",{defaultMessage:"Validation"})},createStepProps(_step_types.WIZARD_STEPS.VALIDATION)),_objectSpread({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.step.summaryTitle",{defaultMessage:"Summary"})},createStepProps(_step_types.WIZARD_STEPS.SUMMARY))];if(jobType===_new_job.JOB_TYPE.ADVANCED){stepsConfig.splice(0,1,_objectSpread({title:_i18n.i18n.translate("xpack.ml.newJob.wizard.step.configureDatafeedTitle",{defaultMessage:"Configure datafeed"})},createStepProps(_step_types.WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED)))}function createStepProps(step){return{onClick:function onClick(){return jumpToStep(step)},isSelected:currentStep===step,isComplete:currentStep>step,disabled:disableSteps||highestStep<step}}return _react.default.createElement(_eui.EuiStepsHorizontal,{steps:stepsConfig,style:{backgroundColor:"inherit"}})};exports.WizardHorizontalSteps=WizardHorizontalSteps},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ChartLoader",{enumerable:true,get:function get(){return _chart_loader.ChartLoader}});Object.defineProperty(exports,"LineChartData",{enumerable:true,get:function get(){return _chart_loader.LineChartData}});Object.defineProperty(exports,"LineChartPoint",{enumerable:true,get:function get(){return _chart_loader.LineChartPoint}});var _chart_loader=__webpack_require__(1422)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getAggFieldPairNames=getAggFieldPairNames;exports.ChartLoader=void 0;var _memoizeOne=_interopRequireDefault(__webpack_require__(492));var _lodash=__webpack_require__(49);var _ml_api_service=__webpack_require__(51);var _results_service=__webpack_require__(132);var _searches=__webpack_require__(1423);var _general=__webpack_require__(85);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var eq=function eq(newArgs,lastArgs){return(0,_lodash.isEqual)(newArgs,lastArgs)};var newJobLineChart=(0,_memoizeOne.default)(_ml_api_service.ml.jobs.newJobLineChart,eq);var newJobPopulationsChart=(0,_memoizeOne.default)(_ml_api_service.ml.jobs.newJobPopulationsChart,eq);var getEventRateData=(0,_memoizeOne.default)(_results_service.mlResultsService.getEventRateData,eq);var getCategoryFields=(0,_memoizeOne.default)(_searches.getCategoryFields,eq);var ChartLoader=function(){function ChartLoader(indexPattern,query){_classCallCheck(this,ChartLoader);_defineProperty(this,"_indexPatternTitle","");_defineProperty(this,"_timeFieldName","");_defineProperty(this,"_query",{});this._indexPatternTitle=indexPattern.title;this._query=query;if(typeof indexPattern.timeFieldName==="string"){this._timeFieldName=indexPattern.timeFieldName}}_createClass(ChartLoader,[{key:"loadLineCharts",value:function(){var _loadLineCharts=_asyncToGenerator(regeneratorRuntime.mark((function _callee(start,end,aggFieldPairs,splitField,splitFieldValue,intervalMs){var splitFieldName,aggFieldPairNames,resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(this._timeFieldName!=="")){_context.next=11;break}if(!((0,_general.aggFieldPairsCanBeCharted)(aggFieldPairs)===false)){_context.next=3;break}return _context.abrupt("return",{});case 3:splitFieldName=splitField!==null?splitField.name:null;aggFieldPairNames=aggFieldPairs.map(getAggFieldPairNames);_context.next=7;return newJobLineChart(this._indexPatternTitle,this._timeFieldName,start,end,intervalMs,this._query,aggFieldPairNames,splitFieldName,splitFieldValue);case 7:resp=_context.sent;if(!(resp.error!==undefined)){_context.next=10;break}throw resp.error;case 10:return _context.abrupt("return",resp.results);case 11:return _context.abrupt("return",{});case 12:case"end":return _context.stop()}}}),_callee,this)})));function loadLineCharts(_x,_x2,_x3,_x4,_x5,_x6){return _loadLineCharts.apply(this,arguments)}return loadLineCharts}()},{key:"loadPopulationCharts",value:function(){var _loadPopulationCharts=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(start,end,aggFieldPairs,splitField,intervalMs){var splitFieldName,aggFieldPairNames,resp;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(this._timeFieldName!=="")){_context2.next=11;break}if(!((0,_general.aggFieldPairsCanBeCharted)(aggFieldPairs)===false)){_context2.next=3;break}return _context2.abrupt("return",{});case 3:splitFieldName=splitField!==null?splitField.name:"";aggFieldPairNames=aggFieldPairs.map(getAggFieldPairNames);_context2.next=7;return newJobPopulationsChart(this._indexPatternTitle,this._timeFieldName,start,end,intervalMs,this._query,aggFieldPairNames,splitFieldName);case 7:resp=_context2.sent;if(!(resp.error!==undefined)){_context2.next=10;break}throw resp.error;case 10:return _context2.abrupt("return",resp.results);case 11:return _context2.abrupt("return",{});case 12:case"end":return _context2.stop()}}}),_callee2,this)})));function loadPopulationCharts(_x7,_x8,_x9,_x10,_x11){return _loadPopulationCharts.apply(this,arguments)}return loadPopulationCharts}()},{key:"loadEventRateChart",value:function(){var _loadEventRateChart=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(start,end,intervalMs){var resp;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(this._timeFieldName!=="")){_context3.next=7;break}_context3.next=3;return getEventRateData(this._indexPatternTitle,this._query,this._timeFieldName,start,end,intervalMs*3);case 3:resp=_context3.sent;if(!(resp.error!==undefined)){_context3.next=6;break}throw resp.error;case 6:return _context3.abrupt("return",Object.entries(resp.results).map((function(_ref){var _ref2=_slicedToArray(_ref,2),time=_ref2[0],value=_ref2[1];return{time:+time,value:value}})));case 7:return _context3.abrupt("return",[]);case 8:case"end":return _context3.stop()}}}),_callee3,this)})));function loadEventRateChart(_x12,_x13,_x14){return _loadEventRateChart.apply(this,arguments)}return loadEventRateChart}()},{key:"loadFieldExampleValues",value:function(){var _loadFieldExampleValues=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(field){var _ref3,results;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return getCategoryFields(this._indexPatternTitle,field.name,10,this._query);case 2:_ref3=_context4.sent;results=_ref3.results;return _context4.abrupt("return",results);case 5:case"end":return _context4.stop()}}}),_callee4,this)})));function loadFieldExampleValues(_x15){return _loadFieldExampleValues.apply(this,arguments)}return loadFieldExampleValues}()}]);return ChartLoader}();exports.ChartLoader=ChartLoader;function getAggFieldPairNames(af){var by=af.by!==undefined&&af.by.field!==null&&af.by.value!==null?{field:af.by.field.id,value:af.by.value}:{field:null,value:null};return{agg:af.agg.dslName||"",field:af.field.id,by:by}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getCategoryFields=getCategoryFields;var _lodash=__webpack_require__(49);var _ml_api_service=__webpack_require__(51);function getCategoryFields(indexPatternName,fieldName,size,query){return new Promise((function(resolve,reject){_ml_api_service.ml.esSearch({index:indexPatternName,size:0,body:{query:query,aggs:{catFields:{terms:{field:fieldName,size:size}}}}}).then((function(resp){var catFields=(0,_lodash.get)(resp,["aggregations","catFields","buckets"],[]);resolve({success:true,results:catFields.map((function(f){return f.key}))})})).catch((function(resp){reject(resp)}))}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobValidator",{enumerable:true,get:function get(){return _job_validator.JobValidator}});Object.defineProperty(exports,"Validation",{enumerable:true,get:function get(){return _job_validator.Validation}});Object.defineProperty(exports,"BasicValidations",{enumerable:true,get:function get(){return _job_validator.BasicValidations}});Object.defineProperty(exports,"ValidationSummary",{enumerable:true,get:function get(){return _job_validator.ValidationSummary}});var _job_validator=__webpack_require__(1425)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobValidator=void 0;var _rxjs=__webpack_require__(33);var _operators=__webpack_require__(6);var _job_utils=__webpack_require__(59);var _ml_server_info=__webpack_require__(84);var _job_creator=__webpack_require__(89);var _util=__webpack_require__(460);var _validators=__webpack_require__(1426);var _categorization_job=__webpack_require__(142);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var VALIDATION_DELAY_MS=500;var JobValidator=function(){function JobValidator(jobCreator,existingJobsAndGroups){var _this=this;_classCallCheck(this,JobValidator);_defineProperty(this,"_jobCreator",void 0);_defineProperty(this,"_validationSummary",void 0);_defineProperty(this,"_lastJobConfig",void 0);_defineProperty(this,"_lastDatafeedConfig",void 0);_defineProperty(this,"_validateTimeout",null);_defineProperty(this,"_asyncValidators$",[]);_defineProperty(this,"_asyncValidatorsResult$",void 0);_defineProperty(this,"_existingJobsAndGroups",void 0);_defineProperty(this,"_basicValidations",{jobId:{valid:true},groupIds:{valid:true},modelMemoryLimit:{valid:true},bucketSpan:{valid:true},duplicateDetectors:{valid:true},query:{valid:true},queryDelay:{valid:true},frequency:{valid:true},scrollSize:{valid:true}});_defineProperty(this,"_advancedValidations",{categorizationFieldValid:{valid:true}});_defineProperty(this,"_validating",false);_defineProperty(this,"_basicValidationResult$",new _rxjs.ReplaySubject(2));_defineProperty(this,"_jobCreatorSubject$",new _rxjs.Subject);_defineProperty(this,"validationResult$",void 0);_defineProperty(this,"latestValidationResult",this._basicValidations);this._jobCreator=jobCreator;this._lastJobConfig=this._jobCreator.formattedJobJson;this._lastDatafeedConfig=this._jobCreator.formattedDatafeedJson;this._validationSummary={basic:false,advanced:false};this._existingJobsAndGroups=existingJobsAndGroups;this._asyncValidators$=[(0,_validators.cardinalityValidator)(this._jobCreatorSubject$)];this._asyncValidatorsResult$=(0,_rxjs.combineLatest)(this._asyncValidators$).pipe((0,_operators.map)((function(res){return res.reduce((function(acc,curr){return _objectSpread({},acc,{},curr?curr:{})}),{})})));this.validationResult$=(0,_rxjs.combineLatest)([this._basicValidationResult$,this._asyncValidatorsResult$]).pipe((0,_operators.map)((function(_ref){var _ref2=_slicedToArray(_ref,2),basicValidationResult=_ref2[0],asyncValidatorsResult=_ref2[1];return _objectSpread({},basicValidationResult,{},asyncValidatorsResult)})),(0,_operators.tap)((function(latestValidationResult){_this.latestValidationResult=latestValidationResult})))}_createClass(JobValidator,[{key:"validate",value:function validate(callback){var _this2=this;var forceValidate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this._validating=true;var formattedJobConfig=this._jobCreator.formattedJobJson;var formattedDatafeedConfig=this._jobCreator.formattedDatafeedJson;if(forceValidate||formattedJobConfig!==this._lastJobConfig||formattedDatafeedConfig!==this._lastDatafeedConfig){if(this._validateTimeout!==null){clearTimeout(this._validateTimeout)}this._lastJobConfig=formattedJobConfig;this._lastDatafeedConfig=formattedDatafeedConfig;this._validateTimeout=setTimeout((function(){_this2._runBasicValidation();_this2._runAdvancedValidation();_this2._jobCreatorSubject$.next(_this2._jobCreator);_this2._validating=false;_this2._validateTimeout=null;callback()}),VALIDATION_DELAY_MS)}else{this._validating=this._validateTimeout!==null}callback()}},{key:"_resetBasicValidations",value:function _resetBasicValidations(){this._validationSummary.basic=true;Object.values(this._basicValidations).forEach((function(v){v.valid=true;delete v.message}))}},{key:"_runBasicValidation",value:function _runBasicValidation(){this._resetBasicValidations();var jobConfig=this._jobCreator.jobConfig;var datafeedConfig=this._jobCreator.datafeedConfig;var limits=(0,_ml_server_info.getNewJobLimits)();var basicJobResults=(0,_job_utils.basicJobValidation)(jobConfig,undefined,limits);(0,_util.populateValidationMessages)(basicJobResults,this._basicValidations,jobConfig,datafeedConfig);var basicDatafeedResults=(0,_job_utils.basicDatafeedValidation)(datafeedConfig);(0,_util.populateValidationMessages)(basicDatafeedResults,this._basicValidations,jobConfig,datafeedConfig);var idResults=(0,_util.checkForExistingJobAndGroupIds)(this._jobCreator.jobId,this._jobCreator.groups,this._existingJobsAndGroups);(0,_util.populateValidationMessages)(idResults,this._basicValidations,jobConfig,datafeedConfig);this._validationSummary.basic=this._isOverallBasicValid();this._basicValidationResult$.next(this._basicValidations)}},{key:"_runAdvancedValidation",value:function _runAdvancedValidation(){if((0,_job_creator.isCategorizationJobCreator)(this._jobCreator)){this._advancedValidations.categorizationFieldValid.valid=this._jobCreator.overallValidStatus!==_categorization_job.CATEGORY_EXAMPLES_VALIDATION_STATUS.INVALID}}},{key:"_isOverallBasicValid",value:function _isOverallBasicValid(){return Object.values(this._basicValidations).some((function(v){return v.valid===false}))===false}},{key:"validationSummary",get:function get(){return this._validationSummary}},{key:"bucketSpan",get:function get(){return this._basicValidations.bucketSpan}},{key:"duplicateDetectors",get:function get(){return this._basicValidations.duplicateDetectors}},{key:"jobId",get:function get(){return this._basicValidations.jobId}},{key:"groupIds",get:function get(){return this._basicValidations.groupIds}},{key:"modelMemoryLimit",get:function get(){return this._basicValidations.modelMemoryLimit}},{key:"query",get:function get(){return this._basicValidations.query}},{key:"queryDelay",get:function get(){return this._basicValidations.queryDelay}},{key:"frequency",get:function get(){return this._basicValidations.frequency}},{key:"scrollSize",get:function get(){return this._basicValidations.scrollSize}},{key:"advancedValid",set:function set(valid){this._validationSummary.advanced=valid}},{key:"validating",get:function get(){return this._validating}},{key:"categorizationField",get:function get(){return this._advancedValidations.categorizationFieldValid.valid},set:function set(valid){this._advancedValidations.categorizationFieldValid.valid=valid}}]);return JobValidator}();exports.JobValidator=JobValidator},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isCardinalityModelPlotHigh=isCardinalityModelPlotHigh;exports.cardinalityValidator=cardinalityValidator;exports.VALIDATOR_SEVERITY=void 0;var _operators=__webpack_require__(6);var _ml_api_service=__webpack_require__(51);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var VALIDATOR_SEVERITY;exports.VALIDATOR_SEVERITY=VALIDATOR_SEVERITY;(function(VALIDATOR_SEVERITY){VALIDATOR_SEVERITY[VALIDATOR_SEVERITY["ERROR"]=0]="ERROR";VALIDATOR_SEVERITY[VALIDATOR_SEVERITY["WARNING"]=1]="WARNING"})(VALIDATOR_SEVERITY||(exports.VALIDATOR_SEVERITY=VALIDATOR_SEVERITY={}));function isCardinalityModelPlotHigh(cardinalityValidationResult){return cardinalityValidationResult.modelPlotCardinality!==undefined}function cardinalityValidator(jobCreator$){return jobCreator$.pipe((0,_operators.filter)((function(jobCreator){return jobCreator===null||jobCreator===void 0?void 0:jobCreator.modelPlot})),(0,_operators.map)((function(jobCreator){return{jobCreator:jobCreator,analysisConfigString:JSON.stringify(jobCreator.jobConfig.analysis_config)}})),(0,_operators.distinctUntilChanged)((function(prev,curr){return prev.analysisConfigString===curr.analysisConfigString})),(0,_operators.switchMap)((function(_ref){var jobCreator=_ref.jobCreator;return _ml_api_service.ml.validateCardinality$(_objectSpread({},jobCreator.jobConfig,{datafeed_config:jobCreator.datafeedConfig}))})),(0,_operators.map)((function(validationResults){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=validationResults[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var validationResult=_step.value;if(isCardinalityModelPlotHigh(validationResult)){return{highCardinality:{value:validationResult.modelPlotCardinality,severity:VALIDATOR_SEVERITY.WARNING}}}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return null})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _job=__webpack_require__(1428);Object.keys(_job).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _job[key]}})}));var _job_stats=__webpack_require__(1429);Object.keys(_job_stats).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _job_stats[key]}})}));var _datafeed=__webpack_require__(493);Object.keys(_datafeed).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _datafeed[key]}})}));var _datafeed_stats=__webpack_require__(494);Object.keys(_datafeed_stats).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _datafeed_stats[key]}})}));var _combined_job=__webpack_require__(1430);Object.keys(_combined_job).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _combined_job[key]}})}));var _summary_job=__webpack_require__(1431);Object.keys(_summary_job).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _summary_job[key]}})}))},function(module,exports,__webpack_require__){"use strict"},function(module,exports,__webpack_require__){"use strict"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.expandCombinedJobConfig=expandCombinedJobConfig;exports.isCombinedJobWithStats=isCombinedJobWithStats;var _lodash=__webpack_require__(49);function expandCombinedJobConfig(combinedJob){var combinedJobClone=(0,_lodash.cloneDeep)(combinedJob);var job=combinedJobClone;var datafeed=combinedJobClone.datafeed_config;delete job.datafeed_config;return{job:job,datafeed:datafeed}}function isCombinedJobWithStats(arg){return typeof arg.job_id==="string"}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Datafeed",{enumerable:true,get:function get(){return _datafeed.Datafeed}});Object.defineProperty(exports,"DatafeedStats",{enumerable:true,get:function get(){return _datafeed_stats.DatafeedStats}});var _datafeed=__webpack_require__(493);var _datafeed_stats=__webpack_require__(494)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.checkViewOrCreateRoute=exports.recognizeRoute=void 0;var _queryString=__webpack_require__(126);var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _resolvers=__webpack_require__(110);var _recognize=__webpack_require__(1433);var _resolvers2=__webpack_require__(496);var _job_service=__webpack_require__(58);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.ANOMALY_DETECTION_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.jobsBreadcrumbs.selectIndexOrSearchLabelRecognize",{defaultMessage:"Select index or search"}),href:""}];var recognizeRoute={path:"/jobs/new_job/recognize",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.recognizeRoute=recognizeRoute;var checkViewOrCreateRoute={path:"/modules/check_view_or_create",render:function render(props,deps){return _react.default.createElement(CheckViewOrCreateWrapper,_extends({},props,{deps:deps}))},breadcrumbs:[]};exports.checkViewOrCreateRoute=checkViewOrCreateRoute;var PageWrapper=function PageWrapper(_ref){var location=_ref.location,deps=_ref.deps;var _parse=(0,_queryString.parse)(location.search,{sort:false}),id=_parse.id,index=_parse.index,savedSearchId=_parse.savedSearchId;var _useResolver=(0,_use_resolver.useResolver)(index,savedSearchId,deps.config,_objectSpread({},(0,_resolvers.basicResolvers)(deps),{existingJobsAndGroups:_job_service.mlJobService.getJobAndGroupIds})),context=_useResolver.context,results=_useResolver.results;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_recognize.Page,{moduleId:id,existingGroupIds:results.existingJobsAndGroups.groupIds}))};var CheckViewOrCreateWrapper=function CheckViewOrCreateWrapper(_ref2){var location=_ref2.location,deps=_ref2.deps;var _parse2=(0,_queryString.parse)(location.search,{sort:false}),moduleId=_parse2.id,indexPatternId=_parse2.index;(0,_use_resolver.useResolver)(undefined,undefined,deps.config,{checkViewOrCreateJobs:function checkViewOrCreateJobs(){return(0,_resolvers2.checkViewOrCreateJobs)(moduleId,indexPatternId)}});return null}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Page",{enumerable:true,get:function get(){return _page.Page}});var _page=__webpack_require__(203)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CreateResultCallout=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _page=__webpack_require__(203);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var CreateResultCallout=(0,_react.memo)((function(_ref){var saveState=_ref.saveState,resultsUrl=_ref.resultsUrl,onReset=_ref.onReset;if(saveState===_page.SAVE_STATE.NOT_SAVED){return null}return _react.default.createElement(_react.default.Fragment,null,saveState===_page.SAVE_STATE.SAVED&&_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobsCreatedTitle",defaultMessage:"Jobs created"}),color:"success",iconType:"checkInCircleFilled"}),saveState===_page.SAVE_STATE.FAILED&&_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.simple.recognize.jobsCreationFailedTitle",defaultMessage:"Jobs creation failed"}),color:"danger",iconType:"alert"}),saveState===_page.SAVE_STATE.PARTIAL_FAILURE&&_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.someJobsCreationFailedTitle",defaultMessage:"Some jobs failed to be created"}),color:"warning",iconType:"alert"}),_react.default.createElement(_eui.EuiSpacer,{size:"l"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center"},saveState!==_page.SAVE_STATE.SAVING&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{color:"primary",fill:false,"aria-label":_i18n.i18n.translate("xpack.ml.newJi18n(ob.recognize.jobsCreationFailed.resetButtonAriaLabel",{defaultMessage:"Reset"}),onClick:onReset},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.someJobsCreationFailed.resetButtonLabel",defaultMessage:"Reset"}))),(saveState===_page.SAVE_STATE.SAVED||saveState===_page.SAVE_STATE.PARTIAL_FAILURE)&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{color:"primary",fill:true,href:resultsUrl,"aria-label":_i18n.i18n.translate("xpack.ml.newJob.recognize.viewResultsAriaLabel",{defaultMessage:"View Results"})},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.viewResultsLinkText",defaultMessage:"View Results"})))))}));exports.CreateResultCallout=CreateResultCallout},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.KibanaObjects=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var KibanaObjects=(0,_react.memo)((function(_ref){var objectType=_ref.objectType,kibanaObjects=_ref.kibanaObjects,isSaving=_ref.isSaving;var kibanaObjectLabels={dashboard:_i18n.i18n.translate("xpack.ml.newJob.recognize.dashboardsLabel",{defaultMessage:"Dashboards"}),search:_i18n.i18n.translate("xpack.ml.newJob.recognize.searchesLabel",{defaultMessage:"Searches"}),visualization:_i18n.i18n.translate("xpack.ml.newJob.recognize.visualizationsLabel",{defaultMessage:"Visualizations"})};return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h4",null,kibanaObjectLabels[objectType])),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("ul",null,kibanaObjects.map((function(_ref2,i){var id=_ref2.id,title=_ref2.title,success=_ref2.success,exists=_ref2.exists;return _react.default.createElement("li",{key:id},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"s",color:exists?"subdued":"secondary"},title)),exists&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs",color:"default"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.alreadyExistsLabel",defaultMessage:"(already exists)"}))))),!exists&&_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:"60px"}},_react.default.createElement(_eui.EuiText,{textAlign:"center"},isSaving?_react.default.createElement(_eui.EuiLoadingSpinner,{size:"m"}):null,success!==undefined?_react.default.createElement(_eui.EuiIcon,{type:success?"check":"cross",color:success?"success":"danger","aria-label":success?_i18n.i18n.translate("xpack.ml.newJob.recognize.results.savedAriaLabel",{defaultMessage:"Saved"}):_i18n.i18n.translate("xpack.ml.newJob.recognize.results.saveFailedAriaLabel",{defaultMessage:"Save failed"})}):null))),(kibanaObjects.length===1||i<kibanaObjects.length-1)&&_react.default.createElement(_eui.EuiHorizontalRule,{margin:"s"}))}))))}));exports.KibanaObjects=KibanaObjects},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobItem=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _module_jobs=__webpack_require__(495);var _group_color_utils=__webpack_require__(151);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var JobItem=(0,_react.memo)((function(_ref){var job=_ref.job,jobOverride=_ref.jobOverride,isSaving=_ref.isSaving,jobPrefix=_ref.jobPrefix,onEditRequest=_ref.onEditRequest;var id=job.id,_job$config=job.config,description=_job$config.description,groups=_job$config.groups,datafeedResult=job.datafeedResult,setupResult=job.setupResult;var jobGroups=jobOverride&&jobOverride.groups||groups;return _react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"spaceBetween",responsive:false},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"s",color:"secondary"},jobPrefix,id)),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiToolTip,{position:"right",content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.job.overrideJobConfigurationLabel",defaultMessage:"Override job configuration"})},_react.default.createElement(_eui.EuiButtonIcon,{"aria-label":_i18n.i18n.translate("xpack.ml.newJob.recognize.job.overrideJobConfigurationLabel",{defaultMessage:"Override job configuration"}),iconType:"pencil",onClick:function onClick(){return onEditRequest(job)}})))),_react.default.createElement(_eui.EuiText,{size:"s",color:"subdued"},description),_react.default.createElement(_eui.EuiFlexGroup,{wrap:true,responsive:false,gutterSize:"xs"},jobGroups.map((function(group){return _react.default.createElement(_eui.EuiFlexItem,{grow:false,key:group},_react.default.createElement(_eui.EuiBadge,{color:(0,_group_color_utils.tabColor)(group)},group))}))),setupResult&&setupResult.error&&_react.default.createElement(_eui.EuiText,{size:"xs",color:"danger"},setupResult.error.msg),datafeedResult&&datafeedResult.error&&_react.default.createElement(_eui.EuiText,{size:"xs",color:"danger"},datafeedResult.error.msg)),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:_module_jobs.SETUP_RESULTS_WIDTH}},isSaving&&_react.default.createElement(_eui.EuiLoadingSpinner,{size:"m"}),setupResult&&datafeedResult&&_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",wrap:false,responsive:false,justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIcon,{type:setupResult.success?"check":"cross",color:setupResult.success?"secondary":"danger",size:"m","aria-label":setupResult.success?_i18n.i18n.translate("xpack.ml.newJob.recognize.job.savedAriaLabel",{defaultMessage:"Saved"}):_i18n.i18n.translate("xpack.ml.newJob.recognize.job.saveFailedAriaLabel",{defaultMessage:"Save failed"})})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIcon,{type:datafeedResult.success?"check":"cross",color:datafeedResult.success?"secondary":"danger",size:"m","aria-label":setupResult.success?_i18n.i18n.translate("xpack.ml.newJob.recognize.datafeed.savedAriaLabel",{defaultMessage:"Saved"}):_i18n.i18n.translate("xpack.ml.newJob.recognize.datafeed.saveFailedAriaLabel",{defaultMessage:"Save failed"})})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIcon,{type:datafeedResult.started?"check":"cross",color:datafeedResult.started?"secondary":"danger",size:"m","aria-label":setupResult.success?_i18n.i18n.translate("xpack.ml.newJob.recognize.running.startedAriaLabel",{defaultMessage:"Started"}):_i18n.i18n.translate("xpack.ml.newJob.recognize.running.startFailedAriaLabel",{defaultMessage:"Start failed"})})))))}));exports.JobItem=JobItem},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditJob=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _custom_hooks=__webpack_require__(196);var _validators=__webpack_require__(185);var _job_utils=__webpack_require__(59);var _validation=__webpack_require__(107);var _components=__webpack_require__(253);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var EditJob=function EditJob(_ref){var job=_ref.job,jobOverride=_ref.jobOverride,existingGroupIds=_ref.existingGroupIds,_onClose=_ref.onClose;var _usePartialState=(0,_custom_hooks.usePartialState)({jobGroups:jobOverride&&jobOverride.groups||job.config.groups}),_usePartialState2=_slicedToArray(_usePartialState,2),formState=_usePartialState2[0],setFormState=_usePartialState2[1];var _useState=(0,_react.useState)({}),_useState2=_slicedToArray(_useState,2),validationResult=_useState2[0],setValidationResult=_useState2[1];var groupValidator=(0,_validators.composeValidators)((function(value){return(0,_job_utils.isJobIdValid)(value)?null:{pattern:true}}),(0,_validators.maxLengthValidator)(_validation.JOB_ID_MAX_LENGTH));var handleValidation=function handleValidation(){var jobGroupsValidationResult=formState.jobGroups.map((function(group){return groupValidator(group)})).filter((function(result){return result!==null}));setValidationResult({jobGroups:jobGroupsValidationResult,formValid:jobGroupsValidationResult.length===0})};(0,_react.useEffect)((function(){handleValidation()}),[formState.jobGroups]);var onSave=function onSave(){var result={job_id:job.id,groups:formState.jobGroups};_onClose(result)};return _react.default.createElement(_eui.EuiFlyout,{onClose:function onClose(){return _onClose(null)}},_react.default.createElement(_eui.EuiFlyoutHeader,{hasBorder:true},_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.overrideConfigurationHeader",defaultMessage:"Override configuration for {jobID}",values:{jobID:job.id}})))),_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFormRow,{fullWidth:true},_react.default.createElement(_components.JobGroupsInput,{existingGroups:existingGroupIds,selectedGroups:formState.jobGroups,onChange:function onChange(value){setFormState({jobGroups:value})},validation:{valid:!validationResult.jobGroups||validationResult.jobGroups.length===0,message:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobGroupAllowedCharactersDescription",defaultMessage:"Job group names can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"})}}))),_react.default.createElement(_eui.EuiSpacer,null)),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:function onClick(){return _onClose(null)},flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.cancelJobOverrideLabel",defaultMessage:"Close"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:function onClick(){return onSave()},fill:true,disabled:!validationResult.formValid},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.saveJobOverrideLabel",defaultMessage:"Save"}))))))};exports.EditJob=EditJob},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobSettingsForm=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _page=__webpack_require__(203);var _full_time_range_selector=__webpack_require__(201);var _ml=__webpack_require__(77);var _validators=__webpack_require__(185);var _validation=__webpack_require__(107);var _custom_hooks=__webpack_require__(196);var _components=__webpack_require__(253);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var JobSettingsForm=function JobSettingsForm(_ref){var onSubmit=_ref.onSubmit,onChange=_ref.onChange,saveState=_ref.saveState,jobs=_ref.jobs;var _getTimeFilterRange=(0,_full_time_range_selector.getTimeFilterRange)(),from=_getTimeFilterRange.from,to=_getTimeFilterRange.to;var _useMlContext=(0,_ml.useMlContext)(),indexPattern=_useMlContext.currentIndexPattern;var jobPrefixValidator=(0,_validators.composeValidators)((0,_validators.patternValidator)(/^([a-z0-9]+[a-z0-9\-_]*)?$/),(0,_validators.maxLengthValidator)(_validation.JOB_ID_MAX_LENGTH-Math.max.apply(Math,_toConsumableArray(jobs.map((function(_ref2){var id=_ref2.id;return id.length}))))));var _usePartialState=(0,_custom_hooks.usePartialState)({jobPrefix:"",startDatafeedAfterSave:true,useFullIndexData:true,timeRange:{start:from,end:to},useDedicatedIndex:false}),_usePartialState2=_slicedToArray(_usePartialState,2),formState=_usePartialState2[0],setFormState=_usePartialState2[1];var _useState=(0,_react.useState)({}),_useState2=_slicedToArray(_useState,2),validationResult=_useState2[0],setValidationResult=_useState2[1];var onJobPrefixChange=function onJobPrefixChange(value){setFormState({jobPrefix:value&&value.toLowerCase()})};var handleValidation=function handleValidation(){var jobPrefixValidationResult=jobPrefixValidator(formState.jobPrefix);setValidationResult({jobPrefix:jobPrefixValidationResult,formValid:!jobPrefixValidationResult})};(0,_react.useEffect)((function(){handleValidation()}),[formState.jobPrefix]);(0,_react.useEffect)((function(){onChange(formState)}),[formState]);return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobIdPrefixLabel",defaultMessage:"Job ID prefix"})),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.tooltips.newJobRecognizerJobPrefixTooltip",defaultMessage:"A prefix which will be added to the beginning of each job ID."})},_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobIdPrefixLabel",defaultMessage:"Job ID prefix"}),isInvalid:!!validationResult.jobPrefix,error:_react.default.createElement(_react.default.Fragment,null,validationResult.jobPrefix&&validationResult.jobPrefix.maxLength?_react.default.createElement("div",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobPrefixInvalidMaxLengthErrorMessage",defaultMessage:"Job ID prefix must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:validationResult.jobPrefix.maxLength.requiredLength}})):null,validationResult.jobPrefix&&validationResult.jobPrefix.pattern&&_react.default.createElement("div",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobLabelAllowedCharactersDescription",defaultMessage:"Job label can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"})))},_react.default.createElement(_eui.EuiFieldText,{name:"jobPrefix",value:formState.jobPrefix,onChange:function onChange(_ref3){var value=_ref3.target.value;return onJobPrefixChange(value)},isInvalid:!!validationResult.jobPrefix}))),_react.default.createElement(_eui.EuiSpacer,{size:"l"}),_react.default.createElement(_eui.EuiFormRow,null,_react.default.createElement(_eui.EuiSwitch,{id:"startDataFeed",name:"startDataFeed",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.startDatafeedAfterSaveLabel",defaultMessage:"Start datafeed after save"}),checked:formState.startDatafeedAfterSave,onChange:function onChange(_ref4){var checked=_ref4.target.checked;setFormState({startDatafeedAfterSave:checked})}})),_react.default.createElement(_eui.EuiFormRow,null,_react.default.createElement(_eui.EuiSwitch,{id:"useFullData",name:"useFullData",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.useFullDataLabel",defaultMessage:"Use full {indexPatternTitle} data",values:{indexPatternTitle:indexPattern.title}}),checked:formState.useFullIndexData,onChange:function onChange(_ref5){var checked=_ref5.target.checked;setFormState({useFullIndexData:checked})}})),!formState.useFullIndexData&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_components.TimeRangePicker,{setTimeRange:function setTimeRange(value){setFormState({timeRange:value})},timeRange:formState.timeRange})),_react.default.createElement(_eui.EuiSpacer,{size:"l"}),_react.default.createElement(_eui.EuiAccordion,{id:"advancedOptions","aria-label":_i18n.i18n.translate("xpack.ml.newJob.recognize.advancedSettingsAriaLabel",{defaultMessage:"Advanced settings"}),buttonContent:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.advancedLabel",defaultMessage:"Advanced"}),paddingSize:"l"},_react.default.createElement(_eui.EuiDescribedFormGroup,{title:_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.useDedicatedIndexLabel",defaultMessage:"Use dedicated index"})),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.tooltips.newJobDedicatedIndexTooltip",defaultMessage:"Select to store results in a separate index for this job."})},_react.default.createElement(_eui.EuiFormRow,{describedByIds:["ml_aria_label_new_job_dedicated_index"]},_react.default.createElement(_eui.EuiSwitch,{id:"useDedicatedIndex",name:"useDedicatedIndex",checked:formState.useDedicatedIndex,onChange:function onChange(_ref6){var checked=_ref6.target.checked;setFormState({useDedicatedIndex:checked})},label:_i18n.i18n.translate("xpack.ml.newJob.recognize.useDedicatedIndexLabel",{defaultMessage:"Use dedicated index"})})))),_react.default.createElement(_eui.EuiSpacer,{size:"l"})),_react.default.createElement(_eui.EuiTextAlign,{textAlign:"right"},_react.default.createElement(_eui.EuiButton,{fill:true,type:"submit",isLoading:saveState===_page.SAVE_STATE.SAVING,disabled:!validationResult.formValid,onClick:function onClick(){onSubmit(formState)},"aria-label":_i18n.i18n.translate("xpack.ml.newJob.recognize.createJobButtonAriaLabel",{defaultMessage:"Create Job"})},saveState===_page.SAVE_STATE.NOT_SAVED&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.createJobButtonLabel",defaultMessage:"Create {numberOfJobs, plural, zero {Job} one {Job} other {Jobs}}",values:{numberOfJobs:jobs.length}}),saveState===_page.SAVE_STATE.SAVING&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.newJob.recognize.analysisRunningLabel",defaultMessage:"Analysis running"}))))};exports.JobSettingsForm=JobSettingsForm},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _datavisualizer=__webpack_require__(1440);Object.keys(_datavisualizer).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _datavisualizer[key]}})}));var _index_based=__webpack_require__(1443);Object.keys(_index_based).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _index_based[key]}})}));var _file_based=__webpack_require__(1484);Object.keys(_file_based).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _file_based[key]}})}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.selectorRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _datavisualizer=__webpack_require__(1441);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.DATA_VISUALIZER_BREADCRUMB];var selectorRoute={path:"/datavisualizer",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.selectorRoute=selectorRoute;var PageWrapper=function PageWrapper(_ref){var location=_ref.location,deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,{checkBasicLicense:_license.checkBasicLicense,checkFindFileStructurePrivilege:_check_privilege.checkFindFileStructurePrivilege}),context=_useResolver.context;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_datavisualizer.DatavisualizerSelector,null))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DatavisualizerSelector",{enumerable:true,get:function get(){return _datavisualizer_selector.DatavisualizerSelector}});var _datavisualizer_selector=__webpack_require__(1442)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DatavisualizerSelector=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _license=__webpack_require__(73);var _kibana=__webpack_require__(57);var _navigation_menu=__webpack_require__(82);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function startTrialDescription(){return _react.default.createElement("span",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.startTrial.fullMLFeaturesDescription",defaultMessage:"To experience the full Machine Learning features that a {subscriptionsLink} offers, start a 30-day trial.",values:{subscriptionsLink:_react.default.createElement(_eui.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.startTrial.subscriptionsLinkText",defaultMessage:"Platinum or Enterprise subscription"}))}}))}var DatavisualizerSelector=function DatavisualizerSelector(){(0,_kibana.useTimefilter)({timeRangeSelector:false,autoRefreshSelector:false});var _useMlKibana=(0,_kibana.useMlKibana)(),licenseManagement=_useMlKibana.services.licenseManagement;var startTrialVisible=licenseManagement!==undefined&&licenseManagement.enabled===true&&(0,_license.isFullLicense)()===false;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"datavisualizer"}),_react.default.createElement(_eui.EuiPage,{restrictWidth:1e3,"data-test-subj":"mlPageDataVisualizerSelector"},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,{size:"l"},_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.dataVisualizerTitle",defaultMessage:"Data Visualizer"}))))),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.dataVisualizerDescription",defaultMessage:"The Machine Learning Data Visualizer tool helps you understand your data, by analyzing the metrics and fields in a log file or an existing Elasticsearch index."})))),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{icon:_react.default.createElement(_eui.EuiIcon,{size:"xxl",type:"addDataApp"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.importDataTitle",defaultMessage:"Import data"}),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.importDataDescription",defaultMessage:"Import data from a log file. You can upload files up to 100 MB."}),betaBadgeLabel:_i18n.i18n.translate("xpack.ml.datavisualizer.selector.experimentalBadgeLabel",{defaultMessage:"Experimental"}),betaBadgeTooltipContent:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.experimentalBadgeTooltipLabel",defaultMessage:"Experimental feature. We'd love to hear your feedback."}),footer:_react.default.createElement(_eui.EuiButton,{target:"_self",href:"#/filedatavisualizer","data-test-subj":"mlDataVisualizerUploadFileButton"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.uploadFileButtonLabel",defaultMessage:"Upload file"})),"data-test-subj":"mlDataVisualizerCardImportData"})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{icon:_react.default.createElement(_eui.EuiIcon,{size:"xxl",type:"dataVisualizer"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexPatternTitle",defaultMessage:"Select an index pattern"}),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexPatternDescription",defaultMessage:"Visualize the data in an existing Elasticsearch index."}),footer:_react.default.createElement(_eui.EuiButton,{target:"_self",href:"#/datavisualizer_index_select","data-test-subj":"mlDataVisualizerSelectIndexButton"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexButtonLabel",defaultMessage:"Select index"})),"data-test-subj":"mlDataVisualizerCardIndexData"}))),startTrialVisible===true&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}),_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:"600px"}},_react.default.createElement(_eui.EuiCard,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.startTrialTitle",defaultMessage:"Start trial"}),description:startTrialDescription(),footer:_react.default.createElement(_eui.EuiButton,{target:"_blank",href:"kibana#/management/elasticsearch/license_management/home"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.startTrialButtonLabel",defaultMessage:"Start trial"}))})))))))};exports.DatavisualizerSelector=DatavisualizerSelector},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.indexBasedRoute=void 0;var _queryString=__webpack_require__(126);var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _index_based=__webpack_require__(1444);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _index_utils=__webpack_require__(70);var _ml_nodes_check=__webpack_require__(154);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.DATA_VISUALIZER_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.indexLabel",{defaultMessage:"Index"}),href:""}];var indexBasedRoute={path:"/jobs/new_job/datavisualizer",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.indexBasedRoute=indexBasedRoute;var PageWrapper=function PageWrapper(_ref){var location=_ref.location,deps=_ref.deps;var _parse=(0,_queryString.parse)(location.search,{sort:false}),index=_parse.index,savedSearchId=_parse.savedSearchId;var _useResolver=(0,_use_resolver.useResolver)(index,savedSearchId,deps.config,{checkBasicLicense:_license.checkBasicLicense,loadIndexPatterns:function loadIndexPatterns(){return(0,_index_utils.loadIndexPatterns)(deps.indexPatterns)},checkGetJobsPrivilege:_check_privilege.checkGetJobsPrivilege,checkMlNodesAvailable:_ml_nodes_check.checkMlNodesAvailable}),context=_useResolver.context;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_index_based.Page,null))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Page",{enumerable:true,get:function get(){return _page.Page}});var _page=__webpack_require__(1445)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Page=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _rxjs=__webpack_require__(33);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _public=__webpack_require__(63);var _navigation_menu=__webpack_require__(82);var _field_types=__webpack_require__(109);var _search=__webpack_require__(99);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _check_ml_nodes=__webpack_require__(81);var _full_time_range_selector=__webpack_require__(201);var _timefilter_refresh_service=__webpack_require__(184);var _ml=__webpack_require__(77);var _field_types_utils=__webpack_require__(204);var _kibana=__webpack_require__(57);var _index_utils=__webpack_require__(70);var _time_buckets=__webpack_require__(106);var _url_state=__webpack_require__(88);var _actions_panel=__webpack_require__(1446);var _fields_panel=__webpack_require__(1448);var _search_panel=__webpack_require__(1480);var _data_loader=__webpack_require__(1482);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var defaultSearchQuery={match_all:{}};function getDefaultPageState(){return{searchString:"",searchQuery:defaultSearchQuery,searchQueryLanguage:_search.SEARCH_QUERY_LANGUAGE.KUERY,samplerShardSize:5e3,overallStats:{totalCount:0,aggregatableExistsFields:[],aggregatableNotExistsFields:[],nonAggregatableExistsFields:[],nonAggregatableNotExistsFields:[]},metricConfigs:[],totalMetricFieldCount:0,populatedMetricFieldCount:0,showAllMetrics:false,nonMetricConfigs:[],totalNonMetricFieldCount:0,populatedNonMetricFieldCount:0,showAllNonMetrics:false,nonMetricShowFieldType:"*"}}var Page=function Page(){var _globalState$time,_globalState$time2,_globalState$refreshI,_globalState$refreshI2;var mlContext=(0,_ml.useMlContext)();var combinedQuery=mlContext.combinedQuery,currentIndexPattern=mlContext.currentIndexPattern,currentSavedSearch=mlContext.currentSavedSearch,kibanaConfig=mlContext.kibanaConfig;var timefilter=(0,_kibana.useTimefilter)({timeRangeSelector:currentIndexPattern.timeFieldName!==undefined,autoRefreshSelector:true});var dataLoader=new _data_loader.DataLoader(currentIndexPattern,kibanaConfig);var _useUrlState=(0,_url_state.useUrlState)("_g"),_useUrlState2=_slicedToArray(_useUrlState,2),globalState=_useUrlState2[0],setGlobalState=_useUrlState2[1];(0,_react.useEffect)((function(){if((globalState===null||globalState===void 0?void 0:globalState.time)!==undefined){timefilter.setTime({from:globalState.time.from,to:globalState.time.to})}}),[globalState===null||globalState===void 0?void 0:(_globalState$time=globalState.time)===null||_globalState$time===void 0?void 0:_globalState$time.from,globalState===null||globalState===void 0?void 0:(_globalState$time2=globalState.time)===null||_globalState$time2===void 0?void 0:_globalState$time2.to]);(0,_react.useEffect)((function(){if((globalState===null||globalState===void 0?void 0:globalState.refreshInterval)!==undefined){timefilter.setRefreshInterval(globalState.refreshInterval)}}),[globalState===null||globalState===void 0?void 0:(_globalState$refreshI=globalState.refreshInterval)===null||_globalState$refreshI===void 0?void 0:_globalState$refreshI.pause,globalState===null||globalState===void 0?void 0:(_globalState$refreshI2=globalState.refreshInterval)===null||_globalState$refreshI2===void 0?void 0:_globalState$refreshI2.value]);var _useState=(0,_react.useState)(0),_useState2=_slicedToArray(_useState,2),lastRefresh=_useState2[0],setLastRefresh=_useState2[1];(0,_react.useEffect)((function(){(0,_index_utils.timeBasedIndexCheck)(currentIndexPattern,true)}),[]);var indexedFieldTypes=[];var indexPatternFields=currentIndexPattern.fields;indexPatternFields.forEach((function(field){if(field.scripted!==true){var dataVisualizerType=(0,_field_types_utils.kbnTypeToMLJobType)(field);if(dataVisualizerType!==undefined&&!indexedFieldTypes.includes(dataVisualizerType)&&dataVisualizerType!==_field_types.ML_JOB_FIELD_TYPES.NUMBER){indexedFieldTypes.push(dataVisualizerType)}}}));indexedFieldTypes=indexedFieldTypes.sort();var defaults=getDefaultPageState();var showActionsPanel=(0,_license.isFullLicense)()&&(0,_check_privilege.checkPermission)("canCreateJob")&&(0,_check_ml_nodes.mlNodesAvailable)()&&currentIndexPattern.timeFieldName!==undefined;var _extractSearchData=extractSearchData(currentSavedSearch),initSearchQuery=_extractSearchData.searchQuery,initSearchString=_extractSearchData.searchString,initQueryLanguage=_extractSearchData.queryLanguage;var _useState3=(0,_react.useState)(initSearchString),_useState4=_slicedToArray(_useState3,2),searchString=_useState4[0],setSearchString=_useState4[1];var _useState5=(0,_react.useState)(initSearchQuery),_useState6=_slicedToArray(_useState5,2),searchQuery=_useState6[0],setSearchQuery=_useState6[1];var _useState7=(0,_react.useState)(initQueryLanguage),_useState8=_slicedToArray(_useState7,2),searchQueryLanguage=_useState8[0],setSearchQueryLanguage=_useState8[1];var _useState9=(0,_react.useState)(defaults.samplerShardSize),_useState10=_slicedToArray(_useState9,2),samplerShardSize=_useState10[0],setSamplerShardSize=_useState10[1];var _useState11=(0,_react.useState)(defaults.overallStats),_useState12=_slicedToArray(_useState11,2),overallStats=_useState12[0],setOverallStats=_useState12[1];var _useState13=(0,_react.useState)(defaults.metricConfigs),_useState14=_slicedToArray(_useState13,2),metricConfigs=_useState14[0],setMetricConfigs=_useState14[1];var _useState15=(0,_react.useState)(defaults.totalMetricFieldCount),_useState16=_slicedToArray(_useState15,2),totalMetricFieldCount=_useState16[0],setTotalMetricFieldCount=_useState16[1];var _useState17=(0,_react.useState)(defaults.populatedMetricFieldCount),_useState18=_slicedToArray(_useState17,2),populatedMetricFieldCount=_useState18[0],setPopulatedMetricFieldCount=_useState18[1];var _useState19=(0,_react.useState)(defaults.showAllMetrics),_useState20=_slicedToArray(_useState19,2),showAllMetrics=_useState20[0],setShowAllMetrics=_useState20[1];var _useState21=(0,_react.useState)(defaults.metricFieldQuery),_useState22=_slicedToArray(_useState21,2),metricFieldQuery=_useState22[0],setMetricFieldQuery=_useState22[1];var _useState23=(0,_react.useState)(defaults.nonMetricConfigs),_useState24=_slicedToArray(_useState23,2),nonMetricConfigs=_useState24[0],setNonMetricConfigs=_useState24[1];var _useState25=(0,_react.useState)(defaults.totalNonMetricFieldCount),_useState26=_slicedToArray(_useState25,2),totalNonMetricFieldCount=_useState26[0],setTotalNonMetricFieldCount=_useState26[1];var _useState27=(0,_react.useState)(defaults.populatedNonMetricFieldCount),_useState28=_slicedToArray(_useState27,2),populatedNonMetricFieldCount=_useState28[0],setPopulatedNonMetricFieldCount=_useState28[1];var _useState29=(0,_react.useState)(defaults.showAllNonMetrics),_useState30=_slicedToArray(_useState29,2),showAllNonMetrics=_useState30[0],setShowAllNonMetrics=_useState30[1];var _useState31=(0,_react.useState)(defaults.nonMetricShowFieldType),_useState32=_slicedToArray(_useState31,2),nonMetricShowFieldType=_useState32[0],setNonMetricShowFieldType=_useState32[1];var _useState33=(0,_react.useState)(defaults.nonMetricFieldQuery),_useState34=_slicedToArray(_useState33,2),nonMetricFieldQuery=_useState34[0],setNonMetricFieldQuery=_useState34[1];(0,_react.useEffect)((function(){var timeUpdateSubscription=(0,_rxjs.merge)(timefilter.getTimeUpdate$(),_timefilter_refresh_service.mlTimefilterRefresh$).subscribe((function(){setGlobalState({time:timefilter.getTime(),refreshInterval:timefilter.getRefreshInterval()});setLastRefresh(Date.now())}));return function(){timeUpdateSubscription.unsubscribe()}}));(0,_react.useEffect)((function(){loadOverallStats()}),[searchQuery,samplerShardSize,lastRefresh]);(0,_react.useEffect)((function(){createMetricCards();createNonMetricCards()}),[overallStats]);(0,_react.useEffect)((function(){loadMetricFieldStats()}),[metricConfigs]);(0,_react.useEffect)((function(){loadNonMetricFieldStats()}),[nonMetricConfigs]);(0,_react.useEffect)((function(){createMetricCards()}),[showAllMetrics,metricFieldQuery]);(0,_react.useEffect)((function(){createNonMetricCards()}),[showAllNonMetrics,nonMetricShowFieldType,nonMetricFieldQuery]);function extractSearchData(savedSearch){if(!savedSearch){return{searchQuery:defaults.searchQuery,searchString:defaults.searchString,queryLanguage:defaults.searchQueryLanguage}}var _getQueryFromSavedSea=(0,_index_utils.getQueryFromSavedSearch)(savedSearch),query=_getQueryFromSavedSea.query;var queryLanguage=query.language;var qryString=query.query;var qry;if(queryLanguage===_search.SEARCH_QUERY_LANGUAGE.KUERY){var ast=_public.esKuery.fromKueryExpression(qryString);qry=_public.esKuery.toElasticsearchQuery(ast,currentIndexPattern)}else{qry=_public.esQuery.luceneStringToDsl(qryString);_public.esQuery.decorateQuery(qry,kibanaConfig.get("query:queryString:options"))}return{searchQuery:qry,searchString:qryString,queryLanguage:queryLanguage}}function loadOverallStats(){return _loadOverallStats.apply(this,arguments)}function _loadOverallStats(){_loadOverallStats=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var tf,earliest,latest,activeBounds,allStats;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:tf=timefilter;activeBounds=tf.getActiveBounds();if(!(currentIndexPattern.timeFieldName!==undefined&&activeBounds===undefined)){_context.next=4;break}return _context.abrupt("return");case 4:if(currentIndexPattern.timeFieldName!==undefined){earliest=activeBounds.min.valueOf();latest=activeBounds.max.valueOf()}_context.prev=5;_context.next=8;return dataLoader.loadOverallData(searchQuery,samplerShardSize,earliest,latest);case 8:allStats=_context.sent;setOverallStats(allStats);_context.next=15;break;case 12:_context.prev=12;_context.t0=_context["catch"](5);dataLoader.displayError(_context.t0);case 15:case"end":return _context.stop()}}}),_callee,null,[[5,12]])})));return _loadOverallStats.apply(this,arguments)}function loadMetricFieldStats(){return _loadMetricFieldStats.apply(this,arguments)}function _loadMetricFieldStats(){_loadMetricFieldStats=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var configsToLoad,existMetricFields,buckets,tf,earliest,latest,bounds,BAR_TARGET,aggInterval,metricFieldStats,configs;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(metricConfigs.length===0)){_context2.next=2;break}return _context2.abrupt("return");case 2:configsToLoad=metricConfigs.filter((function(config){return config.existsInDocs===true&&config.loading===true}));if(!(configsToLoad.length===0)){_context2.next=5;break}return _context2.abrupt("return");case 5:existMetricFields=configsToLoad.map((function(config){var props={fieldName:config.fieldName,type:config.type,cardinality:0};if(config.stats!==undefined&&config.stats.cardinality!==undefined){props.cardinality=config.stats.cardinality}return props}));buckets=new _time_buckets.TimeBuckets;tf=timefilter;if(currentIndexPattern.timeFieldName!==undefined){earliest=tf.getActiveBounds().min.valueOf();latest=tf.getActiveBounds().max.valueOf()}bounds=tf.getActiveBounds();BAR_TARGET=75;buckets.setInterval("auto");buckets.setBounds(bounds);buckets.setBarTarget(BAR_TARGET);aggInterval=buckets.getInterval();_context2.prev=15;_context2.next=18;return dataLoader.loadFieldStats(searchQuery,samplerShardSize,earliest,latest,existMetricFields,aggInterval.expression);case 18:metricFieldStats=_context2.sent;configs=[];metricConfigs.forEach((function(config){var configWithStats=_objectSpread({},config);if(config.fieldName!==undefined){configWithStats.stats=_objectSpread({},configWithStats.stats,{},metricFieldStats.find((function(fieldStats){return fieldStats.fieldName===config.fieldName})))}else{configWithStats.stats=metricFieldStats.find((function(fieldStats){return fieldStats.fieldName===undefined}));configWithStats.stats.timeRangeEarliest=earliest;configWithStats.stats.timeRangeLatest=latest}configWithStats.loading=false;configs.push(configWithStats)}));setMetricConfigs(configs);_context2.next=27;break;case 24:_context2.prev=24;_context2.t0=_context2["catch"](15);dataLoader.displayError(_context2.t0);case 27:case"end":return _context2.stop()}}}),_callee2,null,[[15,24]])})));return _loadMetricFieldStats.apply(this,arguments)}function loadNonMetricFieldStats(){return _loadNonMetricFieldStats.apply(this,arguments)}function _loadNonMetricFieldStats(){_loadNonMetricFieldStats=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var configsToLoad,existNonMetricFields,tf,earliest,latest,nonMetricFieldStats,configs;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(nonMetricConfigs.length===0)){_context3.next=2;break}return _context3.abrupt("return");case 2:configsToLoad=nonMetricConfigs.filter((function(config){return config.existsInDocs===true&&config.loading===true}));if(!(configsToLoad.length===0)){_context3.next=5;break}return _context3.abrupt("return");case 5:existNonMetricFields=configsToLoad.map((function(config){var props={fieldName:config.fieldName,type:config.type,cardinality:0};if(config.stats!==undefined&&config.stats.cardinality!==undefined){props.cardinality=config.stats.cardinality}return props}));tf=timefilter;if(currentIndexPattern.timeFieldName!==undefined){earliest=tf.getActiveBounds().min.valueOf();latest=tf.getActiveBounds().max.valueOf()}_context3.prev=8;_context3.next=11;return dataLoader.loadFieldStats(searchQuery,samplerShardSize,earliest,latest,existNonMetricFields);case 11:nonMetricFieldStats=_context3.sent;configs=[];nonMetricConfigs.forEach((function(config){var configWithStats=_objectSpread({},config);if(config.fieldName!==undefined){configWithStats.stats=_objectSpread({},configWithStats.stats,{},nonMetricFieldStats.find((function(fieldStats){return fieldStats.fieldName===config.fieldName})))}configWithStats.loading=false;configs.push(configWithStats)}));setNonMetricConfigs(configs);_context3.next=20;break;case 17:_context3.prev=17;_context3.t0=_context3["catch"](8);dataLoader.displayError(_context3.t0);case 20:case"end":return _context3.stop()}}}),_callee3,null,[[8,17]])})));return _loadNonMetricFieldStats.apply(this,arguments)}function createMetricCards(){var configs=[];var aggregatableExistsFields=overallStats.aggregatableExistsFields||[];var allMetricFields=indexPatternFields.filter((function(f){return f.type===_public.KBN_FIELD_TYPES.NUMBER&&f.displayName!==undefined&&dataLoader.isDisplayField(f.displayName)===true}));if(metricFieldQuery!==undefined){var metricFieldRegexp=new RegExp("(".concat(metricFieldQuery,")"),"gi");allMetricFields=allMetricFields.filter((function(f){var addField=f.displayName!==undefined&&!!f.displayName.match(metricFieldRegexp);return addField}))}var metricExistsFields=allMetricFields.filter((function(f){return aggregatableExistsFields.find((function(existsF){return existsF.fieldName===f.displayName}))}));var allFieldCount=allMetricFields.length;var popFieldCount=metricExistsFields.length;if(currentIndexPattern.timeFieldName!==undefined){configs.push({type:_field_types.ML_JOB_FIELD_TYPES.NUMBER,existsInDocs:true,loading:true,aggregatable:true});allFieldCount++;popFieldCount++}setTotalMetricFieldCount(allFieldCount);setPopulatedMetricFieldCount(popFieldCount);if(allMetricFields.length===metricExistsFields.length&&showAllMetrics===false){setShowAllMetrics(true);return}var aggregatableFields=overallStats.aggregatableExistsFields;if(allMetricFields.length!==metricExistsFields.length&&showAllMetrics===true){aggregatableFields=aggregatableFields.concat(overallStats.aggregatableNotExistsFields)}var metricFieldsToShow=showAllMetrics===true?allMetricFields:metricExistsFields;metricFieldsToShow.forEach((function(field){var fieldData=aggregatableFields.find((function(f){return f.fieldName===field.displayName}));if(fieldData!==undefined){var metricConfig=_objectSpread({},fieldData,{fieldFormat:field.format,type:_field_types.ML_JOB_FIELD_TYPES.NUMBER,loading:true,aggregatable:true});configs.push(metricConfig)}}));setMetricConfigs(configs)}function createNonMetricCards(){var allNonMetricFields=[];if(nonMetricShowFieldType==="*"){allNonMetricFields=indexPatternFields.filter((function(f){return f.type!==_public.KBN_FIELD_TYPES.NUMBER&&f.displayName!==undefined&&dataLoader.isDisplayField(f.displayName)===true}))}else{if(nonMetricShowFieldType===_field_types.ML_JOB_FIELD_TYPES.TEXT||nonMetricShowFieldType===_field_types.ML_JOB_FIELD_TYPES.KEYWORD){var aggregatableCheck=nonMetricShowFieldType===_field_types.ML_JOB_FIELD_TYPES.KEYWORD?true:false;allNonMetricFields=indexPatternFields.filter((function(f){return f.displayName!==undefined&&dataLoader.isDisplayField(f.displayName)===true&&f.type===_public.KBN_FIELD_TYPES.STRING&&f.aggregatable===aggregatableCheck}))}else{allNonMetricFields=indexPatternFields.filter((function(f){return f.type===nonMetricShowFieldType&&f.displayName!==undefined&&dataLoader.isDisplayField(f.displayName)===true}))}}if(nonMetricFieldQuery!==undefined){var nonMetricFieldRegexp=new RegExp("(".concat(nonMetricFieldQuery,")"),"gi");allNonMetricFields=allNonMetricFields.filter((function(f){return f.displayName!==undefined&&f.displayName.match(nonMetricFieldRegexp)}))}var populatedNonMetricFields=[];var nonMetricFieldData=[];var aggregatableExistsFields=overallStats.aggregatableExistsFields||[];var nonAggregatableExistsFields=overallStats.nonAggregatableExistsFields||[];allNonMetricFields.forEach((function(f){var checkAggregatableField=aggregatableExistsFields.find((function(existsField){return existsField.fieldName===f.displayName}));if(checkAggregatableField!==undefined){populatedNonMetricFields.push(f);nonMetricFieldData.push(checkAggregatableField)}else{var checkNonAggregatableField=nonAggregatableExistsFields.find((function(existsField){return existsField.fieldName===f.displayName}));if(checkNonAggregatableField!==undefined){populatedNonMetricFields.push(f);nonMetricFieldData.push(checkNonAggregatableField)}}}));setTotalNonMetricFieldCount(allNonMetricFields.length);setPopulatedNonMetricFieldCount(nonMetricFieldData.length);if(allNonMetricFields.length===nonMetricFieldData.length&&showAllNonMetrics===false){setShowAllNonMetrics(true);return}if(allNonMetricFields.length!==nonMetricFieldData.length&&showAllNonMetrics===true){nonMetricFieldData=nonMetricFieldData.concat(overallStats.aggregatableNotExistsFields,overallStats.nonAggregatableNotExistsFields)}var nonMetricFieldsToShow=showAllNonMetrics===true?allNonMetricFields:populatedNonMetricFields;var configs=[];nonMetricFieldsToShow.forEach((function(field){var fieldData=nonMetricFieldData.find((function(f){return f.fieldName===field.displayName}));var nonMetricConfig=_objectSpread({},fieldData,{fieldFormat:field.format,aggregatable:field.aggregatable,scripted:field.scripted,loading:fieldData.existsInDocs});var dataVisualizerType=(0,_field_types_utils.kbnTypeToMLJobType)(field);if(dataVisualizerType!==undefined){nonMetricConfig.type=dataVisualizerType}else{nonMetricConfig.type=field.type;nonMetricConfig.isUnsupportedType=true}configs.push(nonMetricConfig)}));setNonMetricConfigs(configs)}var wizardPanelWidth="280px";return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"datavisualizer"}),_react.default.createElement(_eui.EuiPage,{"data-test-subj":"mlPageIndexDataVisualizer"},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiPageContentHeader,null,_react.default.createElement(_eui.EuiPageContentHeaderSection,null,_react.default.createElement(_eui.EuiTitle,{size:"l"},_react.default.createElement("h1",null,currentIndexPattern.title))),currentIndexPattern.timeFieldName!==undefined&&_react.default.createElement(_eui.EuiPageContentHeaderSection,{"data-test-subj":"mlDataVisualizerTimeRangeSelectorSection"},_react.default.createElement(_full_time_range_selector.FullTimeRangeSelector,{indexPattern:currentIndexPattern,query:combinedQuery,disabled:false})))),showActionsPanel===true&&_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:wizardPanelWidth}})),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiPageContentBody,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiPanel,null,_react.default.createElement(_search_panel.SearchPanel,{indexPattern:currentIndexPattern,searchString:searchString,setSearchString:setSearchString,searchQuery:searchQuery,setSearchQuery:setSearchQuery,searchQueryLanguage:searchQueryLanguage,setSearchQueryLanguage:setSearchQueryLanguage,samplerShardSize:samplerShardSize,setSamplerShardSize:setSamplerShardSize,totalCount:overallStats.totalCount}),_react.default.createElement(_eui.EuiHorizontalRule,null),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m"},_react.default.createElement(_eui.EuiFlexItem,null,totalMetricFieldCount>0&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_fields_panel.FieldsPanel,{title:_i18n.i18n.translate("xpack.ml.datavisualizer.page.metricsPanelTitle",{defaultMessage:"Metrics"}),totalFieldCount:totalMetricFieldCount,populatedFieldCount:populatedMetricFieldCount,fieldTypes:[_field_types.ML_JOB_FIELD_TYPES.NUMBER],showFieldType:_field_types.ML_JOB_FIELD_TYPES.NUMBER,showAllFields:showAllMetrics,setShowAllFields:setShowAllMetrics,fieldSearchBarQuery:metricFieldQuery,setFieldSearchBarQuery:setMetricFieldQuery,fieldVisConfigs:metricConfigs}),_react.default.createElement(_eui.EuiSpacer,{size:"xl"})),_react.default.createElement(_fields_panel.FieldsPanel,{title:_i18n.i18n.translate("xpack.ml.datavisualizer.page.fieldsPanelTitle",{defaultMessage:"Fields"}),totalFieldCount:totalNonMetricFieldCount,populatedFieldCount:populatedNonMetricFieldCount,showAllFields:showAllNonMetrics,setShowAllFields:setShowAllNonMetrics,fieldTypes:indexedFieldTypes,showFieldType:nonMetricShowFieldType,setShowFieldType:setNonMetricShowFieldType,fieldSearchBarQuery:nonMetricFieldQuery,setFieldSearchBarQuery:setNonMetricFieldQuery,fieldVisConfigs:nonMetricConfigs}))))),showActionsPanel===true&&_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:wizardPanelWidth}},_react.default.createElement(_actions_panel.ActionsPanel,{indexPattern:currentIndexPattern})))))))};exports.Page=Page},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ActionsPanel",{enumerable:true,get:function get(){return _actions_panel.ActionsPanel}});var _actions_panel=__webpack_require__(1447)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionsPanel=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _create_job_link_card=__webpack_require__(251);var _data_recognizer=__webpack_require__(464);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ActionsPanel=function ActionsPanel(_ref){var indexPattern=_ref.indexPattern;var _useState=(0,_react.useState)(0),_useState2=_slicedToArray(_useState,2),recognizerResultsCount=_useState2[0],setRecognizerResultsCount=_useState2[1];var recognizerResults={count:0,onChange:function onChange(){setRecognizerResultsCount(recognizerResults.count)}};function openAdvancedJobWizard(){window.open("#/jobs/new_job/advanced?index=".concat(indexPattern),"_self")}return _react.default.createElement("div",{"data-test-subj":"mlDataVisualizerActionsPanel"},_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.actionsPanel.createJobTitle",defaultMessage:"Create Job"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("div",{style:recognizerResultsCount===0?{display:"none"}:{}},_react.default.createElement(_eui.EuiText,{size:"s",color:"subdued"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.actionsPanel.selectKnownConfigurationDescription",defaultMessage:"Select known configurations for recognized data:"}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l",responsive:true,wrap:true},_react.default.createElement(_data_recognizer.DataRecognizer,{indexPattern:indexPattern,savedSearch:null,results:recognizerResults})),_react.default.createElement(_eui.EuiSpacer,{size:"l"})),_react.default.createElement(_eui.EuiText,{size:"s",color:"subdued"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.actionsPanel.createJobDescription",defaultMessage:"Use the Advanced job wizard to create a job to find anomalies in this data:"}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_create_job_link_card.CreateJobLinkCard,{icon:"createAdvancedJob",title:_i18n.i18n.translate("xpack.ml.datavisualizer.actionsPanel.advancedTitle",{defaultMessage:"Advanced"}),description:_i18n.i18n.translate("xpack.ml.datavisualizer.actionsPanel.advancedDescription",{defaultMessage:"Use the full range of options to create a job for more advanced use cases"}),onClick:openAdvancedJobWizard,href:"#/jobs/new_job/advanced?index=".concat(indexPattern),"data-test-subj":"mlDataVisualizerCreateAdvancedJobCard"}))};exports.ActionsPanel=ActionsPanel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FieldsPanel",{enumerable:true,get:function get(){return _fields_panel.FieldsPanel}});var _fields_panel=__webpack_require__(1449)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldsPanel=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _kibana=__webpack_require__(57);var _field_data_card=__webpack_require__(1450);var _field_types_select=__webpack_require__(1478);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FieldsPanel=function FieldsPanel(_ref){var title=_ref.title,totalFieldCount=_ref.totalFieldCount,populatedFieldCount=_ref.populatedFieldCount,showAllFields=_ref.showAllFields,setShowAllFields=_ref.setShowAllFields,fieldTypes=_ref.fieldTypes,showFieldType=_ref.showFieldType,setShowFieldType=_ref.setShowFieldType,fieldSearchBarQuery=_ref.fieldSearchBarQuery,setFieldSearchBarQuery=_ref.setFieldSearchBarQuery,fieldVisConfigs=_ref.fieldVisConfigs;var _useMlKibana=(0,_kibana.useMlKibana)(),notifications=_useMlKibana.services.notifications;function onShowAllFieldsChange(){setShowAllFields(!showAllFields)}function onSearchBarChange(query){if(query.error){var toasts=notifications.toasts;toasts.addWarning(_i18n.i18n.translate("xpack.ml.datavisualizer.fieldsPanel.searchBarError",{defaultMessage:"An error occurred running the search. {message}.",values:{message:query.error.message}}))}else{setFieldSearchBarQuery(query.queryText)}}return _react.default.createElement("div",{"data-test-subj":"mlDataVisualizerFieldsPanel ".concat(fieldTypes)},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h2",null,title))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiToolTip,{position:"top",content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.fieldsPanel.countDescription",defaultMessage:"{cardsCount} {cardsCount, plural, one {field exists} other {fields exist}} in documents sampled",values:{cardsCount:populatedFieldCount}})},_react.default.createElement(_eui.EuiBadge,{title:""},_react.default.createElement("b",null,populatedFieldCount)))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"s",color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.fieldsPanel.totalFieldLabel",defaultMessage:"Total fields: {wrappedTotalFields}",values:{wrappedTotalFields:_react.default.createElement("b",null,totalFieldCount)}}))),populatedFieldCount<totalFieldCount&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiSwitch,{id:"".concat(title,"_show_empty_fields"),label:_i18n.i18n.translate("xpack.ml.datavisualizer.fieldsPanel.showEmptyFieldsLabel",{defaultMessage:"Show empty fields"}),checked:showAllFields,onChange:onShowAllFieldsChange,"data-test-subj":"mlDataVisualizerShowEmptyFieldsCheckbox",compressed:true})))),_react.default.createElement(_eui.EuiFlexItem,{grow:true},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"m",direction:"rowReverse"},_react.default.createElement(_eui.EuiFlexItem,{style:{maxWidth:"400px"},"data-test-subj":"mlDataVisualizerFieldsSearchBarDiv"},_react.default.createElement(_eui.EuiSearchBar,{defaultQuery:"",query:fieldSearchBarQuery,box:{placeholder:_i18n.i18n.translate("xpack.ml.datavisualizer.fieldsPanel.filterFieldsPlaceholder",{defaultMessage:"Filter {type}",values:{type:title}})},onChange:onSearchBarChange,"data-test-subj":"mlDataVisualizerFieldsSearchBar"})),typeof setShowFieldType==="function"&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_field_types_select.FieldTypesSelect,{fieldTypes:fieldTypes,selectedFieldType:showFieldType,setSelectedFieldType:setShowFieldType}))))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexGrid,{gutterSize:"m"},fieldVisConfigs.filter((function(_ref2){var stats=_ref2.stats;return stats!==undefined})).map((function(visConfig,i){return _react.default.createElement(_eui.EuiFlexItem,{key:"".concat(visConfig.fieldName,"_").concat(visConfig.stats.count),style:{minWidth:"360px"}},_react.default.createElement(_field_data_card.FieldDataCard,{config:visConfig}))}))))};exports.FieldsPanel=FieldsPanel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FieldDataCard",{enumerable:true,get:function get(){return _field_data_card.FieldDataCard}});Object.defineProperty(exports,"FieldDataCardProps",{enumerable:true,get:function get(){return _field_data_card.FieldDataCardProps}});var _field_data_card=__webpack_require__(1451)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldDataCard=void 0;var _eui=__webpack_require__(29);var _react=_interopRequireDefault(__webpack_require__(28));var _field_types=__webpack_require__(109);var _index=__webpack_require__(1452);var _content_types=__webpack_require__(1455);var _loading_indicator=__webpack_require__(1476);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FieldDataCard=function FieldDataCard(_ref){var config=_ref.config;var fieldName=config.fieldName,loading=config.loading,type=config.type,existsInDocs=config.existsInDocs;function getCardContent(){if(existsInDocs===false){return _react.default.createElement(_content_types.NotInDocsContent,null)}switch(type){case _field_types.ML_JOB_FIELD_TYPES.NUMBER:if(fieldName!==undefined){return _react.default.createElement(_content_types.NumberContent,{config:config})}else{return _react.default.createElement(_content_types.DocumentCountContent,{config:config})}case _field_types.ML_JOB_FIELD_TYPES.BOOLEAN:return _react.default.createElement(_content_types.BooleanContent,{config:config});case _field_types.ML_JOB_FIELD_TYPES.DATE:return _react.default.createElement(_content_types.DateContent,{config:config});case _field_types.ML_JOB_FIELD_TYPES.GEO_POINT:return _react.default.createElement(_content_types.GeoPointContent,{config:config});case _field_types.ML_JOB_FIELD_TYPES.IP:return _react.default.createElement(_content_types.IpContent,{config:config});case _field_types.ML_JOB_FIELD_TYPES.KEYWORD:return _react.default.createElement(_content_types.KeywordContent,{config:config});case _field_types.ML_JOB_FIELD_TYPES.TEXT:return _react.default.createElement(_content_types.TextContent,{config:config});default:return _react.default.createElement(_content_types.OtherContent,{config:config})}}return _react.default.createElement(_eui.EuiPanel,{"data-test-subj":"mlFieldDataCard ".concat(fieldName," ").concat(type),className:"mlFieldDataCard",hasShadow:false},_react.default.createElement(_index.FieldTitleBar,{card:config}),_react.default.createElement("div",{className:"mlFieldDataCard__content"},loading===true?_react.default.createElement(_loading_indicator.LoadingIndicator,null):getCardContent()))};exports.FieldDataCard=FieldDataCard},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FieldTitleBar",{enumerable:true,get:function get(){return _field_title_bar.FieldTitleBar}});var _field_title_bar=__webpack_require__(1453)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldTitleBar=FieldTitleBar;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _field_type_icon=__webpack_require__(497);var _field_types_utils=__webpack_require__(204);var _i18n=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function FieldTitleBar(_ref){var card=_ref.card;if(_typeof(card)!=="object"||card===null){return null}var fieldName=card.fieldName||_i18n.i18n.translate("xpack.ml.fieldTitleBar.documentCountLabel",{defaultMessage:"document count"});var cardTitleAriaLabel=[fieldName];var classNames=["ml-field-title-bar"];if(card.fieldName===undefined){classNames.push("document_count")}else if(card.isUnsupportedType===true){classNames.push("type-other")}else{classNames.push(card.type)}if(card.isUnsupportedType!==true){cardTitleAriaLabel.unshift((0,_field_types_utils.getMLJobTypeAriaLabel)(card.type))}return _react.default.createElement(_eui.EuiText,{className:classNames.join(" ")},_react.default.createElement(_field_type_icon.FieldTypeIcon,{type:card.type,tooltipEnabled:true,needsAria:false}),_react.default.createElement(_eui.EuiToolTip,{position:"left",content:fieldName},_react.default.createElement("div",{className:"field-name",tabIndex:"0","aria-label":"".concat(cardTitleAriaLabel.join(", "))},fieldName)))}FieldTitleBar.propTypes={card:_propTypes.default.object.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldTypeIcon=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _field_types_utils=__webpack_require__(204);var _field_types=__webpack_require__(109);var _i18n=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}var FieldTypeIcon=function FieldTypeIcon(_ref){var _ref$tooltipEnabled=_ref.tooltipEnabled,tooltipEnabled=_ref$tooltipEnabled===void 0?false:_ref$tooltipEnabled,type=_ref.type,_ref$needsAria=_ref.needsAria,needsAria=_ref$needsAria===void 0?true:_ref$needsAria;var ariaLabel=(0,_field_types_utils.getMLJobTypeAriaLabel)(type);if(ariaLabel===null){return null}var iconClass=["field-type-icon"];var iconChar="";switch(type){case _field_types.ML_JOB_FIELD_TYPES.BOOLEAN:iconClass.push("kuiIcon","fa-adjust");break;case _field_types.ML_JOB_FIELD_TYPES.DATE:iconClass.push("kuiIcon","fa-clock-o");break;case _field_types.ML_JOB_FIELD_TYPES.GEO_POINT:iconClass.push("kuiIcon","fa-globe");break;case _field_types.ML_JOB_FIELD_TYPES.TEXT:iconClass.push("kuiIcon","fa-file-text-o");break;case _field_types.ML_JOB_FIELD_TYPES.IP:iconClass.push("kuiIcon","fa-laptop");break;case _field_types.ML_JOB_FIELD_TYPES.KEYWORD:iconChar="t";break;case _field_types.ML_JOB_FIELD_TYPES.NUMBER:iconChar="#";break;case _field_types.ML_JOB_FIELD_TYPES.UNKNOWN:iconChar="?";break}var containerProps={ariaLabel:ariaLabel,className:iconClass.join(" "),iconChar:iconChar,needsAria:needsAria};if(tooltipEnabled===true){return _react.default.createElement(_eui.EuiToolTip,{position:"left",content:_i18n.i18n.translate("xpack.ml.fieldTypeIcon.fieldTypeTooltip",{defaultMessage:"{type} type",values:{type:type}})},_react.default.createElement(FieldTypeIconContainer,containerProps))}return _react.default.createElement(FieldTypeIconContainer,containerProps)};exports.FieldTypeIcon=FieldTypeIcon;FieldTypeIcon.propTypes={tooltipEnabled:_propTypes.default.bool,type:_propTypes.default.string};function FieldTypeIconContainer(_ref2){var ariaLabel=_ref2.ariaLabel,className=_ref2.className,iconChar=_ref2.iconChar,needsAria=_ref2.needsAria,rest=_objectWithoutProperties(_ref2,["ariaLabel","className","iconChar","needsAria"]);var wrapperProps={className:className};if(needsAria&&ariaLabel){wrapperProps["aria-label"]=ariaLabel}return _react.default.createElement("span",_extends({className:"field-type-icon-container"},rest),iconChar===""?_react.default.createElement("span",wrapperProps):_react.default.createElement("span",wrapperProps,_react.default.createElement("strong",{"aria-hidden":"true"},iconChar)))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"BooleanContent",{enumerable:true,get:function get(){return _boolean_content.BooleanContent}});Object.defineProperty(exports,"DateContent",{enumerable:true,get:function get(){return _date_content.DateContent}});Object.defineProperty(exports,"DocumentCountContent",{enumerable:true,get:function get(){return _document_count_content.DocumentCountContent}});Object.defineProperty(exports,"GeoPointContent",{enumerable:true,get:function get(){return _geo_point_content.GeoPointContent}});Object.defineProperty(exports,"KeywordContent",{enumerable:true,get:function get(){return _keyword_content.KeywordContent}});Object.defineProperty(exports,"IpContent",{enumerable:true,get:function get(){return _ip_content.IpContent}});Object.defineProperty(exports,"NotInDocsContent",{enumerable:true,get:function get(){return _not_in_docs_content.NotInDocsContent}});Object.defineProperty(exports,"NumberContent",{enumerable:true,get:function get(){return _number_content.NumberContent}});Object.defineProperty(exports,"OtherContent",{enumerable:true,get:function get(){return _other_content.OtherContent}});Object.defineProperty(exports,"TextContent",{enumerable:true,get:function get(){return _text_content.TextContent}});var _boolean_content=__webpack_require__(1456);var _date_content=__webpack_require__(1457);var _document_count_content=__webpack_require__(1458);var _geo_point_content=__webpack_require__(1461);var _keyword_content=__webpack_require__(1463);var _ip_content=__webpack_require__(1465);var _not_in_docs_content=__webpack_require__(1466);var _number_content=__webpack_require__(1467);var _other_content=__webpack_require__(1474);var _text_content=__webpack_require__(1475)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BooleanContent=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _charts=__webpack_require__(37);var _react2=__webpack_require__(30);var _round_to_decimal_place=__webpack_require__(102);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getPercentLabel(value){if(value===0){return"0%"}if(value>=.1){return"".concat(value,"%")}else{return"< 0.1%"}}var BooleanContent=function BooleanContent(_ref){var config=_ref.config;var stats=config.stats;var count=stats.count,sampleCount=stats.sampleCount,trueCount=stats.trueCount,falseCount=stats.falseCount;var docsPercent=(0,_round_to_decimal_place.roundToDecimalPlace)(count/sampleCount*100);return _react.default.createElement("div",{className:"mlFieldDataCard__stats"},_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"document"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardBoolean.documentsCountDescription",defaultMessage:"{count, plural, zero {# document} one {# document} other {# documents}} ({docsPercent}%)",values:{count:count,docsPercent:docsPercent}}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement("div",null,_react.default.createElement(_eui.EuiTitle,{size:"xxxs",className:"mlFieldDataCard__valuesTitle"},_react.default.createElement("span",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardBoolean.valuesLabel",defaultMessage:"Values"}))),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement(_charts.Chart,{renderer:"canvas",className:"story-chart",size:{height:200}},_react.default.createElement(_charts.Axis,{id:"bottom",position:"bottom",showOverlappingTicks:true}),_react.default.createElement(_charts.Settings,{showLegend:false,theme:{barSeriesStyle:{displayValue:{fill:"#000",fontSize:12,fontStyle:"normal",offsetX:0,offsetY:-5,padding:0}}}}),_react.default.createElement(_charts.BarSeries,{id:config.fieldName||config.fieldFormat,data:[{x:"true",y:(0,_round_to_decimal_place.roundToDecimalPlace)(trueCount/count*100)},{x:"false",y:(0,_round_to_decimal_place.roundToDecimalPlace)(falseCount/count*100)}],displayValueSettings:{hideClippedValue:true,isAlternatingValueLabel:true,valueFormatter:getPercentLabel,isValueContainedInElement:false,showValueLabel:true},color:["rgba(230, 194, 32, 0.5)","rgba(224, 187, 20, 0.71)"],splitSeriesAccessors:["x"],stackAccessors:["x"],xAccessor:"x",xScaleType:"ordinal",yAccessors:["y"],yScaleType:"linear"}))))};exports.BooleanContent=BooleanContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DateContent=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _format=__webpack_require__(39);var _react2=__webpack_require__(30);var _round_to_decimal_place=__webpack_require__(102);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TIME_FORMAT="MMM D YYYY, HH:mm:ss.SSS";var DateContent=function DateContent(_ref){var config=_ref.config;var stats=config.stats;var count=stats.count,sampleCount=stats.sampleCount,earliest=stats.earliest,latest=stats.latest;var docsPercent=(0,_round_to_decimal_place.roundToDecimalPlace)(count/sampleCount*100);return _react.default.createElement("div",{className:"mlFieldDataCard__stats"},_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"document"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardDate.documentsCountDescription",defaultMessage:"{count, plural, zero {# document} one {# document} other {# documents}} ({docsPercent}%)",values:{count:count,docsPercent:docsPercent}}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement("div",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardDate.earliestDescription",defaultMessage:"earliest {earliestFormatted}",values:{earliestFormatted:(0,_format.formatDate)(earliest,TIME_FORMAT)}})),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("div",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardDate.latestDescription",defaultMessage:"latest {latestFormatted}",values:{latestFormatted:(0,_format.formatDate)(latest,TIME_FORMAT)}})))};exports.DateContent=DateContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DocumentCountContent=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _document_count_chart=__webpack_require__(1459);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var CHART_WIDTH=325;var CHART_HEIGHT=350;var DocumentCountContent=function DocumentCountContent(_ref){var config=_ref.config;var stats=config.stats;var documentCounts=stats.documentCounts,timeRangeEarliest=stats.timeRangeEarliest,timeRangeLatest=stats.timeRangeLatest;var chartPoints=[];if(documentCounts!==undefined&&documentCounts.buckets!==undefined){var buckets=stats.documentCounts.buckets;chartPoints=Object.entries(buckets).map((function(_ref2){var _ref3=_slicedToArray(_ref2,2),time=_ref3[0],value=_ref3[1];return{time:+time,value:value}}))}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_document_count_chart.DocumentCountChart,{width:CHART_WIDTH,height:CHART_HEIGHT,chartPoints:chartPoints,timeRangeEarliest:timeRangeEarliest,timeRangeLatest:timeRangeLatest}))),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"xs"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardDocumentCount.calculatedOverAllDocumentsLabel",defaultMessage:"Calculated over all documents"})))))};exports.DocumentCountContent=DocumentCountContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DocumentCountChart",{enumerable:true,get:function get(){return _document_count_chart.DocumentCountChart}});Object.defineProperty(exports,"DocumentCountChartPoint",{enumerable:true,get:function get(){return _document_count_chart.DocumentCountChartPoint}});var _document_count_chart=__webpack_require__(1460)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DocumentCountChart=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _charts=__webpack_require__(37);var _eui_theme_dark=_interopRequireDefault(__webpack_require__(42));var _eui_theme_light=_interopRequireDefault(__webpack_require__(40));var _use_ui_settings_context=__webpack_require__(150);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SPEC_ID="document_count";var DocumentCountChart=function DocumentCountChart(_ref){var width=_ref.width,height=_ref.height,chartPoints=_ref.chartPoints,timeRangeEarliest=_ref.timeRangeEarliest,timeRangeLatest=_ref.timeRangeLatest;var seriesName=_i18n.i18n.translate("xpack.ml.fieldDataCard.documentCountChart.seriesLabel",{defaultMessage:"document count"});var xDomain={min:timeRangeEarliest,max:timeRangeLatest};var dateFormatter=(0,_charts.niceTimeFormatter)([timeRangeEarliest,timeRangeLatest]);var IS_DARK_THEME=(0,_use_ui_settings_context.useUiSettings)().get("theme:darkMode");var themeName=IS_DARK_THEME?_eui_theme_dark.default:_eui_theme_light.default;var EVENT_RATE_COLOR=themeName.euiColorVis2;return _react.default.createElement("div",{style:{width:width,height:height}},_react.default.createElement(_charts.Chart,null,_react.default.createElement(_charts.Settings,{xDomain:xDomain,theme:{colors:{vizColors:[EVENT_RATE_COLOR]}}}),_react.default.createElement(_charts.Axis,{id:"bottom",position:_charts.Position.Bottom,showOverlappingTicks:true,tickFormat:dateFormatter}),_react.default.createElement(_charts.Axis,{id:"left",position:_charts.Position.Left}),_react.default.createElement(_charts.BarSeries,{id:SPEC_ID,name:seriesName,xScaleType:_charts.ScaleType.Time,yScaleType:_charts.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:chartPoints.length>0?chartPoints:[{time:timeRangeEarliest,value:0}]})))};exports.DocumentCountChart=DocumentCountChart},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GeoPointContent=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _round_to_decimal_place=__webpack_require__(102);var _examples_list=__webpack_require__(261);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var GeoPointContent=function GeoPointContent(_ref){var config=_ref.config;var stats=config.stats;var count=stats.count,sampleCount=stats.sampleCount,cardinality=stats.cardinality,examples=stats.examples;var docsPercent=(0,_round_to_decimal_place.roundToDecimalPlace)(count/sampleCount*100);return _react.default.createElement("div",{className:"mlFieldDataCard__stats"},_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"document"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardGeoPoint.documentsCountDescription",defaultMessage:"{count, plural, zero {# document} one {# document} other {# documents}} ({docsPercent}%)",values:{count:count,docsPercent:docsPercent}}))),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"database"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardGeoPoint.distinctCountDescription",defaultMessage:"{cardinality} distinct {cardinality, plural, zero {value} one {value} other {values}}",values:{cardinality:cardinality}}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_examples_list.ExamplesList,{examples:examples}))};exports.GeoPointContent=GeoPointContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExamplesList=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ExamplesList=function ExamplesList(_ref){var examples=_ref.examples;if(examples===undefined||examples===null||examples.length===0){return null}var examplesContent=examples.map((function(example,i){return _react.default.createElement(_eui.EuiListGroupItem,{style:{padding:0,justifyContent:"center"},size:"xs",key:"example_".concat(i),label:typeof example==="string"?example:JSON.stringify(example)})}));return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiTitle,{size:"xxxs",className:"mlFieldDataCard__valuesTitle"},_react.default.createElement("span",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardText.examplesTitle",defaultMessage:"{numExamples, plural, one {value} other {examples}}",values:{numExamples:examples.length}}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiListGroup,{flush:true,showToolTips:true},examplesContent))};exports.ExamplesList=ExamplesList},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.KeywordContent=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _round_to_decimal_place=__webpack_require__(102);var _top_values=__webpack_require__(262);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var KeywordContent=function KeywordContent(_ref){var config=_ref.config;var stats=config.stats,fieldFormat=config.fieldFormat;var count=stats.count,sampleCount=stats.sampleCount,cardinality=stats.cardinality;var docsPercent=(0,_round_to_decimal_place.roundToDecimalPlace)(count/sampleCount*100);return _react.default.createElement("div",{className:"mlFieldDataCard__stats"},_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"document"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardKeyword.documentsCountDescription",defaultMessage:"{count, plural, zero {# document} one {# document} other {# documents}} ({docsPercent}%)",values:{count:count,docsPercent:docsPercent}}))),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"database"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardKeyword.distinctCountDescription",defaultMessage:"{cardinality} distinct {cardinality, plural, zero {value} one {value} other {values}}",values:{cardinality:cardinality}}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement("div",null,_react.default.createElement(_eui.EuiTitle,{size:"xxxs",className:"mlFieldDataCard__valuesTitle"},_react.default.createElement("span",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardKeyword.topValuesLabel",defaultMessage:"Top values"}))),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement(_top_values.TopValues,{stats:stats,fieldFormat:fieldFormat,barColor:"secondary"})))};exports.KeywordContent=KeywordContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TopValues=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _kibana_field_format=__webpack_require__(205);var _round_to_decimal_place=__webpack_require__(102);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function getPercentLabel(docCount,topValuesSampleSize){var percent=100*docCount/topValuesSampleSize;if(percent>=.1){return"".concat((0,_round_to_decimal_place.roundToDecimalPlace)(percent,1),"%")}else{return"< 0.1%"}}var TopValues=function TopValues(_ref){var stats=_ref.stats,fieldFormat=_ref.fieldFormat,barColor=_ref.barColor;var topValues=stats.topValues,topValuesSampleSize=stats.topValuesSampleSize,topValuesSamplerShardSize=stats.topValuesSamplerShardSize,count=stats.count,isTopValuesSampled=stats.isTopValuesSampled;var progressBarMax=isTopValuesSampled===true?topValuesSampleSize:count;return _react.default.createElement(_react.Fragment,null,topValues.map((function(value){return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",key:value.key},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:100},className:"eui-textTruncate"},_react.default.createElement(_eui.EuiToolTip,{content:(0,_kibana_field_format.kibanaFieldFormat)(value.key,fieldFormat),position:"right"},_react.default.createElement(_eui.EuiText,{size:"xs",textAlign:"right",color:"subdued"},(0,_kibana_field_format.kibanaFieldFormat)(value.key,fieldFormat)))),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiProgress,{value:value.doc_count,max:progressBarMax,color:barColor,size:"m"})),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:70},className:"eui-textTruncate"},_react.default.createElement(_eui.EuiText,{size:"xs",textAlign:"left",color:"subdued"},getPercentLabel(value.doc_count,progressBarMax))))})),isTopValuesSampled===true&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.topValues.calculatedFromSampleDescription",defaultMessage:"Calculated from sample of {topValuesSamplerShardSize} documents per shard",values:{topValuesSamplerShardSize:topValuesSamplerShardSize}}))))};exports.TopValues=TopValues},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.IpContent=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _round_to_decimal_place=__webpack_require__(102);var _top_values=__webpack_require__(262);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var IpContent=function IpContent(_ref){var config=_ref.config;var stats=config.stats,fieldFormat=config.fieldFormat;var count=stats.count,sampleCount=stats.sampleCount,cardinality=stats.cardinality;var docsPercent=(0,_round_to_decimal_place.roundToDecimalPlace)(count/sampleCount*100);return _react.default.createElement("div",{className:"mlFieldDataCard__stats"},_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"document"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardIp.documentsCountDescription",defaultMessage:"{count, plural, zero {# document} one {# document} other {# documents}} ({docsPercent}%)",values:{count:count,docsPercent:docsPercent}}))),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"database"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardIp.distinctCountDescription",defaultMessage:"{cardinality} distinct {cardinality, plural, zero {value} one {value} other {values}}",values:{cardinality:cardinality}}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement("div",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardIp.topValuesLabel",defaultMessage:"top values"}),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement(_top_values.TopValues,{stats:stats,fieldFormat:fieldFormat,barColor:"primary"})))};exports.IpContent=IpContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NotInDocsContent=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var NotInDocsContent=function NotInDocsContent(){return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}),_react.default.createElement(_eui.EuiText,{textAlign:"center"},_react.default.createElement(_eui.EuiIcon,{type:"alert"})),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiText,{textAlign:"center"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.fieldNotInDocsLabel",defaultMessage:"This field does not appear in any documents for the selected time range"})))};exports.NotInDocsContent=NotInDocsContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NumberContent=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _display_value=__webpack_require__(498);var _kibana_field_format=__webpack_require__(205);var _number_as_ordinal=__webpack_require__(1469);var _round_to_decimal_place=__webpack_require__(102);var _metric_distribution_chart=__webpack_require__(1470);var _top_values=__webpack_require__(262);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var DETAILS_MODE;(function(DETAILS_MODE){DETAILS_MODE["DISTRIBUTION"]="distribution";DETAILS_MODE["TOP_VALUES"]="top_values"})(DETAILS_MODE||(DETAILS_MODE={}));var METRIC_DISTRIBUTION_CHART_WIDTH=325;var METRIC_DISTRIBUTION_CHART_HEIGHT=210;var DEFAULT_TOP_VALUES_THRESHOLD=100;var NumberContent=function NumberContent(_ref){var config=_ref.config;var stats=config.stats,fieldFormat=config.fieldFormat;(0,_react.useEffect)((function(){var chartData=(0,_metric_distribution_chart.buildChartDataFromStats)(stats,METRIC_DISTRIBUTION_CHART_WIDTH);setDistributionChartData(chartData)}),[]);var count=stats.count,sampleCount=stats.sampleCount,cardinality=stats.cardinality,min=stats.min,median=stats.median,max=stats.max,distribution=stats.distribution;var docsPercent=(0,_round_to_decimal_place.roundToDecimalPlace)(count/sampleCount*100);var _useState=(0,_react.useState)(cardinality<=DEFAULT_TOP_VALUES_THRESHOLD?DETAILS_MODE.TOP_VALUES:DETAILS_MODE.DISTRIBUTION),_useState2=_slicedToArray(_useState,2),detailsMode=_useState2[0],setDetailsMode=_useState2[1];var defaultChartData=[];var _useState3=(0,_react.useState)(defaultChartData),_useState4=_slicedToArray(_useState3,2),distributionChartData=_useState4[0],setDistributionChartData=_useState4[1];var detailsOptions=[{id:DETAILS_MODE.TOP_VALUES,label:_i18n.i18n.translate("xpack.ml.fieldDataCard.cardNumber.details.topValuesLabel",{defaultMessage:"Top values"})},{id:DETAILS_MODE.DISTRIBUTION,label:_i18n.i18n.translate("xpack.ml.fieldDataCard.cardNumber.details.distributionOfValuesLabel",{defaultMessage:"Distribution"})}];return _react.default.createElement("div",{className:"mlFieldDataCard__stats"},_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"document"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardNumber.documentsCountDescription",defaultMessage:"{count, plural, zero {# document} one {# document} other {# documents}} ({docsPercent}%)",values:{count:count,docsPercent:docsPercent}}))),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"database"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardNumber.distinctCountDescription",defaultMessage:"{cardinality} distinct {cardinality, plural, zero {value} one {value} other {values}}",values:{cardinality:cardinality}}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs",justifyContent:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:1},_react.default.createElement(_eui.EuiText,{color:"subdued",size:"xs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardNumber.minLabel",defaultMessage:"min"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:1},_react.default.createElement(_eui.EuiText,{color:"subdued",size:"xs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardNumber.medianLabel",defaultMessage:"median"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:1},_react.default.createElement(_eui.EuiText,{color:"subdued",size:"xs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardNumber.maxLabel",defaultMessage:"max"})))),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs",justifyContent:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:1,className:"eui-textTruncate"},_react.default.createElement(_display_value.DisplayValue,{value:(0,_kibana_field_format.kibanaFieldFormat)(min,fieldFormat)})),_react.default.createElement(_eui.EuiFlexItem,{grow:1,className:"eui-textTruncate"},_react.default.createElement(_display_value.DisplayValue,{value:(0,_kibana_field_format.kibanaFieldFormat)(median,fieldFormat)})),_react.default.createElement(_eui.EuiFlexItem,{grow:1,className:"eui-textTruncate"},_react.default.createElement(_display_value.DisplayValue,{value:(0,_kibana_field_format.kibanaFieldFormat)(max,fieldFormat)}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiButtonGroup,{options:detailsOptions,idSelected:detailsMode,onChange:function onChange(optionId){return setDetailsMode(optionId)},"aria-label":_i18n.i18n.translate("xpack.ml.fieldDataCard.cardNumber.selectMetricDetailsDisplayAriaLabel",{defaultMessage:"Select display option for metric details"}),"data-test-subj":"mlFieldDataCardNumberDetailsSelect",isFullWidth:true,buttonSize:"compressed"}),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),distribution&&detailsMode===DETAILS_MODE.DISTRIBUTION&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"xs"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardNumber.displayingPercentilesLabel",defaultMessage:"Displaying {minPercent} - {maxPercent} percentiles",values:{minPercent:(0,_number_as_ordinal.numberAsOrdinal)(distribution.minPercentile),maxPercent:(0,_number_as_ordinal.numberAsOrdinal)(distribution.maxPercentile)}})))),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"center",gutterSize:"xs"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_metric_distribution_chart.MetricDistributionChart,{width:METRIC_DISTRIBUTION_CHART_WIDTH,height:METRIC_DISTRIBUTION_CHART_HEIGHT,chartData:distributionChartData,fieldFormat:fieldFormat})))),detailsMode===DETAILS_MODE.TOP_VALUES&&_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_top_values.TopValues,{stats:stats,fieldFormat:fieldFormat,barColor:"primary"}))))};exports.NumberContent=NumberContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DisplayValue=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var MAX_CHARS=12;var DisplayValue=function DisplayValue(_ref){var value=_ref.value;var length=String(value).length;if(length<=MAX_CHARS){return _react.default.createElement("b",null,value)}else{return _react.default.createElement(_eui.EuiToolTip,{content:value,anchorClassName:"valueWrapper"},_react.default.createElement("b",null,value))}};exports.DisplayValue=DisplayValue},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.numberAsOrdinal=numberAsOrdinal;var _numeral=_interopRequireDefault(__webpack_require__(124));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function numberAsOrdinal(num){var int=Math.floor(num);return"".concat((0,_numeral.default)(int).format("0o"))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"MetricDistributionChart",{enumerable:true,get:function get(){return _metric_distribution_chart.MetricDistributionChart}});Object.defineProperty(exports,"MetricDistributionChartData",{enumerable:true,get:function get(){return _metric_distribution_chart.MetricDistributionChartData}});Object.defineProperty(exports,"buildChartDataFromStats",{enumerable:true,get:function get(){return _metric_distribution_chart_data_builder.buildChartDataFromStats}});var _metric_distribution_chart=__webpack_require__(1471);var _metric_distribution_chart_data_builder=__webpack_require__(1473)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MetricDistributionChart=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _charts=__webpack_require__(37);var _eui_theme_dark=_interopRequireDefault(__webpack_require__(42));var _eui_theme_light=_interopRequireDefault(__webpack_require__(40));var _metric_distribution_chart_tooltip_header=__webpack_require__(1472);var _use_ui_settings_context=__webpack_require__(150);var _kibana_field_format=__webpack_require__(205);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SPEC_ID="metric_distribution";var MetricDistributionChart=function MetricDistributionChart(_ref){var width=_ref.width,height=_ref.height,chartData=_ref.chartData,fieldFormat=_ref.fieldFormat;var seriesName=_i18n.i18n.translate("xpack.ml.fieldDataCard.metricDistributionChart.seriesName",{defaultMessage:"distribution"});var IS_DARK_THEME=(0,_use_ui_settings_context.useUiSettings)().get("theme:darkMode");var themeName=IS_DARK_THEME?_eui_theme_dark.default:_eui_theme_light.default;var AREA_SERIES_COLOR=themeName.euiColorVis1;var headerFormatter=function headerFormatter(tooltipData){var xValue=tooltipData.value;var chartPoint=chartData.find((function(data){return data.x===xValue}));return _react.default.createElement(_metric_distribution_chart_tooltip_header.MetricDistributionChartTooltipHeader,{chartPoint:chartPoint,maxWidth:width/2,fieldFormat:fieldFormat})};return _react.default.createElement("div",{style:{width:width,height:height}},_react.default.createElement(_charts.Chart,null,_react.default.createElement(_charts.Settings,{theme:{colors:{vizColors:[AREA_SERIES_COLOR]},areaSeriesStyle:{line:{strokeWidth:1,visible:true},point:{visible:false,radius:0,opacity:0},area:{visible:true,opacity:1}}},tooltip:{headerFormatter:headerFormatter}}),_react.default.createElement(_charts.Axis,{id:"bottom",position:_charts.Position.Bottom,tickFormat:function tickFormat(d){return(0,_kibana_field_format.kibanaFieldFormat)(d,fieldFormat)}}),_react.default.createElement(_charts.Axis,{id:"left",position:_charts.Position.Left,tickFormat:function tickFormat(d){return d.toFixed(3)},hide:true}),_react.default.createElement(_charts.AreaSeries,{id:SPEC_ID,name:seriesName,xScaleType:_charts.ScaleType.Linear,yScaleType:_charts.ScaleType.Linear,xAccessor:"x",yAccessors:["y"],data:chartData.length>0?chartData:[{x:0,y:0}],curve:_charts.CurveType.CURVE_STEP_AFTER})))};exports.MetricDistributionChart=MetricDistributionChart},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MetricDistributionChartTooltipHeader=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _kibana_field_format=__webpack_require__(205);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var MetricDistributionChartTooltipHeader=function MetricDistributionChartTooltipHeader(_ref){var chartPoint=_ref.chartPoint,maxWidth=_ref.maxWidth,fieldFormat=_ref.fieldFormat;if(chartPoint===undefined){return null}return _react.default.createElement("div",{style:{maxWidth:maxWidth}},chartPoint.dataMax>chartPoint.dataMin?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.metricDistributionChart.tooltipValueBetweenLabel",defaultMessage:"{percent}% of documents have values between {minValFormatted} and {maxValFormatted}",values:{percent:chartPoint.percent,minValFormatted:(0,_kibana_field_format.kibanaFieldFormat)(chartPoint.dataMin,fieldFormat),maxValFormatted:(0,_kibana_field_format.kibanaFieldFormat)(chartPoint.dataMax,fieldFormat)}}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.metricDistributionChart.tooltipValueEqualLabel",defaultMessage:"{percent}% of documents have a value of {valFormatted}",values:{percent:chartPoint.percent,valFormatted:(0,_kibana_field_format.kibanaFieldFormat)(chartPoint.dataMin,fieldFormat)}}))};exports.MetricDistributionChartTooltipHeader=MetricDistributionChartTooltipHeader},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buildChartDataFromStats=buildChartDataFromStats;var METRIC_DISTRIBUTION_CHART_MIN_BAR_WIDTH=3;var METRIC_DISTRIBUTION_CHART_MAX_BAR_HEIGHT_FACTOR=20;function buildChartDataFromStats(stats,chartWidth){var chartData=[];var distribution=stats.distribution;if(distribution===undefined){return chartData}var percentiles=distribution.percentiles;if(percentiles.length===0){return chartData}var minX=percentiles[0].minValue;var maxX=percentiles[percentiles.length-1].maxValue;var xAxisMin=minX;var xAxisMax=maxX;if(maxX===minX){if(minX!==0){xAxisMin=0;xAxisMax=2*minX}else{xAxisMax=1}}var minBarWidth=METRIC_DISTRIBUTION_CHART_MIN_BAR_WIDTH/chartWidth*(xAxisMax-xAxisMin);var processedData=[];var lastBar;percentiles.forEach((function(data,index){if(index===0){var bar={x0:data.minValue,x1:Math.max(data.minValue+minBarWidth,data.maxValue),y:0,dataMin:data.minValue,dataMax:data.maxValue,percent:data.percent,isMinWidth:false};bar.y=data.percent/(bar.x1-bar.x0)*Math.max(1,minBarWidth/Math.max(data.maxValue-data.minValue,.5*minBarWidth));bar.isMinWidth=data.maxValue<=data.minValue+minBarWidth;processedData.push(bar);lastBar=bar}else{if(lastBar.isMinWidth===false||data.maxValue>lastBar.x1){var _bar={x0:lastBar.x1,x1:Math.max(lastBar.x1+minBarWidth,data.maxValue),y:0,dataMin:data.minValue,dataMax:data.maxValue,percent:data.percent,isMinWidth:false};_bar.y=data.percent/(_bar.x1-_bar.x0)*Math.max(1,minBarWidth/Math.max(data.maxValue-data.minValue,.5*minBarWidth));_bar.isMinWidth=data.maxValue<=lastBar.x1+minBarWidth;processedData.push(_bar);lastBar=_bar}else{lastBar.percent=lastBar.percent+data.percent;lastBar.y=lastBar.percent/(lastBar.x1-lastBar.x0);lastBar.dataMax=data.maxValue}}}));if(maxX!==minX){xAxisMax=processedData[processedData.length-1].x1}var barHeights=processedData.map((function(data){return data.y}));barHeights=barHeights.sort((function(a,b){return a-b}));var maxBarHeight=0;var processedDataLength=processedData.length;if(Math.abs(processedDataLength%2)===1){maxBarHeight=METRIC_DISTRIBUTION_CHART_MAX_BAR_HEIGHT_FACTOR*barHeights[Math.floor(processedDataLength/2)]}else{maxBarHeight=METRIC_DISTRIBUTION_CHART_MAX_BAR_HEIGHT_FACTOR*(barHeights[Math.floor(processedDataLength/2)-1]+barHeights[Math.floor(processedDataLength/2)])/2}processedData.forEach((function(data){data.y=Math.min(data.y,maxBarHeight)}));chartData=processedData.map((function(data){var x0=data.x0,y=data.y,dataMin=data.dataMin,dataMax=data.dataMax,percent=data.percent;return{x:x0,y:y,dataMin:dataMin,dataMax:dataMax,percent:percent}}));var last=processedData[processedData.length-1];chartData.push({x:last.x1,y:0,dataMin:last.dataMin,dataMax:last.dataMax,percent:last.percent});return chartData}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.OtherContent=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _round_to_decimal_place=__webpack_require__(102);var _examples_list=__webpack_require__(261);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var OtherContent=function OtherContent(_ref){var config=_ref.config;var stats=config.stats,type=config.type,aggregatable=config.aggregatable;var count=stats.count,sampleCount=stats.sampleCount,cardinality=stats.cardinality,examples=stats.examples;var docsPercent=(0,_round_to_decimal_place.roundToDecimalPlace)(count/sampleCount*100);return _react.default.createElement("div",{className:"mlFieldDataCard__stats"},_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardOther.cardTypeLabel",defaultMessage:"{cardType} type",values:{cardType:type}}))),aggregatable===true&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"document"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardOther.documentsCountDescription",defaultMessage:"{count, plural, zero {# document} one {# document} other {# documents}} ({docsPercent}%)",values:{count:count,docsPercent:docsPercent}}))),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_eui.EuiIcon,{type:"database"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardOther.distinctCountDescription",defaultMessage:"{cardinality} distinct {cardinality, plural, zero {value} one {value} other {values}}",values:{cardinality:cardinality}})))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_examples_list.ExamplesList,{examples:examples}))};exports.OtherContent=OtherContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TextContent=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _examples_list=__webpack_require__(261);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var TextContent=function TextContent(_ref){var config=_ref.config;var stats=config.stats;var examples=stats.examples;var numExamples=examples.length;return _react.default.createElement("div",{className:"mlFieldDataCard__stats"},numExamples>0&&_react.default.createElement(_examples_list.ExamplesList,{examples:examples}),numExamples===0&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.fieldDataCard.cardText.noExamplesForFieldsTitle",{defaultMessage:"No examples were obtained for this field"}),iconType:"alert"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardText.fieldNotPresentDescription",defaultMessage:"This field was not present in the {sourceParam} field of documents queried.",values:{sourceParam:_react.default.createElement("span",{className:"mlFieldDataCard__codeContent"},"_source")}}),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardText.fieldMayBePopulatedDescription",defaultMessage:"It may be populated, for example, using a {copyToParam} parameter in the document mapping, or be pruned from the {sourceParam} field after indexing through the use of {includesParam} and {excludesParam} parameters.",values:{copyToParam:_react.default.createElement("span",{className:"mlFieldDataCard__codeContent"},"copy_to"),sourceParam:_react.default.createElement("span",{className:"mlFieldDataCard__codeContent"},"_source"),includesParam:_react.default.createElement("span",{className:"mlFieldDataCard__codeContent"},"includes"),excludesParam:_react.default.createElement("span",{className:"mlFieldDataCard__codeContent"},"excludes")}}))))};exports.TextContent=TextContent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"LoadingIndicator",{enumerable:true,get:function get(){return _loading_indicator.LoadingIndicator}});var _loading_indicator=__webpack_require__(1477)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LoadingIndicator=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var LoadingIndicator=function LoadingIndicator(){return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiLoadingSpinner,{size:"l"}))),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fieldDataCard.loadingLabel",defaultMessage:"Loading"})))))};exports.LoadingIndicator=LoadingIndicator},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FieldTypesSelect",{enumerable:true,get:function get(){return _field_types_select.FieldTypesSelect}});var _field_types_select=__webpack_require__(1479)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldTypesSelect=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FieldTypesSelect=function FieldTypesSelect(_ref){var fieldTypes=_ref.fieldTypes,selectedFieldType=_ref.selectedFieldType,setSelectedFieldType=_ref.setSelectedFieldType;var options=[{value:"*",text:_i18n.i18n.translate("xpack.ml.datavisualizer.fieldTypesSelect.allFieldsTypeOptionLabel",{defaultMessage:"All field types"})}];fieldTypes.forEach((function(fieldType){options.push({value:fieldType,text:_i18n.i18n.translate("xpack.ml.datavisualizer.fieldTypesSelect.typeOptionLabel",{defaultMessage:"{fieldType} types",values:{fieldType:fieldType}})})}));return _react.default.createElement(_eui.EuiSelect,{options:options,value:selectedFieldType,onChange:function onChange(e){return setSelectedFieldType(e.target.value)},"aria-label":_i18n.i18n.translate("xpack.ml.datavisualizer.fieldTypesSelect.selectAriaLabel",{defaultMessage:"Select field types to display"}),"data-test-subj":"mlDataVisualizerFieldTypesSelect"})};exports.FieldTypesSelect=FieldTypesSelect},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"SearchPanel",{enumerable:true,get:function get(){return _search_panel.SearchPanel}});var _search_panel=__webpack_require__(1481)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SearchPanel=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _search=__webpack_require__(99);var _public=__webpack_require__(63);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var searchSizeOptions=[1e3,5e3,1e4,1e5,-1].map((function(v){return{value:String(v),inputDisplay:v>0?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.searchPanel.sampleSizeOptionLabel",defaultMessage:"Sample size (per shard): {wrappedValue}",values:{wrappedValue:_react.default.createElement("b",null,v)}}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.searchPanel.allOptionLabel",defaultMessage:"Search all"})}}));var SearchPanel=function SearchPanel(_ref){var indexPattern=_ref.indexPattern,searchString=_ref.searchString,setSearchString=_ref.setSearchString,searchQuery=_ref.searchQuery,setSearchQuery=_ref.setSearchQuery,searchQueryLanguage=_ref.searchQueryLanguage,setSearchQueryLanguage=_ref.setSearchQueryLanguage,samplerShardSize=_ref.samplerShardSize,setSamplerShardSize=_ref.setSamplerShardSize,totalCount=_ref.totalCount;var _useState=(0,_react.useState)({query:searchString||"",language:searchQueryLanguage}),_useState2=_slicedToArray(_useState,2),searchInput=_useState2[0],setSearchInput=_useState2[1];var _useState3=(0,_react.useState)(undefined),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];var searchHandler=function searchHandler(query){var filterQuery;try{if(query.language===_search.SEARCH_QUERY_LANGUAGE.KUERY){filterQuery=_public.esKuery.toElasticsearchQuery(_public.esKuery.fromKueryExpression(query.query),indexPattern)}else if(query.language===_search.SEARCH_QUERY_LANGUAGE.LUCENE){filterQuery=_public.esQuery.luceneStringToDsl(query.query)}else{filterQuery={}}setSearchQuery(filterQuery);setSearchString(query.query);setSearchQueryLanguage(query.language)}catch(e){console.log("Invalid syntax",JSON.stringify(e,null,2));setErrorMessage({query:query.query,message:e.message})}};var searchChangeHandler=function searchChangeHandler(query){return setSearchInput(query)};return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m",alignItems:"center","data-test-subj":"mlDataVisualizerSearchPanel"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:function closePopover(){return setErrorMessage(undefined)},input:_react.default.createElement(_public.QueryStringInput,{bubbleSubmitEvent:true,query:searchInput,indexPatterns:[indexPattern],onChange:searchChangeHandler,onSubmit:searchHandler,placeholder:_i18n.i18n.translate("xpack.ml.datavisualizer.searchPanel.queryBarPlaceholderText",{defaultMessage:'Search… (e.g. status:200 AND extension:"PHP")'}),disableAutoFocus:true,dataTestSubj:"transformQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown"}),isOpen:(errorMessage===null||errorMessage===void 0?void 0:errorMessage.query)===searchInput.query&&(errorMessage===null||errorMessage===void 0?void 0:errorMessage.message)!==""},_react.default.createElement(_eui.EuiCode,null,_i18n.i18n.translate("xpack.ml.datavisualizer.searchPanel.invalidKuerySyntaxErrorMessageQueryBar",{defaultMessage:"Invalid query"}),": ",errorMessage===null||errorMessage===void 0?void 0:errorMessage.message.split("\n")[0]))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:270}},_react.default.createElement(_eui.EuiSuperSelect,{options:searchSizeOptions,valueOfSelected:String(samplerShardSize),onChange:function onChange(value){return setSamplerShardSize(+value)},"aria-label":_i18n.i18n.translate("xpack.ml.datavisualizer.searchPanel.sampleSizeAriaLabel",{defaultMessage:"Select number of documents to sample"}),"data-test-subj":"mlDataVisualizerShardSizeSelect"})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIconTip,{content:_i18n.i18n.translate("xpack.ml.datavisualizer.searchPanel.queryBarPlaceholder",{defaultMessage:"Selecting a smaller sample size will reduce query run times and the load on the cluster."}),position:"right"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.datavisualizer.searchPanel.documentsPerShardLabel",defaultMessage:"Total documents: {wrappedTotalCount}",values:{wrappedTotalCount:_react.default.createElement("b",{"data-test-subj":"mlDataVisualizerTotalDocCount"},totalCount)}}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false}))};exports.SearchPanel=SearchPanel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DataLoader",{enumerable:true,get:function get(){return _data_loader.DataLoader}});var _data_loader=__webpack_require__(1483)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DataLoader=void 0;var _i18n=__webpack_require__(1);var _dependency_cache=__webpack_require__(5);var _ml_api_service=__webpack_require__(51);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var OMIT_FIELDS=["_source","_type","_index","_id","_version","_score"];var MAX_EXAMPLES_DEFAULT=10;var DataLoader=function(){function DataLoader(indexPattern,kibanaConfig){_classCallCheck(this,DataLoader);_defineProperty(this,"_indexPattern",void 0);_defineProperty(this,"_indexPatternTitle","");_defineProperty(this,"_maxExamples",MAX_EXAMPLES_DEFAULT);this._indexPattern=indexPattern;this._indexPatternTitle=indexPattern.title}_createClass(DataLoader,[{key:"loadOverallData",value:function(){var _loadOverallData=_asyncToGenerator(regeneratorRuntime.mark((function _callee(query,samplerShardSize,earliest,latest){var _this=this;var aggregatableFields,nonAggregatableFields,stats;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:aggregatableFields=[];nonAggregatableFields=[];this._indexPattern.fields.forEach((function(field){var fieldName=field.displayName!==undefined?field.displayName:field.name;if(_this.isDisplayField(fieldName)===true){if(field.aggregatable===true){aggregatableFields.push(fieldName)}else{nonAggregatableFields.push(fieldName)}}}));_context.next=5;return _ml_api_service.ml.getVisualizerOverallStats({indexPatternTitle:this._indexPatternTitle,query:query,timeFieldName:this._indexPattern.timeFieldName,samplerShardSize:samplerShardSize,earliest:earliest,latest:latest,aggregatableFields:aggregatableFields,nonAggregatableFields:nonAggregatableFields});case 5:stats=_context.sent;return _context.abrupt("return",stats);case 7:case"end":return _context.stop()}}}),_callee,this)})));function loadOverallData(_x,_x2,_x3,_x4){return _loadOverallData.apply(this,arguments)}return loadOverallData}()},{key:"loadFieldStats",value:function(){var _loadFieldStats=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(query,samplerShardSize,earliest,latest,fields,interval){var stats;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _ml_api_service.ml.getVisualizerFieldStats({indexPatternTitle:this._indexPatternTitle,query:query,timeFieldName:this._indexPattern.timeFieldName,earliest:earliest,latest:latest,samplerShardSize:samplerShardSize,interval:interval,fields:fields,maxExamples:this._maxExamples});case 2:stats=_context2.sent;return _context2.abrupt("return",stats);case 4:case"end":return _context2.stop()}}}),_callee2,this)})));function loadFieldStats(_x5,_x6,_x7,_x8,_x9,_x10){return _loadFieldStats.apply(this,arguments)}return loadFieldStats}()},{key:"displayError",value:function displayError(err){var toastNotifications=(0,_dependency_cache.getToastNotifications)();if(err.statusCode===500){toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.datavisualizer.dataLoader.internalServerErrorMessage",{defaultMessage:"Error loading data in index {index}. {message}. "+"The request may have timed out. Try using a smaller sample size or narrowing the time range.",values:{index:this._indexPattern.title,message:err.message}}))}else{toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.datavisualizer.page.errorLoadingDataMessage",{defaultMessage:"Error loading data in index {index}. {message}",values:{index:this._indexPattern.title,message:err.message}}))}}},{key:"isDisplayField",value:function isDisplayField(fieldName){return!OMIT_FIELDS.includes(fieldName)}},{key:"maxExamples",set:function set(max){this._maxExamples=max},get:function get(){return this._maxExamples}}]);return DataLoader}();exports.DataLoader=DataLoader},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fileBasedRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _file_based=__webpack_require__(1485);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _index_utils=__webpack_require__(70);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.DATA_VISUALIZER_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.dataVisualizer.fileBasedLabel",{defaultMessage:"File"}),href:""}];var fileBasedRoute={path:"/filedatavisualizer",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.fileBasedRoute=fileBasedRoute;var PageWrapper=function PageWrapper(_ref){var location=_ref.location,deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)("",undefined,deps.config,{checkBasicLicense:_license.checkBasicLicense,loadIndexPatterns:function loadIndexPatterns(){return(0,_index_utils.loadIndexPatterns)(deps.indexPatterns)},checkFindFileStructurePrivilege:_check_privilege.checkFindFileStructurePrivilege}),context=_useResolver.context;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_file_based.FileDataVisualizerPage,{kibanaConfig:deps.config}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FileDataVisualizerPage",{enumerable:true,get:function get(){return _file_datavisualizer.FileDataVisualizerPage}});var _file_datavisualizer=__webpack_require__(1486)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FileDataVisualizerPage=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _kibana=__webpack_require__(57);var _navigation_menu=__webpack_require__(82);var _index_utils=__webpack_require__(70);var _index=__webpack_require__(1487);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var FileDataVisualizerPage=function FileDataVisualizerPage(_ref){var kibanaConfig=_ref.kibanaConfig;(0,_kibana.useTimefilter)({timeRangeSelector:false,autoRefreshSelector:false});var indexPatterns=(0,_index_utils.getIndexPatternsContract)();return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"datavisualizer"}),_react.default.createElement(_index.FileDataVisualizerView,{indexPatterns:indexPatterns,kibanaConfig:kibanaConfig}))};exports.FileDataVisualizerPage=FileDataVisualizerPage},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FileDataVisualizerView",{enumerable:true,get:function get(){return _file_datavisualizer_view.FileDataVisualizerView}});var _file_datavisualizer_view=__webpack_require__(1488)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FileDataVisualizerView=void 0;var _react=__webpack_require__(30);var _react2=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _lodash=__webpack_require__(49);var _ml_api_service=__webpack_require__(51);var _about_panel=__webpack_require__(1489);var _bottom_bar=__webpack_require__(1493);var _results_view=__webpack_require__(1495);var _file_error_callouts=__webpack_require__(1505);var _edit_flyout=__webpack_require__(1506);var _import_view=__webpack_require__(1512);var _file_datavisualizer=__webpack_require__(1534);var _errors=__webpack_require__(388);var _utils=__webpack_require__(504);var _constants=__webpack_require__(500);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var UPLOAD_SIZE_MB=5;var FileDataVisualizerView=function(_Component){_inherits(FileDataVisualizerView,_Component);function FileDataVisualizerView(props){var _this;_classCallCheck(this,FileDataVisualizerView);_this=_possibleConstructorReturn(this,_getPrototypeOf(FileDataVisualizerView).call(this,props));_defineProperty(_assertThisInitialized(_this),"onFilePickerChange",(function(files){_this.overrides={};_this.setState({loading:files.length>0,bottomBarVisible:files.length>0,loaded:false,fileName:"",fileContents:"",fileSize:0,fileTooLarge:false,fileCouldNotBeRead:false,serverErrorMessage:"",results:undefined},(function(){if(files.length){_this.loadFile(files[0])}}))}));_defineProperty(_assertThisInitialized(_this),"closeEditFlyout",(function(){_this.setState({isEditFlyoutVisible:false});_this.showBottomBar()}));_defineProperty(_assertThisInitialized(_this),"showEditFlyout",(function(){_this.setState({isEditFlyoutVisible:true});_this.hideBottomBar()}));_defineProperty(_assertThisInitialized(_this),"showBottomBar",(function(){_this.setState({bottomBarVisible:true})}));_defineProperty(_assertThisInitialized(_this),"hideBottomBar",(function(){_this.setState({bottomBarVisible:false})}));_defineProperty(_assertThisInitialized(_this),"setOverrides",(function(overrides){console.log("setOverrides",overrides);_this.setState({loading:true,loaded:false},(function(){var formattedOverrides=(0,_utils.createUrlOverrides)(overrides,_this.originalSettings);_this.loadSettings(_this.state.fileContents,formattedOverrides)}))}));_defineProperty(_assertThisInitialized(_this),"changeMode",(function(mode){_this.setState({mode:mode})}));_defineProperty(_assertThisInitialized(_this),"onCancel",(function(){_this.changeMode(_constants.MODE.READ);_this.onFilePickerChange([])}));_this.state={files:{},fileName:"",fileContents:"",fileSize:0,fileTooLarge:false,fileCouldNotBeRead:false,serverErrorMessage:"",loading:false,loaded:false,results:undefined,mode:_constants.MODE.READ,isEditFlyoutVisible:false,bottomBarVisible:false,hasPermissionToImport:false};_this.overrides={};_this.previousOverrides={};_this.originalSettings={};return _this}_createClass(FileDataVisualizerView,[{key:"componentDidMount",value:function(){var _componentDidMount=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var hasPermissionToImport;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return(0,_utils.hasImportPermission)();case 2:hasPermissionToImport=_context.sent;this.setState({hasPermissionToImport:hasPermissionToImport});case 4:case"end":return _context.stop()}}}),_callee,this)})));function componentDidMount(){return _componentDidMount.apply(this,arguments)}return componentDidMount}()},{key:"loadFile",value:function(){var _loadFile=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(file){var fileContents,data;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(file.size<=_file_datavisualizer.MAX_BYTES)){_context2.next=17;break}_context2.prev=1;_context2.next=4;return(0,_utils.readFile)(file);case 4:fileContents=_context2.sent;data=fileContents.data;this.setState({fileContents:data,fileName:file.name,fileSize:file.size});_context2.next=9;return this.loadSettings(data);case 9:_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2["catch"](1);console.error(_context2.t0);this.setState({loaded:false,loading:false,fileCouldNotBeRead:true});case 15:_context2.next=18;break;case 17:this.setState({loaded:false,loading:false,fileTooLarge:true,fileName:file.name,fileSize:file.size});case 18:case"end":return _context2.stop()}}}),_callee2,this,[[1,11]])})));function loadFile(_x){return _loadFile.apply(this,arguments)}return loadFile}()},{key:"loadSettings",value:function(){var _loadSettings=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(data,overrides){var _this2=this;var isRetry,lessData,analyzeFile,resp,serverSettings,serverOverrides,serverErrorMsg,_args3=arguments;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:isRetry=_args3.length>2&&_args3[2]!==undefined?_args3[2]:false;_context3.prev=1;lessData=(0,_utils.reduceData)(data,UPLOAD_SIZE_MB);console.log("overrides",overrides);analyzeFile=_ml_api_service.ml.fileDatavisualizer.analyzeFile;_context3.next=7;return analyzeFile(lessData,overrides);case 7:resp=_context3.sent;serverSettings=(0,_utils.processResults)(resp.results);serverOverrides=resp.overrides;this.previousOverrides=this.overrides;this.overrides={};if(!(serverSettings.format==="xml")){_context3.next=14;break}throw{message:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileDatavisualizerView.xmlNotCurrentlySupportedErrorMessage",defaultMessage:"XML not currently supported"})};case 14:if(serverOverrides===undefined){this.originalSettings=serverSettings}else{Object.keys(serverOverrides).forEach((function(o){var camelCaseO=o.replace(/_\w/g,(function(m){return m[1].toUpperCase()}));_this2.overrides[camelCaseO]=serverOverrides[o]}));Object.keys(serverSettings).forEach((function(o){var value=serverSettings[o];if(_this2.overrides[o]===undefined&&(Array.isArray(value)&&(0,_lodash.isEqual)(value,_this2.originalSettings[o])===false||value!==_this2.originalSettings[o])){_this2.originalSettings[o]=value}}))}this.setState({results:resp.results,loaded:true,loading:false,fileCouldNotBeRead:isRetry});_context3.next=24;break;case 18:_context3.prev=18;_context3.t0=_context3["catch"](1);console.error(_context3.t0);if((0,_errors.isErrorResponse)(_context3.t0)===true){serverErrorMsg="".concat(_context3.t0.body.error,": ").concat(_context3.t0.body.message)}else{serverErrorMsg=JSON.stringify(_context3.t0,null,2)}this.setState({results:undefined,loaded:false,loading:false,fileCouldNotBeRead:true,serverErrorMessage:serverErrorMsg});if(overrides!==undefined&&(0,_lodash.isEqual)(this.previousOverrides,overrides)===false){this.setState({loading:true,loaded:false});this.loadSettings(data,this.previousOverrides,true)}case 24:case"end":return _context3.stop()}}}),_callee3,this,[[1,18]])})));function loadSettings(_x2,_x3){return _loadSettings.apply(this,arguments)}return loadSettings}()},{key:"render",value:function render(){var _this3=this;var _this$state=this.state,loading=_this$state.loading,loaded=_this$state.loaded,results=_this$state.results,fileContents=_this$state.fileContents,fileName=_this$state.fileName,fileSize=_this$state.fileSize,fileTooLarge=_this$state.fileTooLarge,fileCouldNotBeRead=_this$state.fileCouldNotBeRead,serverErrorMessage=_this$state.serverErrorMessage,mode=_this$state.mode,isEditFlyoutVisible=_this$state.isEditFlyoutVisible,bottomBarVisible=_this$state.bottomBarVisible,hasPermissionToImport=_this$state.hasPermissionToImport;var fields=results!==undefined&&results.field_stats!==undefined?Object.keys(results.field_stats):[];return _react2.default.createElement("div",null,mode===_constants.MODE.READ&&_react2.default.createElement(_react2.default.Fragment,null,!loading&&!loaded&&_react2.default.createElement(_about_panel.AboutPanel,{onFilePickerChange:this.onFilePickerChange}),loading&&_react2.default.createElement(_about_panel.LoadingPanel,null),fileTooLarge&&_react2.default.createElement(_file_error_callouts.FileTooLarge,{fileSize:fileSize,maxFileSize:_file_datavisualizer.MAX_BYTES}),fileCouldNotBeRead&&loading===false&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_file_error_callouts.FileCouldNotBeRead,{error:serverErrorMessage,loaded:loaded}),_react2.default.createElement(_eui.EuiSpacer,{size:"l"})),loaded&&_react2.default.createElement(_results_view.ResultsView,{results:results,fileName:fileName,data:fileContents,showEditFlyout:function showEditFlyout(){return _this3.showEditFlyout()}}),_react2.default.createElement(_edit_flyout.EditFlyout,{setOverrides:this.setOverrides,closeEditFlyout:this.closeEditFlyout,isFlyoutVisible:isEditFlyoutVisible,originalSettings:this.originalSettings,overrides:this.overrides,fields:fields}),bottomBarVisible&&loaded&&_react2.default.createElement(_bottom_bar.BottomBar,{mode:_constants.MODE.READ,onChangeMode:this.changeMode,onCancel:this.onCancel,disableImport:hasPermissionToImport===false}),_react2.default.createElement(BottomPadding,null)),mode===_constants.MODE.IMPORT&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_import_view.ImportView,{results:results,fileName:fileName,fileContents:fileContents,indexPatterns:this.props.indexPatterns,kibanaConfig:this.props.kibanaConfig,showBottomBar:this.showBottomBar,hideBottomBar:this.hideBottomBar}),bottomBarVisible&&_react2.default.createElement(_bottom_bar.BottomBar,{mode:_constants.MODE.IMPORT,onChangeMode:this.changeMode,onCancel:this.onCancel}),_react2.default.createElement(BottomPadding,null)))}}]);return FileDataVisualizerView}(_react2.Component);exports.FileDataVisualizerView=FileDataVisualizerView;function BottomPadding(){return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiSpacer,{size:"l"}),_react2.default.createElement(_eui.EuiSpacer,{size:"l"}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AboutPanel",{enumerable:true,get:function get(){return _about_panel.AboutPanel}});Object.defineProperty(exports,"LoadingPanel",{enumerable:true,get:function get(){return _about_panel.LoadingPanel}});var _about_panel=__webpack_require__(1490)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AboutPanel=AboutPanel;exports.LoadingPanel=LoadingPanel;var _i18n=__webpack_require__(1);var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _welcome_content=__webpack_require__(1491);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function AboutPanel(_ref){var onFilePickerChange=_ref.onFilePickerChange;return _react2.default.createElement(_eui.EuiPage,{restrictWidth:1e3,"data-test-subj":"mlPageFileDataVisualizerUpload"},_react2.default.createElement(_eui.EuiPageBody,null,_react2.default.createElement(_eui.EuiPageContent,{className:"file-datavisualizer-about-panel__content"},_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react2.default.createElement(_eui.EuiFlexItem,{grow:true},_react2.default.createElement(_welcome_content.WelcomeContent,null),_react2.default.createElement(_eui.EuiHorizontalRule,{margin:"l"}),_react2.default.createElement("div",{style:{textAlign:"center"}},_react2.default.createElement(_eui.EuiFilePicker,{id:"filePicker",initialPromptText:_i18n.i18n.translate("xpack.ml.fileDatavisualizer.aboutPanel.selectOrDragAndDropFileDescription",{defaultMessage:"Select or drag and drop a file"}),onChange:function onChange(files){return onFilePickerChange(files)},className:"file-datavisualizer-file-picker"})),_react2.default.createElement(_eui.EuiSpacer,{size:"l"}))))))}function LoadingPanel(){return _react2.default.createElement(_eui.EuiPage,{restrictWidth:400,"data-test-subj":"mlPageFileDataVisLoading"},_react2.default.createElement(_eui.EuiPageBody,null,_react2.default.createElement(_eui.EuiPageContent,{className:"file-datavisualizer-about-panel__content",paddingSize:"l"},_react2.default.createElement("div",{style:{textAlign:"center"}},_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h1",{role:"alert"},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.aboutPanel.analyzingDataTitle",defaultMessage:"Analyzing data"}))),_react2.default.createElement(_eui.EuiSpacer,{size:"l"}),_react2.default.createElement(_eui.EuiLoadingSpinner,{size:"xl"})))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WelcomeContent=WelcomeContent;var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _experimental_badge=__webpack_require__(499);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function WelcomeContent(){return _react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl",alignItems:"center"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiIcon,{size:"xxl",type:"addDataApp",className:"file-datavisualizer-about-panel__icon"})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiTitle,{size:"m"},_react2.default.createElement("h1",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.visualizeDataFromLogFileTitle",defaultMessage:"Visualize data from a log file {experimentalBadge}",values:{experimentalBadge:_react2.default.createElement(_experimental_badge.ExperimentalBadge,{tooltipContent:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.experimentalFeatureTooltip",defaultMessage:"Experimental feature. We'd love to hear your feedback."})})}}))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.visualizeDataFromLogFileDescription",defaultMessage:"The File Data Visualizer helps you understand the fields and metrics in a log file. Upload your file, analyze its data, and then choose whether to import the data into an Elasticsearch index."}))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.supportedFileFormatDescription",defaultMessage:"The File Data Visualizer supports these file formats:"}))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false,className:"file-datavisualizer-about-panel__doc-icon"},_react2.default.createElement(_eui.EuiIcon,{size:"m",type:"document"})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.delimitedTextFilesDescription",defaultMessage:"Delimited text files, such as CSV and TSV"}))))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false,className:"file-datavisualizer-about-panel__doc-icon"},_react2.default.createElement(_eui.EuiIcon,{size:"m",type:"document"})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.newlineDelimitedJsonDescription",defaultMessage:"Newline-delimited JSON"}))))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false,className:"file-datavisualizer-about-panel__doc-icon"},_react2.default.createElement(_eui.EuiIcon,{size:"m",type:"document"})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.logFilesWithCommonFormatDescription",defaultMessage:"Log files with a common format for the timestamp"}))))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.uploadedFilesAllowedSizeDescription",defaultMessage:"You can upload files up to 100 MB."}))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.welcomeContent.experimentalFeatureDescription",defaultMessage:"This feature is experimental. Got feedback? Please create an issue in {githubLink}.",values:{githubLink:_react2.default.createElement(_eui.EuiLink,{href:"https://github.com/elastic/kibana/issues/new/choose",target:"_blank"},"GitHub")}})))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExperimentalBadge=ExperimentalBadge;var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ExperimentalBadge(_ref){var tooltipContent=_ref.tooltipContent;return _react2.default.createElement("span",null,_react2.default.createElement(_eui.EuiBetaBadge,{className:"ml-experimental-badge",label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.experimentalBadge.experimentalLabel",defaultMessage:"Experimental"}),tooltipContent:tooltipContent}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"BottomBar",{enumerable:true,get:function get(){return _bottom_bar.BottomBar}});var _bottom_bar=__webpack_require__(1494)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BottomBar=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _constants=__webpack_require__(500);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var BottomBar=function BottomBar(_ref){var mode=_ref.mode,onChangeMode=_ref.onChangeMode,onCancel=_ref.onCancel,disableImport=_ref.disableImport;if(mode===_constants.MODE.READ){return _react.default.createElement(_eui.EuiBottomBar,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiToolTip,{position:"top",content:disableImport?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.bottomBar.missingImportPrivilegesMessage",defaultMessage:"You don't have the privileges required to import data"}):null},_react.default.createElement(_eui.EuiButton,{fill:true,isDisabled:disableImport,onClick:function onClick(){return onChangeMode(_constants.MODE.IMPORT)},"data-test-subj":"mlFileDataVisOpenImportPageButton"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.bottomBar.readMode.importButtonLabel",defaultMessage:"Import"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{color:"ghost",onClick:function onClick(){return onCancel()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.bottomBar.readMode.cancelButtonLabel",defaultMessage:"Cancel"})))))}else{return _react.default.createElement(_eui.EuiBottomBar,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{color:"ghost",onClick:function onClick(){return onChangeMode(_constants.MODE.READ)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.bottomBar.backButtonLabel",defaultMessage:"Back"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{color:"ghost",onClick:function onClick(){return onCancel()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.bottomBar.cancelButtonLabel",defaultMessage:"Cancel"})))))}};exports.BottomBar=BottomBar},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ResultsView",{enumerable:true,get:function get(){return _results_view.ResultsView}});var _results_view=__webpack_require__(1496)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ResultsView=void 0;var _i18n=__webpack_require__(1);var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _file_contents=__webpack_require__(1497);var _analysis_summary=__webpack_require__(1499);var _fields_stats=__webpack_require__(1501);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ResultsView=function ResultsView(_ref){var data=_ref.data,fileName=_ref.fileName,results=_ref.results,showEditFlyout=_ref.showEditFlyout;var tabs=[{id:"file-stats",name:_i18n.i18n.translate("xpack.ml.fileDatavisualizer.resultsView.fileStatsTabName",{defaultMessage:"File stats"}),content:_react2.default.createElement(_fields_stats.FieldsStats,{results:results})}];return _react2.default.createElement(_eui.EuiPage,{"data-test-subj":"mlPageFileDataVisResults"},_react2.default.createElement(_eui.EuiPageBody,null,_react2.default.createElement(_eui.EuiPageContentHeader,null,_react2.default.createElement(_eui.EuiTitle,null,_react2.default.createElement("h1",{"data-test-subj":"mlFileDataVisResultsTitle"},fileName))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement("div",{className:"results"},_react2.default.createElement(_eui.EuiPanel,{"data-test-subj":"mlFileDataVisFileContentPanel"},_react2.default.createElement(_file_contents.FileContents,{data:data,format:results.format,numberOfLines:results.num_lines_analyzed})),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiPanel,{"data-test-subj":"mlFileDataVisSummaryPanel"},_react2.default.createElement(_analysis_summary.AnalysisSummary,{results:results}),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiButton,{onClick:function onClick(){return showEditFlyout()}},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsView.overrideSettingsButtonLabel",defaultMessage:"Override settings"}))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiPanel,{"data-test-subj":"mlFileDataVisFileStatsPanel"},_react2.default.createElement(_eui.EuiTabbedContent,{tabs:tabs,initialSelectedTab:tabs[0],onTabClick:function onTabClick(){}})))))};exports.ResultsView=ResultsView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FileContents",{enumerable:true,get:function get(){return _file_contents.FileContents}});var _file_contents=__webpack_require__(1498)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FileContents=FileContents;var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _ml_job_editor=__webpack_require__(103);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function FileContents(_ref){var data=_ref.data,format=_ref.format,numberOfLines=_ref.numberOfLines;var mode=_ml_job_editor.ML_EDITOR_MODE.TEXT;if(format===_ml_job_editor.ML_EDITOR_MODE.JSON){mode=_ml_job_editor.ML_EDITOR_MODE.JSON}var formattedData=limitByNumberOfLines(data,numberOfLines);return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h2",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileContents.fileContentsTitle",defaultMessage:"File contents"}))),_react2.default.createElement("div",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileContents.firstLinesDescription",defaultMessage:"First {numberOfLines, plural, zero {# line} one {# line} other {# lines}}",values:{numberOfLines:numberOfLines}})),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_ml_job_editor.MLJobEditor,{mode:mode,readOnly:true,value:formattedData,height:"200px",syntaxChecking:false}))}function limitByNumberOfLines(data,numberOfLines){return data.split("\n").slice(0,numberOfLines).join("\n")}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AnalysisSummary",{enumerable:true,get:function get(){return _analysis_summary.AnalysisSummary}});var _analysis_summary=__webpack_require__(1500)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnalysisSummary=AnalysisSummary;var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function AnalysisSummary(_ref){var results=_ref.results;var items=createDisplayItems(results);return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h2",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.summaryTitle",defaultMessage:"Summary"}))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiDescriptionList,{type:"column",listItems:items,className:"analysis-summary-list"}))}function createDisplayItems(results){var items=[{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.analyzedLinesNumberTitle",defaultMessage:"Number of lines analyzed"}),description:results.num_lines_analyzed}];if(results.format!==undefined){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.formatTitle",defaultMessage:"Format"}),description:results.format});if(results.format==="delimited"){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.delimiterTitle",defaultMessage:"Delimiter"}),description:results.delimiter});items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.hasHeaderRowTitle",defaultMessage:"Has header row"}),description:"".concat(results.has_header_row)})}}if(results.grok_pattern!==undefined){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.grokPatternTitle",defaultMessage:"Grok pattern"}),description:results.grok_pattern})}if(results.timestamp_field!==undefined){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.timeFieldTitle",defaultMessage:"Time field"}),description:results.timestamp_field})}if(results.java_timestamp_formats!==undefined){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.analysisSummary.timeFormatTitle",defaultMessage:"Time {timestampFormats, plural, zero {format} one {format} other {formats}}",values:{timestampFormats:results.java_timestamp_formats.length}}),description:results.java_timestamp_formats.join(", ")})}return items}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FieldsStats",{enumerable:true,get:function get(){return _fields_stats.FieldsStats}});var _fields_stats=__webpack_require__(1502)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldsStats=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _field_stats_card=__webpack_require__(1503);var _get_field_names=__webpack_require__(1504);var _field_types=__webpack_require__(109);var _round_to_decimal_place=__webpack_require__(102);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var FieldsStats=function(_Component){_inherits(FieldsStats,_Component);function FieldsStats(props){var _this;_classCallCheck(this,FieldsStats);_this=_possibleConstructorReturn(this,_getPrototypeOf(FieldsStats).call(this,props));_this.state={fields:[]};return _this}_createClass(FieldsStats,[{key:"componentDidMount",value:function componentDidMount(){this.setState({fields:createFields(this.props.results)})}},{key:"render",value:function render(){return _react.default.createElement("div",{className:"fields-stats"},_react.default.createElement(_eui.EuiFlexGrid,{gutterSize:"m"},this.state.fields.map((function(f){return _react.default.createElement(_eui.EuiFlexItem,{key:f.name,style:{width:"360px"}},_react.default.createElement(_field_stats_card.FieldStatsCard,{field:f}))}))))}}]);return FieldsStats}(_react.Component);exports.FieldsStats=FieldsStats;function createFields(results){var mappings=results.mappings,fieldStats=results.field_stats,numMessagesAnalyzed=results.num_messages_analyzed,timestampField=results.timestamp_field;if(mappings&&fieldStats){var fieldNames=(0,_get_field_names.getFieldNames)(results);return fieldNames.map((function(name){if(fieldStats[name]!==undefined){var field={name:name};var f=fieldStats[name];var m=mappings[name];if(name===timestampField&&field.type===undefined){field.type=_field_types.ML_JOB_FIELD_TYPES.DATE}if(f!==undefined){Object.assign(field,f)}if(m!==undefined){field.type=m.type;if(m.format!==undefined){field.format=m.format}}var percent=field.count/numMessagesAnalyzed*100;field.percent=(0,_round_to_decimal_place.roundToDecimalPlace)(percent);if(field.median_value!==undefined){field.median_value=(0,_round_to_decimal_place.roundToDecimalPlace)(field.median_value);field.mean_value=(0,_round_to_decimal_place.roundToDecimalPlace)(field.mean_value);field.min_value=(0,_round_to_decimal_place.roundToDecimalPlace)(field.min_value);field.max_value=(0,_round_to_decimal_place.roundToDecimalPlace)(field.max_value)}return field}else{var type=mappings[name]&&mappings[name].type===_field_types.ML_JOB_FIELD_TYPES.TEXT?_field_types.ML_JOB_FIELD_TYPES.TEXT:_field_types.ML_JOB_FIELD_TYPES.UNKNOWN;return{name:name,type:type,mean_value:0,count:0,cardinality:0,percent:0}}}))}return[]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FieldStatsCard=FieldStatsCard;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _field_type_icon=__webpack_require__(497);var _display_value=__webpack_require__(498);var _field_types_utils=__webpack_require__(204);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function FieldStatsCard(_ref){var field=_ref.field;var type=field.type;if(type==="double"||type==="long"){type="number"}var typeAriaLabel=(0,_field_types_utils.getMLJobTypeAriaLabel)(type);var cardTitleAriaLabel=[field.name];if(typeAriaLabel){cardTitleAriaLabel.unshift(typeAriaLabel)}return _react.default.createElement(_eui.EuiPanel,{hasShadow:false,className:"mlFieldDataCard"},_react.default.createElement("div",{className:"ml-field-data-card"},_react.default.createElement("div",{className:"ml-field-title-bar ".concat(type)},_react.default.createElement(_field_type_icon.FieldTypeIcon,{type:type,needsAria:false}),_react.default.createElement("div",{className:"field-name",tabIndex:"0","aria-label":"".concat(cardTitleAriaLabel.join(", "))},field.name)),_react.default.createElement("div",{className:"mlFieldDataCard__content"},field.count>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",{className:"stats"},_react.default.createElement("div",{className:"stat"},_react.default.createElement("i",{className:"fa fa-files-o","aria-hidden":"true"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.documentsCountDescription",defaultMessage:"{fieldCount, plural, zero {# document} one {# document} other {# documents}} ({fieldPercent}%)",values:{fieldCount:field.count,fieldPercent:field.percent}})),_react.default.createElement("div",{className:"stat"},_react.default.createElement("i",{className:"fa fa-cubes","aria-hidden":"true"})," ",_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.distinctCountDescription",defaultMessage:"{fieldCardinality} distinct {fieldCardinality, plural, zero {value} one {value} other {values}}",values:{fieldCardinality:field.cardinality}})),field.median_value&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",null,_react.default.createElement("div",{className:"stat min heading"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.minTitle",defaultMessage:"min"})),_react.default.createElement("div",{className:"stat median heading"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.medianTitle",defaultMessage:"median"})),_react.default.createElement("div",{className:"stat max heading"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.maxTitle",defaultMessage:"max"}))),_react.default.createElement("div",null,_react.default.createElement("div",{className:"stat min value"},_react.default.createElement(_display_value.DisplayValue,{value:field.min_value})),_react.default.createElement("div",{className:"stat median value"},_react.default.createElement(_display_value.DisplayValue,{value:field.median_value})),_react.default.createElement("div",{className:"stat max value"},_react.default.createElement(_display_value.DisplayValue,{value:field.max_value}))))),field.top_hits&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("div",{className:"stats"},_react.default.createElement("div",{className:"stat"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.topStatsValuesDescription",defaultMessage:"top values"})),field.top_hits.map((function(_ref2){var count=_ref2.count,value=_ref2.value;var pcnt=Math.round(count/field.count*100*100)/100;return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",key:value},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:100},className:"eui-textTruncate"},_react.default.createElement(_eui.EuiText,{size:"xs",textAlign:"right",color:"subdued"},value," ")),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiProgress,{value:count,max:field.count,color:"primary",size:"m"})),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:70},className:"eui-textTruncate"},_react.default.createElement(_eui.EuiText,{size:"xs",textAlign:"left",color:"subdued"},pcnt,"%")))}))))),field.count===0&&_react.default.createElement("div",{className:"stats"},_react.default.createElement("div",{className:"stat"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fieldStatsCard.noFieldInformationAvailableDescription",defaultMessage:"No field information available"}))))))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getFieldNames=getFieldNames;var _lodash=__webpack_require__(49);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function getFieldNames(results){var mappings=results.mappings,fieldStats=results.field_stats,columnNames=results.column_names;var tempFields=columnNames!==undefined?columnNames:Object.keys(fieldStats);var differenceFields=(0,_lodash.difference)(Object.keys(mappings),tempFields);var timestampIndex=differenceFields.indexOf("@timestamp");if(timestampIndex!==-1){differenceFields.splice(timestampIndex,1)}if(differenceFields.length){tempFields.push.apply(tempFields,_toConsumableArray(differenceFields))}return tempFields}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FileTooLarge=FileTooLarge;exports.FileCouldNotBeRead=FileCouldNotBeRead;var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _numeral=_interopRequireDefault(__webpack_require__(124));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FILE_SIZE_DISPLAY_FORMAT="0,0.[0] b";function FileTooLarge(_ref){var fileSize=_ref.fileSize,maxFileSize=_ref.maxFileSize;var fileSizeFormatted=(0,_numeral.default)(fileSize).format(FILE_SIZE_DISPLAY_FORMAT);var maxFileSizeFormatted=(0,_numeral.default)(maxFileSize).format(FILE_SIZE_DISPLAY_FORMAT);var errorText;if(fileSizeFormatted!==maxFileSizeFormatted){errorText=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileErrorCallouts.fileSizeExceedsAllowedSizeErrorMessage",defaultMessage:"The size of the file you selected for upload is {fileSizeFormatted} which exceeds the maximum permitted size of {maxFileSizeFormatted}",values:{fileSizeFormatted:fileSizeFormatted,maxFileSizeFormatted:maxFileSizeFormatted}}))}else{var diffFormatted=(0,_numeral.default)(fileSize-maxFileSize).format(FILE_SIZE_DISPLAY_FORMAT);errorText=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileErrorCallouts.fileSizeExceedsAllowedSizeByDiffFormatErrorMessage",defaultMessage:"The size of the file you selected for upload exceeds the maximum permitted size of {maxFileSizeFormatted} by {diffFormatted}",values:{maxFileSizeFormatted:maxFileSizeFormatted,diffFormatted:diffFormatted}}))}return _react2.default.createElement(_eui.EuiCallOut,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileErrorCallouts.fileSizeTooLargeTitle",defaultMessage:"File size is too large"}),color:"danger",iconType:"cross","data-test-subj":"mlFileUploadErrorCallout fileTooLarge"},errorText)}function FileCouldNotBeRead(_ref2){var error=_ref2.error,loaded=_ref2.loaded;return _react2.default.createElement(_eui.EuiCallOut,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileErrorCallouts.fileCouldNotBeReadTitle",defaultMessage:"File could not be read"}),color:"danger",iconType:"cross","data-test-subj":"mlFileUploadErrorCallout fileCouldNotBeRead"},error!==undefined&&_react2.default.createElement("p",null,error),loaded&&_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileErrorCallouts.revertingToPreviousSettingsDescription",defaultMessage:"Reverting to previous settings"})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EditFlyout",{enumerable:true,get:function get(){return _edit_flyout.EditFlyout}});var _edit_flyout=__webpack_require__(1507)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditFlyout=void 0;var _react=__webpack_require__(30);var _react2=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _overrides=__webpack_require__(1508);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var EditFlyout=function(_Component){_inherits(EditFlyout,_Component);function EditFlyout(props){var _this;_classCallCheck(this,EditFlyout);_this=_possibleConstructorReturn(this,_getPrototypeOf(EditFlyout).call(this,props));_defineProperty(_assertThisInitialized(_this),"applyAndClose",(function(){_this.applyOverrides();_this.props.closeEditFlyout()}));_defineProperty(_assertThisInitialized(_this),"setApplyOverrides",(function(applyOverrides){_this.applyOverrides=applyOverrides}));_defineProperty(_assertThisInitialized(_this),"unsetApplyOverrides",(function(){_this.applyOverrides=function(){}}));_defineProperty(_assertThisInitialized(_this),"setOverridesValid",(function(overridesValid){_this.setState({overridesValid:overridesValid})}));_this.applyOverrides=function(){};_this.state={overridesValid:true};return _this}_createClass(EditFlyout,[{key:"render",value:function render(){var _this$props=this.props,isFlyoutVisible=_this$props.isFlyoutVisible,closeEditFlyout=_this$props.closeEditFlyout,setOverrides=_this$props.setOverrides,overrides=_this$props.overrides,originalSettings=_this$props.originalSettings,fields=_this$props.fields;return _react2.default.createElement(_react2.default.Fragment,null,isFlyoutVisible&&_react2.default.createElement(_eui.EuiFlyout,{onClose:closeEditFlyout,size:"m"},_react2.default.createElement(_eui.EuiFlyoutHeader,null,_react2.default.createElement(_eui.EuiTitle,null,_react2.default.createElement("h2",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrideSettingsTitle",defaultMessage:"Override settings"})))),_react2.default.createElement(_eui.EuiFlyoutBody,null,_react2.default.createElement(_overrides.Overrides,{setOverrides:setOverrides,overrides:overrides,originalSettings:originalSettings,setApplyOverrides:this.setApplyOverrides,setOverridesValid:this.setOverridesValid,fields:fields})),_react2.default.createElement(_eui.EuiFlyoutFooter,null,_react2.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:closeEditFlyout,flush:"left"},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.closeOverrideSettingsButtonLabel",defaultMessage:"Close"}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButton,{onClick:this.applyAndClose,isDisabled:this.state.overridesValid===false,fill:true},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.applyOverrideSettingsButtonLabel",defaultMessage:"Apply"})))))))}}]);return EditFlyout}(_react2.Component);exports.EditFlyout=EditFlyout},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Overrides=void 0;var _react=__webpack_require__(30);var _i18n=__webpack_require__(1);var _react2=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _options=__webpack_require__(1509);var _overrides_validation=__webpack_require__(1511);var _public=__webpack_require__(31);var _option_lists=__webpack_require__(501);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var formatOptions=(0,_options.getFormatOptions)();var timestampFormatOptions=(0,_options.getTimestampFormatOptions)();var delimiterOptions=(0,_options.getDelimiterOptions)();var quoteOptions=(0,_options.getQuoteOptions)();var LINES_TO_SAMPLE_VALUE_MIN=3;var LINES_TO_SAMPLE_VALUE_MAX=1e6;var OverridesUI=function(_Component){_inherits(OverridesUI,_Component);function OverridesUI(props){var _this;_classCallCheck(this,OverridesUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(OverridesUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"linesToSampleErrors",_i18n.i18n.translate("xpack.ml.fileDatavisualizer.editFlyout.overrides.linesToSampleErrorMessage",{defaultMessage:"Value must be greater than {min} and less than or equal to {max}",values:{min:LINES_TO_SAMPLE_VALUE_MIN,max:LINES_TO_SAMPLE_VALUE_MAX}}));_defineProperty(_assertThisInitialized(_this),"customTimestampFormatErrors",_i18n.i18n.translate("xpack.ml.fileDatavisualizer.editFlyout.overrides.customTimestampFormatErrorMessage",{defaultMessage:"Timestamp format must be a combination of these Java date/time formats:\n      yy, yyyy, M, MM, MMM, MMMM, d, dd, EEE, EEEE, H, HH, h, mm, ss, S through SSSSSSSSS, a, XX, XXX, zzz"}));_defineProperty(_assertThisInitialized(_this),"applyOverrides",(function(){var overrides=_objectSpread({},_this.state.overrides);overrides.delimiter=convertDelimiterBack(overrides.delimiter,_this.state.customDelimiter);if(overrides.timestampFormat===_option_lists.CUSTOM_DROPDOWN_OPTION&&_this.state.customTimestampFormat!==""){overrides.timestampFormat=_this.state.customTimestampFormat}_this.props.setOverrides(overrides)}));_defineProperty(_assertThisInitialized(_this),"onFormatChange",(function(_ref){var _ref2=_slicedToArray(_ref,1),opt=_ref2[0];var format=opt?opt.label:"";_this.setOverride({format:format})}));_defineProperty(_assertThisInitialized(_this),"onTimestampFormatChange",(function(_ref3){var _ref4=_slicedToArray(_ref3,1),opt=_ref4[0];var timestampFormat=opt?opt.label:"";_this.setOverride({timestampFormat:timestampFormat});if(opt!==_option_lists.CUSTOM_DROPDOWN_OPTION){_this.props.setOverridesValid(true)}}));_defineProperty(_assertThisInitialized(_this),"onCustomTimestampFormatChange",(function(e){_this.setState({customTimestampFormat:e.target.value});var _isTimestampFormatVal=(0,_overrides_validation.isTimestampFormatValid)(e.target.value),isValid=_isTimestampFormatVal.isValid,errorMessage=_isTimestampFormatVal.errorMessage;_this.setState({timestampFormatValid:isValid,timestampFormatError:errorMessage});_this.props.setOverridesValid(isValid)}));_defineProperty(_assertThisInitialized(_this),"onTimestampFieldChange",(function(_ref5){var _ref6=_slicedToArray(_ref5,1),opt=_ref6[0];var timestampField=opt?opt.label:"";_this.setOverride({timestampField:timestampField})}));_defineProperty(_assertThisInitialized(_this),"onDelimiterChange",(function(_ref7){var _ref8=_slicedToArray(_ref7,1),opt=_ref8[0];var delimiter=opt?opt.label:"";_this.setOverride({delimiter:delimiter})}));_defineProperty(_assertThisInitialized(_this),"onCustomDelimiterChange",(function(e){_this.setState({customDelimiter:e.target.value})}));_defineProperty(_assertThisInitialized(_this),"onQuoteChange",(function(_ref9){var _ref10=_slicedToArray(_ref9,1),opt=_ref10[0];var quote=opt?opt.label:"";_this.setOverride({quote:quote})}));_defineProperty(_assertThisInitialized(_this),"onHasHeaderRowChange",(function(e){_this.setOverride({hasHeaderRow:e.target.checked})}));_defineProperty(_assertThisInitialized(_this),"onShouldTrimFieldsChange",(function(e){_this.setOverride({shouldTrimFields:e.target.checked})}));_defineProperty(_assertThisInitialized(_this),"onCharsetChange",(function(_ref11){var _ref12=_slicedToArray(_ref11,1),opt=_ref12[0];var charset=opt?opt.label:"";_this.setOverride({charset:charset})}));_defineProperty(_assertThisInitialized(_this),"onColumnNameChange",(function(e,i){var columnNames=_this.state.overrides.columnNames;columnNames[i]=e.target.value;_this.setOverride({columnNames:columnNames})}));_defineProperty(_assertThisInitialized(_this),"grokPatternChange",(function(e){_this.setOverride({grokPattern:e.target.value})}));_defineProperty(_assertThisInitialized(_this),"onLinesToSampleChange",(function(e){var linesToSample=+e.target.value;_this.setOverride({linesToSample:linesToSample});var linesToSampleValid=isLinesToSampleValid(linesToSample);_this.setState({linesToSampleValid:linesToSampleValid});_this.props.setOverridesValid(linesToSampleValid)}));_this.state={};return _this}_createClass(OverridesUI,[{key:"componentDidMount",value:function componentDidMount(){var originalTimestampFormat=this.props&&this.props.originalSettings&&this.props.originalSettings.timestampFormat;if(typeof this.props.setApplyOverrides==="function"){this.props.setApplyOverrides(this.applyOverrides)}if(originalTimestampFormat!==undefined){var optionExists=_option_lists.TIMESTAMP_OPTIONS.some((function(option){return option===originalTimestampFormat}));if(optionExists===false){var overrides=_objectSpread({},this.state.overrides);overrides.timestampFormat=_option_lists.CUSTOM_DROPDOWN_OPTION;this.setState({customTimestampFormat:originalTimestampFormat,overrides:overrides})}}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(typeof this.props.unsetApplyOverrides==="function"){this.props.unsetApplyOverrides()}}},{key:"setOverride",value:function setOverride(o){var overrides=_objectSpread({},this.state.overrides,{},o);this.setState({overrides:overrides})}},{key:"render",value:function render(){var _this2=this;var fields=this.props.fields;var _this$state=this.state,customDelimiter=_this$state.customDelimiter,customTimestampFormat=_this$state.customTimestampFormat,originalColumnNames=_this$state.originalColumnNames,linesToSampleValid=_this$state.linesToSampleValid,timestampFormatError=_this$state.timestampFormatError,timestampFormatValid=_this$state.timestampFormatValid,overrides=_this$state.overrides;var timestampFormat=overrides.timestampFormat,timestampField=overrides.timestampField,format=overrides.format,delimiter=overrides.delimiter,quote=overrides.quote,hasHeaderRow=overrides.hasHeaderRow,shouldTrimFields=overrides.shouldTrimFields,columnNames=overrides.columnNames,grokPattern=overrides.grokPattern,linesToSample=overrides.linesToSample;var fieldOptions=getSortedFields(fields);var timestampFormatErrorsList=[this.customTimestampFormatErrors,timestampFormatError];var _this$props$kibana$se=this.props.kibana.services.docLinks,ELASTIC_WEBSITE_URL=_this$props$kibana$se.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=_this$props$kibana$se.DOC_LINK_VERSION;var docsUrl="".concat(ELASTIC_WEBSITE_URL,"guide/en/elasticsearch/reference/").concat(DOC_LINK_VERSION,"/search-aggregations-bucket-daterange-aggregation.html#date-format-pattern");var timestampFormatHelp=_react2.default.createElement(_eui.EuiText,{size:"xs"},_react2.default.createElement(_eui.EuiLink,{href:docsUrl,target:"_blank"},_i18n.i18n.translate("xpack.ml.fileDatavisualizer.editFlyout.overrides.timestampFormatHelpText",{defaultMessage:"See more on accepted formats"})));return _react2.default.createElement(_eui.EuiForm,null,_react2.default.createElement(_eui.EuiFormRow,{error:this.linesToSampleErrors,isInvalid:linesToSampleValid===false,label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.linesToSampleFormRowLabel",defaultMessage:"Number of lines to sample"})},_react2.default.createElement(_eui.EuiFieldNumber,{value:linesToSample,onChange:this.onLinesToSampleChange,isInvalid:linesToSampleValid===false})),_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.dataFormatFormRowLabel",defaultMessage:"Data format"})},_react2.default.createElement(_eui.EuiComboBox,{options:formatOptions,selectedOptions:selectedOption(format),onChange:this.onFormatChange,singleSelection:{asPlainText:true},isClearable:false})),format==="delimited"&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.delimiterFormRowLabel",defaultMessage:"Delimiter"})},_react2.default.createElement(_eui.EuiComboBox,{options:delimiterOptions,selectedOptions:selectedOption(delimiter),onChange:this.onDelimiterChange,singleSelection:{asPlainText:true},isClearable:false})),delimiter===_option_lists.CUSTOM_DROPDOWN_OPTION&&_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.customDelimiterFormRowLabel",defaultMessage:"Custom delimiter"})},_react2.default.createElement(_eui.EuiFieldText,{value:customDelimiter,onChange:this.onCustomDelimiterChange})),_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.quoteCharacterFormRowLabel",defaultMessage:"Quote character"})},_react2.default.createElement(_eui.EuiComboBox,{options:quoteOptions,selectedOptions:selectedOption(quote),onChange:this.onQuoteChange,singleSelection:{asPlainText:true},isClearable:false})),_react2.default.createElement(_eui.EuiFormRow,null,_react2.default.createElement(_eui.EuiCheckbox,{id:"hasHeaderRow",label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.hasHeaderRowLabel",defaultMessage:"Has header row"}),checked:hasHeaderRow,onChange:this.onHasHeaderRowChange})),_react2.default.createElement(_eui.EuiFormRow,null,_react2.default.createElement(_eui.EuiCheckbox,{id:"shouldTrimFields",label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.trimFieldsLabel",defaultMessage:"Should trim fields"}),checked:shouldTrimFields,onChange:this.onShouldTrimFieldsChange}))),format==="semi_structured_text"&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.grokPatternFormRowLabel",defaultMessage:"Grok pattern"})},_react2.default.createElement(_eui.EuiTextArea,{placeholder:grokPattern,value:grokPattern,onChange:this.grokPatternChange}))),_react2.default.createElement(_eui.EuiFormRow,{helpText:timestampFormatHelp,label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.timestampFormatFormRowLabel",defaultMessage:"Timestamp format"})},_react2.default.createElement(_eui.EuiComboBox,{options:timestampFormatOptions,selectedOptions:selectedOption(timestampFormat),onChange:this.onTimestampFormatChange,singleSelection:{asPlainText:true},isClearable:false})),timestampFormat===_option_lists.CUSTOM_DROPDOWN_OPTION&&_react2.default.createElement(_eui.EuiFormRow,{error:timestampFormatErrorsList,isInvalid:timestampFormatValid===false,label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.customTimestampFormatFormRowLabel",defaultMessage:"Custom timestamp format"})},_react2.default.createElement(_eui.EuiFieldText,{value:customTimestampFormat,onChange:this.onCustomTimestampFormatChange,isInvalid:timestampFormatValid===false})),_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.timeFieldFormRowLabel",defaultMessage:"Time field"})},_react2.default.createElement(_eui.EuiComboBox,{options:fieldOptions,selectedOptions:selectedOption(timestampField),onChange:this.onTimestampFieldChange,singleSelection:{asPlainText:true},isClearable:false})),format==="delimited"&&originalColumnNames.length>0&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,null),_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h3",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.editFlyout.overrides.editFieldNamesTitle",defaultMessage:"Edit field names"}))),originalColumnNames.map((function(f,i){return _react2.default.createElement(_eui.EuiFormRow,{label:f,key:f},_react2.default.createElement(_eui.EuiFieldText,{value:columnNames[i],onChange:function onChange(e){return _this2.onColumnNameChange(e,i)}}))}))))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props,state){var originalSettings=props.originalSettings;var _props$overrides=props.overrides,charset=_props$overrides.charset,format=_props$overrides.format,hasHeaderRow=_props$overrides.hasHeaderRow,columnNames=_props$overrides.columnNames,delimiter=_props$overrides.delimiter,quote=_props$overrides.quote,shouldTrimFields=_props$overrides.shouldTrimFields,grokPattern=_props$overrides.grokPattern,timestampField=_props$overrides.timestampField,timestampFormat=_props$overrides.timestampFormat,linesToSample=_props$overrides.linesToSample;var _convertDelimiter=convertDelimiter(delimiter===undefined?originalSettings.delimiter:delimiter),d=_convertDelimiter.delimiter,customD=_convertDelimiter.customDelimiter;var _getColumnNames=getColumnNames(columnNames,originalSettings),newColumnNames=_getColumnNames.newColumnNames,originalColumnNames=_getColumnNames.originalColumnNames;var overrides={charset:charset===undefined?originalSettings.charset:charset,format:format===undefined?originalSettings.format:format,hasHeaderRow:hasHeaderRow===undefined?originalSettings.hasHeaderRow:hasHeaderRow,columnNames:newColumnNames,delimiter:d,quote:quote===undefined?originalSettings.quote:quote,shouldTrimFields:shouldTrimFields===undefined?originalSettings.shouldTrimFields:shouldTrimFields,grokPattern:grokPattern===undefined?originalSettings.grokPattern:grokPattern,timestampFormat:timestampFormat===undefined?originalSettings.timestampFormat:timestampFormat,timestampField:timestampField===undefined?originalSettings.timestampField:timestampField,linesToSample:linesToSample===undefined?originalSettings.linesToSample:+linesToSample};return _objectSpread({originalColumnNames:originalColumnNames,customDelimiter:customD===undefined?"":customD,customTimestampFormat:"",linesToSampleValid:true,timestampFormatValid:true,timestampFormatError:null,overrides:overrides},state)}}]);return OverridesUI}(_react2.Component);var Overrides=(0,_public.withKibana)(OverridesUI);exports.Overrides=Overrides;function selectedOption(opt){return[{label:opt||""}]}function getSortedFields(fields){return fields.map((function(f){return{label:f}})).sort((function(a,b){return a.label.localeCompare(b.label,undefined,{numeric:true})}))}function convertDelimiter(d){switch(d){case",":return{delimiter:"comma"};case"\t":return{delimiter:"tab"};case";":return{delimiter:"semicolon"};case"|":return{delimiter:"pipe"};case" ":return{delimiter:"space"};default:return{delimiter:_option_lists.CUSTOM_DROPDOWN_OPTION,customDelimiter:d}}}function convertDelimiterBack(delimiter,customDelimiter){switch(delimiter){case"comma":return",";case"tab":return"\t";case"semicolon":return";";case"pipe":return"|";case"space":return" ";case _option_lists.CUSTOM_DROPDOWN_OPTION:return customDelimiter;default:return undefined}}function getColumnNames(columnNames,originalSettings){var newColumnNames=columnNames===undefined&&originalSettings.columnNames!==undefined?_toConsumableArray(originalSettings.columnNames):columnNames;var originalColumnNames=newColumnNames!==undefined?_toConsumableArray(newColumnNames):[];return{newColumnNames:newColumnNames,originalColumnNames:originalColumnNames}}function isLinesToSampleValid(linesToSample){return linesToSample>LINES_TO_SAMPLE_VALUE_MIN&&linesToSample<=LINES_TO_SAMPLE_VALUE_MAX}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"getCharsetOptions",{enumerable:true,get:function get(){return _options.getCharsetOptions}});Object.defineProperty(exports,"getFormatOptions",{enumerable:true,get:function get(){return _options.getFormatOptions}});Object.defineProperty(exports,"getTimestampFormatOptions",{enumerable:true,get:function get(){return _options.getTimestampFormatOptions}});Object.defineProperty(exports,"getDelimiterOptions",{enumerable:true,get:function get(){return _options.getDelimiterOptions}});Object.defineProperty(exports,"getQuoteOptions",{enumerable:true,get:function get(){return _options.getQuoteOptions}});var _options=__webpack_require__(1510)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getFormatOptions=getFormatOptions;exports.getTimestampFormatOptions=getTimestampFormatOptions;exports.getDelimiterOptions=getDelimiterOptions;exports.getQuoteOptions=getQuoteOptions;exports.getCharsetOptions=getCharsetOptions;var _option_lists=__webpack_require__(501);function getOptions(list){return list.map((function(o){return{label:o}}))}function getFormatOptions(){return getOptions(_option_lists.FORMAT_OPTIONS)}function getTimestampFormatOptions(){return getOptions(_option_lists.TIMESTAMP_OPTIONS)}function getDelimiterOptions(){return getOptions(_option_lists.DELIMITER_OPTIONS)}function getQuoteOptions(){return getOptions(_option_lists.QUOTE_OPTIONS)}function getCharsetOptions(){return getOptions(_option_lists.CHARSET_OPTIONS)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isTimestampFormatValid=isTimestampFormatValid;var _i18n=__webpack_require__(1);var FRACTIONAL_SECOND_SEPARATORS=":.,";var VALID_LETTER_GROUPS={yyyy:true,yy:true,M:true,MM:true,MMM:true,MMMM:true,d:true,dd:true,EEE:true,EEEE:true,H:true,HH:true,h:true,mm:true,ss:true,a:true,XX:true,XXX:true,zzz:true};function isLetter(str){return str.length===1&&str.match(/[a-z]/i)}function isTimestampFormatValid(timestampFormat){var result={isValid:true,errorMessage:null};if(timestampFormat.indexOf("?")>=0){result.isValid=false;result.errorMessage=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.editFlyout.overrides.timestampQuestionMarkValidationErrorMessage",{defaultMessage:"Timestamp format {timestampFormat} not supported because it contains a question mark character ({fieldPlaceholder})",values:{timestampFormat:timestampFormat,fieldPlaceholder:"?"}});return result}var notQuoted=true;var prevChar=null;var prevLetterGroup=null;var pos=0;while(pos<timestampFormat.length){var curChar=timestampFormat.charAt(pos);if(curChar==="'"){notQuoted=!notQuoted}else if(notQuoted&&isLetter(curChar)){var startPos=pos;var endPos=startPos+1;while(endPos<timestampFormat.length&&timestampFormat.charAt(endPos)===curChar){++endPos;++pos}var letterGroup=timestampFormat.substring(startPos,endPos);if(VALID_LETTER_GROUPS[letterGroup]!==true){var length=letterGroup.length;if(curChar!=="S"||FRACTIONAL_SECOND_SEPARATORS.indexOf(prevChar)===-1||!("ss"===prevLetterGroup)||endPos-startPos>9){result.isValid=false;result.errorMessage=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.editFlyout.overrides.timestampLetterValidationErrorMessage",{defaultMessage:"Letter { length, plural, one { {lg} } other { group {lg} } } in {format} is not supported",values:{length:length,lg:letterGroup,format:timestampFormat}});if(curChar==="S"){result.errorMessage=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.editFlyout.overrides.timestampLetterSValidationErrorMessage",{defaultMessage:"Letter { length, plural, one { {lg} } other { group {lg} } } in {format} is not supported because it is not preceded by ss and a separator from {sep}",values:{length:length,lg:letterGroup,sep:FRACTIONAL_SECOND_SEPARATORS,format:timestampFormat}})}return result}}prevLetterGroup=letterGroup}prevChar=curChar;++pos}if(prevLetterGroup==null){result.isValid=false;result.errorMessage=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.editFlyout.overrides.timestampEmptyValidationErrorMessage",{defaultMessage:"No time format letter groups in timestamp format {timestampFormat}",values:{timestampFormat:timestampFormat}})}return result}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportView",{enumerable:true,get:function get(){return _import_view.ImportView}});var _import_view=__webpack_require__(1513)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportView=void 0;var _react=__webpack_require__(30);var _react2=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _importer=__webpack_require__(1514);var _results_links=__webpack_require__(1518);var _filebeat_config_flyout=__webpack_require__(1520);var _import_progress=__webpack_require__(503);var _import_errors=__webpack_require__(1524);var _import_summary=__webpack_require__(1526);var _import_settings=__webpack_require__(1528);var _experimental_badge=__webpack_require__(499);var _index_utils=__webpack_require__(70);var _ml_api_service=__webpack_require__(51);var _utils=__webpack_require__(504);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DEFAULT_TIME_FIELD="@timestamp";var DEFAULT_INDEX_SETTINGS={number_of_shards:1};var CONFIG_MODE={SIMPLE:0,ADVANCED:1};var DEFAULT_STATE={index:"",importing:false,imported:false,initialized:false,reading:false,readProgress:0,readStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,parseJSONStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,indexCreatedStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,indexPatternCreatedStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,ingestPipelineCreatedStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,permissionCheckStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,uploadProgress:0,uploadStatus:_import_progress.IMPORT_STATUS.INCOMPLETE,createIndexPattern:true,indexPattern:"",indexPatternId:"",ingestPipelineId:"",errors:[],importFailures:[],docCount:0,configMode:CONFIG_MODE.SIMPLE,indexSettingsString:"",mappingsString:"",pipelineString:"",indexNames:[],indexPatternNames:[],indexNameError:"",indexPatternNameError:"",timeFieldName:undefined,isFilebeatFlyoutVisible:false};var ImportView=function(_Component){_inherits(ImportView,_Component);function ImportView(props){var _this;_classCallCheck(this,ImportView);_this=_possibleConstructorReturn(this,_getPrototypeOf(ImportView).call(this,props));_defineProperty(_assertThisInitialized(_this),"clickReset",(function(){var state=getDefaultState(_this.state,_this.props.results);_this.setState(state,(function(){_this.loadIndexNames();_this.loadIndexPatternNames()}))}));_defineProperty(_assertThisInitialized(_this),"clickImport",(function(){_this.import()}));_defineProperty(_assertThisInitialized(_this),"onConfigModeChange",(function(configMode){_this.setState({configMode:configMode})}));_defineProperty(_assertThisInitialized(_this),"onIndexChange",(function(e){var name=e.target.value;var _this$state=_this.state,indexNames=_this$state.indexNames,indexPattern=_this$state.indexPattern,indexPatternNames=_this$state.indexPatternNames;_this.setState(_objectSpread({index:name,indexNameError:isIndexNameValid(name,indexNames)},indexPattern===""?{}:{indexPatternNameError:isIndexPatternNameValid(indexPattern,indexPatternNames,name)}))}));_defineProperty(_assertThisInitialized(_this),"onIndexPatternChange",(function(e){var name=e.target.value;var _this$state2=_this.state,indexPatternNames=_this$state2.indexPatternNames,index=_this$state2.index;_this.setState({indexPattern:name,indexPatternNameError:isIndexPatternNameValid(name,indexPatternNames,index)})}));_defineProperty(_assertThisInitialized(_this),"onCreateIndexPatternChange",(function(e){_this.setState({createIndexPattern:e.target.checked})}));_defineProperty(_assertThisInitialized(_this),"onIndexSettingsStringChange",(function(text){_this.setState({indexSettingsString:text})}));_defineProperty(_assertThisInitialized(_this),"onMappingsStringChange",(function(text){_this.setState({mappingsString:text})}));_defineProperty(_assertThisInitialized(_this),"onPipelineStringChange",(function(text){_this.setState({pipelineString:text})}));_defineProperty(_assertThisInitialized(_this),"setImportProgress",(function(progress){_this.setState({uploadProgress:progress})}));_defineProperty(_assertThisInitialized(_this),"setReadProgress",(function(progress){_this.setState({readProgress:progress})}));_defineProperty(_assertThisInitialized(_this),"showFilebeatFlyout",(function(){_this.setState({isFilebeatFlyoutVisible:true});_this.props.hideBottomBar()}));_defineProperty(_assertThisInitialized(_this),"closeFilebeatFlyout",(function(){_this.setState({isFilebeatFlyoutVisible:false});_this.props.showBottomBar()}));_this.state=getDefaultState(DEFAULT_STATE,_this.props.results);return _this}_createClass(ImportView,[{key:"componentDidMount",value:function componentDidMount(){this.loadIndexNames();this.loadIndexPatternNames()}},{key:"import",value:function(){var _import2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _this2=this;var _this$props,fileContents,results,indexPatterns,kibanaConfig,showBottomBar,format,timeFieldName,_this$state3,index,indexPattern,createIndexPattern,indexSettingsString,mappingsString,pipelineString,errors;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this$props=this.props,fileContents=_this$props.fileContents,results=_this$props.results,indexPatterns=_this$props.indexPatterns,kibanaConfig=_this$props.kibanaConfig,showBottomBar=_this$props.showBottomBar;format=results.format;timeFieldName=this.state.timeFieldName;_this$state3=this.state,index=_this$state3.index,indexPattern=_this$state3.indexPattern,createIndexPattern=_this$state3.createIndexPattern,indexSettingsString=_this$state3.indexSettingsString,mappingsString=_this$state3.mappingsString,pipelineString=_this$state3.pipelineString;errors=[];if(index!==""){this.setState({importing:true,errors:errors},_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return(0,_utils.hasImportPermission)(index);case 2:_context2.t0=_context2.sent;if(!(_context2.t0===false)){_context2.next=7;break}errors.push(_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importView.importPermissionError",{defaultMessage:"You do not have permission to create or import data into index {index}.",values:{index:index}}));_this2.setState({permissionCheckStatus:_import_progress.IMPORT_STATUS.FAILED,importing:false,imported:false,errors:errors});return _context2.abrupt("return");case 7:_this2.setState({importing:true,imported:false,reading:true,initialized:true,permissionCheckStatus:_import_progress.IMPORT_STATUS.COMPLETE},(function(){_this2.props.hideBottomBar();setTimeout(_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var success,createPipeline,settings,mappings,pipeline,parseError,_parseError,indexCreationSettings,_parseError2,importer,readResp,initializeImportResp,indexCreated,pipelineCreated,importId,pipelineId,importResp,indexPatternName,indexPatternResp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:success=true;createPipeline=pipelineString!=="";settings={};mappings={};pipeline={};try{settings=JSON.parse(indexSettingsString)}catch(error){success=false;parseError=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importView.parseSettingsError",{defaultMessage:"Error parsing settings:"});errors.push("".concat(parseError," ").concat(error.message))}try{mappings=JSON.parse(mappingsString)}catch(error){success=false;_parseError=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importView.parseMappingsError",{defaultMessage:"Error parsing mappings:"});errors.push("".concat(_parseError," ").concat(error.message))}indexCreationSettings={settings:settings,mappings:mappings};try{if(createPipeline){pipeline=JSON.parse(pipelineString);indexCreationSettings.pipeline=pipeline}}catch(error){success=false;_parseError2=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importView.parsePipelineError",{defaultMessage:"Error parsing ingest pipeline:"});errors.push("".concat(_parseError2," ").concat(error.message))}_this2.setState({parseJSONStatus:success?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED});if(mappings[DEFAULT_TIME_FIELD]!==undefined){timeFieldName=DEFAULT_TIME_FIELD;_this2.setState({timeFieldName:timeFieldName})}if(!success){_context.next=48;break}importer=(0,_importer.importerFactory)(format,results,indexCreationSettings);if(!(importer!==undefined)){_context.next=48;break}readResp=importer.read(fileContents,_this2.setReadProgress);success=readResp.success;_this2.setState({readStatus:success?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED,reading:false});if(readResp.success===false){console.error(readResp.error);errors.push(readResp.error)}if(!success){_context.next=48;break}_context.next=21;return importer.initializeImport(index);case 21:initializeImportResp=_context.sent;indexCreated=initializeImportResp.index!==undefined;_this2.setState({indexCreatedStatus:indexCreated?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED});if(createPipeline){pipelineCreated=initializeImportResp.pipelineId!==undefined;if(indexCreated){_this2.setState({ingestPipelineCreatedStatus:pipelineCreated?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED,ingestPipelineId:pipelineCreated?initializeImportResp.pipelineId:""})}success=indexCreated&&pipelineCreated}else{success=indexCreated}if(!success){_context.next=47;break}importId=initializeImportResp.id;pipelineId=initializeImportResp.pipelineId;_context.next=30;return importer.import(importId,index,pipelineId,_this2.setImportProgress);case 30:importResp=_context.sent;success=importResp.success;_this2.setState({uploadStatus:importResp.success?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED,importFailures:importResp.failures,docCount:importResp.docCount});if(!success){_context.next=44;break}if(!createIndexPattern){_context.next=42;break}indexPatternName=indexPattern===""?index:indexPattern;_context.next=38;return createKibanaIndexPattern(indexPatternName,indexPatterns,timeFieldName,kibanaConfig);case 38:indexPatternResp=_context.sent;success=indexPatternResp.success;_this2.setState({indexPatternCreatedStatus:indexPatternResp.success?_import_progress.IMPORT_STATUS.COMPLETE:_import_progress.IMPORT_STATUS.FAILED,indexPatternId:indexPatternResp.id});if(indexPatternResp.success===false){errors.push(indexPatternResp.error)}case 42:_context.next=45;break;case 44:errors.push(importResp.error);case 45:_context.next=48;break;case 47:errors.push(initializeImportResp.error);case 48:showBottomBar();_this2.setState({importing:false,imported:success,errors:errors});case 50:case"end":return _context.stop()}}}),_callee)}))),500)}));case 8:case"end":return _context2.stop()}}}),_callee2)}))))}case 6:case"end":return _context3.stop()}}}),_callee3,this)})));function _import(){return _import2.apply(this,arguments)}return _import}()},{key:"loadIndexNames",value:function(){var _loadIndexNames=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var indices,indexNames;return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _ml_api_service.ml.getIndices();case 2:indices=_context4.sent;indexNames=indices.map((function(i){return i.name}));this.setState({indexNames:indexNames});case 5:case"end":return _context4.stop()}}}),_callee4,this)})));function loadIndexNames(){return _loadIndexNames.apply(this,arguments)}return loadIndexNames}()},{key:"loadIndexPatternNames",value:function(){var _loadIndexPatternNames=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var indexPatternNames;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return(0,_index_utils.loadIndexPatterns)(this.props.indexPatterns);case 2:indexPatternNames=(0,_index_utils.getIndexPatternNames)();this.setState({indexPatternNames:indexPatternNames});case 4:case"end":return _context5.stop()}}}),_callee5,this)})));function loadIndexPatternNames(){return _loadIndexPatternNames.apply(this,arguments)}return loadIndexPatternNames}()},{key:"render",value:function render(){var _this$state4=this.state,index=_this$state4.index,indexPattern=_this$state4.indexPattern,indexPatternId=_this$state4.indexPatternId,ingestPipelineId=_this$state4.ingestPipelineId,importing=_this$state4.importing,imported=_this$state4.imported,reading=_this$state4.reading,initialized=_this$state4.initialized,readStatus=_this$state4.readStatus,parseJSONStatus=_this$state4.parseJSONStatus,indexCreatedStatus=_this$state4.indexCreatedStatus,ingestPipelineCreatedStatus=_this$state4.ingestPipelineCreatedStatus,indexPatternCreatedStatus=_this$state4.indexPatternCreatedStatus,permissionCheckStatus=_this$state4.permissionCheckStatus,uploadProgress=_this$state4.uploadProgress,uploadStatus=_this$state4.uploadStatus,createIndexPattern=_this$state4.createIndexPattern,errors=_this$state4.errors,docCount=_this$state4.docCount,importFailures=_this$state4.importFailures,indexSettingsString=_this$state4.indexSettingsString,mappingsString=_this$state4.mappingsString,pipelineString=_this$state4.pipelineString,indexNameError=_this$state4.indexNameError,indexPatternNameError=_this$state4.indexPatternNameError,timeFieldName=_this$state4.timeFieldName,isFilebeatFlyoutVisible=_this$state4.isFilebeatFlyoutVisible;var createPipeline=pipelineString!=="";var statuses={reading:reading,readStatus:readStatus,parseJSONStatus:parseJSONStatus,indexCreatedStatus:indexCreatedStatus,ingestPipelineCreatedStatus:ingestPipelineCreatedStatus,indexPatternCreatedStatus:indexPatternCreatedStatus,permissionCheckStatus:permissionCheckStatus,uploadProgress:uploadProgress,uploadStatus:uploadStatus,createIndexPattern:createIndexPattern,createPipeline:createPipeline};var disableImport=index===""||indexNameError!==""||createIndexPattern===true&&indexPatternNameError!==""||initialized===true;return _react2.default.createElement(_eui.EuiPage,{"data-test-subj":"mlPageFileDataVisImport"},_react2.default.createElement(_eui.EuiPageBody,null,_react2.default.createElement(_eui.EuiPageContentHeader,null,_react2.default.createElement(_eui.EuiTitle,null,_react2.default.createElement("h1",null,this.props.fileName))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiPanel,{"data-test-subj":"mlFileDataVisImportSettingsPanel"},_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h2",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.importDataTitle",defaultMessage:"Import data"})," ",_react2.default.createElement(_experimental_badge.ExperimentalBadge,{tooltipContent:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.experimentalFeatureTooltip",defaultMessage:"Experimental feature. We'd love to hear your feedback."})}))),_react2.default.createElement(_import_settings.ImportSettings,{index:index,indexPattern:indexPattern,initialized:initialized,onIndexChange:this.onIndexChange,createIndexPattern:createIndexPattern,onCreateIndexPatternChange:this.onCreateIndexPatternChange,onIndexPatternChange:this.onIndexPatternChange,indexSettingsString:indexSettingsString,mappingsString:mappingsString,pipelineString:pipelineString,onIndexSettingsStringChange:this.onIndexSettingsStringChange,onMappingsStringChange:this.onMappingsStringChange,onPipelineStringChange:this.onPipelineStringChange,indexNameError:indexNameError,indexPatternNameError:indexPatternNameError}),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),(initialized===false||importing===true)&&_react2.default.createElement(_eui.EuiButton,{isDisabled:disableImport,onClick:this.clickImport,isLoading:importing,iconSide:"right",fill:true,"data-test-subj":"mlFileDataVisImportButton"},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.importButtonLabel",defaultMessage:"Import"})),initialized===true&&importing===false&&_react2.default.createElement(_eui.EuiButton,{onClick:this.clickReset},_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.resetButtonLabel",defaultMessage:"Reset"}))),initialized===true&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiPanel,null,_react2.default.createElement(_import_progress.ImportProgress,{statuses:statuses}),imported===true&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_import_summary.ImportSummary,{index:index,indexPattern:indexPattern===""?index:indexPattern,ingestPipelineId:ingestPipelineId,docCount:docCount,importFailures:importFailures,createIndexPattern:createIndexPattern,createPipeline:createPipeline}),_react2.default.createElement(_eui.EuiSpacer,{size:"l"}),_react2.default.createElement(_results_links.ResultsLinks,{index:index,indexPatternId:indexPatternId,timeFieldName:timeFieldName,createIndexPattern:createIndexPattern,showFilebeatFlyout:this.showFilebeatFlyout}),isFilebeatFlyoutVisible&&_react2.default.createElement(_filebeat_config_flyout.FilebeatConfigFlyout,{index:index,results:this.props.results,indexPatternId:indexPatternId,ingestPipelineId:ingestPipelineId,closeFlyout:this.closeFilebeatFlyout})))),errors.length>0&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_import_errors.ImportErrors,{errors:errors,statuses:statuses}))))}}]);return ImportView}(_react2.Component);exports.ImportView=ImportView;function createKibanaIndexPattern(_x,_x2,_x3,_x4){return _createKibanaIndexPattern.apply(this,arguments)}function _createKibanaIndexPattern(){_createKibanaIndexPattern=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(indexPatternName,indexPatterns,timeFieldName,kibanaConfig){var emptyPattern,id;return regeneratorRuntime.wrap((function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return indexPatterns.make();case 3:emptyPattern=_context6.sent;Object.assign(emptyPattern,{id:"",title:indexPatternName,timeFieldName:timeFieldName});_context6.next=7;return emptyPattern.create();case 7:id=_context6.sent;_context6.next=10;return indexPatterns.clearCache();case 10:if(kibanaConfig.get("defaultIndex")){_context6.next=13;break}_context6.next=13;return kibanaConfig.set("defaultIndex",id);case 13:return _context6.abrupt("return",{success:true,id:id});case 16:_context6.prev=16;_context6.t0=_context6["catch"](0);console.error(_context6.t0);return _context6.abrupt("return",{success:false,error:_context6.t0});case 20:case"end":return _context6.stop()}}}),_callee6,null,[[0,16]])})));return _createKibanaIndexPattern.apply(this,arguments)}function getDefaultState(state,results){var indexSettingsString=state.indexSettingsString===""?JSON.stringify(DEFAULT_INDEX_SETTINGS,null,2):state.indexSettingsString;var mappingsString=state.mappingsString===""?JSON.stringify(results.mappings,null,2):state.mappingsString;var pipelineString=state.pipelineString===""&&results.ingest_pipeline!==undefined?JSON.stringify(results.ingest_pipeline,null,2):state.pipelineString;var timeFieldName=results.timestamp_field;return _objectSpread({},DEFAULT_STATE,{indexSettingsString:indexSettingsString,mappingsString:mappingsString,pipelineString:pipelineString,timeFieldName:timeFieldName})}function isIndexNameValid(name,indexNames){if(indexNames.find((function(i){return i===name}))){return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.indexNameAlreadyExistsErrorMessage",defaultMessage:"Index name already exists"})}var reg=new RegExp('[\\\\/*?"<>|\\s,#]+');if(name!==name.toLowerCase()||name==="."||name===".."||name.match(/^[-_+]/)!==null||name.match(reg)!==null){return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.indexNameContainsIllegalCharactersErrorMessage",defaultMessage:"Index name contains illegal characters"})}return""}function isIndexPatternNameValid(name,indexPatternNames,index){if(name===""){return""}if(indexPatternNames.find((function(i){return i===name}))){return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.indexPatternNameAlreadyExistsErrorMessage",defaultMessage:"Index pattern name already exists"})}var newName=name.replace(/\./g,"\\.");newName=newName.replace(/\+/g,"\\+");newName=newName.replace(/\*/g,".*");var reg=new RegExp("^".concat(newName,"$"));if(index.match(reg)===null){return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importView.indexPatternDoesNotMatchIndexNameErrorMessage",defaultMessage:"Index pattern does not match index name"})}return""}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"importerFactory",{enumerable:true,get:function get(){return _importer_factory.importerFactory}});var _importer_factory=__webpack_require__(1515)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.importerFactory=importerFactory;var _message_importer=__webpack_require__(1516);var _ndjson_importer=__webpack_require__(1517);function importerFactory(format,results,settings){switch(format){case"delimited":case"semi_structured_text":return new _message_importer.MessageImporter(results,settings);case"ndjson":return new _ndjson_importer.NdjsonImporter(results,settings);default:return}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MessageImporter=void 0;var _importer=__webpack_require__(502);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var MessageImporter=function(_Importer){_inherits(MessageImporter,_Importer);function MessageImporter(results,settings){var _this;_classCallCheck(this,MessageImporter);_this=_possibleConstructorReturn(this,_getPrototypeOf(MessageImporter).call(this,settings));_this.excludeLinesRegex=results.exclude_lines_pattern===undefined?null:new RegExp(results.exclude_lines_pattern);_this.multilineStartRegex=results.multiline_start_pattern===undefined?null:new RegExp(results.multiline_start_pattern);return _this}_createClass(MessageImporter,[{key:"read",value:function read(text){try{var data=[];var message="";var line="";for(var i=0;i<text.length;i++){var char=text[i];if(char==="\n"){message=this.processLine(data,message,line);line=""}else{line+=char}}if(line!==""){message=this.processLine(data,message,line)}if(message!==""){this.addMessage(data,message)}if(data[0]&&data[0].message===""){data.shift()}this.data=data;this.docArray=this.data;return{success:true}}catch(error){console.error(error);return{success:false,error:error}}}},{key:"processLine",value:function processLine(data,message,line){if(this.excludeLinesRegex===null||line.match(this.excludeLinesRegex)===null){if(this.multilineStartRegex===null||line.match(this.multilineStartRegex)!==null){this.addMessage(data,message);message=""}else if(data.length===0){return""}else{message+="\n"}message+=line}return message}},{key:"addMessage",value:function addMessage(data,message){message=message.replace(/\r$/,"");data.push({message:message})}}]);return MessageImporter}(_importer.Importer);exports.MessageImporter=MessageImporter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NdjsonImporter=void 0;var _importer=__webpack_require__(502);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var NdjsonImporter=function(_Importer){_inherits(NdjsonImporter,_Importer);function NdjsonImporter(results,settings){_classCallCheck(this,NdjsonImporter);return _possibleConstructorReturn(this,_getPrototypeOf(NdjsonImporter).call(this,settings))}_createClass(NdjsonImporter,[{key:"read",value:function read(json){try{var splitJson=json.split(/}\s*\n/);var ndjson=[];for(var i=0;i<splitJson.length;i++){if(splitJson[i]!==""){ndjson.push("".concat(splitJson[i],"}"))}}this.docArray=ndjson;return{success:true}}catch(error){return{success:false,error:error}}}}]);return NdjsonImporter}(_importer.Importer);exports.NdjsonImporter=NdjsonImporter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ResultsLinks",{enumerable:true,get:function get(){return _results_links.ResultsLinks}});var _results_links=__webpack_require__(1519)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ResultsLinks=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _moment=_interopRequireDefault(__webpack_require__(32));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _ml_api_service=__webpack_require__(51);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _check_ml_nodes=__webpack_require__(81);var _kibana=__webpack_require__(57);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var RECHECK_DELAY_MS=3e3;var ResultsLinks=function ResultsLinks(_ref){var index=_ref.index,indexPatternId=_ref.indexPatternId,timeFieldName=_ref.timeFieldName,createIndexPattern=_ref.createIndexPattern,showFilebeatFlyout=_ref.showFilebeatFlyout;var _useState=(0,_react.useState)({from:"now-30m",to:"now"}),_useState2=_slicedToArray(_useState,2),duration=_useState2[0],setDuration=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=_slicedToArray(_useState3,2),showCreateJobLink=_useState4[0],setShowCreateJobLink=_useState4[1];var _useState5=(0,_react.useState)(""),_useState6=_slicedToArray(_useState5,2),globalStateString=_useState6[0],setGlobalStateString=_useState6[1];var _useMlKibana=(0,_kibana.useMlKibana)(),basePath=_useMlKibana.services.http.basePath;(0,_react.useEffect)((function(){setShowCreateJobLink((0,_check_privilege.checkPermission)("canCreateJob")&&(0,_check_ml_nodes.mlNodesAvailable)());updateTimeValues()}),[]);(0,_react.useEffect)((function(){var _g=timeFieldName!==undefined?"&_g=(time:(from:'".concat(duration.from,"',mode:quick,to:'").concat(duration.to,"'))"):"";setGlobalStateString(_g)}),[duration]);function updateTimeValues(){return _updateTimeValues.apply(this,arguments)}function _updateTimeValues(){_updateTimeValues=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var recheck,_ref2,from,to,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:recheck=_args.length>0&&_args[0]!==undefined?_args[0]:true;if(!(timeFieldName!==undefined)){_context.next=9;break}_context.next=4;return getFullTimeRange(index,timeFieldName);case 4:_ref2=_context.sent;from=_ref2.from;to=_ref2.to;setDuration({from:from===null?duration.from:from,to:to===null?duration.to:to});if(recheck&&(from===null||to===null)){setTimeout((function(){updateTimeValues(false)}),RECHECK_DELAY_MS)}case 9:case"end":return _context.stop()}}}),_callee)})));return _updateTimeValues.apply(this,arguments)}return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"l"},createIndexPattern&&_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{icon:_react.default.createElement(_eui.EuiIcon,{size:"xxl",type:"discoverApp"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.viewIndexInDiscoverTitle",defaultMessage:"View index in Discover"}),description:"",href:"".concat(basePath.get(),"/app/kibana#/discover?&_a=(index:'").concat(indexPatternId,"')").concat(globalStateString)})),(0,_license.isFullLicense)()===true&&timeFieldName!==undefined&&showCreateJobLink&&createIndexPattern&&_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{icon:_react.default.createElement(_eui.EuiIcon,{size:"xxl",type:"machineLearningApp"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.createNewMLJobTitle",defaultMessage:"Create new ML job"}),description:"",href:"#/jobs/new_job/step/job_type?index=".concat(indexPatternId).concat(globalStateString)})),createIndexPattern&&_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{icon:_react.default.createElement(_eui.EuiIcon,{size:"xxl",type:"dataVisualizer"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.openInDataVisualizerTitle",defaultMessage:"Open in Data Visualizer"}),description:"",href:"#/jobs/new_job/datavisualizer?index=".concat(indexPatternId).concat(globalStateString)})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{icon:_react.default.createElement(_eui.EuiIcon,{size:"xxl",type:"managementApp"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.indexManagementTitle",defaultMessage:"Index Management"}),description:"",href:"".concat(basePath.get(),"/app/kibana#/management/elasticsearch/index_management/indices/filter/").concat(index)})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{icon:_react.default.createElement(_eui.EuiIcon,{size:"xxl",type:"managementApp"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.indexPatternManagementTitle",defaultMessage:"Index Pattern Management"}),description:"",href:"".concat(basePath.get(),"/app/kibana#/management/kibana/index_patterns/").concat(createIndexPattern?indexPatternId:"")})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiCard,{icon:_react.default.createElement(_eui.EuiIcon,{size:"xxl",type:"filebeatApp"}),title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.fileBeatConfig",defaultMessage:"Create Filebeat configuration"}),description:"",onClick:showFilebeatFlyout})))};exports.ResultsLinks=ResultsLinks;function getFullTimeRange(_x,_x2){return _getFullTimeRange.apply(this,arguments)}function _getFullTimeRange(){_getFullTimeRange=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(index,timeFieldName){var query,resp;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:query={bool:{must:[{query_string:{analyze_wildcard:true,query:"*"}}]}};_context2.next=3;return _ml_api_service.ml.getTimeFieldRange({index:index,timeFieldName:timeFieldName,query:query});case 3:resp=_context2.sent;return _context2.abrupt("return",{from:(0,_moment.default)(resp.start.epoch).toISOString(),to:(0,_moment.default)(resp.end.epoch).toISOString()});case 5:case"end":return _context2.stop()}}}),_callee2)})));return _getFullTimeRange.apply(this,arguments)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FilebeatConfigFlyout",{enumerable:true,get:function get(){return _filebeat_config_flyout.FilebeatConfigFlyout}});var _filebeat_config_flyout=__webpack_require__(1521)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FilebeatConfigFlyout=exports.EDITOR_MODE=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _filebeat_config=__webpack_require__(1522);var _kibana=__webpack_require__(57);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var EDITOR_MODE;exports.EDITOR_MODE=EDITOR_MODE;(function(EDITOR_MODE){EDITOR_MODE[EDITOR_MODE["HIDDEN"]=0]="HIDDEN";EDITOR_MODE[EDITOR_MODE["READONLY"]=1]="READONLY";EDITOR_MODE[EDITOR_MODE["EDITABLE"]=2]="EDITABLE"})(EDITOR_MODE||(exports.EDITOR_MODE=EDITOR_MODE={}));var FilebeatConfigFlyout=function FilebeatConfigFlyout(_ref){var index=_ref.index,results=_ref.results,indexPatternId=_ref.indexPatternId,ingestPipelineId=_ref.ingestPipelineId,closeFlyout=_ref.closeFlyout;var _useState=(0,_react.useState)(""),_useState2=_slicedToArray(_useState,2),fileBeatConfig=_useState2[0],setFileBeatConfig=_useState2[1];var _useState3=(0,_react.useState)(null),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useMlKibana=(0,_kibana.useMlKibana)(),security=_useMlKibana.services.security;(0,_react.useEffect)((function(){security.authc.getCurrentUser().then((function(user){setUsername(user.username===undefined?null:user.username)}))}),[]);(0,_react.useEffect)((function(){var config=(0,_filebeat_config.createFilebeatConfig)(index,results,ingestPipelineId,username);setFileBeatConfig(config)}),[username]);return _react.default.createElement(_eui.EuiFlyout,{onClose:closeFlyout,hideCloseButton:true,size:"m"},_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(Contents,{value:fileBeatConfig,username:username,index:index}))),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:closeFlyout,flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileBeatConfigFlyout.closeButton",defaultMessage:"Close"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCopy,{textToCopy:fileBeatConfig},(function(copy){return _react.default.createElement(_eui.EuiButton,{onClick:copy},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.fileBeatConfigFlyout.copyButton",defaultMessage:"Copy to clipboard"}))}))))))};exports.FilebeatConfigFlyout=FilebeatConfigFlyout;var Contents=function Contents(_ref2){var value=_ref2.value,index=_ref2.index,username=_ref2.username;return _react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiTitle,{size:"s"},_react.default.createElement("h5",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.fileBeatConfigTitle",defaultMessage:"Filebeat configuration"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.fileBeatConfigTopText1",defaultMessage:"Additional data can be uploaded to the {index} index using Filebeat.",values:{index:_react.default.createElement(_eui.EuiCode,null,index)}})),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.fileBeatConfigTopText2",defaultMessage:"Modify {filebeatYml} to set the connection information:",values:{filebeatYml:_react.default.createElement(_eui.EuiCode,null,"filebeat.yml")}})),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiCodeBlock,{language:"bash"},value),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("p",null,username===null?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.fileBeatConfigBottomTextNoUsername",defaultMessage:"Where {esUrl} is the URL of Elasticsearch.",values:{esUrl:_react.default.createElement(_eui.EuiCode,null,"<es_url>")}}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.resultsLinks.fileBeatConfigBottomText",defaultMessage:"Where {password} is the password of the {user} user, {esUrl} is the URL of Elasticsearch.",values:{user:_react.default.createElement(_eui.EuiCode,null,username),password:_react.default.createElement(_eui.EuiCode,null,"<password>"),esUrl:_react.default.createElement(_eui.EuiCode,null,"<es_url>")}})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createFilebeatConfig=createFilebeatConfig;var _i18n=__webpack_require__(1);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function createFilebeatConfig(index,results,ingestPipelineId,username){return["filebeat.inputs:","- type: log"].concat(_toConsumableArray(getPaths()),_toConsumableArray(getEncoding(results)),_toConsumableArray(getExcludeLines(results)),_toConsumableArray(getMultiline(results)),[""],_toConsumableArray(getProcessors(results)),["output.elasticsearch:",'  hosts: ["<es_url>"]'],_toConsumableArray(getUserDetails(username)),['  index: "'.concat(index,'"'),'  pipeline: "'.concat(ingestPipelineId,'"'),"","setup:","  template.enabled: false","  ilm.enabled: false"]).join("\n")}function getPaths(){var txt=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.fileBeatConfig.paths",{defaultMessage:"add path to your files here"});return["  paths:","  - '<".concat(txt,">'")]}function getEncoding(results){return results.charset!=="UTF-8"?["  encoding: ".concat(results.charset)]:[]}function getExcludeLines(results){return results.exclude_lines_pattern!==undefined?["  exclude_lines: ['".concat(results.exclude_lines_pattern.replace(/'/g,"''"),"']")]:[]}function getMultiline(results){return results.multiline_start_pattern!==undefined?["  multiline:","    pattern: '".concat(results.multiline_start_pattern.replace(/'/g,"''"),"'"),"    match: after","    negate: true"]:[]}function getProcessors(results){return results.need_client_timezone===true?["processors:","- add_locale: ~",""]:[]}function getUserDetails(username){return username!==null?['  username: "'.concat(username,'"'),'  password: "<password>"']:[]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportProgress=ImportProgress;exports.IMPORT_STATUS=void 0;var _i18n=__webpack_require__(1);var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var IMPORT_STATUS={INCOMPLETE:"incomplete",COMPLETE:"complete",FAILED:"danger"};exports.IMPORT_STATUS=IMPORT_STATUS;function ImportProgress(_ref){var statuses=_ref.statuses;var reading=statuses.reading,readStatus=statuses.readStatus,parseJSONStatus=statuses.parseJSONStatus,indexCreatedStatus=statuses.indexCreatedStatus,ingestPipelineCreatedStatus=statuses.ingestPipelineCreatedStatus,indexPatternCreatedStatus=statuses.indexPatternCreatedStatus,uploadProgress=statuses.uploadProgress,uploadStatus=statuses.uploadStatus,createIndexPattern=statuses.createIndexPattern,createPipeline=statuses.createPipeline;var statusInfo=null;var completedStep=0;if(reading===true&&readStatus===IMPORT_STATUS.INCOMPLETE&&parseJSONStatus===IMPORT_STATUS.INCOMPLETE){completedStep=0}if(readStatus===IMPORT_STATUS.COMPLETE&&indexCreatedStatus===IMPORT_STATUS.INCOMPLETE&&ingestPipelineCreatedStatus===IMPORT_STATUS.INCOMPLETE){completedStep=1}if(indexCreatedStatus===IMPORT_STATUS.COMPLETE){completedStep=2}if(ingestPipelineCreatedStatus===IMPORT_STATUS.COMPLETE||createPipeline===false&&indexCreatedStatus===IMPORT_STATUS.COMPLETE){completedStep=3}if(uploadStatus===IMPORT_STATUS.COMPLETE){completedStep=4}if(indexPatternCreatedStatus===IMPORT_STATUS.COMPLETE){completedStep=5}var processFileTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.processFileTitle",{defaultMessage:"Process file"});var createIndexTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.createIndexTitle",{defaultMessage:"Create index"});var createIngestPipelineTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.createIngestPipelineTitle",{defaultMessage:"Create ingest pipeline"});var uploadingDataTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.uploadDataTitle",{defaultMessage:"Upload data"});var createIndexPatternTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.createIndexPatternTitle",{defaultMessage:"Create index pattern"});var creatingIndexStatus=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importProgress.stepTwoCreatingIndexDescription",defaultMessage:"Creating index"}));var creatingIndexAndIngestPipelineStatus=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importProgress.stepTwoCreatingIndexIngestPipelineDescription",defaultMessage:"Creating index and ingest pipeline"}));if(completedStep>=0){processFileTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.processingFileTitle",{defaultMessage:"Processing file"});statusInfo=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importProgress.processingImportedFileDescription",defaultMessage:"Processing file for import"}))}if(completedStep>=1){processFileTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.fileProcessedTitle",{defaultMessage:"File processed"});createIndexTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.creatingIndexTitle",{defaultMessage:"Creating index"});statusInfo=createPipeline===true?creatingIndexAndIngestPipelineStatus:creatingIndexStatus}if(completedStep>=2){createIndexTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.indexCreatedTitle",{defaultMessage:"Index created"});createIngestPipelineTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.creatingIngestPipelineTitle",{defaultMessage:"Creating ingest pipeline"});statusInfo=createPipeline===true?creatingIndexAndIngestPipelineStatus:creatingIndexStatus}if(completedStep>=3){createIngestPipelineTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.ingestPipelineCreatedTitle",{defaultMessage:"Ingest pipeline created"});uploadingDataTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.uploadingDataTitle",{defaultMessage:"Uploading data"});statusInfo=_react2.default.createElement(UploadFunctionProgress,{progress:uploadProgress})}if(completedStep>=4){uploadingDataTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.dataUploadedTitle",{defaultMessage:"Data uploaded"});if(createIndexPattern===true){createIndexPatternTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.creatingIndexPatternTitle",{defaultMessage:"Creating index pattern"});statusInfo=_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importProgress.creatingIndexPatternDescription",defaultMessage:"Creating index pattern"}))}else{statusInfo=null}}if(completedStep>=5){createIndexPatternTitle=_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importProgress.indexPatternCreatedTitle",{defaultMessage:"Index pattern created"});statusInfo=null}var steps=[{title:processFileTitle,isSelected:true,isComplete:readStatus===IMPORT_STATUS.COMPLETE&&parseJSONStatus===IMPORT_STATUS.COMPLETE,status:parseJSONStatus===IMPORT_STATUS.FAILED?parseJSONStatus:readStatus,onClick:function onClick(){}},{title:createIndexTitle,isSelected:readStatus===IMPORT_STATUS.COMPLETE,isComplete:indexCreatedStatus===IMPORT_STATUS.COMPLETE,status:indexCreatedStatus,onClick:function onClick(){}},{title:uploadingDataTitle,isSelected:indexCreatedStatus===IMPORT_STATUS.COMPLETE&&(createPipeline===false||createPipeline===true&&ingestPipelineCreatedStatus===IMPORT_STATUS.COMPLETE),isComplete:uploadStatus===IMPORT_STATUS.COMPLETE,status:uploadStatus,onClick:function onClick(){}}];if(createPipeline===true){steps.splice(2,0,{title:createIngestPipelineTitle,isSelected:indexCreatedStatus===IMPORT_STATUS.COMPLETE,isComplete:ingestPipelineCreatedStatus===IMPORT_STATUS.COMPLETE,status:ingestPipelineCreatedStatus,onClick:function onClick(){}})}if(createIndexPattern===true){steps.push({title:createIndexPatternTitle,isSelected:uploadStatus===IMPORT_STATUS.COMPLETE,isComplete:indexPatternCreatedStatus===IMPORT_STATUS.COMPLETE,status:indexPatternCreatedStatus,onClick:function onClick(){}})}return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiStepsHorizontal,{steps:steps,style:{backgroundColor:"transparent"}}),statusInfo&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),statusInfo))}function UploadFunctionProgress(_ref2){var progress=_ref2.progress;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importProgress.uploadingDataDescription",defaultMessage:"Uploading data"})),progress<100&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiProgress,{value:progress,max:100,color:"primary",size:"s"})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportErrors",{enumerable:true,get:function get(){return _errors.ImportErrors}});var _errors=__webpack_require__(1525)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportErrors=ImportErrors;var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _import_progress=__webpack_require__(503);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function ImportErrors(_ref){var errors=_ref.errors,statuses=_ref.statuses;return _react2.default.createElement(_eui.EuiCallOut,{title:title(statuses),color:"danger",iconType:"cross"},errors.map((function(e,i){return _react2.default.createElement(ImportError,{error:e,key:i})})))}function title(statuses){switch(_import_progress.IMPORT_STATUS.FAILED){case statuses.readStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.readingFileErrorMessage",defaultMessage:"Error reading file"});case statuses.parseJSONStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.parsingJSONErrorMessage",defaultMessage:"Error parsing JSON"});case statuses.indexCreatedStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.creatingIndexErrorMessage",defaultMessage:"Error creating index"});case statuses.ingestPipelineCreatedStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.creatingIngestPipelineErrorMessage",defaultMessage:"Error creating ingest pipeline"});case statuses.uploadStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.uploadingDataErrorMessage",defaultMessage:"Error uploading data"});case statuses.indexPatternCreatedStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.creatingIndexPatternErrorMessage",defaultMessage:"Error creating index pattern"});case statuses.permissionCheckStatus:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.checkingPermissionErrorMessage",defaultMessage:"Import permissions error"});default:return _react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.defaultErrorMessage",defaultMessage:"Error"})}}function ImportError(error,key){var errorObj=toString(error);return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement("p",{key:key},errorObj.msg),errorObj.more!==undefined&&_react2.default.createElement(_eui.EuiAccordion,{id:"more",buttonContent:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.moreButtonLabel",defaultMessage:"More"}),paddingSize:"m"},errorObj.more))}function toString(error){if(typeof error==="string"){return{msg:error}}if(_typeof(error)==="object"){if(error.msg!==undefined){return{msg:error.msg}}else if(error.error!==undefined){if(_typeof(error.error)==="object"){if(error.error.msg!==undefined){var errorObj={msg:error.error.msg};if(error.error.body!==undefined){errorObj.more=error.error.response}return errorObj}if(error.error.message!==undefined){return{msg:error.error.message}}}else{return{msg:error.error}}}else{return{msg:JSON.stringify(error)}}}return{msg:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importErrors.unknownErrorMessage",defaultMessage:"Unknown error"})}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportSummary",{enumerable:true,get:function get(){return _import_summary.ImportSummary}});var _import_summary=__webpack_require__(1527)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportSummary=ImportSummary;var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ImportSummary(_ref){var index=_ref.index,indexPattern=_ref.indexPattern,ingestPipelineId=_ref.ingestPipelineId,docCount=_ref.docCount,importFailures=_ref.importFailures,createIndexPattern=_ref.createIndexPattern,createPipeline=_ref.createPipeline;var items=createDisplayItems(index,indexPattern,ingestPipelineId,docCount,importFailures,createIndexPattern,createPipeline);return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiCallOut,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.importCompleteTitle",defaultMessage:"Import complete"}),color:"success",iconType:"check","data-test-subj":"mlFileImportSuccessCallout"},_react2.default.createElement(_eui.EuiDescriptionList,{type:"column",listItems:items,className:"import-summary-list"})),importFailures&&importFailures.length>0&&_react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiCallOut,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.documentsCouldNotBeImportedTitle",defaultMessage:"Some documents could not be imported"}),color:"warning",iconType:"help"},_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.documentsCouldNotBeImportedDescription",defaultMessage:"{importFailuresLength} out of {docCount} documents could not be imported. This could be due to lines not matching the Grok pattern.",values:{importFailuresLength:importFailures.length,docCount:docCount}})),_react2.default.createElement(Failures,{failedDocs:importFailures}))))}function Failures(_ref2){var failedDocs=_ref2.failedDocs;return _react2.default.createElement(_eui.EuiAccordion,{id:"failureList",buttonContent:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.failedDocumentsButtonLabel",defaultMessage:"Failed documents"}),paddingSize:"m"},_react2.default.createElement("div",{className:"failure-list"},failedDocs.map((function(_ref3){var item=_ref3.item,reason=_ref3.reason,doc=_ref3.doc;return _react2.default.createElement("div",{key:item},_react2.default.createElement("div",{className:"error-message"},item,": ",reason),_react2.default.createElement("div",null,JSON.stringify(doc)))}))))}function createDisplayItems(index,indexPattern,ingestPipelineId,docCount,importFailures,createIndexPattern,createPipeline){var items=[{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.indexTitle",defaultMessage:"Index"}),description:index},{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.documentsIngestedTitle",defaultMessage:"Documents ingested"}),description:docCount-(importFailures&&importFailures.length||0)}];if(createPipeline){items.splice(1,0,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.ingestPipelineTitle",defaultMessage:"Ingest pipeline"}),description:ingestPipelineId})}if(createIndexPattern){items.splice(1,0,{title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.indexPatternTitle",defaultMessage:"Index pattern"}),description:indexPattern})}if(importFailures&&importFailures.length>0){items.push({title:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.importSummary.failedDocumentsTitle",defaultMessage:"Failed documents"}),description:importFailures.length})}return items}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportSettings",{enumerable:true,get:function get(){return _import_settings.ImportSettings}});var _import_settings=__webpack_require__(1529)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportSettings=void 0;var _i18n=__webpack_require__(1);var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _simple=__webpack_require__(1530);var _advanced=__webpack_require__(1531);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ImportSettings=function ImportSettings(_ref){var index=_ref.index,indexPattern=_ref.indexPattern,initialized=_ref.initialized,onIndexChange=_ref.onIndexChange,createIndexPattern=_ref.createIndexPattern,onCreateIndexPatternChange=_ref.onCreateIndexPatternChange,onIndexPatternChange=_ref.onIndexPatternChange,indexSettingsString=_ref.indexSettingsString,mappingsString=_ref.mappingsString,pipelineString=_ref.pipelineString,onIndexSettingsStringChange=_ref.onIndexSettingsStringChange,onMappingsStringChange=_ref.onMappingsStringChange,onPipelineStringChange=_ref.onPipelineStringChange,indexNameError=_ref.indexNameError,indexPatternNameError=_ref.indexPatternNameError;var tabs=[{id:"simple-settings",name:_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importSettings.simpleTabName",{defaultMessage:"Simple"}),content:_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_simple.SimpleSettings,{index:index,initialized:initialized,onIndexChange:onIndexChange,createIndexPattern:createIndexPattern,onCreateIndexPatternChange:onCreateIndexPatternChange,indexNameError:indexNameError}))},{id:"advanced-settings",name:_i18n.i18n.translate("xpack.ml.fileDatavisualizer.importSettings.advancedTabName",{defaultMessage:"Advanced"}),content:_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_advanced.AdvancedSettings,{index:index,indexPattern:indexPattern,initialized:initialized,onIndexChange:onIndexChange,createIndexPattern:createIndexPattern,onCreateIndexPatternChange:onCreateIndexPatternChange,onIndexPatternChange:onIndexPatternChange,indexSettingsString:indexSettingsString,mappingsString:mappingsString,pipelineString:pipelineString,onIndexSettingsStringChange:onIndexSettingsStringChange,onMappingsStringChange:onMappingsStringChange,onPipelineStringChange:onPipelineStringChange,indexNameError:indexNameError,indexPatternNameError:indexPatternNameError}))}];return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiTabbedContent,{tabs:tabs,initialSelectedTab:tabs[0],onTabClick:function onTabClick(){}}))};exports.ImportSettings=ImportSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SimpleSettings=void 0;var _i18n=__webpack_require__(1);var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SimpleSettings=function SimpleSettings(_ref){var index=_ref.index,initialized=_ref.initialized,onIndexChange=_ref.onIndexChange,createIndexPattern=_ref.createIndexPattern,onCreateIndexPatternChange=_ref.onCreateIndexPatternChange,indexNameError=_ref.indexNameError;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.simpleImportSettings.indexNameFormRowLabel",defaultMessage:"Index name"}),isInvalid:indexNameError!=="",error:[indexNameError]},_react2.default.createElement(_eui.EuiFieldText,{placeholder:_i18n.i18n.translate("xpack.ml.fileDatavisualizer.simpleImportSettings.indexNamePlaceholder",{defaultMessage:"index name"}),value:index,disabled:initialized===true,onChange:onIndexChange,isInvalid:indexNameError!=="","aria-label":_i18n.i18n.translate("xpack.ml.fileDatavisualizer.simpleImportSettings.indexNameAriaLabel",{defaultMessage:"Index name, required field"}),"data-test-subj":"mlFileDataVisIndexNameInput"})),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiCheckbox,{id:"createIndexPattern",label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.simpleImportSettings.createIndexPatternLabel",defaultMessage:"Create index pattern"}),checked:createIndexPattern===true,disabled:initialized===true,onChange:onCreateIndexPatternChange,"data-test-subj":"mlFileDataVisCreateIndexPatternCheckbox"}))};exports.SimpleSettings=SimpleSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedSettings=AdvancedSettings;var _i18n=__webpack_require__(1);var _react=__webpack_require__(30);var _react2=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _ml_job_editor=__webpack_require__(103);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var EDITOR_HEIGHT="300px";function AdvancedSettings(_ref){var index=_ref.index,indexPattern=_ref.indexPattern,initialized=_ref.initialized,onIndexChange=_ref.onIndexChange,createIndexPattern=_ref.createIndexPattern,onCreateIndexPatternChange=_ref.onCreateIndexPatternChange,onIndexPatternChange=_ref.onIndexPatternChange,indexSettingsString=_ref.indexSettingsString,mappingsString=_ref.mappingsString,pipelineString=_ref.pipelineString,onIndexSettingsStringChange=_ref.onIndexSettingsStringChange,onMappingsStringChange=_ref.onMappingsStringChange,onPipelineStringChange=_ref.onPipelineStringChange,indexNameError=_ref.indexNameError,indexPatternNameError=_ref.indexPatternNameError;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.indexNameLabel",defaultMessage:"Index name"}),isInvalid:indexNameError!=="",error:[indexNameError]},_react2.default.createElement(_eui.EuiFieldText,{placeholder:_i18n.i18n.translate("xpack.ml.fileDatavisualizer.advancedImportSettings.indexNamePlaceholder",{defaultMessage:"index name"}),value:index,disabled:initialized===true,onChange:onIndexChange,isInvalid:indexNameError!=="","aria-label":_i18n.i18n.translate("xpack.ml.fileDatavisualizer.advancedImportSettings.indexNameAriaLabel",{defaultMessage:"Index name, required field"})})),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiCheckbox,{id:"createIndexPattern",label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.createIndexPatternLabel",defaultMessage:"Create index pattern"}),checked:createIndexPattern===true,disabled:initialized===true,onChange:onCreateIndexPatternChange}),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.indexPatternNameLabel",defaultMessage:"Index pattern name"}),disabled:createIndexPattern===false||initialized===true,isInvalid:indexPatternNameError!=="",error:[indexPatternNameError]},_react2.default.createElement(_eui.EuiFieldText,{disabled:createIndexPattern===false||initialized===true,placeholder:createIndexPattern===true?index:"",value:indexPattern,onChange:onIndexPatternChange,isInvalid:indexPatternNameError!==""})),_react2.default.createElement(_eui.EuiFlexGroup,null,_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(IndexSettings,{initialized:initialized,data:indexSettingsString,onChange:onIndexSettingsStringChange})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(Mappings,{initialized:initialized,data:mappingsString,onChange:onMappingsStringChange})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(IngestPipeline,{initialized:initialized,data:pipelineString,onChange:onPipelineStringChange}))))}function IndexSettings(_ref2){var initialized=_ref2.initialized,data=_ref2.data,onChange=_ref2.onChange;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.indexSettingsLabel",defaultMessage:"Index settings"}),disabled:initialized===true,fullWidth:true},_react2.default.createElement(_ml_job_editor.MLJobEditor,{mode:_ml_job_editor.ML_EDITOR_MODE.JSON,readOnly:initialized===true,value:data,height:EDITOR_HEIGHT,syntaxChecking:false,onChange:onChange})))}function Mappings(_ref3){var initialized=_ref3.initialized,data=_ref3.data,onChange=_ref3.onChange;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.mappingsLabel",defaultMessage:"Mappings"}),disabled:initialized===true,fullWidth:true},_react2.default.createElement(_ml_job_editor.MLJobEditor,{mode:_ml_job_editor.ML_EDITOR_MODE.JSON,readOnly:initialized===true,value:data,height:EDITOR_HEIGHT,syntaxChecking:false,onChange:onChange})))}function IngestPipeline(_ref4){var initialized=_ref4.initialized,data=_ref4.data,onChange=_ref4.onChange;return _react2.default.createElement(_react2.default.Fragment,null,_react2.default.createElement(_eui.EuiFormRow,{label:_react2.default.createElement(_react.FormattedMessage,{id:"xpack.ml.fileDatavisualizer.advancedImportSettings.ingestPipelineLabel",defaultMessage:"Ingest pipeline"}),disabled:initialized===true,fullWidth:true},_react2.default.createElement(_ml_job_editor.MLJobEditor,{mode:_ml_job_editor.ML_EDITOR_MODE.JSON,readOnly:initialized===true,value:data,height:EDITOR_HEIGHT,syntaxChecking:false,onChange:onChange})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.readFile=readFile;exports.reduceData=reduceData;exports.createUrlOverrides=createUrlOverrides;exports.processResults=processResults;exports.hasImportPermission=hasImportPermission;var _overrides=__webpack_require__(1533);var _lodash=__webpack_require__(49);var _ml_api_service=__webpack_require__(51);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function readFile(file){return new Promise((function(resolve,reject){if(file&&file.size){var reader=new FileReader;reader.readAsText(file);reader.onload=function(){return function(){var data=reader.result;if(data===""){reject()}else{resolve({data:data})}}}(file)}else{reject()}}))}function reduceData(data,mb){var size=mb*Math.pow(2,20);return data.length>=size?data.slice(0,size):data}function createUrlOverrides(overrides,originalSettings){var formattedOverrides={};for(var o in _overrides.overrideDefaults){if(_overrides.overrideDefaults.hasOwnProperty(o)){var value=overrides[o];if(Array.isArray(value)&&(0,_lodash.isEqual)(value,originalSettings[o])||value===undefined||value===originalSettings[o]){value=""}var snakeCaseO=o.replace(/([A-Z])/g,(function($1){return"_".concat($1.toLowerCase())}));formattedOverrides[snakeCaseO]=value}}if(formattedOverrides.format===""&&originalSettings.format==="delimited"){if(formattedOverrides.should_trim_fields!==""||formattedOverrides.has_header_row!==""||formattedOverrides.delimiter!==""||formattedOverrides.quote!==""||formattedOverrides.column_names!==""){formattedOverrides.format=originalSettings.format}if(Array.isArray(formattedOverrides.column_names)){formattedOverrides.column_names=formattedOverrides.column_names.join()}}if(formattedOverrides.format===""&&originalSettings.format==="semi_structured_text"){if(formattedOverrides.grok_pattern!==""){formattedOverrides.format=originalSettings.format}}if(formattedOverrides.format==="ndjson"||originalSettings.format==="ndjson"){formattedOverrides.should_trim_fields="";formattedOverrides.has_header_row="";formattedOverrides.delimiter="";formattedOverrides.quote="";formattedOverrides.column_names=""}if(formattedOverrides.lines_to_sample===""){formattedOverrides.lines_to_sample=overrides.linesToSample}return formattedOverrides}function processResults(results){var timestampFormat=results.java_timestamp_formats!==undefined&&results.java_timestamp_formats.length?results.java_timestamp_formats[0]:undefined;var linesToSample=results.overrides!==undefined&&results.overrides.lines_to_sample!==undefined?results.overrides.lines_to_sample:_overrides.DEFAULT_LINES_TO_SAMPLE;return{format:results.format,delimiter:results.delimiter,timestampField:results.timestamp_field,timestampFormat:timestampFormat,quote:results.quote,hasHeaderRow:results.has_header_row,shouldTrimFields:results.should_trim_fields,charset:results.charset,columnNames:results.column_names,grokPattern:results.grok_pattern,linesToSample:linesToSample}}function hasImportPermission(_x){return _hasImportPermission.apply(this,arguments)}function _hasImportPermission(){_hasImportPermission=_asyncToGenerator(regeneratorRuntime.mark((function _callee(indexName){var priv,resp;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:priv={cluster:["cluster:monitor/nodes/info","cluster:admin/ingest/pipeline/put"]};if(indexName!==undefined){priv.index=[{names:[indexName],privileges:["indices:data/write/bulk","indices:data/write/index","indices:admin/create"]}]}_context.next=4;return _ml_api_service.ml.hasPrivileges(priv);case 4:resp=_context.sent;return _context.abrupt("return",resp.securityDisabled===true||resp.has_all_requested===true);case 6:case"end":return _context.stop()}}}),_callee)})));return _hasImportPermission.apply(this,arguments)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.overrideDefaults=exports.DEFAULT_LINES_TO_SAMPLE=void 0;var DEFAULT_LINES_TO_SAMPLE=1e3;exports.DEFAULT_LINES_TO_SAMPLE=DEFAULT_LINES_TO_SAMPLE;var overrideDefaults={timestampFormat:undefined,timestampField:undefined,format:undefined,delimiter:undefined,quote:undefined,hasHeaderRow:undefined,charset:undefined,columnNames:undefined,shouldTrimFields:undefined,grokPattern:undefined,linesToSample:undefined};exports.overrideDefaults=overrideDefaults},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.INDEX_META_DATA_CREATED_BY=exports.MAX_BYTES=void 0;var MAX_BYTES=104857600;exports.MAX_BYTES=MAX_BYTES;var INDEX_META_DATA_CREATED_BY="ml-file-data-visualizer";exports.INDEX_META_DATA_CREATED_BY=INDEX_META_DATA_CREATED_BY},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _settings=__webpack_require__(1536);Object.keys(_settings).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _settings[key]}})}));var _calendar_list=__webpack_require__(1539);Object.keys(_calendar_list).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _calendar_list[key]}})}));var _calendar_new_edit=__webpack_require__(1562);Object.keys(_calendar_new_edit).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _calendar_new_edit[key]}})}));var _filter_list=__webpack_require__(1563);Object.keys(_filter_list).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _filter_list[key]}})}));var _filter_list_new_edit=__webpack_require__(1585);Object.keys(_filter_list_new_edit).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _filter_list_new_edit[key]}})}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.settingsRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _kibana=__webpack_require__(57);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _check_ml_nodes=__webpack_require__(81);var _settings=__webpack_require__(1537);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.SETTINGS];var settingsRoute={path:"/settings",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.settingsRoute=settingsRoute;var PageWrapper=function PageWrapper(_ref){var deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,{checkFullLicense:_license.checkFullLicense,checkGetJobsPrivilege:_check_privilege.checkGetJobsPrivilege,getMlNodeCount:_check_ml_nodes.getMlNodeCount}),context=_useResolver.context;(0,_kibana.useTimefilter)({timeRangeSelector:false,autoRefreshSelector:false});var canGetFilters=(0,_check_privilege.checkPermission)("canGetFilters");var canGetCalendars=(0,_check_privilege.checkPermission)("canGetCalendars");return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_settings.Settings,{canGetCalendars:canGetCalendars,canGetFilters:canGetFilters}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Settings",{enumerable:true,get:function get(){return _settings.Settings}});var _settings=__webpack_require__(1538)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Settings=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _navigation_menu=__webpack_require__(82);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Settings=function Settings(_ref){var canGetFilters=_ref.canGetFilters,canGetCalendars=_ref.canGetCalendars;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"settings"}),_react.default.createElement(_eui.EuiPage,{className:"mlSettingsPage","data-test-subj":"mlPageSettings"},_react.default.createElement(_eui.EuiPageBody,{className:"mlSettingsPage__body"},_react.default.createElement(_eui.EuiPageContent,{className:"mlSettingsPage__content",horizontalPosition:"center"},_react.default.createElement(_eui.EuiPageContentHeader,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.jobManagementTitle",defaultMessage:"Job Management"})))),_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{"data-test-subj":"ml_calendar_mng_button",size:"l",color:"primary",href:"#/settings/calendars_list",isDisabled:canGetCalendars===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendarManagementButtonLabel",defaultMessage:"Calendar management"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{"data-test-subj":"ml_filter_lists_button",size:"l",color:"primary",href:"#/settings/filter_lists",isDisabled:canGetFilters===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterListsButtonLabel",defaultMessage:"Filter Lists"}))))))))};exports.Settings=Settings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.calendarListRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _kibana=__webpack_require__(57);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _check_ml_nodes=__webpack_require__(81);var _calendars=__webpack_require__(505);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.SETTINGS,{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagementLabel",{defaultMessage:"Calendar management"}),href:"#/settings/calendars_list"}];var calendarListRoute={path:"/settings/calendars_list",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.calendarListRoute=calendarListRoute;var PageWrapper=function PageWrapper(_ref){var deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,{checkFullLicense:_license.checkFullLicense,checkGetJobsPrivilege:_check_privilege.checkGetJobsPrivilege,getMlNodeCount:_check_ml_nodes.getMlNodeCount}),context=_useResolver.context;(0,_kibana.useTimefilter)({timeRangeSelector:false,autoRefreshSelector:false});var canCreateCalendar=(0,_check_privilege.checkPermission)("canCreateCalendar");var canDeleteCalendar=(0,_check_privilege.checkPermission)("canDeleteCalendar");return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_calendars.CalendarsList,{canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NewCalendar",{enumerable:true,get:function get(){return _new_calendar.NewCalendar}});var _new_calendar=__webpack_require__(1541)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NewCalendar=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _navigation_menu=__webpack_require__(82);var _utils=__webpack_require__(263);var _calendar_form=__webpack_require__(1542);var _new_event_modal=__webpack_require__(1545);var _import_modal=__webpack_require__(1547);var _ml_api_service=__webpack_require__(51);var _public=__webpack_require__(31);var _calendars=__webpack_require__(259);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var NewCalendarUI=function(_Component){_inherits(NewCalendarUI,_Component);function NewCalendarUI(props){var _this;_classCallCheck(this,NewCalendarUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(NewCalendarUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"isDuplicateId",(function(){var _this$state=_this.state,calendars=_this$state.calendars,formCalendarId=_this$state.formCalendarId;for(var i=0;i<calendars.length;i++){if(calendars[i].calendar_id===formCalendarId){return true}}return false}));_defineProperty(_assertThisInitialized(_this),"onCreate",_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var formCalendarId,toasts,calendar,_toasts;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:formCalendarId=_this.state.formCalendarId;if(!_this.isDuplicateId()){_context.next=6;break}toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.calendarsEdit.canNotCreateCalendarWithExistingIdErrorMessag",{defaultMessage:"Cannot create calendar with id [{formCalendarId}] as it already exists.",values:{formCalendarId:formCalendarId}}));_context.next=20;break;case 6:calendar=_this.setUpCalendarForApi();_this.setState({saving:true});_context.prev=8;_context.next=11;return _ml_api_service.ml.addCalendar(calendar);case 11:window.location="#/settings/calendars_list";_context.next=20;break;case 14:_context.prev=14;_context.t0=_context["catch"](8);console.log("Error saving calendar",_context.t0);_this.setState({saving:false});_toasts=_this.props.kibana.services.notifications.toasts;_toasts.addDanger(_i18n.i18n.translate("xpack.ml.calendarsEdit.errorWithCreatingCalendarErrorMessage",{defaultMessage:"An error occurred creating calendar {calendarId}",values:{calendarId:calendar.calendarId}}));case 20:case"end":return _context.stop()}}}),_callee,null,[[8,14]])}))));_defineProperty(_assertThisInitialized(_this),"onEdit",_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var calendar,toasts;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:calendar=_this.setUpCalendarForApi();_this.setState({saving:true});_context2.prev=2;_context2.next=5;return _ml_api_service.ml.updateCalendar(calendar);case 5:window.location="#/settings/calendars_list";_context2.next=14;break;case 8:_context2.prev=8;_context2.t0=_context2["catch"](2);console.log("Error saving calendar",_context2.t0);_this.setState({saving:false});toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.calendarsEdit.errorWithUpdatingCalendarErrorMessage",{defaultMessage:"An error occurred saving calendar {calendarId}. Try refreshing the page.",values:{calendarId:calendar.calendarId}}));case 14:case"end":return _context2.stop()}}}),_callee2,null,[[2,8]])}))));_defineProperty(_assertThisInitialized(_this),"setUpCalendarForApi",(function(){var _this$state2=_this.state,formCalendarId=_this$state2.formCalendarId,description=_this$state2.description,events=_this$state2.events,selectedGroupOptions=_this$state2.selectedGroupOptions,selectedJobOptions=_this$state2.selectedJobOptions,isGlobalCalendar=_this$state2.isGlobalCalendar;var allIds=isGlobalCalendar?[_calendars.GLOBAL_CALENDAR]:[].concat(_toConsumableArray(selectedJobOptions.map((function(option){return option.label}))),_toConsumableArray(selectedGroupOptions.map((function(option){return option.label}))));var eventsToSave=events.map((function(event){return{description:event.description,start_time:event.start_time,end_time:event.end_time}}));var calendar={calendarId:formCalendarId,description:description,events:eventsToSave,job_ids:allIds};return calendar}));_defineProperty(_assertThisInitialized(_this),"onCreateGroupOption",(function(newGroup){var newOption={label:newGroup};_this.setState((function(prevState){return{selectedGroupOptions:prevState.selectedGroupOptions.concat(newOption)}}))}));_defineProperty(_assertThisInitialized(_this),"onGlobalCalendarChange",(function(_ref3){var currentTarget=_ref3.currentTarget;_this.setState({isGlobalCalendar:currentTarget.checked})}));_defineProperty(_assertThisInitialized(_this),"onJobSelection",(function(selectedJobOptions){_this.setState({selectedJobOptions:selectedJobOptions})}));_defineProperty(_assertThisInitialized(_this),"onGroupSelection",(function(selectedGroupOptions){_this.setState({selectedGroupOptions:selectedGroupOptions})}));_defineProperty(_assertThisInitialized(_this),"onCalendarIdChange",(function(e){var isValid=(0,_utils.validateCalendarId)(e.target.value);_this.setState({formCalendarId:e.target.value,isNewCalendarIdValid:isValid})}));_defineProperty(_assertThisInitialized(_this),"onDescriptionChange",(function(e){_this.setState({description:e.target.value})}));_defineProperty(_assertThisInitialized(_this),"showImportModal",(function(){_this.setState((function(prevState){return{isImportModalVisible:!prevState.isImportModalVisible}}))}));_defineProperty(_assertThisInitialized(_this),"closeImportModal",(function(){_this.setState({isImportModalVisible:false})}));_defineProperty(_assertThisInitialized(_this),"onEventDelete",(function(eventId){_this.setState((function(prevState){return{events:prevState.events.filter((function(event){return event.event_id!==eventId}))}}))}));_defineProperty(_assertThisInitialized(_this),"closeNewEventModal",(function(){_this.setState({isNewEventModalVisible:false})}));_defineProperty(_assertThisInitialized(_this),"showNewEventModal",(function(){_this.setState({isNewEventModalVisible:true})}));_defineProperty(_assertThisInitialized(_this),"addEvent",(function(event){_this.setState((function(prevState){return{events:[].concat(_toConsumableArray(prevState.events),[event]),isNewEventModalVisible:false}}))}));_defineProperty(_assertThisInitialized(_this),"addImportedEvents",(function(events){_this.setState((function(prevState){return{events:[].concat(_toConsumableArray(prevState.events),_toConsumableArray(events)),isImportModalVisible:false}}))}));_this.state={isNewEventModalVisible:false,isImportModalVisible:false,isNewCalendarIdValid:null,loading:true,jobIds:[],jobIdOptions:[],groupIds:[],groupIdOptions:[],calendars:[],formCalendarId:"",description:"",selectedJobOptions:[],selectedGroupOptions:[],events:[],saving:false,selectedCalendar:undefined,isGlobalCalendar:false};return _this}_createClass(NewCalendarUI,[{key:"componentDidMount",value:function componentDidMount(){this.formSetup()}},{key:"formSetup",value:function(){var _formSetup=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _this2=this;var _ref4,jobIds,groupIds,calendars,jobIdOptions,groupIdOptions,selectedJobOptions,selectedGroupOptions,eventsList,selectedCalendar,formCalendarId,isGlobalCalendar,toasts;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return(0,_utils.getCalendarSettingsData)();case 3:_ref4=_context3.sent;jobIds=_ref4.jobIds;groupIds=_ref4.groupIds;calendars=_ref4.calendars;jobIdOptions=jobIds.map((function(jobId){return{label:jobId}}));groupIdOptions=groupIds.map((function(groupId){return{label:groupId}}));selectedJobOptions=[];selectedGroupOptions=[];eventsList=[];formCalendarId="";isGlobalCalendar=false;if(this.props.calendarId!==undefined){selectedCalendar=calendars.find((function(cal){return cal.calendar_id===_this2.props.calendarId}));if(selectedCalendar){formCalendarId=selectedCalendar.calendar_id;eventsList=selectedCalendar.events;if(selectedCalendar.job_ids.includes(_calendars.GLOBAL_CALENDAR)){isGlobalCalendar=true}else{selectedCalendar.job_ids.forEach((function(id){if(jobIds.find((function(jobId){return jobId===id}))){selectedJobOptions.push({label:id})}else if(groupIds.find((function(groupId){return groupId===id}))){selectedGroupOptions.push({label:id})}}))}}}this.setState({events:eventsList,formCalendarId:formCalendarId,jobIds:jobIds,jobIdOptions:jobIdOptions,groupIds:groupIds,groupIdOptions:groupIdOptions,calendars:calendars,loading:false,selectedJobOptions:selectedJobOptions,selectedGroupOptions:selectedGroupOptions,selectedCalendar:selectedCalendar,isGlobalCalendar:isGlobalCalendar});_context3.next=24;break;case 18:_context3.prev=18;_context3.t0=_context3["catch"](0);console.log(_context3.t0);this.setState({loading:false});toasts=this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingCalendarFromDataErrorMessage",{defaultMessage:"An error occurred loading calendar form data. Try refreshing the page."}));case 24:case"end":return _context3.stop()}}}),_callee3,this,[[0,18]])})));function formSetup(){return _formSetup.apply(this,arguments)}return formSetup}()},{key:"render",value:function render(){var _this$state3=this.state,events=_this$state3.events,isNewEventModalVisible=_this$state3.isNewEventModalVisible,isImportModalVisible=_this$state3.isImportModalVisible,isNewCalendarIdValid=_this$state3.isNewCalendarIdValid,formCalendarId=_this$state3.formCalendarId,description=_this$state3.description,groupIdOptions=_this$state3.groupIdOptions,jobIdOptions=_this$state3.jobIdOptions,saving=_this$state3.saving,selectedCalendar=_this$state3.selectedCalendar,selectedJobOptions=_this$state3.selectedJobOptions,selectedGroupOptions=_this$state3.selectedGroupOptions,isGlobalCalendar=_this$state3.isGlobalCalendar;var modal="";if(isNewEventModalVisible){modal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_new_event_modal.NewEventModal,{addEvent:this.addEvent,closeModal:this.closeNewEventModal}))}else if(isImportModalVisible){modal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_import_modal.ImportModal,{addImportedEvents:this.addImportedEvents,closeImportModal:this.closeImportModal}))}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"settings"}),_react.default.createElement(_eui.EuiPage,{className:"mlCalendarEditForm"},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiPageContent,{className:"mlCalendarEditForm__content",verticalPosition:"center",horizontalPosition:"center"},_react.default.createElement(_calendar_form.CalendarForm,{calendarId:selectedCalendar?selectedCalendar.calendar_id:formCalendarId,canCreateCalendar:this.props.canCreateCalendar,canDeleteCalendar:this.props.canDeleteCalendar,description:selectedCalendar?selectedCalendar.description:description,eventsList:events,groupIds:groupIdOptions,isEdit:selectedCalendar!==undefined,isNewCalendarIdValid:selectedCalendar||isNewCalendarIdValid===null?true:isNewCalendarIdValid,jobIds:jobIdOptions,onCalendarIdChange:this.onCalendarIdChange,onCreate:this.onCreate,onDescriptionChange:this.onDescriptionChange,onEdit:this.onEdit,onEventDelete:this.onEventDelete,onGroupSelection:this.onGroupSelection,showImportModal:this.showImportModal,onJobSelection:this.onJobSelection,saving:saving,selectedGroupOptions:selectedGroupOptions,selectedJobOptions:selectedJobOptions,onCreateGroupOption:this.onCreateGroupOption,showNewEventModal:this.showNewEventModal,isGlobalCalendar:isGlobalCalendar,onGlobalCalendarChange:this.onGlobalCalendarChange})),modal)))}}]);return NewCalendarUI}(_react.Component);_defineProperty(NewCalendarUI,"propTypes",{calendarId:_propTypes.PropTypes.string,canCreateCalendar:_propTypes.PropTypes.bool.isRequired,canDeleteCalendar:_propTypes.PropTypes.bool.isRequired});var NewCalendar=(0,_public.withKibana)(NewCalendarUI);exports.NewCalendar=NewCalendar},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CalendarForm",{enumerable:true,get:function get(){return _calendar_form.CalendarForm}});var _calendar_form=__webpack_require__(1543)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CalendarForm=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);var _events_table=__webpack_require__(264);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function EditHeader(_ref){var calendarId=_ref.calendarId,description=_ref.description;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.calendarTitle",defaultMessage:"Calendar {calendarId}",values:{calendarId:calendarId}}))),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,description)),_react.default.createElement(_eui.EuiSpacer,{size:"l"}))}var CalendarForm=function CalendarForm(_ref2){var calendarId=_ref2.calendarId,canCreateCalendar=_ref2.canCreateCalendar,canDeleteCalendar=_ref2.canDeleteCalendar,description=_ref2.description,eventsList=_ref2.eventsList,groupIds=_ref2.groupIds,isEdit=_ref2.isEdit,isNewCalendarIdValid=_ref2.isNewCalendarIdValid,jobIds=_ref2.jobIds,onCalendarIdChange=_ref2.onCalendarIdChange,onCreate=_ref2.onCreate,onCreateGroupOption=_ref2.onCreateGroupOption,onDescriptionChange=_ref2.onDescriptionChange,onEdit=_ref2.onEdit,onEventDelete=_ref2.onEventDelete,onGroupSelection=_ref2.onGroupSelection,showImportModal=_ref2.showImportModal,onJobSelection=_ref2.onJobSelection,saving=_ref2.saving,selectedGroupOptions=_ref2.selectedGroupOptions,selectedJobOptions=_ref2.selectedJobOptions,showNewEventModal=_ref2.showNewEventModal,isGlobalCalendar=_ref2.isGlobalCalendar,onGlobalCalendarChange=_ref2.onGlobalCalendarChange;var msg=_i18n.i18n.translate("xpack.ml.calendarsEdit.calendarForm.allowedCharactersDescription",{defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores; "+"must start and end with an alphanumeric character"});var helpText=isNewCalendarIdValid===true&&!isEdit?msg:undefined;var error=isNewCalendarIdValid===false&&!isEdit?[msg]:undefined;var saveButtonDisabled=canCreateCalendar===false||saving||!isNewCalendarIdValid||calendarId==="";return _react.default.createElement(_eui.EuiForm,null,isEdit===true?_react.default.createElement(EditHeader,{calendarId:calendarId,description:description}):_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.createCalendarTitle",defaultMessage:"Create new calendar"}))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.calendarIdLabel",defaultMessage:"Calendar ID"}),helpText:helpText,error:error,isInvalid:!isNewCalendarIdValid},_react.default.createElement(_eui.EuiFieldText,{name:"calendarId",value:calendarId,onChange:onCalendarIdChange,disabled:isEdit===true||saving===true})),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.descriptionLabel",defaultMessage:"Description"})},_react.default.createElement(_eui.EuiFieldText,{name:"description",value:description,onChange:onDescriptionChange,disabled:isEdit===true||saving===true}))),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiSwitch,{name:"switch",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.allJobsLabel",defaultMessage:"Apply calendar to all jobs"}),checked:isGlobalCalendar,onChange:onGlobalCalendarChange}),isGlobalCalendar===false&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.jobsLabel",defaultMessage:"Jobs"})},_react.default.createElement(_eui.EuiComboBox,{options:jobIds,selectedOptions:selectedJobOptions,onChange:onJobSelection,isDisabled:saving===true||canCreateCalendar===false})),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.groupsLabel",defaultMessage:"Groups"})},_react.default.createElement(_eui.EuiComboBox,{onCreateOption:onCreateGroupOption,options:groupIds,selectedOptions:selectedGroupOptions,onChange:onGroupSelection,isDisabled:saving===true||canCreateCalendar===false}))),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.eventsLabel",defaultMessage:"Events"}),fullWidth:true},_react.default.createElement(_events_table.EventsTable,{canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar,eventsList:eventsList,onDeleteClick:onEventDelete,showImportModal:showImportModal,showNewEventModal:showNewEventModal,showSearchBar:true})),_react.default.createElement(_eui.EuiSpacer,{size:"l"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{isDisabled:saving,href:"#/settings/calendars_list"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.cancelButtonLabel",defaultMessage:"Cancel"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{"data-test-subj":"ml_save_calendar_button",fill:true,onClick:isEdit?onEdit:onCreate,isDisabled:saveButtonDisabled},saving?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.savingButtonLabel",defaultMessage:"Saving…"}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.saveButtonLabel",defaultMessage:"Save"})))))};exports.CalendarForm=CalendarForm;CalendarForm.propTypes={calendarId:_propTypes.PropTypes.string.isRequired,canCreateCalendar:_propTypes.PropTypes.bool.isRequired,canDeleteCalendar:_propTypes.PropTypes.bool.isRequired,description:_propTypes.PropTypes.string,groupIds:_propTypes.PropTypes.array.isRequired,isEdit:_propTypes.PropTypes.bool.isRequired,isNewCalendarIdValid:_propTypes.PropTypes.bool.isRequired,jobIds:_propTypes.PropTypes.array.isRequired,onCalendarIdChange:_propTypes.PropTypes.func.isRequired,onCreate:_propTypes.PropTypes.func.isRequired,onCreateGroupOption:_propTypes.PropTypes.func.isRequired,onDescriptionChange:_propTypes.PropTypes.func.isRequired,onEdit:_propTypes.PropTypes.func.isRequired,onEventDelete:_propTypes.PropTypes.func.isRequired,onGroupSelection:_propTypes.PropTypes.func.isRequired,showImportModal:_propTypes.PropTypes.func.isRequired,onJobSelection:_propTypes.PropTypes.func.isRequired,saving:_propTypes.PropTypes.bool.isRequired,selectedGroupOptions:_propTypes.PropTypes.array.isRequired,selectedJobOptions:_propTypes.PropTypes.array.isRequired,showNewEventModal:_propTypes.PropTypes.func.isRequired,isGlobalCalendar:_propTypes.PropTypes.bool.isRequired,onGlobalCalendarChange:_propTypes.PropTypes.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EventsTable=exports.TIME_FORMAT=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _moment=_interopRequireDefault(__webpack_require__(32));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TIME_FORMAT="YYYY-MM-DD HH:mm:ss";exports.TIME_FORMAT=TIME_FORMAT;function DeleteButton(_ref){var onClick=_ref.onClick,canDeleteCalendar=_ref.canDeleteCalendar;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiButtonEmpty,{size:"xs",color:"danger",onClick:onClick,isDisabled:canDeleteCalendar===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.deleteButtonLabel",defaultMessage:"Delete"})))}var EventsTable=function EventsTable(_ref2){var canCreateCalendar=_ref2.canCreateCalendar,canDeleteCalendar=_ref2.canDeleteCalendar,eventsList=_ref2.eventsList,onDeleteClick=_ref2.onDeleteClick,showSearchBar=_ref2.showSearchBar,showImportModal=_ref2.showImportModal,showNewEventModal=_ref2.showNewEventModal;var sorting={sort:{field:"description",direction:"asc"}};var pagination={initialPageSize:5,pageSizeOptions:[5,10]};var columns=[{field:"description",name:_i18n.i18n.translate("xpack.ml.calendarsEdit.eventsTable.descriptionColumnName",{defaultMessage:"Description"}),sortable:true,truncateText:true,scope:"row"},{field:"start_time",name:_i18n.i18n.translate("xpack.ml.calendarsEdit.eventsTable.startColumnName",{defaultMessage:"Start"}),sortable:true,render:function render(timeMs){var time=(0,_moment.default)(timeMs);return time.format(TIME_FORMAT)}},{field:"end_time",name:_i18n.i18n.translate("xpack.ml.calendarsEdit.eventsTable.endColumnName",{defaultMessage:"End"}),sortable:true,render:function render(timeMs){var time=(0,_moment.default)(timeMs);return time.format(TIME_FORMAT)}},{field:"",name:"",render:function render(event){return _react.default.createElement(DeleteButton,{"data-test-subj":"event_delete",canDeleteCalendar:canDeleteCalendar,onClick:function onClick(){onDeleteClick(event.event_id)}})}}];var search={toolsRight:[_react.default.createElement(_eui.EuiButton,{isDisabled:canCreateCalendar===false,key:"ml_new_event","data-test-subj":"ml_new_event",size:"s",iconType:"plusInCircle",onClick:showNewEventModal},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.newEventButtonLabel",defaultMessage:"New event"})),_react.default.createElement(_eui.EuiButton,{isDisabled:canCreateCalendar===false,key:"ml_import_event","data-test-subj":"ml_import_events",size:"s",iconType:"importAction",onClick:showImportModal},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsButtonLabel",defaultMessage:"Import events"}))],box:{incremental:true},filters:[]};return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiInMemoryTable,{items:eventsList,itemId:"event_id",columns:columns,pagination:pagination,sorting:sorting,search:showSearchBar?search:undefined}))};exports.EventsTable=EventsTable;EventsTable.propTypes={canCreateCalendar:_propTypes.default.bool,canDeleteCalendar:_propTypes.default.bool,eventsList:_propTypes.default.array.isRequired,onDeleteClick:_propTypes.default.func.isRequired,showImportModal:_propTypes.default.func,showNewEventModal:_propTypes.default.func,showSearchBar:_propTypes.default.bool};EventsTable.defaultProps={showSearchBar:false,canCreateCalendar:true,canDeleteCalendar:true}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NewEventModal",{enumerable:true,get:function get(){return _new_event_modal.NewEventModal}});var _new_event_modal=__webpack_require__(1546)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NewEventModal=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);var _moment=_interopRequireDefault(__webpack_require__(32));var _events_table=__webpack_require__(264);var _utils=__webpack_require__(263);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var VALID_DATE_STRING_LENGTH=19;var NewEventModal=function(_Component){_inherits(NewEventModal,_Component);function NewEventModal(props){var _this;_classCallCheck(this,NewEventModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(NewEventModal).call(this,props));_defineProperty(_assertThisInitialized(_this),"onDescriptionChange",(function(e){_this.setState({description:e.target.value})}));_defineProperty(_assertThisInitialized(_this),"handleAddEvent",(function(){var _this$state=_this.state,description=_this$state.description,startDate=_this$state.startDate,endDate=_this$state.endDate;var tempId=(0,_utils.generateTempId)();var event={description:description,start_time:startDate.valueOf(),end_time:endDate.valueOf(),event_id:tempId};_this.props.addEvent(event)}));_defineProperty(_assertThisInitialized(_this),"handleChangeStart",(function(date){var start=null;var end=_this.state.endDate;var startMoment=(0,_moment.default)(date);var endMoment=(0,_moment.default)(date);start=startMoment.startOf("day");if(start>end){end=endMoment.startOf("day").add(1,"days")}_this.setState({startDate:start,endDate:end,startDateString:start.format(_events_table.TIME_FORMAT),endDateString:end.format(_events_table.TIME_FORMAT)})}));_defineProperty(_assertThisInitialized(_this),"handleChangeEnd",(function(date){var start=_this.state.startDate;var end=null;var startMoment=(0,_moment.default)(date);var endMoment=(0,_moment.default)(date);end=endMoment.startOf("day");if(start>end){start=startMoment.startOf("day").subtract(1,"days")}_this.setState({startDate:start,endDate:end,startDateString:start.format(_events_table.TIME_FORMAT),endDateString:end.format(_events_table.TIME_FORMAT)})}));_defineProperty(_assertThisInitialized(_this),"handleTimeStartChange",(function(event){var dateString=event.target.value;var isValidDate=false;if(dateString.length===VALID_DATE_STRING_LENGTH){isValidDate=(0,_moment.default)(dateString).isValid(_events_table.TIME_FORMAT,true)}else{_this.setState({startDateString:dateString})}if(isValidDate){_this.setState({startDateString:dateString,startDate:(0,_moment.default)(dateString)})}}));_defineProperty(_assertThisInitialized(_this),"handleTimeEndChange",(function(event){var dateString=event.target.value;var isValidDate=false;if(dateString.length===VALID_DATE_STRING_LENGTH){isValidDate=(0,_moment.default)(dateString).isValid(_events_table.TIME_FORMAT,true)}else{_this.setState({endDateString:dateString})}if(isValidDate){_this.setState({endDateString:dateString,endDate:(0,_moment.default)(dateString)})}}));_defineProperty(_assertThisInitialized(_this),"renderRangedDatePicker",(function(){var _this$state2=_this.state,startDate=_this$state2.startDate,endDate=_this$state2.endDate,startDateString=_this$state2.startDateString,endDateString=_this$state2.endDateString;var timeInputs=_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.fromLabel",defaultMessage:"From:"}),helpText:_events_table.TIME_FORMAT},_react.default.createElement(_eui.EuiFieldText,{name:"startTime",onChange:_this.handleTimeStartChange,placeholder:_events_table.TIME_FORMAT,value:startDateString}))),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.toLabel",defaultMessage:"To:"}),helpText:_events_table.TIME_FORMAT},_react.default.createElement(_eui.EuiFieldText,{name:"endTime",onChange:_this.handleTimeEndChange,placeholder:_events_table.TIME_FORMAT,value:endDateString})))));return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),timeInputs,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true},_react.default.createElement(_eui.EuiDatePickerRange,{fullWidth:true,iconType:false,startDateControl:_react.default.createElement(_eui.EuiDatePicker,{fullWidth:true,inline:true,selected:startDate,onChange:_this.handleChangeStart,startDate:startDate,endDate:endDate,isInvalid:startDate>endDate,"aria-label":_i18n.i18n.translate("xpack.ml.calendarsEdit.newEventModal.startDateAriaLabel",{defaultMessage:"Start date"}),timeFormat:_events_table.TIME_FORMAT,dateFormat:_events_table.TIME_FORMAT}),endDateControl:_react.default.createElement(_eui.EuiDatePicker,{fullWidth:true,inline:true,selected:endDate,onChange:_this.handleChangeEnd,startDate:startDate,endDate:endDate,isInvalid:startDate>endDate,"aria-label":_i18n.i18n.translate("xpack.ml.calendarsEdit.newEventModal.endDateAriaLabel",{defaultMessage:"End date"}),timeFormat:_events_table.TIME_FORMAT,dateFormat:_events_table.TIME_FORMAT})})))}));var _startDate=(0,_moment.default)().startOf("day");var _endDate=(0,_moment.default)().startOf("day").add(1,"days");_this.state={startDate:_startDate,endDate:_endDate,description:"",startDateString:_startDate.format(_events_table.TIME_FORMAT),endDateString:_endDate.format(_events_table.TIME_FORMAT)};return _this}_createClass(NewEventModal,[{key:"render",value:function render(){var closeModal=this.props.closeModal;var description=this.state.description;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiModal,{onClose:closeModal,initialFocus:"[name=eventDescription]",maxWidth:false},_react.default.createElement(_eui.EuiModalHeader,null,_react.default.createElement(_eui.EuiModalHeaderTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.createNewEventTitle",defaultMessage:"Create new event"}))),_react.default.createElement(_eui.EuiModalBody,null,_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.descriptionLabel",defaultMessage:"Description"}),fullWidth:true},_react.default.createElement(_eui.EuiFieldText,{name:"eventDescription",onChange:this.onDescriptionChange,isInvalid:!description,fullWidth:true})),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),this.renderRangedDatePicker())),_react.default.createElement(_eui.EuiModalFooter,null,_react.default.createElement(_eui.EuiButtonEmpty,{onClick:closeModal},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.cancelButtonLabel",defaultMessage:"Cancel"})),_react.default.createElement(_eui.EuiButton,{onClick:this.handleAddEvent,fill:true,disabled:!description},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.addButtonLabel",defaultMessage:"Add"})))))}}]);return NewEventModal}(_react.Component);exports.NewEventModal=NewEventModal;_defineProperty(NewEventModal,"propTypes",{closeModal:_propTypes.PropTypes.func.isRequired,addEvent:_propTypes.PropTypes.func.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportModal",{enumerable:true,get:function get(){return _import_modal.ImportModal}});var _import_modal=__webpack_require__(1548)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportModal=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);var _imported_events=__webpack_require__(1549);var _utils=__webpack_require__(1551);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var MAX_FILE_SIZE_MB=100;var ImportModal=function(_Component){_inherits(ImportModal,_Component);function ImportModal(props){var _this;_classCallCheck(this,ImportModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(ImportModal).call(this,props));_defineProperty(_assertThisInitialized(_this),"handleImport",function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(loadedFile){var incomingFile,errorMessage,events,parsedFile;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:incomingFile=loadedFile[0];errorMessage=_i18n.i18n.translate("xpack.ml.calendarsEdit.importModal.couldNotParseICSFileErrorMessage",{defaultMessage:"Could not parse ICS file."});events=[];if(!(incomingFile&&incomingFile.size<=MAX_FILE_SIZE_MB*1e6)){_context.next=19;break}_this.setState({fileLoading:true,fileLoaded:true});_context.prev=5;_context.next=8;return(0,_utils.readFile)(incomingFile);case 8:parsedFile=_context.sent;events=(0,_utils.parseICSFile)(parsedFile.data);_this.setState({allImportedEvents:events,selectedEvents:(0,_utils.filterEvents)(events),fileLoading:false,errorMessage:null,includePastEvents:false});_context.next=17;break;case 13:_context.prev=13;_context.t0=_context["catch"](5);console.log(errorMessage,_context.t0);_this.setState({errorMessage:errorMessage,fileLoading:false});case 17:_context.next=20;break;case 19:if(incomingFile&&incomingFile.size>MAX_FILE_SIZE_MB*1e6){_this.setState({fileLoading:false,errorMessage:errorMessage})}else{_this.setState({fileLoading:false,errorMessage:null})}case 20:case"end":return _context.stop()}}}),_callee,null,[[5,13]])})));return function(_x){return _ref.apply(this,arguments)}}());_defineProperty(_assertThisInitialized(_this),"onEventDelete",(function(eventId){_this.setState((function(prevState){return{allImportedEvents:prevState.allImportedEvents.filter((function(event){return event.event_id!==eventId})),selectedEvents:prevState.selectedEvents.filter((function(event){return event.event_id!==eventId}))}}))}));_defineProperty(_assertThisInitialized(_this),"onCheckboxToggle",(function(e){_this.setState({includePastEvents:e.target.checked})}));_defineProperty(_assertThisInitialized(_this),"handleEventsAdd",(function(){var _this$state=_this.state,allImportedEvents=_this$state.allImportedEvents,selectedEvents=_this$state.selectedEvents,includePastEvents=_this$state.includePastEvents;var eventsToImport=includePastEvents?allImportedEvents:selectedEvents;var events=eventsToImport.map((function(event){return{description:event.description,start_time:event.start_time,end_time:event.end_time,event_id:event.event_id}}));_this.props.addImportedEvents(events)}));_defineProperty(_assertThisInitialized(_this),"renderCallout",(function(){return _react.default.createElement(_eui.EuiCallOut,{color:"danger"},_react.default.createElement("p",null,_this.state.errorMessage))}));_this.state={includePastEvents:false,allImportedEvents:[],selectedEvents:[],fileLoading:false,fileLoaded:false,errorMessage:null};return _this}_createClass(ImportModal,[{key:"render",value:function render(){var closeImportModal=this.props.closeImportModal;var _this$state2=this.state,fileLoading=_this$state2.fileLoading,fileLoaded=_this$state2.fileLoaded,allImportedEvents=_this$state2.allImportedEvents,selectedEvents=_this$state2.selectedEvents,errorMessage=_this$state2.errorMessage,includePastEvents=_this$state2.includePastEvents;var showRecurringWarning=false;var importedEvents;if(includePastEvents){importedEvents=allImportedEvents}else{importedEvents=selectedEvents}if(importedEvents.find((function(e){return e.asterisk}))!==undefined){showRecurringWarning=true}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiModal,{onClose:closeImportModal,maxWidth:true},_react.default.createElement(_eui.EuiModalHeader,null,_react.default.createElement(_eui.EuiFlexGroup,{direction:"column",gutterSize:"none"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiModalHeaderTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsTitle",defaultMessage:"Import events"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsDescription",defaultMessage:"Import events from an ICS file."}))))),_react.default.createElement(_eui.EuiModalBody,null,_react.default.createElement(_eui.EuiFlexGroup,{direction:"column"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFilePicker,{compressed:true,initialPromptText:_i18n.i18n.translate("xpack.ml.calendarsEdit.importModal.selectOrDragAndDropFilePromptText",{defaultMessage:"Select or drag and drop a file"}),onChange:this.handleImport,disabled:fileLoading})),errorMessage!==null&&this.renderCallout(),allImportedEvents.length>0&&_react.default.createElement(_imported_events.ImportedEvents,{events:importedEvents,showRecurringWarning:showRecurringWarning,includePastEvents:includePastEvents,onCheckboxToggle:this.onCheckboxToggle,onEventDelete:this.onEventDelete}))),_react.default.createElement(_eui.EuiModalFooter,null,_react.default.createElement(_eui.EuiButtonEmpty,{onClick:closeImportModal},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.cancelButtonLabel",defaultMessage:"Cancel"})),_react.default.createElement(_eui.EuiButton,{onClick:this.handleEventsAdd,fill:true,disabled:fileLoaded===false||errorMessage!==null},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importButtonLabel",defaultMessage:"Import"})))))}}]);return ImportModal}(_react.Component);exports.ImportModal=ImportModal;_defineProperty(ImportModal,"propTypes",{addImportedEvents:_propTypes.PropTypes.func.isRequired,closeImportModal:_propTypes.PropTypes.func.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ImportedEvents",{enumerable:true,get:function get(){return _imported_events.ImportedEvents}});var _imported_events=__webpack_require__(1550)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ImportedEvents=ImportedEvents;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);var _events_table=__webpack_require__(264);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ImportedEvents(_ref){var events=_ref.events,showRecurringWarning=_ref.showRecurringWarning,includePastEvents=_ref.includePastEvents,onCheckboxToggle=_ref.onCheckboxToggle,onEventDelete=_ref.onEventDelete;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.eventsToImportTitle",defaultMessage:"Events to import: {eventsCount}",values:{eventsCount:events.length}})),showRecurringWarning&&_react.default.createElement(_eui.EuiText,{color:"danger"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.recurringEventsNotSupportedDescription",defaultMessage:"Recurring events not supported. Only the first event will be imported."}))))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_events_table.EventsTable,{eventsList:events,onDeleteClick:onEventDelete})),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCheckbox,{id:"ml-include-past-events",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.includePastEventsLabel",defaultMessage:"Include past events"}),checked:includePastEvents,onChange:onCheckboxToggle})))}ImportedEvents.propTypes={events:_propTypes.PropTypes.array.isRequired,showRecurringWarning:_propTypes.PropTypes.bool.isRequired,includePastEvents:_propTypes.PropTypes.bool.isRequired,onCheckboxToggle:_propTypes.PropTypes.func.isRequired,onEventDelete:_propTypes.PropTypes.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.filterEvents=filterEvents;exports.parseICSFile=parseICSFile;exports.readFile=readFile;var _moment=_interopRequireDefault(__webpack_require__(32));var _utils=__webpack_require__(263);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var icalendar=__webpack_require__(506);function createEvents(ical){var events=ical.events();var mlEvents=[];events.forEach((function(e){if(e.element==="VEVENT"){var description=e.properties.SUMMARY;var start=e.properties.DTSTART;var end=e.properties.DTEND;var recurring=e.properties.RRULE!==undefined;if(description&&start&&end&&description.length&&start.length&&end.length){var tempId=(0,_utils.generateTempId)();mlEvents.push({event_id:tempId,description:description[0].value,start_time:start[0].value.valueOf(),end_time:end[0].value.valueOf(),asterisk:recurring})}}}));return mlEvents}function filterEvents(events){var now=(0,_moment.default)().valueOf();return events.filter((function(e){return e.start_time>now}))}function parseICSFile(data){var cal=icalendar.parse_calendar(data);return createEvents(cal)}function readFile(file){return new Promise((function(resolve,reject){if(file&&file.size){var reader=new FileReader;reader.readAsText(file);reader.onload=function(){return function(){var data=reader.result;if(data===""){reject()}else{resolve({data:data})}}}(file)}else{reject()}}))}},,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CalendarsList",{enumerable:true,get:function get(){return _calendars_list.CalendarsList}});var _calendars_list=__webpack_require__(1557)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CalendarsList=exports.CalendarsListUI=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);var _navigation_menu=__webpack_require__(82);var _header=__webpack_require__(1558);var _table=__webpack_require__(1559);var _ml_api_service=__webpack_require__(51);var _check_ml_nodes=__webpack_require__(81);var _delete_calendars=__webpack_require__(1561);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _public=__webpack_require__(31);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CalendarsListUI=function(_Component){_inherits(CalendarsListUI,_Component);function CalendarsListUI(props){var _this;_classCallCheck(this,CalendarsListUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(CalendarsListUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"loadCalendars",_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var calendars,toasts;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({loading:true});_context.prev=1;_context.next=4;return _ml_api_service.ml.calendars();case 4:calendars=_context.sent;_this.setState({calendars:calendars,loading:false,isDestroyModalVisible:false});_context.next=14;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);console.log(_context.t0);_this.setState({loading:false});toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.calendarsList.errorWithLoadingListOfCalendarsErrorMessage",{defaultMessage:"An error occurred loading the list of calendars."}));case 14:case"end":return _context.stop()}}}),_callee,null,[[1,8]])}))));_defineProperty(_assertThisInitialized(_this),"closeDestroyModal",(function(){_this.setState({isDestroyModalVisible:false,calendarId:null})}));_defineProperty(_assertThisInitialized(_this),"showDestroyModal",(function(){_this.setState({isDestroyModalVisible:true})}));_defineProperty(_assertThisInitialized(_this),"setSelectedCalendarList",(function(selectedCalendars){_this.setState({selectedForDeletion:selectedCalendars})}));_defineProperty(_assertThisInitialized(_this),"deleteCalendars",(function(){var selectedForDeletion=_this.state.selectedForDeletion;_this.closeDestroyModal();(0,_delete_calendars.deleteCalendars)(selectedForDeletion,_this.loadCalendars)}));_defineProperty(_assertThisInitialized(_this),"addRequiredFieldsToList",(function(){var calendarsList=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];for(var i=0;i<calendarsList.length;i++){calendarsList[i].job_ids_string=calendarsList[i].job_ids.join(", ");calendarsList[i].events_length=calendarsList[i].events.length}return calendarsList}));_this.state={loading:true,calendars:[],isDestroyModalVisible:false,calendarId:null,selectedForDeletion:[],nodesAvailable:(0,_check_ml_nodes.mlNodesAvailable)()};return _this}_createClass(CalendarsListUI,[{key:"componentDidMount",value:function componentDidMount(){this.loadCalendars()}},{key:"render",value:function render(){var _this$state=this.state,calendars=_this$state.calendars,selectedForDeletion=_this$state.selectedForDeletion,loading=_this$state.loading,nodesAvailable=_this$state.nodesAvailable;var _this$props=this.props,canCreateCalendar=_this$props.canCreateCalendar,canDeleteCalendar=_this$props.canDeleteCalendar;var destroyModal="";if(this.state.isDestroyModalVisible){destroyModal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiConfirmModal,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteCalendarTitle",defaultMessage:"Delete calendar"}),onCancel:this.closeDestroyModal,onConfirm:this.deleteCalendars,cancelButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:_eui.EUI_MODAL_CONFIRM_BUTTON},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteCalendarsDescription",defaultMessage:"Delete {calendarsCount, plural, one {this calendar} other {these calendars}}? {calendarsList}",values:{calendarsCount:selectedForDeletion.length,calendarsList:selectedForDeletion.map((function(c){return c.calendar_id})).join(", ")}}))))}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"settings"}),_react.default.createElement(_eui.EuiPage,{className:"mlCalendarList"},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiPageContent,{className:"mlCalendarList__content",verticalPosition:"center",horizontalPosition:"center"},_react.default.createElement(_header.CalendarsListHeader,{totalCount:calendars.length,refreshCalendars:this.loadCalendars}),_react.default.createElement(_table.CalendarsListTable,{loading:loading,calendarsList:this.addRequiredFieldsToList(calendars),onDeleteClick:this.showDestroyModal,canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar,mlNodesAvailable:nodesAvailable,setSelectedCalendarList:this.setSelectedCalendarList,itemsSelected:selectedForDeletion.length>0})),destroyModal)))}}]);return CalendarsListUI}(_react.Component);exports.CalendarsListUI=CalendarsListUI;_defineProperty(CalendarsListUI,"propTypes",{canCreateCalendar:_propTypes.PropTypes.bool.isRequired,canDeleteCalendar:_propTypes.PropTypes.bool.isRequired});var CalendarsList=(0,_public.withKibana)(CalendarsListUI);exports.CalendarsList=CalendarsList},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CalendarsListHeader=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _public=__webpack_require__(31);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function CalendarsListHeaderUI(_ref){var totalCount=_ref.totalCount,refreshCalendars=_ref.refreshCalendars,kibana=_ref.kibana;var _kibana$services$docL=kibana.services.docLinks,ELASTIC_WEBSITE_URL=_kibana$services$docL.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=_kibana$services$docL.DOC_LINK_VERSION;var docsUrl="".concat(ELASTIC_WEBSITE_URL,"guide/en/machine-learning/").concat(DOC_LINK_VERSION,"/ml-calendars.html");return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsTitle",defaultMessage:"Calendars"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsListTotalCount",defaultMessage:"{totalCount} in total",values:{totalCount:totalCount}})))))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:refreshCalendars},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsDescription",defaultMessage:"Calendars contain a list of scheduled events for which you do not want to generate anomalies, such as planned system outages or public holidays. The same calendar can be assigned to multiple jobs.{br}{learnMoreLink}",values:{br:_react.default.createElement("br",null),learnMoreLink:_react.default.createElement(_eui.EuiLink,{href:docsUrl,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))}CalendarsListHeaderUI.propTypes={totalCount:_propTypes.default.number.isRequired,refreshCalendars:_propTypes.default.func.isRequired};var CalendarsListHeader=(0,_public.withKibana)(CalendarsListHeaderUI);exports.CalendarsListHeader=CalendarsListHeader},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CalendarsListTable",{enumerable:true,get:function get(){return _table.CalendarsListTable}});var _table=__webpack_require__(1560)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CalendarsListTable=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _calendars=__webpack_require__(259);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CalendarsListTable=function CalendarsListTable(_ref){var calendarsList=_ref.calendarsList,onDeleteClick=_ref.onDeleteClick,setSelectedCalendarList=_ref.setSelectedCalendarList,loading=_ref.loading,canCreateCalendar=_ref.canCreateCalendar,canDeleteCalendar=_ref.canDeleteCalendar,mlNodesAvailable=_ref.mlNodesAvailable,itemsSelected=_ref.itemsSelected;var sorting={sort:{field:"calendar_id",direction:"asc"}};var pagination={initialPageSize:20,pageSizeOptions:[10,20]};var columns=[{field:"calendar_id",name:_i18n.i18n.translate("xpack.ml.calendarsList.table.idColumnName",{defaultMessage:"ID"}),sortable:true,truncateText:true,scope:"row",render:function render(id){return _react.default.createElement(_eui.EuiLink,{href:"#/settings/calendars_list/edit_calendar/".concat(id)},id)}},{field:"job_ids_string",name:_i18n.i18n.translate("xpack.ml.calendarsList.table.jobsColumnName",{defaultMessage:"Jobs"}),sortable:true,truncateText:true,render:function render(jobList){return jobList===_calendars.GLOBAL_CALENDAR?_react.default.createElement("span",{style:{fontStyle:"italic"}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.table.allJobsLabel",defaultMessage:"Applies to all jobs"})):jobList}},{field:"events_length",name:_i18n.i18n.translate("xpack.ml.calendarsList.table.eventsColumnName",{defaultMessage:"Events"}),sortable:true,render:function render(eventsLength){return _i18n.i18n.translate("xpack.ml.calendarsList.table.eventsCountLabel",{defaultMessage:"{eventsLength, plural, one {# event} other {# events}}",values:{eventsLength:eventsLength}})}}];var tableSelection={onSelectionChange:function onSelectionChange(selection){return setSelectedCalendarList(selection)}};var search={toolsRight:[_react.default.createElement(_eui.EuiButton,{size:"s","data-test-subj":"mlCalendarButtonCreate",key:"new_calendar_button",href:"#/settings/calendars_list/new_calendar",isDisabled:canCreateCalendar===false||mlNodesAvailable===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.table.newButtonLabel",defaultMessage:"New"})),_react.default.createElement(_eui.EuiButton,{size:"s",color:"danger",iconType:"trash",onClick:onDeleteClick,isDisabled:canDeleteCalendar===false||mlNodesAvailable===false||itemsSelected===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.calendarsList.table.deleteButtonLabel",defaultMessage:"Delete"}))],box:{incremental:true},filters:[]};return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiInMemoryTable,{items:calendarsList,itemId:"calendar_id",columns:columns,search:search,pagination:pagination,sorting:sorting,loading:loading,selection:tableSelection,isSelectable:true,"data-test-subj":"mlCalendarTable"}))};exports.CalendarsListTable=CalendarsListTable;CalendarsListTable.propTypes={calendarsList:_propTypes.default.array.isRequired,onDeleteClick:_propTypes.default.func.isRequired,loading:_propTypes.default.bool.isRequired,canCreateCalendar:_propTypes.default.bool.isRequired,canDeleteCalendar:_propTypes.default.bool.isRequired,mlNodesAvailable:_propTypes.default.bool.isRequired,setSelectedCalendarList:_propTypes.default.func.isRequired,itemsSelected:_propTypes.default.bool.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.deleteCalendars=deleteCalendars;var _dependency_cache=__webpack_require__(5);var _ml_api_service=__webpack_require__(51);var _i18n=__webpack_require__(1);var _errors=__webpack_require__(152);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function deleteCalendars(_x,_x2){return _deleteCalendars.apply(this,arguments)}function _deleteCalendars(){_deleteCalendars=_asyncToGenerator(regeneratorRuntime.mark((function _callee(calendarsToDelete,callback){var toastNotifications,messageId,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,calendar,calendarId;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(calendarsToDelete===undefined||calendarsToDelete.length===0)){_context.next=2;break}return _context.abrupt("return");case 2:toastNotifications=(0,_dependency_cache.getToastNotifications)();messageId=calendarsToDelete.length>1?_i18n.i18n.translate("xpack.ml.calendarsList.deleteCalendars.calendarsLabel",{defaultMessage:"{calendarsToDeleteCount} calendars",values:{calendarsToDeleteCount:calendarsToDelete.length}}):"".concat(calendarsToDelete[0].calendar_id);toastNotifications.add(_i18n.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarsNotificationMessage",{defaultMessage:"Deleting {messageId}",values:{messageId:messageId}}));_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context.prev=8;_iterator=calendarsToDelete[Symbol.iterator]();case 10:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context.next=25;break}calendar=_step.value;calendarId=calendar.calendar_id;_context.prev=13;_context.next=16;return _ml_api_service.ml.deleteCalendar({calendarId:calendarId});case 16:_context.next=22;break;case 18:_context.prev=18;_context.t0=_context["catch"](13);console.log("Error deleting calendar:",_context.t0);toastNotifications.addDanger({title:_i18n.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarErrorMessage",{defaultMessage:"An error occurred deleting calendar {calendarId}",values:{calendarId:calendar.calendar_id}}),text:(0,_errors.getErrorMessage)(_context.t0)});case 22:_iteratorNormalCompletion=true;_context.next=10;break;case 25:_context.next=31;break;case 27:_context.prev=27;_context.t1=_context["catch"](8);_didIteratorError=true;_iteratorError=_context.t1;case 31:_context.prev=31;_context.prev=32;if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}case 34:_context.prev=34;if(!_didIteratorError){_context.next=37;break}throw _iteratorError;case 37:return _context.finish(34);case 38:return _context.finish(31);case 39:toastNotifications.addSuccess(_i18n.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarSuccessNotificationMessage",{defaultMessage:"{messageId} deleted",values:{messageId:messageId}}));callback();case 41:case"end":return _context.stop()}}}),_callee,null,[[8,27,31,39],[13,18],[32,,34,38]])})));return _deleteCalendars.apply(this,arguments)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.editCalendarRoute=exports.newCalendarRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _kibana=__webpack_require__(57);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _check_ml_nodes=__webpack_require__(81);var _calendars=__webpack_require__(505);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var MODE;(function(MODE){MODE[MODE["NEW"]=0]="NEW";MODE[MODE["EDIT"]=1]="EDIT"})(MODE||(MODE={}));var newBreadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.SETTINGS,{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagement.createLabel",{defaultMessage:"Create"}),href:"#/settings/calendars_list/new_calendar"}];var editBreadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.SETTINGS,{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagement.editLabel",{defaultMessage:"Edit"}),href:"#/settings/calendars_list/edit_calendar"}];var newCalendarRoute={path:"/settings/calendars_list/new_calendar",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps,mode:MODE.NEW}))},breadcrumbs:newBreadcrumbs};exports.newCalendarRoute=newCalendarRoute;var editCalendarRoute={path:"/settings/calendars_list/edit_calendar/:calendarId",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps,mode:MODE.EDIT}))},breadcrumbs:editBreadcrumbs};exports.editCalendarRoute=editCalendarRoute;var PageWrapper=function PageWrapper(_ref){var location=_ref.location,mode=_ref.mode,deps=_ref.deps;var calendarId;if(mode===MODE.EDIT){var pathMatch=location.pathname.match(/.+\/(.+)$/);calendarId=pathMatch&&pathMatch.length>1?pathMatch[1]:undefined}var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,{checkFullLicense:_license.checkFullLicense,checkGetJobsPrivilege:_check_privilege.checkGetJobsPrivilege,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable}),context=_useResolver.context;(0,_kibana.useTimefilter)({timeRangeSelector:false,autoRefreshSelector:false});var canCreateCalendar=(0,_check_privilege.checkPermission)("canCreateCalendar");var canDeleteCalendar=(0,_check_privilege.checkPermission)("canDeleteCalendar");return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_calendars.NewCalendar,{calendarId:calendarId,canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.filterListRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _kibana=__webpack_require__(57);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _check_ml_nodes=__webpack_require__(81);var _filter_lists=__webpack_require__(508);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.SETTINGS,{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.filterListsLabel",{defaultMessage:"Filter lists"}),href:"#/settings/filter_lists"}];var filterListRoute={path:"/settings/filter_lists",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.filterListRoute=filterListRoute;var PageWrapper=function PageWrapper(_ref){var deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,{checkFullLicense:_license.checkFullLicense,checkGetJobsPrivilege:_check_privilege.checkGetJobsPrivilege,getMlNodeCount:_check_ml_nodes.getMlNodeCount}),context=_useResolver.context;(0,_kibana.useTimefilter)({timeRangeSelector:false,autoRefreshSelector:false});var canCreateFilter=(0,_check_privilege.checkPermission)("canCreateFilter");var canDeleteFilter=(0,_check_privilege.checkPermission)("canDeleteFilter");return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_filter_lists.FilterLists,{canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EditFilterList",{enumerable:true,get:function get(){return _edit_filter_list.EditFilterList}});var _edit_filter_list=__webpack_require__(1565)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditFilterList=exports.EditFilterListUI=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _public=__webpack_require__(31);var _header=__webpack_require__(1566);var _toolbar=__webpack_require__(1571);var _items_grid=__webpack_require__(1574);var _navigation_menu=__webpack_require__(82);var _utils=__webpack_require__(1577);var _ml_api_service=__webpack_require__(51);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var DEFAULT_ITEMS_PER_PAGE=50;function getMatchingFilterItems(searchBarQuery,items){if(items===undefined){return[]}if(searchBarQuery===undefined){return _toConsumableArray(items)}var allItems=items.map((function(item){return{value:item}}));var matchingObjects=_eui.EuiSearchBar.Query.execute(searchBarQuery,allItems,{defaultFields:["value"]});return matchingObjects.map((function(item){return item.value}))}function getActivePage(activePageState,itemsPerPage,numMatchingItems){var activePage=activePageState;var activePageStartIndex=itemsPerPage*activePageState;if(activePageStartIndex>numMatchingItems){activePage=Math.max(Math.ceil(numMatchingItems/itemsPerPage)-1,0)}return activePage}function returnToFiltersList(){window.location.href="#/settings/filter_lists"}var EditFilterListUI=function(_Component){_inherits(EditFilterListUI,_Component);function EditFilterListUI(props){var _this;_classCallCheck(this,EditFilterListUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(EditFilterListUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"loadFilterList",(function(filterId){_ml_api_service.ml.filters.filters({filterId:filterId}).then((function(filter){_this.setLoadedFilterState(filter)})).catch((function(resp){console.log("Error loading filter ".concat(filterId,":"),resp);var toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.settings.filterLists.editFilterList.loadingDetailsOfFilterErrorMessage",{defaultMessage:"An error occurred loading details of filter {filterId}",values:{filterId:filterId}}))}))}));_defineProperty(_assertThisInitialized(_this),"setLoadedFilterState",(function(loadedFilter){_this.setState((function(prevState){var itemsPerPage=prevState.itemsPerPage,searchQuery=prevState.searchQuery;var matchingItems=getMatchingFilterItems(searchQuery,loadedFilter.items);var activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{description:loadedFilter.description,items:loadedFilter.items!==undefined?_toConsumableArray(loadedFilter.items):[],matchingItems:matchingItems,selectedItems:[],loadedFilter:loadedFilter,isNewFilterIdInvalid:false,activePage:activePage,searchQuery:searchQuery,saveInProgress:false}}))}));_defineProperty(_assertThisInitialized(_this),"updateNewFilterId",(function(newFilterId){_this.setState({newFilterId:newFilterId,isNewFilterIdInvalid:!(0,_utils.isValidFilterListId)(newFilterId)})}));_defineProperty(_assertThisInitialized(_this),"updateDescription",(function(description){_this.setState({description:description})}));_defineProperty(_assertThisInitialized(_this),"addItems",(function(itemsToAdd){_this.setState((function(prevState){var itemsPerPage=prevState.itemsPerPage,searchQuery=prevState.searchQuery;var items=_toConsumableArray(prevState.items);var alreadyInFilter=[];itemsToAdd.forEach((function(item){if(items.indexOf(item)===-1){items.push(item)}else{alreadyInFilter.push(item)}}));items.sort((function(str1,str2){return str1.localeCompare(str2)}));if(alreadyInFilter.length>0){var toasts=_this.props.kibana.services.notifications.toasts;toasts.addWarning(_i18n.i18n.translate("xpack.ml.settings.filterLists.editFilterList.duplicatedItemsInFilterListWarningMessage",{defaultMessage:"The following items were already in the filter list: {alreadyInFilter}",values:{alreadyInFilter:alreadyInFilter}}))}var matchingItems=getMatchingFilterItems(searchQuery,items);var activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{items:items,matchingItems:matchingItems,activePage:activePage,searchQuery:searchQuery}}))}));_defineProperty(_assertThisInitialized(_this),"deleteSelectedItems",(function(){_this.setState((function(prevState){var selectedItems=prevState.selectedItems,itemsPerPage=prevState.itemsPerPage,searchQuery=prevState.searchQuery;var items=_toConsumableArray(prevState.items);selectedItems.forEach((function(item){var index=items.indexOf(item);if(index!==-1){items.splice(index,1)}}));var matchingItems=getMatchingFilterItems(searchQuery,items);var activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{items:items,matchingItems:matchingItems,selectedItems:[],activePage:activePage,searchQuery:searchQuery}}))}));_defineProperty(_assertThisInitialized(_this),"onSearchChange",(function(_ref){var query=_ref.query;_this.setState((function(prevState){var items=prevState.items,itemsPerPage=prevState.itemsPerPage;var matchingItems=getMatchingFilterItems(query,items);var activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{matchingItems:matchingItems,activePage:activePage,searchQuery:query}}))}));_defineProperty(_assertThisInitialized(_this),"setItemSelected",(function(item,isSelected){_this.setState((function(prevState){var selectedItems=_toConsumableArray(prevState.selectedItems);var index=selectedItems.indexOf(item);if(isSelected===true&&index===-1){selectedItems.push(item)}else if(isSelected===false&&index!==-1){selectedItems.splice(index,1)}return{selectedItems:selectedItems}}))}));_defineProperty(_assertThisInitialized(_this),"setActivePage",(function(activePage){_this.setState({activePage:activePage})}));_defineProperty(_assertThisInitialized(_this),"setItemsPerPage",(function(itemsPerPage){_this.setState({itemsPerPage:itemsPerPage,activePage:0})}));_defineProperty(_assertThisInitialized(_this),"save",(function(){_this.setState({saveInProgress:true});var _this$state=_this.state,loadedFilter=_this$state.loadedFilter,newFilterId=_this$state.newFilterId,description=_this$state.description,items=_this$state.items;var filterId=_this.props.filterId!==undefined?_this.props.filterId:newFilterId;(0,_utils.saveFilterList)(filterId,description,items,loadedFilter).then((function(savedFilter){_this.setLoadedFilterState(savedFilter);returnToFiltersList()})).catch((function(resp){console.log("Error saving filter ".concat(filterId,":"),resp);var toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.settings.filterLists.editFilterList.savingFilterErrorMessage",{defaultMessage:"An error occurred saving filter {filterId}",values:{filterId:filterId}}));_this.setState({saveInProgress:false})}))}));_this.state={description:"",items:[],matchingItems:[],selectedItems:[],loadedFilter:{},newFilterId:"",isNewFilterIdInvalid:true,activePage:0,itemsPerPage:DEFAULT_ITEMS_PER_PAGE,saveInProgress:false};return _this}_createClass(EditFilterListUI,[{key:"componentDidMount",value:function componentDidMount(){var filterId=this.props.filterId;if(filterId!==undefined){this.loadFilterList(filterId)}else{this.setState({newFilterId:""})}}},{key:"render",value:function render(){var _this$state2=this.state,loadedFilter=_this$state2.loadedFilter,newFilterId=_this$state2.newFilterId,isNewFilterIdInvalid=_this$state2.isNewFilterIdInvalid,description=_this$state2.description,items=_this$state2.items,matchingItems=_this$state2.matchingItems,selectedItems=_this$state2.selectedItems,itemsPerPage=_this$state2.itemsPerPage,activePage=_this$state2.activePage,saveInProgress=_this$state2.saveInProgress;var _this$props=this.props,canCreateFilter=_this$props.canCreateFilter,canDeleteFilter=_this$props.canDeleteFilter;var totalItemCount=items!==undefined?items.length:0;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"settings"}),_react.default.createElement(_eui.EuiPage,{className:"ml-edit-filter-lists"},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiPageContent,{className:"ml-edit-filter-lists-content",verticalPosition:"center",horizontalPosition:"center"},_react.default.createElement(_header.EditFilterListHeader,{canCreateFilter:canCreateFilter,filterId:this.props.filterId,newFilterId:newFilterId,isNewFilterIdInvalid:isNewFilterIdInvalid,updateNewFilterId:this.updateNewFilterId,description:description,updateDescription:this.updateDescription,totalItemCount:totalItemCount,usedBy:loadedFilter.used_by}),_react.default.createElement(_toolbar.EditFilterListToolbar,{canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter,onSearchChange:this.onSearchChange,addItems:this.addItems,deleteSelectedItems:this.deleteSelectedItems,selectedItemCount:selectedItems.length}),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_items_grid.ItemsGrid,{totalItemCount:totalItemCount,items:matchingItems,selectedItems:selectedItems,itemsPerPage:itemsPerPage,setItemsPerPage:this.setItemsPerPage,setItemSelected:this.setItemSelected,activePage:activePage,setActivePage:this.setActivePage}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{onClick:returnToFiltersList},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.cancelButtonLabel",defaultMessage:"Cancel"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:this.save,disabled:saveInProgress===true||isNewFilterIdInvalid===true||canCreateFilter===false,fill:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.saveButtonLabel",defaultMessage:"Save"}))))))))}}]);return EditFilterListUI}(_react.Component);exports.EditFilterListUI=EditFilterListUI;_defineProperty(EditFilterListUI,"displayName","EditFilterList");_defineProperty(EditFilterListUI,"propTypes",{filterId:_propTypes.default.string,canCreateFilter:_propTypes.default.bool.isRequired,canDeleteFilter:_propTypes.default.bool.isRequired});var EditFilterList=(0,_public.withKibana)(EditFilterListUI);exports.EditFilterList=EditFilterList},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditFilterListHeader=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _edit_description_popover=__webpack_require__(1567);var _filter_list_usage_popover=__webpack_require__(1569);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var EditFilterListHeader=function EditFilterListHeader(_ref){var canCreateFilter=_ref.canCreateFilter,filterId=_ref.filterId,totalItemCount=_ref.totalItemCount,description=_ref.description,updateDescription=_ref.updateDescription,newFilterId=_ref.newFilterId,isNewFilterIdInvalid=_ref.isNewFilterIdInvalid,updateNewFilterId=_ref.updateNewFilterId,usedBy=_ref.usedBy;var title=filterId!==undefined?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListTitle",defaultMessage:"Filter list {filterId}",values:{filterId:filterId}}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.createFilterListTitle",defaultMessage:"Create new filter list"});var idField;var descriptionField;var usedByElement;if(filterId===undefined){var msg=_i18n.i18n.translate("xpack.ml.settings.filterLists.editFilterHeader.allowedCharactersDescription",{defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores;"+" must start and end with an alphanumeric character"});var helpText=isNewFilterIdInvalid===false?msg:undefined;var error=isNewFilterIdInvalid===true?[msg]:undefined;idField=_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListIdAriaLabel",defaultMessage:"Filter list ID"}),helpText:helpText,error:error,isInvalid:isNewFilterIdInvalid},_react.default.createElement(_eui.EuiFieldText,{name:"new_filter_id",value:newFilterId,isInvalid:isNewFilterIdInvalid,onChange:function onChange(e){return updateNewFilterId(e.target.value)}}))}if(description!==undefined&&description.length>0){descriptionField=_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,description))}else{descriptionField=_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.addDescriptionText",defaultMessage:"Add a description"})))}if(filterId!==undefined){if(usedBy!==undefined&&usedBy.jobs.length>0){usedByElement=_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",{className:"ml-filter-list-usage"},_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsUsedInJobsDescription",defaultMessage:"This filter list is used in"})),_react.default.createElement(_filter_list_usage_popover.FilterListUsagePopover,{entityType:"detector",entityValues:usedBy.detectors}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.acrossText",defaultMessage:"across"})),_react.default.createElement(_filter_list_usage_popover.FilterListUsagePopover,{entityType:"job",entityValues:usedBy.jobs})),_react.default.createElement(_eui.EuiSpacer,{size:"s"}))}else{usedByElement=_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsNotUsedInJobsDescription",defaultMessage:"This filter list is not used by any jobs."}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}))}}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,title))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.totalItemsDescription",defaultMessage:"{totalItemCount, plural, one {# item} other {# items}} in total",values:{totalItemCount:totalItemCount}}))))))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),idField,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"s",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},descriptionField),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_edit_description_popover.EditDescriptionPopover,{canCreateFilter:canCreateFilter,description:description,updateDescription:updateDescription}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),usedByElement)};exports.EditFilterListHeader=EditFilterListHeader;EditFilterListHeader.propTypes={canCreateFilter:_propTypes.default.bool.isRequired,filterId:_propTypes.default.string,newFilterId:_propTypes.default.string,isNewFilterIdInvalid:_propTypes.default.bool,updateNewFilterId:_propTypes.default.func.isRequired,totalItemCount:_propTypes.default.number.isRequired,description:_propTypes.default.string,updateDescription:_propTypes.default.func.isRequired,usedBy:_propTypes.default.object};EditFilterListHeader.displayName="EditFilterListHeader"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EditDescriptionPopover",{enumerable:true,get:function get(){return _edit_description_popover.EditDescriptionPopover}});var _edit_description_popover=__webpack_require__(1568)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditDescriptionPopover=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var EditDescriptionPopover=function(_Component){_inherits(EditDescriptionPopover,_Component);function EditDescriptionPopover(props){var _this;_classCallCheck(this,EditDescriptionPopover);_this=_possibleConstructorReturn(this,_getPrototypeOf(EditDescriptionPopover).call(this,props));_defineProperty(_assertThisInitialized(_this),"onChange",(function(e){_this.setState({value:e.target.value})}));_defineProperty(_assertThisInitialized(_this),"onButtonClick",(function(){if(_this.state.isPopoverOpen===false){_this.setState({isPopoverOpen:!_this.state.isPopoverOpen,value:_this.props.description})}else{_this.closePopover()}}));_defineProperty(_assertThisInitialized(_this),"closePopover",(function(){if(_this.state.isPopoverOpen===true){_this.setState({isPopoverOpen:false});_this.props.updateDescription(_this.state.value)}}));_this.state={isPopoverOpen:false,value:props.description};return _this}_createClass(EditDescriptionPopover,[{key:"render",value:function render(){var _this$state=this.state,isPopoverOpen=_this$state.isPopoverOpen,value=_this$state.value;var button=_react.default.createElement(_eui.EuiButtonIcon,{size:"s",color:"primary",onClick:this.onButtonClick,iconType:"pencil","aria-label":_i18n.i18n.translate("xpack.ml.settings.filterLists.editDescriptionPopover.editDescriptionAriaLabel",{defaultMessage:"Edit description"}),isDisabled:this.props.canCreateFilter===false});return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiPopover,{id:"filter_list_description_popover",ownFocus:true,button:button,isOpen:isPopoverOpen,closePopover:this.closePopover},_react.default.createElement("div",{style:{width:"300px"}},_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.editDescriptionPopover.filterListDescriptionAriaLabel",defaultMessage:"Filter list description"})},_react.default.createElement(_eui.EuiFieldText,{name:"filter_list_description",value:value,onChange:this.onChange}))))))}}]);return EditDescriptionPopover}(_react.Component);exports.EditDescriptionPopover=EditDescriptionPopover;_defineProperty(EditDescriptionPopover,"displayName","EditDescriptionPopover");_defineProperty(EditDescriptionPopover,"propTypes",{description:_propTypes.default.string,updateDescription:_propTypes.default.func.isRequired,canCreateFilter:_propTypes.default.bool.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FilterListUsagePopover",{enumerable:true,get:function get(){return _filter_list_usage_popover.FilterListUsagePopover}});var _filter_list_usage_popover=__webpack_require__(1570)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FilterListUsagePopover=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var FilterListUsagePopover=function(_Component){_inherits(FilterListUsagePopover,_Component);function FilterListUsagePopover(props){var _this;_classCallCheck(this,FilterListUsagePopover);_this=_possibleConstructorReturn(this,_getPrototypeOf(FilterListUsagePopover).call(this,props));_defineProperty(_assertThisInitialized(_this),"onButtonClick",(function(){_this.setState({isPopoverOpen:!_this.state.isPopoverOpen})}));_defineProperty(_assertThisInitialized(_this),"closePopover",(function(){_this.setState({isPopoverOpen:false})}));_this.state={isPopoverOpen:false};return _this}_createClass(FilterListUsagePopover,[{key:"render",value:function render(){var _this$props=this.props,entityType=_this$props.entityType,entityValues=_this$props.entityValues;var linkText="".concat(entityValues.length," ").concat(entityType).concat(entityValues.length!==1?"s":"");var listItems=entityValues.map((function(value){return _react.default.createElement("li",{key:value},value)}));var button=_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",color:"primary",onClick:this.onButtonClick},linkText);return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiPopover,{id:"".concat(entityType,"_filter_list_usage"),panelClassName:"ml-filter-list-usage-popover",ownFocus:true,button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},_react.default.createElement("ul",null,listItems)))}}]);return FilterListUsagePopover}(_react.Component);exports.FilterListUsagePopover=FilterListUsagePopover;FilterListUsagePopover.propTypes={entityType:_propTypes.default.oneOf(["job","detector"]),entityValues:_propTypes.default.array.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditFilterListToolbar=EditFilterListToolbar;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _add_item_popover=__webpack_require__(1572);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function renderToolsRight(canCreateFilter,canDeleteFilter,addItems,deleteSelectedItems,selectedItemCount){return[_react.default.createElement(_add_item_popover.AddItemPopover,{addItems:addItems,canCreateFilter:canCreateFilter,key:"add_item_btn"}),_react.default.createElement(_eui.EuiButton,{color:"danger",size:"s",disabled:selectedItemCount===0||canDeleteFilter===false,onClick:deleteSelectedItems,key:"delete_item_btn"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.toolbar.deleteItemButtonLabel",defaultMessage:"Delete item"}))]}function EditFilterListToolbar(_ref){var canCreateFilter=_ref.canCreateFilter,canDeleteFilter=_ref.canDeleteFilter,onSearchChange=_ref.onSearchChange,addItems=_ref.addItems,deleteSelectedItems=_ref.deleteSelectedItems,selectedItemCount=_ref.selectedItemCount;var toolsRight=renderToolsRight(canCreateFilter,canDeleteFilter,addItems,deleteSelectedItems,selectedItemCount);return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"xl"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiSearchBar,{toolsRight:toolsRight,onChange:onSearchChange,filters:[]}))))}EditFilterListToolbar.propTypes={canCreateFilter:_propTypes.default.bool.isRequired,canDeleteFilter:_propTypes.default.bool.isRequired,onSearchChange:_propTypes.default.func.isRequired,addItems:_propTypes.default.func.isRequired,deleteSelectedItems:_propTypes.default.func.isRequired,selectedItemCount:_propTypes.default.number.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"AddItemPopover",{enumerable:true,get:function get(){return _add_item_popover.AddItemPopover}});var _add_item_popover=__webpack_require__(1573)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AddItemPopover=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var AddItemPopover=function(_Component){_inherits(AddItemPopover,_Component);function AddItemPopover(props){var _this;_classCallCheck(this,AddItemPopover);_this=_possibleConstructorReturn(this,_getPrototypeOf(AddItemPopover).call(this,props));_defineProperty(_assertThisInitialized(_this),"onItemsTextChange",(function(e){_this.setState({itemsText:e.target.value})}));_defineProperty(_assertThisInitialized(_this),"onButtonClick",(function(){_this.setState({isPopoverOpen:!_this.state.isPopoverOpen})}));_defineProperty(_assertThisInitialized(_this),"closePopover",(function(){_this.setState({isPopoverOpen:false})}));_defineProperty(_assertThisInitialized(_this),"onAddButtonClick",(function(){var items=_this.state.itemsText.split("\n");var addItems=[];items.forEach((function(item){if(addItems.indexOf(item)===-1&&item.length>0){addItems.push(item)}}));_this.props.addItems(addItems);_this.setState({isPopoverOpen:false,itemsText:""})}));_this.state={isPopoverOpen:false,itemsText:""};return _this}_createClass(AddItemPopover,[{key:"render",value:function render(){var button=_react.default.createElement(_eui.EuiButton,{size:"s",color:"primary",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick,isDisabled:this.props.canCreateFilter===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addItemButtonLabel",defaultMessage:"Add item"}));return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiPopover,{id:"add_item_popover",panelClassName:"ml-add-filter-item-popover",ownFocus:true,button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.itemsLabel",defaultMessage:"Items"})},_react.default.createElement(_eui.EuiTextArea,{value:this.state.itemsText,onChange:this.onItemsTextChange}))),_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.enterItemPerLineDescription",defaultMessage:"Enter one item per line"})),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:this.onAddButtonClick,disabled:this.state.itemsText.length===0},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addButtonLabel",defaultMessage:"Add"}))))))}}]);return AddItemPopover}(_react.Component);exports.AddItemPopover=AddItemPopover;_defineProperty(AddItemPopover,"displayName","AddItemPopover");_defineProperty(AddItemPopover,"propTypes",{addItems:_propTypes.default.func.isRequired,canCreateFilter:_propTypes.default.bool.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ItemsGrid",{enumerable:true,get:function get(){return _items_grid.ItemsGrid}});var _items_grid=__webpack_require__(1575)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ItemsGrid=ItemsGrid;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _items_grid_pagination=__webpack_require__(1576);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ItemsGrid(_ref){var numberColumns=_ref.numberColumns,totalItemCount=_ref.totalItemCount,items=_ref.items,selectedItems=_ref.selectedItems,itemsPerPage=_ref.itemsPerPage,itemsPerPageOptions=_ref.itemsPerPageOptions,setItemsPerPage=_ref.setItemsPerPage,setItemSelected=_ref.setItemSelected,activePage=_ref.activePage,setActivePage=_ref.setActivePage;if(items===undefined||items.length===0){return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h4",null,totalItemCount===0?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.itemsGrid.noItemsAddedTitle",defaultMessage:"No items have been added"}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.itemsGrid.noMatchingItemsTitle",defaultMessage:"No matching items"})))))}var startIndex=activePage*itemsPerPage;var pageItems=items.slice(startIndex,startIndex+itemsPerPage);var gridItems=pageItems.map((function(item,index){return _react.default.createElement(_eui.EuiFlexItem,{key:"ml_grid_item_".concat(index)},_react.default.createElement(_eui.EuiCheckbox,{id:"ml_grid_item_".concat(index),label:item,checked:selectedItems.indexOf(item)>=0,onChange:function onChange(e){setItemSelected(item,e.target.checked)}}))}));return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiFlexGrid,{columns:numberColumns,className:"eui-textBreakWord",gutterSize:"m"},gridItems),_react.default.createElement(_items_grid_pagination.ItemsGridPagination,{itemCount:items.length,itemsPerPage:itemsPerPage,itemsPerPageOptions:itemsPerPageOptions,setItemsPerPage:setItemsPerPage,activePage:activePage,setActivePage:setActivePage}))}ItemsGrid.propTypes={numberColumns:_propTypes.default.oneOf([2,3,4]),totalItemCount:_propTypes.default.number.isRequired,items:_propTypes.default.array,selectedItems:_propTypes.default.array,itemsPerPage:_propTypes.default.number,itemsPerPageOptions:_propTypes.default.arrayOf(_propTypes.default.number),setItemsPerPage:_propTypes.default.func.isRequired,setItemSelected:_propTypes.default.func.isRequired,activePage:_propTypes.default.number.isRequired,setActivePage:_propTypes.default.func.isRequired};ItemsGrid.defaultProps={numberColumns:4,itemsPerPage:50,itemsPerPageOptions:[50,100,500,1e3]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ItemsGridPagination=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function getContextMenuItemIcon(menuItemSetting,itemsPerPage){return menuItemSetting===itemsPerPage?"check":"empty"}var ItemsGridPagination=function(_Component){_inherits(ItemsGridPagination,_Component);function ItemsGridPagination(props){var _this;_classCallCheck(this,ItemsGridPagination);_this=_possibleConstructorReturn(this,_getPrototypeOf(ItemsGridPagination).call(this,props));_defineProperty(_assertThisInitialized(_this),"onButtonClick",(function(){_this.setState({isPopoverOpen:!_this.state.isPopoverOpen})}));_defineProperty(_assertThisInitialized(_this),"closePopover",(function(){_this.setState({isPopoverOpen:false})}));_defineProperty(_assertThisInitialized(_this),"onPageClick",(function(pageNumber){_this.props.setActivePage(pageNumber)}));_defineProperty(_assertThisInitialized(_this),"onChangeItemsPerPage",(function(pageSize){_this.closePopover();_this.props.setItemsPerPage(pageSize)}));_this.state={isPopoverOpen:false};return _this}_createClass(ItemsGridPagination,[{key:"render",value:function render(){var _this2=this;var _this$props=this.props,itemCount=_this$props.itemCount,itemsPerPage=_this$props.itemsPerPage,itemsPerPageOptions=_this$props.itemsPerPageOptions,activePage=_this$props.activePage;var button=_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsPerPageButtonLabel",defaultMessage:"Items per page: {itemsPerPage}",values:{itemsPerPage:itemsPerPage}}));var pageCount=Math.ceil(itemCount/itemsPerPage);var items=itemsPerPageOptions.map((function(pageSize){return _react.default.createElement(_eui.EuiContextMenuItem,{key:"".concat(pageSize," items"),icon:getContextMenuItemIcon(pageSize,itemsPerPage),onClick:function onClick(){_this2.onChangeItemsPerPage(pageSize)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsCountLabel",defaultMessage:"{pageSize} items",values:{pageSize:pageSize}}))}));return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiPopover,{id:"customizablePagination",button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none"},_react.default.createElement(_eui.EuiContextMenuPanel,{items:items,className:"ml-items-grid-page-size-menu"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiPagination,{pageCount:pageCount,activePage:activePage,onPageClick:this.onPageClick})))}}]);return ItemsGridPagination}(_react.Component);exports.ItemsGridPagination=ItemsGridPagination;ItemsGridPagination.propTypes={itemCount:_propTypes.default.number.isRequired,itemsPerPage:_propTypes.default.number.isRequired,itemsPerPageOptions:_propTypes.default.arrayOf(_propTypes.default.number).isRequired,setItemsPerPage:_propTypes.default.func.isRequired,activePage:_propTypes.default.number.isRequired,setActivePage:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isValidFilterListId=isValidFilterListId;exports.saveFilterList=saveFilterList;exports.addFilterList=addFilterList;exports.updateFilterList=updateFilterList;var _i18n=__webpack_require__(1);var _dependency_cache=__webpack_require__(5);var _job_utils=__webpack_require__(59);var _ml_api_service=__webpack_require__(51);function isValidFilterListId(id){return id!==undefined&&id.length>0&&(0,_job_utils.isJobIdValid)(id)}function saveFilterList(filterId,description,items,loadedFilterList){return new Promise((function(resolve,reject){if(loadedFilterList===undefined||loadedFilterList.filter_id===undefined){addFilterList(filterId,description,items).then((function(newFilter){resolve(newFilter)})).catch((function(error){reject(error)}))}else{updateFilterList(loadedFilterList,description,items).then((function(updatedFilter){resolve(updatedFilter)})).catch((function(error){reject(error)}))}}))}function addFilterList(filterId,description,items){var filterWithIdExistsErrorMessage=_i18n.i18n.translate("xpack.ml.settings.filterLists.filterWithIdExistsErrorMessage",{defaultMessage:"A filter with id {filterId} already exists",values:{filterId:filterId}});return new Promise((function(resolve,reject){_ml_api_service.ml.filters.filtersStats().then((function(filterLists){var savedFilterIds=filterLists.map((function(filterList){return filterList.filter_id}));if(savedFilterIds.indexOf(filterId)===-1){_ml_api_service.ml.filters.addFilter(filterId,description,items).then((function(newFilter){resolve(newFilter)})).catch((function(error){reject(error)}))}else{var toastNotifications=(0,_dependency_cache.getToastNotifications)();toastNotifications.addDanger(filterWithIdExistsErrorMessage);reject(new Error(filterWithIdExistsErrorMessage))}})).catch((function(error){reject(error)}))}))}function updateFilterList(loadedFilterList,description,items){return new Promise((function(resolve,reject){var loadedItems=loadedFilterList.items;var addItems=items.filter((function(item){return loadedItems.includes(item)===false}));var removeItems=loadedItems.filter((function(item){return items.includes(item)===false}));_ml_api_service.ml.filters.updateFilter(loadedFilterList.filter_id,description,addItems,removeItems).then((function(updatedFilter){resolve(updatedFilter)})).catch((function(error){reject(error)}))}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"FilterLists",{enumerable:true,get:function get(){return _filter_lists.FilterLists}});var _filter_lists=__webpack_require__(1579)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FilterLists=exports.FilterListsUI=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _navigation_menu=__webpack_require__(82);var _public=__webpack_require__(31);var _header=__webpack_require__(1580);var _table=__webpack_require__(1581);var _ml_api_service=__webpack_require__(51);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var FilterListsUI=function(_Component){_inherits(FilterListsUI,_Component);function FilterListsUI(props){var _this;_classCallCheck(this,FilterListsUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(FilterListsUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"setFilterLists",(function(filterLists){_this.setState((function(prevState){var loadedFilterIds=filterLists.map((function(filterList){return filterList.filter_id}));var selectedFilterLists=prevState.selectedFilterLists.filter((function(filterList){return loadedFilterIds.indexOf(filterList.filter_id)!==-1}));return{filterLists:filterLists,selectedFilterLists:selectedFilterLists}}))}));_defineProperty(_assertThisInitialized(_this),"setSelectedFilterLists",(function(selectedFilterLists){_this.setState({selectedFilterLists:selectedFilterLists})}));_defineProperty(_assertThisInitialized(_this),"refreshFilterLists",(function(){_ml_api_service.ml.filters.filtersStats().then((function(filterLists){_this.setFilterLists(filterLists)})).catch((function(resp){console.log("Error loading list of filters:",resp);var toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.settings.filterLists.filterLists.loadingFilterListsErrorMessage",{defaultMessage:"An error occurred loading the filter lists"}))}))}));_this.state={filterLists:[],selectedFilterLists:[]};return _this}_createClass(FilterListsUI,[{key:"componentDidMount",value:function componentDidMount(){this.refreshFilterLists()}},{key:"render",value:function render(){var _this$state=this.state,filterLists=_this$state.filterLists,selectedFilterLists=_this$state.selectedFilterLists;var _this$props=this.props,canCreateFilter=_this$props.canCreateFilter,canDeleteFilter=_this$props.canDeleteFilter;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"settings"}),_react.default.createElement(_eui.EuiPage,{className:"ml-list-filter-lists"},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiPageContent,{className:"ml-list-filter-lists-content",verticalPosition:"center",horizontalPosition:"center"},_react.default.createElement(_header.FilterListsHeader,{totalCount:filterLists.length,refreshFilterLists:this.refreshFilterLists}),_react.default.createElement(_table.FilterListsTable,{canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter,filterLists:filterLists,selectedFilterLists:selectedFilterLists,setSelectedFilterLists:this.setSelectedFilterLists,refreshFilterLists:this.refreshFilterLists})))))}}]);return FilterListsUI}(_react.Component);exports.FilterListsUI=FilterListsUI;_defineProperty(FilterListsUI,"displayName","FilterLists");_defineProperty(FilterListsUI,"propTypes",{canCreateFilter:_propTypes.PropTypes.bool.isRequired,canDeleteFilter:_propTypes.PropTypes.bool.isRequired});var FilterLists=(0,_public.withKibana)(FilterListsUI);exports.FilterLists=FilterLists},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FilterListsHeader=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _public=__webpack_require__(31);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function FilterListsHeaderUI(_ref){var totalCount=_ref.totalCount,refreshFilterLists=_ref.refreshFilterLists,kibana=_ref.kibana;var _kibana$services$docL=kibana.services.docLinks,ELASTIC_WEBSITE_URL=_kibana$services$docL.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=_kibana$services$docL.DOC_LINK_VERSION;var docsUrl="".concat(ELASTIC_WEBSITE_URL,"guide/en/machine-learning/").concat(DOC_LINK_VERSION,"/ml-rules.html");return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsTitle",defaultMessage:"Filter Lists"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsDescription",defaultMessage:"{totalCount} in total",values:{totalCount:totalCount}})))))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:function onClick(){return refreshFilterLists()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription",defaultMessage:"Filter lists contain values that you can use to include or exclude events from the machine learning analysis.\nYou can use the same filter list in multiple jobs.{br}{learnMoreLink}",values:{br:_react.default.createElement("br",null),learnMoreLink:_react.default.createElement(_eui.EuiLink,{href:docsUrl,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))}FilterListsHeaderUI.propTypes={totalCount:_propTypes.default.number.isRequired,refreshFilterLists:_propTypes.default.func.isRequired};var FilterListsHeader=(0,_public.withKibana)(FilterListsHeaderUI);exports.FilterListsHeader=FilterListsHeader},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FilterListsTable=FilterListsTable;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _delete_filter_list_modal=__webpack_require__(1582);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function UsedByIcon(_ref){var usedBy=_ref.usedBy;var icon;if(usedBy!==undefined&&usedBy.jobs.length>0){icon=_react.default.createElement(_eui.EuiIcon,{type:"check","aria-label":_i18n.i18n.translate("xpack.ml.settings.filterLists.table.inUseAriaLabel",{defaultMessage:"In use"})})}else{icon=_react.default.createElement(_eui.EuiIcon,{type:"cross","aria-label":_i18n.i18n.translate("xpack.ml.settings.filterLists.table.notInUseAriaLabel",{defaultMessage:"Not in use"})})}return icon}UsedByIcon.propTypes={usedBy:_propTypes.default.object};function NewFilterButton(_ref2){var canCreateFilter=_ref2.canCreateFilter;return _react.default.createElement(_eui.EuiButton,{key:"new_filter_list",href:"#/settings/filter_lists/new_filter_list",isDisabled:canCreateFilter===false,"data-test-subj":"mlFilterListsButtonCreate"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.newButtonLabel",defaultMessage:"New"}))}function getColumns(){var columns=[{field:"filter_id",name:_i18n.i18n.translate("xpack.ml.settings.filterLists.table.idColumnName",{defaultMessage:"ID"}),render:function render(id){return _react.default.createElement(_eui.EuiLink,{href:"#/settings/filter_lists/edit_filter_list/".concat(id)},id)},sortable:true,scope:"row"},{field:"description",name:_i18n.i18n.translate("xpack.ml.settings.filterLists.table.descriptionColumnName",{defaultMessage:"Description"}),sortable:true},{field:"item_count",name:_i18n.i18n.translate("xpack.ml.settings.filterLists.table.itemCountColumnName",{defaultMessage:"Item count"}),sortable:true},{field:"used_by",name:_i18n.i18n.translate("xpack.ml.settings.filterLists.table.inUseColumnName",{defaultMessage:"In use"}),render:function render(usedBy){return _react.default.createElement(UsedByIcon,{usedBy:usedBy})},sortable:true}];return columns}function renderToolsRight(canCreateFilter,canDeleteFilter,selectedFilterLists,refreshFilterLists){return[_react.default.createElement(NewFilterButton,{key:"new_filter_list",canCreateFilter:canCreateFilter}),_react.default.createElement(_delete_filter_list_modal.DeleteFilterListModal,{canDeleteFilter:canDeleteFilter,selectedFilterLists:selectedFilterLists,refreshFilterLists:refreshFilterLists})]}function FilterListsTable(_ref3){var canCreateFilter=_ref3.canCreateFilter,canDeleteFilter=_ref3.canDeleteFilter,filterLists=_ref3.filterLists,selectedFilterLists=_ref3.selectedFilterLists,setSelectedFilterLists=_ref3.setSelectedFilterLists,refreshFilterLists=_ref3.refreshFilterLists;var sorting={sort:{field:"filter_id",direction:"asc"}};var search={toolsRight:renderToolsRight(canCreateFilter,canDeleteFilter,selectedFilterLists,refreshFilterLists),box:{incremental:true},filters:[]};var tableSelection={selectable:function selectable(filterList){return filterList.used_by===undefined||filterList.used_by.jobs.length===0},selectableMessage:function selectableMessage(){return undefined},onSelectionChange:function onSelectionChange(selection){return setSelectedFilterLists(selection)}};return _react.default.createElement(_react.default.Fragment,null,filterLists===undefined||filterLists.length===0?_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"flexEnd",justifyContent:"flexEnd"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(NewFilterButton,null))),_react.default.createElement(_eui.EuiSpacer,{size:"l"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.noFiltersCreatedTitle",defaultMessage:"No filters have been created"})))))):_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiInMemoryTable,{className:"ml-filter-lists-table",items:filterLists,itemId:"filter_id",columns:getColumns(),search:search,pagination:true,sorting:sorting,selection:tableSelection,isSelectable:true,"data-test-subj":"mlFilterListsTable"})))}FilterListsTable.propTypes={canCreateFilter:_propTypes.default.bool.isRequired,canDeleteFilter:_propTypes.default.bool.isRequired,filterLists:_propTypes.default.array,selectedFilterLists:_propTypes.default.array,setSelectedFilterLists:_propTypes.default.func.isRequired,refreshFilterLists:_propTypes.default.func.isRequired};UsedByIcon.displayName="UsedByIcon"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"DeleteFilterListModal",{enumerable:true,get:function get(){return _delete_filter_list_modal.DeleteFilterListModal}});var _delete_filter_list_modal=__webpack_require__(1583)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DeleteFilterListModal=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _delete_filter_lists=__webpack_require__(1584);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DeleteFilterListModal=function(_Component){_inherits(DeleteFilterListModal,_Component);function DeleteFilterListModal(props){var _this;_classCallCheck(this,DeleteFilterListModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(DeleteFilterListModal).call(this,props));_defineProperty(_assertThisInitialized(_this),"closeModal",(function(){_this.setState({isModalVisible:false})}));_defineProperty(_assertThisInitialized(_this),"showModal",(function(){_this.setState({isModalVisible:true})}));_defineProperty(_assertThisInitialized(_this),"onConfirmDelete",(function(){_this.doDelete()}));_this.state={isModalVisible:false};return _this}_createClass(DeleteFilterListModal,[{key:"doDelete",value:function(){var _doDelete=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _this$props,selectedFilterLists,refreshFilterLists;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props=this.props,selectedFilterLists=_this$props.selectedFilterLists,refreshFilterLists=_this$props.refreshFilterLists;_context.next=3;return(0,_delete_filter_lists.deleteFilterLists)(selectedFilterLists);case 3:refreshFilterLists();this.closeModal();case 5:case"end":return _context.stop()}}}),_callee,this)})));function doDelete(){return _doDelete.apply(this,arguments)}return doDelete}()},{key:"render",value:function render(){var _this$props2=this.props,selectedFilterLists=_this$props2.selectedFilterLists,canDeleteFilter=_this$props2.canDeleteFilter;var modal;if(this.state.isModalVisible){var title=_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.modalTitle",defaultMessage:"Delete {selectedFilterListsLength, plural, one {{selectedFilterId}} other {# filter lists}}",values:{selectedFilterListsLength:selectedFilterLists.length,selectedFilterId:!!selectedFilterLists.length&&selectedFilterLists[0].filter_id}});modal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiConfirmModal,{title:title,className:"eui-textBreakWord",onCancel:this.closeModal,onConfirm:this.onConfirmDelete,cancelButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.confirmButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:_eui.EUI_MODAL_CONFIRM_BUTTON},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.deleteWarningMessage",defaultMessage:"Are you sure you want to delete\n{selectedFilterListsLength, plural, one {this filter list} other {these filter lists}}",values:{selectedFilterListsLength:selectedFilterLists.length}}))))}return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiButton,{key:"delete_filter_list",iconType:"trash",color:"danger",onClick:this.showModal,isDisabled:selectedFilterLists===undefined||selectedFilterLists.length===0||canDeleteFilter===false},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.deleteButtonLabel",defaultMessage:"Delete"})),modal)}}]);return DeleteFilterListModal}(_react.Component);exports.DeleteFilterListModal=DeleteFilterListModal;_defineProperty(DeleteFilterListModal,"displayName","DeleteFilterListModal");_defineProperty(DeleteFilterListModal,"propTypes",{selectedFilterLists:_propTypes.default.array,canDeleteFilter:_propTypes.default.bool.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.deleteFilterLists=deleteFilterLists;var _dependency_cache=__webpack_require__(5);var _i18n=__webpack_require__(1);var _ml_api_service=__webpack_require__(51);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function deleteFilterLists(_x){return _deleteFilterLists.apply(this,arguments)}function _deleteFilterLists(){_deleteFilterLists=_asyncToGenerator(regeneratorRuntime.mark((function _callee(filterListsToDelete){var toastNotifications,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,filterList,filterId;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(filterListsToDelete===undefined||filterListsToDelete.length===0)){_context.next=2;break}return _context.abrupt("return");case 2:toastNotifications=(0,_dependency_cache.getToastNotifications)();toastNotifications.add(_i18n.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingNotificationMessage",{defaultMessage:"Deleting {filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}}",values:{filterListsToDeleteLength:filterListsToDelete.length,filterListToDeleteId:!!filterListsToDelete.length&&filterListsToDelete[0].filter_id}}));_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context.prev=7;_iterator=filterListsToDelete[Symbol.iterator]();case 9:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context.next=24;break}filterList=_step.value;filterId=filterList.filter_id;_context.prev=12;_context.next=15;return _ml_api_service.ml.filters.deleteFilter(filterId);case 15:_context.next=21;break;case 17:_context.prev=17;_context.t0=_context["catch"](12);console.log("Error deleting filter list:",_context.t0);toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingErrorMessage",{defaultMessage:"An error occurred deleting filter list {filterListId}{respMessage}",values:{filterListId:filterList.filter_id,respMessage:_context.t0.message?" : ".concat(_context.t0.message):""}}));case 21:_iteratorNormalCompletion=true;_context.next=9;break;case 24:_context.next=30;break;case 26:_context.prev=26;_context.t1=_context["catch"](7);_didIteratorError=true;_iteratorError=_context.t1;case 30:_context.prev=30;_context.prev=31;if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}case 33:_context.prev=33;if(!_didIteratorError){_context.next=36;break}throw _iteratorError;case 36:return _context.finish(33);case 37:return _context.finish(30);case 38:toastNotifications.addSuccess(_i18n.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.filtersSuccessfullyDeletedNotificationMessage",{defaultMessage:"{filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}} deleted",values:{filterListsToDeleteLength:filterListsToDelete.length,filterListToDeleteId:!!filterListsToDelete.length&&filterListsToDelete[0].filter_id}}));case 39:case"end":return _context.stop()}}}),_callee,null,[[7,26,30,38],[12,17],[31,,33,37]])})));return _deleteFilterLists.apply(this,arguments)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.editFilterListRoute=exports.newFilterListRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _kibana=__webpack_require__(57);var _license=__webpack_require__(73);var _check_privilege=__webpack_require__(56);var _check_ml_nodes=__webpack_require__(81);var _filter_lists=__webpack_require__(508);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var MODE;(function(MODE){MODE[MODE["NEW"]=0]="NEW";MODE[MODE["EDIT"]=1]="EDIT"})(MODE||(MODE={}));var newBreadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.SETTINGS,{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.filterLists.createLabel",{defaultMessage:"Create"}),href:"#/settings/filter_lists/new"}];var editBreadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.SETTINGS,{text:_i18n.i18n.translate("xpack.ml.settings.breadcrumbs.filterLists.editLabel",{defaultMessage:"Edit"}),href:"#/settings/filter_lists/edit"}];var newFilterListRoute={path:"/settings/filter_lists/new_filter_list",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{mode:MODE.NEW,deps:deps}))},breadcrumbs:newBreadcrumbs};exports.newFilterListRoute=newFilterListRoute;var editFilterListRoute={path:"/settings/filter_lists/edit_filter_list/:filterId",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{mode:MODE.EDIT,deps:deps}))},breadcrumbs:editBreadcrumbs};exports.editFilterListRoute=editFilterListRoute;var PageWrapper=function PageWrapper(_ref){var location=_ref.location,mode=_ref.mode,deps=_ref.deps;var filterId;if(mode===MODE.EDIT){var pathMatch=location.pathname.match(/.+\/(.+)$/);filterId=pathMatch&&pathMatch.length>1?pathMatch[1]:undefined}var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,{checkFullLicense:_license.checkFullLicense,checkGetJobsPrivilege:_check_privilege.checkGetJobsPrivilege,checkMlNodesAvailable:_check_ml_nodes.checkMlNodesAvailable}),context=_useResolver.context;(0,_kibana.useTimefilter)({timeRangeSelector:false,autoRefreshSelector:false});var canCreateFilter=(0,_check_privilege.checkPermission)("canCreateFilter");var canDeleteFilter=(0,_check_privilege.checkPermission)("canDeleteFilter");return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_filter_lists.EditFilterList,{filterId:filterId,canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _analytics_jobs_list=__webpack_require__(1587);Object.keys(_analytics_jobs_list).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _analytics_jobs_list[key]}})}));var _analytics_job_exploration=__webpack_require__(1616);Object.keys(_analytics_job_exploration).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _analytics_job_exploration[key]}})}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.analyticsJobsListRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _resolvers=__webpack_require__(110);var _analytics_management=__webpack_require__(1588);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataFrameListLabel",{defaultMessage:"Data Frame Analytics"}),href:""}];var analyticsJobsListRoute={path:"/data_frame_analytics",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.analyticsJobsListRoute=analyticsJobsListRoute;var PageWrapper=function PageWrapper(_ref){var location=_ref.location,deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)("",undefined,deps.config,(0,_resolvers.basicResolvers)(deps)),context=_useResolver.context;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_analytics_management.Page,null))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Page",{enumerable:true,get:function get(){return _page.Page}});var _page=__webpack_require__(1589)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Page=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _navigation_menu=__webpack_require__(82);var _analytics_list=__webpack_require__(509);var _use_refresh_interval=__webpack_require__(1613);var _use_create_analytics_form=__webpack_require__(1614);var _node_available_warning=__webpack_require__(234);var _upgrade=__webpack_require__(235);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var Page=function Page(){var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),blockRefresh=_useState2[0],setBlockRefresh=_useState2[1];(0,_use_refresh_interval.useRefreshInterval)(setBlockRefresh);var createAnalyticsForm=(0,_use_create_analytics_form.useCreateAnalyticsForm)();return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"data_frame_analytics"}),_react.default.createElement(_eui.EuiPage,{"data-test-subj":"mlPageDataFrameAnalytics"},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiPageHeader,null,_react.default.createElement(_eui.EuiPageHeaderSection,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.title",defaultMessage:"Analytics jobs"}),_react.default.createElement("span",null," "),_react.default.createElement(_eui.EuiBetaBadge,{label:_i18n.i18n.translate("xpack.ml.dataframe.analyticsList.experimentalBadgeLabel",{defaultMessage:"Experimental"}),tooltipContent:_i18n.i18n.translate("xpack.ml.dataframe.analyticsList.experimentalBadgeTooltipContent",{defaultMessage:"Data frame analytics are an experimental feature. We'd love to hear your feedback."})}))))),_react.default.createElement(_node_available_warning.NodeAvailableWarning,null),_react.default.createElement(_upgrade.UpgradeWarning,null),_react.default.createElement(_analytics_list.DataFrameAnalyticsList,{blockRefresh:blockRefresh,createAnalyticsForm:createAnalyticsForm}))))};exports.Page=Page},,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useRefreshInterval=void 0;var _react=__webpack_require__(28);var _kibana=__webpack_require__(57);var _jobs_list=__webpack_require__(193);var _common=__webpack_require__(65);var useRefreshInterval=function useRefreshInterval(setBlockRefresh){var _useMlKibana=(0,_kibana.useMlKibana)(),services=_useMlKibana.services;var timefilter=services.data.query.timefilter.timefilter;var _useRefreshAnalyticsL=(0,_common.useRefreshAnalyticsList)(),refresh=_useRefreshAnalyticsL.refresh;(0,_react.useEffect)((function(){var analyticsRefreshInterval=null;var refreshIntervalSubscription=timefilter.getRefreshIntervalUpdate$().subscribe(setAutoRefresh);timefilter.disableTimeRangeSelector();timefilter.enableAutoRefreshSelector();initAutoRefresh();function initAutoRefresh(){var _timefilter$getRefres=timefilter.getRefreshInterval(),value=_timefilter$getRefres.value;if(value===0){timefilter.setRefreshInterval({pause:false,value:_jobs_list.DEFAULT_REFRESH_INTERVAL_MS})}setAutoRefresh()}function setAutoRefresh(){var _timefilter$getRefres2=timefilter.getRefreshInterval(),value=_timefilter$getRefres2.value,pause=_timefilter$getRefres2.pause;if(pause){clearRefreshInterval()}else{setRefreshInterval(value)}refresh()}function setRefreshInterval(interval){clearRefreshInterval();if(interval>=_jobs_list.MINIMUM_REFRESH_INTERVAL_MS){setBlockRefresh(false);var intervalId=window.setInterval((function(){refresh()}),interval);analyticsRefreshInterval=intervalId}}function clearRefreshInterval(){setBlockRefresh(true);if(analyticsRefreshInterval!==null){window.clearInterval(analyticsRefreshInterval)}}return function(){refreshIntervalSubscription.unsubscribe();clearRefreshInterval()}}),[])};exports.useRefreshInterval=useRefreshInterval},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"useCreateAnalyticsForm",{enumerable:true,get:function get(){return _use_create_analytics_form.useCreateAnalyticsForm}});Object.defineProperty(exports,"CreateAnalyticsFormProps",{enumerable:true,get:function get(){return _use_create_analytics_form.CreateAnalyticsFormProps}});var _use_create_analytics_form=__webpack_require__(1615)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useCreateAnalyticsForm=void 0;var _react=__webpack_require__(28);var _i18n=__webpack_require__(1);var _errors=__webpack_require__(152);var _ml_api_service=__webpack_require__(51);var _ml=__webpack_require__(77);var _common=__webpack_require__(65);var _action_clone=__webpack_require__(390);var _actions=__webpack_require__(511);var _reducer=__webpack_require__(510);var _state=__webpack_require__(266);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var useCreateAnalyticsForm=function useCreateAnalyticsForm(){var mlContext=(0,_ml.useMlContext)();var _useReducer=(0,_react.useReducer)(_reducer.reducer,(0,_state.getInitialState)()),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var _useRefreshAnalyticsL=(0,_common.useRefreshAnalyticsList)(),refresh=_useRefreshAnalyticsL.refresh;var form=state.form,jobConfig=state.jobConfig,isAdvancedEditorEnabled=state.isAdvancedEditorEnabled;var createIndexPattern=form.createIndexPattern,jobId=form.jobId;var destinationIndex=form.destinationIndex;var addRequestMessage=function addRequestMessage(requestMessage){return dispatch({type:_actions.ACTION.ADD_REQUEST_MESSAGE,requestMessage:requestMessage})};var closeModal=function closeModal(){return dispatch({type:_actions.ACTION.CLOSE_MODAL})};var resetAdvancedEditorMessages=function resetAdvancedEditorMessages(){return dispatch({type:_actions.ACTION.RESET_ADVANCED_EDITOR_MESSAGES})};var setIndexNames=function setIndexNames(indexNames){return dispatch({type:_actions.ACTION.SET_INDEX_NAMES,indexNames:indexNames})};var setAdvancedEditorRawString=function setAdvancedEditorRawString(advancedEditorRawString){return dispatch({type:_actions.ACTION.SET_ADVANCED_EDITOR_RAW_STRING,advancedEditorRawString:advancedEditorRawString})};var setIndexPatternTitles=function setIndexPatternTitles(payload){return dispatch({type:_actions.ACTION.SET_INDEX_PATTERN_TITLES,payload:payload})};var setIsJobCreated=function setIsJobCreated(isJobCreated){return dispatch({type:_actions.ACTION.SET_IS_JOB_CREATED,isJobCreated:isJobCreated})};var setIsJobStarted=function setIsJobStarted(isJobStarted){dispatch({type:_actions.ACTION.SET_IS_JOB_STARTED,isJobStarted:isJobStarted})};var setIsModalButtonDisabled=function setIsModalButtonDisabled(isModalButtonDisabled){return dispatch({type:_actions.ACTION.SET_IS_MODAL_BUTTON_DISABLED,isModalButtonDisabled:isModalButtonDisabled})};var setIsModalVisible=function setIsModalVisible(isModalVisible){return dispatch({type:_actions.ACTION.SET_IS_MODAL_VISIBLE,isModalVisible:isModalVisible})};var setJobIds=function setJobIds(jobIds){return dispatch({type:_actions.ACTION.SET_JOB_IDS,jobIds:jobIds})};var resetRequestMessages=function resetRequestMessages(){return dispatch({type:_actions.ACTION.RESET_REQUEST_MESSAGES})};var resetForm=function resetForm(){return dispatch({type:_actions.ACTION.RESET_FORM})};var createAnalyticsJob=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var analyticsJobConfig;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:resetRequestMessages();setIsModalButtonDisabled(true);analyticsJobConfig=isAdvancedEditorEnabled?jobConfig:(0,_state.getJobConfigFromFormState)(form);if(isAdvancedEditorEnabled){destinationIndex=analyticsJobConfig.dest.index}_context.prev=4;_context.next=7;return _ml_api_service.ml.dataFrameAnalytics.createDataFrameAnalytics(jobId,analyticsJobConfig);case 7:addRequestMessage({message:_i18n.i18n.translate("xpack.ml.dataframe.stepCreateForm.createDataFrameAnalyticsSuccessMessage",{defaultMessage:"Request to create data frame analytics {jobId} acknowledged.",values:{jobId:jobId}})});setIsModalButtonDisabled(false);setIsJobCreated(true);if(createIndexPattern){createKibanaIndexPattern()}refresh();_context.next=18;break;case 14:_context.prev=14;_context.t0=_context["catch"](4);addRequestMessage({error:(0,_errors.getErrorMessage)(_context.t0),message:_i18n.i18n.translate("xpack.ml.dataframe.analytics.create.errorCreatingDataFrameAnalyticsJob",{defaultMessage:"An error occurred creating the data frame analytics job:"})});setIsModalButtonDisabled(false);case 18:case"end":return _context.stop()}}}),_callee,null,[[4,14]])})));return function createAnalyticsJob(){return _ref.apply(this,arguments)}}();var createKibanaIndexPattern=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var indexPatternName,newIndexPattern,id;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:indexPatternName=destinationIndex;_context2.prev=1;_context2.next=4;return mlContext.indexPatterns.make();case 4:newIndexPattern=_context2.sent;Object.assign(newIndexPattern,{id:"",title:indexPatternName});_context2.next=8;return newIndexPattern.create();case 8:id=_context2.sent;_context2.next=11;return mlContext.indexPatterns.clearCache();case 11:if(!(id===false)){_context2.next=14;break}addRequestMessage({error:_i18n.i18n.translate("xpack.ml.dataframe.analytics.create.duplicateIndexPatternErrorMessageError",{defaultMessage:"The index pattern {indexPatternName} already exists.",values:{indexPatternName:indexPatternName}}),message:_i18n.i18n.translate("xpack.ml.dataframe.analytics.create.duplicateIndexPatternErrorMessage",{defaultMessage:"An error occurred creating the Kibana index pattern:"})});return _context2.abrupt("return");case 14:if(mlContext.kibanaConfig.get("defaultIndex")){_context2.next=17;break}_context2.next=17;return mlContext.kibanaConfig.set("defaultIndex",id);case 17:addRequestMessage({message:_i18n.i18n.translate("xpack.ml.dataframe.analytics.create.createIndexPatternSuccessMessage",{defaultMessage:"Kibana index pattern {indexPatternName} created.",values:{indexPatternName:indexPatternName}})});_context2.next=23;break;case 20:_context2.prev=20;_context2.t0=_context2["catch"](1);addRequestMessage({error:(0,_errors.getErrorMessage)(_context2.t0),message:_i18n.i18n.translate("xpack.ml.dataframe.analytics.create.createIndexPatternErrorMessage",{defaultMessage:"An error occurred creating the Kibana index pattern:"})});case 23:case"end":return _context2.stop()}}}),_callee2,null,[[1,20]])})));return function createKibanaIndexPattern(){return _ref2.apply(this,arguments)}}();var prepareFormValidation=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var indexPatternsMap,savedObjects;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.t0=setJobIds;_context3.next=4;return _ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalytics();case 4:_context3.t1=function(job){return job.id};_context3.t2=_context3.sent.data_frame_analytics.map(_context3.t1);(0,_context3.t0)(_context3.t2);_context3.next=12;break;case 9:_context3.prev=9;_context3.t3=_context3["catch"](0);addRequestMessage({error:(0,_errors.getErrorMessage)(_context3.t3),message:_i18n.i18n.translate("xpack.ml.dataframe.analytics.create.errorGettingDataFrameAnalyticsList",{defaultMessage:"An error occurred getting the existing data frame analytics job IDs:"})});case 12:_context3.prev=12;_context3.t4=setIndexNames;_context3.next=16;return _ml_api_service.ml.getIndices();case 16:_context3.t5=function(index){return index.name};_context3.t6=_context3.sent.map(_context3.t5);(0,_context3.t4)(_context3.t6);_context3.next=24;break;case 21:_context3.prev=21;_context3.t7=_context3["catch"](12);addRequestMessage({error:(0,_errors.getErrorMessage)(_context3.t7),message:_i18n.i18n.translate("xpack.ml.dataframe.analytics.create.errorGettingDataFrameIndexNames",{defaultMessage:"An error occurred getting the existing index names:"})});case 24:_context3.prev=24;indexPatternsMap={};_context3.next=28;return mlContext.indexPatterns.getCache();case 28:_context3.t8=_context3.sent;if(_context3.t8){_context3.next=31;break}_context3.t8=[];case 31:savedObjects=_context3.t8;savedObjects.forEach((function(obj){var _obj$attributes;var title=obj===null||obj===void 0?void 0:(_obj$attributes=obj.attributes)===null||_obj$attributes===void 0?void 0:_obj$attributes.title;if(title!==undefined){var id=(obj===null||obj===void 0?void 0:obj.id)||"";indexPatternsMap[title]={label:title,value:id}}}));setIndexPatternTitles({indexPatternsMap:indexPatternsMap});_context3.next=39;break;case 36:_context3.prev=36;_context3.t9=_context3["catch"](24);addRequestMessage({error:(0,_errors.getErrorMessage)(_context3.t9),message:_i18n.i18n.translate("xpack.ml.dataframe.analytics.create.errorGettingIndexPatternTitles",{defaultMessage:"An error occurred getting the existing index pattern titles:"})});case 39:case"end":return _context3.stop()}}}),_callee3,null,[[0,9],[12,21],[24,36]])})));return function prepareFormValidation(){return _ref3.apply(this,arguments)}}();var openModal=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){return regeneratorRuntime.wrap((function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return mlContext.indexPatterns.clearCache();case 2:resetForm();_context4.next=5;return prepareFormValidation();case 5:dispatch({type:_actions.ACTION.OPEN_MODAL});case 6:case"end":return _context4.stop()}}}),_callee4)})));return function openModal(){return _ref4.apply(this,arguments)}}();var startAnalyticsJob=function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var response;return regeneratorRuntime.wrap((function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setIsModalButtonDisabled(true);_context5.prev=1;_context5.next=4;return _ml_api_service.ml.dataFrameAnalytics.startDataFrameAnalytics(jobId);case 4:response=_context5.sent;if(!(response.acknowledged!==true)){_context5.next=7;break}throw new Error(response);case 7:addRequestMessage({message:_i18n.i18n.translate("xpack.ml.dataframe.analytics.create.startDataFrameAnalyticsSuccessMessage",{defaultMessage:"Request to start data frame analytics {jobId} acknowledged.",values:{jobId:jobId}})});setIsJobStarted(true);setIsModalButtonDisabled(false);refresh();_context5.next=17;break;case 13:_context5.prev=13;_context5.t0=_context5["catch"](1);addRequestMessage({error:(0,_errors.getErrorMessage)(_context5.t0),message:_i18n.i18n.translate("xpack.ml.dataframe.analytics.create.errorStartingDataFrameAnalyticsJob",{defaultMessage:"An error occurred starting the data frame analytics job:"})});setIsModalButtonDisabled(false);case 17:case"end":return _context5.stop()}}}),_callee5,null,[[1,13]])})));return function startAnalyticsJob(){return _ref5.apply(this,arguments)}}();var setJobConfig=function setJobConfig(payload){dispatch({type:_actions.ACTION.SET_JOB_CONFIG,payload:payload})};var setFormState=function setFormState(payload){dispatch({type:_actions.ACTION.SET_FORM_STATE,payload:payload})};var switchToAdvancedEditor=function switchToAdvancedEditor(){dispatch({type:_actions.ACTION.SWITCH_TO_ADVANCED_EDITOR})};var setEstimatedModelMemoryLimit=function setEstimatedModelMemoryLimit(value){dispatch({type:_actions.ACTION.SET_ESTIMATED_MODEL_MEMORY_LIMIT,value:value})};var setJobClone=function(){var _ref6=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(cloneJob){var config;return regeneratorRuntime.wrap((function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:resetForm();_context6.next=3;return prepareFormValidation();case 3:config=(0,_action_clone.extractCloningConfig)(cloneJob);if((0,_action_clone.isAdvancedConfig)(config)){setJobConfig(config);switchToAdvancedEditor()}else{setFormState((0,_state.getCloneFormStateFromJobConfig)(config));setEstimatedModelMemoryLimit(config.model_memory_limit)}dispatch({type:_actions.ACTION.SET_JOB_CLONE,cloneJob:cloneJob});dispatch({type:_actions.ACTION.OPEN_MODAL});case 7:case"end":return _context6.stop()}}}),_callee6)})));return function setJobClone(_x){return _ref6.apply(this,arguments)}}();var actions={closeModal:closeModal,createAnalyticsJob:createAnalyticsJob,openModal:openModal,resetAdvancedEditorMessages:resetAdvancedEditorMessages,setAdvancedEditorRawString:setAdvancedEditorRawString,setFormState:setFormState,setIsModalVisible:setIsModalVisible,setJobConfig:setJobConfig,startAnalyticsJob:startAnalyticsJob,switchToAdvancedEditor:switchToAdvancedEditor,setEstimatedModelMemoryLimit:setEstimatedModelMemoryLimit,setJobClone:setJobClone};return{state:state,actions:actions}};exports.useCreateAnalyticsForm=useCreateAnalyticsForm},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.analyticsJobExplorationRoute=void 0;var _queryString=__webpack_require__(126);var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _risonNode=__webpack_require__(100);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _resolvers=__webpack_require__(110);var _analytics_exploration=__webpack_require__(1617);var _breadcrumbs=__webpack_require__(69);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataFrameExplorationLabel",{defaultMessage:"Data Frame Analytics"}),href:""}];var analyticsJobExplorationRoute={path:"/data_frame_analytics/exploration",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.analyticsJobExplorationRoute=analyticsJobExplorationRoute;var PageWrapper=function PageWrapper(_ref){var location=_ref.location,deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)("",undefined,deps.config,(0,_resolvers.basicResolvers)(deps)),context=_useResolver.context;var _parse=(0,_queryString.parse)(location.search,{sort:false}),_g=_parse._g;var globalState=null;try{globalState=(0,_risonNode.decode)(_g)}catch(error){console.error("Could not parse global state");window.location.href="#data_frame_analytics"}var jobId=globalState.ml.jobId;var analysisType=globalState.ml.analysisType;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_analytics_exploration.Page,{jobId:jobId,analysisType:analysisType}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Page",{enumerable:true,get:function get(){return _page.Page}});var _page=__webpack_require__(1618)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Page=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _navigation_menu=__webpack_require__(82);var _outlier_exploration=__webpack_require__(1619);var _regression_exploration=__webpack_require__(1631);var _classification_exploration=__webpack_require__(1638);var _analytics=__webpack_require__(76);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Page=function Page(_ref){var jobId=_ref.jobId,analysisType=_ref.analysisType;return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"data_frame_analytics"}),_react.default.createElement(_eui.EuiPage,{"data-test-subj":"mlPageDataFrameAnalyticsExploration"},_react.default.createElement(_eui.EuiPageBody,{style:{maxWidth:"calc(100% - 0px)"}},_react.default.createElement(_eui.EuiPageContentHeader,null,_react.default.createElement(_eui.EuiPageContentHeaderSection,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.title",defaultMessage:"Analytics exploration"}),_react.default.createElement("span",null," "),_react.default.createElement(_eui.EuiBetaBadge,{label:_i18n.i18n.translate("xpack.ml.dataframe.analytics.exploration.experimentalBadgeLabel",{defaultMessage:"Experimental"}),tooltipContent:_i18n.i18n.translate("xpack.ml.dataframe.analytics.exploration.experimentalBadgeTooltipContent",{defaultMessage:"Data frame analytics are an experimental feature. We'd love to hear your feedback."})}))))),_react.default.createElement(_eui.EuiPageContentBody,{style:{maxWidth:"calc(100% - 0px)"}},_react.default.createElement(_eui.EuiSpacer,{size:"l"}),analysisType===_analytics.ANALYSIS_CONFIG_TYPE.OUTLIER_DETECTION&&_react.default.createElement(_outlier_exploration.OutlierExploration,{jobId:jobId}),analysisType===_analytics.ANALYSIS_CONFIG_TYPE.REGRESSION&&_react.default.createElement(_regression_exploration.RegressionExploration,{jobId:jobId}),analysisType===_analytics.ANALYSIS_CONFIG_TYPE.CLASSIFICATION&&_react.default.createElement(_classification_exploration.ClassificationExploration,{jobId:jobId})))))};exports.Page=Page},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"OutlierExploration",{enumerable:true,get:function get(){return _outlier_exploration.OutlierExploration}});var _outlier_exploration=__webpack_require__(1620)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.OutlierExploration=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _color_range_legend=__webpack_require__(1621);var _common=__webpack_require__(65);var _columns=__webpack_require__(117);var _use_explore_data=__webpack_require__(1624);var _exploration_data_grid=__webpack_require__(1627);var _exploration_query_bar=__webpack_require__(1629);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}var FEATURE_INFLUENCE="feature_influence";var ExplorationTitle=function ExplorationTitle(_ref){var jobId=_ref.jobId;return _react.default.createElement(_eui.EuiTitle,{size:"xs"},_react.default.createElement("span",null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.exploration.jobIdTitle",{defaultMessage:"Outlier detection job ID {jobId}",values:{jobId:jobId}})))};var getFeatureCount=function getFeatureCount(resultsField){var tableItems=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(tableItems.length===0){return 0}return Object.keys(tableItems[0]).filter((function(key){return key.includes("".concat(resultsField,".").concat(FEATURE_INFLUENCE,"."))})).length};var OutlierExploration=_react.default.memo((function(_ref2){var jobId=_ref2.jobId;var _useExploreData=(0,_use_explore_data.useExploreData)(jobId),errorMessage=_useExploreData.errorMessage,indexPattern=_useExploreData.indexPattern,jobConfig=_useExploreData.jobConfig,jobStatus=_useExploreData.jobStatus,pagination=_useExploreData.pagination,searchQuery=_useExploreData.searchQuery,selectedFields=_useExploreData.selectedFields,setPagination=_useExploreData.setPagination,setSearchQuery=_useExploreData.setSearchQuery,setSelectedFields=_useExploreData.setSelectedFields,setSortingColumns=_useExploreData.setSortingColumns,sortingColumns=_useExploreData.sortingColumns,rowCount=_useExploreData.rowCount,status=_useExploreData.status,tableFields=_useExploreData.tableFields,tableItems=_useExploreData.tableItems;var columns=[];if(jobConfig!==undefined&&indexPattern!==undefined&&selectedFields.length>0&&tableItems.length>0){var resultsField=jobConfig.dest.results_field;var removePrefix=new RegExp("^".concat(resultsField,".").concat(FEATURE_INFLUENCE,"."),"g");columns.push.apply(columns,_toConsumableArray(tableFields.sort((0,_common.sortColumns)(tableItems[0],resultsField)).map((function(id){var idWithoutPrefix=id.replace(removePrefix,"");var field=indexPattern.fields.getByName(idWithoutPrefix);var schema;switch(field===null||field===void 0?void 0:field.type){case"date":schema="datetime";break;case"geo_point":schema="json";break;case"number":schema="numeric";break}if(id==="".concat(resultsField,".outlier_score")){schema="numeric"}return{id:id,schema:schema}}))))}var colorRange=(0,_color_range_legend.useColorRange)(_color_range_legend.COLOR_RANGE.BLUE,_color_range_legend.COLOR_RANGE_SCALE.INFLUENCER,jobConfig!==undefined?getFeatureCount(jobConfig.dest.results_field,tableItems):1);if(jobConfig===undefined||indexPattern===undefined){return null}if(status===_common.INDEX_STATUS.ERROR&&!errorMessage.includes("parsing_exception")){return _react.default.createElement(_eui.EuiPanel,{grow:false},_react.default.createElement(ExplorationTitle,{jobId:jobConfig.id}),_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.dataframe.analytics.exploration.indexError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},_react.default.createElement("p",null,errorMessage)))}var tableError=status===_common.INDEX_STATUS.ERROR&&errorMessage.includes("parsing_exception")?errorMessage:undefined;if(status===_common.INDEX_STATUS.LOADED&&tableItems.length===0&&tableError===undefined){tableError=_i18n.i18n.translate("xpack.ml.dataframe.analytics.exploration.noDataCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure the index contains documents and your query is not too restrictive."})}return _react.default.createElement(_eui.EuiPanel,{"data-test-subj":"mlDFAnalyticsOutlierExplorationTablePanel"},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",responsive:false,gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(ExplorationTitle,{jobId:jobConfig.id})),jobStatus!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("span",null,(0,_columns.getTaskStateBadge)(jobStatus)))),_react.default.createElement(_eui.EuiHorizontalRule,{margin:"xs"}),(columns.length>0||searchQuery!==_common.defaultSearchQuery)&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_exploration_query_bar.ExplorationQueryBar,{indexPattern:indexPattern,setSearchQuery:setSearchQuery})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_color_range_legend.ColorRangeLegend,{colorRange:colorRange,title:_i18n.i18n.translate("xpack.ml.dataframe.analytics.exploration.colorRangeLegendTitle",{defaultMessage:"Feature influence score"})}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),columns.length>0&&tableItems.length>0&&_react.default.createElement(_exploration_data_grid.ExplorationDataGrid,{colorRange:colorRange,columns:columns,indexPattern:indexPattern,pagination:pagination,resultsField:jobConfig.dest.results_field,rowCount:rowCount,selectedFields:selectedFields,setPagination:setPagination,setSelectedFields:setSelectedFields,setSortingColumns:setSortingColumns,sortingColumns:sortingColumns,tableItems:tableItems})))}));exports.OutlierExploration=OutlierExploration},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ColorRangeLegend",{enumerable:true,get:function get(){return _color_range_legend.ColorRangeLegend}});Object.defineProperty(exports,"colorRangeOptions",{enumerable:true,get:function get(){return _use_color_range.colorRangeOptions}});Object.defineProperty(exports,"colorRangeScaleOptions",{enumerable:true,get:function get(){return _use_color_range.colorRangeScaleOptions}});Object.defineProperty(exports,"useColorRange",{enumerable:true,get:function get(){return _use_color_range.useColorRange}});Object.defineProperty(exports,"COLOR_RANGE",{enumerable:true,get:function get(){return _use_color_range.COLOR_RANGE}});Object.defineProperty(exports,"COLOR_RANGE_SCALE",{enumerable:true,get:function get(){return _use_color_range.COLOR_RANGE_SCALE}});var _color_range_legend=__webpack_require__(1622);var _use_color_range=__webpack_require__(1623)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorRangeLegend=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _d=_interopRequireDefault(__webpack_require__(97));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var COLOR_RANGE_RESOLUTION=10;var ColorRangeLegend=function ColorRangeLegend(_ref){var colorRange=_ref.colorRange,_ref$justifyTicks=_ref.justifyTicks,justifyTicks=_ref$justifyTicks===void 0?false:_ref$justifyTicks,_ref$showTicks=_ref.showTicks,showTicks=_ref$showTicks===void 0?true:_ref$showTicks,title=_ref.title,_ref$width=_ref.width,width=_ref$width===void 0?250:_ref$width;var d3Container=(0,_react.useRef)(null);var scale=_d.default.range(COLOR_RANGE_RESOLUTION+1).map((function(d){return{offset:d/COLOR_RANGE_RESOLUTION*100,stopColor:colorRange(d/COLOR_RANGE_RESOLUTION)}}));(0,_react.useEffect)((function(){if(d3Container.current===null){return}var wrapperHeight=32;var wrapperWidth=width;var margin={top:2,bottom:20,left:justifyTicks||!showTicks?1:4,right:1};var legendWidth=wrapperWidth-margin.left-margin.right;var legendHeight=wrapperHeight-margin.top-margin.bottom;_d.default.select(d3Container.current).selectAll("*").remove();var wrapper=_d.default.select(d3Container.current).classed("mlColorRangeLegend",true).attr("width",wrapperWidth).attr("height",wrapperHeight).append("g").attr("transform","translate("+margin.left+","+margin.top+")");var gradient=wrapper.append("defs").append("linearGradient").attr("id","mlColorRangeGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");scale.forEach((function(d){gradient.append("stop").attr("offset","".concat(d.offset,"%")).attr("stop-color",d.stopColor).attr("stop-opacity",1)}));wrapper.append("rect").attr("x1",0).attr("y1",0).attr("width",legendWidth).attr("height",legendHeight).style("fill","url(#mlColorRangeGradient)");var axisScale=_d.default.scale.linear().domain([0,1]).range([0,legendWidth]);var tickFormat=_d.default.format("");var legendAxis=_d.default.svg.axis().scale(axisScale).orient("bottom").tickFormat(tickFormat).tickSize(legendHeight+4).ticks(legendWidth/40);wrapper.append("g").attr("class","legend axis").attr("transform","translate(0, 0)").call(legendAxis);if(justifyTicks||!showTicks){var text=wrapper.selectAll("text")[0];if(text.length>1){_d.default.select(text[0]).style("text-anchor","start");_d.default.select(text[text.length-1]).style("text-anchor","end")}}if(!showTicks){wrapper.selectAll(".axis line").style("display","none")}}),[JSON.stringify(scale),d3Container.current]);if(title===undefined){return _react.default.createElement("svg",{ref:d3Container})}return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("strong",null,title))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("svg",{ref:d3Container})))};exports.ColorRangeLegend=ColorRangeLegend},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useColorRange=exports.colorRangeOptions=exports.COLOR_RANGE=exports.colorRangeScaleOptions=exports.COLOR_RANGE_SCALE=exports.influencerColorScaleFactory=void 0;var _d=_interopRequireDefault(__webpack_require__(97));var _eui_theme_light=_interopRequireDefault(__webpack_require__(40));var _eui_theme_dark=_interopRequireDefault(__webpack_require__(42));var _i18n=__webpack_require__(1);var _use_ui_settings_context=__webpack_require__(150);var _colorDomains;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var influencerColorScaleFactory=function influencerColorScaleFactory(n){return function(t){if(n<=1){return t}if(t<1/n){return 0}if(t<3/n){return n/4*(t-1/n)}return.5+(t-3/n)}};exports.influencerColorScaleFactory=influencerColorScaleFactory;var COLOR_RANGE_SCALE;exports.COLOR_RANGE_SCALE=COLOR_RANGE_SCALE;(function(COLOR_RANGE_SCALE){COLOR_RANGE_SCALE["LINEAR"]="linear";COLOR_RANGE_SCALE["INFLUENCER"]="influencer";COLOR_RANGE_SCALE["SQRT"]="sqrt"})(COLOR_RANGE_SCALE||(exports.COLOR_RANGE_SCALE=COLOR_RANGE_SCALE={}));var colorRangeScaleOptions=[{value:COLOR_RANGE_SCALE.LINEAR,text:_i18n.i18n.translate("xpack.ml.components.colorRangeLegend.linearScaleLabel",{defaultMessage:"Linear"})},{value:COLOR_RANGE_SCALE.INFLUENCER,text:_i18n.i18n.translate("xpack.ml.components.colorRangeLegend.influencerScaleLabel",{defaultMessage:"Influencer custom scale"})},{value:COLOR_RANGE_SCALE.SQRT,text:_i18n.i18n.translate("xpack.ml.components.colorRangeLegend.sqrtScaleLabel",{defaultMessage:"Sqrt"})}];exports.colorRangeScaleOptions=colorRangeScaleOptions;var COLOR_RANGE;exports.COLOR_RANGE=COLOR_RANGE;(function(COLOR_RANGE){COLOR_RANGE["BLUE"]="blue";COLOR_RANGE["RED"]="red";COLOR_RANGE["RED_GREEN"]="red-green";COLOR_RANGE["GREEN_RED"]="green-red";COLOR_RANGE["YELLOW_GREEN_BLUE"]="yellow-green-blue"})(COLOR_RANGE||(exports.COLOR_RANGE=COLOR_RANGE={}));var colorRangeOptions=[{value:COLOR_RANGE.BLUE,text:_i18n.i18n.translate("xpack.ml.components.colorRangeLegend.blueColorRangeLabel",{defaultMessage:"Blue"})},{value:COLOR_RANGE.RED,text:_i18n.i18n.translate("xpack.ml.components.colorRangeLegend.redColorRangeLabel",{defaultMessage:"Red"})},{value:COLOR_RANGE.RED_GREEN,text:_i18n.i18n.translate("xpack.ml.components.colorRangeLegend.redGreenColorRangeLabel",{defaultMessage:"Red - Green"})},{value:COLOR_RANGE.GREEN_RED,text:_i18n.i18n.translate("xpack.ml.components.colorRangeLegend.greenRedColorRangeLabel",{defaultMessage:"Green - Red"})},{value:COLOR_RANGE.YELLOW_GREEN_BLUE,text:_i18n.i18n.translate("xpack.ml.components.colorRangeLegend.yellowGreenBlueColorRangeLabel",{defaultMessage:"Yellow - Green - Blue"})}];exports.colorRangeOptions=colorRangeOptions;var coloursYGB=["#FFFFDD","#AAF191","#80D385","#61B385","#3E9583","#217681","#285285","#1F2D86","#000086"];var colourRangeYGB=_d.default.range(0,1,1/(coloursYGB.length-1));colourRangeYGB.push(1);var colorDomains=(_colorDomains={},_defineProperty(_colorDomains,COLOR_RANGE.BLUE,[0,1]),_defineProperty(_colorDomains,COLOR_RANGE.RED,[0,1]),_defineProperty(_colorDomains,COLOR_RANGE.RED_GREEN,[0,1]),_defineProperty(_colorDomains,COLOR_RANGE.GREEN_RED,[0,1]),_defineProperty(_colorDomains,COLOR_RANGE.YELLOW_GREEN_BLUE,colourRangeYGB),_colorDomains);var useColorRange=function useColorRange(){var _colorRanges,_scaleTypes;var colorRange=arguments.length>0&&arguments[0]!==undefined?arguments[0]:COLOR_RANGE.BLUE;var colorRangeScale=arguments.length>1&&arguments[1]!==undefined?arguments[1]:COLOR_RANGE_SCALE.LINEAR;var featureCount=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var euiTheme=(0,_use_ui_settings_context.useUiSettings)().get("theme:darkMode")?_eui_theme_dark.default:_eui_theme_light.default;var colorRanges=(_colorRanges={},_defineProperty(_colorRanges,COLOR_RANGE.BLUE,[_d.default.rgb(euiTheme.euiColorEmptyShade),_d.default.rgb(euiTheme.euiColorVis1)]),_defineProperty(_colorRanges,COLOR_RANGE.RED,[_d.default.rgb(euiTheme.euiColorEmptyShade),_d.default.rgb(euiTheme.euiColorDanger)]),_defineProperty(_colorRanges,COLOR_RANGE.RED_GREEN,["red","green"]),_defineProperty(_colorRanges,COLOR_RANGE.GREEN_RED,["green","red"]),_defineProperty(_colorRanges,COLOR_RANGE.YELLOW_GREEN_BLUE,coloursYGB),_colorRanges);var linearScale=_d.default.scale.linear().domain(colorDomains[colorRange]).range(colorRanges[colorRange]);var influencerColorScale=influencerColorScaleFactory(featureCount);var influencerScaleLinearWrapper=function influencerScaleLinearWrapper(n){return linearScale(influencerColorScale(n))};var scaleTypes=(_scaleTypes={},_defineProperty(_scaleTypes,COLOR_RANGE_SCALE.LINEAR,linearScale),_defineProperty(_scaleTypes,COLOR_RANGE_SCALE.INFLUENCER,influencerScaleLinearWrapper),_defineProperty(_scaleTypes,COLOR_RANGE_SCALE.SQRT,_d.default.scale.sqrt().domain(colorDomains[colorRange]).range(colorRanges[colorRange])),_scaleTypes);return scaleTypes[colorRangeScale]};exports.useColorRange=useColorRange},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"useExploreData",{enumerable:true,get:function get(){return _use_explore_data.useExploreData}});Object.defineProperty(exports,"TableItem",{enumerable:true,get:function get(){return _use_explore_data.TableItem}});var _use_explore_data=__webpack_require__(1625)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useExploreData=void 0;var _react=__webpack_require__(28);var _ml_api_service=__webpack_require__(51);var _new_job_capabilities_service=__webpack_require__(66);var _index_utils=__webpack_require__(70);var _object_utils=__webpack_require__(149);var _ml=__webpack_require__(77);var _get_analytics=__webpack_require__(189);var _common=__webpack_require__(65);var _fields=__webpack_require__(137);var _common2=__webpack_require__(1626);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var useExploreData=function useExploreData(jobId){var mlContext=(0,_ml.useMlContext)();var _useState=(0,_react.useState)(undefined),_useState2=_slicedToArray(_useState,2),indexPattern=_useState2[0],setIndexPattern=_useState2[1];var _useState3=(0,_react.useState)(undefined),_useState4=_slicedToArray(_useState3,2),jobConfig=_useState4[0],setJobConfig=_useState4[1];var _useState5=(0,_react.useState)(undefined),_useState6=_slicedToArray(_useState5,2),jobStatus=_useState6[0],setJobStatus=_useState6[1];var _useState7=(0,_react.useState)(""),_useState8=_slicedToArray(_useState7,2),errorMessage=_useState8[0],setErrorMessage=_useState8[1];var _useState9=(0,_react.useState)(_common.INDEX_STATUS.UNUSED),_useState10=_slicedToArray(_useState9,2),status=_useState10[0],setStatus=_useState10[1];var _useState11=(0,_react.useState)([]),_useState12=_slicedToArray(_useState11,2),selectedFields=_useState12[0],setSelectedFields=_useState12[1];var _useState13=(0,_react.useState)([]),_useState14=_slicedToArray(_useState13,2),tableFields=_useState14[0],setTableFields=_useState14[1];var _useState15=(0,_react.useState)([]),_useState16=_slicedToArray(_useState15,2),tableItems=_useState16[0],setTableItems=_useState16[1];var _useState17=(0,_react.useState)(0),_useState18=_slicedToArray(_useState17,2),rowCount=_useState18[0],setRowCount=_useState18[1];var _useState19=(0,_react.useState)({pageIndex:0,pageSize:25}),_useState20=_slicedToArray(_useState19,2),pagination=_useState20[0],setPagination=_useState20[1];var _useState21=(0,_react.useState)(_common.defaultSearchQuery),_useState22=_slicedToArray(_useState21,2),searchQuery=_useState22[0],setSearchQuery=_useState22[1];var _useState23=(0,_react.useState)([]),_useState24=_slicedToArray(_useState23,2),sortingColumns=_useState24[0],setSortingColumns=_useState24[1];(0,_react.useEffect)((function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var analyticsConfigs,analyticsStats,stats;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalytics(jobId);case 2:analyticsConfigs=_context.sent;_context.next=5;return _ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(jobId);case 5:analyticsStats=_context.sent;stats=(0,_get_analytics.isGetDataFrameAnalyticsStatsResponseOk)(analyticsStats)?analyticsStats.data_frame_analytics[0]:undefined;if(stats!==undefined&&stats.state){setJobStatus(stats.state)}if(Array.isArray(analyticsConfigs.data_frame_analytics)&&analyticsConfigs.data_frame_analytics.length>0){setJobConfig(analyticsConfigs.data_frame_analytics[0])}case 9:case"end":return _context.stop()}}}),_callee)})))()}),[]);(0,_react.useEffect)((function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var destIndex,destIndexPatternId,indexP,sourceIndex,sourceIndexPatternId;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(jobConfig!==undefined)){_context2.next=28;break}_context2.prev=1;destIndex=Array.isArray(jobConfig.dest.index)?jobConfig.dest.index[0]:jobConfig.dest.index;destIndexPatternId=(0,_index_utils.getIndexPatternIdFromName)(destIndex)||destIndex;_context2.prev=4;_context2.next=7;return mlContext.indexPatterns.get(destIndexPatternId);case 7:indexP=_context2.sent;_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2["catch"](4);indexP=undefined;case 13:if(!(indexP===undefined)){_context2.next=19;break}sourceIndex=jobConfig.source.index[0];sourceIndexPatternId=(0,_index_utils.getIndexPatternIdFromName)(sourceIndex)||sourceIndex;_context2.next=18;return mlContext.indexPatterns.get(sourceIndexPatternId);case 18:indexP=_context2.sent;case 19:if(!(indexP!==undefined)){_context2.next=23;break}setIndexPattern(indexP);_context2.next=23;return _new_job_capabilities_service.newJobCapsService.initializeFromIndexPattern(indexP,false,false);case 23:_context2.next=28;break;case 25:_context2.prev=25;_context2.t1=_context2["catch"](1);console.log("Error loading index field data",_context2.t1);case 28:case"end":return _context2.stop()}}}),_callee2,null,[[1,25],[4,10]])})))()}),[jobConfig&&jobConfig.id]);(0,_react.useEffect)((function(){if(jobConfig!==undefined){setSortingColumns([{id:(0,_common2.getOutlierScoreFieldName)(jobConfig),direction:"desc"}])}}),[jobConfig&&jobConfig.id]);(0,_react.useEffect)((function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var resultsField,sort,pageIndex,pageSize,resp,docs,newSelectedFields,flattenedFields,transformedTableItems;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(jobConfig!==undefined)){_context3.next=29;break}setErrorMessage("");setStatus(_common.INDEX_STATUS.LOADING);_context3.prev=3;resultsField=jobConfig.dest.results_field;sort=sortingColumns.map((function(column){var id=column.id;column.id=(0,_fields.isKeywordAndTextType)(id)?"".concat(id,".keyword"):id;return column})).reduce((function(s,column){s[column.id]={order:column.direction};return s}),{});pageIndex=pagination.pageIndex,pageSize=pagination.pageSize;_context3.next=9;return _ml_api_service.ml.esSearch({index:jobConfig.dest.index,body:_objectSpread({query:searchQuery,from:pageIndex*pageSize,size:pageSize},Object.keys(sort).length>0?{sort:sort}:{})});case 9:resp=_context3.sent;setRowCount(resp.hits.total.value);docs=resp.hits.hits;if(!(docs.length===0)){_context3.next=16;break}setTableItems([]);setStatus(_common.INDEX_STATUS.LOADED);return _context3.abrupt("return");case 16:if(selectedFields.length===0){newSelectedFields=(0,_common.getDefaultSelectableFields)(docs,resultsField);setSelectedFields(newSelectedFields.sort().splice(0,_common.MAX_COLUMNS))}flattenedFields=(0,_common.getFlattenedFields)(docs[0]._source,resultsField);transformedTableItems=docs.map((function(doc){var item={};flattenedFields.forEach((function(ff){item[ff]=(0,_object_utils.getNestedProperty)(doc._source,ff);if(item[ff]===undefined){item[ff]=doc._source['"'.concat(ff,'"')]}if(item[ff]===undefined){var parts=ff.split(".");if(parts[0]===resultsField&&parts.length>=2){parts.shift();if(doc._source[resultsField]!==undefined){item[ff]=doc._source[resultsField][parts.join(".")]}}}}));return item}));setTableFields(flattenedFields);setTableItems(transformedTableItems);setStatus(_common.INDEX_STATUS.LOADED);_context3.next=29;break;case 24:_context3.prev=24;_context3.t0=_context3["catch"](3);if(_context3.t0.message!==undefined){setErrorMessage(_context3.t0.message)}else{setErrorMessage(JSON.stringify(_context3.t0))}setTableItems([]);setStatus(_common.INDEX_STATUS.ERROR);case 29:case"end":return _context3.stop()}}}),_callee3,null,[[3,24]])})))()}),[jobConfig&&jobConfig.id,pagination,searchQuery,selectedFields,sortingColumns]);return{errorMessage:errorMessage,indexPattern:indexPattern,jobConfig:jobConfig,jobStatus:jobStatus,pagination:pagination,rowCount:rowCount,searchQuery:searchQuery,selectedFields:selectedFields,setJobConfig:setJobConfig,setPagination:setPagination,setSearchQuery:setSearchQuery,setSelectedFields:setSelectedFields,setSortingColumns:setSortingColumns,sortingColumns:sortingColumns,status:status,tableFields:tableFields,tableItems:tableItems}};exports.useExploreData=useExploreData},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getOutlierScoreFieldName=void 0;var OUTLIER_SCORE="outlier_score";var getOutlierScoreFieldName=function getOutlierScoreFieldName(jobConfig){return"".concat(jobConfig.dest.results_field,".").concat(OUTLIER_SCORE)};exports.getOutlierScoreFieldName=getOutlierScoreFieldName},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ExplorationDataGrid",{enumerable:true,get:function get(){return _exploration_data_grid.ExplorationDataGrid}});var _exploration_data_grid=__webpack_require__(1628)},function(module,exports,__webpack_require__){"use strict";function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorationDataGrid=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _common=__webpack_require__(65);var _field_format_service=__webpack_require__(112);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}var FEATURE_INFLUENCE="feature_influence";var PAGE_SIZE_OPTIONS=[5,10,25,50];var ExplorationDataGrid=function ExplorationDataGrid(_ref){var colorRange=_ref.colorRange,columns=_ref.columns,indexPattern=_ref.indexPattern,pagination=_ref.pagination,resultsField=_ref.resultsField,rowCount=_ref.rowCount,selectedFields=_ref.selectedFields,setPagination=_ref.setPagination,setSelectedFields=_ref.setSelectedFields,setSortingColumns=_ref.setSortingColumns,sortingColumns=_ref.sortingColumns,tableItems=_ref.tableItems;var renderCellValue=(0,_react.useMemo)((function(){return function(_ref2){var rowIndex=_ref2.rowIndex,columnId=_ref2.columnId,setCellProps=_ref2.setCellProps;var adjustedRowIndex=rowIndex-pagination.pageIndex*pagination.pageSize;var fullItem=tableItems[adjustedRowIndex];if(fullItem===undefined){return null}var format;if(indexPattern!==undefined){format=_field_format_service.mlFieldFormatService.getFieldFormatFromIndexPattern(indexPattern,columnId,"")}var cellValue=fullItem.hasOwnProperty(columnId)&&fullItem[columnId]!==undefined?fullItem[columnId]:null;var split=columnId.split(".");var backgroundColor;if(fullItem["".concat(resultsField,".").concat(FEATURE_INFLUENCE,".").concat(columnId)]!==undefined){backgroundColor=colorRange(fullItem["".concat(resultsField,".").concat(FEATURE_INFLUENCE,".").concat(columnId)])}if(split.length>2&&split[0]===resultsField&&split[1]===FEATURE_INFLUENCE){backgroundColor=colorRange(cellValue)}if(backgroundColor!==undefined){setCellProps({style:{backgroundColor:backgroundColor}})}if(format!==undefined){return format.convert(cellValue,"text")}if(typeof cellValue==="string"||cellValue===null){return cellValue}if(typeof cellValue==="boolean"){return cellValue?"true":"false"}if(_typeof(cellValue)==="object"&&cellValue!==null){return JSON.stringify(cellValue)}return cellValue}}),[resultsField,rowCount,tableItems,pagination.pageIndex,pagination.pageSize]);var onChangeItemsPerPage=(0,_react.useCallback)((function(pageSize){setPagination((function(p){var pageIndex=Math.floor(p.pageSize*p.pageIndex/pageSize);return{pageIndex:pageIndex,pageSize:pageSize}}))}),[setPagination]);var onChangePage=(0,_react.useCallback)((function(pageIndex){return setPagination((function(p){return _objectSpread({},p,{pageIndex:pageIndex})}))}),[setPagination]);var onSort=(0,_react.useCallback)((function(sc){return setSortingColumns(sc)}),[setSortingColumns]);return _react.default.createElement(_eui.EuiDataGrid,{"aria-label":_i18n.i18n.translate("xpack.ml.dataframe.analytics.exploration.dataGridAriaLabel",{defaultMessage:"Outlier detection results table"}),columns:columns,columnVisibility:{visibleColumns:selectedFields,setVisibleColumns:setSelectedFields},gridStyle:_common.euiDataGridStyle,rowCount:rowCount,renderCellValue:renderCellValue,sorting:{columns:sortingColumns,onSort:onSort},toolbarVisibility:_common.euiDataGridToolbarSettings,pagination:_objectSpread({},pagination,{pageSizeOptions:PAGE_SIZE_OPTIONS,onChangeItemsPerPage:onChangeItemsPerPage,onChangePage:onChangePage})})};exports.ExplorationDataGrid=ExplorationDataGrid},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ExplorationQueryBar",{enumerable:true,get:function get(){return _exploration_query_bar.ExplorationQueryBar}});var _exploration_query_bar=__webpack_require__(1630)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorationQueryBar=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _public=__webpack_require__(63);var _search=__webpack_require__(99);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ExplorationQueryBar=function ExplorationQueryBar(_ref){var indexPattern=_ref.indexPattern,setSearchQuery=_ref.setSearchQuery;var _useState=(0,_react.useState)({query:"",language:_search.SEARCH_QUERY_LANGUAGE.KUERY}),_useState2=_slicedToArray(_useState,2),searchInput=_useState2[0],setSearchInput=_useState2[1];var _useState3=(0,_react.useState)(undefined),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];var searchChangeHandler=function searchChangeHandler(query){return setSearchInput(query)};var searchSubmitHandler=function searchSubmitHandler(query){try{switch(query.language){case _search.SEARCH_QUERY_LANGUAGE.KUERY:setSearchQuery(_public.esKuery.toElasticsearchQuery(_public.esKuery.fromKueryExpression(query.query),indexPattern));return;case _search.SEARCH_QUERY_LANGUAGE.LUCENE:setSearchQuery(_public.esQuery.luceneStringToDsl(query.query));return}}catch(e){setErrorMessage({query:query.query,message:e.message})}};return _react.default.createElement(_eui.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:function closePopover(){return setErrorMessage(undefined)},input:_react.default.createElement(_public.QueryStringInput,{bubbleSubmitEvent:true,query:searchInput,indexPatterns:[indexPattern],onChange:searchChangeHandler,onSubmit:searchSubmitHandler,placeholder:searchInput.language===_search.SEARCH_QUERY_LANGUAGE.KUERY?_i18n.i18n.translate("xpack.ml.stepDefineForm.queryPlaceholderKql",{defaultMessage:"e.g. {example}",values:{example:'method : "GET" or status : "404"'}}):_i18n.i18n.translate("xpack.ml.stepDefineForm.queryPlaceholderLucene",{defaultMessage:"e.g. {example}",values:{example:"method:GET OR status:404"}}),disableAutoFocus:true,dataTestSubj:"transformQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown"}),isOpen:(errorMessage===null||errorMessage===void 0?void 0:errorMessage.query)===searchInput.query&&(errorMessage===null||errorMessage===void 0?void 0:errorMessage.message)!==""},_react.default.createElement(_eui.EuiCode,null,_i18n.i18n.translate("xpack.ml.stepDefineForm.invalidQuery",{defaultMessage:"Invalid Query"}),": ",errorMessage===null||errorMessage===void 0?void 0:errorMessage.message.split("\n")[0]))};exports.ExplorationQueryBar=ExplorationQueryBar},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"RegressionExploration",{enumerable:true,get:function get(){return _regression_exploration.RegressionExploration}});var _regression_exploration=__webpack_require__(512)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EvaluatePanel=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _kibana=__webpack_require__(57);var _error_callout=__webpack_require__(513);var _common=__webpack_require__(65);var _columns=__webpack_require__(117);var _evaluate_stat=__webpack_require__(1634);var _analytics=__webpack_require__(76);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var defaultEval={meanSquaredError:"",rSquared:"",error:null};var EvaluatePanel=function EvaluatePanel(_ref){var jobConfig=_ref.jobConfig,jobStatus=_ref.jobStatus,searchQuery=_ref.searchQuery;var _useMlKibana=(0,_kibana.useMlKibana)(),docLinks=_useMlKibana.services.docLinks;var ELASTIC_WEBSITE_URL=docLinks.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=docLinks.DOC_LINK_VERSION;var _useState=(0,_react.useState)(defaultEval),_useState2=_slicedToArray(_useState,2),trainingEval=_useState2[0],setTrainingEval=_useState2[1];var _useState3=(0,_react.useState)(defaultEval),_useState4=_slicedToArray(_useState3,2),generalizationEval=_useState4[0],setGeneralizationEval=_useState4[1];var _useState5=(0,_react.useState)(false),_useState6=_slicedToArray(_useState5,2),isLoadingTraining=_useState6[0],setIsLoadingTraining=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=_slicedToArray(_useState7,2),isLoadingGeneralization=_useState8[0],setIsLoadingGeneralization=_useState8[1];var _useState9=(0,_react.useState)(null),_useState10=_slicedToArray(_useState9,2),trainingDocsCount=_useState10[0],setTrainingDocsCount=_useState10[1];var _useState11=(0,_react.useState)(null),_useState12=_slicedToArray(_useState11,2),generalizationDocsCount=_useState12[0],setGeneralizationDocsCount=_useState12[1];var index=jobConfig.dest.index;var dependentVariable=(0,_common.getDependentVar)(jobConfig.analysis);var predictionFieldName=(0,_common.getPredictionFieldName)(jobConfig.analysis);var resultsField=jobConfig.dest.results_field;var loadGeneralizationData=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var ignoreDefaultQuery,genErrorEval,_getValuesFromRespons,meanSquaredError,rSquared,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:ignoreDefaultQuery=_args.length>0&&_args[0]!==undefined?_args[0]:true;setIsLoadingGeneralization(true);_context.next=4;return(0,_common.loadEvalData)({isTraining:false,index:index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:predictionFieldName,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery,jobType:_analytics.ANALYSIS_CONFIG_TYPE.REGRESSION});case 4:genErrorEval=_context.sent;if(genErrorEval.success===true&&genErrorEval.eval&&(0,_analytics.isRegressionEvaluateResponse)(genErrorEval.eval)){_getValuesFromRespons=(0,_common.getValuesFromResponse)(genErrorEval.eval),meanSquaredError=_getValuesFromRespons.meanSquaredError,rSquared=_getValuesFromRespons.rSquared;setGeneralizationEval({meanSquaredError:meanSquaredError,rSquared:rSquared,error:null});setIsLoadingGeneralization(false)}else{setIsLoadingGeneralization(false);setGeneralizationEval({meanSquaredError:"",rSquared:"",error:genErrorEval.error})}case 6:case"end":return _context.stop()}}}),_callee)})));return function loadGeneralizationData(){return _ref2.apply(this,arguments)}}();var loadTrainingData=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var ignoreDefaultQuery,trainingErrorEval,_getValuesFromRespons2,meanSquaredError,rSquared,_args2=arguments;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:ignoreDefaultQuery=_args2.length>0&&_args2[0]!==undefined?_args2[0]:true;setIsLoadingTraining(true);_context2.next=4;return(0,_common.loadEvalData)({isTraining:true,index:index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:predictionFieldName,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery,jobType:_analytics.ANALYSIS_CONFIG_TYPE.REGRESSION});case 4:trainingErrorEval=_context2.sent;if(trainingErrorEval.success===true&&trainingErrorEval.eval&&(0,_analytics.isRegressionEvaluateResponse)(trainingErrorEval.eval)){_getValuesFromRespons2=(0,_common.getValuesFromResponse)(trainingErrorEval.eval),meanSquaredError=_getValuesFromRespons2.meanSquaredError,rSquared=_getValuesFromRespons2.rSquared;setTrainingEval({meanSquaredError:meanSquaredError,rSquared:rSquared,error:null});setIsLoadingTraining(false)}else{setIsLoadingTraining(false);setTrainingEval({meanSquaredError:"",rSquared:"",error:trainingErrorEval.error})}case 6:case"end":return _context2.stop()}}}),_callee2)})));return function loadTrainingData(){return _ref3.apply(this,arguments)}}();var loadData=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(_ref5){var isTrainingClause,docsCountResp,_docsCountResp,genDocsCountResp,trainDocsCountResp;return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:isTrainingClause=_ref5.isTrainingClause;if(!(isTrainingClause!==undefined&&isTrainingClause.query==="false")){_context3.next=11;break}loadGeneralizationData();_context3.next=5;return(0,_common.loadDocsCount)({isTraining:false,searchQuery:searchQuery,resultsField:resultsField,destIndex:jobConfig.dest.index});case 5:docsCountResp=_context3.sent;if(docsCountResp.success===true){setGeneralizationDocsCount(docsCountResp.docsCount)}else{setGeneralizationDocsCount(null)}setTrainingDocsCount(0);setTrainingEval({meanSquaredError:"--",rSquared:"--",error:null});_context3.next=31;break;case 11:if(!(isTrainingClause!==undefined&&isTrainingClause.query==="true")){_context3.next=21;break}loadTrainingData();_context3.next=15;return(0,_common.loadDocsCount)({isTraining:true,searchQuery:searchQuery,resultsField:resultsField,destIndex:jobConfig.dest.index});case 15:_docsCountResp=_context3.sent;if(_docsCountResp.success===true){setTrainingDocsCount(_docsCountResp.docsCount)}else{setTrainingDocsCount(null)}setGeneralizationDocsCount(0);setGeneralizationEval({meanSquaredError:"--",rSquared:"--",error:null});_context3.next=31;break;case 21:loadGeneralizationData(false);_context3.next=24;return(0,_common.loadDocsCount)({ignoreDefaultQuery:false,isTraining:false,searchQuery:searchQuery,resultsField:resultsField,destIndex:jobConfig.dest.index});case 24:genDocsCountResp=_context3.sent;if(genDocsCountResp.success===true){setGeneralizationDocsCount(genDocsCountResp.docsCount)}else{setGeneralizationDocsCount(null)}loadTrainingData(false);_context3.next=29;return(0,_common.loadDocsCount)({ignoreDefaultQuery:false,isTraining:true,searchQuery:searchQuery,resultsField:resultsField,destIndex:jobConfig.dest.index});case 29:trainDocsCountResp=_context3.sent;if(trainDocsCountResp.success===true){setTrainingDocsCount(trainDocsCountResp.docsCount)}else{setTrainingDocsCount(null)}case 31:case"end":return _context3.stop()}}}),_callee3)})));return function loadData(_x){return _ref4.apply(this,arguments)}}();(0,_react.useEffect)((function(){var hasIsTrainingClause=(0,_analytics.isResultsSearchBoolQuery)(searchQuery)&&searchQuery.bool.must.filter((function(clause){return clause.match&&clause.match["".concat(resultsField,".is_training")]!==undefined}));var isTrainingClause=hasIsTrainingClause&&hasIsTrainingClause[0]&&hasIsTrainingClause[0].match["".concat(resultsField,".is_training")];loadData({isTrainingClause:isTrainingClause})}),[JSON.stringify(searchQuery)]);return _react.default.createElement(_eui.EuiPanel,{"data-test-subj":"mlDFAnalyticsRegressionExplorationEvaluatePanel"},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,{size:"xs"},_react.default.createElement("span",null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.evaluateJobIdTitle",{defaultMessage:"Evaluation of regression job ID {jobId}",values:{jobId:jobConfig.id}})))),jobStatus!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("span",null,(0,_columns.getTaskStateBadge)(jobStatus))),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiSpacer,null)),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:"".concat(ELASTIC_WEBSITE_URL,"guide/en/machine-learning/").concat(DOC_LINK_VERSION,"/ml-dfanalytics-evaluate.html#ml-dfanalytics-regression-evaluation")},_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.regressionDocsLink",{defaultMessage:"Regression evaluation docs "})))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiTitle,{size:"xxs"},_react.default.createElement("span",null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.generalizationErrorTitle",{defaultMessage:"Generalization error"}))),generalizationDocsCount!==null&&_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.generalizationDocsCount",defaultMessage:"{docsCount, plural, one {# doc} other {# docs}} evaluated",values:{docsCount:generalizationDocsCount}})),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiFlexGroup,null,generalizationEval.error!==null&&_react.default.createElement(_error_callout.ErrorCallout,{error:generalizationEval.error}),generalizationEval.error===null&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_evaluate_stat.EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionGenMSEstat",isLoading:isLoadingGeneralization,title:generalizationEval.meanSquaredError,isMSE:true})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_evaluate_stat.EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionGenRSquaredStat",isLoading:isLoadingGeneralization,title:generalizationEval.rSquared,isMSE:false}))))),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiTitle,{size:"xxs"},_react.default.createElement("span",null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.trainingErrorTitle",{defaultMessage:"Training error"}))),trainingDocsCount!==null&&_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.trainingDocsCount",defaultMessage:"{docsCount, plural, one {# doc} other {# docs}} evaluated",values:{docsCount:trainingDocsCount}})),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiFlexGroup,null,trainingEval.error!==null&&_react.default.createElement(_error_callout.ErrorCallout,{error:trainingEval.error}),trainingEval.error===null&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_evaluate_stat.EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionTrainingMSEstat",isLoading:isLoadingTraining,title:trainingEval.meanSquaredError,isMSE:true})),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_evaluate_stat.EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionTrainingRSquaredStat",isLoading:isLoadingTraining,title:trainingEval.rSquared,isMSE:false})))))))};exports.EvaluatePanel=EvaluatePanel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ErrorCallout=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var ErrorCallout=function ErrorCallout(_ref){var error=_ref.error;var errorCallout=_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.generalError",{defaultMessage:"An error occurred loading the data."}),color:"danger",iconType:"cross"},_react.default.createElement("p",null,error));if(error.includes("index_not_found")){errorCallout=_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.evaluateError",{defaultMessage:"An error occurred loading the data."}),color:"danger",iconType:"cross"},_react.default.createElement("p",null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.noIndexCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure the destination index exists and contains documents."})))}else if(error.includes("No documents found")){errorCallout=_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.noDataCalloutTitle",{defaultMessage:"Empty index query result."}),color:"primary"},_react.default.createElement("p",null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.noDataCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure the job has completed and the index contains documents."})))}else if(error.includes("userProvidedQueryBuilder")){errorCallout=_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.queryParsingErrorMessage",{defaultMessage:"Unable to parse query."}),color:"primary"},_react.default.createElement("p",null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.queryParsingErrorBody",{defaultMessage:"The query syntax is invalid and returned no results. Please check the query syntax and try again."})))}return _react.default.createElement(_react.Fragment,null,errorCallout)};exports.ErrorCallout=ErrorCallout},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EvaluateStat=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var meanSquaredErrorText=_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.meanSquaredErrorText",{defaultMessage:"Mean squared error"});var rSquaredText=_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.rSquaredText",{defaultMessage:"R squared"});var meanSquaredErrorTooltipContent=_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.meanSquaredErrorTooltipContent",{defaultMessage:"Measures how well the regression analysis model is performing. Mean squared sum of the difference between true and predicted values."});var rSquaredTooltipContent=_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.rSquaredTooltipContent",{defaultMessage:"Represents the goodness of fit. Measures how well the observed outcomes are replicated by the model."});var EvaluateStat=function EvaluateStat(_ref){var isLoading=_ref.isLoading,isMSE=_ref.isMSE,title=_ref.title,dataTestSubj=_ref.dataTestSubj;return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs","data-test-subj":dataTestSubj},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiStat,{reverse:true,isLoading:isLoading,title:title,description:isMSE?meanSquaredErrorText:rSquaredText,titleSize:"xxs"})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIconTip,{anchorClassName:"mlDataFrameAnalyticsRegression__evaluateStat",content:isMSE?meanSquaredErrorTooltipContent:rSquaredTooltipContent})))};exports.EvaluateStat=EvaluateStat},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ResultsTable=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _momentTimezone=_interopRequireDefault(__webpack_require__(36));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _public=__webpack_require__(63);var _field_format_service=__webpack_require__(112);var _ml_in_memory_table=__webpack_require__(127);var _date_utils=__webpack_require__(83);var _fields=__webpack_require__(137);var _common=__webpack_require__(65);var _columns=__webpack_require__(117);var _use_explore_data=__webpack_require__(1636);var _regression_exploration=__webpack_require__(512);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var PAGE_SIZE_OPTIONS=[5,10,25,50];var MlInMemoryTableBasic=(0,_ml_in_memory_table.mlInMemoryTableBasicFactory)();var showingDocs=_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.documentsShownHelpText",{defaultMessage:"Showing documents for which predictions exist"});var showingFirstDocs=_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.firstDocumentsShownHelpText",{defaultMessage:"Showing first {searchSize} documents for which predictions exist",values:{searchSize:_common.SEARCH_SIZE}});var ResultsTable=_react.default.memo((function(_ref){var indexPattern=_ref.indexPattern,jobConfig=_ref.jobConfig,jobStatus=_ref.jobStatus,setEvaluateSearchQuery=_ref.setEvaluateSearchQuery;var _useState=(0,_react.useState)(0),_useState2=_slicedToArray(_useState,2),pageIndex=_useState2[0],setPageIndex=_useState2[1];var _useState3=(0,_react.useState)(25),_useState4=_slicedToArray(_useState3,2),pageSize=_useState4[0],setPageSize=_useState4[1];var _useState5=(0,_react.useState)([]),_useState6=_slicedToArray(_useState5,2),selectedFields=_useState6[0],setSelectedFields=_useState6[1];var _useState7=(0,_react.useState)([]),_useState8=_slicedToArray(_useState7,2),docFields=_useState8[0],setDocFields=_useState8[1];var _useState9=(0,_react.useState)(undefined),_useState10=_slicedToArray(_useState9,2),depVarType=_useState10[0],setDepVarType=_useState10[1];var _useState11=(0,_react.useState)(false),_useState12=_slicedToArray(_useState11,2),isColumnsPopoverVisible=_useState12[0],setColumnsPopoverVisible=_useState12[1];var _useState13=(0,_react.useState)(_common.defaultSearchQuery),_useState14=_slicedToArray(_useState13,2),searchQuery=_useState14[0],setSearchQuery=_useState14[1];var _useState15=(0,_react.useState)(undefined),_useState16=_slicedToArray(_useState15,2),searchError=_useState16[0],setSearchError=_useState16[1];var _useState17=(0,_react.useState)(undefined),_useState18=_slicedToArray(_useState17,2),searchString=_useState18[0],setSearchString=_useState18[1];var predictedFieldName=(0,_common.getPredictedFieldName)(jobConfig.dest.results_field,jobConfig.analysis);var dependentVariable=(0,_common.getDependentVar)(jobConfig.analysis);function toggleColumnsPopover(){setColumnsPopoverVisible(!isColumnsPopoverVisible)}function closeColumnsPopover(){setColumnsPopoverVisible(false)}function toggleColumn(column){if(tableItems.length>0&&jobConfig!==undefined){setSelectedFields(_toConsumableArray((0,_fields.toggleSelectedField)(selectedFields,column,jobConfig.dest.results_field,depVarType)))}}var needsDestIndexFields=indexPattern&&indexPattern.title===jobConfig.source.index[0];var _useExploreData=(0,_use_explore_data.useExploreData)(jobConfig,needsDestIndexFields,selectedFields,setSelectedFields,setDocFields,setDepVarType),errorMessage=_useExploreData.errorMessage,loadExploreData=_useExploreData.loadExploreData,sortField=_useExploreData.sortField,sortDirection=_useExploreData.sortDirection,status=_useExploreData.status,tableItems=_useExploreData.tableItems;var columns=selectedFields.sort((function(_ref2,_ref3){var a=_ref2.name;var b=_ref3.name;return(0,_fields.sortRegressionResultsFields)(a,b,jobConfig)})).map((function(field){var type=field.type;var format;if(indexPattern!==undefined){format=_field_format_service.mlFieldFormatService.getFieldFormatFromIndexPattern(indexPattern,field.id,"")}var isNumber=type!==undefined&&(_fields.BASIC_NUMERICAL_TYPES.has(type)||_fields.EXTENDED_NUMERICAL_TYPES.has(type));var column={field:field.name,name:field.name,sortable:true,truncateText:true};var render=function render(d,fullItem){if(format!==undefined){d=format.convert(d,"text");return d}if(Array.isArray(d)&&d.every((function(item){return typeof item==="string"}))){return"".concat(d.slice(0,5).join(", ")).concat(d.length>5?", …":"")}else if(Array.isArray(d)){return _react.default.createElement(_eui.EuiToolTip,{content:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.indexArrayToolTipContent",{defaultMessage:"The full content of this array based column cannot be displayed."})},_react.default.createElement(_eui.EuiBadge,null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.indexArrayBadgeContent",{defaultMessage:"array"})))}return d};if(isNumber){column.dataType="number";column.render=render}else if(typeof type!=="undefined"){switch(type){case _public.ES_FIELD_TYPES.BOOLEAN:column.dataType=_public.ES_FIELD_TYPES.BOOLEAN;column.render=function(d){return d?"true":"false"};break;case _public.ES_FIELD_TYPES.DATE:column.align="right";if(format!==undefined){column.render=render}else{column.render=function(d){if(d!==undefined){return(0,_date_utils.formatHumanReadableDateTimeSeconds)((0,_momentTimezone.default)(d).unix()*1e3)}return d}}break;default:column.render=render;break}}else{column.render=render}return column}));var docFieldsCount=docFields.length;(0,_react.useEffect)((function(){if(jobConfig!==undefined&&columns.length>0&&selectedFields.length>0&&sortField!==undefined&&sortDirection!==undefined&&selectedFields.some((function(field){return field.name===sortField}))){var field=sortField;if(predictedFieldName===sortField){field=dependentVariable}var requiresKeyword=(0,_fields.isKeywordAndTextType)(field);loadExploreData({field:sortField,direction:sortDirection,searchQuery:searchQuery,requiresKeyword:requiresKeyword})}}),[JSON.stringify(searchQuery)]);(0,_react.useEffect)((function(){if(jobConfig!==undefined&&columns.length>0&&selectedFields.length>0&&!selectedFields.some((function(field){return field.name===sortField}))){var predictedFieldSelected=selectedFields.some((function(field){return field.name===predictedFieldName}));var sortByField=predictedFieldSelected?dependentVariable:selectedFields[0].name;var requiresKeyword=(0,_fields.isKeywordAndTextType)(sortByField);sortByField=predictedFieldSelected?predictedFieldName:sortByField;var direction=predictedFieldSelected?_ml_in_memory_table.SORT_DIRECTION.DESC:_ml_in_memory_table.SORT_DIRECTION.ASC;loadExploreData({field:sortByField,direction:direction,searchQuery:searchQuery,requiresKeyword:requiresKeyword})}}),[jobConfig,columns.length,selectedFields.length,sortField,sortDirection,tableItems.length]);var sorting=false;var onTableChange;if(columns.length>0&&sortField!==""&&sortField!==undefined){sorting={sort:{field:sortField,direction:sortDirection}};onTableChange=function onTableChange(_ref4){var _ref4$page=_ref4.page,page=_ref4$page===void 0?{index:0,size:10}:_ref4$page,_ref4$sort=_ref4.sort,sort=_ref4$sort===void 0?{field:sortField,direction:sortDirection}:_ref4$sort;var index=page.index,size=page.size;setPageIndex(index);setPageSize(size);if(sort.field!==sortField||sort.direction!==sortDirection){var field=sort.field;if(predictedFieldName===sort.field){field=dependentVariable}loadExploreData(_objectSpread({},sort,{searchQuery:searchQuery,requiresKeyword:(0,_fields.isKeywordAndTextType)(field)}))}}}var pagination={initialPageIndex:pageIndex,initialPageSize:pageSize,totalItemCount:tableItems.length,pageSizeOptions:PAGE_SIZE_OPTIONS,hidePerPageOptions:false};var onQueryChange=function onQueryChange(_ref5){var query=_ref5.query,error=_ref5.error;if(error){setSearchError(error.message)}else{try{var esQueryDsl=_eui.Query.toESQuery(query);setSearchQuery(esQueryDsl);setSearchString(query.text);setSearchError(undefined);setEvaluateSearchQuery(esQueryDsl)}catch(e){setSearchError(e.toString())}}};var search={onChange:onQueryChange,defaultQuery:searchString,box:{incremental:false,placeholder:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.searchBoxPlaceholder",{defaultMessage:"E.g. avg>0.5"})},filters:[{type:"field_value_toggle_group",field:"".concat(jobConfig.dest.results_field,".is_training"),items:[{value:false,name:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.isTestingLabel",{defaultMessage:"Testing"})},{value:true,name:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.isTrainingLabel",{defaultMessage:"Training"})}]}]};if(jobConfig===undefined){return null}if(status===_common.INDEX_STATUS.ERROR&&!errorMessage.includes("parsing_exception")){return _react.default.createElement(_eui.EuiPanel,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_regression_exploration.ExplorationTitle,{jobId:jobConfig.id})),jobStatus!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("span",null,(0,_columns.getTaskStateBadge)(jobStatus)))),_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.indexError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},_react.default.createElement("p",null,errorMessage)))}var tableError=status===_common.INDEX_STATUS.ERROR&&errorMessage.includes("parsing_exception")?errorMessage:searchError;return _react.default.createElement(_eui.EuiPanel,{grow:false,"data-test-subj":"mlDFAnalyticsRegressionExplorationTablePanel"},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_regression_exploration.ExplorationTitle,{jobId:jobConfig.id})),jobStatus!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("span",null,(0,_columns.getTaskStateBadge)(jobStatus))))),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{style:{textAlign:"right"}},docFieldsCount>_common.MAX_COLUMNS&&_react.default.createElement(_eui.EuiText,{size:"s"},_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.fieldSelection",{defaultMessage:"{selectedFieldsLength, number} of {docFieldsCount, number} {docFieldsCount, plural, one {field} other {fields}} selected",values:{selectedFieldsLength:selectedFields.length,docFieldsCount:docFieldsCount}}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement(_eui.EuiPopover,{id:"popover",button:_react.default.createElement(_eui.EuiButtonIcon,{iconType:"gear",onClick:toggleColumnsPopover,"aria-label":_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.selectColumnsAriaLabel",{defaultMessage:"Select columns"})}),isOpen:isColumnsPopoverVisible,closePopover:closeColumnsPopover,ownFocus:true},_react.default.createElement(_eui.EuiPopoverTitle,null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.selectFieldsPopoverTitle",{defaultMessage:"Select fields"})),_react.default.createElement("div",{style:{maxHeight:"400px",overflowY:"scroll"}},docFields.map((function(_ref6){var name=_ref6.name;return _react.default.createElement(_eui.EuiCheckbox,{id:name,key:name,label:name,checked:selectedFields.some((function(field){return field.name===name})),onChange:function onChange(){return toggleColumn(name)},disabled:selectedFields.some((function(field){return field.name===name}))&&selectedFields.length===1})}))))))))),status===_common.INDEX_STATUS.LOADING&&_react.default.createElement(_eui.EuiProgress,{size:"xs",color:"accent"}),status!==_common.INDEX_STATUS.LOADING&&_react.default.createElement(_eui.EuiProgress,{size:"xs",color:"accent",max:1,value:0}),(columns.length>0||searchQuery!==_common.defaultSearchQuery)&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFormRow,{helpText:tableItems.length===_common.SEARCH_SIZE?showingFirstDocs:showingDocs},_react.default.createElement(_react.Fragment,null)),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(MlInMemoryTableBasic,{allowNeutralSort:false,columns:columns,compressed:true,hasActions:false,isSelectable:false,items:tableItems,onTableChange:onTableChange,pagination:pagination,responsive:false,search:search,error:tableError,sorting:sorting})))}));exports.ResultsTable=ResultsTable},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useExploreData=void 0;var _react=__webpack_require__(28);var _lodash=__webpack_require__(49);var _ml_in_memory_table=__webpack_require__(127);var _ml_api_service=__webpack_require__(51);var _object_utils=__webpack_require__(149);var _new_job_capabilities_service=__webpack_require__(66);var _common=__webpack_require__(65);var _analytics=__webpack_require__(76);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var useExploreData=function useExploreData(jobConfig,needsDestIndexFields,selectedFields,setSelectedFields,setDocFields,setDepVarType){var _useState=(0,_react.useState)(""),_useState2=_slicedToArray(_useState,2),errorMessage=_useState2[0],setErrorMessage=_useState2[1];var _useState3=(0,_react.useState)(_common.INDEX_STATUS.UNUSED),_useState4=_slicedToArray(_useState3,2),status=_useState4[0],setStatus=_useState4[1];var _useState5=(0,_react.useState)([]),_useState6=_slicedToArray(_useState5,2),tableItems=_useState6[0],setTableItems=_useState6[1];var _useState7=(0,_react.useState)(""),_useState8=_slicedToArray(_useState7,2),sortField=_useState8[0],setSortField=_useState8[1];var _useState9=(0,_react.useState)(_ml_in_memory_table.SORT_DIRECTION.ASC),_useState10=_slicedToArray(_useState9,2),sortDirection=_useState10[0],setSortDirection=_useState10[1];var getDefaultSelectedFields=function getDefaultSelectedFields(){var fields=_new_job_capabilities_service.newJobCapsService.fields;if(selectedFields.length===0&&jobConfig!==undefined){var _getDefaultFieldsFrom=(0,_common.getDefaultFieldsFromJobCaps)(fields,jobConfig,needsDestIndexFields),defaultSelected=_getDefaultFieldsFrom.selectedFields,docFields=_getDefaultFieldsFrom.docFields,depVarType=_getDefaultFieldsFrom.depVarType;setDepVarType(depVarType);setSelectedFields(defaultSelected);setDocFields(docFields)}};var loadExploreData=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(_ref2){var field,direction,searchQuery,requiresKeyword,resultsField,searchQueryClone,query,body,resp,docs,flattenedFields,transformedTableItems;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:field=_ref2.field,direction=_ref2.direction,searchQuery=_ref2.searchQuery,requiresKeyword=_ref2.requiresKeyword;if(!(jobConfig!==undefined)){_context.next=31;break}setErrorMessage("");setStatus(_common.INDEX_STATUS.LOADING);_context.prev=4;resultsField=jobConfig.dest.results_field;searchQueryClone=(0,_lodash.cloneDeep)(searchQuery);if(JSON.stringify(searchQuery)===JSON.stringify(_analytics.defaultSearchQuery)){query={exists:{field:resultsField}}}else if((0,_analytics.isResultsSearchBoolQuery)(searchQueryClone)){if(searchQueryClone.bool.must===undefined){searchQueryClone.bool.must=[]}searchQueryClone.bool.must.push({exists:{field:resultsField}});query=searchQueryClone}else{query=searchQueryClone}body={query:query};if(field!==undefined){body.sort=[_defineProperty({},"".concat(field).concat(requiresKeyword?".keyword":""),{order:direction})]}_context.next=12;return _ml_api_service.ml.esSearch({index:jobConfig.dest.index,size:_common.SEARCH_SIZE,body:body});case 12:resp=_context.sent;setSortField(field);setSortDirection(direction);docs=resp.hits.hits;if(!(docs.length===0)){_context.next=20;break}setTableItems([]);setStatus(_common.INDEX_STATUS.LOADED);return _context.abrupt("return");case 20:flattenedFields=(0,_common.getFlattenedFields)(docs[0]._source,resultsField);transformedTableItems=docs.map((function(doc){var item={};flattenedFields.forEach((function(ff){item[ff]=(0,_object_utils.getNestedProperty)(doc._source,ff);if(item[ff]===undefined){item[ff]=doc._source['"'.concat(ff,'"')]}if(item[ff]===undefined){var parts=ff.split(".");if(parts[0]===resultsField&&parts.length>=2){parts.shift();if(doc._source[resultsField]!==undefined){item[ff]=doc._source[resultsField][parts.join(".")]}}}}));return item}));setTableItems(transformedTableItems);setStatus(_common.INDEX_STATUS.LOADED);_context.next=31;break;case 26:_context.prev=26;_context.t0=_context["catch"](4);if(_context.t0.message!==undefined){setErrorMessage(_context.t0.message)}else{setErrorMessage(JSON.stringify(_context.t0))}setTableItems([]);setStatus(_common.INDEX_STATUS.ERROR);case 31:case"end":return _context.stop()}}}),_callee,null,[[4,26]])})));return function loadExploreData(_x){return _ref.apply(this,arguments)}}();(0,_react.useEffect)((function(){if(jobConfig!==undefined){getDefaultSelectedFields()}}),[jobConfig&&jobConfig.id]);return{errorMessage:errorMessage,loadExploreData:loadExploreData,sortField:sortField,sortDirection:sortDirection,status:status,tableItems:tableItems}};exports.useExploreData=useExploreData},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LoadingPanel=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LoadingPanel=function LoadingPanel(){return _react.default.createElement(_eui.EuiPanel,{className:"eui-textCenter"},_react.default.createElement(_eui.EuiLoadingSpinner,{size:"xl"}))};exports.LoadingPanel=LoadingPanel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ClassificationExploration",{enumerable:true,get:function get(){return _classification_exploration.ClassificationExploration}});var _classification_exploration=__webpack_require__(514)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EvaluatePanel=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _kibana=__webpack_require__(57);var _error_callout=__webpack_require__(513);var _common=__webpack_require__(65);var _fields=__webpack_require__(137);var _columns=__webpack_require__(117);var _analytics=__webpack_require__(76);var _loading_panel=__webpack_require__(267);var _column_data=__webpack_require__(1640);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var defaultPanelWidth=500;var SUBSET_TITLE;(function(SUBSET_TITLE){SUBSET_TITLE["TRAINING"]="training";SUBSET_TITLE["TESTING"]="testing";SUBSET_TITLE["ENTIRE"]="entire"})(SUBSET_TITLE||(SUBSET_TITLE={}));var entireDatasetHelpText=_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixEntireHelpText",{defaultMessage:"Normalized confusion matrix for entire dataset"});var testingDatasetHelpText=_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixTestingHelpText",{defaultMessage:"Normalized confusion matrix for testing dataset"});var trainingDatasetHelpText=_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixTrainingHelpText",{defaultMessage:"Normalized confusion matrix for training dataset"});function getHelpText(dataSubsetTitle){var helpText=entireDatasetHelpText;if(dataSubsetTitle===SUBSET_TITLE.TESTING){helpText=testingDatasetHelpText}else if(dataSubsetTitle===SUBSET_TITLE.TRAINING){helpText=trainingDatasetHelpText}return helpText}var EvaluatePanel=function EvaluatePanel(_ref){var jobConfig=_ref.jobConfig,jobStatus=_ref.jobStatus,searchQuery=_ref.searchQuery;var _useMlKibana=(0,_kibana.useMlKibana)(),docLinks=_useMlKibana.services.docLinks;var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=_slicedToArray(_useState3,2),confusionMatrixData=_useState4[0],setConfusionMatrixData=_useState4[1];var _useState5=(0,_react.useState)([]),_useState6=_slicedToArray(_useState5,2),columns=_useState6[0],setColumns=_useState6[1];var _useState7=(0,_react.useState)([]),_useState8=_slicedToArray(_useState7,2),columnsData=_useState8[0],setColumnsData=_useState8[1];var _useState9=(0,_react.useState)(false),_useState10=_slicedToArray(_useState9,2),showFullColumns=_useState10[0],setShowFullColumns=_useState10[1];var _useState11=(0,_react.useState)([]),_useState12=_slicedToArray(_useState11,2),popoverContents=_useState12[0],setPopoverContents=_useState12[1];var _useState13=(0,_react.useState)(null),_useState14=_slicedToArray(_useState13,2),docsCount=_useState14[0],setDocsCount=_useState14[1];var _useState15=(0,_react.useState)(null),_useState16=_slicedToArray(_useState15,2),error=_useState16[0],setError=_useState16[1];var _useState17=(0,_react.useState)(SUBSET_TITLE.ENTIRE),_useState18=_slicedToArray(_useState17,2),dataSubsetTitle=_useState18[0],setDataSubsetTitle=_useState18[1];var _useState19=(0,_react.useState)(defaultPanelWidth),_useState20=_slicedToArray(_useState19,2),panelWidth=_useState20[0],setPanelWidth=_useState20[1];var _useState21=(0,_react.useState)((function(){return columns.map((function(_ref2){var id=_ref2.id;return id}))})),_useState22=_slicedToArray(_useState21,2),visibleColumns=_useState22[0],setVisibleColumns=_useState22[1];var index=jobConfig.dest.index;var dependentVariable=(0,_common.getDependentVar)(jobConfig.analysis);var predictionFieldName=(0,_common.getPredictionFieldName)(jobConfig.analysis);var resultsField=jobConfig.dest.results_field;var requiresKeyword=false;var loadData=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee(_ref4){var isTrainingClause,_ref4$ignoreDefaultQu,ignoreDefaultQuery,evalData,docsCountResp,_evalData$eval,_evalData$eval$classi,_evalData$eval$classi2,confusionMatrix;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isTrainingClause=_ref4.isTrainingClause,_ref4$ignoreDefaultQu=_ref4.ignoreDefaultQuery,ignoreDefaultQuery=_ref4$ignoreDefaultQu===void 0?true:_ref4$ignoreDefaultQu;setIsLoading(true);try{requiresKeyword=(0,_fields.isKeywordAndTextType)(dependentVariable)}catch(e){console.error("Unable to load new field types",error)}_context.next=5;return(0,_common.loadEvalData)({isTraining:false,index:index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:predictionFieldName,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery,jobType:_analytics.ANALYSIS_CONFIG_TYPE.CLASSIFICATION,requiresKeyword:requiresKeyword});case 5:evalData=_context.sent;_context.next=8;return(0,_common.loadDocsCount)({isTraining:false,searchQuery:searchQuery,resultsField:resultsField,destIndex:jobConfig.dest.index});case 8:docsCountResp=_context.sent;if(evalData.success===true&&evalData.eval&&(0,_analytics.isClassificationEvaluateResponse)(evalData.eval)){confusionMatrix=(_evalData$eval=evalData.eval)===null||_evalData$eval===void 0?void 0:(_evalData$eval$classi=_evalData$eval.classification)===null||_evalData$eval$classi===void 0?void 0:(_evalData$eval$classi2=_evalData$eval$classi.multiclass_confusion_matrix)===null||_evalData$eval$classi2===void 0?void 0:_evalData$eval$classi2.confusion_matrix;setError(null);setConfusionMatrixData(confusionMatrix||[]);setIsLoading(false)}else{setIsLoading(false);setConfusionMatrixData([]);setError(evalData.error)}if(docsCountResp.success===true){setDocsCount(docsCountResp.docsCount)}else{setDocsCount(null)}case 11:case"end":return _context.stop()}}}),_callee)})));return function loadData(_x){return _ref3.apply(this,arguments)}}();var resizeHandler=function resizeHandler(){var _document$getElementB;var tablePanelWidth=((_document$getElementB=document.getElementById("mlDataFrameAnalyticsTableResultsPanel"))===null||_document$getElementB===void 0?void 0:_document$getElementB.clientWidth)||defaultPanelWidth;var newWidth=tablePanelWidth-8;setPanelWidth(newWidth)};(0,_react.useEffect)((function(){window.addEventListener("resize",resizeHandler);resizeHandler();return function(){window.removeEventListener("resize",resizeHandler)}}),[]);(0,_react.useEffect)((function(){if(confusionMatrixData.length>0){var _getColumnData=(0,_column_data.getColumnData)(confusionMatrixData),derivedColumns=_getColumnData.columns,columnData=_getColumnData.columnData;setVisibleColumns((function(){return derivedColumns.map((function(_ref5){var id=_ref5.id;return id}))}));setColumns(derivedColumns);setColumnsData(columnData);setPopoverContents({numeric:function numeric(_ref6){var _children$props,_children$props2;var cellContentsElement=_ref6.cellContentsElement,children=_ref6.children;var rowIndex=children===null||children===void 0?void 0:(_children$props=children.props)===null||_children$props===void 0?void 0:_children$props.rowIndex;var colId=children===null||children===void 0?void 0:(_children$props2=children.props)===null||_children$props2===void 0?void 0:_children$props2.columnId;var gridItem=columnData[rowIndex];if(gridItem!==undefined&&colId!==_column_data.ACTUAL_CLASS_ID){var count=gridItem[colId];return"".concat(count," / ").concat(gridItem.actual_class_doc_count," * 100 = ").concat(cellContentsElement.textContent)}return cellContentsElement.textContent}})}}),[confusionMatrixData]);(0,_react.useEffect)((function(){var hasIsTrainingClause=(0,_analytics.isResultsSearchBoolQuery)(searchQuery)&&searchQuery.bool.must.filter((function(clause){return clause.match&&clause.match["".concat(resultsField,".is_training")]!==undefined}));var isTrainingClause=hasIsTrainingClause&&hasIsTrainingClause[0]&&hasIsTrainingClause[0].match["".concat(resultsField,".is_training")];var noTrainingQuery=isTrainingClause===false||isTrainingClause===undefined;if(noTrainingQuery){setDataSubsetTitle(SUBSET_TITLE.ENTIRE)}else{setDataSubsetTitle(isTrainingClause&&isTrainingClause.query==="true"?SUBSET_TITLE.TRAINING:SUBSET_TITLE.TESTING)}loadData({isTrainingClause:isTrainingClause})}),[JSON.stringify(searchQuery)]);var renderCellValue=function renderCellValue(_ref7){var rowIndex=_ref7.rowIndex,columnId=_ref7.columnId,setCellProps=_ref7.setCellProps;var cellValue=columnsData[rowIndex][columnId];var actualCount=columnsData[rowIndex]&&columnsData[rowIndex].actual_class_doc_count;var accuracy="0%";if(columnId!==_column_data.ACTUAL_CLASS_ID&&actualCount){accuracy=cellValue/actualCount;accuracy=Math.round(accuracy*100)/100;accuracy="".concat(Math.round(accuracy*100),"%")}(0,_react.useEffect)((function(){if(columnId!==_column_data.ACTUAL_CLASS_ID){setCellProps({style:{backgroundColor:"rgba(0, 179, 164, ".concat(accuracy,")")}})}}),[rowIndex,columnId,setCellProps]);return _react.default.createElement("span",null,columnId===_column_data.ACTUAL_CLASS_ID?cellValue:accuracy)};if(isLoading===true){return _react.default.createElement(_loading_panel.LoadingPanel,null)}var ELASTIC_WEBSITE_URL=docLinks.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=docLinks.DOC_LINK_VERSION;var showTrailingColumns=columnsData.length>_column_data.MAX_COLUMNS;var extraColumns=columnsData.length-_column_data.MAX_COLUMNS;var shownColumns=showTrailingColumns===true&&showFullColumns===false?columns.slice(0,_column_data.MAX_COLUMNS+1):columns;var rowCount=showTrailingColumns===true&&showFullColumns===false?_column_data.MAX_COLUMNS:columnsData.length;return _react.default.createElement(_eui.EuiPanel,{"data-test-subj":"mlDFAnalyticsClassificationExplorationEvaluatePanel",style:{width:"".concat(panelWidth,"px")}},_react.default.createElement(_eui.EuiFlexGroup,{direction:"column",gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiTitle,{size:"xs"},_react.default.createElement("span",null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateJobIdTitle",{defaultMessage:"Evaluation of classification job ID {jobId}",values:{jobId:jobConfig.id}})))),jobStatus!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("span",null,(0,_columns.getTaskStateBadge)(jobStatus))),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiSpacer,null)),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:"".concat(ELASTIC_WEBSITE_URL,"guide/en/machine-learning/").concat(DOC_LINK_VERSION,"/ml-dfanalytics-evaluate.html#ml-dfanalytics-classification")},_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.classificationDocsLink",{defaultMessage:"Classification evaluation docs "}))))),error!==null&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_error_callout.ErrorCallout,{error:error})),error===null&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs"},_react.default.createElement(_eui.EuiTitle,{size:"xxs"},_react.default.createElement("span",null,getHelpText(dataSubsetTitle))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIconTip,{anchorClassName:"mlDataFrameAnalyticsClassificationInfoTooltip",content:_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixTooltip",{defaultMessage:"The multi-class confusion matrix contains the number of occurrences where the analysis classified data points correctly with their actual class as well as the number of occurrences where it misclassified them with another class"})})))),docsCount!==null&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs",color:"subdued"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.generalizationDocsCount",defaultMessage:"{docsCount, plural, one {# doc} other {# docs}} evaluated",values:{docsCount:docsCount}}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",style:{paddingLeft:"5%",paddingRight:"5%"}},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{className:"mlDataFrameAnalyticsClassification__actualLabel",helpText:_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixActualLabel",{defaultMessage:"Actual label"})},_react.default.createElement(_react.Fragment,null))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},columns.length>0&&columnsData.length>0&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{direction:"column",justifyContent:"center",gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{helpText:_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixPredictedLabel",{defaultMessage:"Predicted label"})},_react.default.createElement(_react.Fragment,null))),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:"90%"}},_react.default.createElement(_eui.EuiDataGrid,{"data-test-subj":"mlDFAnalyticsClassificationExplorationConfusionMatrix","aria-label":_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixLabel",{defaultMessage:"Classification confusion matrix"}),columns:shownColumns,columnVisibility:{visibleColumns:visibleColumns,setVisibleColumns:setVisibleColumns},rowCount:rowCount,renderCellValue:renderCellValue,inMemory:{level:"sorting"},toolbarVisibility:{showColumnSelector:true,showStyleSelector:false,showFullScreenSelector:false,showSortSelector:false},popoverContents:popoverContents,gridStyle:{rowHover:"none"},trailingControlColumns:showTrailingColumns===true&&showFullColumns===false?(0,_column_data.getTrailingControlColumns)(extraColumns,setShowFullColumns):undefined}))))))))))};exports.EvaluatePanel=EvaluatePanel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getColumnData=getColumnData;exports.getTrailingControlColumns=getTrailingControlColumns;exports.MAX_COLUMNS=exports.OTHER_CLASS_ID=exports.ACTUAL_CLASS_ID=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var ACTUAL_CLASS_ID="actual_class";exports.ACTUAL_CLASS_ID=ACTUAL_CLASS_ID;var OTHER_CLASS_ID="other";exports.OTHER_CLASS_ID=OTHER_CLASS_ID;var MAX_COLUMNS=6;exports.MAX_COLUMNS=MAX_COLUMNS;function getColumnData(confusionMatrixData){var colData=[];var columns=[{id:ACTUAL_CLASS_ID,display:_react.default.createElement("span",null)}];var showOther=false;confusionMatrixData.forEach((function(classData){var otherCount=classData.other_predicted_class_doc_count;if(otherCount>0){showOther=true}var col={actual_class:classData.actual_class,actual_class_doc_count:classData.actual_class_doc_count,other:otherCount};var predictedClasses=classData.predicted_classes||[];columns.push({id:classData.actual_class});for(var i=0;i<predictedClasses.length;i++){var predictedClass=predictedClasses[i].predicted_class;var predictedClassCount=predictedClasses[i].count;col[predictedClass]=predictedClassCount}colData.push(col)}));if(showOther){columns.push({id:OTHER_CLASS_ID})}return{columns:columns,columnData:colData}}function getTrailingControlColumns(numColumns,setShowFullColumns){return[{id:"actions",width:60,headerCellRender:function headerCellRender(){return _react.default.createElement("span",null,"".concat(numColumns," more"))},rowCellRender:function RowCellRender(){var _useState=(0,_react.useState)(false),_useState2=_slicedToArray(_useState,2),isPopoverOpen=_useState2[0],setIsPopoverOpen=_useState2[1];return _react.default.createElement(_eui.EuiPopover,{isOpen:isPopoverOpen,anchorPosition:"upCenter",button:_react.default.createElement(_eui.EuiButtonIcon,{"aria-label":_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.showActions",{defaultMessage:"Show actions"}),iconType:"boxesHorizontal",color:"text",onClick:function onClick(){return setIsPopoverOpen(!isPopoverOpen)}}),closePopover:function closePopover(){return setIsPopoverOpen(false)},ownFocus:true},_react.default.createElement(_eui.EuiButtonEmpty,{onClick:function onClick(){return setShowFullColumns(true)}},_react.default.createElement(_eui.EuiText,{size:"s",grow:false,textAlign:"center"},_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.showAllColumns",{defaultMessage:"Show all columns"}))))}}]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ResultsTable=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _momentTimezone=_interopRequireDefault(__webpack_require__(36));var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _public=__webpack_require__(63);var _field_format_service=__webpack_require__(112);var _ml_in_memory_table=__webpack_require__(127);var _date_utils=__webpack_require__(83);var _fields=__webpack_require__(137);var _common=__webpack_require__(65);var _columns=__webpack_require__(117);var _use_explore_data=__webpack_require__(1642);var _classification_exploration=__webpack_require__(514);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var PAGE_SIZE_OPTIONS=[5,10,25,50];var MlInMemoryTableBasic=(0,_ml_in_memory_table.mlInMemoryTableBasicFactory)();var showingDocs=_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.documentsShownHelpText",{defaultMessage:"Showing documents for which predictions exist"});var showingFirstDocs=_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.firstDocumentsShownHelpText",{defaultMessage:"Showing first {searchSize} documents for which predictions exist",values:{searchSize:_common.SEARCH_SIZE}});var ResultsTable=_react.default.memo((function(_ref){var indexPattern=_ref.indexPattern,jobConfig=_ref.jobConfig,jobStatus=_ref.jobStatus,setEvaluateSearchQuery=_ref.setEvaluateSearchQuery;var _useState=(0,_react.useState)(0),_useState2=_slicedToArray(_useState,2),pageIndex=_useState2[0],setPageIndex=_useState2[1];var _useState3=(0,_react.useState)(25),_useState4=_slicedToArray(_useState3,2),pageSize=_useState4[0],setPageSize=_useState4[1];var _useState5=(0,_react.useState)([]),_useState6=_slicedToArray(_useState5,2),selectedFields=_useState6[0],setSelectedFields=_useState6[1];var _useState7=(0,_react.useState)([]),_useState8=_slicedToArray(_useState7,2),docFields=_useState8[0],setDocFields=_useState8[1];var _useState9=(0,_react.useState)(undefined),_useState10=_slicedToArray(_useState9,2),depVarType=_useState10[0],setDepVarType=_useState10[1];var _useState11=(0,_react.useState)(false),_useState12=_slicedToArray(_useState11,2),isColumnsPopoverVisible=_useState12[0],setColumnsPopoverVisible=_useState12[1];var _useState13=(0,_react.useState)(_common.defaultSearchQuery),_useState14=_slicedToArray(_useState13,2),searchQuery=_useState14[0],setSearchQuery=_useState14[1];var _useState15=(0,_react.useState)(undefined),_useState16=_slicedToArray(_useState15,2),searchError=_useState16[0],setSearchError=_useState16[1];var _useState17=(0,_react.useState)(undefined),_useState18=_slicedToArray(_useState17,2),searchString=_useState18[0],setSearchString=_useState18[1];var predictedFieldName=(0,_common.getPredictedFieldName)(jobConfig.dest.results_field,jobConfig.analysis);var dependentVariable=(0,_common.getDependentVar)(jobConfig.analysis);function toggleColumnsPopover(){setColumnsPopoverVisible(!isColumnsPopoverVisible)}function closeColumnsPopover(){setColumnsPopoverVisible(false)}function toggleColumn(column){if(tableItems.length>0&&jobConfig!==undefined){setSelectedFields(_toConsumableArray((0,_common.toggleSelectedField)(selectedFields,column,jobConfig.dest.results_field,depVarType)))}}var needsDestIndexFields=indexPattern&&indexPattern.title===jobConfig.source.index[0];var _useExploreData=(0,_use_explore_data.useExploreData)(jobConfig,needsDestIndexFields,selectedFields,setSelectedFields,setDocFields,setDepVarType),errorMessage=_useExploreData.errorMessage,loadExploreData=_useExploreData.loadExploreData,sortField=_useExploreData.sortField,sortDirection=_useExploreData.sortDirection,status=_useExploreData.status,tableItems=_useExploreData.tableItems;var columns=selectedFields.sort((function(_ref2,_ref3){var a=_ref2.name;var b=_ref3.name;return(0,_fields.sortRegressionResultsFields)(a,b,jobConfig)})).map((function(field){var type=field.type;var format;if(indexPattern!==undefined){format=_field_format_service.mlFieldFormatService.getFieldFormatFromIndexPattern(indexPattern,field.id,"")}var isNumber=type!==undefined&&(_fields.BASIC_NUMERICAL_TYPES.has(type)||_fields.EXTENDED_NUMERICAL_TYPES.has(type));var column={field:field.name,name:field.name,sortable:true,truncateText:true};var render=function render(d,fullItem){if(format!==undefined){d=format.convert(d,"text");return d}if(Array.isArray(d)&&d.every((function(item){return typeof item==="string"}))){return"".concat(d.slice(0,5).join(", ")).concat(d.length>5?", …":"")}else if(Array.isArray(d)){return _react.default.createElement(_eui.EuiToolTip,{content:_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.indexArrayToolTipContent",{defaultMessage:"The full content of this array based column cannot be displayed."})},_react.default.createElement(_eui.EuiBadge,null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.indexArrayBadgeContent",{defaultMessage:"array"})))}return d};if(isNumber){column.dataType="number";column.render=render}else if(typeof type!=="undefined"){switch(type){case _public.ES_FIELD_TYPES.BOOLEAN:column.dataType=_public.ES_FIELD_TYPES.BOOLEAN;column.render=function(d){return d?"true":"false"};break;case _public.ES_FIELD_TYPES.DATE:column.align="right";if(format!==undefined){column.render=render}else{column.render=function(d){if(d!==undefined){return(0,_date_utils.formatHumanReadableDateTimeSeconds)((0,_momentTimezone.default)(d).unix()*1e3)}return d}}break;default:column.render=render;break}}else{column.render=render}return column}));var docFieldsCount=docFields.length;(0,_react.useEffect)((function(){if(jobConfig!==undefined&&columns.length>0&&selectedFields.length>0&&sortField!==undefined&&sortDirection!==undefined&&selectedFields.some((function(field){return field.name===sortField}))){var field=sortField;if(predictedFieldName===sortField){field=dependentVariable}var requiresKeyword=(0,_fields.isKeywordAndTextType)(field);loadExploreData({field:sortField,direction:sortDirection,searchQuery:searchQuery,requiresKeyword:requiresKeyword})}}),[JSON.stringify(searchQuery)]);(0,_react.useEffect)((function(){if(jobConfig!==undefined&&columns.length>0&&selectedFields.length>0&&!selectedFields.some((function(field){return field.name===sortField}))){var predictedFieldSelected=selectedFields.some((function(field){return field.name===predictedFieldName}));var sortByField=predictedFieldSelected?dependentVariable:selectedFields[0].name;var requiresKeyword=(0,_fields.isKeywordAndTextType)(sortByField);sortByField=predictedFieldSelected?predictedFieldName:sortByField;var direction=predictedFieldSelected?_ml_in_memory_table.SORT_DIRECTION.DESC:_ml_in_memory_table.SORT_DIRECTION.ASC;loadExploreData({field:sortByField,direction:direction,searchQuery:searchQuery,requiresKeyword:requiresKeyword})}}),[jobConfig,columns.length,selectedFields.length,sortField,sortDirection,tableItems.length]);var sorting=false;var onTableChange;if(columns.length>0&&sortField!==""&&sortField!==undefined){sorting={sort:{field:sortField,direction:sortDirection}};onTableChange=function onTableChange(_ref4){var _ref4$page=_ref4.page,page=_ref4$page===void 0?{index:0,size:10}:_ref4$page,_ref4$sort=_ref4.sort,sort=_ref4$sort===void 0?{field:sortField,direction:sortDirection}:_ref4$sort;var index=page.index,size=page.size;setPageIndex(index);setPageSize(size);if(sort.field!==sortField||sort.direction!==sortDirection){var field=sort.field;if(predictedFieldName===sort.field){field=dependentVariable}loadExploreData(_objectSpread({},sort,{searchQuery:searchQuery,requiresKeyword:(0,_fields.isKeywordAndTextType)(field)}))}}}var pagination={initialPageIndex:pageIndex,initialPageSize:pageSize,totalItemCount:tableItems.length,pageSizeOptions:PAGE_SIZE_OPTIONS,hidePerPageOptions:false};var onQueryChange=function onQueryChange(_ref5){var query=_ref5.query,error=_ref5.error;if(error){setSearchError(error.message)}else{try{var esQueryDsl=_eui.Query.toESQuery(query);setSearchQuery(esQueryDsl);setSearchString(query.text);setSearchError(undefined);setEvaluateSearchQuery(esQueryDsl)}catch(e){setSearchError(e.toString())}}};var search={onChange:onQueryChange,defaultQuery:searchString,box:{incremental:false,placeholder:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.searchBoxPlaceholder",{defaultMessage:"E.g. avg>0.5"})},filters:[{type:"field_value_toggle_group",field:"".concat(jobConfig.dest.results_field,".is_training"),items:[{value:false,name:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.isTestingLabel",{defaultMessage:"Testing"})},{value:true,name:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.isTrainingLabel",{defaultMessage:"Training"})}]}]};if(jobConfig===undefined){return null}if(status===_common.INDEX_STATUS.ERROR&&!errorMessage.includes("parsing_exception")){return _react.default.createElement(_eui.EuiPanel,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_classification_exploration.ExplorationTitle,{jobId:jobConfig.id})),jobStatus!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("span",null,(0,_columns.getTaskStateBadge)(jobStatus)))),_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.indexError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},_react.default.createElement("p",null,errorMessage)))}var tableError=status===_common.INDEX_STATUS.ERROR&&errorMessage.includes("parsing_exception")?errorMessage:searchError;return _react.default.createElement(_eui.EuiPanel,{grow:false,id:"mlDataFrameAnalyticsTableResultsPanel","data-test-subj":"mlDFAnalyticsClassificationExplorationTablePanel"},_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_classification_exploration.ExplorationTitle,{jobId:jobConfig.id})),jobStatus!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("span",null,(0,_columns.getTaskStateBadge)(jobStatus))))),_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{style:{textAlign:"right"}},docFieldsCount>_common.MAX_COLUMNS&&_react.default.createElement(_eui.EuiText,{size:"s"},_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.fieldSelection",{defaultMessage:"{selectedFieldsLength, number} of {docFieldsCount, number} {docFieldsCount, plural, one {field} other {fields}} selected",values:{selectedFieldsLength:selectedFields.length,docFieldsCount:docFieldsCount}}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement(_eui.EuiPopover,{id:"popover",button:_react.default.createElement(_eui.EuiButtonIcon,{iconType:"gear",onClick:toggleColumnsPopover,"aria-label":_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.selectColumnsAriaLabel",{defaultMessage:"Select columns"})}),isOpen:isColumnsPopoverVisible,closePopover:closeColumnsPopover,ownFocus:true},_react.default.createElement(_eui.EuiPopoverTitle,null,_i18n.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.selectFieldsPopoverTitle",{defaultMessage:"Select fields"})),_react.default.createElement("div",{style:{maxHeight:"400px",overflowY:"scroll"}},docFields.map((function(_ref6){var name=_ref6.name;return _react.default.createElement(_eui.EuiCheckbox,{key:name,id:name,label:name,checked:selectedFields.some((function(field){return field.name===name})),onChange:function onChange(){return toggleColumn(name)},disabled:selectedFields.some((function(field){return field.name===name}))&&selectedFields.length===1})}))))))))),status===_common.INDEX_STATUS.LOADING&&_react.default.createElement(_eui.EuiProgress,{size:"xs",color:"accent"}),status!==_common.INDEX_STATUS.LOADING&&_react.default.createElement(_eui.EuiProgress,{size:"xs",color:"accent",max:1,value:0}),(columns.length>0||searchQuery!==_common.defaultSearchQuery)&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFormRow,{helpText:tableItems.length===_common.SEARCH_SIZE?showingFirstDocs:showingDocs},_react.default.createElement(_react.Fragment,null)),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(MlInMemoryTableBasic,{allowNeutralSort:false,columns:columns,compressed:true,hasActions:false,isSelectable:false,items:tableItems,onTableChange:onTableChange,pagination:pagination,responsive:false,search:search,error:tableError,sorting:sorting})))}));exports.ResultsTable=ResultsTable},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useExploreData=void 0;var _react=__webpack_require__(28);var _lodash=__webpack_require__(49);var _ml_in_memory_table=__webpack_require__(127);var _ml_api_service=__webpack_require__(51);var _object_utils=__webpack_require__(149);var _new_job_capabilities_service=__webpack_require__(66);var _analytics=__webpack_require__(76);var _common=__webpack_require__(65);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var useExploreData=function useExploreData(jobConfig,needsDestIndexFields,selectedFields,setSelectedFields,setDocFields,setDepVarType){var _useState=(0,_react.useState)(""),_useState2=_slicedToArray(_useState,2),errorMessage=_useState2[0],setErrorMessage=_useState2[1];var _useState3=(0,_react.useState)(_common.INDEX_STATUS.UNUSED),_useState4=_slicedToArray(_useState3,2),status=_useState4[0],setStatus=_useState4[1];var _useState5=(0,_react.useState)([]),_useState6=_slicedToArray(_useState5,2),tableItems=_useState6[0],setTableItems=_useState6[1];var _useState7=(0,_react.useState)(""),_useState8=_slicedToArray(_useState7,2),sortField=_useState8[0],setSortField=_useState8[1];var _useState9=(0,_react.useState)(_ml_in_memory_table.SORT_DIRECTION.ASC),_useState10=_slicedToArray(_useState9,2),sortDirection=_useState10[0],setSortDirection=_useState10[1];var getDefaultSelectedFields=function getDefaultSelectedFields(){var fields=_new_job_capabilities_service.newJobCapsService.fields;if(selectedFields.length===0&&jobConfig!==undefined){var _getDefaultFieldsFrom=(0,_common.getDefaultFieldsFromJobCaps)(fields,jobConfig,needsDestIndexFields),defaultSelected=_getDefaultFieldsFrom.selectedFields,docFields=_getDefaultFieldsFrom.docFields,depVarType=_getDefaultFieldsFrom.depVarType;setDepVarType(depVarType);setSelectedFields(defaultSelected);setDocFields(docFields)}};var loadExploreData=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(_ref2){var field,direction,searchQuery,requiresKeyword,resultsField,searchQueryClone,query,body,resp,docs,flattenedFields,transformedTableItems;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:field=_ref2.field,direction=_ref2.direction,searchQuery=_ref2.searchQuery,requiresKeyword=_ref2.requiresKeyword;if(!(jobConfig!==undefined)){_context.next=31;break}setErrorMessage("");setStatus(_common.INDEX_STATUS.LOADING);_context.prev=4;resultsField=jobConfig.dest.results_field;searchQueryClone=(0,_lodash.cloneDeep)(searchQuery);if(JSON.stringify(searchQuery)===JSON.stringify(_analytics.defaultSearchQuery)){query={exists:{field:resultsField}}}else if((0,_analytics.isResultsSearchBoolQuery)(searchQueryClone)){if(searchQueryClone.bool.must===undefined){searchQueryClone.bool.must=[]}searchQueryClone.bool.must.push({exists:{field:resultsField}});query=searchQueryClone}else{query=searchQueryClone}body={query:query};if(field!==undefined){body.sort=[_defineProperty({},"".concat(field).concat(requiresKeyword?".keyword":""),{order:direction})]}_context.next=12;return _ml_api_service.ml.esSearch({index:jobConfig.dest.index,size:_common.SEARCH_SIZE,body:body});case 12:resp=_context.sent;setSortField(field);setSortDirection(direction);docs=resp.hits.hits;if(!(docs.length===0)){_context.next=20;break}setTableItems([]);setStatus(_common.INDEX_STATUS.LOADED);return _context.abrupt("return");case 20:flattenedFields=(0,_common.getFlattenedFields)(docs[0]._source,resultsField);transformedTableItems=docs.map((function(doc){var item={};flattenedFields.forEach((function(ff){item[ff]=(0,_object_utils.getNestedProperty)(doc._source,ff);if(item[ff]===undefined){item[ff]=doc._source['"'.concat(ff,'"')]}if(item[ff]===undefined){var parts=ff.split(".");if(parts[0]===resultsField&&parts.length>=2){parts.shift();if(doc._source[resultsField]!==undefined){item[ff]=doc._source[resultsField][parts.join(".")]}}}}));return item}));setTableItems(transformedTableItems);setStatus(_common.INDEX_STATUS.LOADED);_context.next=31;break;case 26:_context.prev=26;_context.t0=_context["catch"](4);if(_context.t0.message!==undefined){setErrorMessage(_context.t0.message)}else{setErrorMessage(JSON.stringify(_context.t0))}setTableItems([]);setStatus(_common.INDEX_STATUS.ERROR);case 31:case"end":return _context.stop()}}}),_callee,null,[[4,26]])})));return function loadExploreData(_x){return _ref.apply(this,arguments)}}();(0,_react.useEffect)((function(){if(jobConfig!==undefined){getDefaultSelectedFields()}}),[jobConfig&&jobConfig.id]);return{errorMessage:errorMessage,loadExploreData:loadExploreData,sortField:sortField,sortDirection:sortDirection,status:status,tableItems:tableItems}};exports.useExploreData=useExploreData},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeSeriesExplorerUrlStateManager=exports.timeSeriesExplorerRoute=void 0;var _lodash=__webpack_require__(49);var _react=_interopRequireWildcard(__webpack_require__(28));var _reactUse=__webpack_require__(236);var _moment=_interopRequireDefault(__webpack_require__(32));var _i18n=__webpack_require__(1);var _timeseriesexplorer=__webpack_require__(1644);var _explorer_utils=__webpack_require__(93);var _ml_api_service=__webpack_require__(51);var _job_service=__webpack_require__(58);var _forecast_service=__webpack_require__(160);var _timeseriesexplorer_constants=__webpack_require__(210);var _timeseriesexplorer_utils=__webpack_require__(274);var _timeseriesexplorer_page=__webpack_require__(522);var _timeseriesexplorer_no_jobs_found=__webpack_require__(1699);var _url_state=__webpack_require__(88);var _select_interval=__webpack_require__(524);var _select_severity=__webpack_require__(525);var _router=__webpack_require__(67);var _use_refresh=__webpack_require__(526);var _use_resolver=__webpack_require__(68);var _resolvers=__webpack_require__(110);var _breadcrumbs=__webpack_require__(69);var _kibana=__webpack_require__(57);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var timeSeriesExplorerRoute={path:"/timeseriesexplorer",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.ANOMALY_DETECTION_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.anomalyDetection.singleMetricViewerLabel",{defaultMessage:"Single Metric Viewer"}),href:""}]};exports.timeSeriesExplorerRoute=timeSeriesExplorerRoute;var PageWrapper=function PageWrapper(_ref){var deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)("",undefined,deps.config,_objectSpread({},(0,_resolvers.basicResolvers)(deps),{jobs:_job_service.mlJobService.loadJobsWrapper,jobsWithTimeRange:function jobsWithTimeRange(){return _ml_api_service.ml.jobs.jobsWithTimerange((0,_explorer_utils.getDateFormatTz)())}})),context=_useResolver.context,results=_useResolver.results;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(TimeSeriesExplorerUrlStateManager,{config:deps.config,jobsWithTimeRange:results.jobsWithTimeRange.jobs}))};var TimeSeriesExplorerUrlStateManager=function TimeSeriesExplorerUrlStateManager(_ref2){var _globalState$time,_globalState$time2,_globalState$ml,_appState$mlTimeSerie,_appState$mlTimeSerie2,_appState$mlTimeSerie3,_appState$mlTimeSerie4,_bounds$min,_bounds$max,_appState$mlTimeSerie5;var config=_ref2.config,jobsWithTimeRange=_ref2.jobsWithTimeRange;var _useUrlState=(0,_url_state.useUrlState)("_a"),_useUrlState2=_slicedToArray(_useUrlState,2),appState=_useUrlState2[0],setAppState=_useUrlState2[1];var _useUrlState3=(0,_url_state.useUrlState)("_g"),_useUrlState4=_slicedToArray(_useUrlState3,2),globalState=_useUrlState4[0],setGlobalState=_useUrlState4[1];var _useState=(0,_react.useState)(0),_useState2=_slicedToArray(_useState,2),lastRefresh=_useState2[0],setLastRefresh=_useState2[1];var previousRefresh=(0,_reactUse.usePrevious)(lastRefresh);var _useState3=(0,_react.useState)(),_useState4=_slicedToArray(_useState3,2),selectedJobId=_useState4[0],setSelectedJobId=_useState4[1];var timefilter=(0,_kibana.useTimefilter)({timeRangeSelector:true,autoRefreshSelector:true});var refresh=(0,_use_refresh.useRefresh)();(0,_react.useEffect)((function(){if(refresh!==undefined){setLastRefresh(refresh===null||refresh===void 0?void 0:refresh.lastRefresh);if(refresh.timeRange!==undefined){var _refresh$timeRange=refresh.timeRange,start=_refresh$timeRange.start,end=_refresh$timeRange.end;setGlobalState("time",{from:start,to:end})}}}),[refresh===null||refresh===void 0?void 0:refresh.lastRefresh]);var _useState5=(0,_react.useState)(undefined),_useState6=_slicedToArray(_useState5,2),bounds=_useState6[0],setBounds=_useState6[1];(0,_react.useEffect)((function(){if((globalState===null||globalState===void 0?void 0:globalState.time)!==undefined){timefilter.setTime({from:globalState.time.from,to:globalState.time.to});var timefilterBounds=timefilter.getBounds();if((timefilterBounds===null||timefilterBounds===void 0?void 0:timefilterBounds.min)!==undefined&&(timefilterBounds===null||timefilterBounds===void 0?void 0:timefilterBounds.max)!==undefined){setBounds(timefilter.getBounds())}}}),[globalState===null||globalState===void 0?void 0:(_globalState$time=globalState.time)===null||_globalState$time===void 0?void 0:_globalState$time.from,globalState===null||globalState===void 0?void 0:(_globalState$time2=globalState.time)===null||_globalState$time2===void 0?void 0:_globalState$time2.to]);var selectedJobIds=globalState===null||globalState===void 0?void 0:(_globalState$ml=globalState.ml)===null||_globalState$ml===void 0?void 0:_globalState$ml.jobIds;if(Array.isArray(selectedJobIds)){selectedJobIds.sort()}var previousSelectedJobIds=(0,_reactUse.usePrevious)(selectedJobIds);var isJobChange=!(0,_lodash.isEqual)(previousSelectedJobIds,selectedJobIds);(0,_react.useEffect)((function(){if(selectedJobIds!==undefined&&previousSelectedJobIds!==undefined){setLastRefresh(Date.now());appStateHandler(_timeseriesexplorer_constants.APP_STATE_ACTION.CLEAR)}var validatedJobId=(0,_timeseriesexplorer_utils.validateJobSelection)(jobsWithTimeRange,selectedJobIds,setGlobalState);if(typeof validatedJobId==="string"){setSelectedJobId(validatedJobId)}}),[JSON.stringify(selectedJobIds)]);var selectedDetectorIndex=isJobChange?0:+(appState===null||appState===void 0?void 0:(_appState$mlTimeSerie=appState.mlTimeSeriesExplorer)===null||_appState$mlTimeSerie===void 0?void 0:_appState$mlTimeSerie.detectorIndex)||0;var selectedEntities=isJobChange?undefined:appState===null||appState===void 0?void 0:(_appState$mlTimeSerie2=appState.mlTimeSeriesExplorer)===null||_appState$mlTimeSerie2===void 0?void 0:_appState$mlTimeSerie2.entities;var selectedForecastId=isJobChange?undefined:appState===null||appState===void 0?void 0:(_appState$mlTimeSerie3=appState.mlTimeSeriesExplorer)===null||_appState$mlTimeSerie3===void 0?void 0:_appState$mlTimeSerie3.forecastId;var zoom=isJobChange?undefined:appState===null||appState===void 0?void 0:(_appState$mlTimeSerie4=appState.mlTimeSeriesExplorer)===null||_appState$mlTimeSerie4===void 0?void 0:_appState$mlTimeSerie4.zoom;var selectedJob=selectedJobId!==undefined?_job_service.mlJobService.getJob(selectedJobId):undefined;var timeSeriesJobs=(0,_timeseriesexplorer_utils.createTimeSeriesJobData)(_job_service.mlJobService.jobs);var autoZoomDuration;if(selectedJobId!==undefined&&selectedJob!==undefined){autoZoomDuration=(0,_timeseriesexplorer_utils.getAutoZoomDuration)(timeSeriesJobs,selectedJob)}var appStateHandler=(0,_react.useCallback)((function(action,payload){var mlTimeSeriesExplorer=(appState===null||appState===void 0?void 0:appState.mlTimeSeriesExplorer)!==undefined?_objectSpread({},appState.mlTimeSeriesExplorer):{};switch(action){case _timeseriesexplorer_constants.APP_STATE_ACTION.CLEAR:delete mlTimeSeriesExplorer.detectorIndex;delete mlTimeSeriesExplorer.entities;delete mlTimeSeriesExplorer.forecastId;delete mlTimeSeriesExplorer.zoom;break;case _timeseriesexplorer_constants.APP_STATE_ACTION.SET_DETECTOR_INDEX:mlTimeSeriesExplorer.detectorIndex=payload;break;case _timeseriesexplorer_constants.APP_STATE_ACTION.SET_ENTITIES:mlTimeSeriesExplorer.entities=payload;break;case _timeseriesexplorer_constants.APP_STATE_ACTION.SET_FORECAST_ID:mlTimeSeriesExplorer.forecastId=payload;delete mlTimeSeriesExplorer.zoom;break;case _timeseriesexplorer_constants.APP_STATE_ACTION.SET_ZOOM:mlTimeSeriesExplorer.zoom=payload;break;case _timeseriesexplorer_constants.APP_STATE_ACTION.UNSET_ZOOM:delete mlTimeSeriesExplorer.zoom;break}setAppState("mlTimeSeriesExplorer",mlTimeSeriesExplorer)}),[JSON.stringify([appState,globalState])]);var boundsMinMs=bounds===null||bounds===void 0?void 0:(_bounds$min=bounds.min)===null||_bounds$min===void 0?void 0:_bounds$min.valueOf();var boundsMaxMs=bounds===null||bounds===void 0?void 0:(_bounds$max=bounds.max)===null||_bounds$max===void 0?void 0:_bounds$max.valueOf();var _useState7=(0,_react.useState)(appState===null||appState===void 0?void 0:(_appState$mlTimeSerie5=appState.mlTimeSeriesExplorer)===null||_appState$mlTimeSerie5===void 0?void 0:_appState$mlTimeSerie5.forecastId),_useState8=_slicedToArray(_useState7,2),selectedForecastIdProp=_useState8[0],setSelectedForecastIdProp=_useState8[1];(0,_react.useEffect)((function(){if(autoZoomDuration!==undefined&&boundsMinMs!==undefined&&boundsMaxMs!==undefined&&selectedJob!==undefined&&selectedForecastId!==undefined){if(selectedForecastIdProp!==selectedForecastId){setSelectedForecastIdProp(undefined)}_forecast_service.mlForecastService.getForecastDateRange(selectedJob,selectedForecastId).then((function(resp){if(autoZoomDuration===undefined){return}var earliest=(0,_moment.default)(resp.earliest||boundsMinMs);var latest=(0,_moment.default)(resp.latest||boundsMaxMs);if(earliest.isBefore((0,_moment.default)(boundsMinMs))||latest.isAfter((0,_moment.default)(boundsMaxMs))){var earliestMs=Math.min(earliest.valueOf(),boundsMinMs);var latestMs=Math.max(latest.valueOf(),boundsMaxMs);setGlobalState("time",{from:(0,_moment.default)(earliestMs).toISOString(),to:(0,_moment.default)(latestMs).toISOString()})}setSelectedForecastIdProp(selectedForecastId)})).catch((function(resp){console.error("Time series explorer - error loading time range of forecast from elasticsearch:",resp)}))}}),[selectedForecastId]);var _useTableInterval=(0,_select_interval.useTableInterval)(),_useTableInterval2=_slicedToArray(_useTableInterval,1),tableInterval=_useTableInterval2[0];var _useTableSeverity=(0,_select_severity.useTableSeverity)(),_useTableSeverity2=_slicedToArray(_useTableSeverity,1),tableSeverity=_useTableSeverity2[0];var tzConfig=config.get("dateFormat:tz");var dateFormatTz=tzConfig!=="Browser"?tzConfig:_moment.default.tz.guess();if(timeSeriesJobs.length===0){return _react.default.createElement(_timeseriesexplorer_page.TimeSeriesExplorerPage,{dateFormatTz:dateFormatTz},_react.default.createElement(_timeseriesexplorer_no_jobs_found.TimeseriesexplorerNoJobsFound,null))}if(selectedJobId===undefined||autoZoomDuration===undefined||bounds===undefined){return null}var zoomProp=typeof selectedForecastId==="string"&&selectedForecastIdProp===undefined?undefined:zoom;return _react.default.createElement(_timeseriesexplorer.TimeSeriesExplorer,{appStateHandler:appStateHandler,autoZoomDuration:autoZoomDuration,bounds:bounds,dateFormatTz:dateFormatTz,lastRefresh:lastRefresh,previousRefresh:previousRefresh,selectedJobId:selectedJobId,selectedDetectorIndex:selectedDetectorIndex,selectedEntities:selectedEntities,selectedForecastId:selectedForecastIdProp,tableInterval:tableInterval.val,tableSeverity:tableSeverity.val,timefilter:timefilter,zoom:zoomProp})};exports.TimeSeriesExplorerUrlStateManager=TimeSeriesExplorerUrlStateManager},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"TimeSeriesExplorer",{enumerable:true,get:function get(){return _timeseriesexplorer.TimeSeriesExplorer}});var _timeseriesexplorer=__webpack_require__(1645)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeSeriesExplorer=void 0;var _lodash=__webpack_require__(49);var _momentTimezone=_interopRequireDefault(__webpack_require__(36));var _rxjs=__webpack_require__(33);var _operators=__webpack_require__(6);var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _dependency_cache=__webpack_require__(5);var _public=__webpack_require__(34);var _search=__webpack_require__(99);var _job_utils=__webpack_require__(59);var _annotation_flyout=__webpack_require__(243);var _annotations_table=__webpack_require__(240);var _anomalies_table=__webpack_require__(515);var _chart_tooltip=__webpack_require__(517);var _entity_control=__webpack_require__(1672);var _forecasting_modal=__webpack_require__(518);var _loading_indicator=__webpack_require__(209);var _select_interval=__webpack_require__(272);var _select_severity=__webpack_require__(273);var _timeseries_chart=__webpack_require__(1680);var _timeseriesexplorer_no_chart_data=__webpack_require__(1686);var _timeseriesexplorer_page=__webpack_require__(522);var _ml_api_service=__webpack_require__(51);var _field_format_service=__webpack_require__(112);var _forecast_service=__webpack_require__(160);var _job_service=__webpack_require__(58);var _results_service=__webpack_require__(132);var _time_buckets=__webpack_require__(106);var _timeseriesexplorer_constants=__webpack_require__(210);var _timeseries_search_service=__webpack_require__(520);var _timeseriesexplorer_utils=__webpack_require__(274);var _entity_control2=__webpack_require__(208);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var allValuesLabel=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.allPartitionValuesLabel",{defaultMessage:"all"});function getEntityControlOptions(fieldValues){if(!Array.isArray(fieldValues)){return[]}fieldValues.sort();return fieldValues.map((function(value){return{label:value===""?_entity_control2.EMPTY_FIELD_VALUE_LABEL:value,value:value}}))}function getViewableDetectors(selectedJob){var jobDetectors=selectedJob.analysis_config.detectors;var viewableDetectors=[];(0,_lodash.each)(jobDetectors,(function(dtr,index){if((0,_job_utils.isTimeSeriesViewDetector)(selectedJob,index)){viewableDetectors.push({index:index,detector_description:dtr.detector_description})}}));return viewableDetectors}function getTimeseriesexplorerDefaultState(){return{chartDetails:undefined,contextAggregationInterval:undefined,contextChartData:undefined,contextForecastData:undefined,dataNotChartable:false,entitiesLoading:false,entityValues:{},focusAnnotationData:[],focusChartData:undefined,focusForecastData:undefined,fullRefresh:true,hasResults:false,loadCounter:0,loading:false,modelPlotEnabled:false,showAnnotations:true,showAnnotationsCheckbox:true,showForecast:true,showForecastCheckbox:false,showModelBounds:true,showModelBoundsCheckbox:false,svgWidth:0,tableData:undefined,zoomFrom:undefined,zoomTo:undefined,zoomFromFocusLoaded:undefined,zoomToFocusLoaded:undefined}}var containerPadding=24;var TimeSeriesExplorer=function(_React$Component){_inherits(TimeSeriesExplorer,_React$Component);function TimeSeriesExplorer(){var _getPrototypeOf2;var _this;_classCallCheck(this,TimeSeriesExplorer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(TimeSeriesExplorer)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"state",getTimeseriesexplorerDefaultState());_defineProperty(_assertThisInitialized(_this),"subscriptions",new _rxjs.Subscription);_defineProperty(_assertThisInitialized(_this),"resizeRef",(0,_react.createRef)());_defineProperty(_assertThisInitialized(_this),"resizeChecker",undefined);_defineProperty(_assertThisInitialized(_this),"resizeHandler",(function(){_this.setState({svgWidth:_this.resizeRef.current!==null?_this.resizeRef.current.offsetWidth-containerPadding:0})}));_defineProperty(_assertThisInitialized(_this),"contextChart$",new _rxjs.Subject);_defineProperty(_assertThisInitialized(_this),"getFieldNamesWithEmptyValues",(function(){var latestEntityControls=_this.getControlsForDetector();return latestEntityControls.filter((function(_ref){var fieldValue=_ref.fieldValue;return fieldValue===null})).map((function(_ref2){var fieldName=_ref2.fieldName;return fieldName}))}));_defineProperty(_assertThisInitialized(_this),"arePartitioningFieldsProvided",(function(){var fieldNamesWithEmptyValues=_this.getFieldNamesWithEmptyValues();return fieldNamesWithEmptyValues.length===0}));_defineProperty(_assertThisInitialized(_this),"detectorIndexChangeHandler",(function(e){var appStateHandler=_this.props.appStateHandler;var id=e.target.value;if(id!==undefined){appStateHandler(_timeseriesexplorer_constants.APP_STATE_ACTION.SET_DETECTOR_INDEX,+id)}}));_defineProperty(_assertThisInitialized(_this),"toggleShowAnnotationsHandler",(function(){_this.setState((function(prevState){return{showAnnotations:!prevState.showAnnotations}}))}));_defineProperty(_assertThisInitialized(_this),"toggleShowForecastHandler",(function(){_this.setState((function(prevState){return{showForecast:!prevState.showForecast}}))}));_defineProperty(_assertThisInitialized(_this),"toggleShowModelBoundsHandler",(function(){_this.setState({showModelBounds:!_this.state.showModelBounds})}));_defineProperty(_assertThisInitialized(_this),"previousChartProps",{});_defineProperty(_assertThisInitialized(_this),"previousShowAnnotations",undefined);_defineProperty(_assertThisInitialized(_this),"previousShowForecast",undefined);_defineProperty(_assertThisInitialized(_this),"previousShowModelBounds",undefined);_defineProperty(_assertThisInitialized(_this),"tableFilter",(function(field,value,operator){var entities=_this.getControlsForDetector();var entity=entities.find((function(_ref3){var fieldName=_ref3.fieldName;return fieldName===field}));if(entity===undefined){return}var appStateHandler=_this.props.appStateHandler;var resultValue="";if(operator==="+"&&entity.fieldValue!==value){resultValue=value}else if(operator==="-"&&entity.fieldValue===value){resultValue=null}else{return}var resultEntities=_objectSpread({},entities.reduce((function(appStateEntities,appStateEntity){appStateEntities[appStateEntity.fieldName]=appStateEntity.fieldValue;return appStateEntities}),{}),_defineProperty({},entity.fieldName,resultValue));appStateHandler(_timeseriesexplorer_constants.APP_STATE_ACTION.SET_ENTITIES,resultEntities)}));_defineProperty(_assertThisInitialized(_this),"contextChartSelectedInitCallDone",false);_defineProperty(_assertThisInitialized(_this),"contextChartSelected",(function(selection){var zoomState={from:selection.from.toISOString(),to:selection.to.toISOString()};if((0,_lodash.isEqual)(_this.props.zoom,zoomState)&&_this.state.focusChartData!==undefined&&_this.props.previousRefresh===_this.props.lastRefresh){return}_this.contextChart$.next(selection);_this.props.appStateHandler(_timeseriesexplorer_constants.APP_STATE_ACTION.SET_ZOOM,zoomState)}));_defineProperty(_assertThisInitialized(_this),"entityFieldValueChanged",(function(entity,fieldValue){var appStateHandler=_this.props.appStateHandler;var entityControls=_this.getControlsForDetector();var resultEntities=_objectSpread({},entityControls.reduce((function(appStateEntities,appStateEntity){appStateEntities[appStateEntity.fieldName]=appStateEntity.fieldValue;return appStateEntities}),{}),_defineProperty({},entity.fieldName,fieldValue));appStateHandler(_timeseriesexplorer_constants.APP_STATE_ACTION.SET_ENTITIES,resultEntities)}));_defineProperty(_assertThisInitialized(_this),"entityFieldSearchChanged",(0,_lodash.debounce)((function(entity,queryTerm){var entityControls=_this.getControlsForDetector();_this.loadEntityValues(entityControls,_defineProperty({},entity.fieldType,queryTerm))}),500));_defineProperty(_assertThisInitialized(_this),"loadAnomaliesTableData",(function(earliestMs,latestMs){var _this$props=_this.props,dateFormatTz=_this$props.dateFormatTz,selectedDetectorIndex=_this$props.selectedDetectorIndex,selectedJobId=_this$props.selectedJobId,tableInterval=_this$props.tableInterval,tableSeverity=_this$props.tableSeverity;var selectedJob=_job_service.mlJobService.getJob(selectedJobId);var entityControls=_this.getControlsForDetector();return _ml_api_service.ml.results.getAnomaliesTableData([selectedJob.job_id],_this.getCriteriaFields(selectedDetectorIndex,entityControls),[],tableInterval,tableSeverity,earliestMs,latestMs,dateFormatTz,_search.ANOMALIES_TABLE_DEFAULT_QUERY_SIZE).pipe((0,_operators.map)((function(resp){var anomalies=resp.anomalies;var detectorsByJob=_job_service.mlJobService.detectorsByJob;anomalies.forEach((function(anomaly){var jobId=anomaly.jobId;var detector=(0,_lodash.get)(detectorsByJob,[jobId,anomaly.detectorIndex]);anomaly.detector=(0,_lodash.get)(detector,["detector_description"],anomaly.source.function_description);var customRules=detector.custom_rules;if(customRules!==undefined){anomaly.rulesLength=customRules.length}if((0,_lodash.has)(_job_service.mlJobService.customUrlsByJob,jobId)){anomaly.customUrls=_job_service.mlJobService.customUrlsByJob[jobId]}}));return{tableData:{anomalies:anomalies,interval:resp.interval,examplesByJobId:resp.examplesByJobId,showViewSeriesLink:false}}})))}));_defineProperty(_assertThisInitialized(_this),"loadEntityValues",function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee(entities){var searchTerm,_this$props2,bounds,selectedJobId,selectedDetectorIndex,selectedJob,detectorIndex,_ref5,partitionField,overField,byField,entityValues,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:searchTerm=_args.length>1&&_args[1]!==undefined?_args[1]:{};_this.setState({entitiesLoading:true});_this$props2=_this.props,bounds=_this$props2.bounds,selectedJobId=_this$props2.selectedJobId,selectedDetectorIndex=_this$props2.selectedDetectorIndex;selectedJob=_job_service.mlJobService.getJob(selectedJobId);detectorIndex=selectedDetectorIndex;_context.next=7;return _results_service.mlResultsService.fetchPartitionFieldsValues(selectedJob.job_id,searchTerm,[{fieldName:"detector_index",fieldValue:detectorIndex}],bounds.min.valueOf(),bounds.max.valueOf()).toPromise();case 7:_ref5=_context.sent;partitionField=_ref5.partition_field;overField=_ref5.over_field;byField=_ref5.by_field;entityValues={};entities.forEach((function(entity){var fieldValues;if((partitionField===null||partitionField===void 0?void 0:partitionField.name)===entity.fieldName){fieldValues=partitionField.values}if((overField===null||overField===void 0?void 0:overField.name)===entity.fieldName){fieldValues=overField.values}if((byField===null||byField===void 0?void 0:byField.name)===entity.fieldName){fieldValues=byField.values}entityValues[entity.fieldName]=fieldValues}));_this.setState({entitiesLoading:false,entityValues:entityValues});case 14:case"end":return _context.stop()}}}),_callee)})));return function(_x){return _ref4.apply(this,arguments)}}());_defineProperty(_assertThisInitialized(_this),"setForecastId",(function(forecastId){_this.props.appStateHandler(_timeseriesexplorer_constants.APP_STATE_ACTION.SET_FORECAST_ID,forecastId)}));_defineProperty(_assertThisInitialized(_this),"loadSingleMetricData",(function(){var fullRefresh=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var _this$props3=_this.props,autoZoomDuration=_this$props3.autoZoomDuration,bounds=_this$props3.bounds,selectedDetectorIndex=_this$props3.selectedDetectorIndex,selectedForecastId=_this$props3.selectedForecastId,selectedJobId=_this$props3.selectedJobId,zoom=_this$props3.zoom;var currentLoadCounter=_this.state.loadCounter;var currentSelectedJob=_job_service.mlJobService.getJob(selectedJobId);if(currentSelectedJob===undefined){return}_this.contextChartSelectedInitCallDone=false;var entityControls=_this.getControlsForDetector();_this.setState(_objectSpread({fullRefresh:fullRefresh,loadCounter:currentLoadCounter+1,loading:true},fullRefresh?{chartDetails:undefined,contextChartData:undefined,contextForecastData:undefined,focusChartData:undefined,focusForecastData:undefined,modelPlotEnabled:(0,_job_utils.isModelPlotEnabled)(currentSelectedJob,selectedDetectorIndex,entityControls),hasResults:false,dataNotChartable:false}:{}),(function(){var _this$state=_this.state,loadCounter=_this$state.loadCounter,modelPlotEnabled=_this$state.modelPlotEnabled;var jobs=(0,_timeseriesexplorer_utils.createTimeSeriesJobData)(_job_service.mlJobService.jobs);var selectedJob=_job_service.mlJobService.getJob(selectedJobId);var detectorIndex=selectedDetectorIndex;var awaitingCount=3;var stateUpdate={};var finish=function finish(counterVar){awaitingCount--;if(awaitingCount===0&&counterVar===loadCounter){stateUpdate.hasResults=Array.isArray(stateUpdate.contextChartData)&&stateUpdate.contextChartData.length>0||Array.isArray(stateUpdate.contextForecastData)&&stateUpdate.contextForecastData.length>0;stateUpdate.loading=false;if(stateUpdate.contextChartData.length&&_this.arePartitioningFieldsProvided()===true){var focusRange=(0,_timeseriesexplorer_utils.calculateInitialFocusRange)(zoom,stateUpdate.contextAggregationInterval,bounds);if(focusRange===undefined||_this.previousSelectedForecastId!==_this.props.selectedForecastId){focusRange=(0,_timeseriesexplorer_utils.calculateDefaultFocusRange)(autoZoomDuration,stateUpdate.contextAggregationInterval,stateUpdate.contextChartData,stateUpdate.contextForecastData);_this.previousSelectedForecastId=_this.props.selectedForecastId}_this.contextChartSelected({from:focusRange[0],to:focusRange[1]})}_this.setState(stateUpdate)}};var nonBlankEntities=entityControls.filter((function(entity){return entity.fieldValue!==null}));if(modelPlotEnabled===false&&(0,_job_utils.isSourceDataChartableForDetector)(selectedJob,detectorIndex)===false&&nonBlankEntities.length>0){stateUpdate.hasResults=false;stateUpdate.loading=false;stateUpdate.dataNotChartable=true;_this.setState(stateUpdate);return}stateUpdate.contextAggregationInterval=(0,_timeseriesexplorer_utils.calculateAggregationInterval)(bounds,_timeseriesexplorer_constants.CHARTS_POINT_TARGET,jobs,selectedJob);var searchBounds=(0,_time_buckets.getBoundsRoundedToInterval)(bounds,stateUpdate.contextAggregationInterval,false);var counter=loadCounter;_timeseries_search_service.mlTimeSeriesSearchService.getMetricData(selectedJob,detectorIndex,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),stateUpdate.contextAggregationInterval.expression).toPromise().then((function(resp){var fullRangeChartData=(0,_timeseriesexplorer_utils.processMetricPlotResults)(resp.results,modelPlotEnabled);stateUpdate.contextChartData=fullRangeChartData;finish(counter)})).catch((function(resp){console.log("Time series explorer - error getting metric data from elasticsearch:",resp)}));_results_service.mlResultsService.getRecordMaxScoreByTime(selectedJob.job_id,_this.getCriteriaFields(detectorIndex,entityControls),searchBounds.min.valueOf(),searchBounds.max.valueOf(),stateUpdate.contextAggregationInterval.expression).then((function(resp){var fullRangeRecordScoreData=(0,_timeseriesexplorer_utils.processRecordScoreResults)(resp.results);stateUpdate.swimlaneData=fullRangeRecordScoreData;finish(counter)})).catch((function(resp){console.log("Time series explorer - error getting bucket anomaly scores from elasticsearch:",resp)}));_timeseries_search_service.mlTimeSeriesSearchService.getChartDetails(selectedJob,detectorIndex,entityControls,searchBounds.min.valueOf(),searchBounds.max.valueOf()).then((function(resp){stateUpdate.chartDetails=resp.results;finish(counter)})).catch((function(resp){console.log("Time series explorer - error getting entity counts from elasticsearch:",resp)}));if(selectedForecastId!==undefined){awaitingCount++;var aggType=undefined;var detector=selectedJob.analysis_config.detectors[detectorIndex];var esAgg=(0,_job_utils.mlFunctionToESAggregation)(detector.function);if(modelPlotEnabled===false&&(esAgg==="sum"||esAgg==="count")){aggType={avg:"sum",max:"sum",min:"sum"}}_forecast_service.mlForecastService.getForecastData(selectedJob,detectorIndex,selectedForecastId,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),stateUpdate.contextAggregationInterval.expression,aggType).toPromise().then((function(resp){stateUpdate.contextForecastData=(0,_timeseriesexplorer_utils.processForecastResults)(resp.results);finish(counter)})).catch((function(resp){console.log("Time series explorer - error loading data for forecast ID ".concat(selectedForecastId),resp)}))}}))}));_defineProperty(_assertThisInitialized(_this),"getControlsForDetector",(function(){var _this$props4=_this.props,selectedDetectorIndex=_this$props4.selectedDetectorIndex,selectedEntities=_this$props4.selectedEntities,selectedJobId=_this$props4.selectedJobId;var selectedJob=_job_service.mlJobService.getJob(selectedJobId);var entities=[];if(selectedJob===undefined){return entities}var detectorIndex=selectedDetectorIndex;var detector=selectedJob.analysis_config.detectors[detectorIndex];var entitiesState=selectedEntities;var partitionFieldName=(0,_lodash.get)(detector,"partition_field_name");var overFieldName=(0,_lodash.get)(detector,"over_field_name");var byFieldName=(0,_lodash.get)(detector,"by_field_name");if(partitionFieldName!==undefined){var partitionFieldValue=(0,_lodash.get)(entitiesState,partitionFieldName,null);entities.push({fieldType:"partition_field",fieldName:partitionFieldName,fieldValue:partitionFieldValue})}if(overFieldName!==undefined){var overFieldValue=(0,_lodash.get)(entitiesState,overFieldName,null);entities.push({fieldType:"over_field",fieldName:overFieldName,fieldValue:overFieldValue})}if(byFieldName!==undefined&&overFieldName===undefined){var byFieldValue=(0,_lodash.get)(entitiesState,byFieldName,null);entities.push({fieldType:"by_field",fieldName:byFieldName,fieldValue:byFieldValue})}return entities}));return _this}_createClass(TimeSeriesExplorer,[{key:"getFocusAggregationInterval",value:function getFocusAggregationInterval(selection){var selectedJobId=this.props.selectedJobId;var jobs=(0,_timeseriesexplorer_utils.createTimeSeriesJobData)(_job_service.mlJobService.jobs);var selectedJob=_job_service.mlJobService.getJob(selectedJobId);var bounds={min:(0,_momentTimezone.default)(selection.from),max:(0,_momentTimezone.default)(selection.to)};return(0,_timeseriesexplorer_utils.calculateAggregationInterval)(bounds,_timeseriesexplorer_constants.CHARTS_POINT_TARGET,jobs,selectedJob)}},{key:"getFocusData",value:function getFocusData(selection){var _this$props5=this.props,selectedJobId=_this$props5.selectedJobId,selectedForecastId=_this$props5.selectedForecastId,selectedDetectorIndex=_this$props5.selectedDetectorIndex;var modelPlotEnabled=this.state.modelPlotEnabled;var selectedJob=_job_service.mlJobService.getJob(selectedJobId);var entityControls=this.getControlsForDetector();var bounds={min:(0,_momentTimezone.default)(selection.from),max:(0,_momentTimezone.default)(selection.to)};var focusAggregationInterval=this.getFocusAggregationInterval(selection);var searchBounds=(0,_time_buckets.getBoundsRoundedToInterval)(bounds,focusAggregationInterval,false);return(0,_timeseriesexplorer_utils.getFocusData)(this.getCriteriaFields(selectedDetectorIndex,entityControls),selectedDetectorIndex,focusAggregationInterval,selectedForecastId,modelPlotEnabled,entityControls.filter((function(entity){return entity.fieldValue!==null})),searchBounds,selectedJob,_timeseriesexplorer_constants.TIME_FIELD_NAME)}},{key:"getCriteriaFields",value:function getCriteriaFields(detectorIndex,entities){var nonBlankEntities=entities.filter((function(entity){return entity.fieldValue!==null}));return[{fieldName:"detector_index",fieldValue:detectorIndex}].concat(_toConsumableArray(nonBlankEntities))}},{key:"loadForJobId",value:function loadForJobId(jobId){var _this$props6=this.props,appStateHandler=_this$props6.appStateHandler,selectedDetectorIndex=_this$props6.selectedDetectorIndex;var selectedJob=_job_service.mlJobService.getJob(jobId);if(selectedJob===undefined){return}var detectors=getViewableDetectors(selectedJob);var appStateDtrIdx=selectedDetectorIndex;var detectorIndex=appStateDtrIdx!==undefined?appStateDtrIdx:detectors[0].index;if((0,_lodash.find)(detectors,{index:detectorIndex})===undefined){var warningText=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.requestedDetectorIndexNotValidWarningMessage",{defaultMessage:"Requested detector index {detectorIndex} is not valid for job {jobId}",values:{detectorIndex:detectorIndex,jobId:selectedJob.job_id}});var toastNotifications=(0,_dependency_cache.getToastNotifications)();toastNotifications.addWarning(warningText);detectorIndex=detectors[0].index}var detectorId=detectorIndex;if(detectorId!==selectedDetectorIndex){appStateHandler(_timeseriesexplorer_constants.APP_STATE_ACTION.SET_DETECTOR_INDEX,detectorId)}_field_format_service.mlFieldFormatService.populateFormats([jobId]).catch((function(err){console.log("Error populating field formats:",err)}))}},{key:"componentDidMount",value:function componentDidMount(){var _this2=this;this.resizeChecker=new _public.ResizeChecker(this.resizeRef.current);this.resizeChecker.on("resize",(function(){_this2.resizeHandler()}));this.resizeHandler();this.subscriptions.add(this.contextChart$.pipe((0,_operators.tap)((function(selection){_this2.setState({zoomFrom:selection.from,zoomTo:selection.to})})),(0,_operators.debounceTime)(500),(0,_operators.tap)((function(selection){var _this2$state=_this2.state,contextChartData=_this2$state.contextChartData,contextForecastData=_this2$state.contextForecastData,focusChartData=_this2$state.focusChartData,zoomFromFocusLoaded=_this2$state.zoomFromFocusLoaded,zoomToFocusLoaded=_this2$state.zoomToFocusLoaded;if((contextChartData===undefined||contextChartData.length===0)&&(contextForecastData===undefined||contextForecastData.length===0)){return}if(_this2.contextChartSelectedInitCallDone===false&&focusChartData===undefined||zoomFromFocusLoaded.getTime()!==selection.from.getTime()||zoomToFocusLoaded.getTime()!==selection.to.getTime()){_this2.contextChartSelectedInitCallDone=true;_this2.setState({loading:true,fullRefresh:false})}})),(0,_operators.switchMap)((function(selection){var selectedJobId=_this2.props.selectedJobId;var jobs=(0,_timeseriesexplorer_utils.createTimeSeriesJobData)(_job_service.mlJobService.jobs);var selectedJob=_job_service.mlJobService.getJob(selectedJobId);var bounds={min:(0,_momentTimezone.default)(selection.from),max:(0,_momentTimezone.default)(selection.to)};var focusAggregationInterval=(0,_timeseriesexplorer_utils.calculateAggregationInterval)(bounds,_timeseriesexplorer_constants.CHARTS_POINT_TARGET,jobs,selectedJob);var searchBounds=(0,_time_buckets.getBoundsRoundedToInterval)(bounds,focusAggregationInterval,false);return(0,_rxjs.forkJoin)([_this2.getFocusData(selection),_this2.loadAnomaliesTableData(searchBounds.min.valueOf(),searchBounds.max.valueOf())])})),(0,_operators.withLatestFrom)(this.contextChart$)).subscribe((function(_ref6){var _ref7=_slicedToArray(_ref6,2),_ref7$=_slicedToArray(_ref7[0],2),refreshFocusData=_ref7$[0],tableData=_ref7$[1],selection=_ref7[1];var modelPlotEnabled=_this2.state.modelPlotEnabled;_this2.setState(_objectSpread({focusAggregationInterval:_this2.getFocusAggregationInterval({from:selection.from,to:selection.to}),loading:false,showModelBoundsCheckbox:modelPlotEnabled&&refreshFocusData.focusChartData.length>0,zoomFromFocusLoaded:selection.from,zoomToFocusLoaded:selection.to},refreshFocusData,{},tableData))})));this.componentDidUpdate()}},{key:"componentDidUpdate",value:function componentDidUpdate(previousProps){var _this3=this;if(previousProps===undefined||previousProps.selectedJobId!==this.props.selectedJobId){this.contextChartSelectedInitCallDone=false;this.setState({fullRefresh:false,loading:true},(function(){_this3.loadForJobId(_this3.props.selectedJobId)}))}if(previousProps===undefined||previousProps.selectedJobId!==this.props.selectedJobId||previousProps.selectedDetectorIndex!==this.props.selectedDetectorIndex||!(0,_lodash.isEqual)(previousProps.selectedEntities,this.props.selectedEntities)){var entityControls=this.getControlsForDetector();this.loadEntityValues(entityControls)}if(previousProps===undefined||previousProps.selectedForecastId!==this.props.selectedForecastId){if(this.props.selectedForecastId!==undefined){this.setState({showForecast:true});if(previousProps!==undefined){this.previousSelectedForecastId=previousProps.selectedForecastId}}}if(previousProps===undefined||!(0,_lodash.isEqual)(previousProps.bounds,this.props.bounds)||!(0,_lodash.isEqual)(previousProps.lastRefresh,this.props.lastRefresh)||!(0,_lodash.isEqual)(previousProps.selectedDetectorIndex,this.props.selectedDetectorIndex)||!(0,_lodash.isEqual)(previousProps.selectedEntities,this.props.selectedEntities)||previousProps.selectedForecastId!==this.props.selectedForecastId||previousProps.selectedJobId!==this.props.selectedJobId){var fullRefresh=previousProps===undefined||!(0,_lodash.isEqual)(previousProps.bounds,this.props.bounds)||!(0,_lodash.isEqual)(previousProps.selectedDetectorIndex,this.props.selectedDetectorIndex)||!(0,_lodash.isEqual)(previousProps.selectedEntities,this.props.selectedEntities)||previousProps.selectedForecastId!==this.props.selectedForecastId||previousProps.selectedJobId!==this.props.selectedJobId;this.loadSingleMetricData(fullRefresh)}if(previousProps===undefined){return}var tableControlsListener=function tableControlsListener(){var _this3$state=_this3.state,zoomFrom=_this3$state.zoomFrom,zoomTo=_this3$state.zoomTo;if(zoomFrom!==undefined&&zoomTo!==undefined){_this3.loadAnomaliesTableData(zoomFrom.getTime(),zoomTo.getTime()).subscribe((function(res){return _this3.setState(res)}))}};if(previousProps.tableInterval!==this.props.tableInterval||previousProps.tableSeverity!==this.props.tableSeverity){tableControlsListener()}}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.subscriptions.unsubscribe();this.resizeChecker.destroy()}},{key:"render",value:function render(){var _this4=this;var _this$props7=this.props,autoZoomDuration=_this$props7.autoZoomDuration,bounds=_this$props7.bounds,dateFormatTz=_this$props7.dateFormatTz,lastRefresh=_this$props7.lastRefresh,selectedDetectorIndex=_this$props7.selectedDetectorIndex,selectedJobId=_this$props7.selectedJobId;var _this$state2=this.state,chartDetails=_this$state2.chartDetails,contextAggregationInterval=_this$state2.contextAggregationInterval,contextChartData=_this$state2.contextChartData,contextForecastData=_this$state2.contextForecastData,dataNotChartable=_this$state2.dataNotChartable,entityValues=_this$state2.entityValues,focusAggregationInterval=_this$state2.focusAggregationInterval,focusAnnotationData=_this$state2.focusAnnotationData,focusChartData=_this$state2.focusChartData,focusForecastData=_this$state2.focusForecastData,fullRefresh=_this$state2.fullRefresh,hasResults=_this$state2.hasResults,loading=_this$state2.loading,modelPlotEnabled=_this$state2.modelPlotEnabled,showAnnotations=_this$state2.showAnnotations,showAnnotationsCheckbox=_this$state2.showAnnotationsCheckbox,showForecast=_this$state2.showForecast,showForecastCheckbox=_this$state2.showForecastCheckbox,showModelBounds=_this$state2.showModelBounds,showModelBoundsCheckbox=_this$state2.showModelBoundsCheckbox,svgWidth=_this$state2.svgWidth,swimlaneData=_this$state2.swimlaneData,tableData=_this$state2.tableData,zoomFrom=_this$state2.zoomFrom,zoomTo=_this$state2.zoomTo,zoomFromFocusLoaded=_this$state2.zoomFromFocusLoaded,zoomToFocusLoaded=_this$state2.zoomToFocusLoaded;var chartProps={modelPlotEnabled:modelPlotEnabled,contextChartData:contextChartData,contextChartSelected:this.contextChartSelected,contextForecastData:contextForecastData,contextAggregationInterval:contextAggregationInterval,swimlaneData:swimlaneData,focusAnnotationData:focusAnnotationData,focusChartData:focusChartData,focusForecastData:focusForecastData,focusAggregationInterval:focusAggregationInterval,svgWidth:svgWidth,zoomFrom:zoomFrom,zoomTo:zoomTo,zoomFromFocusLoaded:zoomFromFocusLoaded,zoomToFocusLoaded:zoomToFocusLoaded,autoZoomDuration:autoZoomDuration};var jobs=(0,_timeseriesexplorer_utils.createTimeSeriesJobData)(_job_service.mlJobService.jobs);if(selectedDetectorIndex===undefined||_job_service.mlJobService.getJob(selectedJobId)===undefined){return _react.default.createElement(_timeseriesexplorer_page.TimeSeriesExplorerPage,{dateFormatTz:dateFormatTz,resizeRef:this.resizeRef})}var selectedJob=_job_service.mlJobService.getJob(selectedJobId);var entityControls=this.getControlsForDetector();var fieldNamesWithEmptyValues=this.getFieldNamesWithEmptyValues();var arePartitioningFieldsProvided=this.arePartitioningFieldsProvided();var detectorSelectOptions=getViewableDetectors(selectedJob).map((function(d){return{value:d.index,text:d.detector_description}}));var renderFocusChartOnly=true;if((0,_lodash.isEqual)(this.previousChartProps.focusForecastData,chartProps.focusForecastData)&&(0,_lodash.isEqual)(this.previousChartProps.focusChartData,chartProps.focusChartData)&&(0,_lodash.isEqual)(this.previousChartProps.focusAnnotationData,chartProps.focusAnnotationData)&&this.previousShowAnnotations===showAnnotations&&this.previousShowForecast===showForecast&&this.previousShowModelBounds===showModelBounds&&this.props.previousRefresh===lastRefresh){renderFocusChartOnly=false}this.previousChartProps=chartProps;this.previousShowAnnotations=showAnnotations;this.previousShowForecast=showForecast;this.previousShowModelBounds=showModelBounds;var hasEmptyFieldValues=false;return _react.default.createElement(_timeseriesexplorer_page.TimeSeriesExplorerPage,{dateFormatTz:dateFormatTz,loading:loading,resizeRef:this.resizeRef},fieldNamesWithEmptyValues.length>0&&_react.default.createElement(_eui.EuiCallOut,{className:"single-metric-request-callout",title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.singleMetricRequiredMessage",defaultMessage:"To view a single metric you must select {missingValuesCount, plural, one {a value for {fieldName1}} other {values for {fieldName1} and {fieldName2}}}",values:{missingValuesCount:fieldNamesWithEmptyValues.length,fieldName1:fieldNamesWithEmptyValues[0],fieldName2:fieldNamesWithEmptyValues[1]}}),color:"warning",iconType:"help",size:"s"}),_react.default.createElement("div",{className:"series-controls","data-test-subj":"mlSingleMetricViewerSeriesControls"},_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.detectorLabel",{defaultMessage:"Detector"})},_react.default.createElement(_eui.EuiSelect,{onChange:this.detectorIndexChangeHandler,value:selectedDetectorIndex,options:detectorSelectOptions,"data-test-subj":"mlSingleMetricViewerDetectorSelect"}))),entityControls.map((function(entity){var entityKey="".concat(entity.fieldName);var forceSelection=!hasEmptyFieldValues&&entity.fieldValue===null;hasEmptyFieldValues=!hasEmptyFieldValues&&forceSelection;return _react.default.createElement(_entity_control.EntityControl,{entity:entity,entityFieldValueChanged:_this4.entityFieldValueChanged,isLoading:_this4.state.entitiesLoading,onSearchChange:_this4.entityFieldSearchChanged,forceSelection:forceSelection,key:entityKey,options:getEntityControlOptions(entityValues[entity.fieldName])})})),arePartitioningFieldsProvided&&_react.default.createElement(_eui.EuiFlexItem,{style:{textAlign:"right"}},_react.default.createElement(_eui.EuiFormRow,{hasEmptyLabelSpace:true,style:{maxWidth:"100%"}},_react.default.createElement(_forecasting_modal.ForecastingModal,{job:selectedJob,detectorIndex:selectedDetectorIndex,entities:entityControls,setForecastId:this.setForecastId,className:"forecast-controls"}))))),fullRefresh&&loading===true&&_react.default.createElement(_loading_indicator.LoadingIndicator,{label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.loadingLabel",{defaultMessage:"Loading"})}),arePartitioningFieldsProvided&&jobs.length>0&&(fullRefresh===false||loading===false)&&hasResults===false&&_react.default.createElement(_timeseriesexplorer_no_chart_data.TimeseriesexplorerNoChartData,{dataNotChartable:dataNotChartable,entities:entityControls}),arePartitioningFieldsProvided&&jobs.length>0&&(fullRefresh===false||loading===false)&&hasResults===true&&_react.default.createElement("div",null,_react.default.createElement(_chart_tooltip.ChartTooltip,null),_react.default.createElement("div",{className:"results-container"},_react.default.createElement(_eui.EuiTitle,{className:"panel-title"},_react.default.createElement("h2",{style:{display:"inline"}},_react.default.createElement("span",null,_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.singleTimeSeriesAnalysisTitle",{defaultMessage:"Single time series analysis of {functionLabel}",values:{functionLabel:chartDetails.functionLabel}}))," ",chartDetails.entityData.count===1&&_react.default.createElement("span",{className:"entity-count-text"},chartDetails.entityData.entities.length>0&&"(",chartDetails.entityData.entities.map((function(entity){return"".concat(entity.fieldName,": ").concat(entity.fieldValue)})).join(", "),chartDetails.entityData.entities.length>0&&")"),chartDetails.entityData.count!==1&&_react.default.createElement("span",{className:"entity-count-text"},chartDetails.entityData.entities.map((function(countData,i){return _react.default.createElement(_react.Fragment,{key:countData.fieldName},_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.countDataInChartDetailsDescription",{defaultMessage:"{openBrace}{cardinalityValue} distinct {fieldName} {cardinality, plural, one {} other { values}}{closeBrace}",values:{openBrace:i===0?"(":"",closeBrace:i===chartDetails.entityData.entities.length-1?")":"",cardinalityValue:countData.cardinality===0?allValuesLabel:countData.cardinality,cardinality:countData.cardinality,fieldName:countData.fieldName}}),i!==chartDetails.entityData.entities.length-1?", ":"")}))))),_react.default.createElement(_eui.EuiFlexGroup,{style:{float:"right"}},showModelBoundsCheckbox&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCheckbox,{id:"toggleModelBoundsCheckbox",label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.showModelBoundsLabel",{defaultMessage:"show model bounds"}),checked:showModelBounds,onChange:this.toggleShowModelBoundsHandler})),showAnnotationsCheckbox&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCheckbox,{id:"toggleAnnotationsCheckbox",label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.annotationsLabel",{defaultMessage:"annotations"}),checked:showAnnotations,onChange:this.toggleShowAnnotationsHandler})),showForecastCheckbox&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCheckbox,{id:"toggleShowForecastCheckbox",label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.showForecastLabel",{defaultMessage:"show forecast"}),checked:showForecast,onChange:this.toggleShowForecastHandler}))),_react.default.createElement("div",{className:"ml-timeseries-chart","data-test-subj":"mlSingleMetricViewerChart"},_react.default.createElement(_timeseries_chart.TimeseriesChart,_extends({},chartProps,{bounds:bounds,detectorIndex:selectedDetectorIndex,renderFocusChartOnly:renderFocusChartOnly,selectedJob:selectedJob,showAnnotations:showAnnotations,showForecast:showForecast,showModelBounds:showModelBounds}))),showAnnotations&&focusAnnotationData.length>0&&_react.default.createElement("div",null,_react.default.createElement(_eui.EuiTitle,{className:"panel-title"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationsTitle",defaultMessage:"Annotations"}))),_react.default.createElement(_annotations_table.AnnotationsTable,{annotations:focusAnnotationData,isSingleMetricViewerLinkVisible:false,isNumberBadgeVisible:true}),_react.default.createElement(_eui.EuiSpacer,{size:"l"})),_react.default.createElement(_annotation_flyout.AnnotationFlyout,null),_react.default.createElement(_eui.EuiTitle,{className:"panel-title"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.anomaliesTitle",defaultMessage:"Anomalies"}))),_react.default.createElement(_eui.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:true,className:"ml-anomalies-controls"},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:"170px"}},_react.default.createElement(_eui.EuiFormRow,{label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.severityThresholdLabel",{defaultMessage:"Severity threshold"})},_react.default.createElement(_select_severity.SelectSeverity,null))),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:"170px"}},_react.default.createElement(_eui.EuiFormRow,{label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.intervalLabel",{defaultMessage:"Interval"})},_react.default.createElement(_select_interval.SelectInterval,null)))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))),arePartitioningFieldsProvided&&jobs.length>0&&hasResults===true&&_react.default.createElement(_anomalies_table.AnomaliesTable,{bounds:bounds,tableData:tableData,filter:this.tableFilter}))}}]);return TimeSeriesExplorer}(_react.default.Component);exports.TimeSeriesExplorer=TimeSeriesExplorer;_defineProperty(TimeSeriesExplorer,"propTypes",{appStateHandler:_propTypes.default.func.isRequired,autoZoomDuration:_propTypes.default.number.isRequired,bounds:_propTypes.default.object.isRequired,dateFormatTz:_propTypes.default.string.isRequired,lastRefresh:_propTypes.default.number.isRequired,previousRefresh:_propTypes.default.number.isRequired,selectedJobId:_propTypes.default.string.isRequired,selectedDetectorIndex:_propTypes.default.number,selectedEntities:_propTypes.default.object,selectedForecastId:_propTypes.default.string,tableInterval:_propTypes.default.string,tableSeverity:_propTypes.default.number,zoom:_propTypes.default.object})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getColumns=getColumns;var _eui=__webpack_require__(29);var _react=_interopRequireDefault(__webpack_require__(28));var _lodash=_interopRequireDefault(__webpack_require__(49));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _date_utils=__webpack_require__(83);var _description_cell=__webpack_require__(1647);var _detector_cell=__webpack_require__(1649);var _entity_cell=__webpack_require__(268);var _influencers_cell=__webpack_require__(1651);var _links_menu=__webpack_require__(1652);var _check_privilege=__webpack_require__(56);var _field_format_service=__webpack_require__(112);var _anomaly_utils=__webpack_require__(75);var _format_value=__webpack_require__(133);var _anomalies_table_constants=__webpack_require__(270);var _severity_cell=__webpack_require__(1654);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function renderTime(date,aggregationInterval){if(aggregationInterval==="hour"){return(0,_date_utils.formatHumanReadableDateTime)(date)}else if(aggregationInterval==="second"){return(0,_date_utils.formatHumanReadableDateTimeSeconds)(date)}else{return(0,_date_utils.formatHumanReadableDate)(date)}}function showLinksMenuForItem(item,showViewSeriesLink){var canConfigureRules=(0,_anomaly_utils.isRuleSupported)(item.source)&&(0,_check_privilege.checkPermission)("canUpdateJob");return canConfigureRules||showViewSeriesLink&&item.isTimeSeriesViewRecord||item.entityName==="mlcategory"||item.customUrls!==undefined}function getColumns(items,jobIds,examplesByJobId,isAggregatedData,interval,bounds,showViewSeriesLink,showRuleEditorFlyout,itemIdToExpandedRowMap,toggleRow,filter,influencerFilter){var columns=[{name:_react.default.createElement(_eui.EuiScreenReaderOnly,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each anomaly"}))),render:function render(item){return _react.default.createElement(_eui.EuiButtonIcon,{onClick:function onClick(){return toggleRow(item)},iconType:itemIdToExpandedRowMap[item.rowId]?"arrowDown":"arrowRight","aria-label":itemIdToExpandedRowMap[item.rowId]?_i18n.i18n.translate("xpack.ml.anomaliesTable.hideDetailsAriaLabel",{defaultMessage:"Hide details"}):_i18n.i18n.translate("xpack.ml.anomaliesTable.showDetailsAriaLabel",{defaultMessage:"Show details"}),"data-row-id":item.rowId,"data-test-subj":"mlJobListRowDetailsToggle"})}},{field:"time","data-test-subj":"mlAnomaliesListColumnTime",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.timeColumnName",{defaultMessage:"time"}),dataType:"date",scope:"row",render:function render(date){return renderTime(date,interval)},textOnly:true,sortable:true},{field:"severity","data-test-subj":"mlAnomaliesListColumnSeverity",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.severityColumnName",{defaultMessage:"severity"}),render:function render(score,item){return _react.default.createElement(_severity_cell.SeverityCell,{score:score,multiBucketImpact:item.source.multi_bucket_impact})},sortable:true},{field:"detector","data-test-subj":"mlAnomaliesListColumnDetector",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.detectorColumnName",{defaultMessage:"detector"}),render:function render(detectorDescription,item){return _react.default.createElement(_detector_cell.DetectorCell,{detectorDescription:detectorDescription,numberOfRules:item.rulesLength})},textOnly:true,sortable:true}];if(items.some((function(item){return item.entityValue!==undefined}))){columns.push({field:"entityValue","data-test-subj":"mlAnomaliesListColumnFoundFor",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.entityValueColumnName",{defaultMessage:"found for"}),render:function render(entityValue,item){return _react.default.createElement(_entity_cell.EntityCell,{entityName:item.entityName,entityValue:entityValue,filter:filter,wrapText:true})},textOnly:true,sortable:true})}if(items.some((function(item){return item.influencers!==undefined}))){columns.push({field:"influencers","data-test-subj":"mlAnomaliesListColumnInfluencers",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.influencersColumnName",{defaultMessage:"influenced by"}),render:function render(influencers){return _react.default.createElement(_influencers_cell.InfluencersCell,{limit:_anomalies_table_constants.INFLUENCERS_LIMIT,influencers:influencers,influencerFilter:influencerFilter})},textOnly:true,sortable:true})}if(items.some((function(item){return item.actual!==undefined}))){columns.push({field:"actualSort","data-test-subj":"mlAnomaliesListColumnActual",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.actualSortColumnName",{defaultMessage:"actual"}),render:function render(actual,item){var fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormat(item.jobId,item.source.detector_index);return(0,_format_value.formatValue)(item.actual,item.source.function,fieldFormat,item.source)},sortable:true})}if(items.some((function(item){return item.typical!==undefined}))){columns.push({field:"typicalSort","data-test-subj":"mlAnomaliesListColumnTypical",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.typicalSortColumnName",{defaultMessage:"typical"}),render:function render(typical,item){var fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormat(item.jobId,item.source.detector_index);return(0,_format_value.formatValue)(item.typical,item.source.function,fieldFormat,item.source)},sortable:true});var nonTimeOfDayOrWeek=items.some((function(item){var summaryRecFunc=item.source.function;return summaryRecFunc!=="time_of_day"&&summaryRecFunc!=="time_of_week"}));if(nonTimeOfDayOrWeek===true){columns.push({field:"metricDescriptionSort","data-test-subj":"mlAnomaliesListColumnDescription",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.metricDescriptionSortColumnName",{defaultMessage:"description"}),render:function render(metricDescriptionSort,item){return _react.default.createElement(_description_cell.DescriptionCell,{actual:item.actual,typical:item.typical})},textOnly:true,sortable:true})}}if(jobIds&&jobIds.length>1){columns.push({field:"jobId","data-test-subj":"mlAnomaliesListColumnJobID",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.jobIdColumnName",{defaultMessage:"job ID"}),sortable:true})}var showExamples=items.some((function(item){return item.entityName==="mlcategory"}));if(showExamples===true){columns.push({"data-test-subj":"mlAnomaliesListColumnCategoryExamples",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.categoryExamplesColumnName",{defaultMessage:"category examples"}),sortable:false,truncateText:true,render:function render(item){var examples=_lodash.default.get(examplesByJobId,[item.jobId,item.entityValue],[]);return _react.default.createElement(_eui.EuiLink,{className:"mlAnomalyCategoryExamples__link",onClick:function onClick(){return toggleRow(item,_anomalies_table_constants.ANOMALIES_TABLE_TABS.CATEGORY_EXAMPLES)}},examples.map((function(example,i){return _react.default.createElement("span",{key:"example".concat(i),className:"category-example"},example)})))},textOnly:true,width:"13%"})}var showLinks=items.some((function(item){return showLinksMenuForItem(item,showViewSeriesLink)}));if(showLinks===true){columns.push({"data-test-subj":"mlAnomaliesListColumnAction",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.actionsColumnName",{defaultMessage:"actions"}),render:function render(item){if(showLinksMenuForItem(item,showViewSeriesLink)===true){return _react.default.createElement(_links_menu.LinksMenu,{anomaly:item,bounds:bounds,showViewSeriesLink:showViewSeriesLink,isAggregatedData:isAggregatedData,interval:interval,showRuleEditorFlyout:showRuleEditorFlyout})}else{return null}}})}return columns}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DescriptionCell=DescriptionCell;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _metric_change_description=__webpack_require__(1648);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function DescriptionCell(_ref){var actual=_ref.actual,typical=_ref.typical;var _getMetricChangeDescr=(0,_metric_change_description.getMetricChangeDescription)(actual,typical),iconType=_getMetricChangeDescr.iconType,message=_getMetricChangeDescr.message;return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},iconType!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIcon,{type:iconType,size:"s"})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},message)))}DescriptionCell.propTypes={actual:_propTypes.default.oneOfType([_propTypes.default.array,_propTypes.default.number]),typical:_propTypes.default.oneOfType([_propTypes.default.array,_propTypes.default.number])}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getMetricChangeDescription=getMetricChangeDescription;var _i18n=__webpack_require__(1);function getMetricChangeDescription(actualProp,typicalProp){if(actualProp===undefined||typicalProp===undefined){return{iconType:"empty",message:""}}var iconType="alert";var message;var actual=0;var typical=0;if(Array.isArray(actualProp)){if(actualProp.length===1){actual=actualProp[0]}else{return{iconType:"alert",message:_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusualValuesDescription",{defaultMessage:"Unusual values"})}}}else{actual=actualProp}if(Array.isArray(typicalProp)){if(typicalProp.length===1){typical=typicalProp[0]}}else{typical=typicalProp}if(actual===typical){message=_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.actualSameAsTypicalDescription",{defaultMessage:"actual same as typical"})}else{var isHigher=actual>typical;iconType=isHigher?"sortUp":"sortDown";if(typical!==0&&actual!==0){var factor=isHigher?actual/typical:typical/actual;if(factor>1.5){if(factor<=100){message=isHigher?_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:Math.round(factor)}}):_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:Math.round(factor)}})}else{message=isHigher?_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThan100xHigherDescription",{defaultMessage:"More than 100x higher"}):_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThan100xLowerDescription",{defaultMessage:"More than 100x lower"})}}else if(factor>=1.05){message=isHigher?_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:factor.toPrecision(2)}}):_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:factor.toPrecision(2)}})}else{message=isHigher?_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusuallyHighDescription",{defaultMessage:"Unusually high"}):_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusuallyLowDescription",{defaultMessage:"Unusually low"})}}else{if(actual===0){message=_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unexpectedZeroValueDescription",{defaultMessage:"Unexpected zero value"})}else{message=_i18n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unexpectedNonZeroValueDescription",{defaultMessage:"Unexpected non-zero value"})}}}return{iconType:iconType,message:message}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DetectorCell=DetectorCell;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function DetectorCell(_ref){var detectorDescription=_ref.detectorDescription,numberOfRules=_ref.numberOfRules;var rulesIcon;if(numberOfRules!==undefined&&numberOfRules>0){rulesIcon=_react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.detectorCell.rulesConfiguredTooltip",defaultMessage:"rules have been configured for this detector"})},_react.default.createElement(_eui.EuiIcon,{type:"controlsHorizontal",className:"detector-rules-icon"}))}return _react.default.createElement(_react.default.Fragment,null,detectorDescription,rulesIcon)}DetectorCell.propTypes={detectorDescription:_propTypes.default.string.isRequired,numberOfRules:_propTypes.default.number}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EntityCell=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _entity_control=__webpack_require__(208);var _field_types=__webpack_require__(109);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getAddFilter(_ref){var entityName=_ref.entityName,entityValue=_ref.entityValue,filter=_ref.filter;return _react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.entityCell.addFilterTooltip",defaultMessage:"Add filter"})},_react.default.createElement(_eui.EuiButtonIcon,{size:"s",className:"filter-button",onClick:function onClick(){return filter(entityName,entityValue,"+")},iconType:"plusInCircle","aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.entityCell.addFilterAriaLabel",{defaultMessage:"Add filter"})}))}function getRemoveFilter(_ref2){var entityName=_ref2.entityName,entityValue=_ref2.entityValue,filter=_ref2.filter;return _react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.entityCell.removeFilterTooltip",defaultMessage:"Remove filter"})},_react.default.createElement(_eui.EuiButtonIcon,{size:"s",className:"filter-button",onClick:function onClick(){return filter(entityName,entityValue,"-")},iconType:"minusInCircle","aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.entityCell.removeFilterAriaLabel",{defaultMessage:"Remove filter"})}))}var EntityCell=function EntityCell(_ref3){var entityName=_ref3.entityName,entityValue=_ref3.entityValue,filter=_ref3.filter,_ref3$wrapText=_ref3.wrapText,wrapText=_ref3$wrapText===void 0?false:_ref3$wrapText;var valueText=entityValue===""?_react.default.createElement("i",null,_entity_control.EMPTY_FIELD_VALUE_LABEL):entityValue;if(entityName===_field_types.MLCATEGORY){valueText="".concat(_field_types.MLCATEGORY," ").concat(valueText)}var textStyle={maxWidth:"100%"};var textWrapperClass=wrapText?"field-value-long":"field-value-short";var shouldDisplayIcons=filter!==undefined&&entityName!==undefined&&entityValue!==undefined;if(wrapText===true){return _react.default.createElement("div",null,_react.default.createElement("span",{className:textWrapperClass},valueText),shouldDisplayIcons&&_react.default.createElement(_react.default.Fragment,null,getAddFilter({entityName:entityName,entityValue:entityValue,filter:filter}),getRemoveFilter({entityName:entityName,entityValue:entityValue,filter:filter})))}else{return _react.default.createElement(_eui.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"none"},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:textStyle},_react.default.createElement(_eui.EuiText,{size:"xs",className:textWrapperClass},valueText)),shouldDisplayIcons&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"none"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},getAddFilter({entityName:entityName,entityValue:entityValue,filter:filter})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},getRemoveFilter({entityName:entityName,entityValue:entityValue,filter:filter})))))}};exports.EntityCell=EntityCell;EntityCell.propTypes={entityName:_propTypes.default.string,entityValue:_propTypes.default.any,filter:_propTypes.default.func,wrapText:_propTypes.default.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.InfluencersCell=void 0;var _lodash=_interopRequireDefault(__webpack_require__(49));var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var InfluencersCell=function(_Component){_inherits(InfluencersCell,_Component);function InfluencersCell(props){var _this;_classCallCheck(this,InfluencersCell);_this=_possibleConstructorReturn(this,_getPrototypeOf(InfluencersCell).call(this,props));_this.state={showAll:false};return _this}_createClass(InfluencersCell,[{key:"toggleAllInfluencers",value:function toggleAllInfluencers(){this.setState({showAll:!this.state.showAll})}},{key:"renderInfluencers",value:function renderInfluencers(influencers){var numberToDisplay=this.state.showAll===false?this.props.limit:influencers.length;var displayInfluencers=influencers.slice(0,numberToDisplay);var influencerFilter=this.props.influencerFilter;var othersCount=Math.max(influencers.length-numberToDisplay,0);if(othersCount===1){displayInfluencers.push(influencers[this.props.limit]);othersCount=0}var displayRows=displayInfluencers.map((function(influencer,index){return _react.default.createElement("div",{key:index},influencer.influencerFieldName,": ",influencer.influencerFieldValue,influencerFilter!==undefined&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.addFilterTooltip",defaultMessage:"Add filter"})},_react.default.createElement(_eui.EuiButtonIcon,{size:"s",className:"filter-button",onClick:function onClick(){return influencerFilter(influencer.influencerFieldName,influencer.influencerFieldValue,"+")},iconType:"plusInCircle","aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.influencersCell.addFilterAriaLabel",{defaultMessage:"Add filter"})})),_react.default.createElement(_eui.EuiToolTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.removeFilterTooltip",defaultMessage:"Remove filter"})},_react.default.createElement(_eui.EuiButtonIcon,{size:"s",className:"filter-button",onClick:function onClick(){return influencerFilter(influencer.influencerFieldName,influencer.influencerFieldValue,"-")},iconType:"minusInCircle","aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.influencersCell.removeFilterAriaLabel",{defaultMessage:"Remove filter"})}))))}));return _react.default.createElement(_react.default.Fragment,null,displayRows,this.renderOthers(influencers.length,othersCount))}},{key:"renderOthers",value:function renderOthers(totalCount,othersCount){var _this2=this;if(othersCount>0){return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return _this2.toggleAllInfluencers()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.moreInfluencersLinkText",defaultMessage:"and {othersCount} more",values:{othersCount:othersCount}})))}else if(totalCount>this.props.limit+1){return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return _this2.toggleAllInfluencers()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.showLessInfluencersLinkText",defaultMessage:"show less"})))}}},{key:"render",value:function render(){var recordInfluencers=this.props.influencers||[];var influencers=[];recordInfluencers.forEach((function(influencer){_lodash.default.each(influencer,(function(influencerFieldValue,influencerFieldName){influencers.push({influencerFieldName:influencerFieldName,influencerFieldValue:influencerFieldValue})}))}));return _react.default.createElement("div",null,this.renderInfluencers(influencers),this.renderOthers(influencers))}}]);return InfluencersCell}(_react.Component);exports.InfluencersCell=InfluencersCell;InfluencersCell.propTypes={influencerFilter:_propTypes.default.func,influencers:_propTypes.default.array,limit:_propTypes.default.number}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LinksMenu=void 0;var _lodash=_interopRequireDefault(__webpack_require__(49));var _moment=_interopRequireDefault(__webpack_require__(32));var _risonNode=_interopRequireDefault(__webpack_require__(100));var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _public=__webpack_require__(31);var _public2=__webpack_require__(63);var _check_privilege=__webpack_require__(56);var _search=__webpack_require__(99);var _anomaly_utils=__webpack_require__(75);var _parse_interval=__webpack_require__(74);var _explorer_utils=__webpack_require__(93);var _mapping_service=__webpack_require__(1653);var _ml_api_service=__webpack_require__(51);var _job_service=__webpack_require__(58);var _custom_url_utils=__webpack_require__(139);var _date_utils=__webpack_require__(83);var _index_utils=__webpack_require__(70);var _string_utils=__webpack_require__(80);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var LinksMenuUI=function(_Component){_inherits(LinksMenuUI,_Component);function LinksMenuUI(props){var _this;_classCallCheck(this,LinksMenuUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(LinksMenuUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"openCustomUrl",(function(customUrl){var _this$props=_this.props,anomaly=_this$props.anomaly,interval=_this$props.interval,isAggregatedData=_this$props.isAggregatedData;console.log("Anomalies Table - open customUrl for record:",anomaly);var record=_lodash.default.cloneDeep(anomaly.source);var timestamp=record.timestamp;var configuredUrlValue=customUrl.url_value;var timeRangeInterval=(0,_parse_interval.parseInterval)(customUrl.time_range);if(configuredUrlValue.includes("$earliest$")){var earliestMoment=(0,_moment.default)(timestamp);if(timeRangeInterval!==null){earliestMoment.subtract(timeRangeInterval)}else{earliestMoment=(0,_moment.default)(timestamp).startOf(interval);if(interval==="hour"){earliestMoment.subtract(1,"h")}}record.earliest=earliestMoment.toISOString()}if(configuredUrlValue.includes("$latest$")){var latestMoment=(0,_moment.default)(timestamp).add(record.bucket_span,"s");if(timeRangeInterval!==null){latestMoment.add(timeRangeInterval)}else{if(isAggregatedData===true){latestMoment=(0,_moment.default)(timestamp).endOf(interval);if(interval==="hour"){latestMoment.add(1,"h")}}}record.latest=latestMoment.toISOString()}if((configuredUrlValue.includes("$mlcategoryterms$")||configuredUrlValue.includes("$mlcategoryregex$"))&&_lodash.default.has(record,"mlcategory")){var jobId=record.job_id;var categoryId=record.mlcategory[0];_ml_api_service.ml.results.getCategoryDefinition(jobId,categoryId).then((function(resp){var termsArray=resp.terms.split(" ").map((function(term){return"+".concat(term)}));record.mlcategoryterms=termsArray.join(" ");record.mlcategoryregex=resp.regex;var urlPath=(0,_string_utils.replaceStringTokens)(customUrl.url_value,record,true);(0,_custom_url_utils.openCustomUrlWindow)(urlPath,customUrl)})).catch((function(resp){console.log("openCustomUrl(): error loading categoryDefinition:",resp);var toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.anomaliesTable.linksMenu.unableToOpenLinkErrorMessage",{defaultMessage:"Unable to open link as an error occurred loading details on category ID {categoryId}",values:{categoryId:categoryId}}))}))}else{var urlPath=(0,_custom_url_utils.getUrlForRecord)(customUrl,record);(0,_custom_url_utils.openCustomUrlWindow)(urlPath,customUrl)}}));_defineProperty(_assertThisInitialized(_this),"viewSeries",(function(){var record=_this.props.anomaly.source;var bounds=_this.props.bounds;var from=bounds.min.toISOString();var to=bounds.max.toISOString();var recordTime=(0,_moment.default)(record.timestamp);var zoomFrom=recordTime.subtract(50*record.bucket_span,"s").toISOString();var zoomTo=recordTime.add(100*record.bucket_span,"s").toISOString();var entityCondition={};if(_lodash.default.has(record,"partition_field_value")){entityCondition[record.partition_field_name]=record.partition_field_value}if(_lodash.default.has(record,"over_field_value")){entityCondition[record.over_field_name]=record.over_field_value}if(_lodash.default.has(record,"by_field_value")){entityCondition[record.by_field_name]=record.by_field_value}var _g=_risonNode.default.encode({ml:{jobIds:[record.job_id]},refreshInterval:{display:"Off",pause:false,value:0},time:{from:from,to:to,mode:"absolute"}});var _a=_risonNode.default.encode({mlTimeSeriesExplorer:{zoom:{from:zoomFrom,to:zoomTo},detectorIndex:record.detector_index,entities:entityCondition},query:{query_string:{analyze_wildcard:true,query:"*"}}});var path="#/timeseriesexplorer";path+="?_g=".concat(_g,"&_a=").concat(encodeURIComponent(_a));window.open(path,"_blank")}));_defineProperty(_assertThisInitialized(_this),"viewExamples",(function(){var categoryId=_this.props.anomaly.entityValue;var record=_this.props.anomaly.source;var job=_job_service.mlJobService.getJob(_this.props.anomaly.jobId);if(job===undefined){console.log("viewExamples(): no job found with ID: ".concat(_this.props.anomaly.jobId));var toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.anomaliesTable.linksMenu.unableToViewExamplesErrorMessage",{defaultMessage:"Unable to view examples as no details could be found for job ID {jobId}",values:{jobId:_this.props.anomaly.jobId}}));return}var categorizationFieldName=job.analysis_config.categorization_field_name;var datafeedIndices=job.datafeed_config.indices;var i=0;findFieldType(datafeedIndices[i]);var error=function error(){console.log("viewExamples(): error finding type of field ".concat(categorizationFieldName," in indices:"),datafeedIndices);var toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.anomaliesTable.linksMenu.noMappingCouldBeFoundErrorMessage",{defaultMessage:"Unable to view examples of documents with mlcategory {categoryId} "+"as no mapping could be found for the categorization field {categorizationFieldName}",values:{categoryId:categoryId,categorizationFieldName:categorizationFieldName}}))};var createAndOpenUrl=function createAndOpenUrl(index,categorizationFieldType){var indexPatternId=(0,_index_utils.getIndexPatternIdFromName)(index)||index;_ml_api_service.ml.results.getCategoryDefinition(record.job_id,categoryId).then((function(resp){var query=null;if(categorizationFieldType===_public2.ES_FIELD_TYPES.KEYWORD){if(resp.regex){query={language:_search.SEARCH_QUERY_LANGUAGE.LUCENE,query:"".concat(categorizationFieldName,":/").concat(resp.regex,"/")}}}else{if(resp.terms){var escapedTerms=(0,_explorer_utils.escapeDoubleQuotes)(resp.terms);query={language:_search.SEARCH_QUERY_LANGUAGE.KUERY,query:"".concat(categorizationFieldName,':"')+escapedTerms.split(" ").join('" and '.concat(categorizationFieldName,':"'))+'"'}}}var recordTime=(0,_moment.default)(record.timestamp);var from=recordTime.toISOString();var to=recordTime.add(record.bucket_span,"s").toISOString();var _g=_risonNode.default.encode({refreshInterval:{display:"Off",pause:false,value:0},time:{from:from,to:to,mode:"absolute"}});var appStateProps={index:indexPatternId,filters:[]};if(query!==null){appStateProps.query=query}var _a=_risonNode.default.encode(appStateProps);var basePath=_this.props.kibana.services.http.basePath;var path=basePath.get();path+="/app/kibana#/discover";path+="?_g="+_g;path+="&_a="+encodeURIComponent(_a);window.open(path,"_blank")})).catch((function(resp){console.log("viewExamples(): error loading categoryDefinition:",resp);var toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.anomaliesTable.linksMenu.loadingDetailsErrorMessage",{defaultMessage:"Unable to view examples as an error occurred loading details on category ID {categoryId}",values:{categoryId:categoryId}}))}))};function findFieldType(index){(0,_mapping_service.getFieldTypeFromMapping)(index,categorizationFieldName).then((function(resp){if(resp!==""){createAndOpenUrl(index,resp)}else{i++;if(i<datafeedIndices.length){findFieldType(datafeedIndices[i])}else{error()}}})).catch((function(){error()}))}}));_defineProperty(_assertThisInitialized(_this),"onButtonClick",(function(){_this.setState((function(prevState){return{isPopoverOpen:!prevState.isPopoverOpen}}))}));_defineProperty(_assertThisInitialized(_this),"closePopover",(function(){_this.setState({isPopoverOpen:false})}));_this.state={isPopoverOpen:false,toasts:[]};return _this}_createClass(LinksMenuUI,[{key:"render",value:function render(){var _this2=this;var _this$props2=this.props,anomaly=_this$props2.anomaly,showViewSeriesLink=_this$props2.showViewSeriesLink;var canConfigureRules=(0,_anomaly_utils.isRuleSupported)(anomaly.source)&&(0,_check_privilege.checkPermission)("canUpdateJob");var button=_react.default.createElement(_eui.EuiButtonIcon,{size:"s",color:"text",onClick:this.onButtonClick,iconType:"gear","aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.linksMenu.selectActionAriaLabel",{defaultMessage:"Select action for anomaly at {time}",values:{time:(0,_date_utils.formatHumanReadableDateTimeSeconds)(anomaly.time)}})});var items=[];if(anomaly.customUrls!==undefined){anomaly.customUrls.forEach((function(customUrl,index){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"custom_url_".concat(index),icon:"popout",onClick:function onClick(){_this2.closePopover();_this2.openCustomUrl(customUrl)}},customUrl.url_name))}))}if(showViewSeriesLink===true&&anomaly.isTimeSeriesViewRecord===true){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"view_series",icon:"stats",onClick:function onClick(){_this2.closePopover();_this2.viewSeries()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewSeriesLabel",defaultMessage:"View series"})))}if(anomaly.entityName==="mlcategory"){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"view_examples",icon:"popout",onClick:function onClick(){_this2.closePopover();_this2.viewExamples()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewExamplesLabel",defaultMessage:"View examples"})))}if(canConfigureRules){items.push(_react.default.createElement(_eui.EuiContextMenuItem,{key:"create_rule",icon:"controlsHorizontal",onClick:function onClick(){_this2.closePopover();_this2.props.showRuleEditorFlyout(anomaly)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.configureRulesLabel",defaultMessage:"Configure rules"})))}return _react.default.createElement(_eui.EuiPopover,{button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft"},_react.default.createElement(_eui.EuiContextMenuPanel,{items:items}))}}]);return LinksMenuUI}(_react.Component);_defineProperty(LinksMenuUI,"propTypes",{anomaly:_propTypes.default.object.isRequired,bounds:_propTypes.default.object.isRequired,showViewSeriesLink:_propTypes.default.bool,isAggregatedData:_propTypes.default.bool,interval:_propTypes.default.string,showRuleEditorFlyout:_propTypes.default.func});var LinksMenu=(0,_public.withKibana)(LinksMenuUI);exports.LinksMenu=LinksMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getFieldTypeFromMapping=getFieldTypeFromMapping;var _lodash=_interopRequireDefault(__webpack_require__(49));var _ml_api_service=__webpack_require__(51);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getFieldTypeFromMapping(index,fieldName){return new Promise((function(resolve,reject){if(index!==""){_ml_api_service.ml.getFieldCaps({index:index,fields:[fieldName]}).then((function(resp){var fieldType="";_lodash.default.each(resp.fields,(function(field){_lodash.default.each(field,(function(type){if(fieldType===""){fieldType=type.type}}))}));resolve(fieldType)})).catch((function(error){reject(error)}))}else{reject()}}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"SeverityCell",{enumerable:true,get:function get(){return _severity_cell.SeverityCell}});var _severity_cell=__webpack_require__(1655)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SeverityCell=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _multi_bucket_impact=__webpack_require__(188);var _anomaly_utils=__webpack_require__(75);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var SeverityCell=(0,_react.memo)((function(_ref){var score=_ref.score,multiBucketImpact=_ref.multiBucketImpact;var severity=score>=1?Math.floor(score):"< 1";var color=(0,_anomaly_utils.getSeverityColor)(score);var isMultiBucket=multiBucketImpact>=_multi_bucket_impact.MULTI_BUCKET_IMPACT.MEDIUM;return isMultiBucket?_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("svg",{width:"16",height:"16",viewBox:"-2 -2 20 20",fill:color},_react.default.createElement("path",{d:"M-6.708203932499369,-2.23606797749979H-2.23606797749979V-6.708203932499369H2.23606797749979V-2.23606797749979H6.708203932499369V2.23606797749979H2.23606797749979V6.708203932499369H-2.23606797749979V2.23606797749979H-6.708203932499369Z",transform:"translate(8,8)"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},severity)):_react.default.createElement(_eui.EuiHealth,{color:color},severity)}));exports.SeverityCell=SeverityCell},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnomalyDetails=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _lodash=_interopRequireDefault(__webpack_require__(49));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);var _date_utils=__webpack_require__(83);var _entity_cell=__webpack_require__(268);var _anomaly_utils=__webpack_require__(75);var _multi_bucket_impact=__webpack_require__(188);var _format_value=__webpack_require__(133);var _anomalies_table_constants=__webpack_require__(270);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var TIME_FIELD_NAME="timestamp";function getFilterEntity(entityName,entityValue,filter){return _react.default.createElement(_entity_cell.EntityCell,{entityName:entityName,entityValue:entityValue,filter:filter})}function getDetailsItems(anomaly,examples,filter){var source=anomaly.source;var causes=[];var sourceCauses=source.causes||[];var singleCauseByFieldName=undefined;var singleCauseByFieldValue=undefined;if(sourceCauses.length===1){if(sourceCauses[0].by_field_name!==undefined){singleCauseByFieldName=sourceCauses[0].by_field_name;singleCauseByFieldValue=sourceCauses[0].by_field_value}}else{causes=sourceCauses.map((function(cause){var simplified=_lodash.default.pick(cause,"typical","actual","probability");simplified.entityName=_lodash.default.has(cause,"by_field_name")?cause.by_field_name:cause.over_field_name;simplified.entityValue=_lodash.default.has(cause,"by_field_value")?cause.by_field_value:cause.over_field_value;return simplified}))}var items=[];if(source.partition_field_value!==undefined){items.push({title:source.partition_field_name,description:getFilterEntity(source.partition_field_name,source.partition_field_value,filter)})}if(source.by_field_value!==undefined){items.push({title:source.by_field_name,description:getFilterEntity(source.by_field_name,source.by_field_value,filter)})}if(singleCauseByFieldName!==undefined){items.push({title:singleCauseByFieldName,description:getFilterEntity(singleCauseByFieldName,singleCauseByFieldValue,filter)})}if(source.over_field_value!==undefined){items.push({title:source.over_field_name,description:getFilterEntity(source.over_field_name,source.over_field_value,filter)})}var anomalyTime=source[TIME_FIELD_NAME];var timeDesc="".concat((0,_date_utils.formatHumanReadableDateTimeSeconds)(anomalyTime));if(source.bucket_span!==undefined){var anomalyEndTime=anomalyTime+source.bucket_span*1e3;timeDesc=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.anomalyTimeRangeLabel",{defaultMessage:"{anomalyTime} to {anomalyEndTime}",values:{anomalyTime:(0,_date_utils.formatHumanReadableDateTimeSeconds)(anomalyTime),anomalyEndTime:(0,_date_utils.formatHumanReadableDateTimeSeconds)(anomalyEndTime)}})}items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.timeTitle",{defaultMessage:"time"}),description:timeDesc});items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.functionTitle",{defaultMessage:"function"}),description:source.function!=="metric"?source.function:source.function_description});if(source.field_name!==undefined){items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.fieldNameTitle",{defaultMessage:"fieldName"}),description:source.field_name})}var functionDescription=source.function_description||"";if(anomaly.actual!==undefined&&(0,_anomaly_utils.showActualForFunction)(functionDescription)===true){items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.actualTitle",{defaultMessage:"actual"}),description:(0,_format_value.formatValue)(anomaly.actual,source.function,undefined,source)})}if(anomaly.typical!==undefined&&(0,_anomaly_utils.showTypicalForFunction)(functionDescription)===true){items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.typicalTitle",{defaultMessage:"typical"}),description:(0,_format_value.formatValue)(anomaly.typical,source.function,undefined,source)})}items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.jobIdTitle",{defaultMessage:"job ID"}),description:anomaly.jobId});if(source.multi_bucket_impact!==undefined&&source.multi_bucket_impact>=_multi_bucket_impact.MULTI_BUCKET_IMPACT.LOW){items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.multiBucketImpactTitle",{defaultMessage:"multi-bucket impact"}),description:(0,_anomaly_utils.getMultiBucketImpactLabel)(source.multi_bucket_impact)})}items.push({title:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.probabilityTitle",{defaultMessage:"probability"}),description:source.probability});if(causes.length>1){causes.forEach((function(cause,index){var title=index===0?_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.causeValuesTitle",{defaultMessage:"{causeEntityName} values",values:{causeEntityName:cause.entityName}}):"";var description=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.causeValuesDescription",{defaultMessage:"{causeEntityValue} (actual {actualValue}, "+"typical {typicalValue}, probability {probabilityValue})",values:{causeEntityValue:cause.entityValue,actualValue:(0,_format_value.formatValue)(cause.actual,source.function),typicalValue:(0,_format_value.formatValue)(cause.typical,source.function),probabilityValue:cause.probability}});items.push({title:title,description:description})}))}return items}function getInfluencersItems(anomalyInfluencers,influencerFilter,numToDisplay){var items=[];var _loop=function _loop(i){Object.keys(anomalyInfluencers[i]).forEach((function(influencerFieldName){var value=anomalyInfluencers[i][influencerFieldName];items.push({title:influencerFieldName,description:getFilterEntity(influencerFieldName,value,influencerFilter)})}))};for(var i=0;i<numToDisplay;i++){_loop(i)}return items}var AnomalyDetails=function(_Component){_inherits(AnomalyDetails,_Component);function AnomalyDetails(props){var _this;_classCallCheck(this,AnomalyDetails);_this=_possibleConstructorReturn(this,_getPrototypeOf(AnomalyDetails).call(this,props));_this.state={showAllInfluencers:false};if(_this.props.examples!==undefined&&_this.props.examples.length>0){_this.tabs=[{id:"Details",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.detailsTitle",{defaultMessage:"Details"}),content:_react.default.createElement(_react.Fragment,null,_react.default.createElement("div",{className:"ml-anomalies-table-details"},_this.renderDescription(),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_this.renderDetails(),_this.renderInfluencers()))},{id:"Category examples",name:_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.categoryExamplesTitle",{defaultMessage:"Category examples"}),content:_react.default.createElement(_react.Fragment,null,_this.renderCategoryExamples())}]}return _this}_createClass(AnomalyDetails,[{key:"toggleAllInfluencers",value:function toggleAllInfluencers(){this.setState({showAllInfluencers:!this.state.showAllInfluencers})}},{key:"renderCategoryExamples",value:function renderCategoryExamples(){var _this$props=this.props,examples=_this$props.examples,definition=_this$props.definition;return _react.default.createElement(_eui.EuiFlexGroup,{direction:"column",justifyContent:"center",gutterSize:"m",className:"mlAnomalyCategoryExamples"},definition!==undefined&&definition.terms&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,{key:"example-terms"},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h4",{className:"mlAnomalyCategoryExamples__header"},_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.termsTitle",{defaultMessage:"Terms"}))," ",_react.default.createElement(_eui.EuiIconTip,{"aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.termsDescriptionAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",size:"s",content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.termsDescriptionTooltip",defaultMessage:"A space separated list of the common tokens that are matched in values of the category (may have been truncated to a max character limit of {maxChars})",values:{maxChars:_anomalies_table_constants.MAX_CHARS}})})),_react.default.createElement(_eui.EuiText,{size:"xs"},definition.terms)),_react.default.createElement(_eui.EuiSpacer,{size:"xs"})),definition!==undefined&&definition.regex&&_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexItem,{key:"example-regex"},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h4",{className:"mlAnomalyCategoryExamples__header"},_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.regexTitle",{defaultMessage:"Regex"}))," ",_react.default.createElement(_eui.EuiIconTip,{"aria-label":_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.regexDescriptionAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",size:"s",content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.regexDescriptionTooltip",defaultMessage:"The regular expression that is used to search for values that match the category (may have been truncated to a max character limit of {maxChars})",values:{maxChars:_anomalies_table_constants.MAX_CHARS}})})),_react.default.createElement(_eui.EuiText,{size:"xs"},definition.regex)),_react.default.createElement(_eui.EuiSpacer,{size:"xs"})),examples.map((function(example,i){return _react.default.createElement(_eui.EuiFlexItem,{key:"example".concat(i)},i===0&&definition!==undefined&&_react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement("h4",null,_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.examplesTitle",{defaultMessage:"Examples"}))),_react.default.createElement("span",{className:"mlAnomalyCategoryExamples__item"},example))})))}},{key:"renderDescription",value:function renderDescription(){var anomaly=this.props.anomaly;var source=anomaly.source;var anomalyDescription=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.anomalyInLabel",{defaultMessage:"{anomalySeverity} anomaly in {anomalyDetector}",values:{anomalySeverity:(0,_anomaly_utils.getSeverity)(anomaly.severity).label,anomalyDetector:anomaly.detector}});if(anomaly.entityName!==undefined){anomalyDescription+=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.foundForLabel",{defaultMessage:" found for {anomalyEntityName} {anomalyEntityValue}",values:{anomalyEntityName:anomaly.entityName,anomalyEntityValue:anomaly.entityValue}})}if(source.partition_field_name!==undefined&&source.partition_field_name!==anomaly.entityName){anomalyDescription+=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.detectedInLabel",{defaultMessage:" detected in {sourcePartitionFieldName} {sourcePartitionFieldValue}",values:{sourcePartitionFieldName:source.partition_field_name,sourcePartitionFieldValue:source.partition_field_value}})}var mvDescription=undefined;if(source.correlated_by_field_value!==undefined){mvDescription=_i18n.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.multivariateDescription",{defaultMessage:"multivariate correlations found in {sourceByFieldName}; "+"{sourceByFieldValue} is considered anomalous given {sourceCorrelatedByFieldValue}",values:{sourceByFieldName:source.by_field_name,sourceByFieldValue:source.by_field_value,sourceCorrelatedByFieldValue:source.correlated_by_field_value}})}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.descriptionTitle",defaultMessage:"Description"})),anomalyDescription),mvDescription!==undefined&&_react.default.createElement(_eui.EuiText,{size:"xs"},mvDescription))}},{key:"renderDetails",value:function renderDetails(){var detailItems=getDetailsItems(this.props.anomaly,this.props.examples,this.props.filter);var isInterimResult=_lodash.default.get(this.props.anomaly,"source.is_interim",false);return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiText,{size:"xs"},this.props.isAggregatedData===true?_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.detailsOnHighestSeverityAnomalyTitle",defaultMessage:"Details on highest severity anomaly"})):_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDetailsTitle",defaultMessage:"Anomaly details"})),isInterimResult===true&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiIcon,{type:"alert"}),_react.default.createElement("span",{className:"interim-result"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.interimResultLabel",defaultMessage:"Interim result"})))),_react.default.createElement(_eui.EuiDescriptionList,{type:"column",listItems:detailItems,className:"anomaly-description-list"}))}},{key:"renderInfluencers",value:function renderInfluencers(){var _this2=this;var anomalyInfluencers=this.props.anomaly.influencers;var listItems=[];var othersCount=0;var numToDisplay=0;if(anomalyInfluencers!==undefined){numToDisplay=this.state.showAllInfluencers===true?anomalyInfluencers.length:Math.min(this.props.influencersLimit,anomalyInfluencers.length);othersCount=Math.max(anomalyInfluencers.length-numToDisplay,0);if(othersCount===1){numToDisplay++;othersCount=0}listItems=getInfluencersItems(anomalyInfluencers,this.props.influencerFilter,numToDisplay)}if(listItems.length>0){return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h4",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.influencersTitle",defaultMessage:"Influencers"}))),_react.default.createElement(_eui.EuiDescriptionList,{type:"column",listItems:listItems,className:"anomaly-description-list"}),othersCount>0&&_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return _this2.toggleAllInfluencers()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDescriptionListMoreLinkText",defaultMessage:"and {othersCount} more",values:{othersCount:othersCount}})),numToDisplay>this.props.influencersLimit+1&&_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return _this2.toggleAllInfluencers()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDescriptionShowLessLinkText",defaultMessage:"show less"})))}}},{key:"render",value:function render(){var tabIndex=this.props.tabIndex;if(this.tabs!==undefined){return _react.default.createElement(_eui.EuiTabbedContent,{tabs:this.tabs,size:"s",initialSelectedTab:this.tabs[tabIndex],onTabClick:function onTabClick(){}})}else{return _react.default.createElement("div",{className:"ml-anomalies-table-details"},this.renderDescription(),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),this.renderDetails(),this.renderInfluencers())}}}]);return AnomalyDetails}(_react.Component);exports.AnomalyDetails=AnomalyDetails;_defineProperty(AnomalyDetails,"propTypes",{anomaly:_propTypes.default.object.isRequired,examples:_propTypes.default.array,definition:_propTypes.default.object,isAggregatedData:_propTypes.default.bool,filter:_propTypes.default.func,influencersLimit:_propTypes.default.number,influencerFilter:_propTypes.default.func,tabIndex:_propTypes.default.number.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"RuleEditorFlyout",{enumerable:true,get:function get(){return _rule_editor_flyout.RuleEditorFlyout}});var _rule_editor_flyout=__webpack_require__(1658)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RuleEditorFlyout=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _detector_description_list=__webpack_require__(516);var _actions_section=__webpack_require__(1660);var _check_privilege=__webpack_require__(56);var _conditions_section=__webpack_require__(1661);var _scope_section=__webpack_require__(1663);var _select_rule_action=__webpack_require__(1665);var _utils=__webpack_require__(143);var _detector_rule=__webpack_require__(128);var _job_utils=__webpack_require__(59);var _public=__webpack_require__(31);var _job_service=__webpack_require__(58);var _ml_api_service=__webpack_require__(51);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var RuleEditorFlyoutUI=function(_Component){_inherits(RuleEditorFlyoutUI,_Component);function RuleEditorFlyoutUI(props){var _this;_classCallCheck(this,RuleEditorFlyoutUI);_this=_possibleConstructorReturn(this,_getPrototypeOf(RuleEditorFlyoutUI).call(this,props));_defineProperty(_assertThisInitialized(_this),"showFlyout",(function(anomaly){var ruleIndex=-1;var job=_job_service.mlJobService.getJob(anomaly.jobId);if(job===undefined){var toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.unableToConfigureRulesNotificationMesssage",{defaultMessage:"Unable to configure rules as an error occurred obtaining details for job ID {jobId}",values:{jobId:anomaly.jobId}}));_this.setState({job:job,isFlyoutVisible:false});return}_this.partitioningFieldNames=(0,_job_utils.getPartitioningFieldNames)(job,anomaly.detectorIndex);var detectorIndex=anomaly.detectorIndex;var detector=job.analysis_config.detectors[detectorIndex];if(detector.custom_rules===undefined){ruleIndex=0}var isConditionsEnabled=false;if(ruleIndex===0){isConditionsEnabled=_this.partitioningFieldNames.length===0}_this.setState({anomaly:anomaly,job:job,ruleIndex:ruleIndex,isConditionsEnabled:isConditionsEnabled,isScopeEnabled:false,isFlyoutVisible:true});if(_this.partitioningFieldNames.length>0&&_this.canGetFilters){_ml_api_service.ml.filters.filters().then((function(filters){var filterListIds=filters.map((function(filter){return filter.filter_id}));_this.setState({filterListIds:filterListIds})})).catch((function(resp){console.log("Error loading list of filters:",resp);var toasts=_this.props.kibana.services.notifications.toasts;toasts.addDanger(_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithLoadingFilterListsNotificationMesssage",{defaultMessage:"Error loading the filter lists used in the rule scope"}))}))}}));_defineProperty(_assertThisInitialized(_this),"closeFlyout",(function(){_this.setState({isFlyoutVisible:false})}));_defineProperty(_assertThisInitialized(_this),"setEditRuleIndex",(function(ruleIndex){var detectorIndex=_this.state.anomaly.detectorIndex;var detector=_this.state.job.analysis_config.detectors[detectorIndex];var rules=detector.custom_rules;var rule=rules===undefined||ruleIndex>=rules.length?(0,_utils.getNewRuleDefaults)():rules[ruleIndex];var isConditionsEnabled=_this.partitioningFieldNames.length===0||rule.conditions!==undefined&&rule.conditions.length>0;var isScopeEnabled=rule.scope!==undefined&&Object.keys(rule.scope).length>0;if(isScopeEnabled===true){Object.keys(rule.scope).forEach((function(field){rule.scope[field].enabled=true}))}_this.setState({ruleIndex:ruleIndex,rule:rule,isConditionsEnabled:isConditionsEnabled,isScopeEnabled:isScopeEnabled})}));_defineProperty(_assertThisInitialized(_this),"onSkipResultChange",(function(e){var checked=e.target.checked;_this.setState((function(prevState){var actions=_toConsumableArray(prevState.rule.actions);var idx=actions.indexOf(_detector_rule.ACTION.SKIP_RESULT);if(idx===-1&&checked){actions.push(_detector_rule.ACTION.SKIP_RESULT)}else if(idx>-1&&!checked){actions.splice(idx,1)}return{rule:_objectSpread({},prevState.rule,{actions:actions})}}))}));_defineProperty(_assertThisInitialized(_this),"onSkipModelUpdateChange",(function(e){var checked=e.target.checked;_this.setState((function(prevState){var actions=_toConsumableArray(prevState.rule.actions);var idx=actions.indexOf(_detector_rule.ACTION.SKIP_MODEL_UPDATE);if(idx===-1&&checked){actions.push(_detector_rule.ACTION.SKIP_MODEL_UPDATE)}else if(idx>-1&&!checked){actions.splice(idx,1)}return{rule:_objectSpread({},prevState.rule,{actions:actions})}}))}));_defineProperty(_assertThisInitialized(_this),"onConditionsEnabledChange",(function(e){var isConditionsEnabled=e.target.checked;_this.setState((function(prevState){var conditions;if(isConditionsEnabled===false){conditions=[]}else{conditions=[(0,_utils.getNewConditionDefaults)()]}return{rule:_objectSpread({},prevState.rule,{conditions:conditions}),isConditionsEnabled:isConditionsEnabled}}))}));_defineProperty(_assertThisInitialized(_this),"addCondition",(function(){_this.setState((function(prevState){var conditions=_toConsumableArray(prevState.rule.conditions);conditions.push((0,_utils.getNewConditionDefaults)());return{rule:_objectSpread({},prevState.rule,{conditions:conditions})}}))}));_defineProperty(_assertThisInitialized(_this),"updateCondition",(function(index,appliesTo,operator,value){_this.setState((function(prevState){var conditions=_toConsumableArray(prevState.rule.conditions);if(index<conditions.length){conditions[index]={applies_to:appliesTo,operator:operator,value:value}}return{rule:_objectSpread({},prevState.rule,{conditions:conditions})}}))}));_defineProperty(_assertThisInitialized(_this),"deleteCondition",(function(index){_this.setState((function(prevState){var conditions=_toConsumableArray(prevState.rule.conditions);if(index<conditions.length){conditions.splice(index,1)}return{rule:_objectSpread({},prevState.rule,{conditions:conditions})}}))}));_defineProperty(_assertThisInitialized(_this),"onScopeEnabledChange",(function(e){var isScopeEnabled=e.target.checked;_this.setState((function(prevState){var rule=_objectSpread({},prevState.rule);if(isScopeEnabled===false){delete rule.scope}return{rule:rule,isScopeEnabled:isScopeEnabled}}))}));_defineProperty(_assertThisInitialized(_this),"updateScope",(function(fieldName,filterId,filterType,enabled){_this.setState((function(prevState){var scope=_objectSpread({},prevState.rule.scope);if(scope===undefined){scope={}}scope[fieldName]={filter_id:filterId,filter_type:filterType,enabled:enabled};return{rule:_objectSpread({},prevState.rule,{scope:scope})}}))}));_defineProperty(_assertThisInitialized(_this),"saveEdit",(function(){var _this$state=_this.state,rule=_this$state.rule,ruleIndex=_this$state.ruleIndex;_this.updateRuleAtIndex(ruleIndex,rule)}));_defineProperty(_assertThisInitialized(_this),"updateRuleAtIndex",(function(ruleIndex,editedRule){var toasts=_this.props.kibana.services.notifications.toasts;var _this$state2=_this.state,job=_this$state2.job,anomaly=_this$state2.anomaly;var jobId=job.job_id;var detectorIndex=anomaly.detectorIndex;(0,_utils.saveJobRule)(job,detectorIndex,ruleIndex,editedRule).then((function(resp){if(resp.success){toasts.add({title:_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.changesToJobDetectorRulesSavedNotificationMessageTitle",{defaultMessage:"Changes to {jobId} detector rules saved",values:{jobId:jobId}}),color:"success",iconType:"check",text:_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.changesToJobDetectorRulesSavedNotificationMessageDescription",{defaultMessage:"Note that changes will take effect for new results only."})});_this.closeFlyout()}else{toasts.addDanger(_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithSavingChangesToJobDetectorRulesNotificationMessage",{defaultMessage:"Error saving changes to {jobId} detector rules",values:{jobId:jobId}}))}})).catch((function(error){console.error(error);toasts.addDanger(_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithSavingChangesToJobDetectorRulesNotificationMessage",{defaultMessage:"Error saving changes to {jobId} detector rules",values:{jobId:jobId}}))}))}));_defineProperty(_assertThisInitialized(_this),"deleteRuleAtIndex",(function(index){var toasts=_this.props.kibana.services.notifications.toasts;var _this$state3=_this.state,job=_this$state3.job,anomaly=_this$state3.anomaly;var jobId=job.job_id;var detectorIndex=anomaly.detectorIndex;(0,_utils.deleteJobRule)(job,detectorIndex,index).then((function(resp){if(resp.success){toasts.addSuccess(_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.ruleDeletedFromJobDetectorNotificationMessage",{defaultMessage:"Rule deleted from {jobId} detector",values:{jobId:jobId}}));_this.closeFlyout()}else{toasts.addDanger(_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithDeletingRuleFromJobDetectorNotificationMessage",{defaultMessage:"Error deleting rule from {jobId} detector",values:{jobId:jobId}}))}})).catch((function(error){console.error(error);var errorMessage=_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithDeletingRuleFromJobDetectorNotificationMessage",{defaultMessage:"Error deleting rule from {jobId} detector",values:{jobId:jobId}});if(error.message){errorMessage+=" : ".concat(error.message)}toasts.addDanger(errorMessage)}))}));_defineProperty(_assertThisInitialized(_this),"addItemToFilterList",(function(item,filterId,closeFlyoutOnAdd){var toasts=_this.props.kibana.services.notifications.toasts;(0,_utils.addItemToFilter)(item,filterId).then((function(){if(closeFlyoutOnAdd===true){toasts.add({title:_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.addedItemToFilterListNotificationMessageTitle",{defaultMessage:"Added {item} to {filterId}",values:{item:item,filterId:filterId}}),color:"success",iconType:"check",text:_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.addedItemToFilterListNotificationMessageDescription",{defaultMessage:"Note that changes will take effect for new results only."})});_this.closeFlyout()}})).catch((function(error){console.log("Error adding ".concat(item," to filter ").concat(filterId,":"),error);toasts.addDanger(_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithAddingItemToFilterListNotificationMessage",{defaultMessage:"An error occurred adding {item} to filter {filterId}",values:{item:item,filterId:filterId}}))}))}));_this.state={anomaly:{},job:{},ruleIndex:-1,rule:(0,_utils.getNewRuleDefaults)(),skipModelUpdate:false,isConditionsEnabled:false,isScopeEnabled:false,filterListIds:[],isFlyoutVisible:false};_this.partitioningFieldNames=[];_this.canGetFilters=(0,_check_privilege.checkPermission)("canGetFilters");return _this}_createClass(RuleEditorFlyoutUI,[{key:"componentDidMount",value:function componentDidMount(){if(typeof this.props.setShowFunction==="function"){this.props.setShowFunction(this.showFlyout)}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(typeof this.props.unsetShowFunction==="function"){this.props.unsetShowFunction()}}},{key:"render",value:function render(){var _this$props$kibana$se=this.props.kibana.services.docLinks,ELASTIC_WEBSITE_URL=_this$props$kibana$se.ELASTIC_WEBSITE_URL,DOC_LINK_VERSION=_this$props$kibana$se.DOC_LINK_VERSION;var docsUrl="".concat(ELASTIC_WEBSITE_URL,"guide/en/machine-learning/").concat(DOC_LINK_VERSION,"/ml-rules.html");var _this$state4=this.state,isFlyoutVisible=_this$state4.isFlyoutVisible,job=_this$state4.job,anomaly=_this$state4.anomaly,ruleIndex=_this$state4.ruleIndex,rule=_this$state4.rule,filterListIds=_this$state4.filterListIds,isConditionsEnabled=_this$state4.isConditionsEnabled,isScopeEnabled=_this$state4.isScopeEnabled;if(isFlyoutVisible===false){return null}var flyout;if(ruleIndex===-1){flyout=_react.default.createElement(_eui.EuiFlyout,{className:"ml-rule-editor-flyout",onClose:this.closeFlyout,"aria-labelledby":"flyoutTitle"},_react.default.createElement(_eui.EuiFlyoutHeader,{hasBorder:true},_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h1",{id:"flyoutTitle"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.editRulesTitle",defaultMessage:"Edit rules"})))),_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(_select_rule_action.SelectRuleAction,{job:job,anomaly:anomaly,setEditRuleIndex:this.setEditRuleIndex,updateRuleAtIndex:this.updateRuleAtIndex,deleteRuleAtIndex:this.deleteRuleAtIndex,addItemToFilterList:this.addItemToFilterList})),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.closeButtonLabel",defaultMessage:"Close"}))))))}else{var detectorIndex=anomaly.detectorIndex;var detector=job.analysis_config.detectors[detectorIndex];var rules=detector.custom_rules;var isCreate=rules===undefined||ruleIndex>=rules.length;var hasPartitioningFields=this.partitioningFieldNames&&this.partitioningFieldNames.length>0;var conditionSupported=_detector_rule.CONDITIONS_NOT_SUPPORTED_FUNCTIONS.indexOf(anomaly.source.function)===-1;var conditionsText=_i18n.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.conditionsDescription",{defaultMessage:"Add numeric conditions for when the rule applies. Multiple conditions are combined using AND."});flyout=_react.default.createElement(_eui.EuiFlyout,{className:"ml-rule-editor-flyout",onClose:this.closeFlyout,"aria-labelledby":"flyoutTitle"},_react.default.createElement(_eui.EuiFlyoutHeader,{hasBorder:true},_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h1",{id:"flyoutTitle"},isCreate===true?_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.createRuleTitle",defaultMessage:"Create rule"}):_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.editRuleTitle",defaultMessage:"Edit rule"})))),_react.default.createElement(_eui.EuiFlyoutBody,null,_react.default.createElement(_detector_description_list.DetectorDescriptionList,{job:job,detector:detector,anomaly:anomaly}),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rulesDescription",defaultMessage:"Rules instruct anomaly detectors to change their behavior based on domain-specific knowledge that you provide. When you create a rule, you can specify conditions, scope, and actions. When the conditions of a rule are satisfied, its actions are triggered. {learnMoreLink}",values:{learnMoreLink:_react.default.createElement(_eui.EuiLink,{href:docsUrl,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rulesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}}))),_react.default.createElement(_eui.EuiSpacer,null),_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.actionTitle",defaultMessage:"Action"}))),_react.default.createElement(_actions_section.ActionsSection,{actions:rule.actions,onSkipResultChange:this.onSkipResultChange,onSkipModelUpdateChange:this.onSkipModelUpdateChange}),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsTitle",defaultMessage:"Conditions"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),conditionSupported===true?_react.default.createElement(_eui.EuiCheckbox,{id:"enable_conditions_checkbox",className:"scope-enable-checkbox",label:conditionsText,checked:isConditionsEnabled,onChange:this.onConditionsEnabledChange,disabled:!conditionSupported||!hasPartitioningFields}):_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsNotSupportedTitle",defaultMessage:"Conditions are not supported for detectors using the {functionName} function",values:{functionName:anomaly.source.function}}),iconType:"iInCircle"}),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_conditions_section.ConditionsSection,{isEnabled:isConditionsEnabled,conditions:rule.conditions,addCondition:this.addCondition,updateCondition:this.updateCondition,deleteCondition:this.deleteCondition}),_react.default.createElement(_eui.EuiSpacer,{size:"xl"}),_react.default.createElement(_scope_section.ScopeSection,{isEnabled:isScopeEnabled,onEnabledChange:this.onScopeEnabledChange,partitioningFieldNames:this.partitioningFieldNames,filterListIds:filterListIds,scope:rule.scope,updateScope:this.updateScope}),_react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rerunJobTitle",defaultMessage:"Rerun job"}),color:"warning",iconType:"help"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.whenChangesTakeEffectDescription",defaultMessage:"Changes to rules take effect for new results only."})),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.howToApplyChangesToExistingResultsDescription",defaultMessage:"To apply these changes to existing results you must clone and rerun the job. Note rerunning the job may take some time and should only be done once you have completed all your changes to the rules for this job."})))),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.closeButtonLabel",defaultMessage:"Close"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:this.saveEdit,isDisabled:!(0,_utils.isValidRule)(rule),fill:true},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.saveButtonLabel",defaultMessage:"Save"}))))))}return _react.default.createElement(_react.default.Fragment,null,flyout)}}]);return RuleEditorFlyoutUI}(_react.Component);_defineProperty(RuleEditorFlyoutUI,"propTypes",{setShowFunction:_propTypes.default.func.isRequired,unsetShowFunction:_propTypes.default.func.isRequired});var RuleEditorFlyout=(0,_public.withKibana)(RuleEditorFlyoutUI);exports.RuleEditorFlyout=RuleEditorFlyout},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DetectorDescriptionList=DetectorDescriptionList;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _format_value=__webpack_require__(133);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function DetectorDescriptionList(_ref){var job=_ref.job,detector=_ref.detector,anomaly=_ref.anomaly;var listItems=[{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.jobIdTitle",defaultMessage:"Job ID"}),description:job.job_id},{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.detectorTitle",defaultMessage:"Detector"}),description:detector.detector_description}];if(anomaly.actual!==undefined){var actual=(0,_format_value.formatValue)(anomaly.actual,anomaly.source.function);var typical=(0,_format_value.formatValue)(anomaly.typical,anomaly.source.function);listItems.push({title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.selectedAnomalyTitle",defaultMessage:"Selected anomaly"}),description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.selectedAnomalyDescription",defaultMessage:"actual {actual}, typical {typical}",values:{actual:actual,typical:typical}})})}return _react.default.createElement(_eui.EuiDescriptionList,{className:"rule-detector-description-list",type:"column",listItems:listItems})}DetectorDescriptionList.propTypes={job:_propTypes.default.object.isRequired,detector:_propTypes.default.object.isRequired,anomaly:_propTypes.default.object.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionsSection=ActionsSection;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _detector_rule=__webpack_require__(128);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ActionsSection(_ref){var actions=_ref.actions,onSkipResultChange=_ref.onSkipResultChange,onSkipModelUpdateChange=_ref.onSkipModelUpdateChange;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiText,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.chooseActionsDescription",defaultMessage:"Choose the action(s) to take when the rule matches an anomaly."}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCheckbox,{id:"skip_result_cb",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.skipResultLabel",defaultMessage:"Skip result (recommended)"}),checked:actions.indexOf(_detector_rule.ACTION.SKIP_RESULT)>-1,onChange:onSkipResultChange})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIconTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.resultWillNotBeCreatedTooltip",defaultMessage:"The result will not be created."}),size:"s",position:"right"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiCheckbox,{id:"skip_model_update_cb",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.skipModelUpdateLabel",defaultMessage:"Skip model update"}),checked:actions.indexOf(_detector_rule.ACTION.SKIP_MODEL_UPDATE)>-1,onChange:onSkipModelUpdateChange})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiIconTip,{content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.valueWillNotBeUsedToUpdateModelTooltip",defaultMessage:"The value for that series will not be used to update the model."}),size:"s",position:"right"}))))}ActionsSection.propTypes={actions:_propTypes.default.array.isRequired,onSkipResultChange:_propTypes.default.func.isRequired,onSkipModelUpdateChange:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ConditionsSection=ConditionsSection;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _condition_expression=__webpack_require__(1662);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ConditionsSection(_ref){var isEnabled=_ref.isEnabled,conditions=_ref.conditions,addCondition=_ref.addCondition,updateCondition=_ref.updateCondition,deleteCondition=_ref.deleteCondition;if(isEnabled===false){return null}var expressions=[];if(conditions!==undefined){expressions=conditions.map((function(condition,index){return _react.default.createElement(_condition_expression.ConditionExpression,{key:index,index:index,appliesTo:condition.applies_to,operator:condition.operator,value:condition.value,updateCondition:updateCondition,deleteCondition:deleteCondition})}))}return _react.default.createElement(_react.default.Fragment,null,expressions,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiButtonEmpty,{onClick:function onClick(){return addCondition()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionsSection.addNewConditionButtonLabel",defaultMessage:"Add new condition"})))}ConditionsSection.propTypes={isEnabled:_propTypes.default.bool.isRequired,conditions:_propTypes.default.array,addCondition:_propTypes.default.func.isRequired,updateCondition:_propTypes.default.func.isRequired,deleteCondition:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ConditionExpression=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _detector_rule=__webpack_require__(128);var _utils=__webpack_require__(143);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var POPOVER_STYLE={zIndex:"200"};var ConditionExpression=function(_Component){_inherits(ConditionExpression,_Component);function ConditionExpression(props){var _this;_classCallCheck(this,ConditionExpression);_this=_possibleConstructorReturn(this,_getPrototypeOf(ConditionExpression).call(this,props));_defineProperty(_assertThisInitialized(_this),"openAppliesTo",(function(){_this.setState({isAppliesToOpen:true,isOperatorValueOpen:false})}));_defineProperty(_assertThisInitialized(_this),"closeAppliesTo",(function(){_this.setState({isAppliesToOpen:false})}));_defineProperty(_assertThisInitialized(_this),"openOperatorValue",(function(){_this.setState({isAppliesToOpen:false,isOperatorValueOpen:true})}));_defineProperty(_assertThisInitialized(_this),"closeOperatorValue",(function(){_this.setState({isOperatorValueOpen:false})}));_defineProperty(_assertThisInitialized(_this),"changeAppliesTo",(function(event){var _this$props=_this.props,index=_this$props.index,operator=_this$props.operator,value=_this$props.value,updateCondition=_this$props.updateCondition;updateCondition(index,event.target.value,operator,value)}));_defineProperty(_assertThisInitialized(_this),"changeOperator",(function(event){var _this$props2=_this.props,index=_this$props2.index,appliesTo=_this$props2.appliesTo,value=_this$props2.value,updateCondition=_this$props2.updateCondition;updateCondition(index,appliesTo,event.target.value,value)}));_defineProperty(_assertThisInitialized(_this),"changeValue",(function(event){var _this$props3=_this.props,index=_this$props3.index,appliesTo=_this$props3.appliesTo,operator=_this$props3.operator,updateCondition=_this$props3.updateCondition;updateCondition(index,appliesTo,operator,+event.target.value)}));_this.state={isAppliesToOpen:false,isOperatorValueOpen:false};return _this}_createClass(ConditionExpression,[{key:"renderAppliesToPopover",value:function renderAppliesToPopover(){return _react.default.createElement("div",{style:POPOVER_STYLE},_react.default.createElement(_eui.EuiPopoverTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.appliesToPopoverTitle",defaultMessage:"When"})),_react.default.createElement("div",{className:"euiExpression",style:{width:200}},_react.default.createElement(_eui.EuiSelect,{value:this.props.appliesTo,onChange:this.changeAppliesTo,options:[{value:_detector_rule.APPLIES_TO.ACTUAL,text:(0,_utils.appliesToText)(_detector_rule.APPLIES_TO.ACTUAL)},{value:_detector_rule.APPLIES_TO.TYPICAL,text:(0,_utils.appliesToText)(_detector_rule.APPLIES_TO.TYPICAL)},{value:_detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL,text:(0,_utils.appliesToText)(_detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL)}]})))}},{key:"renderOperatorValuePopover",value:function renderOperatorValuePopover(){return _react.default.createElement("div",{style:POPOVER_STYLE},_react.default.createElement(_eui.EuiPopoverTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.operatorValuePopoverTitle",defaultMessage:"Is"})),_react.default.createElement("div",{className:"euiExpression"},_react.default.createElement(_eui.EuiFlexGroup,{style:{maxWidth:450}},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:250}},_react.default.createElement(_eui.EuiSelect,{value:this.props.operator,onChange:this.changeOperator,options:[{value:_detector_rule.OPERATOR.LESS_THAN,text:(0,_utils.operatorToText)(_detector_rule.OPERATOR.LESS_THAN)},{value:_detector_rule.OPERATOR.LESS_THAN_OR_EQUAL,text:(0,_utils.operatorToText)(_detector_rule.OPERATOR.LESS_THAN_OR_EQUAL)},{value:_detector_rule.OPERATOR.GREATER_THAN,text:(0,_utils.operatorToText)(_detector_rule.OPERATOR.GREATER_THAN)},{value:_detector_rule.OPERATOR.GREATER_THAN_OR_EQUAL,text:(0,_utils.operatorToText)(_detector_rule.OPERATOR.GREATER_THAN_OR_EQUAL)}]})),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:200}},_react.default.createElement(_eui.EuiFieldNumber,{value:+this.props.value,onChange:this.changeValue})))))}},{key:"render",value:function render(){var _this$props4=this.props,index=_this$props4.index,appliesTo=_this$props4.appliesTo,operator=_this$props4.operator,value=_this$props4.value,deleteCondition=_this$props4.deleteCondition;return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiPopover,{id:"appliesToPopover",button:_react.default.createElement(_eui.EuiExpression,{description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.appliesToButtonLabel",defaultMessage:"when"}),value:(0,_utils.appliesToText)(appliesTo),isActive:this.state.isAppliesToOpen,onClick:this.openAppliesTo}),isOpen:this.state.isAppliesToOpen,closePopover:this.closeAppliesTo,panelPaddingSize:"none",ownFocus:true,withTitle:true,anchorPosition:"downLeft"},this.renderAppliesToPopover())),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiPopover,{id:"operatorValuePopover",button:_react.default.createElement(_eui.EuiExpression,{description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.operatorValueButtonLabel",defaultMessage:"is {operator}",values:{operator:(0,_utils.operatorToText)(operator)}}),value:"".concat(value),isActive:this.state.isOperatorValueOpen,onClick:this.openOperatorValue}),isOpen:this.state.isOperatorValueOpen,closePopover:this.closeOperatorValue,panelPaddingSize:"none",ownFocus:true,withTitle:true,anchorPosition:"downLeft"},this.renderOperatorValuePopover())),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonIcon,{size:"s",color:"danger",onClick:function onClick(){return deleteCondition(index)},iconType:"trash","aria-label":_i18n.i18n.translate("xpack.ml.ruleEditor.conditionExpression.deleteConditionButtonAriaLabel",{defaultMessage:"Delete condition"})})))}}]);return ConditionExpression}(_react.Component);exports.ConditionExpression=ConditionExpression;_defineProperty(ConditionExpression,"propTypes",{index:_propTypes.default.number.isRequired,appliesTo:_propTypes.default.oneOf([_detector_rule.APPLIES_TO.ACTUAL,_detector_rule.APPLIES_TO.TYPICAL,_detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL]),operator:_propTypes.default.oneOf([_detector_rule.OPERATOR.LESS_THAN,_detector_rule.OPERATOR.LESS_THAN_OR_EQUAL,_detector_rule.OPERATOR.GREATER_THAN,_detector_rule.OPERATOR.GREATER_THAN_OR_EQUAL]),value:_propTypes.default.number.isRequired,updateCondition:_propTypes.default.func.isRequired,deleteCondition:_propTypes.default.func.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ScopeSection=ScopeSection;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _scope_expression=__webpack_require__(1664);var _check_privilege=__webpack_require__(56);var _utils=__webpack_require__(143);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function NoFilterListsCallOut(){return _react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.noFilterListsConfiguredTitle",defaultMessage:"No filter lists configured"}),iconType:"gear"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.createFilterListsDescription",defaultMessage:"To configure scope, you must first use the {filterListsLink} settings page to create the list of values you want to include or exclude in the rule.",values:{filterListsLink:_react.default.createElement(_eui.EuiLink,{href:"#/settings/filter_lists"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.createFilterListsDescription.filterListsLinkText",defaultMessage:"Filter Lists"}))}})))}function NoPermissionCallOut(){return _react.default.createElement(_eui.EuiCallOut,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.noPermissionToViewFilterListsTitle",defaultMessage:"You do not have permission to view filter lists"}),iconType:"gear"})}function ScopeSection(_ref){var isEnabled=_ref.isEnabled,onEnabledChange=_ref.onEnabledChange,partitioningFieldNames=_ref.partitioningFieldNames,filterListIds=_ref.filterListIds,scope=_ref.scope,updateScope=_ref.updateScope;var canGetFilters=(0,_check_privilege.checkPermission)("canGetFilters");if(partitioningFieldNames===null||partitioningFieldNames.length===0){return null}var content;if(filterListIds.length>0){content=partitioningFieldNames.map((function(fieldName,index){var filterValues;if(scope!==undefined&&scope[fieldName]!==undefined){filterValues=scope[fieldName]}else{filterValues=(0,_utils.getScopeFieldDefaults)(filterListIds)}return _react.default.createElement(_scope_expression.ScopeExpression,{key:index,fieldName:fieldName,filterId:filterValues.filter_id,filterType:filterValues.filter_type,enabled:filterValues.enabled,filterListIds:filterListIds,updateScope:updateScope})}))}else if(canGetFilters===false){content=_react.default.createElement(NoPermissionCallOut,null)}else{content=_react.default.createElement(NoFilterListsCallOut,null)}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.scopeTitle",defaultMessage:"Scope"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiCheckbox,{id:"enable_scope_checkbox",label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.addFilterListLabel",defaultMessage:"Add a filter list to limit where the rule applies."}),checked:isEnabled,onChange:onEnabledChange}),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),isEnabled&&_react.default.createElement(_react.default.Fragment,null,content),_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}))}ScopeSection.propTypes={isEnabled:_propTypes.default.bool.isRequired,onEnabledChange:_propTypes.default.func.isRequired,partitioningFieldNames:_propTypes.default.array.isRequired,filterListIds:_propTypes.default.array.isRequired,scope:_propTypes.default.object,updateScope:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ScopeExpression=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _detector_rule=__webpack_require__(128);var _utils=__webpack_require__(143);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var POPOVER_STYLE={zIndex:"200"};function getFilterListOptions(filterListIds){return filterListIds.map((function(filterId){return{value:filterId,text:filterId}}))}var ScopeExpression=function(_Component){_inherits(ScopeExpression,_Component);function ScopeExpression(props){var _this;_classCallCheck(this,ScopeExpression);_this=_possibleConstructorReturn(this,_getPrototypeOf(ScopeExpression).call(this,props));_defineProperty(_assertThisInitialized(_this),"openFilterList",(function(){_this.setState({isFilterListOpen:true})}));_defineProperty(_assertThisInitialized(_this),"closeFilterList",(function(){_this.setState({isFilterListOpen:false})}));_defineProperty(_assertThisInitialized(_this),"onChangeFilterType",(function(event){var _this$props=_this.props,fieldName=_this$props.fieldName,filterId=_this$props.filterId,enabled=_this$props.enabled,updateScope=_this$props.updateScope;updateScope(fieldName,filterId,event.target.value,enabled)}));_defineProperty(_assertThisInitialized(_this),"onChangeFilterId",(function(event){var _this$props2=_this.props,fieldName=_this$props2.fieldName,filterType=_this$props2.filterType,enabled=_this$props2.enabled,updateScope=_this$props2.updateScope;updateScope(fieldName,event.target.value,filterType,enabled)}));_defineProperty(_assertThisInitialized(_this),"onEnableChange",(function(event){var _this$props3=_this.props,fieldName=_this$props3.fieldName,filterId=_this$props3.filterId,filterType=_this$props3.filterType,updateScope=_this$props3.updateScope;updateScope(fieldName,filterId,filterType,event.target.checked)}));_this.state={isFilterListOpen:false};return _this}_createClass(ScopeExpression,[{key:"renderFilterListPopover",value:function renderFilterListPopover(){var _this$props4=this.props,filterId=_this$props4.filterId,filterType=_this$props4.filterType,filterListIds=_this$props4.filterListIds;return _react.default.createElement("div",{style:POPOVER_STYLE},_react.default.createElement(_eui.EuiPopoverTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFilterTypePopoverTitle",defaultMessage:"Is"})),_react.default.createElement("div",{className:"euiExpression"},_react.default.createElement(_eui.EuiFlexGroup,{style:{maxWidth:450}},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:150}},_react.default.createElement(_eui.EuiSelect,{value:filterType,onChange:this.onChangeFilterType,options:[{value:_detector_rule.FILTER_TYPE.INCLUDE,text:(0,_utils.filterTypeToText)(_detector_rule.FILTER_TYPE.INCLUDE)},{value:_detector_rule.FILTER_TYPE.EXCLUDE,text:(0,_utils.filterTypeToText)(_detector_rule.FILTER_TYPE.EXCLUDE)}]})),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:300}},_react.default.createElement(_eui.EuiSelect,{value:filterId,onChange:this.onChangeFilterId,options:getFilterListOptions(filterListIds)})))))}},{key:"render",value:function render(){var _this$props5=this.props,fieldName=_this$props5.fieldName,filterId=_this$props5.filterId,filterType=_this$props5.filterType,enabled=_this$props5.enabled,filterListIds=_this$props5.filterListIds;return _react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m"},_react.default.createElement(_eui.EuiFlexItem,{grow:false,className:"scope-field-checkbox"},_react.default.createElement(_eui.EuiCheckbox,{id:"scope_cb_".concat(fieldName),checked:enabled,onChange:this.onEnableChange})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiExpression,{className:"scope-field-button",description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFieldWhenLabel",defaultMessage:"when"}),value:fieldName,isActive:false,onClick:function onClick(event){return event.preventDefault()}})),filterListIds!==undefined&&filterListIds.length>0&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiPopover,{id:"operatorValuePopover",button:_react.default.createElement(_eui.EuiExpression,{description:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFilterTypeButtonLabel",defaultMessage:"is {filterType}",values:{filterType:(0,_utils.filterTypeToText)(filterType)}}),value:filterId||"",isActive:this.state.isFilterListOpen,onClick:this.openFilterList}),isOpen:this.state.isFilterListOpen,closePopover:this.closeFilterList,panelPaddingSize:"none",ownFocus:true,withTitle:true,anchorPosition:"downLeft"},this.renderFilterListPopover())))}}]);return ScopeExpression}(_react.Component);exports.ScopeExpression=ScopeExpression;ScopeExpression.propTypes={fieldName:_propTypes.default.string.isRequired,filterId:_propTypes.default.string,filterType:_propTypes.default.oneOf([_detector_rule.FILTER_TYPE.INCLUDE,_detector_rule.FILTER_TYPE.EXCLUDE]),enabled:_propTypes.default.bool.isRequired,filterListIds:_propTypes.default.array.isRequired,updateScope:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"SelectRuleAction",{enumerable:true,get:function get(){return _select_rule_action.SelectRuleAction}});var _select_rule_action=__webpack_require__(1666)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SelectRuleAction=SelectRuleAction;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _detector_description_list=__webpack_require__(516);var _rule_action_panel=__webpack_require__(1667);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function SelectRuleAction(_ref){var job=_ref.job,anomaly=_ref.anomaly,setEditRuleIndex=_ref.setEditRuleIndex,updateRuleAtIndex=_ref.updateRuleAtIndex,deleteRuleAtIndex=_ref.deleteRuleAtIndex,addItemToFilterList=_ref.addItemToFilterList;var detectorIndex=anomaly.detectorIndex;var detector=job.analysis_config.detectors[detectorIndex];var rules=detector.custom_rules||[];var ruleActionPanels;if(rules.length>0){ruleActionPanels=rules.map((function(rule,index){return _react.default.createElement(_react.default.Fragment,{key:"rule_panel_".concat(index)},_react.default.createElement(_rule_action_panel.RuleActionPanel,{job:job,ruleIndex:index,anomaly:anomaly,setEditRuleIndex:setEditRuleIndex,updateRuleAtIndex:updateRuleAtIndex,deleteRuleAtIndex:deleteRuleAtIndex,addItemToFilterList:addItemToFilterList}),_react.default.createElement(_eui.EuiSpacer,{size:"l"}))}))}return _react.default.createElement("div",{className:"select-rule-action"},rules.length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_detector_description_list.DetectorDescriptionList,{job:job,detector:detector,anomaly:anomaly}),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),ruleActionPanels,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiText,{style:{display:"inline"}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.selectRuleAction.orText",defaultMessage:"Or "}))),_react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setEditRuleIndex(rules.length)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.selectRuleAction.createRuleLinkText",defaultMessage:"create a rule"})))}SelectRuleAction.propTypes={job:_propTypes.default.object.isRequired,anomaly:_propTypes.default.object.isRequired,setEditRuleIndex:_propTypes.default.func.isRequired,updateRuleAtIndex:_propTypes.default.func.isRequired,deleteRuleAtIndex:_propTypes.default.func.isRequired,addItemToFilterList:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RuleActionPanel=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _lodash=__webpack_require__(49);var _add_to_filter_list_link=__webpack_require__(1668);var _delete_rule_modal=__webpack_require__(1669);var _edit_condition_link=__webpack_require__(1670);var _utils=__webpack_require__(143);var _ml_api_service=__webpack_require__(51);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var RuleActionPanel=function(_Component){_inherits(RuleActionPanel,_Component);function RuleActionPanel(props){var _this;_classCallCheck(this,RuleActionPanel);_this=_possibleConstructorReturn(this,_getPrototypeOf(RuleActionPanel).call(this,props));_defineProperty(_assertThisInitialized(_this),"getEditRuleLink",(function(){var _this$props=_this.props,ruleIndex=_this$props.ruleIndex,setEditRuleIndex=_this$props.setEditRuleIndex;return _react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setEditRuleIndex(ruleIndex)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.editRuleLinkText",defaultMessage:"Edit rule"}))}));_defineProperty(_assertThisInitialized(_this),"getDeleteRuleLink",(function(){var _this$props2=_this.props,ruleIndex=_this$props2.ruleIndex,deleteRuleAtIndex=_this$props2.deleteRuleAtIndex;return _react.default.createElement(_delete_rule_modal.DeleteRuleModal,{ruleIndex:ruleIndex,deleteRuleAtIndex:deleteRuleAtIndex})}));_defineProperty(_assertThisInitialized(_this),"getQuickEditConditionLink",(function(){var conditions=_this.rule.conditions;var link=null;if(_this.rule.conditions!==undefined&&conditions.length===1){link=_react.default.createElement(_edit_condition_link.EditConditionLink,{conditionIndex:0,conditionValue:conditions[0].value,appliesTo:conditions[0].applies_to,anomaly:_this.props.anomaly,updateConditionValue:_this.updateConditionValue})}return link}));_defineProperty(_assertThisInitialized(_this),"getQuickAddToFilterListLink",(function(){var _this$props3=_this.props,anomaly=_this$props3.anomaly,addItemToFilterList=_this$props3.addItemToFilterList;var scope=_this.rule.scope;var partitionFieldName=Object.keys(scope)[0];var partitionFieldValue=anomaly.source[partitionFieldName];var filterId=scope[partitionFieldName].filter_id;return _react.default.createElement(_add_to_filter_list_link.AddToFilterListLink,{fieldValue:partitionFieldValue[0],filterId:filterId,addItemToFilterList:addItemToFilterList})}));_defineProperty(_assertThisInitialized(_this),"updateConditionValue",(function(conditionIndex,value){var _this$props4=_this.props,job=_this$props4.job,anomaly=_this$props4.anomaly,ruleIndex=_this$props4.ruleIndex,updateRuleAtIndex=_this$props4.updateRuleAtIndex;var detector=job.analysis_config.detectors[anomaly.detectorIndex];var editedRule=(0,_lodash.cloneDeep)(detector.custom_rules[ruleIndex]);var conditions=editedRule.conditions;if(conditionIndex<conditions.length){conditions[conditionIndex].value=value}updateRuleAtIndex(ruleIndex,editedRule)}));var _this$props5=_this.props,_job=_this$props5.job,_anomaly=_this$props5.anomaly,_ruleIndex=_this$props5.ruleIndex;var _detector=_job.analysis_config.detectors[_anomaly.detectorIndex];var rules=_detector.custom_rules;if(rules!==undefined&&_ruleIndex<rules.length){_this.rule=rules[_ruleIndex]}_this.state={showAddToFilterListLink:false};return _this}_createClass(RuleActionPanel,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;var scope=this.rule.scope;if(scope!==undefined&&Object.keys(scope).length===1){var partitionFieldName=Object.keys(scope)[0];var partitionFieldValue=this.props.anomaly.source[partitionFieldName];if(scope[partitionFieldName]!==undefined&&partitionFieldValue!==undefined&&partitionFieldValue.length===1&&partitionFieldValue[0].length>0){var filterId=scope[partitionFieldName].filter_id;_ml_api_service.ml.filters.filters({filterId:filterId}).then((function(filter){var filterItems=filter.items;if(filterItems.indexOf(partitionFieldValue[0])===-1){_this2.setState({showAddToFilterListLink:true})}})).catch((function(resp){console.log("Error loading filter ".concat(filterId,":"),resp)}))}}}},{key:"render",value:function render(){if(this.rule===undefined){return null}var descriptionListItems=[{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.ruleTitle",defaultMessage:"Rule"}),description:(0,_utils.buildRuleDescription)(this.rule,this.props.anomaly)},{title:"",description:this.getEditRuleLink()},{title:"",description:this.getDeleteRuleLink()}];var quickConditionLink=this.getQuickEditConditionLink();if(quickConditionLink!==null){descriptionListItems.splice(1,0,{title:"",description:quickConditionLink})}if(this.state.showAddToFilterListLink===true){var quickAddToFilterListLink=this.getQuickAddToFilterListLink();descriptionListItems.splice(descriptionListItems.length-2,0,{title:"",description:quickAddToFilterListLink})}descriptionListItems[1].title=_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.actionsTitle",defaultMessage:"Actions"});return _react.default.createElement(_eui.EuiPanel,{paddingSize:"m",className:"select-rule-action-panel"},_react.default.createElement(_eui.EuiDescriptionList,{type:"column",listItems:descriptionListItems}))}}]);return RuleActionPanel}(_react.Component);exports.RuleActionPanel=RuleActionPanel;RuleActionPanel.propTypes={job:_propTypes.default.object.isRequired,anomaly:_propTypes.default.object.isRequired,ruleIndex:_propTypes.default.number.isRequired,setEditRuleIndex:_propTypes.default.func.isRequired,updateRuleAtIndex:_propTypes.default.func.isRequired,deleteRuleAtIndex:_propTypes.default.func.isRequired,addItemToFilterList:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AddToFilterListLink=AddToFilterListLink;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function AddToFilterListLink(_ref){var fieldValue=_ref.fieldValue,filterId=_ref.filterId,addItemToFilterList=_ref.addItemToFilterList;return _react.default.createElement(_eui.EuiLink,{onClick:function onClick(){return addItemToFilterList(fieldValue,filterId,true)}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.addValueToFilterListLinkText",defaultMessage:"Add {fieldValue} to {filterId}",values:{fieldValue:fieldValue,filterId:filterId}}))}AddToFilterListLink.propTypes={fieldValue:_propTypes.default.string.isRequired,filterId:_propTypes.default.string.isRequired,addItemToFilterList:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DeleteRuleModal=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DeleteRuleModal=function(_Component){_inherits(DeleteRuleModal,_Component);function DeleteRuleModal(props){var _this;_classCallCheck(this,DeleteRuleModal);_this=_possibleConstructorReturn(this,_getPrototypeOf(DeleteRuleModal).call(this,props));_defineProperty(_assertThisInitialized(_this),"deleteRule",(function(){var _this$props=_this.props,ruleIndex=_this$props.ruleIndex,deleteRuleAtIndex=_this$props.deleteRuleAtIndex;deleteRuleAtIndex(ruleIndex);_this.closeModal()}));_defineProperty(_assertThisInitialized(_this),"closeModal",(function(){_this.setState({isModalVisible:false})}));_defineProperty(_assertThisInitialized(_this),"showModal",(function(){_this.setState({isModalVisible:true})}));_this.state={isModalVisible:false};return _this}_createClass(DeleteRuleModal,[{key:"render",value:function render(){var _this2=this;var modal;if(this.state.isModalVisible){modal=_react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiConfirmModal,{title:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleTitle",defaultMessage:"Delete rule"}),onCancel:this.closeModal,onConfirm:this.deleteRule,buttonColor:"danger",cancelButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteButtonLabel",defaultMessage:"Delete"}),defaultFocusedButton:_eui.EUI_MODAL_CONFIRM_BUTTON},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleDescription",defaultMessage:"Are you sure you want to delete this rule?"}))))}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiLink,{color:"danger",onClick:function onClick(){return _this2.showModal()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleLinkText",defaultMessage:"Delete rule"})),modal)}}]);return DeleteRuleModal}(_react.Component);exports.DeleteRuleModal=DeleteRuleModal;DeleteRuleModal.propTypes={ruleIndex:_propTypes.default.number.isRequired,deleteRuleAtIndex:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditConditionLink=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _detector_rule=__webpack_require__(128);var _format_value=__webpack_require__(133);var _utils=__webpack_require__(143);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var EditConditionLink=function(_Component){_inherits(EditConditionLink,_Component);function EditConditionLink(props){var _this;_classCallCheck(this,EditConditionLink);_this=_possibleConstructorReturn(this,_getPrototypeOf(EditConditionLink).call(this,props));_defineProperty(_assertThisInitialized(_this),"onChangeValue",(function(event){var enteredValue=event.target.value;_this.setState({value:enteredValue!==""?+enteredValue:""})}));_defineProperty(_assertThisInitialized(_this),"onUpdateClick",(function(){var _this$props=_this.props,conditionIndex=_this$props.conditionIndex,updateConditionValue=_this$props.updateConditionValue;updateConditionValue(conditionIndex,_this.state.value)}));var value="";var anomaly=_this.props.anomaly;var anomalyValue=(0,_utils.getAppliesToValueFromAnomaly)(anomaly,props.appliesTo);if(anomalyValue!==undefined){value=+(0,_format_value.formatValue)(anomalyValue,anomaly.source.function)}_this.state={value:value};return _this}_createClass(EditConditionLink,[{key:"render",value:function render(){var _this2=this;var value=this.state.value;return _react.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.editConditionLink.updateRuleConditionFromText",defaultMessage:"Update rule condition from {conditionValue} to",values:{conditionValue:this.props.conditionValue}}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false,className:"condition-edit-value-field"},_react.default.createElement(_eui.EuiFieldNumber,{placeholder:_i18n.i18n.translate("xpack.ml.ruleEditor.editConditionLink.enterValuePlaceholder",{defaultMessage:"Enter value"}),compressed:true,value:value,onChange:this.onChangeValue,"aria-label":_i18n.i18n.translate("xpack.ml.ruleEditor.editConditionLink.enterNumericValueForConditionAriaLabel",{defaultMessage:"Enter numeric value for condition"})})),value!==""&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiLink,{size:"s",onClick:function onClick(){return _this2.onUpdateClick()}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.ruleEditor.editConditionLink.updateLinkText",defaultMessage:"Update"}))))}}]);return EditConditionLink}(_react.Component);exports.EditConditionLink=EditConditionLink;_defineProperty(EditConditionLink,"propTypes",{conditionIndex:_propTypes.default.number.isRequired,conditionValue:_propTypes.default.number.isRequired,appliesTo:_propTypes.default.oneOf([_detector_rule.APPLIES_TO.ACTUAL,_detector_rule.APPLIES_TO.TYPICAL,_detector_rule.APPLIES_TO.DIFF_FROM_TYPICAL]),anomaly:_propTypes.default.object.isRequired,updateConditionValue:_propTypes.default.func.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ChartTooltip=void 0;var _classnames=_interopRequireDefault(__webpack_require__(87));var _react=_interopRequireWildcard(__webpack_require__(28));var _useObservable=_interopRequireDefault(__webpack_require__(129));var _chart_tooltip_service=__webpack_require__(134);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function useRefWithCallback(chartTooltipState){var ref=(0,_react.useRef)(null);return function(node){ref.current=node;if(node!==null&&node.parentElement!==null&&chartTooltipState!==undefined&&chartTooltipState.isTooltipVisible){var parentBounding=node.parentElement.getBoundingClientRect();var targetPosition=chartTooltipState.targetPosition,offset=chartTooltipState.offset;var contentWidth=document.body.clientWidth-parentBounding.left;var tooltipWidth=node.clientWidth;var left=targetPosition.left+offset.x-parentBounding.left;if(left+tooltipWidth>contentWidth){left=left-(tooltipWidth+offset.x)}var top=targetPosition.top+offset.y-parentBounding.top;if(chartTooltipState.tooltipPosition.left!==left||chartTooltipState.tooltipPosition.top!==top){_chart_tooltip_service.chartTooltip$.next(_objectSpread({},chartTooltipState,{tooltipPosition:{left:left,top:top}}))}}}}var renderHeader=function renderHeader(headerData,formatter){if(!headerData){return null}return formatter?formatter(headerData):headerData.label};var ChartTooltip=function ChartTooltip(){var chartTooltipState=(0,_useObservable.default)(_chart_tooltip_service.chartTooltip$);var chartTooltipElement=useRefWithCallback(chartTooltipState);if(chartTooltipState===undefined||!chartTooltipState.isTooltipVisible){return _react.default.createElement("div",{className:"mlChartTooltip mlChartTooltip--hidden",ref:chartTooltipElement})}var tooltipData=chartTooltipState.tooltipData,tooltipHeaderFormatter=chartTooltipState.tooltipHeaderFormatter,tooltipPosition=chartTooltipState.tooltipPosition;var transform="translate(".concat(tooltipPosition.left,"px, ").concat(tooltipPosition.top,"px)");return _react.default.createElement("div",{className:"mlChartTooltip",style:{transform:transform},ref:chartTooltipElement},tooltipData.length>0&&tooltipData[0].skipHeader===undefined&&_react.default.createElement("div",{className:"mlChartTooltip__header"},renderHeader(tooltipData[0],tooltipHeaderFormatter)),tooltipData.length>1&&_react.default.createElement("div",{className:"mlChartTooltip__list"},tooltipData.slice(1).map((function(_ref){var label=_ref.label,value=_ref.value,color=_ref.color,isHighlighted=_ref.isHighlighted,seriesIdentifier=_ref.seriesIdentifier,valueAccessor=_ref.valueAccessor;var classes=(0,_classnames.default)("mlChartTooltip__item",{echTooltip__rowHighlighted:isHighlighted});return _react.default.createElement("div",{key:"".concat(seriesIdentifier.key,"__").concat(valueAccessor),className:classes,style:{borderLeftColor:color}},_react.default.createElement("span",{className:"mlChartTooltip__label"},label),_react.default.createElement("span",{className:"mlChartTooltip__value"},value))}))))};exports.ChartTooltip=ChartTooltip},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"EntityControl",{enumerable:true,get:function get(){return _entity_control.EntityControl}});var _entity_control=__webpack_require__(208)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Modal=Modal;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _message_call_out=__webpack_require__(1674);var _forecasts_list=__webpack_require__(1676);var _run_controls=__webpack_require__(1677);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function Modal(props){return _react.default.createElement(_eui.EuiOverlayMask,null,_react.default.createElement(_eui.EuiModal,{onClose:props.close,maxWidth:860},_react.default.createElement(_eui.EuiModalHeader,null,_react.default.createElement(_eui.EuiModalHeaderTitle,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastingTitle",defaultMessage:"Forecasting"}))),_react.default.createElement(_eui.EuiModalBody,null,props.messages.map((function(message,i){return _react.default.createElement(_react.default.Fragment,{key:i},_react.default.createElement(_message_call_out.MessageCallOut,message),_react.default.createElement(_eui.EuiSpacer,{size:"m"}))})),props.forecasts.length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_forecasts_list.ForecastsList,{forecasts:props.forecasts,viewForecast:props.viewForecast}),_react.default.createElement(_eui.EuiSpacer,null)),_react.default.createElement(_run_controls.RunControls,props)),_react.default.createElement(_eui.EuiModalFooter,null,_react.default.createElement(_eui.EuiButtonEmpty,{onClick:props.close,size:"s","data-test-subj":"mlModalForecastButtonClose"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.closeButtonLabel",defaultMessage:"Close"})))))}Modal.propType={job:_propTypes.default.object,forecasts:_propTypes.default.array,close:_propTypes.default.func.isRequired,viewForecast:_propTypes.default.func.isRequired,runForecast:_propTypes.default.func.isRequired,newForecastDuration:_propTypes.default.string,isNewForecastDurationValid:_propTypes.default.bool,newForecastDurationErrors:_propTypes.default.array,onNewForecastDurationChange:_propTypes.default.func.isRequired,isForecastRequested:_propTypes.default.bool,forecastProgress:_propTypes.default.number,jobOpeningState:_propTypes.default.number,jobClosingState:_propTypes.default.number,messages:_propTypes.default.array}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"MessageCallOut",{enumerable:true,get:function get(){return _message_call_out.MessageCallOut}});var _message_call_out=__webpack_require__(1675)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MessageCallOut=MessageCallOut;var _react=_interopRequireDefault(__webpack_require__(28));var _propTypes=_interopRequireDefault(__webpack_require__(50));var _eui=__webpack_require__(29);var _message_levels=__webpack_require__(519);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function getCallOutAttributes(message,status){switch(status){case _message_levels.MESSAGE_LEVEL.ERROR:return{title:message,iconType:"cross",color:"danger"};case _message_levels.MESSAGE_LEVEL.WARNING:return{title:message,iconType:"alert",color:"warning"};case _message_levels.MESSAGE_LEVEL.SUCCESS:return{title:message,iconType:"check",color:"success"};case _message_levels.MESSAGE_LEVEL.INFO:return{title:message,iconType:"iInCircle",color:"primary"}}}function MessageCallOut(_ref){var message=_ref.message,status=_ref.status,rest=_objectWithoutProperties(_ref,["message","status"]);return _react.default.createElement(_eui.EuiCallOut,_extends({size:"s"},getCallOutAttributes(message,status),rest))}MessageCallOut.propTypes={message:_propTypes.default.string,status:_propTypes.default.oneOf([_message_levels.MESSAGE_LEVEL.ERROR,_message_levels.MESSAGE_LEVEL.WARNING,_message_levels.MESSAGE_LEVEL.SUCCESS,_message_levels.MESSAGE_LEVEL.INFO])}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ForecastsList=ForecastsList;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _date_utils=__webpack_require__(83);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getColumns(viewForecast){return[{field:"forecast_create_timestamp",name:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.createdColumnName",{defaultMessage:"Created"}),dataType:"date",render:function render(date){return(0,_date_utils.formatHumanReadableDateTimeSeconds)(date)},sortable:true},{field:"forecast_start_timestamp",name:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.fromColumnName",{defaultMessage:"From"}),dataType:"date",render:function render(date){return(0,_date_utils.formatHumanReadableDateTimeSeconds)(date)},sortable:true},{field:"forecast_end_timestamp",name:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.toColumnName",{defaultMessage:"To"}),dataType:"date",render:function render(date){return(0,_date_utils.formatHumanReadableDateTimeSeconds)(date)},sortable:true},{name:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.viewColumnName",{defaultMessage:"View"}),width:"60px",render:function render(forecast){var viewForecastAriaLabel=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.viewForecastAriaLabel",{defaultMessage:"View forecast created at {createdDate}",values:{createdDate:(0,_date_utils.formatHumanReadableDateTimeSeconds)(forecast.forecast_create_timestamp)}});return _react.default.createElement(_eui.EuiButtonIcon,{onClick:function onClick(){return viewForecast(forecast.forecast_id)},iconType:"stats","aria-label":viewForecastAriaLabel})}}]}function ForecastsList(_ref){var forecasts=_ref.forecasts,viewForecast=_ref.viewForecast;return _react.default.createElement(_eui.EuiText,null,_react.default.createElement("h3",{"aria-describedby":"ml_aria_description_forecasting_modal_view_list",style:{display:"inline",paddingRight:"5px"}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastsList.previousForecastsTitle",defaultMessage:"Previous forecasts"})),_react.default.createElement(_eui.EuiToolTip,{position:"right",content:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastsList.listsOfFiveRecentlyRunForecastsTooltip",defaultMessage:"Lists a maximum of five of the most recently run forecasts."})},_react.default.createElement(_eui.EuiIcon,{type:"questionInCircle",size:"s"})),_react.default.createElement(_eui.EuiInMemoryTable,{items:forecasts,columns:getColumns(viewForecast),pagination:false,"data-test-subj":"mlModalForecastTable"}))}ForecastsList.propType={forecasts:_propTypes.default.array,viewForecast:_propTypes.default.func.isRequired}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RunControls=RunControls;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _states=__webpack_require__(108);var _forecasting_modal=__webpack_require__(518);var _forecast_progress=__webpack_require__(1678);var _check_ml_nodes=__webpack_require__(81);var _check_privilege=__webpack_require__(56);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getRunInputDisabledState(job,isForecastRequested){if((0,_check_ml_nodes.mlNodesAvailable)()===false){return{isDisabled:true,isDisabledToolTipText:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.runControls.noMLNodesAvailableTooltip",{defaultMessage:"There are no ML nodes available."})}}if((0,_check_privilege.checkPermission)("canForecastJob")===false){return{isDisabled:true,isDisabledToolTipText:(0,_check_privilege.createPermissionFailureMessage)("canForecastJob")}}if(job.state!==_states.JOB_STATE.OPENED&&job.state!==_states.JOB_STATE.CLOSED){return{isDisabled:true,isDisabledToolTipText:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.runControls.forecastsCanNotBeRunOnJobsTooltip",{defaultMessage:"Forecasts cannot be run on {jobState} jobs",values:{jobState:job.state}})}}return{isDisabled:isForecastRequested}}function RunControls(_ref){var job=_ref.job,newForecastDuration=_ref.newForecastDuration,isNewForecastDurationValid=_ref.isNewForecastDurationValid,newForecastDurationErrors=_ref.newForecastDurationErrors,onNewForecastDurationChange=_ref.onNewForecastDurationChange,runForecast=_ref.runForecast,isForecastRequested=_ref.isForecastRequested,forecastProgress=_ref.forecastProgress,jobOpeningState=_ref.jobOpeningState,jobClosingState=_ref.jobClosingState;var disabledState=getRunInputDisabledState(job,isForecastRequested);var durationInput=_react.default.createElement(_eui.EuiFieldText,{name:"forecastDuration",value:newForecastDuration,disabled:disabledState.isDisabled,isInvalid:!isNewForecastDurationValid,onChange:onNewForecastDurationChange,fullWidth:true});var runButton=_react.default.createElement(_eui.EuiButton,{onClick:runForecast,isDisabled:disabledState.isDisabled||!isNewForecastDurationValid,"data-test-subj":"mlModalForecastButtonRun"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.runButtonLabel",defaultMessage:"Run"}));return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiText,null,_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.runNewForecastTitle",defaultMessage:"Run a new forecast"}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiForm,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiFormRow,{label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.durationLabel",defaultMessage:"Duration"}),fullWidth:true,isInvalid:!isNewForecastDurationValid,error:newForecastDurationErrors,helpText:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.forecastMaximumLengthHelpText",defaultMessage:"Length of forecast, up to a maximum of {maximumForecastDurationDays} days. Use s for seconds, m for minutes, h for hours, d for days, w for weeks.",values:{maximumForecastDurationDays:_forecasting_modal.FORECAST_DURATION_MAX_DAYS}})},disabledState.isDisabledToolTipText===undefined?durationInput:_react.default.createElement(_eui.EuiToolTip,{position:"right",content:disabledState.isDisabledToolTipText},durationInput))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{hasEmptyLabelSpace:true},disabledState.isDisabledToolTipText===undefined?runButton:_react.default.createElement(_eui.EuiToolTip,{position:"left",content:disabledState.isDisabledToolTipText},runButton))))),_react.default.createElement(_eui.EuiSpacer,{size:"s"}),isForecastRequested===true&&_react.default.createElement(_forecast_progress.ForecastProgress,{forecastProgress:forecastProgress,jobOpeningState:jobOpeningState,jobClosingState:jobClosingState}))}RunControls.propType={job:_propTypes.default.object,newForecastDuration:_propTypes.default.string,isNewForecastDurationValid:_propTypes.default.bool,newForecastDurationErrors:_propTypes.default.array,onNewForecastDurationChange:_propTypes.default.func.isRequired,runForecast:_propTypes.default.func.isRequired,isForecastRequested:_propTypes.default.bool,forecastProgress:_propTypes.default.number,jobOpeningState:_propTypes.default.number,jobClosingState:_propTypes.default.number}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ForecastProgress=ForecastProgress;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _progress_icon=__webpack_require__(1679);var _progress_states=__webpack_require__(271);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ForecastProgress(_ref){var forecastProgress=_ref.forecastProgress,jobOpeningState=_ref.jobOpeningState,jobClosingState=_ref.jobClosingState;return _react.default.createElement("div",null,jobOpeningState!==_progress_states.PROGRESS_STATES.UNSET&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.openingJobTitle",defaultMessage:"Opening job…"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_progress_icon.ProgressIcon,{state:jobOpeningState}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"})),forecastProgress!==_progress_states.PROGRESS_STATES.UNSET&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.runningForecastTitle",defaultMessage:"Running forecast…"})))),forecastProgress>=0&&_react.default.createElement(_eui.EuiFlexItem,null,_react.default.createElement(_eui.EuiToolTip,{position:"top",content:forecastProgress+"%"},_react.default.createElement(_eui.EuiProgress,{size:"l",value:forecastProgress,max:100}))),forecastProgress===_progress_states.PROGRESS_STATES.ERROR&&_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_progress_icon.ProgressIcon,{state:_progress_states.PROGRESS_STATES.ERROR}))),_react.default.createElement(_eui.EuiSpacer,{size:"s"})),jobClosingState!==_progress_states.PROGRESS_STATES.UNSET&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiText,{size:"xs"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.closingJobTitle",defaultMessage:"Closing job…"})))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_progress_icon.ProgressIcon,{state:jobClosingState})))))}ForecastProgress.propType={forecastProgress:_propTypes.default.number,jobOpeningState:_propTypes.default.number,jobClosingState:_propTypes.default.number}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ProgressIcon=ProgressIcon;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _progress_states=__webpack_require__(271);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ProgressIcon(_ref){var state=_ref.state;if(state===_progress_states.PROGRESS_STATES.WAITING){return _react.default.createElement(_eui.EuiLoadingSpinner,{size:"m"})}else if(state===_progress_states.PROGRESS_STATES.DONE){return _react.default.createElement(_eui.EuiIcon,{type:"check",size:"m",color:"primary"})}else if(state===_progress_states.PROGRESS_STATES.ERROR){return _react.default.createElement(_eui.EuiIcon,{type:"cross",size:"m",color:"danger"})}}ProgressIcon.propTypes={state:_propTypes.default.number}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeseriesChart=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _useObservable=_interopRequireDefault(__webpack_require__(129));var _lodash=_interopRequireDefault(__webpack_require__(49));var _d=_interopRequireDefault(__webpack_require__(97));var _moment=_interopRequireDefault(__webpack_require__(32));var _anomaly_utils=__webpack_require__(75);var _annotations_service=__webpack_require__(159);var _format_value=__webpack_require__(133);var _chart_utils=__webpack_require__(135);var _date_utils=__webpack_require__(83);var _time_buckets=__webpack_require__(106);var _table_service=__webpack_require__(242);var _context_chart_mask=__webpack_require__(1681);var _timeseriesexplorer_utils=__webpack_require__(274);var _string_utils=__webpack_require__(80);var _field_format_service=__webpack_require__(112);var _chart_tooltip_service=__webpack_require__(134);var _timeseries_chart_annotations=__webpack_require__(1685);var _i18n=__webpack_require__(1);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var focusZoomPanelHeight=25;var focusChartHeight=310;var focusHeight=focusZoomPanelHeight+focusChartHeight;var contextChartHeight=60;var contextChartLineTopMargin=3;var chartSpacing=25;var swimlaneHeight=30;var margin={top:10,right:10,bottom:15,left:40};var ZOOM_INTERVAL_OPTIONS=[{duration:_moment.default.duration(1,"h"),label:"1h"},{duration:_moment.default.duration(12,"h"),label:"12h"},{duration:_moment.default.duration(1,"d"),label:"1d"},{duration:_moment.default.duration(1,"w"),label:"1w"},{duration:_moment.default.duration(2,"w"),label:"2w"},{duration:_moment.default.duration(1,"M"),label:"1M"}];var anomalyColorScale=_d.default.scale.threshold().domain([3,25,50,75,100]).range(["#d2e9f7","#8bc8fb","#ffdd00","#ff7e00","#fe5050"]);var anomalyGrayScale=_d.default.scale.threshold().domain([3,25,50,75,100]).range(["#dce7ed","#b0c5d6","#b1a34e","#b17f4e","#c88686"]);function getSvgHeight(){return focusHeight+contextChartHeight+swimlaneHeight+chartSpacing+margin.top+margin.bottom}var TimeseriesChartIntl=function(_Component){_inherits(TimeseriesChartIntl,_Component);function TimeseriesChartIntl(){var _getPrototypeOf2;var _this;_classCallCheck(this,TimeseriesChartIntl);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(TimeseriesChartIntl)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"rowMouseenterSubscriber",null);_defineProperty(_assertThisInitialized(_this),"rowMouseleaveSubscriber",null);_defineProperty(_assertThisInitialized(_this),"contextChartInitialized",false);_defineProperty(_assertThisInitialized(_this),"drawContextBrush",(function(contextGroup){var contextChartSelected=_this.props.contextChartSelected;var brush=_this.brush;var contextXScale=_this.contextXScale;var mask=_this.mask;brush.x(contextXScale).on("brush",brushing).on("brushend",brushed);contextGroup.append("g").attr("class","x brush").call(brush).selectAll("rect").attr("y",-1).attr("height",contextChartHeight+swimlaneHeight+1);contextGroup.selectAll(".w rect").attr("x",-10).attr("width",10);contextGroup.selectAll(".e rect").attr("x",0).attr("width",10);var handleBrushExtent=brush.extent();var topBorder=contextGroup.append("rect").attr("class","top-border").attr("y",-2).attr("height",contextChartLineTopMargin);var leftHandle=contextGroup.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").attr("x",contextXScale(handleBrushExtent[0])-10).html('<div class="brush-handle-inner brush-handle-inner-left"><i class="fa fa-caret-left"></i></div>');var rightHandle=contextGroup.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").attr("x",contextXScale(handleBrushExtent[1])+0).html('<div class="brush-handle-inner brush-handle-inner-right"><i class="fa fa-caret-right"></i></div>');function brushing(){var brushExtent=brush.extent();mask.reveal(brushExtent);leftHandle.attr("x",contextXScale(brushExtent[0])-10);rightHandle.attr("x",contextXScale(brushExtent[1])+0);topBorder.attr("x",contextXScale(brushExtent[0])+1);var topBorderWidth=Math.max(0,contextXScale(brushExtent[1])-contextXScale(brushExtent[0])-2);topBorder.attr("width",topBorderWidth);var isEmpty=brush.empty();_d.default.selectAll(".brush-handle").style("visibility",isEmpty?"hidden":"visible")}brushing();var that=_assertThisInitialized(_this);function brushed(){var isEmpty=brush.empty();var selectedBounds=isEmpty?contextXScale.domain():brush.extent();var selectionMin=selectedBounds[0].getTime();var selectionMax=selectedBounds[1].getTime();if(that.selectedBounds!==undefined&&that.selectedBounds.min.valueOf()===selectionMin&&that.selectedBounds.max.valueOf()===selectionMax){return}contextGroup.selectAll(".swimlane-cell").style("fill",(function(d){var cellMs=d.date.getTime();if(cellMs<selectionMin||cellMs>selectionMax){return anomalyGrayScale(d.score)}else{return anomalyColorScale(d.score)}}));that.selectedBounds={min:(0,_moment.default)(selectionMin),max:(0,_moment.default)(selectionMax)};contextChartSelected({from:selectedBounds[0],to:selectedBounds[1]})}}));_defineProperty(_assertThisInitialized(_this),"drawSwimlane",(function(swlGroup,swlWidth,swlHeight){var _this$props=_this.props,contextAggregationInterval=_this$props.contextAggregationInterval,swimlaneData=_this$props.swimlaneData;var data=swimlaneData;if(typeof data==="undefined"){return}var xAxisDomain=_this.calculateContextXAxisDomain();var x=_d.default.time.scale().range([0,swlWidth]).domain(xAxisDomain);var y=_d.default.scale.linear().range([swlHeight,0]).domain([0,swlHeight]);var xAxis=_d.default.svg.axis().scale(x).orient("bottom").innerTickSize(-swlHeight).outerTickSize(0);var yAxis=_d.default.svg.axis().scale(y).orient("left").tickValues(y.domain()).innerTickSize(-swlWidth).outerTickSize(0);var axes=swlGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0,"+swlHeight+")").call(xAxis);axes.append("g").attr("class","y axis").call(yAxis);var earliest=xAxisDomain[0].getTime();var latest=xAxisDomain[1].getTime();var swimlaneAggMs=contextAggregationInterval.asMilliseconds();var cellWidth=swlWidth/((latest-earliest)/swimlaneAggMs);if(cellWidth<1){cellWidth=1}var cells=swlGroup.append("g").attr("class","swimlane-cells").selectAll("rect").data(data);cells.enter().append("rect").attr("x",(function(d){return x(d.date)})).attr("y",0).attr("rx",0).attr("ry",0).attr("class",(function(d){return d.score>0?"swimlane-cell":"swimlane-cell-hidden"})).attr("width",cellWidth).attr("height",swlHeight).style("fill",(function(d){return anomalyColorScale(d.score)}))}));_defineProperty(_assertThisInitialized(_this),"calculateContextXAxisDomain",(function(){var _this$props2=_this.props,bounds=_this$props2.bounds,contextAggregationInterval=_this$props2.contextAggregationInterval,swimlaneData=_this$props2.swimlaneData;var earliest=bounds.min.valueOf();if(swimlaneData!==undefined&&swimlaneData.length>0){earliest=Math.min(_lodash.default.first(swimlaneData).date.getTime(),bounds.min.valueOf())}var contextAggMs=contextAggregationInterval.asMilliseconds();var earliestMs=Math.floor(earliest/contextAggMs)*contextAggMs;var latestMs=Math.ceil(bounds.max.valueOf()/contextAggMs)*contextAggMs;return[new Date(earliestMs),new Date(latestMs)]}));_defineProperty(_assertThisInitialized(_this),"setContextBrushExtent",(function(from,to){var brush=_this.brush;var brushExtent=brush.extent();var newExtent=[from,to];brush.extent(newExtent);brush(_d.default.select(".brush"));if(newExtent[0].getTime()!==brushExtent[0].getTime()||newExtent[1].getTime()!==brushExtent[1].getTime()){brush.event(_d.default.select(".brush"))}}));return _this}_createClass(TimeseriesChartIntl,[{key:"componentWillUnmount",value:function componentWillUnmount(){var element=_d.default.select(this.rootNode);element.html("");if(this.rowMouseenterSubscriber!==null){this.rowMouseenterSubscriber.unsubscribe()}if(this.rowMouseleaveSubscriber!==null){this.rowMouseleaveSubscriber.unsubscribe()}}},{key:"componentDidMount",value:function componentDidMount(){var svgWidth=this.props.svgWidth;this.vizWidth=svgWidth-margin.left-margin.right;var vizWidth=this.vizWidth;this.focusXScale=_d.default.time.scale().range([0,vizWidth]);this.focusYScale=_d.default.scale.linear().range([focusHeight,focusZoomPanelHeight]);var focusXScale=this.focusXScale;var focusYScale=this.focusYScale;this.focusXAxis=_d.default.svg.axis().scale(focusXScale).orient("bottom").innerTickSize(-focusChartHeight).outerTickSize(0).tickPadding(10);this.focusYAxis=_d.default.svg.axis().scale(focusYScale).orient("left").innerTickSize(-vizWidth).outerTickSize(0).tickPadding(10);this.focusValuesLine=_d.default.svg.line().x((function(d){return focusXScale(d.date)})).y((function(d){return focusYScale(d.value)})).defined((function(d){return d.value!==null}));this.focusBoundedArea=_d.default.svg.area().x((function(d){return focusXScale(d.date)||1})).y0((function(d){return focusYScale(d.upper)})).y1((function(d){return focusYScale(d.lower)})).defined((function(d){return d.lower!==null&&d.upper!==null}));this.contextXScale=_d.default.time.scale().range([0,vizWidth]);this.contextYScale=_d.default.scale.linear().range([contextChartHeight,contextChartLineTopMargin]);this.fieldFormat=undefined;this.annotateBrush=_timeseries_chart_annotations.getAnnotationBrush.call(this);this.brush=_d.default.svg.brush();this.mask=undefined;var highlightFocusChartAnomaly=this.highlightFocusChartAnomaly.bind(this);var boundHighlightFocusChartAnnotation=_timeseries_chart_annotations.highlightFocusChartAnnotation.bind(this);function tableRecordMousenterListener(_ref){var record=_ref.record,_ref$type=_ref.type,type=_ref$type===void 0?"anomaly":_ref$type;if(type==="anomaly"){highlightFocusChartAnomaly(record)}else if(type==="annotation"){boundHighlightFocusChartAnnotation(record)}}var unhighlightFocusChartAnomaly=this.unhighlightFocusChartAnomaly.bind(this);var boundUnhighlightFocusChartAnnotation=_timeseries_chart_annotations.unhighlightFocusChartAnnotation.bind(this);function tableRecordMouseleaveListener(_ref2){var record=_ref2.record,_ref2$type=_ref2.type,type=_ref2$type===void 0?"anomaly":_ref2$type;if(type==="anomaly"){unhighlightFocusChartAnomaly(record)}else{boundUnhighlightFocusChartAnnotation(record)}}this.rowMouseenterSubscriber=_table_service.mlTableService.rowMouseenter$.subscribe(tableRecordMousenterListener);this.rowMouseleaveSubscriber=_table_service.mlTableService.rowMouseleave$.subscribe(tableRecordMouseleaveListener);this.renderChart();this.drawContextChartSelection();this.renderFocusChart()}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){if(this.props.renderFocusChartOnly===false||prevProps.svgWidth!==this.props.svgWidth){this.renderChart();this.drawContextChartSelection()}this.renderFocusChart();if(this.props.annotation===null){var chartElement=_d.default.select(this.rootNode);chartElement.select("g.mlAnnotationBrush").call(this.annotateBrush.extent([0,0]))}}},{key:"renderChart",value:function renderChart(){var _this$props3=this.props,contextChartData=_this$props3.contextChartData,contextForecastData=_this$props3.contextForecastData,detectorIndex=_this$props3.detectorIndex,modelPlotEnabled=_this$props3.modelPlotEnabled,selectedJob=_this$props3.selectedJob,svgWidth=_this$props3.svgWidth;var createFocusChart=this.createFocusChart.bind(this);var drawContextElements=this.drawContextElements.bind(this);var focusXScale=this.focusXScale;var focusYAxis=this.focusYAxis;var focusYScale=this.focusYScale;var svgHeight=getSvgHeight();var chartElement=_d.default.select(this.rootNode);chartElement.selectAll("*").remove();if(typeof selectedJob!=="undefined"){this.fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormat(selectedJob.job_id,detectorIndex)}else{return}if(contextChartData===undefined){return}var fieldFormat=this.fieldFormat;var svg=chartElement.append("svg").attr("width",svgWidth).attr("height",svgHeight);var contextDataMin;var contextDataMax;if(modelPlotEnabled===true||contextForecastData!==undefined&&contextForecastData.length>0){var combinedData=contextForecastData===undefined?contextChartData:contextChartData.concat(contextForecastData);contextDataMin=_d.default.min(combinedData,(function(d){return Math.min(d.value,d.lower)}));contextDataMax=_d.default.max(combinedData,(function(d){return Math.max(d.value,d.upper)}))}else{contextDataMin=_d.default.min(contextChartData,(function(d){return d.value}));contextDataMax=_d.default.max(contextChartData,(function(d){return d.value}))}var ceiledMax=contextDataMax>0?Math.pow(10,Math.ceil(Math.log10(Math.abs(contextDataMax)))):contextDataMax;var flooredMin=contextDataMin>=0?contextDataMin:-1*Math.pow(10,Math.ceil(Math.log10(Math.abs(contextDataMin))));focusYScale.domain([flooredMin,ceiledMax]);var maxYAxisLabelWidth=0;var tempLabelText=svg.append("g").attr("class","temp-axis-label tick");tempLabelText.selectAll("text.temp.axis").data(focusYScale.ticks()).enter().append("text").text((function(d){if(fieldFormat!==undefined){return fieldFormat.convert(d,"text")}else{return focusYScale.tickFormat()(d)}})).each((function(){maxYAxisLabelWidth=Math.max(this.getBBox().width+focusYAxis.tickPadding(),maxYAxisLabelWidth)})).remove();_d.default.select(".temp-axis-label").remove();margin.left=Math.max(maxYAxisLabelWidth,40);this.vizWidth=Math.max(svgWidth-margin.left-margin.right,0);focusXScale.range([0,this.vizWidth]);focusYAxis.innerTickSize(-this.vizWidth);var focus=svg.append("g").attr("class","focus-chart").attr("transform","translate("+margin.left+","+margin.top+")");var context=svg.append("g").attr("class","context-chart").attr("transform","translate("+margin.left+","+(focusHeight+margin.top+chartSpacing)+")");var annotationsMask=svg.append("defs").append("mask").attr("id",_timeseries_chart_annotations.ANNOTATION_MASK_ID);annotationsMask.append("rect").attr("x",0).attr("y",0).attr("width",this.vizWidth).attr("height",focusHeight).style("fill","white");createFocusChart(focus,this.vizWidth,focusHeight);drawContextElements(context,this.vizWidth,contextChartHeight,swimlaneHeight)}},{key:"drawContextChartSelection",value:function drawContextChartSelection(){var _this$props4=this.props,contextChartData=_this$props4.contextChartData,contextChartSelected=_this$props4.contextChartSelected,contextForecastData=_this$props4.contextForecastData,zoomFrom=_this$props4.zoomFrom,zoomTo=_this$props4.zoomTo;if(contextChartData===undefined){return}var focusLoadFrom;var focusLoadTo;var contextXMin=this.contextXScale.domain()[0].getTime();var contextXMax=this.contextXScale.domain()[1].getTime();var combinedData=contextChartData;if(contextForecastData!==undefined){combinedData=combinedData.concat(contextForecastData)}if(zoomFrom){focusLoadFrom=zoomFrom.getTime()}else{focusLoadFrom=_lodash.default.reduce(combinedData,(function(memo,point){return Math.min(memo,point.date.getTime())}),new Date(2099,12,31).getTime())}focusLoadFrom=Math.max(focusLoadFrom,contextXMin);if(zoomTo){focusLoadTo=zoomTo.getTime()}else{focusLoadTo=_lodash.default.reduce(combinedData,(function(memo,point){return Math.max(memo,point.date.getTime())}),0)}focusLoadTo=Math.min(focusLoadTo,contextXMax);if(focusLoadFrom!==contextXMin||focusLoadTo!==contextXMax){this.setContextBrushExtent(new Date(focusLoadFrom),new Date(focusLoadTo));var newSelectedBounds={min:(0,_moment.default)(new Date(focusLoadFrom)),max:(0,_moment.default)(focusLoadFrom)};this.selectedBounds=newSelectedBounds}else{var contextXScaleDomain=this.contextXScale.domain();var _newSelectedBounds={min:(0,_moment.default)(new Date(contextXScaleDomain[0])),max:(0,_moment.default)(contextXScaleDomain[1])};if(!_lodash.default.isEqual(_newSelectedBounds,this.selectedBounds)){this.selectedBounds=_newSelectedBounds;this.setContextBrushExtent(new Date(contextXScaleDomain[0]),new Date(contextXScaleDomain[1]));if(this.contextChartInitialized===false){this.contextChartInitialized=true;contextChartSelected({from:contextXScaleDomain[0],to:contextXScaleDomain[1]})}}}}},{key:"createFocusChart",value:function createFocusChart(fcsGroup,fcsWidth,fcsHeight){var contextForecastData=this.props.contextForecastData;var zoomGroup=fcsGroup.append("g").attr("class","focus-zoom");zoomGroup.append("rect").attr("x",0).attr("y",0).attr("width",fcsWidth).attr("height",focusZoomPanelHeight).attr("class","chart-border");this.createZoomInfoElements(zoomGroup,fcsWidth);var annotateBrush=this.annotateBrush.bind(this);var brushX=0;var brushWidth=0;if(this.props.annotation!==null){brushX=this.focusXScale(this.props.annotation.timestamp);brushWidth=(0,_timeseries_chart_annotations.getAnnotationWidth)(this.props.annotation,this.focusXScale)}fcsGroup.append("g").attr("class","mlAnnotationBrush").call(annotateBrush).selectAll("rect").attr("x",brushX).attr("y",focusZoomPanelHeight).attr("width",brushWidth).attr("height",focusChartHeight);fcsGroup.append("g").classed("mlAnnotations",true);fcsGroup.append("rect").attr("x",0).attr("y",focusZoomPanelHeight).attr("width",fcsWidth).attr("height",focusChartHeight).attr("class","chart-border");var xAxisBg=fcsGroup.append("g").attr("class","x-axis-background");xAxisBg.append("rect").attr("x",0).attr("y",fcsHeight).attr("width",fcsWidth).attr("height",chartSpacing);xAxisBg.append("line").attr("x1",0).attr("y1",fcsHeight).attr("x2",0).attr("y2",fcsHeight+chartSpacing);xAxisBg.append("line").attr("x1",fcsWidth).attr("y1",fcsHeight).attr("x2",fcsWidth).attr("y2",fcsHeight+chartSpacing);xAxisBg.append("line").attr("x1",0).attr("y1",fcsHeight+chartSpacing).attr("x2",fcsWidth).attr("y2",fcsHeight+chartSpacing);var axes=fcsGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0,"+fcsHeight+")");axes.append("g").attr("class","y axis");fcsGroup.append("path").attr("class","area bounds");fcsGroup.append("path").attr("class","values-line");fcsGroup.append("g").attr("class","focus-chart-markers");if(contextForecastData){fcsGroup.append("path").attr("class","area forecast");fcsGroup.append("path").attr("class","values-line forecast");fcsGroup.append("g").attr("class","focus-chart-markers forecast")}fcsGroup.append("rect").attr("x",0).attr("y",0).attr("width",fcsWidth).attr("height",fcsHeight+24).attr("class","chart-border chart-border-highlight")}},{key:"renderFocusChart",value:function renderFocusChart(){var _this2=this;var _this$props5=this.props,focusAggregationInterval=_this$props5.focusAggregationInterval,focusAnnotationData=_this$props5.focusAnnotationData,focusChartData=_this$props5.focusChartData,focusForecastData=_this$props5.focusForecastData,modelPlotEnabled=_this$props5.modelPlotEnabled,selectedJob=_this$props5.selectedJob,showAnnotations=_this$props5.showAnnotations,showForecast=_this$props5.showForecast,showModelBounds=_this$props5.showModelBounds,zoomFromFocusLoaded=_this$props5.zoomFromFocusLoaded,zoomToFocusLoaded=_this$props5.zoomToFocusLoaded;if(focusChartData===undefined){return}var data=focusChartData;var contextYScale=this.contextYScale;var showFocusChartTooltip=this.showFocusChartTooltip.bind(this);var focusChart=_d.default.select(".focus-chart");var focusAggInt=focusAggregationInterval.expression;var bucketSpan=selectedJob.analysis_config.bucket_span;var chartElement=_d.default.select(this.rootNode);chartElement.select(".zoom-aggregation-interval").text(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomAggregationIntervalLabel",{defaultMessage:"(aggregation interval: {focusAggInt}, bucket span: {bucketSpan})",values:{focusAggInt:focusAggInt,bucketSpan:bucketSpan}}));if(zoomFromFocusLoaded===undefined||zoomToFocusLoaded===undefined){return}var bounds={min:(0,_moment.default)(zoomFromFocusLoaded.getTime()),max:(0,_moment.default)(zoomToFocusLoaded.getTime())};var aggMs=focusAggregationInterval.asMilliseconds();var earliest=(0,_moment.default)(Math.floor(bounds.min.valueOf()/aggMs)*aggMs);var latest=(0,_moment.default)(Math.ceil(bounds.max.valueOf()/aggMs)*aggMs);this.focusXScale.domain([earliest.toDate(),latest.toDate()]);if(focusChartData.length>0||focusForecastData!==undefined&&focusForecastData.length>0){if(this.fieldFormat!==undefined){this.focusYAxis.tickFormat((function(d){return _this2.fieldFormat.convert(d,"text")}))}else{this.focusYAxis.tickFormat(null)}var yMin=0;var yMax=0;var combinedData=data;if(focusForecastData!==undefined&&focusForecastData.length>0){combinedData=data.concat(focusForecastData)}yMin=_d.default.min(combinedData,(function(d){var metricValue=d.value;if(metricValue===null&&d.anomalyScore!==undefined&&d.actual!==undefined){metricValue=Array.isArray(d.actual)?d.actual[0]:d.actual}if(d.lower!==undefined){if(metricValue!==null&&metricValue!==undefined){return Math.min(metricValue,d.lower)}else{return d.lower}}return metricValue}));yMax=_d.default.max(combinedData,(function(d){var metricValue=d.value;if(metricValue===null&&d.anomalyScore!==undefined&&d.actual!==undefined){metricValue=Array.isArray(d.actual)?d.actual[0]:d.actual}return d.upper!==undefined?Math.max(metricValue,d.upper):metricValue}));if(yMax===yMin){if(this.contextYScale.domain()[0]!==contextYScale.domain()[1]&&yMin>=contextYScale.domain()[0]&&yMax<=contextYScale.domain()[1]){yMin=contextYScale.domain()[0];yMax=contextYScale.domain()[1]}else{yMin-=yMin*.05;yMax+=yMax*.05}}if(focusAnnotationData&&focusAnnotationData.length>0){var levels=(0,_timeseries_chart_annotations.getAnnotationLevels)(focusAnnotationData);var maxLevel=_d.default.max(Object.keys(levels).map((function(key){return levels[key]})));yMax=yMax*(1+(maxLevel+1)/5)}this.focusYScale.domain([yMin,yMax])}else{this.focusYScale.domain([0,10]);this.focusYAxis.tickFormat("")}var timeBuckets=new _time_buckets.TimeBuckets;timeBuckets.setInterval("auto");timeBuckets.setBounds(bounds);var xAxisTickFormat=timeBuckets.getScaledDateFormat();focusChart.select(".x.axis").call(this.focusXAxis.ticks((0,_chart_utils.numTicksForDateFormat)(this.vizWidth),xAxisTickFormat).tickFormat((function(d){return(0,_moment.default)(d).format(xAxisTickFormat)})));focusChart.select(".y.axis").call(this.focusYAxis);(0,_chart_utils.filterAxisLabels)(focusChart.select(".x.axis"),this.vizWidth);if(modelPlotEnabled===true){focusChart.select(".area.bounds").attr("d",this.focusBoundedArea(data)).classed("hidden",!showModelBounds)}(0,_timeseries_chart_annotations.renderAnnotations)(focusChart,focusAnnotationData,focusZoomPanelHeight,focusChartHeight,this.focusXScale,showAnnotations,showFocusChartTooltip);focusChart.select(".mlAnnotationBrush").style("display",showAnnotations?null:"none");focusChart.select(".values-line").attr("d",this.focusValuesLine(data));(0,_chart_utils.drawLineChartDots)(data,focusChart,this.focusValuesLine);var dots=_d.default.select(".focus-chart-markers").selectAll(".metric-value").data(data.filter((function(d){return(d.value!==null||typeof d.anomalyScore==="number")&&!(0,_chart_utils.showMultiBucketAnomalyMarker)(d)})));dots.exit().remove();dots.enter().append("circle").attr("r",_chart_utils.LINE_CHART_ANOMALY_RADIUS).on("mouseover",(function(d){showFocusChartTooltip(d,this)})).on("mouseout",(function(){return _chart_tooltip_service.mlChartTooltipService.hide()}));dots.attr("cx",(function(d){return _this2.focusXScale(d.date)})).attr("cy",(function(d){return _this2.focusYScale(d.value)})).attr("class",(function(d){var markerClass="metric-value";if(_lodash.default.has(d,"anomalyScore")){markerClass+=" anomaly-marker ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id)}return markerClass}));var multiBucketMarkers=_d.default.select(".focus-chart-markers").selectAll(".multi-bucket").data(data.filter((function(d){return d.anomalyScore!==null&&(0,_chart_utils.showMultiBucketAnomalyMarker)(d)===true})));multiBucketMarkers.exit().remove();multiBucketMarkers.enter().append("path").attr("d",_d.default.svg.symbol().size(_chart_utils.MULTI_BUCKET_SYMBOL_SIZE).type("cross")).on("mouseover",(function(d){showFocusChartTooltip(d,this)})).on("mouseout",(function(){return _chart_tooltip_service.mlChartTooltipService.hide()}));multiBucketMarkers.attr("transform",(function(d){return"translate(".concat(_this2.focusXScale(d.date),", ").concat(_this2.focusYScale(d.value),")")})).attr("class",(function(d){return"anomaly-marker multi-bucket ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id)}));var scheduledEventMarkers=_d.default.select(".focus-chart-markers").selectAll(".scheduled-event-marker").data(data.filter((function(d){return d.scheduledEvents!==undefined})));scheduledEventMarkers.exit().remove();scheduledEventMarkers.enter().append("rect").attr("width",_chart_utils.LINE_CHART_ANOMALY_RADIUS*2).attr("height",_chart_utils.SCHEDULED_EVENT_SYMBOL_HEIGHT).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1);scheduledEventMarkers.attr("x",(function(d){return _this2.focusXScale(d.date)-_chart_utils.LINE_CHART_ANOMALY_RADIUS})).attr("y",(function(d){return _this2.focusYScale(d.value)-3}));if(focusForecastData!==undefined){focusChart.select(".area.forecast").attr("d",this.focusBoundedArea(focusForecastData)).classed("hidden",!showForecast);focusChart.select(".values-line.forecast").attr("d",this.focusValuesLine(focusForecastData)).classed("hidden",!showForecast);var forecastDots=_d.default.select(".focus-chart-markers.forecast").selectAll(".metric-value").data(focusForecastData);forecastDots.exit().remove();forecastDots.enter().append("circle").attr("r",_chart_utils.LINE_CHART_ANOMALY_RADIUS).on("mouseover",(function(d){showFocusChartTooltip(d,this)})).on("mouseout",(function(){return _chart_tooltip_service.mlChartTooltipService.hide()}));forecastDots.attr("cx",(function(d){return _this2.focusXScale(d.date)})).attr("cy",(function(d){return _this2.focusYScale(d.value)})).attr("class","metric-value").classed("hidden",!showForecast)}}},{key:"createZoomInfoElements",value:function createZoomInfoElements(zoomGroup,fcsWidth){var _this$props6=this.props,autoZoomDuration=_this$props6.autoZoomDuration,bounds=_this$props6.bounds,modelPlotEnabled=_this$props6.modelPlotEnabled;var setZoomInterval=this.setZoomInterval.bind(this);var boundsSecs=bounds.max.unix()-bounds.min.unix();var minSecs=10/this.vizWidth*boundsSecs;var xPos=10;var zoomLabel=zoomGroup.append("text").attr("x",xPos).attr("y",17).attr("class","zoom-info-text").text(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomLabel",{defaultMessage:"Zoom:"}));var zoomOptions=[{durationMs:autoZoomDuration,label:"auto"}];_lodash.default.each(ZOOM_INTERVAL_OPTIONS,(function(option){if(option.duration.asSeconds()>minSecs&&option.duration.asSeconds()<boundsSecs){zoomOptions.push({durationMs:option.duration.asMilliseconds(),label:option.label})}}));xPos+=zoomLabel.node().getBBox().width+4;_lodash.default.each(zoomOptions,(function(option){var text=zoomGroup.append("a").attr("data-ms",option.durationMs).attr("href","").append("text").attr("x",xPos).attr("y",17).attr("class","zoom-info-text").text(option.label);xPos+=text.node().getBBox().width+4}));zoomGroup.append("text").attr("x",xPos+6).attr("y",17).attr("class","zoom-info-text zoom-aggregation-interval").text(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomGroupAggregationIntervalLabel",{defaultMessage:"(aggregation interval: , bucket span: )"}));if(modelPlotEnabled===false){var modelPlotLabel=zoomGroup.append("text").attr("x",300).attr("y",17).attr("class","zoom-info-text").text(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelBoundsNotAvailableLabel",{defaultMessage:"Model bounds are not available"}));modelPlotLabel.attr("x",fcsWidth-(modelPlotLabel.node().getBBox().width+10))}var chartElement=_d.default.select(this.rootNode);chartElement.selectAll(".focus-zoom a").on("click",(function(){_d.default.event.preventDefault();setZoomInterval(_d.default.select(this).attr("data-ms"))}))}},{key:"drawContextElements",value:function drawContextElements(cxtGroup,cxtWidth,cxtChartHeight,swlHeight){var _this3=this;var _this$props7=this.props,bounds=_this$props7.bounds,contextChartData=_this$props7.contextChartData,contextForecastData=_this$props7.contextForecastData,modelPlotEnabled=_this$props7.modelPlotEnabled;var data=contextChartData;this.contextXScale=_d.default.time.scale().range([0,cxtWidth]).domain(this.calculateContextXAxisDomain());var combinedData=contextForecastData===undefined?data:data.concat(contextForecastData);var valuesRange={min:Number.MAX_VALUE,max:Number.MIN_VALUE};_lodash.default.each(combinedData,(function(item){valuesRange.min=Math.min(item.value,valuesRange.min);valuesRange.max=Math.max(item.value,valuesRange.max)}));var dataMin=valuesRange.min;var dataMax=valuesRange.max;var chartLimits={min:dataMin,max:dataMax};if(modelPlotEnabled===true||contextForecastData!==undefined&&contextForecastData.length>0){var boundsRange={min:Number.MAX_VALUE,max:Number.MIN_VALUE};_lodash.default.each(combinedData,(function(item){boundsRange.min=Math.min(item.lower,boundsRange.min);boundsRange.max=Math.max(item.upper,boundsRange.max)}));dataMin=Math.min(dataMin,boundsRange.min);dataMax=Math.max(dataMax,boundsRange.max);if(valuesRange.max-valuesRange.min<.5*(dataMax-dataMin)){if(valuesRange.min>dataMin){chartLimits.min=valuesRange.min-.5*(valuesRange.max-valuesRange.min)}if(valuesRange.max<dataMax){chartLimits.max=valuesRange.max+.5*(valuesRange.max-valuesRange.min)}}}this.contextYScale=_d.default.scale.linear().range([cxtChartHeight,contextChartLineTopMargin]).domain([chartLimits.min,chartLimits.max]);var borders=cxtGroup.append("g").attr("class","axis");borders.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",cxtChartHeight+swlHeight);borders.append("line").attr("x1",cxtWidth).attr("y1",0).attr("x2",cxtWidth).attr("y2",cxtChartHeight+swlHeight);var timeBuckets=new _time_buckets.TimeBuckets;timeBuckets.setInterval("auto");timeBuckets.setBounds(bounds);var xAxisTickFormat=timeBuckets.getScaledDateFormat();var xAxis=_d.default.svg.axis().scale(this.contextXScale).orient("top").innerTickSize(-cxtChartHeight).outerTickSize(0).tickPadding(0).ticks((0,_chart_utils.numTicksForDateFormat)(cxtWidth,xAxisTickFormat)).tickFormat((function(d){return(0,_moment.default)(d).format(xAxisTickFormat)}));cxtGroup.datum(data);var contextBoundsArea=_d.default.svg.area().x((function(d){return _this3.contextXScale(d.date)})).y0((function(d){return _this3.contextYScale(Math.min(chartLimits.max,Math.max(d.lower,chartLimits.min)))})).y1((function(d){return _this3.contextYScale(Math.max(chartLimits.min,Math.min(d.upper,chartLimits.max)))})).defined((function(d){return d.lower!==null&&d.upper!==null}));if(modelPlotEnabled===true){cxtGroup.append("path").datum(data).attr("class","area context").attr("d",contextBoundsArea)}var contextValuesLine=_d.default.svg.line().x((function(d){return _this3.contextXScale(d.date)})).y((function(d){return _this3.contextYScale(d.value)})).defined((function(d){return d.value!==null}));cxtGroup.append("path").datum(data).attr("class","values-line").attr("d",contextValuesLine);(0,_chart_utils.drawLineChartDots)(data,cxtGroup,contextValuesLine,1);if(contextForecastData!==undefined){cxtGroup.append("path").datum(contextForecastData).attr("class","area forecast").attr("d",contextBoundsArea);cxtGroup.append("path").datum(contextForecastData).attr("class","values-line forecast").attr("d",contextValuesLine)}var swimlane=cxtGroup.append("g").attr("class","swimlane").attr("transform","translate(0,"+cxtChartHeight+")");this.drawSwimlane(swimlane,cxtWidth,swlHeight);this.mask=new _context_chart_mask.ContextChartMask(cxtGroup,contextChartData,modelPlotEnabled,swlHeight).x(this.contextXScale).y(this.contextYScale);cxtGroup.append("g").attr("class","x axis context-chart-axis").call(xAxis);cxtGroup.selectAll(".x.context-chart-axis text").attr("dy",cxtChartHeight-5);(0,_chart_utils.filterAxisLabels)(cxtGroup.selectAll(".x.context-chart-axis"),cxtWidth);this.drawContextBrush(cxtGroup)}},{key:"setZoomInterval",value:function setZoomInterval(ms){var _this$props8=this.props,bounds=_this$props8.bounds,zoomTo=_this$props8.zoomTo;var minBoundsMs=bounds.min.valueOf();var maxBoundsMs=bounds.max.valueOf();var millis=+ms;var to=zoomTo.getTime();var from=to-millis;if(from<minBoundsMs){from=minBoundsMs;to=Math.min(minBoundsMs+millis,maxBoundsMs)}this.setContextBrushExtent(new Date(from),new Date(to))}},{key:"showFocusChartTooltip",value:function showFocusChartTooltip(marker,circle){var modelPlotEnabled=this.props.modelPlotEnabled;var fieldFormat=this.fieldFormat;var seriesKey="single_metric_viewer";var formattedDate=(0,_date_utils.formatHumanReadableDateTimeSeconds)(marker.date);var tooltipData=[{label:formattedDate}];if(_lodash.default.has(marker,"anomalyScore")){var score=parseInt(marker.anomalyScore);var displayScore=score>0?score:"< 1";tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.anomalyScoreLabel",{defaultMessage:"anomaly score"}),value:displayScore,color:anomalyColorScale(score),seriesIdentifier:{key:seriesKey},valueAccessor:"anomaly_score"});if((0,_chart_utils.showMultiBucketAnomalyTooltip)(marker)===true){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.multiBucketImpactLabel",{defaultMessage:"multi-bucket impact"}),value:(0,_anomaly_utils.getMultiBucketImpactLabel)(marker.multiBucketImpact),seriesIdentifier:{key:seriesKey},valueAccessor:"multi_bucket_impact"})}if(modelPlotEnabled===false){if(_lodash.default.has(marker,"actual")&&marker.function!=="rare"){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.actualLabel",{defaultMessage:"actual"}),value:(0,_format_value.formatValue)(marker.actual,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"actual"});tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.typicalLabel",{defaultMessage:"typical"}),value:(0,_format_value.formatValue)(marker.typical,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"typical"})}else{tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.valueLabel",{defaultMessage:"value"}),value:(0,_format_value.formatValue)(marker.value,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"});if(_lodash.default.has(marker,"byFieldName")&&_lodash.default.has(marker,"numberOfCauses")){var numberOfCauses=marker.numberOfCauses;var byFieldName=(0,_string_utils.mlEscape)(marker.byFieldName);tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.moreThanOneUnusualByFieldValuesLabel",{defaultMessage:"{numberOfCauses}{plusSign} unusual {byFieldName} values",values:{numberOfCauses:numberOfCauses,byFieldName:byFieldName,plusSign:numberOfCauses<10?"":"+"}}),seriesIdentifier:{key:seriesKey},valueAccessor:"numberOfCauses"})}}}else{tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.actualLabel",{defaultMessage:"actual"}),value:(0,_format_value.formatValue)(marker.actual,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"actual"});tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.upperBoundsLabel",{defaultMessage:"upper bounds"}),value:(0,_format_value.formatValue)(marker.upper,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"upper_bounds"});tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.lowerBoundsLabel",{defaultMessage:"lower bounds"}),value:(0,_format_value.formatValue)(marker.lower,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"lower_bounds"})}}else{if(_lodash.default.get(marker,"isForecast",false)===true){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.predictionLabel",{defaultMessage:"prediction"}),value:(0,_format_value.formatValue)(marker.value,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"prediction"})}else{tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.valueLabel",{defaultMessage:"value"}),value:(0,_format_value.formatValue)(marker.value,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"})}if(modelPlotEnabled===true){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.upperBoundsLabel",{defaultMessage:"upper bounds"}),value:(0,_format_value.formatValue)(marker.upper,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"upper_bounds"});tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.lowerBoundsLabel",{defaultMessage:"lower bounds"}),value:(0,_format_value.formatValue)(marker.lower,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"lower_bounds"})}}if(_lodash.default.has(marker,"scheduledEvents")){marker.scheduledEvents.forEach((function(scheduledEvent,i){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.scheduledEventsLabel",{defaultMessage:"scheduled event{counter}",values:{counter:marker.scheduledEvents.length>1?" #".concat(i+1):""}}),value:scheduledEvent,seriesIdentifier:{key:seriesKey},valueAccessor:"scheduled_events_".concat(i+1)})}))}if(_lodash.default.has(marker,"annotation")){tooltipData.length=0;tooltipData.push({label:marker.annotation});var timespan=(0,_moment.default)(marker.timestamp).format("MMMM Do YYYY, HH:mm");if(typeof marker.end_timestamp!=="undefined"){timespan+=" - ".concat((0,_moment.default)(marker.end_timestamp).format("MMMM Do YYYY, HH:mm"))}tooltipData.push({label:timespan,seriesIdentifier:{key:seriesKey},valueAccessor:"timespan"})}var xOffset=_chart_utils.LINE_CHART_ANOMALY_RADIUS*2;if(circle.tagName.toLowerCase()==="rect"){var x=Number(circle.getAttribute("x"));if(x<0){xOffset=Math.abs(x)}}_chart_tooltip_service.mlChartTooltipService.show(tooltipData,circle,{x:xOffset,y:0})}},{key:"highlightFocusChartAnomaly",value:function highlightFocusChartAnomaly(record){var _this$props9=this.props,focusChartData=_this$props9.focusChartData,focusAggregationInterval=_this$props9.focusAggregationInterval;var focusXScale=this.focusXScale;var focusYScale=this.focusYScale;var showFocusChartTooltip=this.showFocusChartTooltip.bind(this);var anomalyTime=record.source.timestamp;var markerToSelect=(0,_timeseriesexplorer_utils.findChartPointForAnomalyTime)(focusChartData,anomalyTime,focusAggregationInterval);if(markerToSelect!==undefined){var selectedMarker=_d.default.select(".focus-chart-markers").selectAll(".focus-chart-highlighted-marker").data([markerToSelect]);if((0,_chart_utils.showMultiBucketAnomalyMarker)(markerToSelect)===true){selectedMarker.enter().append("path").attr("d",_d.default.svg.symbol().size(_chart_utils.MULTI_BUCKET_SYMBOL_SIZE).type("cross")).attr("transform",(function(d){return"translate(".concat(focusXScale(d.date),", ").concat(focusYScale(d.value),")")})).attr("class",(function(d){return"anomaly-marker multi-bucket ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id," highlighted")}))}else{selectedMarker.enter().append("circle").attr("r",_chart_utils.LINE_CHART_ANOMALY_RADIUS).attr("cx",(function(d){return focusXScale(d.date)})).attr("cy",(function(d){return focusYScale(d.value)})).attr("class",(function(d){return"anomaly-marker metric-value ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id," highlighted")}))}var chartElement=_d.default.select(this.rootNode);var anomalyMarker=chartElement.selectAll(".focus-chart-markers .anomaly-marker.highlighted");if(anomalyMarker.length){showFocusChartTooltip(markerToSelect,anomalyMarker[0][0])}}}},{key:"unhighlightFocusChartAnomaly",value:function unhighlightFocusChartAnomaly(){_d.default.select(".focus-chart-markers").selectAll(".anomaly-marker.highlighted").remove();_chart_tooltip_service.mlChartTooltipService.hide()}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(){return true}},{key:"setRef",value:function setRef(componentNode){this.rootNode=componentNode}},{key:"render",value:function render(){return _react.default.createElement("div",{className:"ml-timeseries-chart-react",ref:this.setRef.bind(this)})}}]);return TimeseriesChartIntl}(_react.Component);_defineProperty(TimeseriesChartIntl,"propTypes",{annotation:_propTypes.default.object,autoZoomDuration:_propTypes.default.number,bounds:_propTypes.default.object,contextAggregationInterval:_propTypes.default.object,contextChartData:_propTypes.default.array,contextForecastData:_propTypes.default.array,contextChartSelected:_propTypes.default.func.isRequired,detectorIndex:_propTypes.default.number,focusAggregationInterval:_propTypes.default.object,focusAnnotationData:_propTypes.default.array,focusChartData:_propTypes.default.array,focusForecastData:_propTypes.default.array,modelPlotEnabled:_propTypes.default.bool.isRequired,renderFocusChartOnly:_propTypes.default.bool.isRequired,selectedJob:_propTypes.default.object,showForecast:_propTypes.default.bool.isRequired,showModelBounds:_propTypes.default.bool.isRequired,svgWidth:_propTypes.default.number.isRequired,swimlaneData:_propTypes.default.array,zoomFrom:_propTypes.default.object,zoomTo:_propTypes.default.object,zoomFromFocusLoaded:_propTypes.default.object,zoomToFocusLoaded:_propTypes.default.object});var TimeseriesChart=function TimeseriesChart(props){var annotationProp=(0,_useObservable.default)(_annotations_service.annotation$);if(annotationProp===undefined){return null}return _react.default.createElement(TimeseriesChartIntl,_extends({annotation:annotationProp},props))};exports.TimeseriesChart=TimeseriesChart},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ContextChartMask",{enumerable:true,get:function get(){return _context_chart_mask.ContextChartMask}});var _context_chart_mask=__webpack_require__(1682)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ContextChartMask=ContextChartMask;var _d=_interopRequireDefault(__webpack_require__(97));var _chart_utils=__webpack_require__(135);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ContextChartMask(contextGroup,data,drawBounds,swimlaneHeight){this.contextGroup=contextGroup;this.data=data;this.drawBounds=drawBounds;this.swimlaneHeight=swimlaneHeight;this.mask=this.contextGroup.append("g").attr("class","mask");this.leftGroup=this.mask.append("g").attr("class","left-mask");this.rightGroup=this.mask.append("g").attr("class","right-mask");this.leftPolygon=this.leftGroup.append("polygon");this.rightPolygon=this.rightGroup.append("polygon");if(this.drawBounds===true){this.leftGroup.append("path").attr("class","left area bounds");this.rightGroup.append("path").attr("class","right area bounds")}this.leftGroup.append("path").attr("class","left values-line");this.rightGroup.append("path").attr("class","right values-line");this._x=null;this._y=null}ContextChartMask.prototype.style=function(prop,val){this.leftGroup.style(prop,val);this.rightGroup.style(prop,val);return this};ContextChartMask.prototype.x=function(f){if(f==null){return this._x}this._x=f;return this};ContextChartMask.prototype.y=function(f){if(f==null){return this._y}this._y=f;return this};ContextChartMask.prototype.redraw=function(){var yDomain=this._y.domain();var minY=yDomain[0];var maxY=yDomain[1];var xDomain=this._x.domain();var minX=xDomain[0];var maxX=xDomain[1];var that=this;var leftData=this.data.filter((function(d){return d.date<that.from}));var rightData=this.data.filter((function(d){return d.date>that.to}));if(this.drawBounds===true){var boundedArea=_d.default.svg.area().x((function(d){return that._x(d.date)||1})).y0((function(d){return that._y(Math.min(maxY,Math.max(d.lower,minY)))})).y1((function(d){return that._y(Math.max(minY,Math.min(d.upper,maxY)))})).defined((function(d){return d.lower!==null&&d.upper!==null}));this.leftGroup.select(".left.area.bounds").attr("d",boundedArea(leftData));this.rightGroup.select(".right.area.bounds").attr("d",boundedArea(rightData))}var valuesLine=_d.default.svg.line().x((function(d){return that._x(d.date)})).y((function(d){return that._y(d.value)})).defined((function(d){return d.value!==null}));this.leftGroup.select(".left.values-line").attr("d",valuesLine(leftData));(0,_chart_utils.drawLineChartDots)(leftData,this.leftGroup,valuesLine,1);this.rightGroup.select(".right.values-line").attr("d",valuesLine(rightData));(0,_chart_utils.drawLineChartDots)(rightData,this.rightGroup,valuesLine,1);var leftPoly={l:this._x(minX),t:this._y(minY)+this.swimlaneHeight,r:this._x(this.from),b:0};var rightPoly={l:this._x(this.to),t:this._y(minY)+this.swimlaneHeight,r:this._x(maxX),b:0};this.leftPolygon.attr("points",""+leftPoly.l+","+leftPoly.t+"  "+leftPoly.r+","+leftPoly.t+"  "+leftPoly.r+","+leftPoly.b+"  "+leftPoly.l+","+leftPoly.b);this.rightPolygon.attr("points",""+rightPoly.l+","+rightPoly.t+"  "+rightPoly.r+","+rightPoly.t+"  "+rightPoly.r+","+rightPoly.b+"  "+rightPoly.l+","+rightPoly.b);return this};ContextChartMask.prototype.reveal=function(extent){this.from=extent[0];this.to=extent[1];this.redraw();return this}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getFocusData=getFocusData;var _rxjs=__webpack_require__(33);var _operators=__webpack_require__(6);var _ml_api_service=__webpack_require__(51);var _search=__webpack_require__(99);var _timeseries_search_service=__webpack_require__(520);var _results_service=__webpack_require__(132);var _timeseriesexplorer_constants=__webpack_require__(210);var _timeseriesexplorer_utils=__webpack_require__(275);var _forecast_service=__webpack_require__(160);var _job_utils=__webpack_require__(59);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function getFocusData(criteriaFields,detectorIndex,focusAggregationInterval,forecastId,modelPlotEnabled,nonBlankEntities,searchBounds,selectedJob){return(0,_rxjs.forkJoin)([_timeseries_search_service.mlTimeSeriesSearchService.getMetricData(selectedJob,detectorIndex,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),focusAggregationInterval.expression),_results_service.mlResultsService.getRecordsForCriteria([selectedJob.job_id],criteriaFields,0,searchBounds.min.valueOf(),searchBounds.max.valueOf(),_search.ANOMALIES_TABLE_DEFAULT_QUERY_SIZE),_results_service.mlResultsService.getScheduledEventsByBucket([selectedJob.job_id],searchBounds.min.valueOf(),searchBounds.max.valueOf(),focusAggregationInterval.expression,1,_timeseriesexplorer_constants.MAX_SCHEDULED_EVENTS),_ml_api_service.ml.annotations.getAnnotations({jobIds:[selectedJob.job_id],earliestMs:searchBounds.min.valueOf(),latestMs:searchBounds.max.valueOf(),maxAnnotations:_search.ANNOTATIONS_TABLE_DEFAULT_QUERY_SIZE}).pipe((0,_operators.catchError)((function(){return(0,_rxjs.of)({annotations:{}})}))),forecastId!==undefined?function(){var aggType;var detector=selectedJob.analysis_config.detectors[detectorIndex];var esAgg=(0,_job_utils.mlFunctionToESAggregation)(detector.function);if(!modelPlotEnabled&&(esAgg==="sum"||esAgg==="count")){aggType={avg:"sum",max:"sum",min:"sum"}}return _forecast_service.mlForecastService.getForecastData(selectedJob,detectorIndex,forecastId,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),focusAggregationInterval.expression,aggType)}():(0,_rxjs.of)(null)]).pipe((0,_operators.map)((function(_ref){var _ref2=_slicedToArray(_ref,5),metricData=_ref2[0],recordsForCriteria=_ref2[1],scheduledEventsByBucket=_ref2[2],annotations=_ref2[3],forecastData=_ref2[4];var anomalyRecords=recordsForCriteria.records.sort((function(a,b){return a[_timeseriesexplorer_constants.TIME_FIELD_NAME]-b[_timeseriesexplorer_constants.TIME_FIELD_NAME]})).reverse();var scheduledEvents=scheduledEventsByBucket.events[selectedJob.job_id];var focusChartData=(0,_timeseriesexplorer_utils.processMetricPlotResults)(metricData.results,modelPlotEnabled);focusChartData=(0,_timeseriesexplorer_utils.processDataForFocusAnomalies)(focusChartData,anomalyRecords,focusAggregationInterval,modelPlotEnabled);focusChartData=(0,_timeseriesexplorer_utils.processScheduledEventsForChart)(focusChartData,scheduledEvents);var refreshFocusData={scheduledEvents:scheduledEvents,anomalyRecords:anomalyRecords,focusChartData:focusChartData};if(annotations){var _annotations$annotati;refreshFocusData.focusAnnotationData=((_annotations$annotati=annotations.annotations[selectedJob.job_id])!==null&&_annotations$annotati!==void 0?_annotations$annotati:[]).sort((function(a,b){return a.timestamp-b.timestamp})).map((function(d,i){d.key=String.fromCharCode(65+i);return d}))}if(forecastData){refreshFocusData.focusForecastData=(0,_timeseriesexplorer_utils.processForecastResults)(forecastData.results);refreshFocusData.showForecastCheckbox=refreshFocusData.focusForecastData.length>0}return refreshFocusData})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateJobSelection=validateJobSelection;var _lodash=__webpack_require__(49);var _i18n=__webpack_require__(1);var _dependency_cache=__webpack_require__(5);var _job_select_service_utils=__webpack_require__(276);var _job_service=__webpack_require__(58);var _timeseriesexplorer_utils=__webpack_require__(275);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function validateJobSelection(jobsWithTimeRange,selectedJobIds,setGlobalState){var toastNotifications=(0,_dependency_cache.getToastNotifications)();var jobs=(0,_timeseriesexplorer_utils.createTimeSeriesJobData)(_job_service.mlJobService.jobs);var timeSeriesJobIds=jobs.map((function(j){return j.id}));var invalidIds=(0,_lodash.difference)(selectedJobIds,timeSeriesJobIds);var validSelectedJobIds=_lodash.without.apply(void 0,[selectedJobIds].concat(_toConsumableArray(invalidIds)));if(invalidIds.length>0){var warningText=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.canNotViewRequestedJobsWarningMessage",{defaultMessage:"You can't view requested {invalidIdsCount, plural, one {job} other {jobs}} {invalidIds} in this dashboard",values:{invalidIdsCount:invalidIds.length,invalidIds:invalidIds.join(", ")}});if(validSelectedJobIds.length===0&&timeSeriesJobIds.length>0){warningText+=_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.autoSelectingFirstJobText",{defaultMessage:", auto selecting first job"})}toastNotifications.addWarning(warningText)}if(validSelectedJobIds.length>1){toastNotifications.addWarning(_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.youCanViewOneJobAtTimeWarningMessage",{defaultMessage:"You can only view one job at a time in this dashboard"}));setGlobalState("ml",{jobIds:[validSelectedJobIds[0]]});return true}else if(invalidIds.length>0&&validSelectedJobIds.length>0){setGlobalState("ml",{jobIds:[validSelectedJobIds[0]]});return true}else if(validSelectedJobIds.length===1){return validSelectedJobIds[0]}else if(validSelectedJobIds.length===0&&jobs.length>0){var jobIds=[jobs[0].id];var time=(0,_job_select_service_utils.getTimeRangeFromSelection)(jobsWithTimeRange,jobIds);setGlobalState(_objectSpread({},{ml:{jobIds:jobIds}},{},time!==undefined?{time:time}:{}));return true}else{return false}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getAnnotationBrush=getAnnotationBrush;exports.getAnnotationLevels=getAnnotationLevels;exports.renderAnnotations=renderAnnotations;exports.getAnnotationWidth=getAnnotationWidth;exports.highlightFocusChartAnnotation=highlightFocusChartAnnotation;exports.unhighlightFocusChartAnnotation=unhighlightFocusChartAnnotation;exports.ANNOTATION_MASK_ID=void 0;var _d=_interopRequireDefault(__webpack_require__(97));var _moment=_interopRequireDefault(__webpack_require__(32));var _annotations=__webpack_require__(414);var _chart_tooltip_service=__webpack_require__(134);var _annotations_service=__webpack_require__(159);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ANNOTATION_MASK_ID="mlAnnotationMask";exports.ANNOTATION_MASK_ID=ANNOTATION_MASK_ID;function getAnnotationBrush(){var focusXScale=this.focusXScale;var annotateBrush=_d.default.svg.brush().x(focusXScale).on("brushend",brushend.bind(this));function brushend(){var selectedJob=this.props.selectedJob;var extent=annotateBrush.extent();var timestamp=extent[0].getTime();var endTimestamp=extent[1].getTime();if(timestamp===endTimestamp){_annotations_service.annotation$.next(null);return}var annotation={timestamp:timestamp,end_timestamp:endTimestamp,annotation:"",job_id:selectedJob.job_id,type:_annotations.ANNOTATION_TYPE.ANNOTATION};_annotations_service.annotation$.next(annotation)}return annotateBrush}function getAnnotationLevels(focusAnnotationData){var levels={};focusAnnotationData.forEach((function(d,i){if(d.key!==undefined){var longerAnnotations=focusAnnotationData.filter((function(d2,i2){return i2<i}));levels[d.key]=longerAnnotations.reduce((function(level,d2){if(d.end_timestamp===undefined||d2.end_timestamp===undefined||d2.key===undefined){return level}if(d2.timestamp<d.timestamp&&d2.end_timestamp<d.timestamp||d2.timestamp>d.end_timestamp&&d2.end_timestamp>d.end_timestamp){return level}return levels[d2.key]+1}),0)}}));return levels}var ANNOTATION_DEFAULT_LEVEL=1;var ANNOTATION_LEVEL_HEIGHT=28;var ANNOTATION_UPPER_RECT_MARGIN=0;var ANNOTATION_UPPER_TEXT_MARGIN=-7;var ANNOTATION_MIN_WIDTH=2;var ANNOTATION_RECT_BORDER_RADIUS=2;var ANNOTATION_TEXT_VERTICAL_OFFSET=26;var ANNOTATION_TEXT_RECT_VERTICAL_OFFSET=12;var ANNOTATION_TEXT_RECT_WIDTH=24;var ANNOTATION_TEXT_RECT_HEIGHT=20;function renderAnnotations(focusChart,focusAnnotationData,focusZoomPanelHeight,focusChartHeight,focusXScale,showAnnotations,showFocusChartTooltip){var upperRectMargin=ANNOTATION_UPPER_RECT_MARGIN;var upperTextMargin=ANNOTATION_UPPER_TEXT_MARGIN;var durations={};focusAnnotationData.forEach((function(d){if(d.key!==undefined){var duration=(d.end_timestamp||0)-d.timestamp;durations[d.key]=duration}}));focusAnnotationData.sort((function(a,b){if(a.key===undefined||b.key===undefined){return 0}return durations[b.key]-durations[a.key]}));var levelHeight=ANNOTATION_LEVEL_HEIGHT;var levels=getAnnotationLevels(focusAnnotationData);var annotations=focusChart.select(".mlAnnotations").selectAll("g.mlAnnotation").data(focusAnnotationData||[],(function(d){return d._id||""}));annotations.enter().append("g").classed("mlAnnotation",true);var rects=annotations.selectAll(".mlAnnotationRect").data((function(d){return[d]}));rects.enter().append("rect").attr("rx",ANNOTATION_RECT_BORDER_RADIUS).attr("ry",ANNOTATION_RECT_BORDER_RADIUS).classed("mlAnnotationRect",true).attr("mask","url(#".concat(ANNOTATION_MASK_ID,")")).on("mouseover",(function(d){showFocusChartTooltip(d,this)})).on("mouseout",(function(){return _chart_tooltip_service.mlChartTooltipService.hide()})).on("click",(function(d){_annotations_service.annotation$.next(null);_annotations_service.annotation$.next(d)}));rects.attr("x",(function(d){var date=(0,_moment.default)(d.timestamp);return focusXScale(date)})).attr("y",(function(d){var level=d.key!==undefined?levels[d.key]:ANNOTATION_DEFAULT_LEVEL;return focusZoomPanelHeight+1+upperRectMargin+level*levelHeight})).attr("height",(function(d){var level=d.key!==undefined?levels[d.key]:ANNOTATION_DEFAULT_LEVEL;return focusChartHeight-2-upperRectMargin-level*levelHeight})).attr("width",(function(d){var s=focusXScale((0,_moment.default)(d.timestamp))+1;var e=typeof d.end_timestamp!=="undefined"?focusXScale((0,_moment.default)(d.end_timestamp))-1:s+ANNOTATION_MIN_WIDTH;var width=Math.max(ANNOTATION_MIN_WIDTH,e-s);return width}));rects.exit().remove();var textRects=annotations.selectAll(".mlAnnotationTextRect").data((function(d){return[d]}));var texts=annotations.selectAll(".mlAnnotationText").data((function(d){return[d]}));textRects.enter().append("rect").classed("mlAnnotationTextRect",true).attr("width",ANNOTATION_TEXT_RECT_WIDTH).attr("height",ANNOTATION_TEXT_RECT_HEIGHT).attr("rx",ANNOTATION_RECT_BORDER_RADIUS).attr("ry",ANNOTATION_RECT_BORDER_RADIUS);texts.enter().append("text").classed("mlAnnotationText",true);function labelXOffset(ts){var earliestMs=focusXScale.domain()[0];var latestMs=focusXScale.domain()[1];var date=(0,_moment.default)(ts);var minX=Math.max(focusXScale(earliestMs),focusXScale(date));var maxOffset=32;return Math.min(focusXScale(latestMs)-maxOffset,minX)}texts.attr("x",(function(d){var leftInnerOffset=17;return labelXOffset(d.timestamp)+leftInnerOffset})).attr("y",(function(d){var level=d.key!==undefined?levels[d.key]:ANNOTATION_DEFAULT_LEVEL;return focusZoomPanelHeight+upperTextMargin+ANNOTATION_TEXT_VERTICAL_OFFSET+level*levelHeight})).text((function(d){return d.key}));textRects.attr("x",(function(d){var leftInnerOffset=5;return labelXOffset(d.timestamp)+leftInnerOffset})).attr("y",(function(d){var level=d.key!==undefined?levels[d.key]:ANNOTATION_DEFAULT_LEVEL;return focusZoomPanelHeight+upperTextMargin+ANNOTATION_TEXT_RECT_VERTICAL_OFFSET+level*levelHeight}));textRects.exit().remove();texts.exit().remove();annotations.classed("mlAnnotationHidden",!showAnnotations);annotations.exit().remove()}function getAnnotationWidth(annotation,focusXScale){var start=focusXScale(annotation.timestamp)+1;var end=typeof annotation.end_timestamp!=="undefined"?focusXScale(annotation.end_timestamp)-1:start+ANNOTATION_MIN_WIDTH;var width=Math.max(ANNOTATION_MIN_WIDTH,end-start);return width}function highlightFocusChartAnnotation(annotation){var annotations=_d.default.selectAll(".mlAnnotation");annotations.each((function(d){var element=_d.default.select(this);if(d._id===annotation._id){element.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",true)}else{element.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",true);element.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",true);element.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isBlur",true)}}))}function unhighlightFocusChartAnnotation(){var annotations=_d.default.selectAll(".mlAnnotation");annotations.each((function(){var element=_d.default.select(this);element.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",false);element.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",false).classed("mlAnnotationRect-isBlur",false);element.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",false)}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"TimeseriesexplorerNoChartData",{enumerable:true,get:function get(){return _timeseriesexplorer_no_chart_data.TimeseriesexplorerNoChartData}});var _timeseriesexplorer_no_chart_data=__webpack_require__(1687)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeseriesexplorerNoChartData=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TimeseriesexplorerNoChartData=function TimeseriesexplorerNoChartData(_ref){var dataNotChartable=_ref.dataNotChartable,entities=_ref.entities;return _react.default.createElement(_eui.EuiEmptyPrompt,{iconType:"iInCircle",title:_react.default.createElement("h2",null,_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.noResultsFoundLabel",{defaultMessage:"No results found"})),body:dataNotChartable?_react.default.createElement("p",null,_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.dataNotChartableDescription",{defaultMessage:"Model plot is not collected for the selected {entityCount, plural, one {entity} other {entities}}\nand the source data cannot be plotted for this detector.",values:{entityCount:entities.length}})):_react.default.createElement("p",null,_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.tryWideningTheTimeSelectionDescription",{defaultMessage:"Try widening the time selection or moving further back in time."}))})};exports.TimeseriesexplorerNoChartData=TimeseriesexplorerNoChartData},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobSelector=JobSelector;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=_interopRequireDefault(__webpack_require__(50));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _kibana=__webpack_require__(57);var _ml_api_service=__webpack_require__(51);var _url_state=__webpack_require__(88);var _index=__webpack_require__(1689);var _index2=__webpack_require__(1695);var _index3=__webpack_require__(1697);var _job_select_service_utils=__webpack_require__(276);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function mergeSelection(jobIds,groupObjs,singleSelection){if(singleSelection){return jobIds}var selectedIds=[];var alreadySelected=[];groupObjs.forEach((function(group){selectedIds.push(group.groupId);alreadySelected.push.apply(alreadySelected,_toConsumableArray(group.jobIds))}));jobIds.forEach((function(jobId){if(alreadySelected.includes(jobId)===false){selectedIds.push(jobId)}}));return selectedIds}function getInitialGroupsMap(selectedGroups){var map={};if(selectedGroups.length){selectedGroups.forEach((function(group){map[group.groupId]=group.jobIds}))}return map}var BADGE_LIMIT=10;var DEFAULT_GANTT_BAR_WIDTH=299;function JobSelector(_ref){var _ref2,_globalState$ml,_ref3,_globalState$ml2;var dateFormatTz=_ref.dateFormatTz,singleSelection=_ref.singleSelection,timeseriesOnly=_ref.timeseriesOnly;var _useUrlState=(0,_url_state.useUrlState)("_g"),_useUrlState2=_slicedToArray(_useUrlState,2),globalState=_useUrlState2[0],setGlobalState=_useUrlState2[1];var selectedJobIds=(_ref2=globalState===null||globalState===void 0?void 0:(_globalState$ml=globalState.ml)===null||_globalState$ml===void 0?void 0:_globalState$ml.jobIds)!==null&&_ref2!==void 0?_ref2:[];var selectedGroups=(_ref3=globalState===null||globalState===void 0?void 0:(_globalState$ml2=globalState.ml)===null||_globalState$ml2===void 0?void 0:_globalState$ml2.groups)!==null&&_ref3!==void 0?_ref3:[];var _useState=(0,_react.useState)([]),_useState2=_slicedToArray(_useState,2),jobs=_useState2[0],setJobs=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=_slicedToArray(_useState3,2),groups=_useState4[0],setGroups=_useState4[1];var _useState5=(0,_react.useState)({groupsMap:getInitialGroupsMap(selectedGroups),jobsMap:{}}),_useState6=_slicedToArray(_useState5,2),maps=_useState6[0],setMaps=_useState6[1];var _useState7=(0,_react.useState)(mergeSelection(selectedJobIds,selectedGroups,singleSelection)),_useState8=_slicedToArray(_useState7,2),selectedIds=_useState8[0],setSelectedIds=_useState8[1];var _useState9=(0,_react.useState)(mergeSelection(selectedJobIds,selectedGroups,singleSelection)),_useState10=_slicedToArray(_useState9,2),newSelection=_useState10[0],setNewSelection=_useState10[1];var _useState11=(0,_react.useState)(false),_useState12=_slicedToArray(_useState11,2),showAllBadges=_useState12[0],setShowAllBadges=_useState12[1];var _useState13=(0,_react.useState)(false),_useState14=_slicedToArray(_useState13,2),showAllBarBadges=_useState14[0],setShowAllBarBadges=_useState14[1];var _useState15=(0,_react.useState)(true),_useState16=_slicedToArray(_useState15,2),applyTimeRange=_useState16[0],setApplyTimeRange=_useState16[1];var _useState17=(0,_react.useState)(false),_useState18=_slicedToArray(_useState17,2),isFlyoutVisible=_useState18[0],setIsFlyoutVisible=_useState18[1];var _useState19=(0,_react.useState)(DEFAULT_GANTT_BAR_WIDTH),_useState20=_slicedToArray(_useState19,2),ganttBarWidth=_useState20[0],setGanttBarWidth=_useState20[1];var flyoutEl=(0,_react.useRef)(null);var _useMlKibana=(0,_kibana.useMlKibana)(),notifications=_useMlKibana.services.notifications;(0,_react.useEffect)((function(){setSelectedIds(mergeSelection(selectedJobIds,selectedGroups,singleSelection))}),[JSON.stringify([selectedJobIds,selectedGroups])]);(0,_react.useEffect)((function(){setNewSelection(selectedIds)}),[isFlyoutVisible]);var handleResize=(0,_react.useCallback)((function(){if(jobs.length>0&&flyoutEl&&flyoutEl.current&&flyoutEl.current.flyout){var tableHeaderCols=flyoutEl.current.flyout.querySelectorAll("table thead th");var derivedWidth=tableHeaderCols[tableHeaderCols.length-1].offsetWidth-16;var normalizedJobs=(0,_job_select_service_utils.normalizeTimes)(jobs,dateFormatTz,derivedWidth);setJobs(normalizedJobs);var _getGroupsFromJobs=(0,_job_select_service_utils.getGroupsFromJobs)(normalizedJobs),updatedGroups=_getGroupsFromJobs.groups;setGroups(updatedGroups);setGanttBarWidth(derivedWidth)}}),[dateFormatTz,jobs]);(0,_react.useEffect)((function(){window.addEventListener("resize",handleResize);return function(){window.removeEventListener("resize",handleResize)}}),[handleResize]);(0,_react.useEffect)((function(){handleResize()}),[handleResize,jobs]);function closeFlyout(){setIsFlyoutVisible(false)}function showFlyout(){setIsFlyoutVisible(true)}function handleJobSelectionClick(){showFlyout();_ml_api_service.ml.jobs.jobsWithTimerange(dateFormatTz).then((function(resp){var normalizedJobs=(0,_job_select_service_utils.normalizeTimes)(resp.jobs,dateFormatTz,DEFAULT_GANTT_BAR_WIDTH);var _getGroupsFromJobs2=(0,_job_select_service_utils.getGroupsFromJobs)(normalizedJobs),groupsWithTimerange=_getGroupsFromJobs2.groups,groupsMap=_getGroupsFromJobs2.groupsMap;setJobs(normalizedJobs);setGroups(groupsWithTimerange);setMaps({groupsMap:groupsMap,jobsMap:resp.jobsMap})})).catch((function(err){console.error("Error fetching jobs with time range",err);var toasts=notifications.toasts;toasts.addDanger({title:_i18n.i18n.translate("xpack.ml.jobSelector.jobFetchErrorMessage",{defaultMessage:"An error occurred fetching jobs. Refresh and try again."})})}))}function handleNewSelection(_ref4){var selectionFromTable=_ref4.selectionFromTable;setNewSelection(selectionFromTable)}function applySelection(){var allNewSelection=[];var groupSelection=[];newSelection.forEach((function(id){if(maps.groupsMap[id]!==undefined){allNewSelection.push.apply(allNewSelection,_toConsumableArray(maps.groupsMap[id]));groupSelection.push({groupId:id,jobIds:maps.groupsMap[id]})}else{allNewSelection.push(id)}}));var allNewSelectionUnique=Array.from(new Set(allNewSelection));setSelectedIds(newSelection);setNewSelection([]);closeFlyout();var time=applyTimeRange?(0,_job_select_service_utils.getTimeRangeFromSelection)(jobs,allNewSelectionUnique):undefined;setGlobalState(_objectSpread({ml:{jobIds:allNewSelectionUnique,groups:groupSelection}},time!==undefined?{time:time}:{}))}function toggleTimerangeSwitch(){setApplyTimeRange(!applyTimeRange)}function removeId(id){setNewSelection(newSelection.filter((function(item){return item!==id})))}function clearSelection(){setNewSelection([])}function renderJobSelectionBar(){return _react.default.createElement(_eui.EuiFlexGroup,{responsive:false,gutterSize:"xs",alignItems:"center"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{wrap:true,responsive:false,gutterSize:"xs",alignItems:"center","data-test-subj":"mlJobSelectionBadges"},_react.default.createElement(_index2.IdBadges,{limit:BADGE_LIMIT,maps:maps,onLinkClick:function onLinkClick(){return setShowAllBarBadges(!showAllBarBadges)},selectedIds:selectedIds,showAllBarBadges:showAllBarBadges}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{size:"xs",iconType:"pencil",onClick:handleJobSelectionClick,"data-test-subj":"mlButtonEditJobSelection"},_i18n.i18n.translate("xpack.ml.jobSelector.jobSelectionButton",{defaultMessage:"Edit job selection"}))))}function renderFlyout(){if(isFlyoutVisible){return _react.default.createElement(_eui.EuiFlyout,{ref:flyoutEl,onClose:closeFlyout,"aria-labelledby":"jobSelectorFlyout",size:"l","data-test-subj":"mlFlyoutJobSelector"},_react.default.createElement(_eui.EuiFlyoutHeader,{hasBorder:true},_react.default.createElement(_eui.EuiTitle,{size:"m"},_react.default.createElement("h2",{id:"flyoutTitle"},_i18n.i18n.translate("xpack.ml.jobSelector.flyoutTitle",{defaultMessage:"Job selection"})))),_react.default.createElement(_eui.EuiFlyoutBody,{className:"mlJobSelectorFlyoutBody"},_react.default.createElement(_eui.EuiFlexGroup,{direction:"column",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{wrap:true,responsive:false,gutterSize:"xs",alignItems:"center"},_react.default.createElement(_index3.NewSelectionIdBadges,{limit:BADGE_LIMIT,maps:maps,newSelection:newSelection,onDeleteClick:removeId,onLinkClick:function onLinkClick(){return setShowAllBadges(!showAllBadges)},showAllBadges:showAllBadges}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFlexGroup,{direction:"row",justifyContent:"spaceBetween",responsive:false},_react.default.createElement(_eui.EuiFlexItem,{grow:false},!singleSelection&&newSelection.length>0&&_react.default.createElement(_eui.EuiButtonEmpty,{onClick:clearSelection,size:"xs","data-test-subj":"mlFlyoutJobSelectorButtonClearSelection"},_i18n.i18n.translate("xpack.ml.jobSelector.clearAllFlyoutButton",{defaultMessage:"Clear all"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiSwitch,{label:_i18n.i18n.translate("xpack.ml.jobSelector.applyTimerangeSwitchLabel",{defaultMessage:"Apply timerange"}),checked:applyTimeRange,onChange:toggleTimerangeSwitch,"data-test-subj":"mlFlyoutJobSelectorSwitchApplyTimeRange"}))))),_react.default.createElement(_index.JobSelectorTable,{jobs:jobs,ganttBarWidth:ganttBarWidth,groupsList:groups,onSelection:handleNewSelection,selectedIds:newSelection,singleSelection:singleSelection,timeseriesOnly:timeseriesOnly})),_react.default.createElement(_eui.EuiFlyoutFooter,null,_react.default.createElement(_eui.EuiFlexGroup,null,_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{onClick:applySelection,fill:true,isDisabled:newSelection.length===0,"data-test-subj":"mlFlyoutJobSelectorButtonApply"},_i18n.i18n.translate("xpack.ml.jobSelector.applyFlyoutButton",{defaultMessage:"Apply"}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButtonEmpty,{iconType:"cross",onClick:closeFlyout,"data-test-subj":"mlFlyoutJobSelectorButtonClose"},_i18n.i18n.translate("xpack.ml.jobSelector.closeFlyoutButton",{defaultMessage:"Close"}))))))}}return _react.default.createElement("div",{className:"mlJobSelectorBar"},selectedIds.length>0&&renderJobSelectionBar(),renderFlyout())}JobSelector.propTypes={selectedJobIds:_propTypes.default.array,singleSelection:_propTypes.default.bool,timeseriesOnly:_propTypes.default.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"JobSelectorTable",{enumerable:true,get:function get(){return _job_selector_table.JobSelectorTable}});var _job_selector_table=__webpack_require__(1690)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobSelectorTable=JobSelectorTable;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _custom_selection_table=__webpack_require__(1691);var _job_selector_badge=__webpack_require__(187);var _timerange_bar=__webpack_require__(1693);var _eui=__webpack_require__(29);var _services=__webpack_require__(43);var _i18n=__webpack_require__(1);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var JOB_FILTER_FIELDS=["job_id","groups"];var GROUP_FILTER_FIELDS=["id"];function JobSelectorTable(_ref){var ganttBarWidth=_ref.ganttBarWidth,groupsList=_ref.groupsList,jobs=_ref.jobs,onSelection=_ref.onSelection,selectedIds=_ref.selectedIds,singleSelection=_ref.singleSelection,timeseriesOnly=_ref.timeseriesOnly;var _useState=(0,_react.useState)(),_useState2=_slicedToArray(_useState,2),sortableProperties=_useState2[0],setSortableProperties=_useState2[1];var _useState3=(0,_react.useState)("Jobs"),_useState4=_slicedToArray(_useState3,2),currentTab=_useState4[0],setCurrentTab=_useState4[1];(0,_react.useEffect)((function(){var sortablePropertyItems=[];var defaultSortProperty="job_id";if(currentTab==="Jobs"||singleSelection){sortablePropertyItems=[{name:"job_id",getValue:function getValue(item){return item.job_id.toLowerCase()},isAscending:true},{name:"groups",getValue:function getValue(item){return item.groups&&item.groups[0]?item.groups[0].toLowerCase():""},isAscending:true}]}else if(currentTab==="Groups"){defaultSortProperty="id";sortablePropertyItems=[{name:"id",getValue:function getValue(item){return item.id.toLowerCase()},isAscending:true}]}var sortableProps=new _services.SortableProperties(sortablePropertyItems,defaultSortProperty);setSortableProperties(sortableProps)}),[jobs,currentTab]);var tabs=[{id:"Jobs",name:_i18n.i18n.translate("xpack.ml.jobSelector.jobsTab",{defaultMessage:"Jobs"}),content:renderJobsTable()},{id:"Groups",name:_i18n.i18n.translate("xpack.ml.jobSelector.groupsTab",{defaultMessage:"Groups"}),content:renderGroupsTable()}];function getGroupOptions(){return groupsList.map((function(g){return{value:g.id,view:_react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{key:g.id,grow:false},_react.default.createElement(_job_selector_badge.JobSelectorBadge,{id:g.id,isGroup:true})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_i18n.i18n.translate("xpack.ml.jobSelector.filterBar.jobGroupTitle",{defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:g.jobIds.length}}))))}}))}function renderJobsTable(){var columns=[{id:"checkbox",isCheckbox:true,textOnly:false,width:"24px"},{label:"job ID",id:"job_id",isSortable:true,alignment:_services.LEFT_ALIGNMENT},{id:"groups",label:"groups",isSortable:true,alignment:_services.LEFT_ALIGNMENT,render:function render(_ref2){var _ref2$groups=_ref2.groups,groups=_ref2$groups===void 0?[]:_ref2$groups;return groups.map((function(group){return _react.default.createElement(_job_selector_badge.JobSelectorBadge,{key:"".concat(group,"-key"),id:group,isGroup:true})}))}},{label:"time range",id:"timerange",alignment:_services.LEFT_ALIGNMENT,render:function render(_ref3){var _ref3$timeRange=_ref3.timeRange,timeRange=_ref3$timeRange===void 0?{}:_ref3$timeRange,isRunning=_ref3.isRunning;return _react.default.createElement(_timerange_bar.TimeRangeBar,{timerange:timeRange,isRunning:isRunning,ganttBarWidth:ganttBarWidth})}}];var filters=[{type:"field_value_selection",field:"groups",name:_i18n.i18n.translate("xpack.ml.jobSelector.filterBar.groupLabel",{defaultMessage:"Group"}),loadingMessage:"Loading...",noOptionsMessage:"No groups found.",multiSelect:"or",cache:1e4,options:getGroupOptions()}];return _react.default.createElement(_custom_selection_table.CustomSelectionTable,{columns:columns,filters:filters,filterDefaultFields:!singleSelection?JOB_FILTER_FIELDS:undefined,items:jobs,onTableChange:function onTableChange(selectionFromTable){return onSelection({selectionFromTable:selectionFromTable})},selectedIds:selectedIds,singleSelection:singleSelection,sortableProperties:sortableProperties,timeseriesOnly:timeseriesOnly})}function renderGroupsTable(){var groupColumns=[{id:"checkbox",isCheckbox:true,textOnly:false,width:"24px"},{label:"group ID",id:"id",isSortable:true,alignment:_services.LEFT_ALIGNMENT,render:function render(_ref4){var id=_ref4.id;return _react.default.createElement(_job_selector_badge.JobSelectorBadge,{id:id,isGroup:true})}},{id:"jobs in group",label:"jobs in group",isSortable:false,alignment:_services.CENTER_ALIGNMENT,render:function render(_ref5){var _ref5$jobIds=_ref5.jobIds,jobIds=_ref5$jobIds===void 0?[]:_ref5$jobIds;return jobIds.length}},{label:"time range",id:"timerange",alignment:_services.LEFT_ALIGNMENT,render:function render(_ref6){var _ref6$timeRange=_ref6.timeRange,timeRange=_ref6$timeRange===void 0?{}:_ref6$timeRange;return _react.default.createElement(_timerange_bar.TimeRangeBar,{timerange:timeRange,ganttBarWidth:ganttBarWidth})}}];return _react.default.createElement(_custom_selection_table.CustomSelectionTable,{columns:groupColumns,filterDefaultFields:!singleSelection?GROUP_FILTER_FIELDS:undefined,items:groupsList,onTableChange:function onTableChange(selectionFromTable){return onSelection({selectionFromTable:selectionFromTable})},selectedIds:selectedIds,sortableProperties:sortableProperties})}function renderTabs(){return _react.default.createElement(_eui.EuiTabbedContent,{size:"s",tabs:tabs,initialSelectedTab:tabs[0],onTabClick:function onTabClick(tab){setCurrentTab(tab.id)}})}return _react.default.createElement(_react.Fragment,null,jobs.length===0&&_react.default.createElement(_eui.EuiLoadingSpinner,{size:"l"}),jobs.length!==0&&singleSelection===true&&renderJobsTable(),jobs.length!==0&&singleSelection===undefined&&renderTabs())}JobSelectorTable.propTypes={ganttBarWidth:_propTypes.PropTypes.number.isRequired,groupsList:_propTypes.PropTypes.array,jobs:_propTypes.PropTypes.array,onSelection:_propTypes.PropTypes.func.isRequired,selectedIds:_propTypes.PropTypes.array.isRequired,singleSelection:_propTypes.PropTypes.bool,timeseriesOnly:_propTypes.PropTypes.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CustomSelectionTable",{enumerable:true,get:function get(){return _custom_selection_table.CustomSelectionTable}});var _custom_selection_table=__webpack_require__(1692)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CustomSelectionTable=CustomSelectionTable;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);var _services=__webpack_require__(43);var _i18n=__webpack_require__(1);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var JOBS_PER_PAGE=20;function getError(error){if(error!==null){return _i18n.i18n.translate("xpack.ml.jobSelector.filterBar.invalidSearchErrorMessage",{defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:error.message}})}return""}function CustomSelectionTable(_ref){var columns=_ref.columns,filterDefaultFields=_ref.filterDefaultFields,filters=_ref.filters,items=_ref.items,onTableChange=_ref.onTableChange,selectedIds=_ref.selectedIds,singleSelection=_ref.singleSelection,sortableProperties=_ref.sortableProperties,timeseriesOnly=_ref.timeseriesOnly;var _useState=(0,_react.useState)(getCurrentlySelectedItemIdsMap()),_useState2=_slicedToArray(_useState,2),itemIdToSelectedMap=_useState2[0],setItemIdToSelectedMap=_useState2[1];var _useState3=(0,_react.useState)(items),_useState4=_slicedToArray(_useState3,2),currentItems=_useState4[0],setCurrentItems=_useState4[1];var _useState5=(0,_react.useState)(selectedIds),_useState6=_slicedToArray(_useState5,2),lastSelected=_useState6[0],setLastSelected=_useState6[1];var _useState7=(0,_react.useState)(""),_useState8=_slicedToArray(_useState7,2),sortedColumn=_useState8[0],setSortedColumn=_useState8[1];var _useState9=(0,_react.useState)(),_useState10=_slicedToArray(_useState9,2),pager=_useState10[0],setPager=_useState10[1];var _useState11=(0,_react.useState)({itemsPerPage:JOBS_PER_PAGE,firstItemIndex:0,lastItemIndex:1}),_useState12=_slicedToArray(_useState11,2),pagerSettings=_useState12[0],setPagerSettings=_useState12[1];var _useState13=(0,_react.useState)(_eui.EuiSearchBar.Query.MATCH_ALL),_useState14=_slicedToArray(_useState13,2),query=_useState14[0],setQuery=_useState14[1];var _useState15=(0,_react.useState)(null),_useState16=_slicedToArray(_useState15,2),error=_useState16[0],setError=_useState16[1];(0,_react.useEffect)((function(){setCurrentItems(items);handleQueryChange({query:query})}),[items]);(0,_react.useEffect)((function(){setItemIdToSelectedMap(getCurrentlySelectedItemIdsMap())}),[selectedIds]);(0,_react.useEffect)((function(){var tablePager=new _services.Pager(currentItems.length,JOBS_PER_PAGE);setPagerSettings({itemsPerPage:JOBS_PER_PAGE,firstItemIndex:tablePager.getFirstItemIndex(),lastItemIndex:tablePager.getLastItemIndex()});setPager(tablePager)}),[currentItems]);function getCurrentlySelectedItemIdsMap(){var selectedIdsMap={all:false};selectedIds.forEach((function(id){selectedIdsMap[id]=true}));return selectedIdsMap}function handleSingleSelectionTableChange(itemId){onTableChange([itemId])}function handleTableChange(_ref2){var isSelected=_ref2.isSelected,itemId=_ref2.itemId;var selectedMapIds=Object.getOwnPropertyNames(itemIdToSelectedMap);var currentItemIds=currentItems.map((function(item){return item.id}));var currentSelected=selectedMapIds.filter((function(id){return itemIdToSelectedMap[id]===true&&id!==itemId}));if(itemId!=="all"){if(isSelected===true){currentSelected.push(itemId)}}else{if(isSelected===false){currentSelected=currentSelected.filter((function(id){return currentItemIds.includes(id)===false}))}else{currentSelected=[].concat(_toConsumableArray(currentSelected),_toConsumableArray(currentItemIds));currentSelected=_toConsumableArray(new Set(currentSelected))}}onTableChange(currentSelected)}function handleChangeItemsPerPage(itemsPerPage){pager.setItemsPerPage(itemsPerPage);setPagerSettings(_objectSpread({},pagerSettings,{itemsPerPage:itemsPerPage,firstItemIndex:pager.getFirstItemIndex(),lastItemIndex:pager.getLastItemIndex()}))}function handlePageChange(pageIndex){pager.goToPageIndex(pageIndex);setPagerSettings(_objectSpread({},pagerSettings,{firstItemIndex:pager.getFirstItemIndex(),lastItemIndex:pager.getLastItemIndex()}))}function handleQueryChange(_ref3){var incomingQuery=_ref3.query,newError=_ref3.error;if(newError){setError(newError)}else{var queriedItems=_eui.EuiSearchBar.Query.execute(incomingQuery,items,{defaultFields:filterDefaultFields});setError(null);setCurrentItems(queriedItems);setQuery(incomingQuery)}}function isItemSelected(itemId){return itemIdToSelectedMap[itemId]===true}function areAllItemsSelected(){var indexOfUnselectedItem=currentItems.findIndex((function(item){return!isItemSelected(item.id)}));return indexOfUnselectedItem===-1}function renderSelectAll(mobile){var selectAll=_i18n.i18n.translate("xpack.ml.jobSelector.customTable.selectAllCheckboxLabel",{defaultMessage:"Select all"});return _react.default.createElement(_eui.EuiCheckbox,{id:"selectAllCheckbox",label:mobile?selectAll:null,checked:areAllItemsSelected(),onChange:toggleAll,type:mobile?null:"inList"})}function toggleItem(itemId){if(singleSelection){var _objectSpread2;var lastId=lastSelected[0];setItemIdToSelectedMap(_objectSpread({},itemIdToSelectedMap,(_objectSpread2={},_defineProperty(_objectSpread2,lastId,false),_defineProperty(_objectSpread2,itemId,true),_objectSpread2)));handleSingleSelectionTableChange(itemId);setLastSelected([itemId])}else{var isSelected=!isItemSelected(itemId);setItemIdToSelectedMap(_objectSpread({},itemIdToSelectedMap,_defineProperty({},itemId,isSelected)));handleTableChange({isSelected:isSelected,itemId:itemId})}}function toggleAll(){var allSelected=areAllItemsSelected()||itemIdToSelectedMap.all===true;var newItemIdToSelectedMap={};currentItems.forEach((function(item){return newItemIdToSelectedMap[item.id]=!allSelected}));setItemIdToSelectedMap(newItemIdToSelectedMap);handleTableChange({isSelected:!allSelected,itemId:"all"})}function onSort(prop){sortableProperties.sortOn(prop);var sortedItems=sortableProperties.sortItems(currentItems);setCurrentItems(sortedItems);setSortedColumn(prop)}function renderHeaderCells(){var headers=[];columns.forEach((function(column,columnIndex){if(column.isCheckbox&&!singleSelection){headers.push(_react.default.createElement(_eui.EuiTableHeaderCellCheckbox,{key:column.id,width:column.width},renderSelectAll()))}else{headers.push(_react.default.createElement(_eui.EuiTableHeaderCell,{key:column.id,align:columns[columnIndex].alignment,width:column.width,onSort:column.isSortable?function(){return onSort(column.id)}:undefined,isSorted:sortedColumn===column.id,isSortAscending:sortableProperties?sortableProperties.isAscendingByName(column.id):true,mobileOptions:column.mobileOptions},column.label))}}));return headers.length?headers:null}function renderRows(){var renderRow=function renderRow(item){var cells=columns.map((function(column){var cell=item[column.id];var child;if(column.isCheckbox){return _react.default.createElement(_eui.EuiTableRowCellCheckbox,{key:column.id},!singleSelection&&_react.default.createElement(_eui.EuiCheckbox,{id:"".concat(item.id,"-checkbox"),"data-test-subj":"".concat(item.id,"-checkbox"),checked:isItemSelected(item.id),onChange:function onChange(){return toggleItem(item.id)},type:"inList"}),singleSelection&&_react.default.createElement(_eui.EuiRadio,{id:item.id,"data-test-subj":"".concat(item.id,"-radio-button"),checked:isItemSelected(item.id),onChange:function onChange(){return toggleItem(item.id)},disabled:timeseriesOnly&&item.isSingleMetricViewerJob===false}))}if(column.render){child=column.render(item)}else{child=cell}return _react.default.createElement(_eui.EuiTableRowCell,{key:column.id,align:column.alignment,truncateText:cell&&cell.truncateText,textOnly:cell?cell.textOnly:true,mobileOptions:_objectSpread({header:column.label},column.mobileOptions)},child)}));return _react.default.createElement(_eui.EuiTableRow,{key:item.id,isSelected:isItemSelected(item.id),isSelectable:true,hasActions:true,"data-test-subj":"mlFlyoutJobSelectorTableRow"},cells)};var rows=[];for(var itemIndex=pagerSettings.firstItemIndex;itemIndex<=pagerSettings.lastItemIndex;itemIndex++){var item=currentItems[itemIndex];if(item===undefined){break}rows.push(renderRow(item))}return rows}return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement(_eui.EuiFlexGroup,{direction:"column"},_react.default.createElement(_eui.EuiFlexItem,{grow:false,"data-test-subj":"mlFlyoutJobSelectorSearchBar"},_react.default.createElement(_eui.EuiSearchBar,{defaultQuery:query,box:{incremental:true,placeholder:_i18n.i18n.translate("xpack.ml.jobSelector.customTable.searchBarPlaceholder",{defaultMessage:"Search..."})},filters:filters,onChange:handleQueryChange}),_react.default.createElement(_eui.EuiFormRow,{fullWidth:true,isInvalid:error!==null,error:getError(error),style:{maxHeight:"0px"}},_react.default.createElement(_react.Fragment,null)))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiTableHeaderMobile,null,_react.default.createElement(_eui.EuiFlexGroup,{responsive:false,justifyContent:"spaceBetween",alignItems:"baseline"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},renderSelectAll(true)))),_react.default.createElement(_eui.EuiTable,{"data-test-subj":"mlFlyoutJobSelectorTable"},_react.default.createElement(_eui.EuiTableHeader,null,renderHeaderCells()),_react.default.createElement(_eui.EuiTableBody,null,renderRows())),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),pager!==undefined&&_react.default.createElement(_eui.EuiTablePagination,{activePage:pager.getCurrentPageIndex(),itemsPerPage:pagerSettings.itemsPerPage,itemsPerPageOptions:[10,JOBS_PER_PAGE,50],pageCount:pager.getTotalPages(),onChangeItemsPerPage:handleChangeItemsPerPage,onChangePage:function onChangePage(pageIndex){return handlePageChange(pageIndex)}}))}CustomSelectionTable.propTypes={columns:_propTypes.PropTypes.array.isRequired,filterDefaultFields:_propTypes.PropTypes.array,filters:_propTypes.PropTypes.array,items:_propTypes.PropTypes.array.isRequired,onTableChange:_propTypes.PropTypes.func.isRequired,selectedId:_propTypes.PropTypes.array,singleSelection:_propTypes.PropTypes.bool,sortableProperties:_propTypes.PropTypes.object,timeseriesOnly:_propTypes.PropTypes.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"TimeRangeBar",{enumerable:true,get:function get(){return _timerange_bar.TimeRangeBar}});var _timerange_bar=__webpack_require__(1694)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeRangeBar=TimeRangeBar;var _react=_interopRequireWildcard(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function TimeRangeBar(_ref){var isRunning=_ref.isRunning,timerange=_ref.timerange,ganttBarWidth=_ref.ganttBarWidth;var style={width:timerange.widthPx,marginLeft:timerange.fromPx};var className="mlJobSelector__ganttBar".concat(isRunning?" mlJobSelector__ganttBarRunning":"");return _react.default.createElement(_eui.EuiToolTip,{position:"top",content:timerange.label},_react.default.createElement(_react.Fragment,null,_react.default.createElement("div",{className:"mlJobSelector__ganttBarBackEdge"},_react.default.createElement("div",{className:"mlJobSelector__ganttBarDashed",style:{width:"".concat(ganttBarWidth,"px")}})),_react.default.createElement("div",{style:style,className:className})))}TimeRangeBar.propTypes={ganttBarWidth:_propTypes.PropTypes.number,isRunning:_propTypes.PropTypes.bool,timerange:_propTypes.PropTypes.shape({widthPx:_propTypes.PropTypes.number,label:_propTypes.PropTypes.string,fromPx:_propTypes.PropTypes.number})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"IdBadges",{enumerable:true,get:function get(){return _id_badges.IdBadges}});var _id_badges=__webpack_require__(1696)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.IdBadges=IdBadges;var _react=_interopRequireDefault(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);var _job_selector_badge=__webpack_require__(187);var _i18n=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function IdBadges(_ref){var limit=_ref.limit,maps=_ref.maps,onLinkClick=_ref.onLinkClick,selectedIds=_ref.selectedIds,showAllBarBadges=_ref.showAllBarBadges;var badges=[];var currentGroups=[];for(var i=0;i<selectedIds.length;i++){var currentId=selectedIds[i];if(maps.groupsMap[currentId]!==undefined){currentGroups.push(currentId);badges.push(_react.default.createElement(_eui.EuiFlexItem,{grow:false,key:currentId},_react.default.createElement(_job_selector_badge.JobSelectorBadge,{id:currentId,isGroup:true,numJobs:maps.groupsMap[currentId].length})))}else{continue}}for(var _i=0;_i<selectedIds.length;_i++){var _currentId=selectedIds[_i];if(maps.groupsMap[_currentId]===undefined){var jobGroups=maps.jobsMap[_currentId]||[];if(jobGroups.some((function(g){return currentGroups.includes(g)}))===false){badges.push(_react.default.createElement(_eui.EuiFlexItem,{grow:false,key:_currentId},_react.default.createElement(_job_selector_badge.JobSelectorBadge,{id:_currentId})))}else{continue}}else{continue}}if(showAllBarBadges||badges.length<=limit){if(badges.length>limit){badges.push(_react.default.createElement(_eui.EuiLink,{key:"more-badges-bar-link",onClick:onLinkClick},_react.default.createElement(_eui.EuiText,{grow:false,size:"xs"},_i18n.i18n.translate("xpack.ml.jobSelector.hideBarBadges",{defaultMessage:"Hide"}))))}return badges}else{var overFlow=badges.length-limit;badges.splice(limit);badges.push(_react.default.createElement(_eui.EuiLink,{key:"more-badges-bar-link",onClick:onLinkClick},_react.default.createElement(_eui.EuiText,{grow:false,size:"xs"},_i18n.i18n.translate("xpack.ml.jobSelector.showBarBadges",{defaultMessage:"And {overFlow} more",values:{overFlow:overFlow}}))));return badges}}IdBadges.propTypes={limit:_propTypes.PropTypes.number,maps:_propTypes.PropTypes.shape({jobsMap:_propTypes.PropTypes.object,groupsMap:_propTypes.PropTypes.object}),onLinkClick:_propTypes.PropTypes.func,selectedIds:_propTypes.PropTypes.array,showAllBarBadges:_propTypes.PropTypes.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"NewSelectionIdBadges",{enumerable:true,get:function get(){return _new_selection_id_badges.NewSelectionIdBadges}});var _new_selection_id_badges=__webpack_require__(1698)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NewSelectionIdBadges=NewSelectionIdBadges;var _react=_interopRequireDefault(__webpack_require__(28));var _propTypes=__webpack_require__(50);var _eui=__webpack_require__(29);var _job_selector_badge=__webpack_require__(187);var _i18n=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function NewSelectionIdBadges(_ref){var limit=_ref.limit,maps=_ref.maps,newSelection=_ref.newSelection,onDeleteClick=_ref.onDeleteClick,onLinkClick=_ref.onLinkClick,showAllBadges=_ref.showAllBadges;var badges=[];for(var i=0;i<newSelection.length;i++){if(i>=limit&&showAllBadges===false){break}badges.push(_react.default.createElement(_eui.EuiFlexItem,{grow:false,key:newSelection[i]},_react.default.createElement(_job_selector_badge.JobSelectorBadge,{id:newSelection[i],icon:true,isGroup:maps.groupsMap[newSelection[i]]!==undefined,removeId:onDeleteClick})))}if(showAllBadges===false&&newSelection.length>limit){badges.push(_react.default.createElement(_eui.EuiLink,{key:"more-badges-link",onClick:onLinkClick},_react.default.createElement(_eui.EuiText,{grow:false,size:"xs"},_i18n.i18n.translate("xpack.ml.jobSelector.showFlyoutBadges",{defaultMessage:"And {overFlow} more",values:{overFlow:newSelection.length-limit}}))))}else if(showAllBadges===true&&newSelection.length>limit){badges.push(_react.default.createElement(_eui.EuiLink,{key:"hide-badges-link",onClick:onLinkClick},_react.default.createElement(_eui.EuiText,{grow:false,size:"xs"},_i18n.i18n.translate("xpack.ml.jobSelector.hideFlyoutBadges",{defaultMessage:"Hide"}))))}return badges}NewSelectionIdBadges.propTypes={limit:_propTypes.PropTypes.number,maps:_propTypes.PropTypes.shape({jobsMap:_propTypes.PropTypes.object,groupsMap:_propTypes.PropTypes.object}),newSelection:_propTypes.PropTypes.array,onDeleteClick:_propTypes.PropTypes.func,onLinkClick:_propTypes.PropTypes.func,showAllBadges:_propTypes.PropTypes.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"TimeseriesexplorerNoJobsFound",{enumerable:true,get:function get(){return _timeseriesexplorer_no_jobs_found.TimeseriesexplorerNoJobsFound}});var _timeseriesexplorer_no_jobs_found=__webpack_require__(1700)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TimeseriesexplorerNoJobsFound=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TimeseriesexplorerNoJobsFound=function TimeseriesexplorerNoJobsFound(){return _react.default.createElement(_eui.EuiEmptyPrompt,{"data-test-subj":"mlNoSingleMetricJobsFound",iconType:"alert",title:_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.noSingleMetricJobsFoundLabel",defaultMessage:"No single metric jobs found"})),actions:_react.default.createElement(_eui.EuiButton,{color:"primary",fill:true,href:"ml#/jobs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.createNewSingleMetricJobLinkText",defaultMessage:"Create new single metric job"}))})};exports.TimeseriesexplorerNoJobsFound=TimeseriesexplorerNoJobsFound},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.explorerRoute=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _useObservable=_interopRequireDefault(__webpack_require__(129));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_refresh=__webpack_require__(526);var _use_resolver=__webpack_require__(68);var _resolvers=__webpack_require__(110);var _explorer=__webpack_require__(1702);var _use_selected_cells=__webpack_require__(1748);var _job_service=__webpack_require__(58);var _ml_api_service=__webpack_require__(51);var _actions=__webpack_require__(527);var _explorer_dashboard_service=__webpack_require__(144);var _explorer_utils=__webpack_require__(93);var _select_limit=__webpack_require__(1749);var _use_job_selection=__webpack_require__(1750);var _checkbox_showcharts=__webpack_require__(529);var _select_interval=__webpack_require__(524);var _select_severity=__webpack_require__(525);var _url_state=__webpack_require__(88);var _breadcrumbs=__webpack_require__(69);var _kibana=__webpack_require__(57);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[_breadcrumbs.ML_BREADCRUMB,_breadcrumbs.ANOMALY_DETECTION_BREADCRUMB,{text:_i18n.i18n.translate("xpack.ml.anomalyDetection.anomalyExplorerLabel",{defaultMessage:"Anomaly Explorer"}),href:""}];var explorerRoute={path:"/explorer",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.explorerRoute=explorerRoute;var PageWrapper=function PageWrapper(_ref){var deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,_objectSpread({},(0,_resolvers.basicResolvers)(deps),{jobs:_job_service.mlJobService.loadJobsWrapper,jobsWithTimeRange:function jobsWithTimeRange(){return _ml_api_service.ml.jobs.jobsWithTimerange((0,_explorer_utils.getDateFormatTz)())}})),context=_useResolver.context,results=_useResolver.results;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(ExplorerUrlStateManager,{jobsWithTimeRange:results.jobsWithTimeRange.jobs}))};var ExplorerUrlStateManager=function ExplorerUrlStateManager(_ref2){var _globalState$time,_globalState$time2;var jobsWithTimeRange=_ref2.jobsWithTimeRange;var _useUrlState=(0,_url_state.useUrlState)("_a"),_useUrlState2=_slicedToArray(_useUrlState,2),appState=_useUrlState2[0],setAppState=_useUrlState2[1];var _useUrlState3=(0,_url_state.useUrlState)("_g"),_useUrlState4=_slicedToArray(_useUrlState3,2),globalState=_useUrlState4[0],setGlobalState=_useUrlState4[1];var _useState=(0,_react.useState)(0),_useState2=_slicedToArray(_useState,2),lastRefresh=_useState2[0],setLastRefresh=_useState2[1];var timefilter=(0,_kibana.useTimefilter)({timeRangeSelector:true,autoRefreshSelector:true});var _useJobSelection=(0,_use_job_selection.useJobSelection)(jobsWithTimeRange,(0,_explorer_utils.getDateFormatTz)()),jobIds=_useJobSelection.jobIds;var refresh=(0,_use_refresh.useRefresh)();(0,_react.useEffect)((function(){if(refresh!==undefined){setLastRefresh(refresh===null||refresh===void 0?void 0:refresh.lastRefresh);if(refresh.timeRange!==undefined){var _refresh$timeRange=refresh.timeRange,start=_refresh$timeRange.start,end=_refresh$timeRange.end;setGlobalState("time",{from:start,to:end})}}}),[refresh===null||refresh===void 0?void 0:refresh.lastRefresh]);(0,_react.useEffect)((function(){if((globalState===null||globalState===void 0?void 0:globalState.time)!==undefined){timefilter.setTime({from:globalState.time.from,to:globalState.time.to});var timefilterBounds=timefilter.getBounds();if((timefilterBounds===null||timefilterBounds===void 0?void 0:timefilterBounds.min)!==undefined&&(timefilterBounds===null||timefilterBounds===void 0?void 0:timefilterBounds.max)!==undefined){_explorer_dashboard_service.explorerService.setBounds(timefilterBounds)}}}),[globalState===null||globalState===void 0?void 0:(_globalState$time=globalState.time)===null||_globalState$time===void 0?void 0:_globalState$time.from,globalState===null||globalState===void 0?void 0:(_globalState$time2=globalState.time)===null||_globalState$time2===void 0?void 0:_globalState$time2.to]);(0,_react.useEffect)((function(){var _appState$mlExplorerS;var viewByFieldName=appState===null||appState===void 0?void 0:(_appState$mlExplorerS=appState.mlExplorerSwimlane)===null||_appState$mlExplorerS===void 0?void 0:_appState$mlExplorerS.viewByFieldName;if(viewByFieldName!==undefined){_explorer_dashboard_service.explorerService.setViewBySwimlaneFieldName(viewByFieldName)}var filterData=appState===null||appState===void 0?void 0:appState.mlExplorerFilter;if(filterData!==undefined){_explorer_dashboard_service.explorerService.setFilterData(filterData)}}),[]);(0,_react.useEffect)((function(){if(jobIds.length>0){_explorer_dashboard_service.explorerService.updateJobSelection(jobIds)}else{_explorer_dashboard_service.explorerService.clearJobs()}}),[JSON.stringify(jobIds)]);var _useExplorerData=(0,_actions.useExplorerData)(),_useExplorerData2=_slicedToArray(_useExplorerData,2),explorerData=_useExplorerData2[0],loadExplorerData=_useExplorerData2[1];(0,_react.useEffect)((function(){if(explorerData!==undefined&&Object.keys(explorerData).length>0){_explorer_dashboard_service.explorerService.setExplorerData(explorerData)}}),[explorerData]);var explorerAppState=(0,_useObservable.default)(_explorer_dashboard_service.explorerService.appState$);(0,_react.useEffect)((function(){if(explorerAppState!==undefined&&explorerAppState.mlExplorerSwimlane.viewByFieldName!==undefined){setAppState(explorerAppState)}}),[explorerAppState]);var explorerState=(0,_useObservable.default)(_explorer_dashboard_service.explorerService.state$);var _useShowCharts=(0,_checkbox_showcharts.useShowCharts)(),_useShowCharts2=_slicedToArray(_useShowCharts,1),showCharts=_useShowCharts2[0];var _useTableInterval=(0,_select_interval.useTableInterval)(),_useTableInterval2=_slicedToArray(_useTableInterval,1),tableInterval=_useTableInterval2[0];var _useTableSeverity=(0,_select_severity.useTableSeverity)(),_useTableSeverity2=_slicedToArray(_useTableSeverity,1),tableSeverity=_useTableSeverity2[0];var _useSwimlaneLimit=(0,_select_limit.useSwimlaneLimit)(),_useSwimlaneLimit2=_slicedToArray(_useSwimlaneLimit,1),swimlaneLimit=_useSwimlaneLimit2[0];(0,_react.useEffect)((function(){_explorer_dashboard_service.explorerService.setSwimlaneLimit(swimlaneLimit)}),[swimlaneLimit]);var _useSelectedCells=(0,_use_selected_cells.useSelectedCells)(),_useSelectedCells2=_slicedToArray(_useSelectedCells,2),selectedCells=_useSelectedCells2[0],setSelectedCells=_useSelectedCells2[1];(0,_react.useEffect)((function(){_explorer_dashboard_service.explorerService.setSelectedCells(selectedCells)}),[JSON.stringify(selectedCells)]);var loadExplorerDataConfig=explorerState!==undefined&&{bounds:explorerState.bounds,lastRefresh:lastRefresh,influencersFilterQuery:explorerState.influencersFilterQuery,noInfluencersConfigured:explorerState.noInfluencersConfigured,selectedCells:selectedCells,selectedJobs:explorerState.selectedJobs,swimlaneBucketInterval:explorerState.swimlaneBucketInterval,swimlaneLimit:explorerState.swimlaneLimit,tableInterval:tableInterval.val,tableSeverity:tableSeverity.val,viewBySwimlaneFieldName:explorerState.viewBySwimlaneFieldName}||undefined;(0,_react.useEffect)((function(){loadExplorerData(loadExplorerDataConfig)}),[JSON.stringify(loadExplorerDataConfig)]);if(explorerState===undefined||refresh===undefined||showCharts===undefined){return null}return _react.default.createElement("div",{className:"ml-explorer"},_react.default.createElement(_explorer.Explorer,{explorerState:explorerState,setSelectedCells:setSelectedCells,showCharts:showCharts,severity:tableSeverity.val}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Explorer",{enumerable:true,get:function get(){return _explorer.Explorer}});var _explorer=__webpack_require__(1703)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Explorer=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireWildcard(__webpack_require__(28));var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);var _dsMin=_interopRequireDefault(__webpack_require__(1704));var _rxjs=__webpack_require__(33);var _operators=__webpack_require__(6);var _eui=__webpack_require__(29);var _annotation_flyout=__webpack_require__(243);var _annotations_table=__webpack_require__(240);var _components=__webpack_require__(1705);var _chart_tooltip=__webpack_require__(517);var _explorer_swimlane=__webpack_require__(1712);var _time_buckets=__webpack_require__(106);var _influencers_list=__webpack_require__(1725);var _explorer_dashboard_service=__webpack_require__(144);var _loading_indicator=__webpack_require__(209);var _navigation_menu=__webpack_require__(82);var _checkbox_showcharts=__webpack_require__(529);var _job_selector=__webpack_require__(523);var _select_interval=__webpack_require__(272);var _select_limit=__webpack_require__(530);var _select_severity=__webpack_require__(273);var _explorer_query_bar=__webpack_require__(1730);var _explorer_utils=__webpack_require__(93);var _legacy_utils=__webpack_require__(269);var _explorer_constants=__webpack_require__(86);var _explorer_charts_container=__webpack_require__(1731);var _anomalies_table=__webpack_require__(515);var _public=__webpack_require__(34);var _dependency_cache=__webpack_require__(5);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function mapSwimlaneOptionsToEuiOptions(options){return options.map((function(option){return{value:option,text:option}}))}var ExplorerPage=function ExplorerPage(_ref){var children=_ref.children,jobSelectorProps=_ref.jobSelectorProps,resizeRef=_ref.resizeRef;return _react.default.createElement("div",{ref:resizeRef,"data-test-subj":"mlPageAnomalyExplorer"},_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"explorer"}),_react.default.createElement(_eui.EuiPage,{style:{padding:"0px",background:"none"}},_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiScreenReaderOnly,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.pageTitle",defaultMessage:"Anomaly Explorer"}))),_react.default.createElement(_job_selector.JobSelector,jobSelectorProps),children)))};var Explorer=function(_React$Component){_inherits(Explorer,_React$Component);function Explorer(){var _getPrototypeOf2;var _this;_classCallCheck(this,Explorer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Explorer)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"state",{filterIconTriggeredQuery:undefined,language:_explorer_query_bar.DEFAULT_QUERY_LANG});_defineProperty(_assertThisInitialized(_this),"_unsubscribeAll",new _rxjs.Subject);_defineProperty(_assertThisInitialized(_this),"disableDragSelectOnMouseLeave",true);_defineProperty(_assertThisInitialized(_this),"dragSelect",new _dsMin.default({selectables:document.getElementsByClassName("sl-cell"),callback:function callback(elements){if(elements.length>1&&!_explorer_dashboard_service.ALLOW_CELL_RANGE_SELECTION){elements=[elements[0]]}if(elements.length>0){_explorer_dashboard_service.dragSelect$.next({action:_explorer_constants.DRAG_SELECT_ACTION.NEW_SELECTION,elements:elements})}this.disableDragSelectOnMouseLeave=true},onDragStart:function onDragStart(e){var target=e.target;while(target&&target!==document.body&&!target.classList.contains("sl-cell")){target=target.parentNode}if(_explorer_dashboard_service.ALLOW_CELL_RANGE_SELECTION&&target!==document.body){_explorer_dashboard_service.dragSelect$.next({action:_explorer_constants.DRAG_SELECT_ACTION.DRAG_START});this.disableDragSelectOnMouseLeave=false}},onElementSelect:function onElementSelect(){if(_explorer_dashboard_service.ALLOW_CELL_RANGE_SELECTION){_explorer_dashboard_service.dragSelect$.next({action:_explorer_constants.DRAG_SELECT_ACTION.ELEMENT_SELECT})}}}));_defineProperty(_assertThisInitialized(_this),"swimlaneRenderDoneListener",(function(){_this.dragSelect.clearSelection();_this.dragSelect.setSelectables(document.getElementsByClassName("sl-cell"))}));_defineProperty(_assertThisInitialized(_this),"resizeRef",(0,_react.createRef)());_defineProperty(_assertThisInitialized(_this),"resizeChecker",undefined);_defineProperty(_assertThisInitialized(_this),"resizeHandler",(function(){_explorer_dashboard_service.explorerService.setSwimlaneContainerWidth((0,_legacy_utils.getSwimlaneContainerWidth)())}));_defineProperty(_assertThisInitialized(_this),"viewByChangeHandler",(function(e){return _explorer_dashboard_service.explorerService.setViewBySwimlaneFieldName(e.target.value)}));_defineProperty(_assertThisInitialized(_this),"isSwimlaneSelectActive",false);_defineProperty(_assertThisInitialized(_this),"onSwimlaneEnterHandler",(function(){return _this.setSwimlaneSelectActive(true)}));_defineProperty(_assertThisInitialized(_this),"onSwimlaneLeaveHandler",(function(){return _this.setSwimlaneSelectActive(false)}));_defineProperty(_assertThisInitialized(_this),"setSwimlaneSelectActive",(function(active){if(_this.isSwimlaneSelectActive&&!active&&_this.disableDragSelectOnMouseLeave){_this.dragSelect.stop();_this.isSwimlaneSelectActive=active;return}if(!_this.isSwimlaneSelectActive&&active){_this.dragSelect.start();_this.dragSelect.clearSelection();_this.dragSelect.setSelectables(document.getElementsByClassName("sl-cell"));_this.isSwimlaneSelectActive=active}}));_defineProperty(_assertThisInitialized(_this),"swimlaneCellClick",(function(selectedCells){if(Object.keys(selectedCells).length===0){_this.props.setSelectedCells()}else{_this.props.setSelectedCells(selectedCells)}}));_defineProperty(_assertThisInitialized(_this),"applyFilter",(function(fieldName,fieldValue,action){var _this$props$explorerS=_this.props.explorerState,filterActive=_this$props$explorerS.filterActive,indexPattern=_this$props$explorerS.indexPattern,queryString=_this$props$explorerS.queryString;var newQueryString="";var operator="and ";var sanitizedFieldName=(0,_explorer_utils.escapeParens)(fieldName);var sanitizedFieldValue=(0,_explorer_utils.escapeDoubleQuotes)(fieldValue);if(action===_explorer_constants.FILTER_ACTION.ADD){var queryPattern=(0,_explorer_utils.getQueryPattern)(fieldName,fieldValue);if(queryString.match(queryPattern)!==null){return}newQueryString="".concat(queryString?"".concat(queryString," ").concat(operator):"").concat(sanitizedFieldName,':"').concat(sanitizedFieldValue,'"')}else if(action===_explorer_constants.FILTER_ACTION.REMOVE){if(filterActive===false){return}else{newQueryString=(0,_explorer_utils.removeFilterFromQueryString)(queryString,sanitizedFieldName,sanitizedFieldValue)}}_this.setState({filterIconTriggeredQuery:"".concat(newQueryString)});try{var _getKqlQueryValues=(0,_explorer_query_bar.getKqlQueryValues)({inputString:"".concat(newQueryString),queryLanguage:_this.state.language,indexPattern:indexPattern}),clearSettings=_getKqlQueryValues.clearSettings,settings=_getKqlQueryValues.settings;if(clearSettings===true){_explorer_dashboard_service.explorerService.clearInfluencerFilterSettings()}else{_explorer_dashboard_service.explorerService.setInfluencerFilterSettings(settings)}}catch(e){console.log("Invalid query syntax from table",e);var toastNotifications=(0,_dependency_cache.getToastNotifications)();toastNotifications.addDanger(_i18n.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessageFromTable",{defaultMessage:"Invalid syntax in query bar. The input must be valid Kibana Query Language (KQL)"}))}}));_defineProperty(_assertThisInitialized(_this),"updateLanguage",(function(language){return _this.setState({language:language})}));return _this}_createClass(Explorer,[{key:"componentDidMount",value:function componentDidMount(){_select_limit.limit$.pipe((0,_operators.takeUntil)(this._unsubscribeAll),(0,_operators.map)((function(d){return d.val}))).subscribe(_explorer_dashboard_service.explorerService.setSwimlaneLimit);this.resizeChecker=new _public.ResizeChecker(this.resizeRef.current);this.resizeChecker.on("resize",this.resizeHandler)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this._unsubscribeAll.next();this._unsubscribeAll.complete();this.resizeChecker.destroy()}},{key:"resetCache",value:function resetCache(){this.anomaliesTablePreviousArgs=null}},{key:"render",value:function render(){var _this$props=this.props,showCharts=_this$props.showCharts,severity=_this$props.severity;var _this$props$explorerS2=this.props.explorerState,annotationsData=_this$props$explorerS2.annotationsData,chartsData=_this$props$explorerS2.chartsData,filterActive=_this$props$explorerS2.filterActive,filterPlaceHolder=_this$props$explorerS2.filterPlaceHolder,indexPattern=_this$props$explorerS2.indexPattern,influencers=_this$props$explorerS2.influencers,loading=_this$props$explorerS2.loading,maskAll=_this$props$explorerS2.maskAll,noInfluencersConfigured=_this$props$explorerS2.noInfluencersConfigured,overallSwimlaneData=_this$props$explorerS2.overallSwimlaneData,queryString=_this$props$explorerS2.queryString,selectedCells=_this$props$explorerS2.selectedCells,selectedJobs=_this$props$explorerS2.selectedJobs,swimlaneContainerWidth=_this$props$explorerS2.swimlaneContainerWidth,tableData=_this$props$explorerS2.tableData,viewByLoadedForTimeFormatted=_this$props$explorerS2.viewByLoadedForTimeFormatted,viewBySwimlaneData=_this$props$explorerS2.viewBySwimlaneData,viewBySwimlaneDataLoading=_this$props$explorerS2.viewBySwimlaneDataLoading,viewBySwimlaneFieldName=_this$props$explorerS2.viewBySwimlaneFieldName,viewBySwimlaneOptions=_this$props$explorerS2.viewBySwimlaneOptions;var jobSelectorProps={dateFormatTz:(0,_explorer_utils.getDateFormatTz)()};var noJobsFound=selectedJobs===null||selectedJobs.length===0;var hasResults=overallSwimlaneData.points&&overallSwimlaneData.points.length>0;if(loading===true){return _react.default.createElement(ExplorerPage,{jobSelectorProps:jobSelectorProps,resizeRef:this.resizeRef},_react.default.createElement(_loading_indicator.LoadingIndicator,{label:_i18n.i18n.translate("xpack.ml.explorer.loadingLabel",{defaultMessage:"Loading"})}))}if(noJobsFound){return _react.default.createElement(ExplorerPage,{jobSelectorProps:jobSelectorProps,resizeRef:this.resizeRef},_react.default.createElement(_components.ExplorerNoJobsFound,null))}if(noJobsFound&&hasResults===false){return _react.default.createElement(ExplorerPage,{jobSelectorProps:jobSelectorProps,resizeRef:this.resizeRef},_react.default.createElement(_components.ExplorerNoResultsFound,null))}var mainColumnWidthClassName=noInfluencersConfigured===true?"col-xs-12":"col-xs-10";var mainColumnClasses="column ".concat(mainColumnWidthClassName);var showOverallSwimlane=overallSwimlaneData!==null&&overallSwimlaneData.laneLabels&&overallSwimlaneData.laneLabels.length>0;var showViewBySwimlane=viewBySwimlaneData!==null&&viewBySwimlaneData.laneLabels&&viewBySwimlaneData.laneLabels.length>0;var timefilter=(0,_dependency_cache.getTimefilter)();var bounds=timefilter.getActiveBounds();return _react.default.createElement(ExplorerPage,{jobSelectorProps:jobSelectorProps,resizeRef:this.resizeRef},_react.default.createElement("div",{className:"results-container"},_react.default.createElement(_chart_tooltip.ChartTooltip,null),noInfluencersConfigured===false&&influencers!==undefined&&_react.default.createElement("div",{className:"mlAnomalyExplorer__filterBar"},_react.default.createElement(_explorer_query_bar.ExplorerQueryBar,{filterActive:filterActive,filterPlaceHolder:filterPlaceHolder,indexPattern:indexPattern,queryString:queryString,filterIconTriggeredQuery:this.state.filterIconTriggeredQuery,updateLanguage:this.updateLanguage})),noInfluencersConfigured&&_react.default.createElement("div",{className:"no-influencers-warning"},_react.default.createElement(_eui.EuiIconTip,{content:_i18n.i18n.translate("xpack.ml.explorer.noConfiguredInfluencersTooltip",{defaultMessage:"The Top Influencers list is hidden because no influencers have been configured for the selected jobs."}),position:"right",type:"iInCircle"})),noInfluencersConfigured===false&&_react.default.createElement("div",{className:"column col-xs-2","data-test-subj":"mlAnomalyExplorerInfluencerList"},_react.default.createElement(_eui.EuiTitle,{className:"panel-title"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.topInfuencersTitle",defaultMessage:"Top influencers"}))),_react.default.createElement(_influencers_list.InfluencersList,{influencers:influencers,influencerFilter:this.applyFilter})),_react.default.createElement("div",{className:mainColumnClasses},_react.default.createElement(_eui.EuiTitle,{className:"panel-title"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelineTitle",defaultMessage:"Anomaly timeline"}))),_react.default.createElement("div",{className:"ml-explorer-swimlane euiText",onMouseEnter:this.onSwimlaneEnterHandler,onMouseLeave:this.onSwimlaneLeaveHandler,"data-test-subj":"mlAnomalyExplorerSwimlaneOverall"},showOverallSwimlane&&_react.default.createElement(_explorer_swimlane.ExplorerSwimlane,{chartWidth:swimlaneContainerWidth,filterActive:filterActive,maskAll:maskAll,TimeBuckets:_time_buckets.TimeBuckets,swimlaneCellClick:this.swimlaneCellClick,swimlaneData:overallSwimlaneData,swimlaneType:_explorer_constants.SWIMLANE_TYPE.OVERALL,selection:selectedCells,swimlaneRenderDoneListener:this.swimlaneRenderDoneListener})),viewBySwimlaneOptions.length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:true},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{label:_i18n.i18n.translate("xpack.ml.explorer.viewByLabel",{defaultMessage:"View by"})},_react.default.createElement(_eui.EuiSelect,{id:"selectViewBy",options:mapSwimlaneOptionsToEuiOptions(viewBySwimlaneOptions),value:viewBySwimlaneFieldName,onChange:this.viewByChangeHandler}))),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiFormRow,{label:_i18n.i18n.translate("xpack.ml.explorer.limitLabel",{defaultMessage:"Limit"})},_react.default.createElement(_select_limit.SelectLimit,null))),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{alignSelf:"center"}},_react.default.createElement(_eui.EuiFormRow,{label:"​"},_react.default.createElement("div",{className:"panel-sub-title"},viewByLoadedForTimeFormatted&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreForTimeFormattedLabel",defaultMessage:"(Sorted by max anomaly score for {viewByLoadedForTimeFormatted})",values:{viewByLoadedForTimeFormatted:viewByLoadedForTimeFormatted}}),viewByLoadedForTimeFormatted===undefined&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreLabel",defaultMessage:"(Sorted by max anomaly score)"}),filterActive===true&&viewBySwimlaneFieldName===_explorer_constants.VIEW_BY_JOB_LABEL&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.jobScoreAcrossAllInfluencersLabel",defaultMessage:"(Job score across all influencers)"}))))),showViewBySwimlane&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement("div",{className:"ml-explorer-swimlane euiText",onMouseEnter:this.onSwimlaneEnterHandler,onMouseLeave:this.onSwimlaneLeaveHandler,"data-test-subj":"mlAnomalyExplorerSwimlaneViewBy"},_react.default.createElement(_explorer_swimlane.ExplorerSwimlane,{chartWidth:swimlaneContainerWidth,filterActive:filterActive,maskAll:maskAll,TimeBuckets:_time_buckets.TimeBuckets,swimlaneCellClick:this.swimlaneCellClick,swimlaneData:viewBySwimlaneData,swimlaneType:_explorer_constants.SWIMLANE_TYPE.VIEW_BY,selection:selectedCells,swimlaneRenderDoneListener:this.swimlaneRenderDoneListener}))),viewBySwimlaneDataLoading&&_react.default.createElement(_loading_indicator.LoadingIndicator,null),!showViewBySwimlane&&!viewBySwimlaneDataLoading&&viewBySwimlaneFieldName!==null&&_react.default.createElement(_components.ExplorerNoInfluencersFound,{viewBySwimlaneFieldName:viewBySwimlaneFieldName,showFilterMessage:filterActive===true})),annotationsData.length>0&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiTitle,{className:"panel-title"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitle",defaultMessage:"Annotations"}))),_react.default.createElement(_annotations_table.AnnotationsTable,{annotations:annotationsData,drillDown:true,numberBadge:false}),_react.default.createElement(_annotation_flyout.AnnotationFlyout,null),_react.default.createElement(_eui.EuiSpacer,{size:"l"})),_react.default.createElement(_eui.EuiTitle,{className:"panel-title"},_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.anomaliesTitle",defaultMessage:"Anomalies"}))),_react.default.createElement(_eui.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:true,className:"ml-anomalies-controls"},_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:"170px"}},_react.default.createElement(_eui.EuiFormRow,{label:_i18n.i18n.translate("xpack.ml.explorer.severityThresholdLabel",{defaultMessage:"Severity threshold"})},_react.default.createElement(_select_severity.SelectSeverity,null))),_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{width:"170px"}},_react.default.createElement(_eui.EuiFormRow,{label:_i18n.i18n.translate("xpack.ml.explorer.intervalLabel",{defaultMessage:"Interval"})},_react.default.createElement(_select_interval.SelectInterval,null))),chartsData.seriesToPlot.length>0&&selectedCells!==undefined&&_react.default.createElement(_eui.EuiFlexItem,{grow:false,style:{alignSelf:"center"}},_react.default.createElement(_eui.EuiFormRow,{label:"​"},_react.default.createElement(_checkbox_showcharts.CheckboxShowCharts,null)))),_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement("div",{className:"euiText explorer-charts"},showCharts&&_react.default.createElement(_explorer_charts_container.ExplorerChartsContainer,_objectSpread({},chartsData,{severity:severity}))),_react.default.createElement(_anomalies_table.AnomaliesTable,{bounds:bounds,tableData:tableData,influencerFilter:this.applyFilter}))))}}]);return Explorer}(_react.default.Component);exports.Explorer=Explorer;_defineProperty(Explorer,"propTypes",{explorerState:_propTypes.default.object.isRequired,setSelectedCells:_propTypes.default.func.isRequired,severity:_propTypes.default.number.isRequired,showCharts:_propTypes.default.bool.isRequired})},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ExplorerNoInfluencersFound",{enumerable:true,get:function get(){return _explorer_no_influencers_found.ExplorerNoInfluencersFound}});Object.defineProperty(exports,"ExplorerNoJobsFound",{enumerable:true,get:function get(){return _explorer_no_jobs_found.ExplorerNoJobsFound}});Object.defineProperty(exports,"ExplorerNoResultsFound",{enumerable:true,get:function get(){return _explorer_no_results_found.ExplorerNoResultsFound}});var _explorer_no_influencers_found=__webpack_require__(1706);var _explorer_no_jobs_found=__webpack_require__(1708);var _explorer_no_results_found=__webpack_require__(1710)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ExplorerNoInfluencersFound",{enumerable:true,get:function get(){return _explorer_no_influencers_found.ExplorerNoInfluencersFound}});var _explorer_no_influencers_found=__webpack_require__(1707)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerNoInfluencersFound=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ExplorerNoInfluencersFound=function ExplorerNoInfluencersFound(_ref){var viewBySwimlaneFieldName=_ref.viewBySwimlaneFieldName,_ref$showFilterMessag=_ref.showFilterMessage,showFilterMessage=_ref$showFilterMessag===void 0?false:_ref$showFilterMessag;return _react.default.createElement(_eui.EuiEmptyPrompt,{titleSize:"xs",title:_react.default.createElement("h2",null,showFilterMessage===false&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.noInfluencersFoundTitle",defaultMessage:"No {viewBySwimlaneFieldName} influencers found",values:{viewBySwimlaneFieldName:viewBySwimlaneFieldName}}),showFilterMessage===true&&_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.noInfluencersFoundTitleFilterMessage",defaultMessage:"No {viewBySwimlaneFieldName} influencers found for specified filter",values:{viewBySwimlaneFieldName:viewBySwimlaneFieldName}}))})};exports.ExplorerNoInfluencersFound=ExplorerNoInfluencersFound;ExplorerNoInfluencersFound.propTypes={viewBySwimlaneFieldName:_propTypes.default.string.isRequired,showFilterMessage:_propTypes.default.bool}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ExplorerNoJobsFound",{enumerable:true,get:function get(){return _explorer_no_jobs_found.ExplorerNoJobsFound}});var _explorer_no_jobs_found=__webpack_require__(1709)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerNoJobsFound=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ExplorerNoJobsFound=function ExplorerNoJobsFound(){return _react.default.createElement(_eui.EuiEmptyPrompt,{iconType:"alert",title:_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.noJobsFoundLabel",defaultMessage:"No jobs found"})),actions:_react.default.createElement(_eui.EuiButton,{color:"primary",fill:true,href:"ml#/jobs"},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.createNewJobLinkText",defaultMessage:"Create job"})),"data-test-subj":"mlNoJobsFound"})};exports.ExplorerNoJobsFound=ExplorerNoJobsFound},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ExplorerNoResultsFound",{enumerable:true,get:function get(){return _explorer_no_results_found.ExplorerNoResultsFound}});var _explorer_no_results_found=__webpack_require__(1711)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerNoResultsFound=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _react2=__webpack_require__(30);var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ExplorerNoResultsFound=function ExplorerNoResultsFound(){return _react.default.createElement(_eui.EuiEmptyPrompt,{iconType:"iInCircle",title:_react.default.createElement("h2",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.noResultsFoundLabel",defaultMessage:"No results found"})),body:_react.default.createElement(_react.default.Fragment,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.tryWideningTimeSelectionLabel",defaultMessage:"Try widening the time selection or moving further back in time"})))})};exports.ExplorerNoResultsFound=ExplorerNoResultsFound},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerSwimlane=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _lodash=_interopRequireDefault(__webpack_require__(49));var _d=_interopRequireDefault(__webpack_require__(97));var _moment=_interopRequireDefault(__webpack_require__(32));var _date_utils=__webpack_require__(83);var _chart_utils=__webpack_require__(135);var _anomaly_utils=__webpack_require__(75);var _string_utils=__webpack_require__(80);var _chart_tooltip_service=__webpack_require__(134);var _explorer_dashboard_service=__webpack_require__(144);var _explorer_constants=__webpack_require__(86);var _i18n=__webpack_require__(1);var _entity_control=__webpack_require__(208);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var SCSS={mlDragselectDragging:"mlDragselectDragging",mlHideRangeSelection:"mlHideRangeSelection"};var ExplorerSwimlane=function(_React$Component){_inherits(ExplorerSwimlane,_React$Component);function ExplorerSwimlane(){var _getPrototypeOf2;var _this;_classCallCheck(this,ExplorerSwimlane);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(ExplorerSwimlane)).call.apply(_getPrototypeOf2,[this].concat(args)));_defineProperty(_assertThisInitialized(_this),"cellMouseoverActive",true);_defineProperty(_assertThisInitialized(_this),"dragSelectSubscriber",null);return _this}_createClass(ExplorerSwimlane,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;var previousSelectedData=null;this.dragSelectSubscriber=_explorer_dashboard_service.dragSelect$.subscribe((function(_ref){var action=_ref.action,_ref$elements=_ref.elements,elements=_ref$elements===void 0?[]:_ref$elements;var element=_d.default.select(_this2.rootNode.parentNode);var swimlaneType=_this2.props.swimlaneType;if(action===_explorer_constants.DRAG_SELECT_ACTION.NEW_SELECTION&&elements.length>0){element.classed(SCSS.mlDragselectDragging,false);var firstSelectedCell=_d.default.select(elements[0]).node().__clickData__;if(typeof firstSelectedCell!=="undefined"&&swimlaneType===firstSelectedCell.swimlaneType){var selectedData=elements.reduce((function(d,e){var cell=_d.default.select(e).node().__clickData__;d.bucketScore=Math.max(d.bucketScore,cell.bucketScore);d.laneLabels.push(cell.laneLabel);d.times.push(cell.time);return d}),{bucketScore:0,laneLabels:[],times:[]});selectedData.laneLabels=_lodash.default.uniq(selectedData.laneLabels);selectedData.times=_lodash.default.uniq(selectedData.times);if(_lodash.default.isEqual(selectedData,previousSelectedData)===false){if(selectedData.bucketScore===0){elements.map((function(e){return _d.default.select(e).classed("ds-selected",false)}));_this2.selectCell([],selectedData);previousSelectedData=null}else{_this2.selectCell(elements,selectedData);previousSelectedData=selectedData}}}_this2.cellMouseoverActive=true}else if(action===_explorer_constants.DRAG_SELECT_ACTION.ELEMENT_SELECT){element.classed(SCSS.mlDragselectDragging,true)}else if(action===_explorer_constants.DRAG_SELECT_ACTION.DRAG_START){previousSelectedData=null;_this2.cellMouseoverActive=false;_chart_tooltip_service.mlChartTooltipService.hide(true)}}));this.renderSwimlane()}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.renderSwimlane()}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(this.dragSelectSubscriber!==null){this.dragSelectSubscriber.unsubscribe()}var element=_d.default.select(this.rootNode);element.html("")}},{key:"selectCell",value:function selectCell(cellsToSelect,_ref2){var laneLabels=_ref2.laneLabels,bucketScore=_ref2.bucketScore,times=_ref2.times;var _this$props=this.props,selection=_this$props.selection,swimlaneCellClick=_this$props.swimlaneCellClick,swimlaneData=_this$props.swimlaneData,swimlaneType=_this$props.swimlaneType;var triggerNewSelection=false;if(cellsToSelect.length>1||bucketScore>0){triggerNewSelection=true}var oldSelection={selectedType:selection&&selection.type,selectedLanes:selection&&selection.lanes,selectedTimes:selection&&selection.times};var newSelection={selectedType:swimlaneType,selectedLanes:laneLabels,selectedTimes:_d.default.extent(times)};if(_lodash.default.isEqual(oldSelection,newSelection)){triggerNewSelection=false}if(triggerNewSelection===false){swimlaneCellClick({});return}var selectedCells={viewByFieldName:swimlaneData.fieldName,lanes:laneLabels,times:_d.default.extent(times),type:swimlaneType};swimlaneCellClick(selectedCells)}},{key:"highlightOverall",value:function highlightOverall(times){var overallSwimlane=_d.default.select(".ml-swimlane-overall");times.forEach((function(time){var overallCell=overallSwimlane.selectAll('div[data-time="'.concat(time,'"]')).selectAll(".sl-cell-inner,.sl-cell-inner-dragselect");overallCell.classed("sl-cell-inner-selected",true)}))}},{key:"highlightSelection",value:function highlightSelection(cellsToSelect,laneLabels,times){var swimlaneType=this.props.swimlaneType;var wrapper=_d.default.selectAll(".ml-explorer-swimlane");wrapper.selectAll(".lane-label").classed("lane-label-masked",true);wrapper.selectAll(".sl-cell-inner,.sl-cell-inner-dragselect").classed("sl-cell-inner-masked",true);wrapper.selectAll(".sl-cell-inner.sl-cell-inner-selected,.sl-cell-inner-dragselect.sl-cell-inner-selected").classed("sl-cell-inner-selected",false);_d.default.selectAll(cellsToSelect).selectAll(".sl-cell-inner,.sl-cell-inner-dragselect").classed("sl-cell-inner-masked",false).classed("sl-cell-inner-selected",true);var rootParent=_d.default.select(this.rootNode.parentNode);rootParent.selectAll(".lane-label").classed("lane-label-masked",(function(){return laneLabels.indexOf(_d.default.select(this).text())===-1}));if(swimlaneType==="viewBy"){this.highlightOverall(times)}}},{key:"maskIrrelevantSwimlanes",value:function maskIrrelevantSwimlanes(maskAll){if(maskAll===true){var allSwimlanes=_d.default.selectAll(".ml-explorer-swimlane");allSwimlanes.selectAll(".lane-label").classed("lane-label-masked",true);allSwimlanes.selectAll(".sl-cell-inner,.sl-cell-inner-dragselect").classed("sl-cell-inner-masked",true)}else{var overallSwimlane=_d.default.select(".ml-swimlane-overall");overallSwimlane.selectAll(".lane-label").classed("lane-label-masked",true);overallSwimlane.selectAll(".sl-cell-inner,.sl-cell-inner-dragselect").classed("sl-cell-inner-masked",true)}}},{key:"clearSelection",value:function clearSelection(){var wrapper=_d.default.selectAll(".ml-explorer-swimlane");wrapper.selectAll(".lane-label").classed("lane-label-masked",false);wrapper.selectAll(".sl-cell-inner").classed("sl-cell-inner-masked",false);wrapper.selectAll(".sl-cell-inner.sl-cell-inner-selected").classed("sl-cell-inner-selected",false);wrapper.selectAll(".sl-cell-inner-dragselect.sl-cell-inner-selected").classed("sl-cell-inner-selected",false);wrapper.selectAll(".ds-selected").classed("sl-cell-inner-selected",false)}},{key:"renderSwimlane",value:function renderSwimlane(){var _this3=this;var element=_d.default.select(this.rootNode.parentNode);if(!_explorer_dashboard_service.ALLOW_CELL_RANGE_SELECTION){element.classed(SCSS.mlHideRangeSelection,true)}var getCellMouseoverActive=function getCellMouseoverActive(){return _this3.cellMouseoverActive};var _this$props2=this.props,chartWidth=_this$props2.chartWidth,filterActive=_this$props2.filterActive,maskAll=_this$props2.maskAll,TimeBuckets=_this$props2.TimeBuckets,swimlaneCellClick=_this$props2.swimlaneCellClick,swimlaneData=_this$props2.swimlaneData,swimlaneType=_this$props2.swimlaneType,selection=_this$props2.selection;var lanes=swimlaneData.laneLabels,startTime=swimlaneData.earliest,endTime=swimlaneData.latest,stepSecs=swimlaneData.interval,points=swimlaneData.points;function colorScore(value){return(0,_anomaly_utils.getSeverityColor)(value)}var numBuckets=parseInt((endTime-startTime)/stepSecs);var cellHeight=30;var height=(lanes.length+1)*cellHeight-10;var laneLabelWidth=170;element.style("height","".concat(height+20,"px"));var swimlanes=element.select(".ml-swimlanes");swimlanes.html("");var cellWidth=Math.floor(chartWidth/numBuckets*100)/100;var xAxisWidth=cellWidth*numBuckets;var xAxisScale=_d.default.time.scale().domain([new Date(startTime*1e3),new Date(endTime*1e3)]).range([0,xAxisWidth]);var timeBuckets=new TimeBuckets;timeBuckets.setInterval("".concat(stepSecs,"s"));var xAxisTickFormat=timeBuckets.getScaledDateFormat();function cellMouseOverFactory(time,i){return function(lane){var bucketScore=getBucketScore(lane,time);if(bucketScore!==0){lane=lane===""?_entity_control.EMPTY_FIELD_VALUE_LABEL:lane;cellMouseover(this,lane,bucketScore,i,time)}}}function cellMouseover(target,laneLabel,bucketScore,index,time){if(bucketScore===undefined||getCellMouseoverActive()===false){return}var displayScore=bucketScore>1?parseInt(bucketScore):"< 1";var formattedDate=(0,_date_utils.formatHumanReadableDateTime)(time*1e3);var tooltipData=[{label:formattedDate}];if(swimlaneData.fieldName!==undefined){tooltipData.push({label:swimlaneData.fieldName,value:laneLabel,seriesIdentifier:{key:laneLabel},valueAccessor:"fieldName"})}tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.swimlane.maxAnomalyScoreLabel",{defaultMessage:"Max anomaly score"}),value:displayScore,color:colorScore(displayScore),seriesIdentifier:{key:laneLabel},valueAccessor:"anomaly_score"});var offsets=target.className==="sl-cell-inner"?{x:6,y:0}:{x:8,y:1};_chart_tooltip_service.mlChartTooltipService.show(tooltipData,target,{x:target.offsetWidth+offsets.x,y:6+offsets.y})}function cellMouseleave(){_chart_tooltip_service.mlChartTooltipService.hide()}var d3Lanes=swimlanes.selectAll(".lane").data(lanes);var d3LanesEnter=d3Lanes.enter().append("div").classed("lane",true);d3LanesEnter.append("div").classed("lane-label",true).style("width","".concat(laneLabelWidth,"px")).html((function(label){var showFilterContext=filterActive===true&&label==="Overall";if(showFilterContext){return _i18n.i18n.translate("xpack.ml.explorer.overallSwimlaneUnfilteredLabel",{defaultMessage:"{label} (unfiltered)",values:{label:(0,_string_utils.mlEscape)(label)}})}else{return label===""?"<i>".concat(_entity_control.EMPTY_FIELD_VALUE_LABEL,"</i>"):(0,_string_utils.mlEscape)(label)}})).on("click",(function(){if(selection&&typeof selection.lanes!=="undefined"){swimlaneCellClick({})}})).each((function(){var _this4=this;if(swimlaneData.fieldName!==undefined){_d.default.select(this).on("mouseover",(function(value){_chart_tooltip_service.mlChartTooltipService.show([{skipHeader:true},{label:swimlaneData.fieldName,value:value===""?_entity_control.EMPTY_FIELD_VALUE_LABEL:value,seriesIdentifier:{key:value},valueAccessor:"fieldName"}],_this4,{x:laneLabelWidth,y:0})})).on("mouseout",(function(){_chart_tooltip_service.mlChartTooltipService.hide()})).attr("aria-label",(function(value){return"".concat((0,_string_utils.mlEscape)(swimlaneData.fieldName),": ").concat((0,_string_utils.mlEscape)(value))}))}}));var cellsContainer=d3LanesEnter.append("div").classed("cells-container",true);function getBucketScore(lane,time){var bucketScore=0;var point=points.find((function(p){return p.value>0&&p.laneLabel===lane&&p.time===time}));if(typeof point!=="undefined"){bucketScore=point.value}return bucketScore}var time=startTime;Array(numBuckets||0).fill(null).forEach((function(v,i){var cell=cellsContainer.append("div").classed("sl-cell",true).style("width","".concat(cellWidth,"px")).attr("data-lane-label",(function(label){return(0,_string_utils.mlEscape)(label)})).attr("data-time",time).attr("data-bucket-score",(function(lane){return getBucketScore(lane,time)})).on("mouseover",cellMouseOverFactory(time,i)).on("mouseleave",cellMouseleave).each((function(laneLabel){this.__clickData__={bucketScore:getBucketScore(laneLabel,time),laneLabel:laneLabel,swimlaneType:swimlaneType,time:time}}));cell.append("div").each((function(lane){var el=_d.default.select(this);var color="none";var bucketScore=0;var point=points.find((function(p){return p.value>0&&p.laneLabel===lane&&p.time===time}));if(typeof point!=="undefined"){bucketScore=point.value;color=colorScore(bucketScore);el.classed("sl-cell-inner",true).style("background-color",color)}else{el.classed("sl-cell-inner-dragselect",true)}}));time+=stepSecs}));var laneTimes=swimlanes.selectAll(".time-tick-labels").data(["x-axis"]).enter().append("div").classed("time-tick-labels",true);var svgHeight=25;var svg=laneTimes.append("svg").attr("width",chartWidth).attr("height",svgHeight);var xAxis=_d.default.svg.axis().scale(xAxisScale).ticks((0,_chart_utils.numTicksForDateFormat)(chartWidth,xAxisTickFormat)).tickFormat((function(tick){return(0,_moment.default)(tick).format(xAxisTickFormat)}));var gAxis=svg.append("g").attr("class","x axis").call(xAxis);var overlapCheck=0;gAxis.selectAll("g.tick").each((function(){var tick=_d.default.select(this);var xTransform=_d.default.transform(tick.attr("transform")).translate[0];var tickWidth=tick.select("text").node().getBBox().width;var xMinOffset=xTransform-tickWidth/2;var xMaxOffset=xTransform+tickWidth/2;if(xMinOffset<overlapCheck){tick.remove()}else{overlapCheck=xTransform+tickWidth/2}if(xMaxOffset>chartWidth){tick.remove()}}));var selectionState=selection;var selectedType=_lodash.default.get(selectionState,"type",undefined);var selectionViewByFieldName=_lodash.default.get(selectionState,"viewByFieldName","");if(swimlaneType!==selectedType&&selectedType!==undefined){element.selectAll(".lane-label").classed("lane-label-masked",true);element.selectAll(".sl-cell-inner").classed("sl-cell-inner-masked",true)}this.props.swimlaneRenderDoneListener();if((swimlaneType!==selectedType||swimlaneData.fieldName!==undefined&&swimlaneData.fieldName!==selectionViewByFieldName)&&filterActive===false){return}var cellsToSelect=[];var selectedLanes=_lodash.default.get(selectionState,"lanes",[]);var selectedTimes=_lodash.default.get(selectionState,"times",[]);var selectedTimeExtent=_d.default.extent(selectedTimes);selectedLanes.forEach((function(selectedLane){if(lanes.indexOf(selectedLane)>-1&&selectedTimeExtent[0]>=startTime&&selectedTimeExtent[1]<=endTime){var swimlaneElements=element.select(".ml-swimlanes");var laneCells=swimlaneElements.selectAll('div[data-lane-label="'.concat((0,_string_utils.mlEscape)(selectedLane),'"]'));laneCells.each((function(){var cell=_d.default.select(this);var cellTime=cell.attr("data-time");if(cellTime>=selectedTimeExtent[0]&&cellTime<=selectedTimeExtent[1]){cellsToSelect.push(cell.node())}}))}}));var selectedMaxBucketScore=cellsToSelect.reduce((function(maxBucketScore,cell){return Math.max(maxBucketScore,+_d.default.select(cell).attr("data-bucket-score")||0)}),0);var selectedCellTimes=cellsToSelect.map((function(e){return _d.default.select(e).node().__clickData__.time}));if(cellsToSelect.length>1||selectedMaxBucketScore>0){this.highlightSelection(cellsToSelect,selectedLanes,selectedCellTimes)}else if(filterActive===true){if(selectedCellTimes.length>0){this.highlightOverall(selectedCellTimes)}this.maskIrrelevantSwimlanes(maskAll)}else{this.clearSelection()}}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(){return true}},{key:"setRef",value:function setRef(componentNode){this.rootNode=componentNode}},{key:"render",value:function render(){var swimlaneType=this.props.swimlaneType;return _react.default.createElement("div",{className:"ml-swimlanes ml-swimlane-".concat(swimlaneType),ref:this.setRef.bind(this)})}}]);return ExplorerSwimlane}(_react.default.Component);exports.ExplorerSwimlane=ExplorerSwimlane;_defineProperty(ExplorerSwimlane,"propTypes",{chartWidth:_propTypes.default.number.isRequired,filterActive:_propTypes.default.bool,maskAll:_propTypes.default.bool,TimeBuckets:_propTypes.default.func.isRequired,swimlaneCellClick:_propTypes.default.func.isRequired,swimlaneData:_propTypes.default.shape({laneLabels:_propTypes.default.array.isRequired}).isRequired,swimlaneType:_propTypes.default.string.isRequired,selection:_propTypes.default.object,swimlaneRenderDoneListener:_propTypes.default.func.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.jobSelectionActionCreator=jobSelectionActionCreator;var _rxjs=__webpack_require__(33);var _operators=__webpack_require__(6);var _field_format_service=__webpack_require__(112);var _job_service=__webpack_require__(58);var _explorer_constants=__webpack_require__(86);var _explorer_utils=__webpack_require__(93);function jobSelectionActionCreator(selectedJobIds){return(0,_rxjs.from)(_field_format_service.mlFieldFormatService.populateFormats(selectedJobIds)).pipe((0,_operators.map)((function(resp){if(resp.err){console.log("Error populating field formats:",resp.err);return null}var jobs=(0,_explorer_utils.createJobs)(_job_service.mlJobService.jobs).map((function(job){job.selected=selectedJobIds.some((function(id){return job.id===id}));return job}));var selectedJobs=jobs.filter((function(job){return job.selected}));return{type:_explorer_constants.EXPLORER_ACTION.JOB_SELECTION_CHANGE,payload:{loading:false,selectedJobs:selectedJobs}}})))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useExplorerData=exports.isLoadExplorerDataConfig=void 0;var _memoizeOne=_interopRequireDefault(__webpack_require__(492));var _lodash=__webpack_require__(49);var _useObservable=_interopRequireDefault(__webpack_require__(129));var _rxjs=__webpack_require__(33);var _operators=__webpack_require__(6);var _explorer_charts_container_service=__webpack_require__(277);var _explorer_dashboard_service=__webpack_require__(144);var _explorer_utils=__webpack_require__(93);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var memoizeIsEqual=function memoizeIsEqual(newArgs,lastArgs){return(0,_lodash.isEqual)(newArgs,lastArgs)};var wrapWithLastRefreshArg=function wrapWithLastRefreshArg(func){return function(lastRefresh){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}return func.apply(null,args)}};var memoize=function memoize(func){return(0,_memoizeOne.default)(wrapWithLastRefreshArg(func),memoizeIsEqual)};var memoizedAnomalyDataChange=memoize(_explorer_charts_container_service.anomalyDataChange);var memoizedLoadAnnotationsTableData=memoize(_explorer_utils.loadAnnotationsTableData);var memoizedLoadDataForCharts=memoize(_explorer_utils.loadDataForCharts);var memoizedLoadFilteredTopInfluencers=memoize(_explorer_utils.loadFilteredTopInfluencers);var memoizedLoadOverallData=memoize(_explorer_utils.loadOverallData);var memoizedLoadTopInfluencers=memoize(_explorer_utils.loadTopInfluencers);var memoizedLoadViewBySwimlane=memoize(_explorer_utils.loadViewBySwimlane);var memoizedLoadAnomaliesTableData=memoize(_explorer_utils.loadAnomaliesTableData);var isLoadExplorerDataConfig=function isLoadExplorerDataConfig(arg){return arg!==undefined&&arg.bounds!==undefined&&arg.selectedJobs!==undefined&&arg.selectedJobs!==null&&arg.viewBySwimlaneFieldName!==undefined};exports.isLoadExplorerDataConfig=isLoadExplorerDataConfig;function loadExplorerData(config){if(!isLoadExplorerDataConfig(config)){return(0,_rxjs.of)({})}var bounds=config.bounds,lastRefresh=config.lastRefresh,influencersFilterQuery=config.influencersFilterQuery,noInfluencersConfigured=config.noInfluencersConfigured,selectedCells=config.selectedCells,selectedJobs=config.selectedJobs,swimlaneBucketInterval=config.swimlaneBucketInterval,swimlaneLimit=config.swimlaneLimit,tableInterval=config.tableInterval,tableSeverity=config.tableSeverity,viewBySwimlaneFieldName=config.viewBySwimlaneFieldName;var selectionInfluencers=(0,_explorer_utils.getSelectionInfluencers)(selectedCells,viewBySwimlaneFieldName);var jobIds=(0,_explorer_utils.getSelectionJobIds)(selectedCells,selectedJobs);var timerange=(0,_explorer_utils.getSelectionTimeRange)(selectedCells,swimlaneBucketInterval.asSeconds(),bounds);var dateFormatTz=(0,_explorer_utils.getDateFormatTz)();return(0,_rxjs.forkJoin)({annotationsData:memoizedLoadAnnotationsTableData(lastRefresh,selectedCells,selectedJobs,swimlaneBucketInterval.asSeconds(),bounds),anomalyChartRecords:memoizedLoadDataForCharts(lastRefresh,jobIds,timerange.earliestMs,timerange.latestMs,selectionInfluencers,selectedCells,influencersFilterQuery),influencers:selectionInfluencers.length===0?memoizedLoadTopInfluencers(lastRefresh,jobIds,timerange.earliestMs,timerange.latestMs,[],noInfluencersConfigured,influencersFilterQuery):Promise.resolve({}),overallState:memoizedLoadOverallData(lastRefresh,selectedJobs,swimlaneBucketInterval,bounds),tableData:memoizedLoadAnomaliesTableData(lastRefresh,selectedCells,selectedJobs,dateFormatTz,swimlaneBucketInterval.asSeconds(),bounds,viewBySwimlaneFieldName,tableInterval,tableSeverity,influencersFilterQuery),topFieldValues:selectedCells!==undefined&&selectedCells.showTopFieldValues===true?(0,_explorer_utils.loadViewByTopFieldValuesForSelectedTime)(timerange.earliestMs,timerange.latestMs,selectedJobs,viewBySwimlaneFieldName,swimlaneLimit,noInfluencersConfigured):Promise.resolve([])}).pipe((0,_operators.tap)(_explorer_dashboard_service.explorerService.setViewBySwimlaneLoading),(0,_operators.tap)((function(_ref){var anomalyChartRecords=_ref.anomalyChartRecords;if(selectedCells!==undefined&&Array.isArray(anomalyChartRecords)){memoizedAnomalyDataChange(lastRefresh,anomalyChartRecords,timerange.earliestMs,timerange.latestMs,tableSeverity)}else{memoizedAnomalyDataChange(lastRefresh,[],timerange.earliestMs,timerange.latestMs,tableSeverity)}})),(0,_operators.mergeMap)((function(_ref2){var anomalyChartRecords=_ref2.anomalyChartRecords,influencers=_ref2.influencers,overallState=_ref2.overallState,topFieldValues=_ref2.topFieldValues;return(0,_rxjs.forkJoin)({influencers:(selectionInfluencers.length>0||influencersFilterQuery!==undefined)&&anomalyChartRecords!==undefined&&anomalyChartRecords.length>0?memoizedLoadFilteredTopInfluencers(lastRefresh,jobIds,timerange.earliestMs,timerange.latestMs,anomalyChartRecords,selectionInfluencers,noInfluencersConfigured,influencersFilterQuery):Promise.resolve(influencers),viewBySwimlaneState:memoizedLoadViewBySwimlane(lastRefresh,topFieldValues,{earliest:overallState.overallSwimlaneData.earliest,latest:overallState.overallSwimlaneData.latest},selectedJobs,viewBySwimlaneFieldName,swimlaneLimit,influencersFilterQuery,noInfluencersConfigured)})}),(function(_ref3,_ref4){var annotationsData=_ref3.annotationsData,overallState=_ref3.overallState,tableData=_ref3.tableData;var influencers=_ref4.influencers,viewBySwimlaneState=_ref4.viewBySwimlaneState;return _objectSpread({annotationsData:annotationsData,influencers:influencers},overallState,{},viewBySwimlaneState,{tableData:tableData})})))}var loadExplorerData$=new _rxjs.Subject;var explorerData$=loadExplorerData$.pipe((0,_operators.switchMap)((function(config){return loadExplorerData(config)})));var useExplorerData=function useExplorerData(){var explorerData=(0,_useObservable.default)(explorerData$);return[explorerData,function(c){return loadExplorerData$.next(c)}]};exports.useExplorerData=useExplorerData},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buildConfig=buildConfig;var _lodash=_interopRequireDefault(__webpack_require__(49));var _parse_interval=__webpack_require__(74);var _anomaly_utils=__webpack_require__(75);var _chart_config_builder=__webpack_require__(521);var _job_service=__webpack_require__(58);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buildConfig(record){var job=_job_service.mlJobService.getJob(record.job_id);var detectorIndex=record.detector_index;var config=(0,_chart_config_builder.buildConfigFromDetector)(job,detectorIndex);config.functionDescription=record.function_description;config.bucketSpanSeconds=(0,_parse_interval.parseInterval)(job.analysis_config.bucket_span).asSeconds();config.detectorLabel=record.function;if(_lodash.default.has(_job_service.mlJobService.detectorsByJob,record.job_id)&&detectorIndex<_job_service.mlJobService.detectorsByJob[record.job_id].length){config.detectorLabel=_job_service.mlJobService.detectorsByJob[record.job_id][detectorIndex].detector_description}else{if(record.field_name!==undefined){config.detectorLabel+=" ".concat(config.fieldName)}}if(record.field_name!==undefined){config.fieldName=record.field_name;config.metricFieldName=record.field_name}config.entityFields=(0,_anomaly_utils.getEntityFieldList)(record);var functionLabel=config.metricFunction;if(config.metricFieldName!==undefined){functionLabel+=" ".concat(config.metricFieldName)}config.infoTooltip={jobId:record.job_id,aggregationInterval:config.interval,chartFunction:functionLabel,entityFields:config.entityFields.map((function(f){return{fieldName:f.fieldName,fieldValue:f.fieldValue}}))};return config}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"explorerReducer",{enumerable:true,get:function get(){return _explorer_reducer.explorerReducer}});Object.defineProperty(exports,"getExplorerDefaultState",{enumerable:true,get:function get(){return _explorer_reducer.getExplorerDefaultState}});Object.defineProperty(exports,"getIndexPattern",{enumerable:true,get:function get(){return _explorer_reducer.getIndexPattern}});Object.defineProperty(exports,"ExplorerState",{enumerable:true,get:function get(){return _explorer_reducer.ExplorerState}});var _explorer_reducer=__webpack_require__(1717)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"getIndexPattern",{enumerable:true,get:function get(){return _get_index_pattern.getIndexPattern}});Object.defineProperty(exports,"explorerReducer",{enumerable:true,get:function get(){return _reducer.explorerReducer}});Object.defineProperty(exports,"getExplorerDefaultState",{enumerable:true,get:function get(){return _state.getExplorerDefaultState}});Object.defineProperty(exports,"ExplorerState",{enumerable:true,get:function get(){return _state.ExplorerState}});var _get_index_pattern=__webpack_require__(528);var _reducer=__webpack_require__(1718);var _state=__webpack_require__(1724)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.explorerReducer=void 0;var _date_utils=__webpack_require__(83);var _explorer_charts_container_service=__webpack_require__(277);var _explorer_constants=__webpack_require__(86);var _explorer_utils=__webpack_require__(93);var _check_selected_cells=__webpack_require__(1719);var _clear_influencer_filter_settings=__webpack_require__(1720);var _job_selection_change=__webpack_require__(1721);var _set_influencer_filter_settings=__webpack_require__(1722);var _set_kql_query_bar_placeholder=__webpack_require__(1723);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var explorerReducer=function explorerReducer(state,nextAction){var type=nextAction.type,payload=nextAction.payload;var nextState;switch(type){case _explorer_constants.EXPLORER_ACTION.CLEAR_INFLUENCER_FILTER_SETTINGS:nextState=(0,_clear_influencer_filter_settings.clearInfluencerFilterSettings)(state);break;case _explorer_constants.EXPLORER_ACTION.CLEAR_JOBS:nextState=_objectSpread({},state,{},(0,_explorer_utils.getClearedSelectedAnomaliesState)(),{loading:false,selectedJobs:[]});break;case _explorer_constants.EXPLORER_ACTION.JOB_SELECTION_CHANGE:nextState=(0,_job_selection_change.jobSelectionChange)(state,payload);break;case _explorer_constants.EXPLORER_ACTION.SET_BOUNDS:nextState=_objectSpread({},state,{bounds:payload});break;case _explorer_constants.EXPLORER_ACTION.SET_CHARTS:nextState=_objectSpread({},state,{chartsData:_objectSpread({},(0,_explorer_charts_container_service.getDefaultChartsData)(),{chartsPerRow:payload.chartsPerRow,seriesToPlot:payload.seriesToPlot,tooManyBuckets:!!payload.tooManyBuckets})});break;case _explorer_constants.EXPLORER_ACTION.SET_INFLUENCER_FILTER_SETTINGS:nextState=(0,_set_influencer_filter_settings.setInfluencerFilterSettings)(state,payload);break;case _explorer_constants.EXPLORER_ACTION.SET_SELECTED_CELLS:var _selectedCells=payload;nextState=_objectSpread({},state,{selectedCells:_selectedCells});break;case _explorer_constants.EXPLORER_ACTION.SET_EXPLORER_DATA:case _explorer_constants.EXPLORER_ACTION.SET_FILTER_DATA:nextState=_objectSpread({},state,{},payload);break;case _explorer_constants.EXPLORER_ACTION.SET_SWIMLANE_CONTAINER_WIDTH:if(state.noInfluencersConfigured===true){nextState=_objectSpread({},state,{swimlaneContainerWidth:payload-250})}else{nextState=_objectSpread({},state,{swimlaneContainerWidth:payload/6*5-220})}break;case _explorer_constants.EXPLORER_ACTION.SET_SWIMLANE_LIMIT:nextState=_objectSpread({},state,{swimlaneLimit:payload});break;case _explorer_constants.EXPLORER_ACTION.SET_VIEW_BY_SWIMLANE_FIELD_NAME:var filteredFields=state.filteredFields,influencersFilterQuery=state.influencersFilterQuery;var _viewBySwimlaneFieldName=payload;var maskAll=false;if(influencersFilterQuery!==undefined){maskAll=_viewBySwimlaneFieldName===_explorer_constants.VIEW_BY_JOB_LABEL||filteredFields.includes(_viewBySwimlaneFieldName)===false}nextState=_objectSpread({},state,{},(0,_explorer_utils.getClearedSelectedAnomaliesState)(),{maskAll:maskAll,viewBySwimlaneFieldName:_viewBySwimlaneFieldName});break;case _explorer_constants.EXPLORER_ACTION.SET_VIEW_BY_SWIMLANE_LOADING:var annotationsData=payload.annotationsData,overallState=payload.overallState,tableData=payload.tableData;nextState=_objectSpread({},state,{annotationsData:annotationsData},overallState,{tableData:tableData,viewBySwimlaneData:_objectSpread({},(0,_explorer_utils.getDefaultSwimlaneData)()),viewBySwimlaneDataLoading:true});break;default:nextState=state}if(nextState.selectedJobs===null||nextState.bounds===undefined){return nextState}var swimlaneBucketInterval=(0,_explorer_utils.getSwimlaneBucketInterval)(nextState.selectedJobs,nextState.swimlaneContainerWidth);var _getViewBySwimlaneOpt=(0,_explorer_utils.getViewBySwimlaneOptions)({currentViewBySwimlaneFieldName:nextState.viewBySwimlaneFieldName,filterActive:nextState.filterActive,filteredFields:nextState.filteredFields,isAndOperator:nextState.isAndOperator,selectedJobs:nextState.selectedJobs,selectedCells:nextState.selectedCells}),viewBySwimlaneFieldName=_getViewBySwimlaneOpt.viewBySwimlaneFieldName,viewBySwimlaneOptions=_getViewBySwimlaneOpt.viewBySwimlaneOptions;var _nextState=nextState,bounds=_nextState.bounds,selectedCells=_nextState.selectedCells;var timerange=(0,_explorer_utils.getSelectionTimeRange)(selectedCells,swimlaneBucketInterval.asSeconds(),bounds);return _objectSpread({},nextState,{swimlaneBucketInterval:swimlaneBucketInterval,viewByLoadedForTimeFormatted:selectedCells!==undefined&&selectedCells.showTopFieldValues===true?(0,_date_utils.formatHumanReadableDateTime)(timerange.earliestMs):null,viewBySwimlaneFieldName:viewBySwimlaneFieldName,viewBySwimlaneOptions:viewBySwimlaneOptions},(0,_check_selected_cells.checkSelectedCells)(nextState),{},(0,_set_kql_query_bar_placeholder.setKqlQueryBarPlaceholder)(nextState))};exports.explorerReducer=explorerReducer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.checkSelectedCells=void 0;var _explorer_constants=__webpack_require__(86);var _explorer_utils=__webpack_require__(93);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var checkSelectedCells=function checkSelectedCells(state){var filterActive=state.filterActive,loading=state.loading,selectedCells=state.selectedCells,viewBySwimlaneData=state.viewBySwimlaneData,viewBySwimlaneDataLoading=state.viewBySwimlaneDataLoading;if(loading||viewBySwimlaneDataLoading){return{}}var clearSelection=false;if(selectedCells!==undefined&&selectedCells!==null&&selectedCells.type===_explorer_constants.SWIMLANE_TYPE.VIEW_BY&&viewBySwimlaneData!==undefined&&viewBySwimlaneData.points!==undefined&&viewBySwimlaneData.points.length>0){clearSelection=filterActive===false&&!selectedCells.lanes.some((function(lane){return viewBySwimlaneData.points.some((function(point){return point.laneLabel===lane&&point.time>=selectedCells.times[0]&&point.time<=selectedCells.times[1]}))}))}if(clearSelection===true){return _objectSpread({},(0,_explorer_utils.getClearedSelectedAnomaliesState)())}return{}};exports.checkSelectedCells=checkSelectedCells},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.clearInfluencerFilterSettings=clearInfluencerFilterSettings;var _explorer_utils=__webpack_require__(93);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function clearInfluencerFilterSettings(state){return _objectSpread({},state,{filterActive:false,filteredFields:[],influencersFilterQuery:undefined,isAndOperator:false,maskAll:false,queryString:"",tableQueryString:""},(0,_explorer_utils.getClearedSelectedAnomaliesState)())}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.jobSelectionChange=void 0;var _explorer_utils=__webpack_require__(93);var _get_index_pattern=__webpack_require__(528);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var jobSelectionChange=function jobSelectionChange(state,payload){var selectedJobs=payload.selectedJobs;var stateUpdate=_objectSpread({},state,{noInfluencersConfigured:(0,_explorer_utils.getInfluencers)(selectedJobs).length===0,overallSwimlaneData:(0,_explorer_utils.getDefaultSwimlaneData)(),selectedJobs:selectedJobs});if(stateUpdate.noInfluencersConfigured===true){var noFilterState={filterActive:false,filteredFields:[],influencersFilterQuery:undefined,maskAll:false,queryString:"",tableQueryString:""};Object.assign(stateUpdate,noFilterState)}else{stateUpdate.indexPattern=(0,_get_index_pattern.getIndexPattern)(selectedJobs)}stateUpdate.loading=true;return stateUpdate};exports.jobSelectionChange=jobSelectionChange},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setInfluencerFilterSettings=setInfluencerFilterSettings;var _explorer_constants=__webpack_require__(86);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function setInfluencerFilterSettings(state,payload){var influencersFilterQuery=payload.filterQuery,isAndOperator=payload.isAndOperator,filteredFields=payload.filteredFields,queryString=payload.queryString,tableQueryString=payload.tableQueryString;var selectedCells=state.selectedCells,viewBySwimlaneOptions=state.viewBySwimlaneOptions;var selectedViewByFieldName=state.viewBySwimlaneFieldName;var filteredViewBySwimlaneOptions=viewBySwimlaneOptions.filter((function(d){return filteredFields.includes(d)}));if(isAndOperator&&selectedCells===undefined){selectedViewByFieldName=_explorer_constants.VIEW_BY_JOB_LABEL}else{for(var i=0;i<filteredFields.length;i++){if(filteredViewBySwimlaneOptions.includes(filteredFields[i])&&(selectedCells===undefined||selectedCells&&selectedCells.type==="overall")){selectedViewByFieldName=filteredFields[i];break}}}return _objectSpread({},state,{filterActive:true,filteredFields:filteredFields,influencersFilterQuery:influencersFilterQuery,isAndOperator:isAndOperator,queryString:queryString,tableQueryString:tableQueryString,maskAll:selectedViewByFieldName===_explorer_constants.VIEW_BY_JOB_LABEL||filteredFields.includes(selectedViewByFieldName)===false,viewBySwimlaneFieldName:selectedViewByFieldName,viewBySwimlaneOptions:filteredViewBySwimlaneOptions})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setKqlQueryBarPlaceholder=void 0;var _i18n=__webpack_require__(1);var setKqlQueryBarPlaceholder=function setKqlQueryBarPlaceholder(state){var influencers=state.influencers,noInfluencersConfigured=state.noInfluencersConfigured;if(influencers!==undefined&&!noInfluencersConfigured){for(var influencerName in influencers){if(influencers[influencerName][0]&&influencers[influencerName][0].influencerFieldValue){return{filterPlaceHolder:_i18n.i18n.translate("xpack.ml.explorer.kueryBar.filterPlaceholder",{defaultMessage:"Filter by influencer fields… ({queryExample})",values:{queryExample:"".concat(influencerName," : ").concat(influencers[influencerName][0].influencerFieldValue)}})}}}}return{}};exports.setKqlQueryBarPlaceholder=setKqlQueryBarPlaceholder},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getExplorerDefaultState=getExplorerDefaultState;var _index_patterns=__webpack_require__(120);var _explorer_charts_container_service=__webpack_require__(277);var _explorer_utils=__webpack_require__(93);function getDefaultIndexPattern(){return{title:_index_patterns.ML_RESULTS_INDEX_PATTERN,fields:[]}}function getExplorerDefaultState(){return{annotationsData:[],bounds:undefined,chartsData:(0,_explorer_charts_container_service.getDefaultChartsData)(),fieldFormatsLoading:false,filterActive:false,filteredFields:[],filterPlaceHolder:undefined,indexPattern:getDefaultIndexPattern(),influencersFilterQuery:undefined,influencers:{},isAndOperator:false,loading:true,maskAll:false,noInfluencersConfigured:true,overallSwimlaneData:(0,_explorer_utils.getDefaultSwimlaneData)(),queryString:"",selectedCells:undefined,selectedJobs:null,swimlaneBucketInterval:undefined,swimlaneContainerWidth:0,swimlaneLimit:10,tableData:{anomalies:[],examplesByJobId:[""],interval:0,jobIds:[],showViewSeriesLink:false},tableQueryString:"",viewByLoadedForTimeFormatted:null,viewBySwimlaneData:(0,_explorer_utils.getDefaultSwimlaneData)(),viewBySwimlaneDataLoading:false,viewBySwimlaneFieldName:undefined,viewBySwimlaneOptions:[]}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"InfluencersList",{enumerable:true,get:function get(){return _influencers_list.InfluencersList}});var _influencers_list=__webpack_require__(1726)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.InfluencersList=InfluencersList;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _react2=__webpack_require__(30);var _abbreviate_whole_number=__webpack_require__(1727);var _anomaly_utils=__webpack_require__(75);var _entity_cell=__webpack_require__(268);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getTooltipContent(maxScoreLabel,totalScoreLabel){return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.influencersList.maxAnomalyScoreTooltipDescription",defaultMessage:"Maximum anomaly score: {maxScoreLabel}",values:{maxScoreLabel:maxScoreLabel}})),_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.influencersList.totalAnomalyScoreTooltipDescription",defaultMessage:"Total anomaly score: {totalScoreLabel}",values:{totalScoreLabel:totalScoreLabel}})))}function Influencer(_ref){var influencerFieldName=_ref.influencerFieldName,influencerFilter=_ref.influencerFilter,valueData=_ref.valueData;var maxScorePrecise=valueData.maxAnomalyScore;var maxScore=parseInt(maxScorePrecise);var maxScoreLabel=maxScore!==0?maxScore:"< 1";var severity=(0,_anomaly_utils.getSeverity)(maxScore);var totalScore=parseInt(valueData.sumAnomalyScore);var totalScoreLabel=totalScore!==0?totalScore:"< 1";var barScore=maxScore!==0?maxScore:1;var barStyle={width:"".concat(barScore,"%")};var tooltipContent=getTooltipContent(maxScoreLabel,totalScoreLabel);return _react.default.createElement("div",{"data-test-subj":"mlInfluencerEntry field-".concat(influencerFieldName)},_react.default.createElement("div",{className:"field-label","data-test-subj":"mlInfluencerEntryFieldLabel"},influencerFieldName!=="mlcategory"?_react.default.createElement(_entity_cell.EntityCell,{entityName:influencerFieldName,entityValue:valueData.influencerFieldValue,filter:influencerFilter}):_react.default.createElement("div",{className:"field-value"},"mlcategory ",valueData.influencerFieldValue)),_react.default.createElement("div",{className:"progress ".concat(severity.id),value:"{valueData.maxAnomalyScore}",max:"100"},_react.default.createElement("div",{className:"progress-bar-holder"},_react.default.createElement("div",{className:"progress-bar",style:barStyle})),_react.default.createElement("div",{className:"score-label"},_react.default.createElement(_eui.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:"".concat(influencerFieldName,": ").concat(valueData.influencerFieldValue),content:tooltipContent},_react.default.createElement("span",null,maxScoreLabel)))),_react.default.createElement("div",{className:"total-score-label"},_react.default.createElement(_eui.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:"".concat(influencerFieldName,": ").concat(valueData.influencerFieldValue),content:tooltipContent},_react.default.createElement("span",null,totalScore>0?(0,_abbreviate_whole_number.abbreviateWholeNumber)(totalScore,4):totalScoreLabel))))}Influencer.propTypes={influencerFieldName:_propTypes.default.string.isRequired,influencerFilter:_propTypes.default.func,valueData:_propTypes.default.object.isRequired};function InfluencersByName(_ref2){var influencerFieldName=_ref2.influencerFieldName,influencerFilter=_ref2.influencerFilter,fieldValues=_ref2.fieldValues;var influencerValues=fieldValues.map((function(valueData){return _react.default.createElement(Influencer,{key:valueData.influencerFieldValue,influencerFieldName:influencerFieldName,influencerFilter:influencerFilter,valueData:valueData})}));return _react.default.createElement(_react.default.Fragment,{key:influencerFieldName},_react.default.createElement(_eui.EuiTitle,{size:"xs","data-test-subj":"mlInfluencerFieldName ".concat(influencerFieldName)},_react.default.createElement("h3",null,influencerFieldName)),_react.default.createElement(_eui.EuiSpacer,{size:"xs"}),influencerValues)}InfluencersByName.propTypes={influencerFieldName:_propTypes.default.string.isRequired,influencerFilter:_propTypes.default.func,fieldValues:_propTypes.default.array.isRequired};function InfluencersList(_ref3){var influencers=_ref3.influencers,influencerFilter=_ref3.influencerFilter;if(influencers===undefined||Object.keys(influencers).length===0){return _react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround",className:"ml-influencers-list"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiSpacer,{size:"xxl"}),_react.default.createElement(_eui.EuiTitle,{size:"xs",className:"influencer-title"},_react.default.createElement("h3",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.influencersList.noInfluencersFoundTitle",defaultMessage:"No influencers found"})))))}var influencersByName=Object.keys(influencers).map((function(influencerFieldName){return _react.default.createElement(InfluencersByName,{key:influencerFieldName,influencerFieldName:influencerFieldName,influencerFilter:influencerFilter,fieldValues:influencers[influencerFieldName]})}));return _react.default.createElement("div",{className:"ml-influencers-list"},influencersByName)}InfluencersList.propTypes={influencers:_propTypes.default.object,influencerFilter:_propTypes.default.func}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.abbreviateWholeNumber=abbreviateWholeNumber;var _numeral=_interopRequireDefault(__webpack_require__(124));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function abbreviateWholeNumber(value){var maxDigits=arguments.length>1&&arguments[1]!==undefined?arguments[1]:3;if(Math.abs(value)<Math.pow(10,maxDigits)){return value}else{return(0,_numeral.default)(value).format("0a")}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CheckboxShowCharts=exports.useShowCharts=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _make_id=_interopRequireDefault(__webpack_require__(1729));var _react2=__webpack_require__(30);var _url_state=__webpack_require__(88);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var SHOW_CHARTS_DEFAULT=true;var SHOW_CHARTS_APP_STATE_NAME="mlShowCharts";var useShowCharts=function useShowCharts(){var _useUrlState=(0,_url_state.useUrlState)("_a"),_useUrlState2=_slicedToArray(_useUrlState,2),appState=_useUrlState2[0],setAppState=_useUrlState2[1];return[(appState===null||appState===void 0?void 0:appState.mlShowCharts)!==undefined?appState===null||appState===void 0?void 0:appState.mlShowCharts:SHOW_CHARTS_DEFAULT,function(d){return setAppState(SHOW_CHARTS_APP_STATE_NAME,d)}]};exports.useShowCharts=useShowCharts;var CheckboxShowCharts=function CheckboxShowCharts(){var _useShowCharts=useShowCharts(),_useShowCharts2=_slicedToArray(_useShowCharts,2),showCharts=_useShowCharts2[0],setShowCarts=_useShowCharts2[1];var onChange=function onChange(e){setShowCarts(e.target.checked)};return _react.default.createElement(_eui.EuiCheckbox,{id:(0,_make_id.default)(),label:_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.controls.checkboxShowCharts.showChartsCheckboxLabel",defaultMessage:"Show charts"}),checked:showCharts,onChange:onChange})};exports.CheckboxShowCharts=CheckboxShowCharts},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getKqlQueryValues=getKqlQueryValues;exports.ExplorerQueryBar=exports.DEFAULT_QUERY_LANG=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _eui=__webpack_require__(29);var _i18n=__webpack_require__(1);var _public=__webpack_require__(63);var _search=__webpack_require__(99);var _explorer_dashboard_service=__webpack_require__(144);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var DEFAULT_QUERY_LANG=_search.SEARCH_QUERY_LANGUAGE.KUERY;exports.DEFAULT_QUERY_LANG=DEFAULT_QUERY_LANG;function getKqlQueryValues(_ref){var _influencersFilterQue;var inputString=_ref.inputString,queryLanguage=_ref.queryLanguage,indexPattern=_ref.indexPattern;var influencersFilterQuery={};var filteredFields=[];var ast=_public.esKuery.fromKueryExpression(inputString);var isAndOperator=ast&&ast.function==="and";if(ast&&Array.isArray(ast.arguments)){ast.arguments.forEach((function(arg){if(arg.arguments!==undefined){arg.arguments.forEach((function(nestedArg){if(typeof nestedArg.value==="string"){filteredFields.push(nestedArg.value)}}))}else if(typeof arg.value==="string"){filteredFields.push(arg.value)}}))}if(queryLanguage===_search.SEARCH_QUERY_LANGUAGE.KUERY){influencersFilterQuery=_public.esKuery.toElasticsearchQuery(_public.esKuery.fromKueryExpression(inputString),indexPattern)}else if(queryLanguage===_search.SEARCH_QUERY_LANGUAGE.LUCENE){influencersFilterQuery=_public.esQuery.luceneStringToDsl(inputString)}var clearSettings=((_influencersFilterQue=influencersFilterQuery)===null||_influencersFilterQue===void 0?void 0:_influencersFilterQue.match_all)&&Object.keys(influencersFilterQuery.match_all).length===0;return{clearSettings:clearSettings,settings:{filterQuery:influencersFilterQuery,queryString:inputString,tableQueryString:inputString,isAndOperator:isAndOperator,filteredFields:filteredFields}}}function getInitSearchInputState(_ref2){var filterActive=_ref2.filterActive,queryString=_ref2.queryString;if(queryString!==undefined&&filterActive===true){return{language:_search.SEARCH_QUERY_LANGUAGE.KUERY,query:queryString}}else{return{query:"",language:DEFAULT_QUERY_LANG}}}var ExplorerQueryBar=function ExplorerQueryBar(_ref3){var filterActive=_ref3.filterActive,filterIconTriggeredQuery=_ref3.filterIconTriggeredQuery,filterPlaceHolder=_ref3.filterPlaceHolder,indexPattern=_ref3.indexPattern,queryString=_ref3.queryString,updateLanguage=_ref3.updateLanguage;var _useState=(0,_react.useState)(getInitSearchInputState({filterActive:filterActive,queryString:queryString})),_useState2=_slicedToArray(_useState,2),searchInput=_useState2[0],setSearchInput=_useState2[1];var _useState3=(0,_react.useState)(undefined),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];(0,_react.useEffect)((function(){if(filterIconTriggeredQuery!==undefined){setSearchInput({language:searchInput.language,query:filterIconTriggeredQuery})}}),[filterIconTriggeredQuery]);var searchChangeHandler=function searchChangeHandler(query){if(searchInput.language!==query.language){updateLanguage(query.language)}setSearchInput(query)};var applyInfluencersFilterQuery=function applyInfluencersFilterQuery(query){try{var _getKqlQueryValues=getKqlQueryValues({inputString:query.query,queryLanguage:query.language,indexPattern:indexPattern}),clearSettings=_getKqlQueryValues.clearSettings,settings=_getKqlQueryValues.settings;if(clearSettings===true){_explorer_dashboard_service.explorerService.clearInfluencerFilterSettings()}else{_explorer_dashboard_service.explorerService.setInfluencerFilterSettings(settings)}}catch(e){console.log("Invalid query syntax in search bar",e);setErrorMessage({query:query.query,message:e.message})}};return _react.default.createElement(_eui.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:function closePopover(){return setErrorMessage(undefined)},input:_react.default.createElement(_public.QueryStringInput,{bubbleSubmitEvent:true,query:searchInput,indexPatterns:[indexPattern],onChange:searchChangeHandler,onSubmit:applyInfluencersFilterQuery,placeholder:filterPlaceHolder,disableAutoFocus:true,dataTestSubj:"explorerQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown"}),isOpen:(errorMessage===null||errorMessage===void 0?void 0:errorMessage.query)===searchInput.query&&(errorMessage===null||errorMessage===void 0?void 0:errorMessage.message)!==""},_react.default.createElement(_eui.EuiCode,null,_i18n.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessageQueryBar",{defaultMessage:"Invalid query"}),": ",errorMessage===null||errorMessage===void 0?void 0:errorMessage.message.split("\n")[0]))};exports.ExplorerQueryBar=ExplorerQueryBar},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartsContainer=void 0;var _jquery=_interopRequireDefault(__webpack_require__(44));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _chart_utils=__webpack_require__(135);var _explorer_chart_distribution=__webpack_require__(1732);var _explorer_chart_single_metric=__webpack_require__(1733);var _explorer_chart_label=__webpack_require__(1734);var _explorer_constants=__webpack_require__(86);var _i18n=__webpack_require__(1);var _react2=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var textTooManyBuckets=_i18n.i18n.translate("xpack.ml.explorer.charts.tooManyBucketsDescription",{defaultMessage:"This selection contains too many buckets to be displayed."+"The dashboard is best viewed over a shorter time range."});var textViewButton=_i18n.i18n.translate("xpack.ml.explorer.charts.openInSingleMetricViewerButtonLabel",{defaultMessage:"Open in Single Metric Viewer"});function getChartId(series){var jobId=series.jobId,detectorLabel=series.detectorLabel,entityFields=series.entityFields;var entities=entityFields.map((function(ef){return"".concat(ef.fieldName,"/").concat(ef.fieldValue)})).join(",");var id="".concat(jobId,"_").concat(detectorLabel,"_").concat(entities);return id}function ExplorerChartContainer(_ref){var series=_ref.series,severity=_ref.severity,tooManyBuckets=_ref.tooManyBuckets,wrapLabel=_ref.wrapLabel;var detectorLabel=series.detectorLabel,entityFields=series.entityFields;var chartType=(0,_chart_utils.getChartType)(series);var DetectorLabel=_react.default.createElement(_react.default.Fragment,null,detectorLabel);if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){var byField=series.entityFields.find((function(d){return d.fieldType==="by"}));if(typeof byField!=="undefined"){DetectorLabel=_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.charts.detectorLabel",defaultMessage:'{detectorLabel}{br}y-axis event distribution split by "{fieldName}"',values:{detectorLabel:detectorLabel,br:_react.default.createElement("br",null),fieldName:byField.fieldName}}));wrapLabel=true}}return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_explorer_chart_label.ExplorerChartLabel,{detectorLabel:DetectorLabel,entityFields:entityFields,infoTooltip:_objectSpread({},series.infoTooltip,{chartType:chartType}),wrapLabel:wrapLabel})),_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement("div",{className:"ml-explorer-chart-icons"},tooManyBuckets&&_react.default.createElement("span",{className:"ml-explorer-chart-icon"},_react.default.createElement(_eui.EuiIconTip,{content:textTooManyBuckets,position:"top",size:"s",type:"alert",color:"warning"})),_react.default.createElement(_eui.EuiToolTip,{position:"top",content:textViewButton},_react.default.createElement(_eui.EuiButtonEmpty,{iconSide:"right",iconType:"stats",size:"xs",onClick:function onClick(){return window.open((0,_chart_utils.getExploreSeriesLink)(series),"_blank")}},_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.explorer.charts.viewLabel",defaultMessage:"View"})))))),function(){if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION||chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){return _react.default.createElement(_explorer_chart_distribution.ExplorerChartDistribution,{tooManyBuckets:tooManyBuckets,seriesConfig:series,severity:severity})}return _react.default.createElement(_explorer_chart_single_metric.ExplorerChartSingleMetric,{tooManyBuckets:tooManyBuckets,seriesConfig:series,severity:severity})}())}var ExplorerChartsContainer=function(_React$Component){_inherits(ExplorerChartsContainer,_React$Component);function ExplorerChartsContainer(){_classCallCheck(this,ExplorerChartsContainer);return _possibleConstructorReturn(this,_getPrototypeOf(ExplorerChartsContainer).apply(this,arguments))}_createClass(ExplorerChartsContainer,[{key:"componentDidMount",value:function componentDidMount(){(0,_jquery.default)(".ml-explorer-charts-tooltip").remove();(0,_jquery.default)("body").append('<div class="ml-explorer-tooltip ml-explorer-charts-tooltip" style="opacity:0; display: none;">')}},{key:"componentWillUnmount",value:function componentWillUnmount(){(0,_jquery.default)(".ml-explorer-charts-tooltip").remove()}},{key:"render",value:function render(){var _this$props=this.props,chartsPerRow=_this$props.chartsPerRow,seriesToPlot=_this$props.seriesToPlot,severity=_this$props.severity,tooManyBuckets=_this$props.tooManyBuckets;var chartsWidth=chartsPerRow===1?"calc(100% - 20px)":"auto";var chartsColumns=chartsPerRow===1?0:chartsPerRow;var wrapLabel=seriesToPlot.some((function(series){return(0,_chart_utils.isLabelLengthAboveThreshold)(series)}));return _react.default.createElement(_eui.EuiFlexGrid,{columns:chartsColumns},seriesToPlot.length>0&&seriesToPlot.map((function(series){return _react.default.createElement(_eui.EuiFlexItem,{key:getChartId(series),className:"ml-explorer-chart-container",style:{minWidth:chartsWidth}},_react.default.createElement(ExplorerChartContainer,{series:series,severity:severity,tooManyBuckets:tooManyBuckets,wrapLabel:wrapLabel}))})))}}]);return ExplorerChartsContainer}(_react.default.Component);exports.ExplorerChartsContainer=ExplorerChartsContainer},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartDistribution=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _lodash=_interopRequireDefault(__webpack_require__(49));var _d=_interopRequireDefault(__webpack_require__(97));var _jquery=_interopRequireDefault(__webpack_require__(44));var _moment=_interopRequireDefault(__webpack_require__(32));var _date_utils=__webpack_require__(83);var _format_value=__webpack_require__(133);var _anomaly_utils=__webpack_require__(75);var _chart_utils=__webpack_require__(135);var _loading_indicator=__webpack_require__(209);var _time_buckets=__webpack_require__(106);var _field_format_service=__webpack_require__(112);var _chart_tooltip_service=__webpack_require__(134);var _explorer_constants=__webpack_require__(86);var _i18n=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CONTENT_WRAPPER_HEIGHT=215;var Y_AXIS_LABEL_THRESHOLD=10;var ExplorerChartDistribution=function(_React$Component){_inherits(ExplorerChartDistribution,_React$Component);function ExplorerChartDistribution(){_classCallCheck(this,ExplorerChartDistribution);return _possibleConstructorReturn(this,_getPrototypeOf(ExplorerChartDistribution).apply(this,arguments))}_createClass(ExplorerChartDistribution,[{key:"componentDidMount",value:function componentDidMount(){this.renderChart()}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.renderChart()}},{key:"renderChart",value:function renderChart(){var tooManyBuckets=this.props.tooManyBuckets;var element=this.rootNode;var config=this.props.seriesConfig;var severity=this.props.severity;if(typeof config==="undefined"||Array.isArray(config.chartData)===false){return}var fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormat(config.jobId,config.detectorIndex);var vizWidth=0;var chartHeight=170;var LINE_CHART_ANOMALY_RADIUS=7;var SCHEDULED_EVENT_MARKER_HEIGHT=5;var chartType=(0,_chart_utils.getChartType)(config);var margin={top:10,right:0,bottom:30,left:0};if(chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){margin.left=60}var lineChartXScale=null;var lineChartYScale=null;var lineChartGroup;var lineChartValuesLine=null;var CHART_Y_ATTRIBUTE=chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION?"entity":"value";var highlight=config.chartData.find((function(d){return d.anomalyScore!==undefined}));highlight=highlight&&highlight.entity;var filteredChartData=init(config);drawRareChart(filteredChartData);function init(_ref){var chartData=_ref.chartData;var $el=(0,_jquery.default)(".ml-explorer-chart");var chartElement=_d.default.select(element).select(".content-wrapper");chartElement.select("svg").remove();var svgWidth=$el.width();var svgHeight=chartHeight+margin.top+margin.bottom;var svg=chartElement.append("svg").classed("ml-explorer-chart-svg",true).attr("width",svgWidth).attr("height",svgHeight);var categoryLimit=30;var scaleCategories=_d.default.nest().key((function(d){return d.entity})).entries(chartData).sort((function(a,b){return b.values.length-a.values.length})).filter((function(d,i){if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){return i<categoryLimit||d.key===highlight}return true})).map((function(d){return d.key}));chartData=chartData.filter((function(d){return scaleCategories.includes(d.entity)}));if(chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){var focusData=chartData.filter((function(d){return d.entity===highlight})).map((function(d){return d.value}));var focusExtent=_d.default.extent(focusData);chartData=chartData.filter((function(d){return d.value<=focusExtent[1]}));lineChartYScale=_d.default.scale.linear().range([chartHeight,0]).domain([0,focusExtent[1]]).nice()}else if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){var rowMargin=5;lineChartYScale=_d.default.scale.ordinal().rangePoints([rowMargin,chartHeight-rowMargin]).domain(scaleCategories)}else{throw"chartType '".concat(chartType,"' not supported")}var yAxis=_d.default.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);var maxYAxisLabelWidth=0;var tempLabelText=svg.append("g").attr("class","temp-axis-label tick");var tempLabelTextData=chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION?lineChartYScale.ticks():scaleCategories;tempLabelText.selectAll("text.temp.axis").data(tempLabelTextData).enter().append("text").text((function(d){if(fieldFormat!==undefined){return fieldFormat.convert(d,"text")}else{if(chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION){return lineChartYScale.tickFormat()(d)}return d}})).each((function(){maxYAxisLabelWidth=Math.max(this.getBBox().width+yAxis.tickPadding(),maxYAxisLabelWidth)})).remove();_d.default.select(".temp-axis-label").remove();if(chartType===_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION||chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION&&scaleCategories.length<=Y_AXIS_LABEL_THRESHOLD){margin.left=Math.max(maxYAxisLabelWidth,40)}vizWidth=svgWidth-margin.left-margin.right;lineChartXScale=_d.default.time.scale().range([0,vizWidth]).domain([config.plotEarliest,config.plotLatest]);lineChartValuesLine=_d.default.svg.line().x((function(d){return lineChartXScale(d.date)})).y((function(d){return lineChartYScale(d[CHART_Y_ATTRIBUTE])})).defined((function(d){return d.value!==null}));lineChartGroup=svg.append("g").attr("class","line-chart").attr("transform","translate("+margin.left+","+margin.top+")");return chartData}function drawRareChart(data){lineChartGroup.append("rect").attr("x",0).attr("y",0).attr("height",chartHeight).attr("width",vizWidth).style("stroke","#cccccc").style("fill","none").style("stroke-width",1);drawRareChartAxes();drawRareChartHighlightedSpan();drawRareChartDots(data,lineChartGroup,lineChartValuesLine);drawRareChartMarkers(data)}function drawRareChartAxes(){var timeBuckets=new _time_buckets.TimeBuckets;var bounds={min:(0,_moment.default)(config.plotEarliest),max:(0,_moment.default)(config.plotLatest)};timeBuckets.setBounds(bounds);timeBuckets.setInterval("auto");var xAxisTickFormat=timeBuckets.getScaledDateFormat();var tickValuesStart=Math.max(config.selectedEarliest,config.plotEarliest);var interval=config.selectedLatest-config.selectedEarliest+1;var tickValues=(0,_chart_utils.getTickValues)(tickValuesStart,interval,config.plotEarliest,config.plotLatest);var xAxis=_d.default.svg.axis().scale(lineChartXScale).orient("bottom").innerTickSize(-chartHeight).outerTickSize(0).tickPadding(10).tickFormat((function(d){return(0,_moment.default)(d).format(xAxisTickFormat)}));if(tooManyBuckets===false){xAxis.tickValues(tickValues)}else{xAxis.ticks((0,_chart_utils.numTicksForDateFormat)(vizWidth,xAxisTickFormat))}var yAxis=_d.default.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);if(fieldFormat!==undefined){yAxis.tickFormat((function(d){return fieldFormat.convert(d,"text")}))}var axes=lineChartGroup.append("g");var gAxis=axes.append("g").attr("class","x axis").attr("transform","translate(0,"+chartHeight+")").call(xAxis);axes.append("g").attr("class","y axis").call(yAxis);if(chartType===_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){axes.select(".y").selectAll("text").each((function(d){_d.default.select(this).classed("ml-explorer-chart-axis-emphasis",d===highlight)}))}if(tooManyBuckets===false){(0,_chart_utils.removeLabelOverlap)(gAxis,tickValuesStart,interval,vizWidth)}}function drawRareChartDots(dotsData,rareChartGroup,rareChartValuesLine){var radius=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1.5;var dotGroup=rareChartGroup.select(".values-dots").empty()?rareChartGroup.append("g").classed("values-dots",true):rareChartGroup.select(".values-dots");var dots=dotGroup.selectAll("circle").data(dotsData);dots.enter().append("circle").classed("values-dots-circle",true).classed("values-dots-circle-blur",(function(d){return d.entity!==highlight})).attr("r",(function(d){return d.entity===highlight?radius*1.5:radius}));dots.attr("cx",rareChartValuesLine.x()).attr("cy",rareChartValuesLine.y());dots.exit().remove()}function drawRareChartHighlightedSpan(){var rectStart=Math.max(config.selectedEarliest,config.plotEarliest);var rectEnd=Math.min(config.selectedLatest,config.plotLatest);var rectWidth=lineChartXScale(rectEnd)-lineChartXScale(rectStart);lineChartGroup.append("rect").attr("class","selected-interval").attr("x",lineChartXScale(new Date(rectStart))+2).attr("y",2).attr("rx",3).attr("ry",3).attr("width",rectWidth-4).attr("height",chartHeight-4)}function drawRareChartMarkers(data){var dots=lineChartGroup.append("g").attr("class","chart-markers").selectAll(".metric-value").data(data.filter((function(d){return d.value!==null})));dots.exit().remove();dots.enter().append("circle").attr("r",LINE_CHART_ANOMALY_RADIUS).on("mouseover",(function(d){showLineChartTooltip(d,this)})).on("mouseout",(function(){return _chart_tooltip_service.mlChartTooltipService.hide()}));dots.attr("cx",(function(d){return lineChartXScale(d.date)})).attr("cy",(function(d){return lineChartYScale(d[CHART_Y_ATTRIBUTE])})).attr("class",(function(d){var markerClass="metric-value";if(_lodash.default.has(d,"anomalyScore")&&Number(d.anomalyScore)>=severity){markerClass+=" anomaly-marker ";markerClass+=(0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id}return markerClass}));var scheduledEventMarkers=lineChartGroup.select(".chart-markers").selectAll(".scheduled-event-marker").data(data.filter((function(d){return d.scheduledEvents!==undefined})));scheduledEventMarkers.exit().remove();scheduledEventMarkers.enter().append("rect").attr("width",LINE_CHART_ANOMALY_RADIUS*2).attr("height",SCHEDULED_EVENT_MARKER_HEIGHT).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1);scheduledEventMarkers.attr("x",(function(d){return lineChartXScale(d.date)-LINE_CHART_ANOMALY_RADIUS})).attr("y",(function(d){return lineChartYScale(d[CHART_Y_ATTRIBUTE])-SCHEDULED_EVENT_MARKER_HEIGHT/2}))}function showLineChartTooltip(marker,circle){var formattedDate=(0,_date_utils.formatHumanReadableDateTime)(marker.date);var tooltipData=[{label:formattedDate}];var seriesKey=config.detectorLabel;if(_lodash.default.has(marker,"entity")){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.distributionChart.entityLabel",{defaultMessage:"entity"}),value:marker.entity,seriesIdentifier:{key:seriesKey},valueAccessor:"entity"})}if(_lodash.default.has(marker,"anomalyScore")){var score=parseInt(marker.anomalyScore);var displayScore=score>0?score:"< 1";tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.distributionChart.anomalyScoreLabel",{defaultMessage:"anomaly score"}),value:displayScore,color:(0,_anomaly_utils.getSeverityColor)(score),seriesIdentifier:{key:seriesKey},valueAccessor:"anomaly_score"});if(chartType!==_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.distributionChart.valueLabel",{defaultMessage:"value"}),value:(0,_format_value.formatValue)(marker.value,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"});if(typeof marker.numberOfCauses==="undefined"||marker.numberOfCauses===1){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.distributionChart.typicalLabel",{defaultMessage:"typical"}),value:(0,_format_value.formatValue)(marker.typical,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"typical"})}if(typeof marker.byFieldName!=="undefined"&&_lodash.default.has(marker,"numberOfCauses")){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.distributionChart.unusualByFieldValuesLabel",{defaultMessage:"{ numberOfCauses, plural, one {# unusual {byFieldName} value} other {#{plusSign} unusual {byFieldName} values}}",values:{numberOfCauses:marker.numberOfCauses,byFieldName:marker.byFieldName,plusSign:marker.numberOfCauses<10?"":"+"}}),seriesIdentifier:{key:seriesKey},valueAccessor:"numberOfCauses"})}}}else if(chartType!==_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.distributionChart.valueWithoutAnomalyScoreLabel",{defaultMessage:"value"}),value:(0,_format_value.formatValue)(marker.value,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"})}if(_lodash.default.has(marker,"scheduledEvents")){marker.scheduledEvents.forEach((function(scheduledEvent,i){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.scheduledEventsLabel",{defaultMessage:"scheduled event{counter}",values:{counter:marker.scheduledEvents.length>1?" #".concat(i+1):""}}),value:scheduledEvent,seriesIdentifier:{key:seriesKey},valueAccessor:"scheduled_events_".concat(i+1)})}))}_chart_tooltip_service.mlChartTooltipService.show(tooltipData,circle,{x:LINE_CHART_ANOMALY_RADIUS*3,y:LINE_CHART_ANOMALY_RADIUS*2})}}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(){return true}},{key:"setRef",value:function setRef(componentNode){this.rootNode=componentNode}},{key:"render",value:function render(){var seriesConfig=this.props.seriesConfig;if(typeof seriesConfig==="undefined"){return null}var isLoading=seriesConfig.loading;return _react.default.createElement("div",{className:"ml-explorer-chart",ref:this.setRef.bind(this)},isLoading&&_react.default.createElement(_loading_indicator.LoadingIndicator,{height:CONTENT_WRAPPER_HEIGHT}),!isLoading&&_react.default.createElement("div",{className:"content-wrapper"}))}}]);return ExplorerChartDistribution}(_react.default.Component);exports.ExplorerChartDistribution=ExplorerChartDistribution;_defineProperty(ExplorerChartDistribution,"propTypes",{seriesConfig:_propTypes.default.object,severity:_propTypes.default.number})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartSingleMetric=void 0;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _lodash=_interopRequireDefault(__webpack_require__(49));var _d=_interopRequireDefault(__webpack_require__(97));var _jquery=_interopRequireDefault(__webpack_require__(44));var _moment=_interopRequireDefault(__webpack_require__(32));var _date_utils=__webpack_require__(83);var _format_value=__webpack_require__(133);var _anomaly_utils=__webpack_require__(75);var _chart_utils=__webpack_require__(135);var _loading_indicator=__webpack_require__(209);var _time_buckets=__webpack_require__(106);var _string_utils=__webpack_require__(80);var _field_format_service=__webpack_require__(112);var _chart_tooltip_service=__webpack_require__(134);var _i18n=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CONTENT_WRAPPER_HEIGHT=215;var CONTENT_WRAPPER_CLASS="ml-explorer-chart-content-wrapper";var ExplorerChartSingleMetric=function(_React$Component){_inherits(ExplorerChartSingleMetric,_React$Component);function ExplorerChartSingleMetric(){_classCallCheck(this,ExplorerChartSingleMetric);return _possibleConstructorReturn(this,_getPrototypeOf(ExplorerChartSingleMetric).apply(this,arguments))}_createClass(ExplorerChartSingleMetric,[{key:"componentDidMount",value:function componentDidMount(){this.renderChart()}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.renderChart()}},{key:"renderChart",value:function renderChart(){var tooManyBuckets=this.props.tooManyBuckets;var element=this.rootNode;var config=this.props.seriesConfig;var severity=this.props.severity;if(typeof config==="undefined"||Array.isArray(config.chartData)===false){return}var fieldFormat=_field_format_service.mlFieldFormatService.getFieldFormat(config.jobId,config.detectorIndex);var vizWidth=0;var chartHeight=170;var margin={top:10,right:0,bottom:30,left:60};var lineChartXScale=null;var lineChartYScale=null;var lineChartGroup;var lineChartValuesLine=null;init(config.chartLimits);drawLineChart(config.chartData);function init(chartLimits){var $el=(0,_jquery.default)(".ml-explorer-chart");var chartElement=_d.default.select(element).select(".".concat(CONTENT_WRAPPER_CLASS));chartElement.select("svg").remove();var svgWidth=$el.width();var svgHeight=chartHeight+margin.top+margin.bottom;var svg=chartElement.append("svg").classed("ml-explorer-chart-svg",true).attr("width",svgWidth).attr("height",svgHeight);lineChartYScale=_d.default.scale.linear().range([chartHeight,0]).domain([chartLimits.min,chartLimits.max]).nice();var yAxis=_d.default.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);var maxYAxisLabelWidth=0;var tempLabelText=svg.append("g").attr("class","temp-axis-label tick");tempLabelText.selectAll("text.temp.axis").data(lineChartYScale.ticks()).enter().append("text").text((function(d){if(fieldFormat!==undefined){return fieldFormat.convert(d,"text")}else{return lineChartYScale.tickFormat()(d)}})).each((function(){maxYAxisLabelWidth=Math.max(this.getBBox().width+yAxis.tickPadding(),maxYAxisLabelWidth)})).remove();_d.default.select(".temp-axis-label").remove();margin.left=Math.max(maxYAxisLabelWidth,40);vizWidth=svgWidth-margin.left-margin.right;lineChartXScale=_d.default.time.scale().range([0,vizWidth]).domain([config.plotEarliest,config.plotLatest]);lineChartValuesLine=_d.default.svg.line().x((function(d){return lineChartXScale(d.date)})).y((function(d){return lineChartYScale(d.value)})).defined((function(d){return d.value!==null}));lineChartGroup=svg.append("g").attr("class","line-chart").attr("transform","translate("+margin.left+","+margin.top+")")}function drawLineChart(data){lineChartGroup.append("rect").attr("x",0).attr("y",0).attr("height",chartHeight).attr("width",vizWidth).style("stroke","#cccccc").style("fill","none").style("stroke-width",1);drawLineChartAxes();drawLineChartHighlightedSpan();drawLineChartPaths(data);(0,_chart_utils.drawLineChartDots)(data,lineChartGroup,lineChartValuesLine);drawLineChartMarkers(data)}function drawLineChartAxes(){var timeBuckets=new _time_buckets.TimeBuckets;var bounds={min:(0,_moment.default)(config.plotEarliest),max:(0,_moment.default)(config.plotLatest)};timeBuckets.setBounds(bounds);timeBuckets.setInterval("auto");var xAxisTickFormat=timeBuckets.getScaledDateFormat();var tickValuesStart=Math.max(config.selectedEarliest,config.plotEarliest);var interval=config.selectedLatest-config.selectedEarliest+1;var tickValues=(0,_chart_utils.getTickValues)(tickValuesStart,interval,config.plotEarliest,config.plotLatest);var xAxis=_d.default.svg.axis().scale(lineChartXScale).orient("bottom").innerTickSize(-chartHeight).outerTickSize(0).tickPadding(10).tickFormat((function(d){return(0,_moment.default)(d).format(xAxisTickFormat)}));if(tooManyBuckets===false){xAxis.tickValues(tickValues)}else{xAxis.ticks((0,_chart_utils.numTicksForDateFormat)(vizWidth,xAxisTickFormat))}var yAxis=_d.default.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);if(fieldFormat!==undefined){yAxis.tickFormat((function(d){return fieldFormat.convert(d,"text")}))}var axes=lineChartGroup.append("g");var gAxis=axes.append("g").attr("class","x axis").attr("transform","translate(0,"+chartHeight+")").call(xAxis);axes.append("g").attr("class","y axis").call(yAxis);if(tooManyBuckets===false){(0,_chart_utils.removeLabelOverlap)(gAxis,tickValuesStart,interval,vizWidth)}}function drawLineChartHighlightedSpan(){var rectStart=Math.max(config.selectedEarliest,config.plotEarliest);var rectEnd=Math.min(config.selectedLatest,config.plotLatest);var rectWidth=lineChartXScale(rectEnd)-lineChartXScale(rectStart);lineChartGroup.append("rect").attr("class","selected-interval").attr("x",lineChartXScale(new Date(rectStart))+2).attr("y",2).attr("rx",3).attr("ry",3).attr("width",rectWidth-4).attr("height",chartHeight-4)}function drawLineChartPaths(data){lineChartGroup.append("path").attr("class","values-line").attr("d",lineChartValuesLine(data))}function drawLineChartMarkers(data){var dots=lineChartGroup.append("g").attr("class","chart-markers").selectAll(".metric-value").data(data.filter((function(d){return(d.value!==null||typeof d.anomalyScore==="number")&&!(0,_chart_utils.showMultiBucketAnomalyMarker)(d)})));dots.exit().remove();dots.enter().append("circle").attr("r",_chart_utils.LINE_CHART_ANOMALY_RADIUS).on("mouseover",(function(d){showLineChartTooltip(d,this)})).on("mouseout",(function(){return _chart_tooltip_service.mlChartTooltipService.hide()}));var isAnomalyVisible=function isAnomalyVisible(d){return _lodash.default.has(d,"anomalyScore")&&Number(d.anomalyScore)>=severity};dots.attr("cx",(function(d){return lineChartXScale(d.date)})).attr("cy",(function(d){return lineChartYScale(d.value)})).attr("class",(function(d){var markerClass="metric-value";if(isAnomalyVisible(d)){markerClass+=" anomaly-marker ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id)}return markerClass}));var multiBucketMarkers=lineChartGroup.select(".chart-markers").selectAll(".multi-bucket").data(data.filter((function(d){return isAnomalyVisible(d)&&(0,_chart_utils.showMultiBucketAnomalyMarker)(d)===true})));multiBucketMarkers.exit().remove();multiBucketMarkers.enter().append("path").attr("d",_d.default.svg.symbol().size(_chart_utils.MULTI_BUCKET_SYMBOL_SIZE).type("cross")).attr("transform",(function(d){return"translate(".concat(lineChartXScale(d.date),", ").concat(lineChartYScale(d.value),")")})).attr("class",(function(d){return"anomaly-marker multi-bucket ".concat((0,_anomaly_utils.getSeverityWithLow)(d.anomalyScore).id)})).on("mouseover",(function(d){showLineChartTooltip(d,this)})).on("mouseout",(function(){return _chart_tooltip_service.mlChartTooltipService.hide()}));var scheduledEventMarkers=lineChartGroup.select(".chart-markers").selectAll(".scheduled-event-marker").data(data.filter((function(d){return d.scheduledEvents!==undefined})));scheduledEventMarkers.exit().remove();scheduledEventMarkers.enter().append("rect").attr("width",_chart_utils.LINE_CHART_ANOMALY_RADIUS*2).attr("height",_chart_utils.SCHEDULED_EVENT_SYMBOL_HEIGHT).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1);scheduledEventMarkers.attr("x",(function(d){return lineChartXScale(d.date)-_chart_utils.LINE_CHART_ANOMALY_RADIUS})).attr("y",(function(d){return lineChartYScale(d.value)-_chart_utils.SCHEDULED_EVENT_SYMBOL_HEIGHT/2}))}function showLineChartTooltip(marker,circle){var formattedDate=(0,_date_utils.formatHumanReadableDateTime)(marker.date);var tooltipData=[{label:formattedDate}];var seriesKey=config.detectorLabel;if(_lodash.default.has(marker,"anomalyScore")){var score=parseInt(marker.anomalyScore);var displayScore=score>0?score:"< 1";tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.singleMetricChart.anomalyScoreLabel",{defaultMessage:"anomaly score"}),value:displayScore,color:(0,_anomaly_utils.getSeverityColor)(score),seriesIdentifier:{key:seriesKey},valueAccessor:"anomaly_score"});if((0,_chart_utils.showMultiBucketAnomalyTooltip)(marker)===true){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.singleMetricChart.multiBucketImpactLabel",{defaultMessage:"multi-bucket impact"}),value:(0,_anomaly_utils.getMultiBucketImpactLabel)(marker.multiBucketImpact),seriesIdentifier:{key:seriesKey},valueAccessor:"multi_bucket_impact"})}if(_lodash.default.has(marker,"actual")&&config.functionDescription!=="rare"){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.singleMetricChart.actualLabel",{defaultMessage:"actual"}),value:(0,_format_value.formatValue)(marker.actual,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"actual"});tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.singleMetricChart.typicalLabel",{defaultMessage:"typical"}),value:(0,_format_value.formatValue)(marker.typical,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"typical"})}else{tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.singleMetricChart.valueLabel",{defaultMessage:"value"}),value:(0,_format_value.formatValue)(marker.value,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"});if(_lodash.default.has(marker,"byFieldName")&&_lodash.default.has(marker,"numberOfCauses")){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.distributionChart.unusualByFieldValuesLabel",{defaultMessage:"{ numberOfCauses, plural, one {# unusual {byFieldName} value} other {#{plusSign} unusual {byFieldName} values}}",values:{numberOfCauses:marker.numberOfCauses,byFieldName:marker.byFieldName,plusSign:marker.numberOfCauses<10?"":"+"}}),seriesIdentifier:{key:seriesKey},valueAccessor:"numberOfCauses"})}}}else{tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.singleMetricChart.valueWithoutAnomalyScoreLabel",{defaultMessage:"value"}),value:(0,_format_value.formatValue)(marker.value,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"})}if(_lodash.default.has(marker,"scheduledEvents")){tooltipData.push({label:_i18n.i18n.translate("xpack.ml.explorer.singleMetricChart.scheduledEventsLabel",{defaultMessage:"Scheduled events"}),value:marker.scheduledEvents.map(_string_utils.mlEscape).join("<br/>"),seriesIdentifier:{key:seriesKey},valueAccessor:"scheduledEvents"})}_chart_tooltip_service.mlChartTooltipService.show(tooltipData,circle,{x:_chart_utils.LINE_CHART_ANOMALY_RADIUS*3,y:_chart_utils.LINE_CHART_ANOMALY_RADIUS*2})}}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(){return true}},{key:"setRef",value:function setRef(componentNode){this.rootNode=componentNode}},{key:"render",value:function render(){var seriesConfig=this.props.seriesConfig;if(typeof seriesConfig==="undefined"){return null}var isLoading=seriesConfig.loading;return _react.default.createElement("div",{className:"ml-explorer-chart",ref:this.setRef.bind(this)},isLoading&&_react.default.createElement(_loading_indicator.LoadingIndicator,{height:CONTENT_WRAPPER_HEIGHT}),!isLoading&&_react.default.createElement("div",{className:CONTENT_WRAPPER_CLASS}))}}]);return ExplorerChartSingleMetric}(_react.default.Component);exports.ExplorerChartSingleMetric=ExplorerChartSingleMetric;_defineProperty(ExplorerChartSingleMetric,"propTypes",{tooManyBuckets:_propTypes.default.bool,seriesConfig:_propTypes.default.object,severity:_propTypes.default.number.isRequired})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"ExplorerChartLabel",{enumerable:true,get:function get(){return _explorer_chart_label.ExplorerChartLabel}});var _explorer_chart_label=__webpack_require__(1735)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartLabel=ExplorerChartLabel;__webpack_require__(1736);var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);var _explorer_chart_label_badge=__webpack_require__(1741);var _explorer_chart_info_tooltip=__webpack_require__(1742);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ExplorerChartLabel(_ref){var detectorLabel=_ref.detectorLabel,entityFields=_ref.entityFields,infoTooltip=_ref.infoTooltip,_ref$wrapLabel=_ref.wrapLabel,wrapLabel=_ref$wrapLabel===void 0?false:_ref$wrapLabel;var labelSeparator=wrapLabel===true||entityFields.length===0||detectorLabel.length===0?_react.default.createElement(_react.default.Fragment,null," "):_react.default.createElement(_react.default.Fragment,null," – ");var entityFieldBadges=entityFields.map((function(entity){return _react.default.createElement(_explorer_chart_label_badge.ExplorerChartLabelBadge,{entity:entity,key:"".concat(entity.fieldName," ").concat(entity.fieldValue)})}));var infoIcon=_react.default.createElement("span",{className:"ml-explorer-chart-info-icon"},_react.default.createElement(_eui.EuiIconTip,{className:"ml-explorer-chart-eui-icon-tip",content:_react.default.createElement(_explorer_chart_info_tooltip.ExplorerChartInfoTooltip,infoTooltip),position:"top",size:"s"}));return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("span",{className:"ml-explorer-chart-label"},_react.default.createElement("span",{className:"ml-explorer-chart-label-detector"},detectorLabel,labelSeparator),wrapLabel&&infoIcon,!wrapLabel&&_react.default.createElement(_react.default.Fragment,null,entityFieldBadges," ",infoIcon)),wrapLabel&&_react.default.createElement("span",{className:"ml-explorer-chart-label-badges"},entityFieldBadges))}ExplorerChartLabel.propTypes={detectorLabel:_propTypes.default.object.isRequired,entityFields:_propTypes.default.arrayOf(_explorer_chart_label_badge.ExplorerChartLabelBadge.propTypes.entity),infoTooltip:_propTypes.default.object.isRequired,wrapLabel:_propTypes.default.bool}},function(module,exports,__webpack_require__){if(window.__kbnDarkMode__){__webpack_require__(1737)}else{__webpack_require__(1739)}},function(module,exports,__webpack_require__){var api=__webpack_require__(2);var content=__webpack_require__(1738);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(3);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".ml-explorer-chart-eui-icon-tip {\n  max-width: none; }\n\n.ml-explorer-chart-label-badges {\n  margin-top: 3px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(2);var content=__webpack_require__(1740);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(3);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".ml-explorer-chart-eui-icon-tip {\n  max-width: none; }\n\n.ml-explorer-chart-label-badges {\n  margin-top: 3px; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartLabelBadge=ExplorerChartLabelBadge;var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _eui=__webpack_require__(29);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ExplorerChartLabelBadge(_ref){var entity=_ref.entity;return _react.default.createElement("span",{className:"ml-explorer-chart-label-badge"},_react.default.createElement(_eui.EuiBadge,{color:"hollow",className:"ml-reset-font-weight"},entity.fieldName," ",_react.default.createElement("strong",null,entity.fieldValue)))}ExplorerChartLabelBadge.propTypes={entity:_propTypes.default.shape({fieldName:_propTypes.default.string.isRequired,fieldValue:_propTypes.default.string.isRequired})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExplorerChartInfoTooltip=void 0;__webpack_require__(1743);var _propTypes=_interopRequireDefault(__webpack_require__(50));var _react=_interopRequireDefault(__webpack_require__(28));var _explorer_constants=__webpack_require__(86);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _CHART_DESCRIPTION;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var CHART_DESCRIPTION=(_CHART_DESCRIPTION={},_defineProperty(_CHART_DESCRIPTION,_explorer_constants.CHART_TYPE.EVENT_DISTRIBUTION,_i18n.i18n.translate("xpack.ml.explorer.charts.infoTooltip.chartEventDistributionDescription",{defaultMessage:"The gray dots depict the approximate distribution of occurrences over time for a sample of {byFieldValuesParam} with"+" more frequent event types at the top and rarer ones at the bottom.",values:{byFieldValuesParam:"by_field_values"}})),_defineProperty(_CHART_DESCRIPTION,_explorer_constants.CHART_TYPE.POPULATION_DISTRIBUTION,_i18n.i18n.translate("xpack.ml.explorer.charts.infoTooltip.chartPopulationDistributionDescription",{defaultMessage:"The gray dots depict the approximate distribution of values over time for a sample of {overFieldValuesParam}.",values:{overFieldValuesParam:"over_field_values"}})),_CHART_DESCRIPTION);function TooltipDefinitionList(_ref){var toolTipData=_ref.toolTipData;return _react.default.createElement("dl",{className:"mlDescriptionList"},toolTipData.map((function(_ref2){var title=_ref2.title,description=_ref2.description;return _react.default.createElement(_react.default.Fragment,{key:"".concat(title," ").concat(description)},_react.default.createElement("dt",{className:"mlDescriptionList__title"},title),_react.default.createElement("dd",{className:"mlDescriptionList__description"},description))})))}var ExplorerChartInfoTooltip=function ExplorerChartInfoTooltip(_ref3){var jobId=_ref3.jobId,aggregationInterval=_ref3.aggregationInterval,chartFunction=_ref3.chartFunction,chartType=_ref3.chartType,_ref3$entityFields=_ref3.entityFields,entityFields=_ref3$entityFields===void 0?[]:_ref3$entityFields;var chartDescription=CHART_DESCRIPTION[chartType];var toolTipData=[{title:_i18n.i18n.translate("xpack.ml.explorer.charts.infoTooltip.jobIdTitle",{defaultMessage:"job ID"}),description:jobId},{title:_i18n.i18n.translate("xpack.ml.explorer.charts.infoTooltip.aggregationIntervalTitle",{defaultMessage:"aggregation interval"}),description:aggregationInterval},{title:_i18n.i18n.translate("xpack.ml.explorer.charts.infoTooltip.chartFunctionTitle",{defaultMessage:"chart function"}),description:chartFunction}];entityFields.forEach((function(entityField){toolTipData.push({title:entityField.fieldName,description:entityField.fieldValue})}));return _react.default.createElement("div",{className:"ml-explorer-chart-info-tooltip"},_react.default.createElement(TooltipDefinitionList,{toolTipData:toolTipData}),chartDescription&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_eui.EuiSpacer,{size:"s"}),_react.default.createElement("div",{className:"ml-explorer-chart-description"},chartDescription)))};exports.ExplorerChartInfoTooltip=ExplorerChartInfoTooltip;ExplorerChartInfoTooltip.propTypes={jobId:_propTypes.default.string.isRequired,aggregationInterval:_propTypes.default.string,chartFunction:_propTypes.default.string,entityFields:_propTypes.default.array}},function(module,exports,__webpack_require__){if(window.__kbnDarkMode__){__webpack_require__(1744)}else{__webpack_require__(1746)}},function(module,exports,__webpack_require__){var api=__webpack_require__(2);var content=__webpack_require__(1745);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(3);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".ml-explorer-chart-info-tooltip {\n  max-width: 384px; }\n\n.ml-explorer-chart-description {\n  font-size: 12px;\n  font-style: italic; }\n\n.ml-explorer-chart-info-tooltip .mlDescriptionList > * {\n  margin-top: 3px; }\n\n.ml-explorer-chart-info-tooltip .mlDescriptionList {\n  display: grid;\n  grid-template-columns: -webkit-max-content auto;\n  grid-template-columns: max-content auto; }\n  .ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__title {\n    color: #FFF;\n    font-size: 12px;\n    font-weight: normal;\n    white-space: nowrap;\n    grid-column-start: 1; }\n  .ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__description {\n    color: #FFF;\n    font-size: 12px;\n    font-weight: bold;\n    padding-left: 8px;\n    max-width: 256px;\n    grid-column-start: 2; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(2);var content=__webpack_require__(1747);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);var exported=content.locals?content.locals:{};module.exports=exported},function(module,exports,__webpack_require__){var ___CSS_LOADER_API_IMPORT___=__webpack_require__(3);exports=___CSS_LOADER_API_IMPORT___(false);exports.push([module.i,".ml-explorer-chart-info-tooltip {\n  max-width: 384px; }\n\n.ml-explorer-chart-description {\n  font-size: 12px;\n  font-style: italic; }\n\n.ml-explorer-chart-info-tooltip .mlDescriptionList > * {\n  margin-top: 3px; }\n\n.ml-explorer-chart-info-tooltip .mlDescriptionList {\n  display: grid;\n  grid-template-columns: -webkit-max-content auto;\n  grid-template-columns: max-content auto; }\n  .ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__title {\n    color: #FFF;\n    font-size: 12px;\n    font-weight: normal;\n    white-space: nowrap;\n    grid-column-start: 1; }\n  .ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__description {\n    color: #FFF;\n    font-size: 12px;\n    font-weight: bold;\n    padding-left: 8px;\n    max-width: 256px;\n    grid-column-start: 2; }\n",""]);module.exports=exports},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useSelectedCells=void 0;var _url_state=__webpack_require__(88);var _explorer_constants=__webpack_require__(86);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var useSelectedCells=function useSelectedCells(){var _useUrlState=(0,_url_state.useUrlState)("_a"),_useUrlState2=_slicedToArray(_useUrlState,2),appState=_useUrlState2[0],setAppState=_useUrlState2[1];var selectedCells;if(appState&&appState.mlExplorerSwimlane&&appState.mlExplorerSwimlane.selectedType!==undefined){selectedCells={type:appState.mlExplorerSwimlane.selectedType,lanes:appState.mlExplorerSwimlane.selectedLanes,times:appState.mlExplorerSwimlane.selectedTimes,showTopFieldValues:appState.mlExplorerSwimlane.showTopFieldValues,viewByFieldName:appState.mlExplorerSwimlane.viewByFieldName}}var setSelectedCells=function setSelectedCells(swimlaneSelectedCells){var mlExplorerSwimlane=_objectSpread({},appState.mlExplorerSwimlane);if(swimlaneSelectedCells!==undefined){var _selectedCells,_selectedCells2,_selectedCells3;swimlaneSelectedCells.showTopFieldValues=false;var currentSwimlaneType=(_selectedCells=selectedCells)===null||_selectedCells===void 0?void 0:_selectedCells.type;var currentShowTopFieldValues=(_selectedCells2=selectedCells)===null||_selectedCells2===void 0?void 0:_selectedCells2.showTopFieldValues;var newSwimlaneType=(_selectedCells3=selectedCells)===null||_selectedCells3===void 0?void 0:_selectedCells3.type;if(currentSwimlaneType===_explorer_constants.SWIMLANE_TYPE.OVERALL&&newSwimlaneType===_explorer_constants.SWIMLANE_TYPE.VIEW_BY||newSwimlaneType===_explorer_constants.SWIMLANE_TYPE.OVERALL||currentShowTopFieldValues===true){swimlaneSelectedCells.showTopFieldValues=true}mlExplorerSwimlane.selectedType=swimlaneSelectedCells.type;mlExplorerSwimlane.selectedLanes=swimlaneSelectedCells.lanes;mlExplorerSwimlane.selectedTimes=swimlaneSelectedCells.times;mlExplorerSwimlane.showTopFieldValues=swimlaneSelectedCells.showTopFieldValues;setAppState("mlExplorerSwimlane",mlExplorerSwimlane)}else{delete mlExplorerSwimlane.selectedType;delete mlExplorerSwimlane.selectedLanes;delete mlExplorerSwimlane.selectedTimes;delete mlExplorerSwimlane.showTopFieldValues;setAppState("mlExplorerSwimlane",mlExplorerSwimlane)}};return[selectedCells,setSelectedCells]};exports.useSelectedCells=useSelectedCells},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"useSwimlaneLimit",{enumerable:true,get:function get(){return _select_limit.useSwimlaneLimit}});Object.defineProperty(exports,"SelectLimit",{enumerable:true,get:function get(){return _select_limit.SelectLimit}});var _select_limit=__webpack_require__(530)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useJobSelection=void 0;var _lodash=__webpack_require__(49);var _react=__webpack_require__(28);var _i18n=__webpack_require__(1);var _dependency_cache=__webpack_require__(5);var _url_state=__webpack_require__(88);var _job_select_service_utils=__webpack_require__(276);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function getInvalidJobIds(jobs,ids){return ids.filter((function(id){var jobExists=jobs.some((function(job){return job.job_id===id}));return jobExists===false&&id!=="*"}))}function warnAboutInvalidJobIds(invalidIds){if(invalidIds.length>0){var toastNotifications=(0,_dependency_cache.getToastNotifications)();toastNotifications.addWarning(_i18n.i18n.translate("xpack.ml.jobSelect.requestedJobsDoesNotExistWarningMessage",{defaultMessage:"Requested\n{invalidIdsLength, plural, one {job {invalidIds} does not exist} other {jobs {invalidIds} do not exist}}",values:{invalidIdsLength:invalidIds.length,invalidIds:invalidIds.join()}}))}}var useJobSelection=function useJobSelection(jobs,dateFormatTz){var _globalState$ml,_ref,_globalState$ml2;var _useUrlState=(0,_url_state.useUrlState)("_g"),_useUrlState2=_slicedToArray(_useUrlState,2),globalState=_useUrlState2[0],setGlobalState=_useUrlState2[1];var jobSelection={jobIds:[],selectedGroups:[]};var ids=(globalState===null||globalState===void 0?void 0:(_globalState$ml=globalState.ml)===null||_globalState$ml===void 0?void 0:_globalState$ml.jobIds)||[];var tmpIds=(typeof ids==="string"?[ids]:ids).map((function(id){return String(id)}));var invalidIds=getInvalidJobIds(jobs,tmpIds);var validIds=(0,_lodash.difference)(tmpIds,invalidIds);validIds.sort();jobSelection.jobIds=validIds;jobSelection.selectedGroups=(_ref=globalState===null||globalState===void 0?void 0:(_globalState$ml2=globalState.ml)===null||_globalState$ml2===void 0?void 0:_globalState$ml2.groups)!==null&&_ref!==void 0?_ref:[];(0,_react.useEffect)((function(){warnAboutInvalidJobIds(invalidIds)}),[invalidIds]);(0,_react.useEffect)((function(){if(validIds.length===0&&jobs.length>0){var toastNotifications=(0,_dependency_cache.getToastNotifications)();toastNotifications.addWarning(_i18n.i18n.translate("xpack.ml.jobSelect.noJobsSelectedWarningMessage",{defaultMessage:"No jobs selected, auto selecting first job"}));var mlGlobalState=(globalState===null||globalState===void 0?void 0:globalState.ml)||{};mlGlobalState.jobIds=[jobs[0].job_id];var time=(0,_job_select_service_utils.getTimeRangeFromSelection)(jobs,mlGlobalState.jobIds);setGlobalState(_objectSpread({},{ml:mlGlobalState},{},time!==undefined?{time:time}:{}))}}),[jobs,validIds]);return jobSelection};exports.useJobSelection=useJobSelection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.accessDeniedRoute=void 0;var _react=_interopRequireDefault(__webpack_require__(28));var _i18n=__webpack_require__(1);var _router=__webpack_require__(67);var _use_resolver=__webpack_require__(68);var _access_denied=__webpack_require__(1752);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var breadcrumbs=[{text:_i18n.i18n.translate("xpack.ml.accessDeniedLabel",{defaultMessage:"Access denied"}),href:""}];var accessDeniedRoute={path:"/access-denied",render:function render(props,deps){return _react.default.createElement(PageWrapper,_extends({},props,{deps:deps}))},breadcrumbs:breadcrumbs};exports.accessDeniedRoute=accessDeniedRoute;var PageWrapper=function PageWrapper(_ref){var deps=_ref.deps;var _useResolver=(0,_use_resolver.useResolver)(undefined,undefined,deps.config,{}),context=_useResolver.context;return _react.default.createElement(_router.PageLoader,{context:context},_react.default.createElement(_access_denied.Page,null))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"Page",{enumerable:true,get:function get(){return _page.Page}});var _page=__webpack_require__(1753)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Page=void 0;var _react=_interopRequireWildcard(__webpack_require__(28));var _react2=__webpack_require__(30);var _i18n=__webpack_require__(1);var _eui=__webpack_require__(29);var _navigation_menu=__webpack_require__(82);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}var Page=function Page(){return _react.default.createElement(_react.Fragment,null,_react.default.createElement(_navigation_menu.NavigationMenu,{tabId:"access-denied"}),_react.default.createElement(_eui.EuiPage,null,_react.default.createElement(_eui.EuiPageBody,null,_react.default.createElement(_eui.EuiPageContentHeader,null,_react.default.createElement(_eui.EuiPageContentHeaderSection,null,_react.default.createElement(_eui.EuiTitle,null,_react.default.createElement("h1",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.management.jobsList.accessDeniedTitle",defaultMessage:"Access denied"}))))),_react.default.createElement(_eui.EuiPageContentBody,null,_react.default.createElement(_eui.EuiSpacer,{size:"m"}),_react.default.createElement(_eui.EuiCallOut,{title:_i18n.i18n.translate("xpack.ml.accessDenied.label",{defaultMessage:"Insufficient permissions"}),color:"danger",iconType:"cross"},_react.default.createElement(_eui.EuiText,{size:"s"},_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"xpack.ml.accessDenied.description",defaultMessage:"You don’t have permission to access the ML plugin"}))))))))};exports.Page=Page}])]);