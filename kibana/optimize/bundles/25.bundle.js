/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[25],{5218:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderApp=void 0;var _angular=_interopRequireDefault(__webpack_require__(42));var _angular2=__webpack_require__(119);var _legacy_imports=__webpack_require__(5449);var _public=__webpack_require__(51);var _legacy_app=__webpack_require__(5920);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var angularModuleInstance=null;var renderApp=function renderApp(element,appBasePath,deps){if(!angularModuleInstance){angularModuleInstance=createLocalAngularModule(deps.core,deps.navigation);(0,_legacy_imports.configureAppAngularModule)(angularModuleInstance,{core:deps.core,env:deps.pluginInitializerContext.env},true);(0,_legacy_app.initVisualizeApp)(angularModuleInstance,deps)}var $injector=mountVisualizeApp(appBasePath,element);return function(){return $injector.get("$rootScope").$destroy()}};exports.renderApp=renderApp;var mainTemplate=function mainTemplate(basePath){return'<div ng-view class="kbnLocalApplicationWrapper">\n  <base href="'.concat(basePath,'" />\n</div>\n')};var moduleName="app/visualize";var thirdPartyAngularDependencies=["ngSanitize","ngRoute","react"];function mountVisualizeApp(appBasePath,element){var mountpoint=document.createElement("div");mountpoint.setAttribute("class","kbnLocalApplicationWrapper");mountpoint.innerHTML=mainTemplate(appBasePath);var $injector=_angular.default.bootstrap(mountpoint,[moduleName]);element.appendChild(mountpoint);return $injector}function createLocalAngularModule(core,navigation){createLocalI18nModule();createLocalTopNavModule(navigation);var visualizeAngularModule=_angular.default.module(moduleName,[].concat(thirdPartyAngularDependencies,["app/visualize/I18n","app/visualize/TopNav"]));return visualizeAngularModule}function createLocalTopNavModule(navigation){_angular.default.module("app/visualize/TopNav",["react"]).directive("kbnTopNav",_public.createTopNavDirective).directive("kbnTopNavHelper",(0,_public.createTopNavHelper)(navigation.ui))}function createLocalI18nModule(){_angular.default.module("app/visualize/I18n",[]).provider("i18n",_angular2.I18nProvider).filter("i18n",_angular2.i18nFilter).directive("i18nId",_angular2.i18nDirective)}},5449:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"absoluteToParsedUrl",{enumerable:true,get:function get(){return _absolute_to_parsed_url.absoluteToParsedUrl}});Object.defineProperty(exports,"KibanaParsedUrl",{enumerable:true,get:function get(){return _kibana_parsed_url.KibanaParsedUrl}});Object.defineProperty(exports,"wrapInI18nContext",{enumerable:true,get:function get(){return _i18n.wrapInI18nContext}});Object.defineProperty(exports,"DashboardConstants",{enumerable:true,get:function get(){return _dashboard_constants.DashboardConstants}});Object.defineProperty(exports,"VisSavedObject",{enumerable:true,get:function get(){return _public.VisSavedObject}});Object.defineProperty(exports,"VISUALIZE_EMBEDDABLE_TYPE",{enumerable:true,get:function get(){return _public.VISUALIZE_EMBEDDABLE_TYPE}});Object.defineProperty(exports,"configureAppAngularModule",{enumerable:true,get:function get(){return _public2.configureAppAngularModule}});Object.defineProperty(exports,"migrateLegacyQuery",{enumerable:true,get:function get(){return _public2.migrateLegacyQuery}});Object.defineProperty(exports,"subscribeWithScope",{enumerable:true,get:function get(){return _public2.subscribeWithScope}});var _absolute_to_parsed_url=__webpack_require__(507);var _kibana_parsed_url=__webpack_require__(1848);var _i18n=__webpack_require__(25);var _dashboard_constants=__webpack_require__(475);var _public=__webpack_require__(690);var _public2=__webpack_require__(51)},5572:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getLandingBreadcrumbs=getLandingBreadcrumbs;exports.getWizardStep1Breadcrumbs=getWizardStep1Breadcrumbs;exports.getWizardStep2Breadcrumbs=getWizardStep2Breadcrumbs;exports.getCreateBreadcrumbs=getCreateBreadcrumbs;exports.getEditBreadcrumbs=getEditBreadcrumbs;var _i18n=__webpack_require__(1);var _visualize_constants=__webpack_require__(689);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function getLandingBreadcrumbs(){return[{text:_i18n.i18n.translate("kbn.visualize.listing.breadcrumb",{defaultMessage:"Visualize"}),href:"#".concat(_visualize_constants.VisualizeConstants.LANDING_PAGE_PATH)}]}function getWizardStep1Breadcrumbs(){return[].concat(_toConsumableArray(getLandingBreadcrumbs()),[{text:_i18n.i18n.translate("kbn.visualize.wizard.step1Breadcrumb",{defaultMessage:"Create"})}])}function getWizardStep2Breadcrumbs(){return[].concat(_toConsumableArray(getLandingBreadcrumbs()),[{text:_i18n.i18n.translate("kbn.visualize.wizard.step2Breadcrumb",{defaultMessage:"Create"})}])}function getCreateBreadcrumbs(){return[].concat(_toConsumableArray(getLandingBreadcrumbs()),[{text:_i18n.i18n.translate("kbn.visualize.editor.createBreadcrumb",{defaultMessage:"Create"})}])}function getEditBreadcrumbs($route){return[].concat(_toConsumableArray(getLandingBreadcrumbs()),[{text:$route.current.locals.resolved.savedVis.title}])}},5573:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.addHelpMenuToAppChrome=addHelpMenuToAppChrome;var _i18n=__webpack_require__(1);function addHelpMenuToAppChrome(chrome,docLinks){chrome.setHelpExtension({appName:_i18n.i18n.translate("kbn.visualize.helpMenu.appName",{defaultMessage:"Visualize"}),links:[{linkType:"documentation",href:"".concat(docLinks.ELASTIC_WEBSITE_URL,"guide/en/kibana/").concat(docLinks.DOC_LINK_VERSION,"/visualize.html")}]})}},5574:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.initListingDirective=initListingDirective;exports.VisualizeListingController=VisualizeListingController;var _help_menu_util=__webpack_require__(5573);var _visualize_listing_table=__webpack_require__(5931);var _visualize_constants=__webpack_require__(689);var _i18n=__webpack_require__(1);var _kibana_services=__webpack_require__(1445);var _legacy_imports=__webpack_require__(5449);var _public=__webpack_require__(8);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function initListingDirective(app){app.directive("visualizeListingTable",(function(reactDirective){return reactDirective((0,_legacy_imports.wrapInI18nContext)(_visualize_listing_table.VisualizeListingTable))}))}function VisualizeListingController($scope,createNewVis,kbnUrlStateStorage,history){var _this=this;var _getServices=(0,_kibana_services.getServices)(),addBasePath=_getServices.addBasePath,chrome=_getServices.chrome,savedObjectsClient=_getServices.savedObjectsClient,savedVisualizations=_getServices.savedVisualizations,query=_getServices.data.query,toastNotifications=_getServices.toastNotifications,uiSettings=_getServices.uiSettings,visualizations=_getServices.visualizations,_getServices$core=_getServices.core,docLinks=_getServices$core.docLinks,savedObjects=_getServices$core.savedObjects;var _syncQueryStateWithUr=(0,_public.syncQueryStateWithUrl)(query,kbnUrlStateStorage),stopSyncingQueryServiceStateWithUrl=_syncQueryStateWithUr.stop;var timefilter=query.timefilter.timefilter;timefilter.disableAutoRefreshSelector();timefilter.disableTimeRangeSelector();this.addBasePath=addBasePath;this.uiSettings=uiSettings;this.savedObjects=savedObjects;this.createNewVis=function(){_this.closeNewVisModal=visualizations.showNewVisModal()};this.editItem=function(_ref){var editUrl=_ref.editUrl;window.location.href=addBasePath(editUrl)};this.getViewUrl=function(_ref2){var editUrl=_ref2.editUrl;return addBasePath(editUrl)};if(createNewVis){this.closeNewVisModal=visualizations.showNewVisModal({onClose:function onClose(){history.push(_objectSpread({},history.location,{pathname:_visualize_constants.VisualizeConstants.LANDING_PAGE_PATH}))}})}this.fetchItems=function(filter){var isLabsEnabled=uiSettings.get("visualize:enableLabs");return savedVisualizations.findListItems(filter,uiSettings.get("savedObjects:listingLimit")).then((function(result){_this.totalItems=result.total;return{total:result.total,hits:result.hits.filter((function(result){return isLabsEnabled||result.type.stage!=="experimental"}))}}))};this.deleteSelectedItems=function deleteSelectedItems(selectedItems){return Promise.all(selectedItems.map((function(item){return savedObjectsClient.delete(item.savedObjectType,item.id)}))).catch((function(error){toastNotifications.addError(error,{title:_i18n.i18n.translate("kbn.visualize.visualizeListingDeleteErrorTitle",{defaultMessage:"Error deleting visualization"})})}))};chrome.setBreadcrumbs([{text:_i18n.i18n.translate("kbn.visualize.visualizeListingBreadcrumbsTitle",{defaultMessage:"Visualize"})}]);this.listingLimit=uiSettings.get("savedObjects:listingLimit");(0,_help_menu_util.addHelpMenuToAppChrome)(chrome,docLinks);$scope.$on("$destroy",(function(){if(_this.closeNewVisModal){_this.closeNewVisModal()}stopSyncingQueryServiceStateWithUrl()}))}},5920:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.initVisualizeApp=initVisualizeApp;var _lodash=__webpack_require__(3);var _i18n=__webpack_require__(1);var _history=__webpack_require__(172);var _public=__webpack_require__(24);var _editor=_interopRequireDefault(__webpack_require__(5921));var _visualize_listing=_interopRequireDefault(__webpack_require__(5922));var _visualize_app=__webpack_require__(5923);var _visualize_constants=__webpack_require__(689);var _visualize_listing2=__webpack_require__(5574);var _breadcrumbs=__webpack_require__(5572);var _public2=__webpack_require__(385);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var getResolvedResults=function getResolvedResults(deps){var core=deps.core,data=deps.data,visualizations=deps.visualizations;var results={};return function(savedVis){results.savedVis=savedVis;return visualizations.convertToSerializedVis(savedVis).then((function(serializedVis){return visualizations.createVis(serializedVis.type,serializedVis)})).then((function(vis){if(vis.type.setup){return vis.type.setup(vis).catch((function(){return vis}))}return vis})).then((function(vis){results.vis=vis;return deps.embeddable.getEmbeddableFactory("visualization").createFromObject(results.vis,{timeRange:data.query.timefilter.timefilter.getTime(),filters:data.query.filterManager.getFilters()})})).then((function(embeddableHandler){results.embeddableHandler=embeddableHandler;if(results.vis.data.savedSearchId){return(0,_public2.createSavedSearchesLoader)({savedObjectsClient:core.savedObjects.client,indexPatterns:data.indexPatterns,chrome:core.chrome,overlays:core.overlays}).get(results.vis.data.savedSearchId)}})).then((function(savedSearch){if(savedSearch){results.savedSearch=savedSearch}return results}))}};function initVisualizeApp(app,deps){(0,_visualize_app.initVisualizeAppDirective)(app,deps);app.factory("history",(function(){return(0,_history.createHashHistory)()}));app.factory("kbnUrlStateStorage",(function(history){return(0,_public.createKbnUrlStateStorage)({history:history,useHash:deps.uiSettings.get("state:storeInSessionStorage")})}));app.config((function($routeProvider){var defaults={reloadOnSearch:false,requireUICapability:"visualize.show",badge:function badge(){if(deps.visualizeCapabilities.save){return undefined}return{text:_i18n.i18n.translate("kbn.visualize.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:_i18n.i18n.translate("kbn.visualize.badge.readOnly.tooltip",{defaultMessage:"Unable to save visualizations"}),iconType:"glasses"}}};$routeProvider.when(_visualize_constants.VisualizeConstants.LANDING_PAGE_PATH,_objectSpread({},defaults,{template:_visualize_listing.default,k7Breadcrumbs:_breadcrumbs.getLandingBreadcrumbs,controller:_visualize_listing2.VisualizeListingController,controllerAs:"listingController",resolve:{createNewVis:function createNewVis(){return false},hasDefaultIndex:function hasDefaultIndex(history){return(0,_public.ensureDefaultIndexPattern)(deps.core,deps.data,history)}}})).when(_visualize_constants.VisualizeConstants.WIZARD_STEP_1_PAGE_PATH,_objectSpread({},defaults,{template:_visualize_listing.default,k7Breadcrumbs:_breadcrumbs.getWizardStep1Breadcrumbs,controller:_visualize_listing2.VisualizeListingController,controllerAs:"listingController",resolve:{createNewVis:function createNewVis(){return true},hasDefaultIndex:function hasDefaultIndex(history){return(0,_public.ensureDefaultIndexPattern)(deps.core,deps.data,history)}}})).when(_visualize_constants.VisualizeConstants.CREATE_PATH,_objectSpread({},defaults,{template:_editor.default,k7Breadcrumbs:_breadcrumbs.getCreateBreadcrumbs,resolve:{resolved:function resolved($route,history){var core=deps.core,data=deps.data,savedVisualizations=deps.savedVisualizations,visualizations=deps.visualizations,toastNotifications=deps.toastNotifications;var visTypes=visualizations.all();var visType=(0,_lodash.find)(visTypes,{name:$route.current.params.type});var shouldHaveIndex=visType.requiresSearch&&visType.options.showIndexSelection;var hasIndex=$route.current.params.indexPattern||$route.current.params.savedSearchId;if(shouldHaveIndex&&!hasIndex){throw new Error(_i18n.i18n.translate("kbn.visualize.createVisualization.noIndexPatternOrSavedSearchIdErrorMessage",{defaultMessage:"You must provide either an indexPattern or a savedSearchId"}))}var delay=function delay(res){return new Promise((function(resolve){setTimeout((function(){return resolve(res)}),0)}))};return(0,_public.ensureDefaultIndexPattern)(core,data,history).then((function(){return savedVisualizations.get($route.current.params)})).then(getResolvedResults(deps)).then(delay).catch((0,_public.redirectWhenMissing)({history:history,mapping:_visualize_constants.VisualizeConstants.LANDING_PAGE_PATH,toastNotifications:toastNotifications}))}}})).when("".concat(_visualize_constants.VisualizeConstants.EDIT_PATH,"/:id"),_objectSpread({},defaults,{template:_editor.default,k7Breadcrumbs:_breadcrumbs.getEditBreadcrumbs,resolve:{resolved:function resolved($route,history){var chrome=deps.chrome,core=deps.core,data=deps.data,savedVisualizations=deps.savedVisualizations,toastNotifications=deps.toastNotifications;return(0,_public.ensureDefaultIndexPattern)(core,data,history).then((function(){return savedVisualizations.get($route.current.params.id)})).then((function(savedVis){chrome.recentlyAccessed.add(savedVis.getFullPath(),savedVis.title,savedVis.id);return savedVis})).then(getResolvedResults(deps)).catch((0,_public.redirectWhenMissing)({history:history,mapping:{visualization:_visualize_constants.VisualizeConstants.LANDING_PAGE_PATH,search:"/management/kibana/objects/savedVisualizations/"+$route.current.params.id,"index-pattern":"/management/kibana/objects/savedVisualizations/"+$route.current.params.id,"index-pattern-field":"/management/kibana/objects/savedVisualizations/"+$route.current.params.id},toastNotifications:toastNotifications,onBeforeRedirect:function onBeforeRedirect(){deps.setActiveUrl(_visualize_constants.VisualizeConstants.LANDING_PAGE_PATH)}}))}}})).when("visualize/:tail*?",{redirectTo:"/".concat(deps.config.defaultAppId)})}))}},5921:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]='<visualize-app class="app-container visEditor visEditor--{{ vis.type.name }}">\n\n  \x3c!--\n    Local nav.\n    Most visualizations have all search bar components enabled\n    Some visualizations have fewer options but all visualizations have a search bar\n    which is why show-search-baris set to "true".\n    All visualizaions also have least a timepicker \\ autorefresh component, which is why\n    show-query-bar is set to "true".\n  --\x3e\n  <kbn-top-nav\n    ng-if="isVisible"\n    app-name="\'visualize\'"\n    config="topNavMenu"\n    show-search-bar="true"\n    show-query-bar="true"\n    show-query-input="showQueryInput()"\n    show-filter-bar="showFilterBar() && isVisible"\n    show-date-picker="showQueryBarTimePicker()"\n    show-auto-refresh-only="!showQueryBarTimePicker()"\n    query="query"\n    saved-query="savedQuery"\n    screen-title="vis.title"\n    on-query-submit="updateQueryAndFetch"\n    index-patterns="[indexPattern]"\n    filters="filters"\n    on-filters-updated="onFiltersUpdated"\n    date-range-from="timeRange.from"\n    date-range-to="timeRange.to"\n    is-refresh-paused="refreshInterval.pause"\n    refresh-interval="refreshInterval.value"\n    on-refresh-change="onRefreshChange"\n    show-save-query="showSaveQuery"\n    on-saved="updateSavedQuery"\n    on-saved-query-updated="updateSavedQuery"\n    on-clear-saved-query="onClearSavedQuery"\n  >\n  </kbn-top-nav>\n\n  \x3c!--\n    The top nav is hidden in embed mode but the filter bar must still be present so\n    we show the filter bar on its own here if the chrome is not visible.\n  --\x3e\n  <kbn-top-nav\n    ng-if="showFilterBar() && !isVisible"\n\n    app-name="\'visualize\'"\n    show-search-bar="true"\n    show-filter-bar="true"\n    show-save-query="false"\n    show-date-picker="false"\n\n    filters="filters"\n    on-filters-updated="onFiltersUpdated"\n    index-patterns="[indexPattern]"\n  >\n  </kbn-top-nav>\n\n  <div\n    class="euiCallOut euiCallOut--primary euiCallOut--small hide-for-sharing"\n    ng-if="vis.type.shouldMarkAsExperimentalInUI()"\n    data-test-subj="experimentalVisInfo"\n  >\n    <div class="euiText">\n      <p ng-bind-html="getAdditionalMessage()"></p>\n    </div>\n  </div>\n\n  <visualization-embedded\n    ng-if="!isVisible"\n    class="visualize"\n    vis="vis"\n    embeddable-handler="embeddableHandler"\n    ui-state="uiState"\n    time-range="timeRange"\n    filters="filters"\n    query="query"\n    app-state="appState"\n  ></visualization-embedded>\n\n  <h1\n    class="euiScreenReaderOnly"\n    i18n-id="kbn.visualize.pageHeading"\n    i18n-default-message="{chartName} {chartType} visualization"\n    i18n-values="{\n      chartName: savedVis.title,\n      chartType: vis.type.title\n    }"\n  >\n  </h1>\n  <visualization-editor\n    ng-if="isVisible"\n    vis="vis"\n    saved-search="savedSearch"\n    embeddable-handler="embeddableHandler"\n    event-emitter="eventEmitter"\n    ui-state="uiState"\n    time-range="timeRange"\n    filters="filters"\n    query="query"\n    class="visEditor__content"\n  ></visualization-editor>\n\n</visualize-app>\n'},5922:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_exports__["default"]='<div class="kuiViewContent kuiViewContent--constrainedWidth kuiViewContentItem"\n     data-test-subj="visualizeLandingPage"\n>\n  <visualize-listing-table\n    find-items="listingController.fetchItems"\n    delete-items="listingController.deleteSelectedItems"\n    create-item="listingController.createNewVis"\n    get-view-url="listingController.getViewUrl"\n    edit-item="listingController.editItem"\n    listing-limit="listingController.listingLimit"\n  ></visualize-listing-table>\n</div>\n'},5923:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.initVisualizeAppDirective=initVisualizeAppDirective;var _editor=__webpack_require__(5924);var _visualize_listing=__webpack_require__(5574);function initVisualizeAppDirective(app,deps){(0,_editor.initEditorDirective)(app,deps);(0,_visualize_listing.initListingDirective)(app)}},5924:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.initEditorDirective=initEditorDirective;var _angular=_interopRequireDefault(__webpack_require__(42));var _lodash=_interopRequireDefault(__webpack_require__(3));var _rxjs=__webpack_require__(18);var _operators=__webpack_require__(31);var _i18n=__webpack_require__(1);var _events=__webpack_require__(146);var _react=_interopRequireDefault(__webpack_require__(0));var _react2=__webpack_require__(4);var _lib=__webpack_require__(5925);var _visualize_constants=__webpack_require__(689);var _breadcrumbs=__webpack_require__(5572);var _help_menu_util=__webpack_require__(5573);var _public=__webpack_require__(24);var _public2=__webpack_require__(14);var _public3=__webpack_require__(51);var _public4=__webpack_require__(127);var _public5=__webpack_require__(8);var _visualization_editor=__webpack_require__(5929);var _visualization=__webpack_require__(5930);var _legacy_imports=__webpack_require__(5449);var _kibana_services=__webpack_require__(1445);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function initEditorDirective(app,deps){app.directive("visualizeApp",(function(){return{restrict:"E",controllerAs:"visualizeApp",controller:VisualizeAppController}}));(0,_visualization_editor.initVisEditorDirective)(app,deps);(0,_visualization.initVisualizationDirective)(app,deps)}function VisualizeAppController($scope,$route,$injector,$timeout,kbnUrlStateStorage,history){var _getServices=(0,_kibana_services.getServices)(),indexPatterns=_getServices.indexPatterns,localStorage=_getServices.localStorage,visualizeCapabilities=_getServices.visualizeCapabilities,share=_getServices.share,queryService=_getServices.data.query,toastNotifications=_getServices.toastNotifications,chrome=_getServices.chrome,getBasePath=_getServices.getBasePath,_getServices$core=_getServices.core,docLinks=_getServices$core.docLinks,fatalErrors=_getServices$core.fatalErrors,savedQueryService=_getServices.savedQueryService,uiSettings=_getServices.uiSettings,I18nContext=_getServices.I18nContext,setActiveUrl=_getServices.setActiveUrl,visualizations=_getServices.visualizations;var filterManager=queryService.filterManager,timefilter=queryService.timefilter.timefilter;var _syncQueryStateWithUr=(0,_public5.syncQueryStateWithUrl)(queryService,kbnUrlStateStorage),stopSyncingQueryServiceStateWithUrl=_syncQueryStateWithUr.stop;var _$route$current$local=$route.current.locals.resolved,vis=_$route$current$local.vis,savedVis=_$route$current$local.savedVis,savedSearch=_$route$current$local.savedSearch,embeddableHandler=_$route$current$local.embeddableHandler;$scope.eventEmitter=new _events.EventEmitter;var _applyVis=function _applyVis(){$scope.$apply()};$scope.eventEmitter.on("apply",_applyVis);var searchSource=vis.data.searchSource;$scope.vis=vis;$scope.savedSearch=savedSearch;var $appStatus={dirty:!savedVis.id};var defaultQuery={query:"",language:localStorage.get("kibana.userQueryLanguage")||uiSettings.get("search:queryLanguage")};var visStateToEditorState=function visStateToEditorState(){var savedVisState=visualizations.convertFromSerializedVis(vis.serialize());return{uiState:vis.uiState.toJSON(),query:vis.data.searchSource.getOwnField("query")||defaultQuery,filters:vis.data.searchSource.getOwnField("filter")||[],vis:_objectSpread({},savedVisState.visState,{title:vis.title}),linked:!!savedVis.savedSearchId}};var stateDefaults=visStateToEditorState();var _useVisualizeAppState=(0,_lib.useVisualizeAppState)({stateDefaults:stateDefaults,kbnUrlStateStorage:kbnUrlStateStorage}),stateContainer=_useVisualizeAppState.stateContainer,stopStateSync=_useVisualizeAppState.stopStateSync;$scope.eventEmitter.on("dirtyStateChange",(function(_ref){var isDirty=_ref.isDirty;if(!isDirty){stateContainer.transitions.updateVisState(visStateToEditorState().vis)}$timeout((function(){$scope.dirty=isDirty}))}));$scope.eventEmitter.on("updateVis",(function(){embeddableHandler.reload()}));$scope.embeddableHandler=embeddableHandler;$scope.topNavMenu=[].concat(_toConsumableArray(visualizeCapabilities.save?[{id:"save",label:_i18n.i18n.translate("kbn.topNavMenu.saveVisualizationButtonLabel",{defaultMessage:"save"}),description:_i18n.i18n.translate("kbn.visualize.topNavMenu.saveVisualizationButtonAriaLabel",{defaultMessage:"Save Visualization"}),testId:"visualizeSaveButton",disableButton:function disableButton(){return Boolean($scope.dirty)},tooltip:function tooltip(){if($scope.dirty){return _i18n.i18n.translate("kbn.visualize.topNavMenu.saveVisualizationDisabledButtonTooltip",{defaultMessage:"Apply or Discard your changes before saving"})}},run:function(){var _run=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var onSave,confirmButtonLabel,saveModal;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:onSave=function onSave(_ref2){var newTitle=_ref2.newTitle,newCopyOnSave=_ref2.newCopyOnSave,isTitleDuplicateConfirmed=_ref2.isTitleDuplicateConfirmed,onTitleDuplicate=_ref2.onTitleDuplicate,newDescription=_ref2.newDescription;var currentTitle=savedVis.title;savedVis.title=newTitle;savedVis.copyOnSave=newCopyOnSave;savedVis.description=newDescription;var saveOptions={confirmOverwrite:false,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate};return doSave(saveOptions).then((function(response){if(!response.id||response.error){savedVis.title=currentTitle}return response}))};confirmButtonLabel=$scope.isAddToDashMode()?_react.default.createElement(_react2.FormattedMessage,{id:"kbn.visualize.saveDialog.saveAndAddToDashboardButtonLabel",defaultMessage:"Save and add to dashboard"}):null;saveModal=_react.default.createElement(_public4.SavedObjectSaveModal,{onSave:onSave,onClose:function onClose(){},title:savedVis.title,showCopyOnSave:savedVis.id?true:false,objectType:"visualization",confirmButtonLabel:confirmButtonLabel,description:savedVis.description,showDescription:true});(0,_public4.showSaveModal)(saveModal,I18nContext);case 4:case"end":return _context.stop()}}}),_callee)})));function run(){return _run.apply(this,arguments)}return run}()}]:[]),[{id:"share",label:_i18n.i18n.translate("kbn.topNavMenu.shareVisualizationButtonLabel",{defaultMessage:"share"}),description:_i18n.i18n.translate("kbn.visualize.topNavMenu.shareVisualizationButtonAriaLabel",{defaultMessage:"Share Visualization"}),testId:"shareTopNavButton",run:function run(anchorElement){var hasUnappliedChanges=$scope.dirty;var hasUnsavedChanges=$appStatus.dirty;share.toggleShareContextMenu({anchorElement:anchorElement,allowEmbed:true,allowShortUrl:visualizeCapabilities.createShortUrl,shareableUrl:(0,_public.unhashUrl)(window.location.href),objectId:savedVis.id,objectType:"visualization",sharingData:{title:savedVis.title},isDirty:hasUnappliedChanges||hasUnsavedChanges})}},{id:"inspector",label:_i18n.i18n.translate("kbn.topNavMenu.openInspectorButtonLabel",{defaultMessage:"inspect"}),description:_i18n.i18n.translate("kbn.visualize.topNavMenu.openInspectorButtonAriaLabel",{defaultMessage:"Open Inspector for visualization"}),testId:"openInspectorButton",disableButton:function disableButton(){return!embeddableHandler.hasInspector||!embeddableHandler.hasInspector()},run:function run(){var inspectorSession=embeddableHandler.openInspector();var removeWatch=$scope.$on("$destroy",(function(){return inspectorSession.close()}));inspectorSession.onClose.finally(removeWatch)},tooltip:function tooltip(){if(!embeddableHandler.hasInspector||!embeddableHandler.hasInspector()){return _i18n.i18n.translate("kbn.visualize.topNavMenu.openInspectorDisabledButtonTooltip",{defaultMessage:"This visualization doesn't support any inspectors."})}}},{id:"refresh",label:_i18n.i18n.translate("kbn.topNavMenu.refreshButtonLabel",{defaultMessage:"refresh"}),description:_i18n.i18n.translate("kbn.visualize.topNavMenu.refreshButtonAriaLabel",{defaultMessage:"Refresh"}),run:function run(){embeddableHandler.reload()},testId:"visualizeRefreshButton"}]);if(savedVis.id){chrome.docTitle.change(savedVis.title)}filterManager.setAppFilters(_lodash.default.cloneDeep(stateContainer.getState().filters));var stopSyncingAppFilters=(0,_public5.connectToQueryState)(queryService,{set:function set(_ref3){var filters=_ref3.filters;return stateContainer.transitions.set("filters",filters)},get:function get(){return{filters:stateContainer.getState().filters}},state$:stateContainer.state$.pipe((0,_operators.map)((function(state){return{filters:state.filters}})))},{filters:_public5.esFilters.FilterStateStore.APP_STATE});var stopAllSyncing=function stopAllSyncing(){stopStateSync();stopSyncingQueryServiceStateWithUrl();stopSyncingAppFilters()};if(!_lodash.default.isEqual(stateContainer.getState().vis,stateDefaults.vis)){try{var _stateContainer$getSt=stateContainer.getState().vis,aggs=_stateContainer$getSt.aggs,visState=_objectWithoutProperties(_stateContainer$getSt,["aggs"]);vis.setState(_objectSpread({},visState,{data:{aggs:aggs}}))}catch(error){stopAllSyncing();toastNotifications.addWarning({title:_i18n.i18n.translate("kbn.visualize.visualizationTypeInvalidNotificationMessage",{defaultMessage:"Invalid visualization type"}),text:(0,_public2.toMountPoint)(_react.default.createElement(_public2.MarkdownSimple,null,error.message))});history.replace("".concat(_visualize_constants.VisualizeConstants.LANDING_PAGE_PATH,"?notFound=visualization"));return}}$scope.filters=filterManager.getFilters();$scope.onFiltersUpdated=function(filters){filterManager.setFilters(filters)};$scope.showSaveQuery=visualizeCapabilities.saveQuery;$scope.$watch((function(){return visualizeCapabilities.saveQuery}),(function(newCapability){$scope.showSaveQuery=newCapability}));var updateSavedQueryFromUrl=function updateSavedQueryFromUrl(savedQueryId){if(!savedQueryId){delete $scope.savedQuery;return}if($scope.savedQuery&&$scope.savedQuery.id===savedQueryId){return}savedQueryService.getSavedQuery(savedQueryId).then((function(savedQuery){$scope.$evalAsync((function(){$scope.updateSavedQuery(savedQuery)}))}))};function init(){if(vis.data.indexPattern){$scope.indexPattern=vis.data.indexPattern}else{indexPatterns.getDefault().then((function(defaultIndexPattern){$scope.indexPattern=defaultIndexPattern}))}var initialState=stateContainer.getState();var handleLinkedSearch=function handleLinkedSearch(linked){if(linked&&!savedVis.savedSearchId&&savedSearch){savedVis.savedSearchId=savedSearch.id;vis.data.savedSearchId=savedSearch.id;searchSource.setParent(savedSearch.searchSource)}else if(!linked&&savedVis.savedSearchId){delete savedVis.savedSearchId;delete vis.data.savedSearchId}};var _makeStateful=(0,_lib.makeStateful)("uiState",stateContainer),persistedState=_makeStateful.persistedState,unsubscribePersisted=_makeStateful.unsubscribePersisted,persistOnChange=_makeStateful.persistOnChange;vis.uiState=persistedState;$scope.uiState=persistedState;$scope.savedVis=savedVis;$scope.query=initialState.query;$scope.searchSource=searchSource;$scope.refreshInterval=timefilter.getRefreshInterval();handleLinkedSearch(initialState.linked);var addToDashMode=$route.current.params[_legacy_imports.DashboardConstants.ADD_VISUALIZATION_TO_DASHBOARD_MODE_PARAM];(0,_public.removeQueryParam)(history,_legacy_imports.DashboardConstants.ADD_VISUALIZATION_TO_DASHBOARD_MODE_PARAM);$scope.isAddToDashMode=function(){return addToDashMode};$scope.showFilterBar=function(){return vis.type.options.showFilterBar};$scope.showQueryInput=function(){return vis.type.requiresSearch&&vis.type.options.showQueryBar};$scope.showQueryBarTimePicker=function(){var hasTimeField=vis.data.indexPattern?!!vis.data.indexPattern.timeFieldName:true;return vis.type.options.showTimePicker&&hasTimeField};$scope.timeRange=timefilter.getTime();var unsubscribeStateUpdates=stateContainer.subscribe((function(state){var newQuery=(0,_legacy_imports.migrateLegacyQuery)(state.query);if(!_lodash.default.isEqual(state.query,newQuery)){stateContainer.transitions.set("query",newQuery)}persistOnChange(state);updateSavedQueryFromUrl(state.savedQuery);if(!_lodash.default.isEqual(_objectSpread({},visualizations.convertFromSerializedVis(vis.serialize()).visState,{title:vis.title}),state.vis)){var _state$vis=state.vis,_aggs=_state$vis.aggs,_visState=_objectWithoutProperties(_state$vis,["aggs"]);vis.setState(_objectSpread({},_visState,{data:{aggs:_aggs}}));embeddableHandler.reload();$scope.eventEmitter.emit("updateEditor")}$appStatus.dirty=true;$scope.fetch()}));var updateTimeRange=function updateTimeRange(){$scope.timeRange=timefilter.getTime();$scope.$broadcast("render")};updateSavedQueryFromUrl(initialState.savedQuery);var subscriptions=new _rxjs.Subscription;subscriptions.add((0,_legacy_imports.subscribeWithScope)($scope,timefilter.getRefreshIntervalUpdate$(),{next:function next(){$scope.refreshInterval=timefilter.getRefreshInterval()}},(function(error){return(0,_public3.addFatalError)(fatalErrors,error)})));subscriptions.add((0,_legacy_imports.subscribeWithScope)($scope,timefilter.getTimeUpdate$(),{next:updateTimeRange},(function(error){return(0,_public3.addFatalError)(fatalErrors,error)})));subscriptions.add(chrome.getIsVisible$().subscribe((function(isVisible){$scope.$evalAsync((function(){$scope.isVisible=isVisible}))})));$scope.fetch=function(){var _stateContainer$getSt2=stateContainer.getState(),query=_stateContainer$getSt2.query,linked=_stateContainer$getSt2.linked,filters=_stateContainer$getSt2.filters;$scope.query=query;handleLinkedSearch(linked);vis.data.searchSource.setField("query",query);vis.data.searchSource.setField("filter",filters);$scope.$broadcast("render")};subscriptions.add((0,_legacy_imports.subscribeWithScope)($scope,filterManager.getUpdates$(),{next:function next(){$scope.filters=filterManager.getFilters()}},(function(error){return(0,_public3.addFatalError)(fatalErrors,error)})));subscriptions.add((0,_legacy_imports.subscribeWithScope)($scope,filterManager.getFetches$(),{next:$scope.fetch},(function(error){return(0,_public3.addFatalError)(fatalErrors,error)})));$scope.$on("$destroy",(function(){if($scope._handler){$scope._handler.destroy()}savedVis.destroy();subscriptions.unsubscribe();$scope.eventEmitter.off("apply",_applyVis);unsubscribePersisted();unsubscribeStateUpdates();stopAllSyncing()}));$timeout((function(){$scope.$broadcast("render")}))}$scope.updateQueryAndFetch=function(_ref4){var query=_ref4.query,dateRange=_ref4.dateRange;var isUpdate=query&&!_lodash.default.isEqual(query,stateContainer.getState().query)||dateRange&&!_lodash.default.isEqual(dateRange,$scope.timeRange);stateContainer.transitions.set("query",query);timefilter.setTime(dateRange);if(!isUpdate){embeddableHandler.reload()}};$scope.onRefreshChange=function(_ref5){var isPaused=_ref5.isPaused,refreshInterval=_ref5.refreshInterval;timefilter.setRefreshInterval({pause:isPaused,value:refreshInterval?refreshInterval:$scope.refreshInterval.value})};$scope.onClearSavedQuery=function(){delete $scope.savedQuery;stateContainer.transitions.removeSavedQuery(defaultQuery);filterManager.setFilters(filterManager.getGlobalFilters())};var updateStateFromSavedQuery=function updateStateFromSavedQuery(savedQuery){stateContainer.transitions.updateFromSavedQuery(savedQuery);var savedQueryFilters=savedQuery.attributes.filters||[];var globalFilters=filterManager.getGlobalFilters();filterManager.setFilters([].concat(_toConsumableArray(globalFilters),_toConsumableArray(savedQueryFilters)));if(savedQuery.attributes.timefilter){timefilter.setTime({from:savedQuery.attributes.timefilter.from,to:savedQuery.attributes.timefilter.to});if(savedQuery.attributes.timefilter.refreshInterval){timefilter.setRefreshInterval(savedQuery.attributes.timefilter.refreshInterval)}}};$scope.updateSavedQuery=function(savedQuery){$scope.savedQuery=savedQuery;updateStateFromSavedQuery(savedQuery)};function doSave(saveOptions){stateContainer.transitions.setVis({title:savedVis.title,type:savedVis.type||stateContainer.getState().vis.type});savedVis.searchSource.setField("query",stateContainer.getState().query);savedVis.searchSource.setField("filter",stateContainer.getState().filters);savedVis.visState=stateContainer.getState().vis;savedVis.uiStateJSON=_angular.default.toJson($scope.uiState.toJSON());$appStatus.dirty=false;return savedVis.save(saveOptions).then((function(id){$scope.$evalAsync((function(){if(id){toastNotifications.addSuccess({title:_i18n.i18n.translate("kbn.visualize.topNavMenu.saveVisualization.successNotificationText",{defaultMessage:"Saved '{visTitle}'",values:{visTitle:savedVis.title}}),"data-test-subj":"saveVisualizationSuccess"});if($scope.isAddToDashMode()){var savedVisualizationParsedUrl=new _legacy_imports.KibanaParsedUrl({basePath:getBasePath(),appId:_public3.kbnBaseUrl.slice("/app/".length),appPath:"".concat(_visualize_constants.VisualizeConstants.EDIT_PATH,"/").concat(encodeURIComponent(savedVis.id))});history.replace(savedVisualizationParsedUrl.appPath);setActiveUrl(savedVisualizationParsedUrl.appPath);var lastDashboardAbsoluteUrl=chrome.navLinks.get("kibana:dashboard").url;var dashboardParsedUrl=(0,_legacy_imports.absoluteToParsedUrl)(lastDashboardAbsoluteUrl,getBasePath());dashboardParsedUrl.addQueryParameter(_legacy_imports.DashboardConstants.ADD_EMBEDDABLE_TYPE,_legacy_imports.VISUALIZE_EMBEDDABLE_TYPE);dashboardParsedUrl.addQueryParameter(_legacy_imports.DashboardConstants.ADD_EMBEDDABLE_ID,savedVis.id);history.push(dashboardParsedUrl.appPath)}else if(savedVis.id===$route.current.params.id){chrome.docTitle.change(savedVis.lastSavedTitle);chrome.setBreadcrumbs($injector.invoke(_breadcrumbs.getEditBreadcrumbs));savedVis.vis.title=savedVis.title;savedVis.vis.description=savedVis.description}else{history.replace(_objectSpread({},history.location,{pathname:"".concat(_visualize_constants.VisualizeConstants.EDIT_PATH,"/").concat(savedVis.id)}))}}}));return{id:id}}),(function(error){console.error(error);toastNotifications.addDanger({title:_i18n.i18n.translate("kbn.visualize.topNavMenu.saveVisualization.failureNotificationText",{defaultMessage:"Error on saving '{visTitle}'",values:{visTitle:savedVis.title}}),text:error.message,"data-test-subj":"saveVisualizationError"});return{error:error}}))}var unlinkFromSavedSearch=function unlinkFromSavedSearch(){var searchSourceParent=savedSearch.searchSource;var searchSourceGrandparent=searchSourceParent.getParent();var currentIndex=searchSourceParent.getField("index");searchSource.setField("index",currentIndex);searchSource.setParent(searchSourceGrandparent);stateContainer.transitions.unlinkSavedSearch({query:searchSourceParent.getField("query"),parentFilters:searchSourceParent.getOwnField("filter")});toastNotifications.addSuccess(_i18n.i18n.translate("kbn.visualize.linkedToSearch.unlinkSuccessNotificationText",{defaultMessage:"Unlinked from saved search '{searchTitle}'",values:{searchTitle:savedSearch.title}}))};$scope.getAdditionalMessage=function(){return'<i class="kuiIcon fa-flask"></i>'+_i18n.i18n.translate("kbn.visualize.experimentalVisInfoText",{defaultMessage:"This visualization is marked as experimental."})+" "+vis.type.feedbackMessage};$scope.eventEmitter.on("unlinkFromSavedSearch",unlinkFromSavedSearch);(0,_help_menu_util.addHelpMenuToAppChrome)(chrome,docLinks);init()}},5925:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"useVisualizeAppState",{enumerable:true,get:function get(){return _visualize_app_state.useVisualizeAppState}});Object.defineProperty(exports,"makeStateful",{enumerable:true,get:function get(){return _make_stateful.makeStateful}});var _visualize_app_state=__webpack_require__(5926);var _make_stateful=__webpack_require__(5928)},5926:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useVisualizeAppState=useVisualizeAppState;var _lodash=__webpack_require__(3);var _migrate_app_state=__webpack_require__(5927);var _public=__webpack_require__(24);function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var STATE_STORAGE_KEY="_a";function toObject(state){return(0,_lodash.omit)(state,(function(value,key){return key.charAt(0)==="$"||key.charAt(0)==="_"||(0,_lodash.isFunction)(value)}))}function useVisualizeAppState(_ref){var stateDefaults=_ref.stateDefaults,kbnUrlStateStorage=_ref.kbnUrlStateStorage;var urlState=kbnUrlStateStorage.get(STATE_STORAGE_KEY);var initialState=(0,_migrate_app_state.migrateAppState)(_objectSpread({},stateDefaults,{},urlState));kbnUrlStateStorage.set(STATE_STORAGE_KEY,initialState,{replace:true});var stateContainer=(0,_public.createStateContainer)(initialState,{set:function set(state){return function(prop,value){return _objectSpread({},state,_defineProperty({},prop,value))}},setVis:function setVis(state){return function(vis){return _objectSpread({},state,{vis:_objectSpread({},state.vis,{},vis)})}},removeSavedQuery:function removeSavedQuery(state){return function(defaultQuery){var savedQuery=state.savedQuery,rest=_objectWithoutProperties(state,["savedQuery"]);return _objectSpread({},rest,{query:defaultQuery})}},unlinkSavedSearch:function unlinkSavedSearch(state){return function(_ref2){var query=_ref2.query,_ref2$parentFilters=_ref2.parentFilters,parentFilters=_ref2$parentFilters===void 0?[]:_ref2$parentFilters;return _objectSpread({},state,{query:query||state.query,filters:(0,_lodash.union)(state.filters,parentFilters),linked:false})}},updateVisState:function updateVisState(state){return function(newVisState){return _objectSpread({},state,{vis:toObject(newVisState)})}},updateFromSavedQuery:function updateFromSavedQuery(state){return function(savedQuery){return _objectSpread({},state,{savedQuery:savedQuery.id,query:savedQuery.attributes.query})}}});var _syncState=(0,_public.syncState)({storageKey:STATE_STORAGE_KEY,stateContainer:_objectSpread({},stateContainer,{set:function set(state){if(state){stateContainer.set(state)}}}),stateStorage:kbnUrlStateStorage}),startStateSync=_syncState.start,stopStateSync=_syncState.stop;startStateSync();return{stateContainer:stateContainer,stopStateSync:stopStateSync}}},5927:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.migrateAppState=migrateAppState;var _lodash=__webpack_require__(3);function migrateAppState(appState){if(appState.vis.type!=="table"){return appState}var visAggs=(0,_lodash.get)(appState,"vis.aggs");if(visAggs){var splitCount=0;var migratedAggs=visAggs.map((function(agg){if(agg.schema!=="split"){return agg}splitCount++;if(splitCount===1){return agg}agg.schema="bucket";agg.params=(0,_lodash.omit)(agg.params,["row"]);return agg}));if(splitCount<=1){return appState}appState.vis.aggs=migratedAggs}return appState}},5928:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.makeStateful=makeStateful;var _public=__webpack_require__(313);function makeStateful(prop,stateContainer){var persistedState=new _public.PersistedState;var updateOnChange=function updateOnChange(){stateContainer.transitions.set(prop,persistedState.getChanges())};var handlerOnChange=function handlerOnChange(method){return persistedState[method]("change",updateOnChange)};handlerOnChange("on");var unsubscribePersisted=function unsubscribePersisted(){return handlerOnChange("off")};var persistOnChange=function persistOnChange(state){if(state[prop]){persistedState.set(state[prop])}};var appState=stateContainer.getState();if(appState[prop])persistedState.setSilent(appState[prop]);return{persistedState:persistedState,unsubscribePersisted:unsubscribePersisted,persistOnChange:persistOnChange}}},5929:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.initVisEditorDirective=initVisEditorDirective;function initVisEditorDirective(app,deps){app.directive("visualizationEditor",(function($timeout){return{restrict:"E",scope:{vis:"=",uiState:"=?",timeRange:"=",filters:"=",query:"=",savedSearch:"=",embeddableHandler:"=",eventEmitter:"="},link:function link($scope,element){var Editor=$scope.vis.type.editor||deps.DefaultVisualizationEditor;var editor=new Editor(element[0],$scope.vis,$scope.eventEmitter,$scope.embeddableHandler);$scope.renderFunction=function(){editor.render({core:deps.core,data:deps.data,embeddable:deps.embeddable,uiState:$scope.uiState,timeRange:$scope.timeRange,filters:$scope.filters,query:$scope.query,linked:!!$scope.vis.data.savedSearchId,savedSearch:$scope.savedSearch})};$scope.$on("render",(function(event){event.preventDefault();$timeout((function(){$scope.renderFunction()}))}));$scope.$on("$destroy",(function(){editor.destroy()}))}}}))}},5930:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.initVisualizationDirective=initVisualizationDirective;function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function initVisualizationDirective(app){app.directive("visualizationEmbedded",(function($timeout){return{restrict:"E",scope:{embeddableHandler:"=",uiState:"=?",timeRange:"=",filters:"=",query:"=",appState:"="},link:function link($scope,element){$scope.renderFunction=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!$scope.rendered){$scope.embeddableHandler.render(element[0]);$scope.rendered=true}$scope.embeddableHandler.updateInput({timeRange:$scope.timeRange,filters:$scope.filters||[],query:$scope.query});case 2:case"end":return _context.stop()}}}),_callee)})));$scope.$on("render",(function(event){event.preventDefault();$timeout((function(){$scope.renderFunction()}))}));$scope.$on("$destroy",(function(){if($scope.embeddableHandler){$scope.embeddableHandler.destroy()}}))}}}))}},5931:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.VisualizeListingTable=void 0;var _react=_interopRequireWildcard(__webpack_require__(0));var _propTypes=_interopRequireDefault(__webpack_require__(7));var _react2=__webpack_require__(4);var _i18n=__webpack_require__(1);var _public=__webpack_require__(14);var _eui=__webpack_require__(2);var _kibana_services=__webpack_require__(1445);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}var VisualizeListingTable=function(_Component){_inherits(VisualizeListingTable,_Component);function VisualizeListingTable(props){_classCallCheck(this,VisualizeListingTable);return _possibleConstructorReturn(this,_getPrototypeOf(VisualizeListingTable).call(this,props))}_createClass(VisualizeListingTable,[{key:"render",value:function render(){var _getServices=(0,_kibana_services.getServices)(),visualizeCapabilities=_getServices.visualizeCapabilities,uiSettings=_getServices.uiSettings,toastNotifications=_getServices.toastNotifications;return _react.default.createElement(_public.TableListView,{headingId:"visualizeListingHeading",createItem:this.props.createItem,findItems:this.props.findItems,deleteItems:visualizeCapabilities.delete?this.props.deleteItems:null,editItem:visualizeCapabilities.save?this.props.editItem:null,tableColumns:this.getTableColumns(),listingLimit:this.props.listingLimit,selectable:function selectable(item){return item.canDelete},initialFilter:"",noItemsFragment:this.getNoItemsMessage(),entityName:_i18n.i18n.translate("kbn.visualize.listing.table.entityName",{defaultMessage:"visualization"}),entityNamePlural:_i18n.i18n.translate("kbn.visualize.listing.table.entityNamePlural",{defaultMessage:"visualizations"}),tableListTitle:_i18n.i18n.translate("kbn.visualize.listing.table.listTitle",{defaultMessage:"Visualizations"}),toastNotifications:toastNotifications,uiSettings:uiSettings})}},{key:"getTableColumns",value:function getTableColumns(){var _this=this;var tableColumns=[{field:"title",name:_i18n.i18n.translate("kbn.visualize.listing.table.titleColumnName",{defaultMessage:"Title"}),sortable:true,render:function render(field,record){return _react.default.createElement(_eui.EuiLink,{href:_this.props.getViewUrl(record),"data-test-subj":"visListingTitleLink-".concat(record.title.split(" ").join("-"))},field)}},{field:"typeTitle",name:_i18n.i18n.translate("kbn.visualize.listing.table.typeColumnName",{defaultMessage:"Type"}),sortable:true,render:function render(field,record){return _react.default.createElement("span",null,_this.renderItemTypeIcon(record),record.typeTitle,_this.getBadge(record))}},{field:"description",name:_i18n.i18n.translate("kbn.dashboard.listing.table.descriptionColumnName",{defaultMessage:"Description"}),sortable:true,render:function render(field,record){return _react.default.createElement("span",null,record.description)}}];return tableColumns}},{key:"getNoItemsMessage",value:function getNoItemsMessage(){if(this.props.hideWriteControls){return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiEmptyPrompt,{iconType:"visualizeApp",title:_react.default.createElement("h1",{id:"visualizeListingHeading"},_react.default.createElement(_react2.FormattedMessage,{id:"kbn.visualize.listing.noItemsMessage",defaultMessage:"Looks like you don't have any visualizations."}))}))}return _react.default.createElement("div",null,_react.default.createElement(_eui.EuiEmptyPrompt,{iconType:"visualizeApp",title:_react.default.createElement("h1",{id:"visualizeListingHeading"},_react.default.createElement(_react2.FormattedMessage,{id:"kbn.visualize.listing.createNew.title",defaultMessage:"Create your first visualization"})),body:_react.default.createElement(_react.Fragment,null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"kbn.visualize.listing.createNew.description",defaultMessage:"You can create different visualizations, based on your data."}))),actions:_react.default.createElement(_eui.EuiButton,{onClick:this.props.createItem,fill:true,iconType:"plusInCircle","data-test-subj":"createVisualizationPromptButton"},_react.default.createElement(_react2.FormattedMessage,{id:"kbn.visualize.listing.createNew.createButtonLabel",defaultMessage:"Create new visualization"}))}))}},{key:"renderItemTypeIcon",value:function renderItemTypeIcon(item){var icon;if(item.image){icon=_react.default.createElement("img",{className:"visListingTable__typeImage","aria-hidden":"true",alt:"",src:item.image})}else{icon=_react.default.createElement(_eui.EuiIcon,{className:"visListingTable__typeIcon","aria-hidden":"true",type:item.icon||"empty",size:"m"})}return icon}},{key:"getBadge",value:function getBadge(item){if(item.stage==="beta"){return _react.default.createElement(_eui.EuiBetaBadge,{className:"visListingTable__betaIcon",label:"B",title:_i18n.i18n.translate("kbn.visualize.listing.betaTitle",{defaultMessage:"Beta"}),tooltipContent:_i18n.i18n.translate("kbn.visualize.listing.betaTooltip",{defaultMessage:"This visualization is in beta and is subject to change. The design and code is less mature than official GA "+"features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA "+"features"})})}else if(item.stage==="experimental"){return _react.default.createElement(_eui.EuiBetaBadge,{className:"visListingTable__experimentalIcon",label:"E",title:_i18n.i18n.translate("kbn.visualize.listing.experimentalTitle",{defaultMessage:"Experimental"}),tooltipContent:_i18n.i18n.translate("kbn.visualize.listing.experimentalTooltip",{defaultMessage:"This visualization might be changed or removed in a future release and is not subject to the support SLA."})})}}}]);return VisualizeListingTable}(_react.Component);exports.VisualizeListingTable=VisualizeListingTable;VisualizeListingTable.propTypes={deleteItems:_propTypes.default.func.isRequired,findItems:_propTypes.default.func.isRequired,createItem:_propTypes.default.func.isRequired,getViewUrl:_propTypes.default.func.isRequired,editItem:_propTypes.default.func.isRequired,listingLimit:_propTypes.default.number.isRequired}},690:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _public=__webpack_require__(775);Object.keys(_public).forEach((function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _public[key]}})}))}}]);